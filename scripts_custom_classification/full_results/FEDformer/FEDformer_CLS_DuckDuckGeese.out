Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3633241653442383
Epoch: 1, Steps: 4 | Train Loss: 1.757 Vali Loss: 1.755 Vali Acc: 0.180 Test Loss: 1.755 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 1.8035213947296143
Epoch: 2, Steps: 4 | Train Loss: 1.438 Vali Loss: 1.694 Vali Acc: 0.200 Test Loss: 1.694 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.9356727600097656
Epoch: 3, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.892 Vali Acc: 0.260 Test Loss: 1.892 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259981).  Saving model ...
Epoch: 4 cost time: 1.9218051433563232
Epoch: 4, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.966 Vali Acc: 0.320 Test Loss: 1.966 Test Acc: 0.320
Validation loss decreased (-0.259981 --> -0.319980).  Saving model ...
Epoch: 5 cost time: 2.311143398284912
Epoch: 5, Steps: 4 | Train Loss: 0.217 Vali Loss: 2.474 Vali Acc: 0.340 Test Loss: 2.474 Test Acc: 0.340
Validation loss decreased (-0.319980 --> -0.339975).  Saving model ...
Epoch: 6 cost time: 2.668853282928467
Epoch: 6, Steps: 4 | Train Loss: 0.139 Vali Loss: 2.360 Vali Acc: 0.300 Test Loss: 2.360 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.324286937713623
Epoch: 7, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.496 Vali Acc: 0.300 Test Loss: 2.496 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5071067810058594
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.720 Vali Acc: 0.280 Test Loss: 2.720 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5346524715423584
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.981 Vali Acc: 0.300 Test Loss: 2.981 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.678913116455078
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.400 Vali Acc: 0.320 Test Loss: 3.400 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.036818265914917
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.758 Vali Acc: 0.280 Test Loss: 3.758 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2321438789367676
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.007 Vali Acc: 0.280 Test Loss: 4.007 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.634862184524536
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.143 Vali Acc: 0.280 Test Loss: 4.143 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.400489091873169
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.200 Vali Acc: 0.300 Test Loss: 4.200 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.262061357498169
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.195 Vali Acc: 0.300 Test Loss: 4.195 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8769612312316895
Epoch: 1, Steps: 4 | Train Loss: 1.801 Vali Loss: 1.697 Vali Acc: 0.160 Test Loss: 1.697 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.246081829071045
Epoch: 2, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.660 Vali Acc: 0.200 Test Loss: 1.660 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 2.7186591625213623
Epoch: 3, Steps: 4 | Train Loss: 0.798 Vali Loss: 1.833 Vali Acc: 0.180 Test Loss: 1.833 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.339566469192505
Epoch: 4, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.861 Vali Acc: 0.300 Test Loss: 1.861 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299981).  Saving model ...
Epoch: 5 cost time: 2.371368885040283
Epoch: 5, Steps: 4 | Train Loss: 0.235 Vali Loss: 2.385 Vali Acc: 0.260 Test Loss: 2.385 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.48366117477417
Epoch: 6, Steps: 4 | Train Loss: 0.159 Vali Loss: 2.298 Vali Acc: 0.260 Test Loss: 2.298 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.357062578201294
Epoch: 7, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.407 Vali Acc: 0.300 Test Loss: 2.407 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2522690296173096
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.498 Vali Acc: 0.280 Test Loss: 2.498 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4211912155151367
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.669 Vali Acc: 0.340 Test Loss: 2.669 Test Acc: 0.340
Validation loss decreased (-0.299981 --> -0.339973).  Saving model ...
Epoch: 10 cost time: 2.536358594894409
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.109 Vali Acc: 0.260 Test Loss: 3.109 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3785665035247803
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.511 Vali Acc: 0.260 Test Loss: 3.511 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3440299034118652
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.795 Vali Acc: 0.240 Test Loss: 3.795 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3527369499206543
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.949 Vali Acc: 0.240 Test Loss: 3.949 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1023964881896973
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.003 Vali Acc: 0.240 Test Loss: 4.003 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8494455814361572
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.984 Vali Acc: 0.240 Test Loss: 3.984 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6832101345062256
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.923 Vali Acc: 0.240 Test Loss: 3.923 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.904482126235962
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.839 Vali Acc: 0.240 Test Loss: 3.839 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9816343784332275
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.758 Vali Acc: 0.220 Test Loss: 3.758 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6190855503082275
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.692 Vali Acc: 0.220 Test Loss: 3.692 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.758080244064331
Epoch: 1, Steps: 4 | Train Loss: 1.851 Vali Loss: 1.644 Vali Acc: 0.160 Test Loss: 1.644 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.4259378910064697
Epoch: 2, Steps: 4 | Train Loss: 1.425 Vali Loss: 1.623 Vali Acc: 0.200 Test Loss: 1.623 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 2.6428492069244385
Epoch: 3, Steps: 4 | Train Loss: 0.742 Vali Loss: 1.823 Vali Acc: 0.220 Test Loss: 1.823 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219982).  Saving model ...
Epoch: 4 cost time: 2.823326587677002
Epoch: 4, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.872 Vali Acc: 0.280 Test Loss: 1.872 Test Acc: 0.280
Validation loss decreased (-0.219982 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 2.549182176589966
Epoch: 5, Steps: 4 | Train Loss: 0.225 Vali Loss: 2.480 Vali Acc: 0.240 Test Loss: 2.480 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.247795820236206
Epoch: 6, Steps: 4 | Train Loss: 0.144 Vali Loss: 2.443 Vali Acc: 0.260 Test Loss: 2.443 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2452890872955322
Epoch: 7, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.481 Vali Acc: 0.320 Test Loss: 2.481 Test Acc: 0.320
Validation loss decreased (-0.279981 --> -0.319975).  Saving model ...
Epoch: 8 cost time: 2.6748361587524414
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.628 Vali Acc: 0.300 Test Loss: 2.628 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.083190679550171
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.782 Vali Acc: 0.320 Test Loss: 2.782 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2411558628082275
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.225 Vali Acc: 0.260 Test Loss: 3.225 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.741006374359131
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.656 Vali Acc: 0.280 Test Loss: 3.656 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5685911178588867
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.974 Vali Acc: 0.280 Test Loss: 3.974 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.527207136154175
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.153 Vali Acc: 0.260 Test Loss: 4.153 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.882979393005371
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.215 Vali Acc: 0.260 Test Loss: 4.215 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.203829526901245
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.207 Vali Acc: 0.260 Test Loss: 4.207 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4643468856811523
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.151 Vali Acc: 0.280 Test Loss: 4.151 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5764286518096924
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.073 Vali Acc: 0.280 Test Loss: 4.073 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.335352420806885
Epoch: 1, Steps: 4 | Train Loss: 1.801 Vali Loss: 1.674 Vali Acc: 0.140 Test Loss: 1.674 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 2.6096880435943604
Epoch: 2, Steps: 4 | Train Loss: 1.443 Vali Loss: 1.613 Vali Acc: 0.180 Test Loss: 1.613 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 2.515340566635132
Epoch: 3, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.836 Vali Acc: 0.240 Test Loss: 1.836 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239982).  Saving model ...
Epoch: 4 cost time: 2.4100120067596436
Epoch: 4, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.877 Vali Acc: 0.280 Test Loss: 1.877 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 2.2876157760620117
Epoch: 5, Steps: 4 | Train Loss: 0.209 Vali Loss: 2.415 Vali Acc: 0.300 Test Loss: 2.415 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299976).  Saving model ...
Epoch: 6 cost time: 2.3762502670288086
Epoch: 6, Steps: 4 | Train Loss: 0.110 Vali Loss: 2.369 Vali Acc: 0.280 Test Loss: 2.369 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4582250118255615
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.285 Vali Acc: 0.380 Test Loss: 2.285 Test Acc: 0.380
Validation loss decreased (-0.299976 --> -0.379977).  Saving model ...
Epoch: 8 cost time: 2.4690661430358887
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.498 Vali Acc: 0.360 Test Loss: 2.498 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.230494499206543
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.575 Vali Acc: 0.320 Test Loss: 2.575 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1224701404571533
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.817 Vali Acc: 0.300 Test Loss: 2.817 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8869235515594482
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.075 Vali Acc: 0.280 Test Loss: 3.075 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7604310512542725
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.315 Vali Acc: 0.280 Test Loss: 3.315 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.144009590148926
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.504 Vali Acc: 0.320 Test Loss: 3.504 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1414899826049805
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.640 Vali Acc: 0.320 Test Loss: 3.640 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2226321697235107
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.721 Vali Acc: 0.320 Test Loss: 3.721 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3279168605804443
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.754 Vali Acc: 0.320 Test Loss: 3.754 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.4499785900115967
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.750 Vali Acc: 0.320 Test Loss: 3.750 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.953041076660156
Epoch: 1, Steps: 4 | Train Loss: 1.776 Vali Loss: 1.644 Vali Acc: 0.200 Test Loss: 1.644 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 3.22405743598938
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.583 Vali Acc: 0.260 Test Loss: 1.583 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.6978492736816406
Epoch: 3, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.863 Vali Acc: 0.220 Test Loss: 1.863 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.80024790763855
Epoch: 4, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.859 Vali Acc: 0.280 Test Loss: 1.859 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 2.894819736480713
Epoch: 5, Steps: 4 | Train Loss: 0.205 Vali Loss: 2.387 Vali Acc: 0.300 Test Loss: 2.387 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299976).  Saving model ...
Epoch: 6 cost time: 3.070725202560425
Epoch: 6, Steps: 4 | Train Loss: 0.111 Vali Loss: 2.371 Vali Acc: 0.280 Test Loss: 2.371 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.075329303741455
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.310 Vali Acc: 0.220 Test Loss: 2.310 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.897087574005127
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.698 Vali Acc: 0.240 Test Loss: 2.698 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9974639415740967
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.905 Vali Acc: 0.260 Test Loss: 2.905 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4407882690429688
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.053 Vali Acc: 0.260 Test Loss: 3.053 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.805729627609253
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.136 Vali Acc: 0.260 Test Loss: 3.136 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8797595500946045
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.227 Vali Acc: 0.260 Test Loss: 3.227 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8989157676696777
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.309 Vali Acc: 0.200 Test Loss: 3.309 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.2172930240631104
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.374 Vali Acc: 0.200 Test Loss: 3.374 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.790344715118408
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.416 Vali Acc: 0.200 Test Loss: 3.416 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.95977783203125
Epoch: 1, Steps: 4 | Train Loss: 1.738 Vali Loss: 1.682 Vali Acc: 0.040 Test Loss: 1.682 Test Acc: 0.040
Validation loss decreased (inf --> -0.039983).  Saving model ...
Epoch: 2 cost time: 2.9971466064453125
Epoch: 2, Steps: 4 | Train Loss: 1.413 Vali Loss: 1.649 Vali Acc: 0.200 Test Loss: 1.649 Test Acc: 0.200
Validation loss decreased (-0.039983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 2.835160255432129
Epoch: 3, Steps: 4 | Train Loss: 0.754 Vali Loss: 1.864 Vali Acc: 0.220 Test Loss: 1.864 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219981).  Saving model ...
Epoch: 4 cost time: 2.538445472717285
Epoch: 4, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.924 Vali Acc: 0.320 Test Loss: 1.924 Test Acc: 0.320
Validation loss decreased (-0.219981 --> -0.319981).  Saving model ...
Epoch: 5 cost time: 3.1531851291656494
Epoch: 5, Steps: 4 | Train Loss: 0.167 Vali Loss: 2.632 Vali Acc: 0.260 Test Loss: 2.632 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8881425857543945
Epoch: 6, Steps: 4 | Train Loss: 0.089 Vali Loss: 2.610 Vali Acc: 0.240 Test Loss: 2.610 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1676130294799805
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.403 Vali Acc: 0.280 Test Loss: 2.403 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1810741424560547
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.668 Vali Acc: 0.320 Test Loss: 2.668 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.012281656265259
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.839 Vali Acc: 0.300 Test Loss: 2.839 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0809593200683594
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.047 Vali Acc: 0.320 Test Loss: 3.047 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.123459815979004
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.219 Vali Acc: 0.260 Test Loss: 3.219 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.136514902114868
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.373 Vali Acc: 0.240 Test Loss: 3.373 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8478763103485107
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.493 Vali Acc: 0.260 Test Loss: 3.493 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7835724353790283
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.581 Vali Acc: 0.260 Test Loss: 3.581 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.58014702796936
Epoch: 1, Steps: 4 | Train Loss: 1.725 Vali Loss: 1.602 Vali Acc: 0.180 Test Loss: 1.602 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.8722176551818848
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.529 Vali Acc: 0.260 Test Loss: 1.529 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 3.2603254318237305
Epoch: 3, Steps: 4 | Train Loss: 0.777 Vali Loss: 1.666 Vali Acc: 0.220 Test Loss: 1.666 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.739137887954712
Epoch: 4, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.750 Vali Acc: 0.260 Test Loss: 1.750 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.340947389602661
Epoch: 5, Steps: 4 | Train Loss: 0.166 Vali Loss: 2.394 Vali Acc: 0.240 Test Loss: 2.394 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6663010120391846
Epoch: 6, Steps: 4 | Train Loss: 0.103 Vali Loss: 2.251 Vali Acc: 0.280 Test Loss: 2.251 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279977).  Saving model ...
Epoch: 7 cost time: 2.846895456314087
Epoch: 7, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.102 Vali Acc: 0.260 Test Loss: 2.102 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1051266193389893
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.386 Vali Acc: 0.300 Test Loss: 2.386 Test Acc: 0.300
Validation loss decreased (-0.279977 --> -0.299976).  Saving model ...
Epoch: 9 cost time: 2.698396682739258
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.561 Vali Acc: 0.240 Test Loss: 2.561 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.755150079727173
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.724 Vali Acc: 0.240 Test Loss: 2.724 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8665122985839844
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.280 Test Loss: 2.845 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5689544677734375
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.950 Vali Acc: 0.240 Test Loss: 2.950 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7848050594329834
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.260 Test Loss: 3.031 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0748250484466553
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.090 Vali Acc: 0.280 Test Loss: 3.090 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.762460470199585
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.128 Vali Acc: 0.260 Test Loss: 3.128 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0810303688049316
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.151 Vali Acc: 0.260 Test Loss: 3.151 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.938413619995117
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.165 Vali Acc: 0.260 Test Loss: 3.165 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.219447374343872
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.172 Vali Acc: 0.260 Test Loss: 3.172 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.000136137008667
Epoch: 1, Steps: 4 | Train Loss: 1.686 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.6538286209106445
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.595 Vali Acc: 0.180 Test Loss: 1.595 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1020612716674805
Epoch: 3, Steps: 4 | Train Loss: 0.920 Vali Loss: 1.666 Vali Acc: 0.240 Test Loss: 1.666 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 3.1814234256744385
Epoch: 4, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.673 Vali Acc: 0.320 Test Loss: 1.673 Test Acc: 0.320
Validation loss decreased (-0.239983 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 2.7127394676208496
Epoch: 5, Steps: 4 | Train Loss: 0.242 Vali Loss: 2.169 Vali Acc: 0.260 Test Loss: 2.169 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1710054874420166
Epoch: 6, Steps: 4 | Train Loss: 0.117 Vali Loss: 2.074 Vali Acc: 0.240 Test Loss: 2.074 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.949291944503784
Epoch: 7, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.772 Vali Acc: 0.340 Test Loss: 1.772 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339982).  Saving model ...
Epoch: 8 cost time: 3.0642426013946533
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.915 Vali Acc: 0.320 Test Loss: 1.915 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2423808574676514
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.064 Vali Acc: 0.300 Test Loss: 2.064 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.912537097930908
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.212 Vali Acc: 0.280 Test Loss: 2.212 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7298738956451416
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.315 Vali Acc: 0.300 Test Loss: 2.315 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7352705001831055
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.360 Test Loss: 2.397 Test Acc: 0.360
Validation loss decreased (-0.339982 --> -0.359976).  Saving model ...
Epoch: 13 cost time: 2.673668384552002
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.340 Test Loss: 2.455 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8205623626708984
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.501 Vali Acc: 0.340 Test Loss: 2.501 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0199477672576904
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.533 Vali Acc: 0.320 Test Loss: 2.533 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4714508056640625
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.320 Test Loss: 2.549 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.663389205932617
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.555 Vali Acc: 0.320 Test Loss: 2.555 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9459829330444336
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.559 Vali Acc: 0.320 Test Loss: 2.559 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9351561069488525
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.562 Vali Acc: 0.320 Test Loss: 2.562 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8973753452301025
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.573 Vali Acc: 0.320 Test Loss: 2.573 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6842849254608154
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.579 Vali Acc: 0.300 Test Loss: 2.579 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.9429852962493896
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.579 Vali Acc: 0.320 Test Loss: 2.579 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8800599575042725
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.678 Vali Acc: 0.200 Test Loss: 1.678 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.956568956375122
Epoch: 2, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.647 Vali Acc: 0.220 Test Loss: 1.647 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.8925840854644775
Epoch: 3, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.714 Vali Acc: 0.260 Test Loss: 1.714 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 2.9201953411102295
Epoch: 4, Steps: 4 | Train Loss: 0.685 Vali Loss: 1.627 Vali Acc: 0.100 Test Loss: 1.627 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.871434450149536
Epoch: 5, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.913 Vali Acc: 0.180 Test Loss: 1.913 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0092735290527344
Epoch: 6, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.850 Vali Acc: 0.180 Test Loss: 1.850 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.142421245574951
Epoch: 7, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.701 Vali Acc: 0.160 Test Loss: 1.701 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.922758102416992
Epoch: 8, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.894 Vali Acc: 0.120 Test Loss: 1.894 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.133784532546997
Epoch: 9, Steps: 4 | Train Loss: 0.077 Vali Loss: 2.082 Vali Acc: 0.160 Test Loss: 2.082 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0618293285369873
Epoch: 10, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.718 Vali Acc: 0.240 Test Loss: 1.718 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.513080358505249
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.731 Vali Acc: 0.260 Test Loss: 1.731 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.034546136856079
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.760 Vali Acc: 0.280 Test Loss: 1.760 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 13 cost time: 2.8845932483673096
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.646 Vali Acc: 0.340 Test Loss: 1.646 Test Acc: 0.340
Validation loss decreased (-0.279982 --> -0.339984).  Saving model ...
Epoch: 14 cost time: 2.8947083950042725
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.300 Test Loss: 1.789 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.222109079360962
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.870 Vali Acc: 0.340 Test Loss: 1.870 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0790340900421143
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.300 Test Loss: 1.808 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0782558917999268
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.340 Test Loss: 1.757 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1026642322540283
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.320 Test Loss: 1.742 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5563299655914307
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.320 Test Loss: 1.760 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0788867473602295
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.320 Test Loss: 1.841 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.9898681640625
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.380 Test Loss: 1.900 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379981).  Saving model ...
Epoch: 22 cost time: 2.894930839538574
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.905 Vali Acc: 0.380 Test Loss: 1.905 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.902646064758301
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.380 Test Loss: 1.879 Test Acc: 0.380
Validation loss decreased (-0.379981 --> -0.379981).  Saving model ...
Epoch: 24 cost time: 2.995715618133545
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.340 Test Loss: 1.854 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.693723440170288
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.320 Test Loss: 1.837 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2072789669036865
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.300 Test Loss: 1.829 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.712165117263794
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.300 Test Loss: 1.832 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.22087025642395
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.300 Test Loss: 1.843 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0665993690490723
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.320 Test Loss: 1.853 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9131317138671875
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.320 Test Loss: 1.875 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.2034144401550293
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.320 Test Loss: 1.898 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.8178346157073975
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.340 Test Loss: 1.926 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.8042569160461426
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.360 Test Loss: 1.940 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.183769464492798
Epoch: 1, Steps: 4 | Train Loss: 1.634 Vali Loss: 1.655 Vali Acc: 0.240 Test Loss: 1.655 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.708472967147827
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.651 Vali Acc: 0.180 Test Loss: 1.651 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9007303714752197
Epoch: 3, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.748 Vali Acc: 0.140 Test Loss: 1.748 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3635175228118896
Epoch: 4, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.627 Vali Acc: 0.200 Test Loss: 1.627 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8999059200286865
Epoch: 5, Steps: 4 | Train Loss: 0.597 Vali Loss: 1.866 Vali Acc: 0.180 Test Loss: 1.866 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.337585687637329
Epoch: 6, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.812 Vali Acc: 0.160 Test Loss: 1.812 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.758587121963501
Epoch: 7, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.640 Vali Acc: 0.160 Test Loss: 1.640 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.905066728591919
Epoch: 8, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.862 Vali Acc: 0.180 Test Loss: 1.862 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4583427906036377
Epoch: 9, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.043 Vali Acc: 0.180 Test Loss: 2.043 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7467610836029053
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.814 Vali Acc: 0.220 Test Loss: 1.814 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6557154655456543
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.680 Vali Acc: 0.280 Test Loss: 1.680 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 12 cost time: 3.0780959129333496
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.623 Vali Acc: 0.300 Test Loss: 1.623 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299984).  Saving model ...
Epoch: 13 cost time: 2.571491241455078
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.591 Vali Acc: 0.300 Test Loss: 1.591 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 14 cost time: 3.016998052597046
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.300 Test Loss: 1.634 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.033816337585449
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.380 Test Loss: 1.759 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379982).  Saving model ...
Epoch: 16 cost time: 2.9675631523132324
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.904 Vali Acc: 0.380 Test Loss: 1.904 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.166936159133911
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.380 Test Loss: 2.015 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7037513256073
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.380 Test Loss: 2.047 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3103973865509033
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.380 Test Loss: 2.029 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9206225872039795
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.360 Test Loss: 2.015 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0892763137817383
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.360 Test Loss: 1.980 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.090876817703247
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.360 Test Loss: 1.953 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.797710418701172
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.360 Test Loss: 1.920 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1056721210479736
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.380 Test Loss: 1.887 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.532890796661377
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.380 Test Loss: 1.871 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 19559429
model size : 94.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.544278383255005
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.644 Vali Acc: 0.200 Test Loss: 1.644 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 3.410689353942871
Epoch: 2, Steps: 4 | Train Loss: 1.435 Vali Loss: 1.616 Vali Acc: 0.220 Test Loss: 1.616 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 3.3566360473632812
Epoch: 3, Steps: 4 | Train Loss: 1.016 Vali Loss: 1.743 Vali Acc: 0.240 Test Loss: 1.743 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 2.969774007797241
Epoch: 4, Steps: 4 | Train Loss: 0.498 Vali Loss: 2.192 Vali Acc: 0.260 Test Loss: 2.192 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259978).  Saving model ...
Epoch: 5 cost time: 2.935235023498535
Epoch: 5, Steps: 4 | Train Loss: 0.191 Vali Loss: 2.200 Vali Acc: 0.320 Test Loss: 2.200 Test Acc: 0.320
Validation loss decreased (-0.259978 --> -0.319978).  Saving model ...
Epoch: 6 cost time: 3.010951280593872
Epoch: 6, Steps: 4 | Train Loss: 0.094 Vali Loss: 2.238 Vali Acc: 0.300 Test Loss: 2.238 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0096163749694824
Epoch: 7, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.806 Vali Acc: 0.320 Test Loss: 2.806 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8538830280303955
Epoch: 8, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.945 Vali Acc: 0.260 Test Loss: 2.945 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3538851737976074
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.094 Vali Acc: 0.280 Test Loss: 3.094 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6935806274414062
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.254 Vali Acc: 0.260 Test Loss: 3.254 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.222761392593384
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.210 Vali Acc: 0.280 Test Loss: 3.210 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.198152780532837
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.195 Vali Acc: 0.260 Test Loss: 3.195 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.382336139678955
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.202 Vali Acc: 0.240 Test Loss: 3.202 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.319263458251953
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.230 Vali Acc: 0.280 Test Loss: 3.230 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0347354412078857
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.266 Vali Acc: 0.300 Test Loss: 3.266 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.572570562362671
Epoch: 1, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.585 Vali Acc: 0.200 Test Loss: 1.585 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 3.241859197616577
Epoch: 2, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.567 Vali Acc: 0.240 Test Loss: 1.567 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.9208343029022217
Epoch: 3, Steps: 4 | Train Loss: 0.997 Vali Loss: 1.664 Vali Acc: 0.240 Test Loss: 1.664 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3115837574005127
Epoch: 4, Steps: 4 | Train Loss: 0.493 Vali Loss: 2.171 Vali Acc: 0.220 Test Loss: 2.171 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.945486307144165
Epoch: 5, Steps: 4 | Train Loss: 0.205 Vali Loss: 2.130 Vali Acc: 0.280 Test Loss: 2.130 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279979).  Saving model ...
Epoch: 6 cost time: 3.220902681350708
Epoch: 6, Steps: 4 | Train Loss: 0.109 Vali Loss: 2.165 Vali Acc: 0.240 Test Loss: 2.165 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.074904441833496
Epoch: 7, Steps: 4 | Train Loss: 0.043 Vali Loss: 2.614 Vali Acc: 0.280 Test Loss: 2.614 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.151282548904419
Epoch: 8, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.031 Vali Acc: 0.300 Test Loss: 3.031 Test Acc: 0.300
Validation loss decreased (-0.279979 --> -0.299970).  Saving model ...
Epoch: 9 cost time: 3.4091293811798096
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.099 Vali Acc: 0.280 Test Loss: 3.099 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0894100666046143
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.232 Vali Acc: 0.240 Test Loss: 3.232 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9288055896759033
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.132 Vali Acc: 0.280 Test Loss: 3.132 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9688687324523926
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.046 Vali Acc: 0.260 Test Loss: 3.046 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.859485149383545
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.995 Vali Acc: 0.300 Test Loss: 2.995 Test Acc: 0.300
Validation loss decreased (-0.299970 --> -0.299970).  Saving model ...
Epoch: 14 cost time: 3.063002347946167
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.007 Vali Acc: 0.280 Test Loss: 3.007 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.571807622909546
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.051 Vali Acc: 0.300 Test Loss: 3.051 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.06707763671875
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.113 Vali Acc: 0.320 Test Loss: 3.113 Test Acc: 0.320
Validation loss decreased (-0.299970 --> -0.319969).  Saving model ...
Epoch: 17 cost time: 2.747314691543579
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.178 Vali Acc: 0.340 Test Loss: 3.178 Test Acc: 0.340
Validation loss decreased (-0.319969 --> -0.339968).  Saving model ...
Epoch: 18 cost time: 3.205066680908203
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.236 Vali Acc: 0.340 Test Loss: 3.236 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7835965156555176
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.283 Vali Acc: 0.340 Test Loss: 3.283 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.046020030975342
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.323 Vali Acc: 0.320 Test Loss: 3.323 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.23816180229187
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.360 Vali Acc: 0.300 Test Loss: 3.360 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.854564905166626
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.388 Vali Acc: 0.300 Test Loss: 3.388 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.854889154434204
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.409 Vali Acc: 0.300 Test Loss: 3.409 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0703682899475098
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.424 Vali Acc: 0.300 Test Loss: 3.424 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.659034013748169
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.435 Vali Acc: 0.300 Test Loss: 3.435 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.4917988777160645
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.438 Vali Acc: 0.300 Test Loss: 3.438 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.0568971633911133
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.442 Vali Acc: 0.300 Test Loss: 3.442 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.590645790100098
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.580 Vali Acc: 0.180 Test Loss: 1.580 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.83060622215271
Epoch: 2, Steps: 4 | Train Loss: 1.429 Vali Loss: 1.569 Vali Acc: 0.200 Test Loss: 1.569 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 2.8160104751586914
Epoch: 3, Steps: 4 | Train Loss: 0.997 Vali Loss: 1.663 Vali Acc: 0.280 Test Loss: 1.663 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 3.1518170833587646
Epoch: 4, Steps: 4 | Train Loss: 0.465 Vali Loss: 2.236 Vali Acc: 0.200 Test Loss: 2.236 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2366209030151367
Epoch: 5, Steps: 4 | Train Loss: 0.204 Vali Loss: 2.268 Vali Acc: 0.240 Test Loss: 2.268 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9772820472717285
Epoch: 6, Steps: 4 | Train Loss: 0.104 Vali Loss: 2.290 Vali Acc: 0.300 Test Loss: 2.290 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299977).  Saving model ...
Epoch: 7 cost time: 3.284717321395874
Epoch: 7, Steps: 4 | Train Loss: 0.038 Vali Loss: 2.632 Vali Acc: 0.280 Test Loss: 2.632 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1070637702941895
Epoch: 8, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.174 Vali Acc: 0.260 Test Loss: 3.174 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.107365369796753
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.325 Vali Acc: 0.260 Test Loss: 3.325 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.907900810241699
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.480 Vali Acc: 0.240 Test Loss: 3.480 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7087550163269043
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.516 Vali Acc: 0.280 Test Loss: 3.516 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.035413980484009
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.456 Vali Acc: 0.340 Test Loss: 3.456 Test Acc: 0.340
Validation loss decreased (-0.299977 --> -0.339965).  Saving model ...
Epoch: 13 cost time: 3.0245981216430664
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.370 Vali Acc: 0.360 Test Loss: 3.370 Test Acc: 0.360
Validation loss decreased (-0.339965 --> -0.359966).  Saving model ...
Epoch: 14 cost time: 2.7518060207366943
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.317 Vali Acc: 0.340 Test Loss: 3.317 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.394193410873413
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.292 Vali Acc: 0.320 Test Loss: 3.292 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.77813458442688
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.292 Vali Acc: 0.300 Test Loss: 3.292 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.933461904525757
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.307 Vali Acc: 0.320 Test Loss: 3.307 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.079904317855835
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.328 Vali Acc: 0.320 Test Loss: 3.328 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1877756118774414
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.348 Vali Acc: 0.340 Test Loss: 3.348 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0540647506713867
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.367 Vali Acc: 0.340 Test Loss: 3.367 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.9163215160369873
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.390 Vali Acc: 0.340 Test Loss: 3.390 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.637108325958252
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.412 Vali Acc: 0.300 Test Loss: 3.412 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1302387714385986
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.433 Vali Acc: 0.300 Test Loss: 3.433 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9923460483551025
Epoch: 1, Steps: 4 | Train Loss: 1.695 Vali Loss: 1.589 Vali Acc: 0.200 Test Loss: 1.589 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.818277597427368
Epoch: 2, Steps: 4 | Train Loss: 1.445 Vali Loss: 1.565 Vali Acc: 0.220 Test Loss: 1.565 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.7786436080932617
Epoch: 3, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.649 Vali Acc: 0.280 Test Loss: 1.649 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.3819692134857178
Epoch: 4, Steps: 4 | Train Loss: 0.464 Vali Loss: 2.176 Vali Acc: 0.260 Test Loss: 2.176 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.305427312850952
Epoch: 5, Steps: 4 | Train Loss: 0.179 Vali Loss: 2.097 Vali Acc: 0.280 Test Loss: 2.097 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9546432495117188
Epoch: 6, Steps: 4 | Train Loss: 0.093 Vali Loss: 2.116 Vali Acc: 0.340 Test Loss: 2.116 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339979).  Saving model ...
Epoch: 7 cost time: 3.158043384552002
Epoch: 7, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.630 Vali Acc: 0.280 Test Loss: 2.630 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.969397783279419
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.041 Vali Acc: 0.280 Test Loss: 3.041 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8463516235351562
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.030 Vali Acc: 0.260 Test Loss: 3.030 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9419326782226562
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.116 Vali Acc: 0.280 Test Loss: 3.116 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.851022243499756
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.280 Test Loss: 3.189 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.051107883453369
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.238 Vali Acc: 0.300 Test Loss: 3.238 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6144230365753174
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.248 Vali Acc: 0.320 Test Loss: 3.248 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4607174396514893
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.221 Vali Acc: 0.320 Test Loss: 3.221 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.828826904296875
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.172 Vali Acc: 0.300 Test Loss: 3.172 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8336057662963867
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.141 Vali Acc: 0.300 Test Loss: 3.141 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.78453254699707
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.935631513595581
Epoch: 2, Steps: 4 | Train Loss: 1.425 Vali Loss: 1.596 Vali Acc: 0.160 Test Loss: 1.596 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0210578441619873
Epoch: 3, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.706 Vali Acc: 0.200 Test Loss: 1.706 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.848541259765625
Epoch: 4, Steps: 4 | Train Loss: 0.454 Vali Loss: 2.112 Vali Acc: 0.200 Test Loss: 2.112 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.914090633392334
Epoch: 5, Steps: 4 | Train Loss: 0.161 Vali Loss: 2.055 Vali Acc: 0.240 Test Loss: 2.055 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.774498224258423
Epoch: 6, Steps: 4 | Train Loss: 0.079 Vali Loss: 2.315 Vali Acc: 0.200 Test Loss: 2.315 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.750185966491699
Epoch: 7, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.540 Vali Acc: 0.200 Test Loss: 2.540 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9542136192321777
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.017 Vali Acc: 0.220 Test Loss: 3.017 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.57417631149292
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.197 Vali Acc: 0.240 Test Loss: 3.197 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6606249809265137
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.360 Vali Acc: 0.240 Test Loss: 3.360 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6955039501190186
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.386 Vali Acc: 0.220 Test Loss: 3.386 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.04739785194397
Epoch: 1, Steps: 4 | Train Loss: 1.740 Vali Loss: 1.636 Vali Acc: 0.180 Test Loss: 1.636 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.306436777114868
Epoch: 2, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.216844081878662
Epoch: 3, Steps: 4 | Train Loss: 0.941 Vali Loss: 1.714 Vali Acc: 0.240 Test Loss: 1.714 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2062416076660156
Epoch: 4, Steps: 4 | Train Loss: 0.411 Vali Loss: 2.166 Vali Acc: 0.220 Test Loss: 2.166 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.036353349685669
Epoch: 5, Steps: 4 | Train Loss: 0.151 Vali Loss: 2.083 Vali Acc: 0.240 Test Loss: 2.083 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.66689395904541
Epoch: 6, Steps: 4 | Train Loss: 0.052 Vali Loss: 2.246 Vali Acc: 0.240 Test Loss: 2.246 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.584585189819336
Epoch: 7, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.751 Vali Acc: 0.240 Test Loss: 2.751 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8758068084716797
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.488 Vali Acc: 0.240 Test Loss: 3.488 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3355207443237305
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.647 Vali Acc: 0.240 Test Loss: 3.647 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8554413318634033
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.661 Vali Acc: 0.260 Test Loss: 3.661 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7686166763305664
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.641 Vali Acc: 0.260 Test Loss: 3.641 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.990680694580078
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.639 Vali Acc: 0.240 Test Loss: 3.639 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.6234447956085205
Epoch: 1, Steps: 4 | Train Loss: 1.779 Vali Loss: 1.591 Vali Acc: 0.200 Test Loss: 1.591 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.611112594604492
Epoch: 2, Steps: 4 | Train Loss: 1.476 Vali Loss: 1.554 Vali Acc: 0.220 Test Loss: 1.554 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.655233144760132
Epoch: 3, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.611 Vali Acc: 0.300 Test Loss: 1.611 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 2.675048351287842
Epoch: 4, Steps: 4 | Train Loss: 0.450 Vali Loss: 1.962 Vali Acc: 0.240 Test Loss: 1.962 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.754690408706665
Epoch: 5, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.868 Vali Acc: 0.260 Test Loss: 1.868 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5598576068878174
Epoch: 6, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.036 Vali Acc: 0.260 Test Loss: 2.036 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8882017135620117
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.421 Vali Acc: 0.260 Test Loss: 2.421 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.754317045211792
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.960 Vali Acc: 0.280 Test Loss: 2.960 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.77367901802063
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.136 Vali Acc: 0.280 Test Loss: 3.136 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8754472732543945
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.176 Vali Acc: 0.260 Test Loss: 3.176 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8113651275634766
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.192 Vali Acc: 0.260 Test Loss: 3.192 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8442251682281494
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.205 Vali Acc: 0.280 Test Loss: 3.205 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5666048526763916
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.208 Vali Acc: 0.300 Test Loss: 3.208 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.61258864402771
Epoch: 1, Steps: 4 | Train Loss: 1.713 Vali Loss: 1.582 Vali Acc: 0.180 Test Loss: 1.582 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.7048511505126953
Epoch: 2, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 2.443345308303833
Epoch: 3, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.531 Vali Acc: 0.320 Test Loss: 1.531 Test Acc: 0.320
Validation loss decreased (-0.239985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 2.4916763305664062
Epoch: 4, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.797 Vali Acc: 0.300 Test Loss: 1.797 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.167750597000122
Epoch: 5, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.710 Vali Acc: 0.300 Test Loss: 1.710 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.781705617904663
Epoch: 6, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.711 Vali Acc: 0.280 Test Loss: 1.711 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7121384143829346
Epoch: 7, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.897 Vali Acc: 0.320 Test Loss: 1.897 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4870409965515137
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.266 Vali Acc: 0.240 Test Loss: 2.266 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5484559535980225
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.400 Vali Acc: 0.240 Test Loss: 2.400 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.84892201423645
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.361 Vali Acc: 0.280 Test Loss: 2.361 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7925920486450195
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.322 Vali Acc: 0.300 Test Loss: 2.322 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.898364543914795
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.307 Vali Acc: 0.280 Test Loss: 2.307 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.98249888420105
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.300 Test Loss: 2.303 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.708446264266968
Epoch: 1, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.747 Vali Acc: 0.220 Test Loss: 1.747 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 3.1388325691223145
Epoch: 2, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.706 Vali Acc: 0.100 Test Loss: 1.706 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.802522897720337
Epoch: 3, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.737 Vali Acc: 0.180 Test Loss: 1.737 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9294772148132324
Epoch: 4, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.897 Vali Acc: 0.140 Test Loss: 1.897 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9194793701171875
Epoch: 5, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.852 Vali Acc: 0.160 Test Loss: 1.852 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9047021865844727
Epoch: 6, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.718 Vali Acc: 0.180 Test Loss: 1.718 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0140411853790283
Epoch: 7, Steps: 4 | Train Loss: 0.414 Vali Loss: 1.839 Vali Acc: 0.200 Test Loss: 1.839 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6123831272125244
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.961 Vali Acc: 0.120 Test Loss: 1.961 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9559874534606934
Epoch: 9, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.787 Vali Acc: 0.220 Test Loss: 1.787 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5268702507019043
Epoch: 10, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.717 Vali Acc: 0.240 Test Loss: 1.717 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 11 cost time: 2.7787930965423584
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.882 Vali Acc: 0.220 Test Loss: 1.882 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8530545234680176
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.649529218673706
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 14 cost time: 3.054049253463745
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.648 Vali Acc: 0.220 Test Loss: 1.648 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1731159687042236
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.320 Test Loss: 1.620 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319984).  Saving model ...
Epoch: 16 cost time: 2.614657163619995
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.320 Test Loss: 1.626 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.937016010284424
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.360 Test Loss: 1.646 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 18 cost time: 2.6228182315826416
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.340 Test Loss: 1.734 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.003384828567505
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.320 Test Loss: 1.849 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.646578788757324
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.320 Test Loss: 1.941 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9111876487731934
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.300 Test Loss: 1.994 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.629713296890259
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.320 Test Loss: 2.016 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.487539529800415
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.007 Vali Acc: 0.320 Test Loss: 2.007 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.7841005325317383
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.340 Test Loss: 1.995 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.414522409439087
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.320 Test Loss: 1.982 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.936793565750122
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.320 Test Loss: 1.966 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.699918031692505
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.340 Test Loss: 1.937 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.036395788192749
Epoch: 1, Steps: 4 | Train Loss: 1.708 Vali Loss: 1.745 Vali Acc: 0.240 Test Loss: 1.745 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.530754804611206
Epoch: 2, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.723 Vali Acc: 0.240 Test Loss: 1.723 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 2.762580156326294
Epoch: 3, Steps: 4 | Train Loss: 1.175 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0907137393951416
Epoch: 4, Steps: 4 | Train Loss: 0.752 Vali Loss: 1.921 Vali Acc: 0.180 Test Loss: 1.921 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.710146427154541
Epoch: 5, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.834 Vali Acc: 0.240 Test Loss: 1.834 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9985029697418213
Epoch: 6, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.698 Vali Acc: 0.280 Test Loss: 1.698 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 7 cost time: 3.167804479598999
Epoch: 7, Steps: 4 | Train Loss: 0.313 Vali Loss: 1.876 Vali Acc: 0.200 Test Loss: 1.876 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.813453197479248
Epoch: 8, Steps: 4 | Train Loss: 0.076 Vali Loss: 2.073 Vali Acc: 0.240 Test Loss: 2.073 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2069456577301025
Epoch: 9, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.884 Vali Acc: 0.240 Test Loss: 1.884 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.937807559967041
Epoch: 10, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 11 cost time: 2.9531219005584717
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.684 Vali Acc: 0.300 Test Loss: 1.684 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 12 cost time: 3.0548243522644043
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.762 Vali Acc: 0.300 Test Loss: 1.762 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8069348335266113
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.320 Test Loss: 1.860 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319981).  Saving model ...
Epoch: 14 cost time: 3.0868537425994873
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.300 Test Loss: 1.938 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7142934799194336
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.951 Vali Acc: 0.280 Test Loss: 1.951 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9485650062561035
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.280 Test Loss: 1.960 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8736836910247803
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.320 Test Loss: 1.968 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7902309894561768
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.320 Test Loss: 1.962 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.942633867263794
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.320 Test Loss: 1.964 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.004523515701294
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.300 Test Loss: 1.968 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.75978684425354
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.340 Test Loss: 1.977 Test Acc: 0.340
Validation loss decreased (-0.319981 --> -0.339980).  Saving model ...
Epoch: 22 cost time: 3.2491133213043213
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.400 Test Loss: 1.978 Test Acc: 0.400
Validation loss decreased (-0.339980 --> -0.399980).  Saving model ...
Epoch: 23 cost time: 3.0374627113342285
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.360 Test Loss: 1.971 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.839421033859253
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.984 Vali Acc: 0.340 Test Loss: 1.984 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5647034645080566
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.360 Test Loss: 2.009 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8451695442199707
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.360 Test Loss: 2.030 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5613808631896973
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.037 Vali Acc: 0.380 Test Loss: 2.037 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2110650539398193
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.400 Test Loss: 2.030 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.7331244945526123
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.360 Test Loss: 2.030 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.532942771911621
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.360 Test Loss: 2.009 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.9297056198120117
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.320 Test Loss: 1.956 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.6505141258239746
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.935 Vali Acc: 0.320 Test Loss: 1.935 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.4
model parameter : 16413701
model size : 82.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.790813684463501
Epoch: 1, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.645 Vali Acc: 0.240 Test Loss: 1.645 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 3.1088707447052
Epoch: 2, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.797 Vali Acc: 0.240 Test Loss: 1.797 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.380976676940918
Epoch: 3, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.718 Vali Acc: 0.280 Test Loss: 1.718 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 2.630361557006836
Epoch: 4, Steps: 4 | Train Loss: 0.537 Vali Loss: 1.865 Vali Acc: 0.320 Test Loss: 1.865 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319981).  Saving model ...
Epoch: 5 cost time: 3.2592105865478516
Epoch: 5, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.923 Vali Acc: 0.320 Test Loss: 1.923 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6628153324127197
Epoch: 6, Steps: 4 | Train Loss: 0.059 Vali Loss: 2.302 Vali Acc: 0.360 Test Loss: 2.302 Test Acc: 0.360
Validation loss decreased (-0.319981 --> -0.359977).  Saving model ...
Epoch: 7 cost time: 3.3020362854003906
Epoch: 7, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.449 Vali Acc: 0.340 Test Loss: 2.449 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9582486152648926
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.557 Vali Acc: 0.300 Test Loss: 2.557 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.567091464996338
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.636 Vali Acc: 0.300 Test Loss: 2.636 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8878602981567383
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.732 Vali Acc: 0.340 Test Loss: 2.732 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5347237586975098
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.836 Vali Acc: 0.320 Test Loss: 2.836 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8148467540740967
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.937 Vali Acc: 0.320 Test Loss: 2.937 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7460577487945557
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.024 Vali Acc: 0.320 Test Loss: 3.024 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.481290578842163
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.081 Vali Acc: 0.320 Test Loss: 3.081 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7200701236724854
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.127 Vali Acc: 0.320 Test Loss: 3.127 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5689704418182373
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.154 Vali Acc: 0.320 Test Loss: 3.154 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.39233136177063
Epoch: 1, Steps: 4 | Train Loss: 1.748 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 3.3267440795898438
Epoch: 2, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.775 Vali Acc: 0.200 Test Loss: 1.775 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0822465419769287
Epoch: 3, Steps: 4 | Train Loss: 1.096 Vali Loss: 1.666 Vali Acc: 0.300 Test Loss: 1.666 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 3.056659460067749
Epoch: 4, Steps: 4 | Train Loss: 0.539 Vali Loss: 1.825 Vali Acc: 0.340 Test Loss: 1.825 Test Acc: 0.340
Validation loss decreased (-0.299983 --> -0.339982).  Saving model ...
Epoch: 5 cost time: 3.349682331085205
Epoch: 5, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.850 Vali Acc: 0.300 Test Loss: 1.850 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.295215368270874
Epoch: 6, Steps: 4 | Train Loss: 0.063 Vali Loss: 2.209 Vali Acc: 0.340 Test Loss: 2.209 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.899099111557007
Epoch: 7, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.256 Vali Acc: 0.320 Test Loss: 2.256 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2150719165802
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.352 Vali Acc: 0.340 Test Loss: 2.352 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.109697103500366
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.488 Vali Acc: 0.320 Test Loss: 2.488 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.827784299850464
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.609 Vali Acc: 0.300 Test Loss: 2.609 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.198704481124878
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.695 Vali Acc: 0.300 Test Loss: 2.695 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.779120683670044
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.300 Test Loss: 2.774 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8801677227020264
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.843 Vali Acc: 0.280 Test Loss: 2.843 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2009027004241943
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.280 Test Loss: 2.888 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.734694242477417
Epoch: 1, Steps: 4 | Train Loss: 1.817 Vali Loss: 1.628 Vali Acc: 0.260 Test Loss: 1.628 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.9849140644073486
Epoch: 2, Steps: 4 | Train Loss: 1.490 Vali Loss: 1.770 Vali Acc: 0.240 Test Loss: 1.770 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.996645212173462
Epoch: 3, Steps: 4 | Train Loss: 1.108 Vali Loss: 1.705 Vali Acc: 0.280 Test Loss: 1.705 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 2.9069159030914307
Epoch: 4, Steps: 4 | Train Loss: 0.511 Vali Loss: 1.880 Vali Acc: 0.340 Test Loss: 1.880 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339981).  Saving model ...
Epoch: 5 cost time: 2.9835832118988037
Epoch: 5, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.904 Vali Acc: 0.320 Test Loss: 1.904 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6204659938812256
Epoch: 6, Steps: 4 | Train Loss: 0.058 Vali Loss: 2.340 Vali Acc: 0.280 Test Loss: 2.340 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.700166940689087
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.446 Vali Acc: 0.320 Test Loss: 2.446 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.931152105331421
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.569 Vali Acc: 0.300 Test Loss: 2.569 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5276708602905273
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.704 Vali Acc: 0.300 Test Loss: 2.704 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8065195083618164
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.827 Vali Acc: 0.300 Test Loss: 2.827 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.760823965072632
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.925 Vali Acc: 0.280 Test Loss: 2.925 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.805232048034668
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.018 Vali Acc: 0.280 Test Loss: 3.018 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9944121837615967
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.101 Vali Acc: 0.280 Test Loss: 3.101 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6478922367095947
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.163 Vali Acc: 0.280 Test Loss: 3.163 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.885538578033447
Epoch: 1, Steps: 4 | Train Loss: 1.751 Vali Loss: 1.590 Vali Acc: 0.340 Test Loss: 1.590 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 2.585918664932251
Epoch: 2, Steps: 4 | Train Loss: 1.457 Vali Loss: 1.683 Vali Acc: 0.180 Test Loss: 1.683 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.127302646636963
Epoch: 3, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6033551692962646
Epoch: 4, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.821 Vali Acc: 0.320 Test Loss: 1.821 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.586338758468628
Epoch: 5, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.874 Vali Acc: 0.320 Test Loss: 1.874 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5321247577667236
Epoch: 6, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.191 Vali Acc: 0.340 Test Loss: 2.191 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7578601837158203
Epoch: 7, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.236 Vali Acc: 0.320 Test Loss: 2.236 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.847626209259033
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.469 Vali Acc: 0.280 Test Loss: 2.469 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5424535274505615
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.731 Vali Acc: 0.280 Test Loss: 2.731 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1882548332214355
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.890 Vali Acc: 0.260 Test Loss: 2.890 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7231669425964355
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.990 Vali Acc: 0.280 Test Loss: 2.990 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.766433238983154
Epoch: 1, Steps: 4 | Train Loss: 1.758 Vali Loss: 1.660 Vali Acc: 0.180 Test Loss: 1.660 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.8833224773406982
Epoch: 2, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.711 Vali Acc: 0.220 Test Loss: 1.711 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 2.9554643630981445
Epoch: 3, Steps: 4 | Train Loss: 1.049 Vali Loss: 1.759 Vali Acc: 0.240 Test Loss: 1.759 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239982).  Saving model ...
Epoch: 4 cost time: 2.8315086364746094
Epoch: 4, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.938 Vali Acc: 0.260 Test Loss: 1.938 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259981).  Saving model ...
Epoch: 5 cost time: 2.9295997619628906
Epoch: 5, Steps: 4 | Train Loss: 0.148 Vali Loss: 2.040 Vali Acc: 0.200 Test Loss: 2.040 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.665369987487793
Epoch: 6, Steps: 4 | Train Loss: 0.046 Vali Loss: 2.415 Vali Acc: 0.280 Test Loss: 2.415 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279976).  Saving model ...
Epoch: 7 cost time: 2.7673089504241943
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.465 Vali Acc: 0.320 Test Loss: 2.465 Test Acc: 0.320
Validation loss decreased (-0.279976 --> -0.319975).  Saving model ...
Epoch: 8 cost time: 2.428415298461914
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.560 Vali Acc: 0.220 Test Loss: 2.560 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5634851455688477
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.693 Vali Acc: 0.220 Test Loss: 2.693 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.594771146774292
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.834 Vali Acc: 0.220 Test Loss: 2.834 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.492598295211792
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.941 Vali Acc: 0.240 Test Loss: 2.941 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.773463249206543
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.021 Vali Acc: 0.200 Test Loss: 3.021 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7478768825531006
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.087 Vali Acc: 0.200 Test Loss: 3.087 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.688680410385132
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.138 Vali Acc: 0.220 Test Loss: 3.138 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.750471353530884
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.175 Vali Acc: 0.220 Test Loss: 3.175 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8155882358551025
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.199 Vali Acc: 0.220 Test Loss: 3.199 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.0022106170654297
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.214 Vali Acc: 0.220 Test Loss: 3.214 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.646258115768433
Epoch: 1, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.645 Vali Acc: 0.220 Test Loss: 1.645 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.962151527404785
Epoch: 2, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.695 Vali Acc: 0.180 Test Loss: 1.695 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7687904834747314
Epoch: 3, Steps: 4 | Train Loss: 0.973 Vali Loss: 1.800 Vali Acc: 0.260 Test Loss: 1.800 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259982).  Saving model ...
Epoch: 4 cost time: 2.6759331226348877
Epoch: 4, Steps: 4 | Train Loss: 0.397 Vali Loss: 1.938 Vali Acc: 0.280 Test Loss: 1.938 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 2.8908016681671143
Epoch: 5, Steps: 4 | Train Loss: 0.142 Vali Loss: 2.084 Vali Acc: 0.280 Test Loss: 2.084 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0622994899749756
Epoch: 6, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.568 Vali Acc: 0.280 Test Loss: 2.568 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6634109020233154
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.742 Vali Acc: 0.280 Test Loss: 2.742 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9016811847686768
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.972 Vali Acc: 0.280 Test Loss: 2.972 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8480052947998047
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.126 Vali Acc: 0.260 Test Loss: 3.126 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6994166374206543
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.234 Vali Acc: 0.260 Test Loss: 3.234 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6028082370758057
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.294 Vali Acc: 0.240 Test Loss: 3.294 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.632742404937744
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.332 Vali Acc: 0.240 Test Loss: 3.332 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7889273166656494
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.360 Vali Acc: 0.260 Test Loss: 3.360 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.083857536315918
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.385 Vali Acc: 0.260 Test Loss: 3.385 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.318657875061035
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.662 Vali Acc: 0.220 Test Loss: 1.662 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 2.927647829055786
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.682 Vali Acc: 0.220 Test Loss: 1.682 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6075096130371094
Epoch: 3, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.761 Vali Acc: 0.260 Test Loss: 1.761 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259982).  Saving model ...
Epoch: 4 cost time: 2.8667795658111572
Epoch: 4, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.874 Vali Acc: 0.320 Test Loss: 1.874 Test Acc: 0.320
Validation loss decreased (-0.259982 --> -0.319981).  Saving model ...
Epoch: 5 cost time: 2.7680931091308594
Epoch: 5, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.911 Vali Acc: 0.320 Test Loss: 1.911 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.694021701812744
Epoch: 6, Steps: 4 | Train Loss: 0.052 Vali Loss: 2.331 Vali Acc: 0.260 Test Loss: 2.331 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.632276773452759
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.255 Vali Acc: 0.320 Test Loss: 2.255 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.318164110183716
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.430 Vali Acc: 0.320 Test Loss: 2.430 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.991825819015503
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.692 Vali Acc: 0.300 Test Loss: 2.692 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8078207969665527
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.890 Vali Acc: 0.300 Test Loss: 2.890 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6819982528686523
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.020 Vali Acc: 0.300 Test Loss: 3.020 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7112765312194824
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.096 Vali Acc: 0.300 Test Loss: 3.096 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.753919839859009
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.142 Vali Acc: 0.300 Test Loss: 3.142 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.609636068344116
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.152 Vali Acc: 0.300 Test Loss: 3.152 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.522583484649658
Epoch: 1, Steps: 4 | Train Loss: 1.734 Vali Loss: 1.569 Vali Acc: 0.220 Test Loss: 1.569 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.8525397777557373
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.588 Vali Acc: 0.180 Test Loss: 1.588 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4790456295013428
Epoch: 3, Steps: 4 | Train Loss: 1.100 Vali Loss: 1.600 Vali Acc: 0.240 Test Loss: 1.600 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 3.001666307449341
Epoch: 4, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.683 Vali Acc: 0.280 Test Loss: 1.683 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 2.8712692260742188
Epoch: 5, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.723 Vali Acc: 0.300 Test Loss: 1.723 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 2.465078353881836
Epoch: 6, Steps: 4 | Train Loss: 0.077 Vali Loss: 2.028 Vali Acc: 0.280 Test Loss: 2.028 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.691216468811035
Epoch: 7, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.861 Vali Acc: 0.300 Test Loss: 1.861 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.686163902282715
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.905 Vali Acc: 0.260 Test Loss: 1.905 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6576385498046875
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.026 Vali Acc: 0.220 Test Loss: 2.026 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8339173793792725
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.170 Vali Acc: 0.260 Test Loss: 2.170 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6279537677764893
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.289 Vali Acc: 0.240 Test Loss: 2.289 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4955976009368896
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.280 Test Loss: 2.367 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.722858190536499
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.415 Vali Acc: 0.240 Test Loss: 2.415 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.495716094970703
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.427 Vali Acc: 0.260 Test Loss: 2.427 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3487586975097656
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.425 Vali Acc: 0.260 Test Loss: 2.425 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.690476179122925
Epoch: 1, Steps: 4 | Train Loss: 1.735 Vali Loss: 1.623 Vali Acc: 0.140 Test Loss: 1.623 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 2.555213212966919
Epoch: 2, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.658 Vali Acc: 0.140 Test Loss: 1.658 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8822274208068848
Epoch: 3, Steps: 4 | Train Loss: 1.459 Vali Loss: 1.626 Vali Acc: 0.120 Test Loss: 1.626 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7413618564605713
Epoch: 4, Steps: 4 | Train Loss: 0.945 Vali Loss: 1.700 Vali Acc: 0.200 Test Loss: 1.700 Test Acc: 0.200
Validation loss decreased (-0.139984 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 2.65549898147583
Epoch: 5, Steps: 4 | Train Loss: 0.549 Vali Loss: 1.766 Vali Acc: 0.180 Test Loss: 1.766 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2036871910095215
Epoch: 6, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.737 Vali Acc: 0.120 Test Loss: 1.737 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7588367462158203
Epoch: 7, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.864 Vali Acc: 0.120 Test Loss: 1.864 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0396597385406494
Epoch: 8, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.889 Vali Acc: 0.200 Test Loss: 1.889 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7783658504486084
Epoch: 9, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.511 Vali Acc: 0.240 Test Loss: 1.511 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239985).  Saving model ...
Epoch: 10 cost time: 2.6834747791290283
Epoch: 10, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.710 Vali Acc: 0.220 Test Loss: 1.710 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8079745769500732
Epoch: 11, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.124 Vali Acc: 0.240 Test Loss: 2.124 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6625800132751465
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.689 Vali Acc: 0.320 Test Loss: 1.689 Test Acc: 0.320
Validation loss decreased (-0.239985 --> -0.319983).  Saving model ...
Epoch: 13 cost time: 2.522362232208252
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.655 Vali Acc: 0.360 Test Loss: 1.655 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359983).  Saving model ...
Epoch: 14 cost time: 2.866508960723877
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.558 Vali Acc: 0.300 Test Loss: 1.558 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.023336887359619
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.320 Test Loss: 1.631 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.352823257446289
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.280 Test Loss: 1.551 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2855372428894043
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.320 Test Loss: 1.652 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4443328380584717
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.380 Test Loss: 1.724 Test Acc: 0.380
Validation loss decreased (-0.359983 --> -0.379983).  Saving model ...
Epoch: 19 cost time: 3.0580646991729736
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.420 Test Loss: 1.730 Test Acc: 0.420
Validation loss decreased (-0.379983 --> -0.419983).  Saving model ...
Epoch: 20 cost time: 2.6909093856811523
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.320 Test Loss: 1.726 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5752148628234863
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.300 Test Loss: 1.716 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.768592357635498
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.300 Test Loss: 1.679 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.625548839569092
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.300 Test Loss: 1.631 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.894052028656006
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.320 Test Loss: 1.606 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.607706308364868
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.340 Test Loss: 1.595 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4972681999206543
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.380 Test Loss: 1.594 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.933903217315674
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.400 Test Loss: 1.600 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7206642627716064
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.380 Test Loss: 1.610 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5410006046295166
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.380 Test Loss: 1.620 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.440934896469116
Epoch: 1, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.783 Vali Acc: 0.180 Test Loss: 1.783 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 2.4723076820373535
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.883 Vali Acc: 0.200 Test Loss: 1.883 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 2.402730703353882
Epoch: 3, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.838 Vali Acc: 0.180 Test Loss: 1.838 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3860998153686523
Epoch: 4, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.825 Vali Acc: 0.200 Test Loss: 1.825 Test Acc: 0.200
Validation loss decreased (-0.199981 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 2.4414522647857666
Epoch: 5, Steps: 4 | Train Loss: 0.465 Vali Loss: 1.929 Vali Acc: 0.200 Test Loss: 1.929 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6636457443237305
Epoch: 6, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.977 Vali Acc: 0.140 Test Loss: 1.977 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.562192678451538
Epoch: 7, Steps: 4 | Train Loss: 0.127 Vali Loss: 2.017 Vali Acc: 0.200 Test Loss: 2.017 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8860692977905273
Epoch: 8, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.944 Vali Acc: 0.240 Test Loss: 1.944 Test Acc: 0.240
Validation loss decreased (-0.199982 --> -0.239981).  Saving model ...
Epoch: 9 cost time: 2.660162925720215
Epoch: 9, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.877 Vali Acc: 0.200 Test Loss: 1.877 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.836344003677368
Epoch: 10, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.077 Vali Acc: 0.280 Test Loss: 2.077 Test Acc: 0.280
Validation loss decreased (-0.239981 --> -0.279979).  Saving model ...
Epoch: 11 cost time: 2.963792562484741
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.226 Vali Acc: 0.220 Test Loss: 2.226 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6714155673980713
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.116 Vali Acc: 0.300 Test Loss: 2.116 Test Acc: 0.300
Validation loss decreased (-0.279979 --> -0.299979).  Saving model ...
Epoch: 13 cost time: 3.011375904083252
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.065 Vali Acc: 0.300 Test Loss: 2.065 Test Acc: 0.300
Validation loss decreased (-0.299979 --> -0.299979).  Saving model ...
Epoch: 14 cost time: 2.7969813346862793
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.260 Test Loss: 1.993 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5058696269989014
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.954 Vali Acc: 0.280 Test Loss: 1.954 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5952489376068115
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.340 Test Loss: 1.934 Test Acc: 0.340
Validation loss decreased (-0.299979 --> -0.339981).  Saving model ...
Epoch: 17 cost time: 2.883955955505371
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.320 Test Loss: 1.934 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4905686378479004
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.360 Test Loss: 1.948 Test Acc: 0.360
Validation loss decreased (-0.339981 --> -0.359981).  Saving model ...
Epoch: 19 cost time: 2.665536403656006
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.340 Test Loss: 1.965 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.666935682296753
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.320 Test Loss: 1.976 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.87614107131958
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.300 Test Loss: 1.982 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.93288516998291
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.340 Test Loss: 1.997 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.569901466369629
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.340 Test Loss: 2.004 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8663721084594727
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.320 Test Loss: 2.022 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7323009967803955
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.033 Vali Acc: 0.300 Test Loss: 2.033 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.9244182109832764
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.300 Test Loss: 2.041 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4853880405426025
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.340 Test Loss: 2.047 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3679614067077637
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.360 Test Loss: 2.056 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 14840837
model size : 76.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.919234037399292
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.714 Vali Acc: 0.140 Test Loss: 1.714 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 2.7902987003326416
Epoch: 2, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.744 Vali Acc: 0.220 Test Loss: 1.744 Test Acc: 0.220
Validation loss decreased (-0.139983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 2.927569627761841
Epoch: 3, Steps: 4 | Train Loss: 1.007 Vali Loss: 1.759 Vali Acc: 0.260 Test Loss: 1.759 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259982).  Saving model ...
Epoch: 4 cost time: 2.6261560916900635
Epoch: 4, Steps: 4 | Train Loss: 0.369 Vali Loss: 2.025 Vali Acc: 0.280 Test Loss: 2.025 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279980).  Saving model ...
Epoch: 5 cost time: 3.0528624057769775
Epoch: 5, Steps: 4 | Train Loss: 0.166 Vali Loss: 2.265 Vali Acc: 0.280 Test Loss: 2.265 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6016781330108643
Epoch: 6, Steps: 4 | Train Loss: 0.068 Vali Loss: 2.263 Vali Acc: 0.300 Test Loss: 2.263 Test Acc: 0.300
Validation loss decreased (-0.279980 --> -0.299977).  Saving model ...
Epoch: 7 cost time: 2.821086883544922
Epoch: 7, Steps: 4 | Train Loss: 0.036 Vali Loss: 2.620 Vali Acc: 0.320 Test Loss: 2.620 Test Acc: 0.320
Validation loss decreased (-0.299977 --> -0.319974).  Saving model ...
Epoch: 8 cost time: 2.850363254547119
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.956 Vali Acc: 0.360 Test Loss: 2.956 Test Acc: 0.360
Validation loss decreased (-0.319974 --> -0.359970).  Saving model ...
Epoch: 9 cost time: 3.0702064037323
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.126 Vali Acc: 0.340 Test Loss: 3.126 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8182835578918457
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.274 Vali Acc: 0.340 Test Loss: 3.274 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.999136447906494
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.534 Vali Acc: 0.300 Test Loss: 3.534 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0040366649627686
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.768 Vali Acc: 0.320 Test Loss: 3.768 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.025458574295044
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.883 Vali Acc: 0.300 Test Loss: 3.883 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9175474643707275
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.917 Vali Acc: 0.300 Test Loss: 3.917 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0984954833984375
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.879 Vali Acc: 0.300 Test Loss: 3.879 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.073920249938965
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.796 Vali Acc: 0.300 Test Loss: 3.796 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.161423444747925
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.724 Vali Acc: 0.320 Test Loss: 3.724 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.836360216140747
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.670 Vali Acc: 0.320 Test Loss: 3.670 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.568664789199829
Epoch: 1, Steps: 4 | Train Loss: 1.732 Vali Loss: 1.733 Vali Acc: 0.160 Test Loss: 1.733 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.460364818572998
Epoch: 2, Steps: 4 | Train Loss: 1.509 Vali Loss: 1.739 Vali Acc: 0.240 Test Loss: 1.739 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 3.1703286170959473
Epoch: 3, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.738 Vali Acc: 0.280 Test Loss: 1.738 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 2.9958038330078125
Epoch: 4, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.973 Vali Acc: 0.280 Test Loss: 1.973 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.926081657409668
Epoch: 5, Steps: 4 | Train Loss: 0.170 Vali Loss: 2.175 Vali Acc: 0.260 Test Loss: 2.175 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9743881225585938
Epoch: 6, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.138 Vali Acc: 0.300 Test Loss: 2.138 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299979).  Saving model ...
Epoch: 7 cost time: 3.1578774452209473
Epoch: 7, Steps: 4 | Train Loss: 0.037 Vali Loss: 2.461 Vali Acc: 0.360 Test Loss: 2.461 Test Acc: 0.360
Validation loss decreased (-0.299979 --> -0.359975).  Saving model ...
Epoch: 8 cost time: 2.869475841522217
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.855 Vali Acc: 0.300 Test Loss: 2.855 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1361477375030518
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.035 Vali Acc: 0.320 Test Loss: 3.035 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.77901554107666
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.130 Vali Acc: 0.340 Test Loss: 3.130 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9279067516326904
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.298 Vali Acc: 0.340 Test Loss: 3.298 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.535585641860962
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.459 Vali Acc: 0.320 Test Loss: 3.459 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.622673988342285
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.534 Vali Acc: 0.320 Test Loss: 3.534 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.901202917098999
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.556 Vali Acc: 0.320 Test Loss: 3.556 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.965851306915283
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.520 Vali Acc: 0.320 Test Loss: 3.520 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8482155799865723
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.445 Vali Acc: 0.320 Test Loss: 3.445 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5766990184783936
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.384 Vali Acc: 0.300 Test Loss: 3.384 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.774264574050903
Epoch: 1, Steps: 4 | Train Loss: 1.730 Vali Loss: 1.715 Vali Acc: 0.180 Test Loss: 1.715 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.7656261920928955
Epoch: 2, Steps: 4 | Train Loss: 1.464 Vali Loss: 1.742 Vali Acc: 0.280 Test Loss: 1.742 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 2.798179864883423
Epoch: 3, Steps: 4 | Train Loss: 0.980 Vali Loss: 1.765 Vali Acc: 0.260 Test Loss: 1.765 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8369789123535156
Epoch: 4, Steps: 4 | Train Loss: 0.362 Vali Loss: 2.092 Vali Acc: 0.280 Test Loss: 2.092 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.029452323913574
Epoch: 5, Steps: 4 | Train Loss: 0.168 Vali Loss: 2.377 Vali Acc: 0.280 Test Loss: 2.377 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.68108868598938
Epoch: 6, Steps: 4 | Train Loss: 0.076 Vali Loss: 2.173 Vali Acc: 0.260 Test Loss: 2.173 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.719816207885742
Epoch: 7, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.523 Vali Acc: 0.320 Test Loss: 2.523 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319975).  Saving model ...
Epoch: 8 cost time: 2.735199451446533
Epoch: 8, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.052 Vali Acc: 0.280 Test Loss: 3.052 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.015511989593506
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.351 Vali Acc: 0.280 Test Loss: 3.351 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0451576709747314
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.428 Vali Acc: 0.260 Test Loss: 3.428 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.895731210708618
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.461 Vali Acc: 0.340 Test Loss: 3.461 Test Acc: 0.340
Validation loss decreased (-0.319975 --> -0.339965).  Saving model ...
Epoch: 12 cost time: 2.6649856567382812
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.497 Vali Acc: 0.320 Test Loss: 3.497 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.711782217025757
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.487 Vali Acc: 0.300 Test Loss: 3.487 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.419978141784668
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.494 Vali Acc: 0.320 Test Loss: 3.494 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.852109909057617
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.496 Vali Acc: 0.280 Test Loss: 3.496 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5539305210113525
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.485 Vali Acc: 0.300 Test Loss: 3.485 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0730466842651367
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.480 Vali Acc: 0.300 Test Loss: 3.480 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9206461906433105
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.476 Vali Acc: 0.300 Test Loss: 3.476 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7443630695343018
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.476 Vali Acc: 0.300 Test Loss: 3.476 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.162660598754883
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.474 Vali Acc: 0.300 Test Loss: 3.474 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.927154064178467
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.474 Vali Acc: 0.300 Test Loss: 3.474 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.183947324752808
Epoch: 1, Steps: 4 | Train Loss: 1.728 Vali Loss: 1.691 Vali Acc: 0.200 Test Loss: 1.691 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.527606725692749
Epoch: 2, Steps: 4 | Train Loss: 1.483 Vali Loss: 1.733 Vali Acc: 0.200 Test Loss: 1.733 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8199286460876465
Epoch: 3, Steps: 4 | Train Loss: 1.009 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.6032915115356445
Epoch: 4, Steps: 4 | Train Loss: 0.352 Vali Loss: 2.058 Vali Acc: 0.320 Test Loss: 2.058 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319979).  Saving model ...
Epoch: 5 cost time: 2.637566328048706
Epoch: 5, Steps: 4 | Train Loss: 0.147 Vali Loss: 2.203 Vali Acc: 0.260 Test Loss: 2.203 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.772007465362549
Epoch: 6, Steps: 4 | Train Loss: 0.068 Vali Loss: 2.072 Vali Acc: 0.320 Test Loss: 2.072 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.508856773376465
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.462 Vali Acc: 0.320 Test Loss: 2.462 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7872095108032227
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.891 Vali Acc: 0.300 Test Loss: 2.891 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8602256774902344
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.185 Vali Acc: 0.260 Test Loss: 3.185 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.720078229904175
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.292 Vali Acc: 0.240 Test Loss: 3.292 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.945979595184326
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.264 Vali Acc: 0.300 Test Loss: 3.264 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5753417015075684
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.221 Vali Acc: 0.300 Test Loss: 3.221 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7565414905548096
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.163 Vali Acc: 0.300 Test Loss: 3.163 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8206593990325928
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.149 Vali Acc: 0.300 Test Loss: 3.149 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.677659273147583
Epoch: 1, Steps: 4 | Train Loss: 1.717 Vali Loss: 1.641 Vali Acc: 0.280 Test Loss: 1.641 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 2.3836259841918945
Epoch: 2, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.659 Vali Acc: 0.280 Test Loss: 1.659 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5459775924682617
Epoch: 3, Steps: 4 | Train Loss: 0.920 Vali Loss: 1.710 Vali Acc: 0.300 Test Loss: 1.710 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.786959171295166
Epoch: 4, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.943 Vali Acc: 0.300 Test Loss: 1.943 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7004740238189697
Epoch: 5, Steps: 4 | Train Loss: 0.133 Vali Loss: 2.103 Vali Acc: 0.220 Test Loss: 2.103 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9139456748962402
Epoch: 6, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.089 Vali Acc: 0.240 Test Loss: 2.089 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4141743183135986
Epoch: 7, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.398 Vali Acc: 0.240 Test Loss: 2.398 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.883716583251953
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.896 Vali Acc: 0.240 Test Loss: 2.896 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3194117546081543
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.209 Vali Acc: 0.240 Test Loss: 3.209 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7772440910339355
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.296 Vali Acc: 0.260 Test Loss: 3.296 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.492319107055664
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.265 Vali Acc: 0.260 Test Loss: 3.265 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.625525951385498
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.218 Vali Acc: 0.260 Test Loss: 3.218 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3687031269073486
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.173 Vali Acc: 0.260 Test Loss: 3.173 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.8153581619262695
Epoch: 1, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.739 Vali Acc: 0.160 Test Loss: 1.739 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.4457943439483643
Epoch: 2, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.771 Vali Acc: 0.280 Test Loss: 1.771 Test Acc: 0.280
Validation loss decreased (-0.159983 --> -0.279982).  Saving model ...
Epoch: 3 cost time: 2.817732572555542
Epoch: 3, Steps: 4 | Train Loss: 0.961 Vali Loss: 1.790 Vali Acc: 0.260 Test Loss: 1.790 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5207912921905518
Epoch: 4, Steps: 4 | Train Loss: 0.329 Vali Loss: 2.119 Vali Acc: 0.220 Test Loss: 2.119 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.85453200340271
Epoch: 5, Steps: 4 | Train Loss: 0.128 Vali Loss: 2.313 Vali Acc: 0.240 Test Loss: 2.313 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.525481939315796
Epoch: 6, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.356 Vali Acc: 0.300 Test Loss: 2.356 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299976).  Saving model ...
Epoch: 7 cost time: 2.9704697132110596
Epoch: 7, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.741 Vali Acc: 0.260 Test Loss: 2.741 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.557417631149292
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.223 Vali Acc: 0.240 Test Loss: 3.223 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5589065551757812
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.457 Vali Acc: 0.240 Test Loss: 3.457 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7139227390289307
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.550 Vali Acc: 0.280 Test Loss: 3.550 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.539048433303833
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.565 Vali Acc: 0.280 Test Loss: 3.565 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7982704639434814
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.565 Vali Acc: 0.260 Test Loss: 3.565 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.922664165496826
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.564 Vali Acc: 0.260 Test Loss: 3.564 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.638017177581787
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.563 Vali Acc: 0.260 Test Loss: 3.563 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8454983234405518
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.558 Vali Acc: 0.260 Test Loss: 3.558 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4906058311462402
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.544 Vali Acc: 0.280 Test Loss: 3.544 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.8538782596588135
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.747 Vali Acc: 0.160 Test Loss: 1.747 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.4740657806396484
Epoch: 2, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.745 Vali Acc: 0.240 Test Loss: 1.745 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 2.5004184246063232
Epoch: 3, Steps: 4 | Train Loss: 0.979 Vali Loss: 1.745 Vali Acc: 0.280 Test Loss: 1.745 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 2.438687801361084
Epoch: 4, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.056 Vali Acc: 0.260 Test Loss: 2.056 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.755835771560669
Epoch: 5, Steps: 4 | Train Loss: 0.144 Vali Loss: 2.053 Vali Acc: 0.200 Test Loss: 2.053 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.60978364944458
Epoch: 6, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.211 Vali Acc: 0.240 Test Loss: 2.211 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.627718687057495
Epoch: 7, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.549 Vali Acc: 0.260 Test Loss: 2.549 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5858688354492188
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.936 Vali Acc: 0.240 Test Loss: 2.936 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.503359079360962
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.081 Vali Acc: 0.300 Test Loss: 3.081 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299969).  Saving model ...
Epoch: 10 cost time: 2.4219512939453125
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.139 Vali Acc: 0.320 Test Loss: 3.139 Test Acc: 0.320
Validation loss decreased (-0.299969 --> -0.319969).  Saving model ...
Epoch: 11 cost time: 2.5303702354431152
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.125 Vali Acc: 0.280 Test Loss: 3.125 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.588048219680786
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.098 Vali Acc: 0.300 Test Loss: 3.098 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5237252712249756
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.070 Vali Acc: 0.260 Test Loss: 3.070 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.69545578956604
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.045 Vali Acc: 0.280 Test Loss: 3.045 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.843100070953369
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.021 Vali Acc: 0.280 Test Loss: 3.021 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6927597522735596
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.993 Vali Acc: 0.280 Test Loss: 2.993 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.492982864379883
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.974 Vali Acc: 0.280 Test Loss: 2.974 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8510379791259766
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.964 Vali Acc: 0.280 Test Loss: 2.964 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.74049973487854
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.957 Vali Acc: 0.280 Test Loss: 2.957 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.710604190826416
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.955 Vali Acc: 0.280 Test Loss: 2.955 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.2491724491119385
Epoch: 1, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.701 Vali Acc: 0.240 Test Loss: 1.701 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.63942289352417
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.716 Vali Acc: 0.240 Test Loss: 1.716 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.575263500213623
Epoch: 3, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.665 Vali Acc: 0.240 Test Loss: 1.665 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 2.5779478549957275
Epoch: 4, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.843 Vali Acc: 0.220 Test Loss: 1.843 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8098349571228027
Epoch: 5, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.803 Vali Acc: 0.380 Test Loss: 1.803 Test Acc: 0.380
Validation loss decreased (-0.239983 --> -0.379982).  Saving model ...
Epoch: 6 cost time: 2.3621222972869873
Epoch: 6, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.983 Vali Acc: 0.300 Test Loss: 1.983 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7555575370788574
Epoch: 7, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.247 Vali Acc: 0.300 Test Loss: 2.247 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4567980766296387
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.400 Vali Acc: 0.240 Test Loss: 2.400 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.543118715286255
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.396 Vali Acc: 0.320 Test Loss: 2.396 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.393380880355835
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.348 Vali Acc: 0.280 Test Loss: 2.348 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.447303533554077
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.271 Vali Acc: 0.340 Test Loss: 2.271 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.52282977104187
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.380 Test Loss: 2.221 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4914238452911377
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.189 Vali Acc: 0.360 Test Loss: 2.189 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.475353479385376
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.400 Test Loss: 2.173 Test Acc: 0.400
Validation loss decreased (-0.379982 --> -0.399978).  Saving model ...
Epoch: 15 cost time: 2.860494375228882
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.169 Vali Acc: 0.400 Test Loss: 2.169 Test Acc: 0.400
Validation loss decreased (-0.399978 --> -0.399978).  Saving model ...
Epoch: 16 cost time: 2.802137851715088
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.169 Vali Acc: 0.420 Test Loss: 2.169 Test Acc: 0.420
Validation loss decreased (-0.399978 --> -0.419978).  Saving model ...
Epoch: 17 cost time: 2.7164220809936523
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.177 Vali Acc: 0.420 Test Loss: 2.177 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7717182636260986
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.190 Vali Acc: 0.400 Test Loss: 2.190 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6368682384490967
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.380 Test Loss: 2.204 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.735644578933716
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.218 Vali Acc: 0.360 Test Loss: 2.218 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.9389193058013916
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.234 Vali Acc: 0.360 Test Loss: 2.234 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6688170433044434
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.250 Vali Acc: 0.380 Test Loss: 2.250 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.656860589981079
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.265 Vali Acc: 0.380 Test Loss: 2.265 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.602830410003662
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.280 Vali Acc: 0.380 Test Loss: 2.280 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.555537462234497
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.360 Test Loss: 2.292 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.508683919906616
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.309 Vali Acc: 0.360 Test Loss: 2.309 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.693188905715942
Epoch: 1, Steps: 4 | Train Loss: 1.784 Vali Loss: 1.692 Vali Acc: 0.120 Test Loss: 1.692 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 2.670560359954834
Epoch: 2, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.725 Vali Acc: 0.200 Test Loss: 1.725 Test Acc: 0.200
Validation loss decreased (-0.119983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 2.6953201293945312
Epoch: 3, Steps: 4 | Train Loss: 1.207 Vali Loss: 1.702 Vali Acc: 0.120 Test Loss: 1.702 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7929458618164062
Epoch: 4, Steps: 4 | Train Loss: 0.759 Vali Loss: 1.806 Vali Acc: 0.200 Test Loss: 1.806 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.691682815551758
Epoch: 5, Steps: 4 | Train Loss: 0.489 Vali Loss: 1.733 Vali Acc: 0.080 Test Loss: 1.733 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5485589504241943
Epoch: 6, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.722 Vali Acc: 0.140 Test Loss: 1.722 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4170572757720947
Epoch: 7, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.984 Vali Acc: 0.220 Test Loss: 1.984 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219980).  Saving model ...
Epoch: 8 cost time: 2.32940673828125
Epoch: 8, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.916 Vali Acc: 0.160 Test Loss: 1.916 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1943790912628174
Epoch: 9, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.755 Vali Acc: 0.220 Test Loss: 1.755 Test Acc: 0.220
Validation loss decreased (-0.219980 --> -0.219982).  Saving model ...
Epoch: 10 cost time: 2.3723363876342773
Epoch: 10, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.737 Vali Acc: 0.220 Test Loss: 1.737 Test Acc: 0.220
Validation loss decreased (-0.219982 --> -0.219983).  Saving model ...
Epoch: 11 cost time: 2.509514570236206
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.649 Vali Acc: 0.260 Test Loss: 1.649 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259984).  Saving model ...
Epoch: 12 cost time: 2.6480534076690674
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.623 Vali Acc: 0.280 Test Loss: 1.623 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 13 cost time: 2.795612096786499
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.584 Vali Acc: 0.300 Test Loss: 1.584 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 14 cost time: 2.4388341903686523
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.591 Vali Acc: 0.340 Test Loss: 1.591 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 15 cost time: 3.0112099647521973
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.280 Test Loss: 1.601 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8891496658325195
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.320 Test Loss: 1.599 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.554323434829712
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.320 Test Loss: 1.606 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.817984104156494
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.320 Test Loss: 1.622 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4310708045959473
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.340 Test Loss: 1.625 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.674332618713379
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.340 Test Loss: 1.628 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7020020484924316
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.300 Test Loss: 1.637 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5687594413757324
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.320 Test Loss: 1.657 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8067944049835205
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.320 Test Loss: 1.666 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5359506607055664
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.300 Test Loss: 1.669 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.745660305023193
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.623 Vali Acc: 0.160 Test Loss: 1.623 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.9596810340881348
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.657 Vali Acc: 0.180 Test Loss: 1.657 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 2.6317505836486816
Epoch: 3, Steps: 4 | Train Loss: 1.234 Vali Loss: 1.646 Vali Acc: 0.160 Test Loss: 1.646 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.805527687072754
Epoch: 4, Steps: 4 | Train Loss: 0.703 Vali Loss: 1.765 Vali Acc: 0.140 Test Loss: 1.765 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.091845989227295
Epoch: 5, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.652 Vali Acc: 0.180 Test Loss: 1.652 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179983).  Saving model ...
Epoch: 6 cost time: 2.161823272705078
Epoch: 6, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.666 Vali Acc: 0.180 Test Loss: 1.666 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.216042995452881
Epoch: 7, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.890 Vali Acc: 0.180 Test Loss: 1.890 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.74570631980896
Epoch: 8, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.857 Vali Acc: 0.200 Test Loss: 1.857 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199981).  Saving model ...
Epoch: 9 cost time: 2.928230047225952
Epoch: 9, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.763 Vali Acc: 0.200 Test Loss: 1.763 Test Acc: 0.200
Validation loss decreased (-0.199981 --> -0.199982).  Saving model ...
Epoch: 10 cost time: 2.9993019104003906
Epoch: 10, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.813 Vali Acc: 0.200 Test Loss: 1.813 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.545091390609741
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.771 Vali Acc: 0.220 Test Loss: 1.771 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219982).  Saving model ...
Epoch: 12 cost time: 2.912304162979126
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.745 Vali Acc: 0.240 Test Loss: 1.745 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239983).  Saving model ...
Epoch: 13 cost time: 2.659510850906372
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.260 Test Loss: 1.771 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259982).  Saving model ...
Epoch: 14 cost time: 2.419323205947876
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.280 Test Loss: 1.830 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279982).  Saving model ...
Epoch: 15 cost time: 2.4666121006011963
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.380 Test Loss: 1.869 Test Acc: 0.380
Validation loss decreased (-0.279982 --> -0.379981).  Saving model ...
Epoch: 16 cost time: 2.419935703277588
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.320 Test Loss: 1.876 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.187004327774048
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.360 Test Loss: 1.855 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4010777473449707
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.340 Test Loss: 1.817 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.313539981842041
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.320 Test Loss: 1.786 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3749706745147705
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.280 Test Loss: 1.769 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7725818157196045
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.260 Test Loss: 1.767 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3996810913085938
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.240 Test Loss: 1.776 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5287060737609863
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.240 Test Loss: 1.798 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.925459384918213
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.280 Test Loss: 1.822 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7034125328063965
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.260 Test Loss: 1.842 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 14054405
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.437175273895264
Epoch: 1, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.698 Vali Acc: 0.220 Test Loss: 1.698 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 3.2677459716796875
Epoch: 2, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.702 Vali Acc: 0.180 Test Loss: 1.702 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.987084150314331
Epoch: 3, Steps: 4 | Train Loss: 0.800 Vali Loss: 1.668 Vali Acc: 0.300 Test Loss: 1.668 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.786175012588501
Epoch: 4, Steps: 4 | Train Loss: 0.449 Vali Loss: 2.010 Vali Acc: 0.240 Test Loss: 2.010 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1980597972869873
Epoch: 5, Steps: 4 | Train Loss: 0.385 Vali Loss: 2.051 Vali Acc: 0.360 Test Loss: 2.051 Test Acc: 0.360
Validation loss decreased (-0.299983 --> -0.359979).  Saving model ...
Epoch: 6 cost time: 3.0408854484558105
Epoch: 6, Steps: 4 | Train Loss: 0.077 Vali Loss: 2.073 Vali Acc: 0.340 Test Loss: 2.073 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8270623683929443
Epoch: 7, Steps: 4 | Train Loss: 0.072 Vali Loss: 2.641 Vali Acc: 0.260 Test Loss: 2.641 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1703758239746094
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.707 Vali Acc: 0.320 Test Loss: 2.707 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.854598045349121
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.815 Vali Acc: 0.320 Test Loss: 2.815 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.071427345275879
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.069 Vali Acc: 0.300 Test Loss: 3.069 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0382089614868164
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.274 Vali Acc: 0.340 Test Loss: 3.274 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.692003011703491
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.156 Vali Acc: 0.340 Test Loss: 3.156 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0833868980407715
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.206 Vali Acc: 0.300 Test Loss: 3.206 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9675614833831787
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.290 Vali Acc: 0.320 Test Loss: 3.290 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8150346279144287
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.319 Vali Acc: 0.320 Test Loss: 3.319 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.896011590957642
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.704 Vali Acc: 0.200 Test Loss: 1.704 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.9398648738861084
Epoch: 2, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.675 Vali Acc: 0.180 Test Loss: 1.675 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6832540035247803
Epoch: 3, Steps: 4 | Train Loss: 0.818 Vali Loss: 1.638 Vali Acc: 0.280 Test Loss: 1.638 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 3.0151009559631348
Epoch: 4, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.981 Vali Acc: 0.240 Test Loss: 1.981 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6218795776367188
Epoch: 5, Steps: 4 | Train Loss: 0.361 Vali Loss: 1.969 Vali Acc: 0.320 Test Loss: 1.969 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319980).  Saving model ...
Epoch: 6 cost time: 2.532935619354248
Epoch: 6, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.945 Vali Acc: 0.320 Test Loss: 1.945 Test Acc: 0.320
Validation loss decreased (-0.319980 --> -0.319981).  Saving model ...
Epoch: 7 cost time: 2.46608567237854
Epoch: 7, Steps: 4 | Train Loss: 0.071 Vali Loss: 2.504 Vali Acc: 0.260 Test Loss: 2.504 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.516068696975708
Epoch: 8, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.477 Vali Acc: 0.280 Test Loss: 2.477 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.130373239517212
Epoch: 9, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.605 Vali Acc: 0.320 Test Loss: 2.605 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.523470640182495
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.928 Vali Acc: 0.300 Test Loss: 2.928 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.317966938018799
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.057 Vali Acc: 0.300 Test Loss: 3.057 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.587311267852783
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.836 Vali Acc: 0.300 Test Loss: 2.836 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.637838125228882
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.011 Vali Acc: 0.280 Test Loss: 3.011 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2453272342681885
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.147 Vali Acc: 0.280 Test Loss: 3.147 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9028069972991943
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.091 Vali Acc: 0.280 Test Loss: 3.091 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8555660247802734
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.006 Vali Acc: 0.280 Test Loss: 3.006 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.031427621841431
Epoch: 1, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.733 Vali Acc: 0.280 Test Loss: 1.733 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 2.739288091659546
Epoch: 2, Steps: 4 | Train Loss: 1.486 Vali Loss: 1.719 Vali Acc: 0.160 Test Loss: 1.719 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.629725456237793
Epoch: 3, Steps: 4 | Train Loss: 0.806 Vali Loss: 1.677 Vali Acc: 0.320 Test Loss: 1.677 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 2.9921884536743164
Epoch: 4, Steps: 4 | Train Loss: 0.411 Vali Loss: 2.078 Vali Acc: 0.300 Test Loss: 2.078 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.782885789871216
Epoch: 5, Steps: 4 | Train Loss: 0.384 Vali Loss: 2.170 Vali Acc: 0.280 Test Loss: 2.170 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6506521701812744
Epoch: 6, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.031 Vali Acc: 0.320 Test Loss: 2.031 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7200324535369873
Epoch: 7, Steps: 4 | Train Loss: 0.055 Vali Loss: 2.586 Vali Acc: 0.300 Test Loss: 2.586 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0358524322509766
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.732 Vali Acc: 0.280 Test Loss: 2.732 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7143943309783936
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.921 Vali Acc: 0.260 Test Loss: 2.921 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5099918842315674
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.187 Vali Acc: 0.280 Test Loss: 3.187 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4674174785614014
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.330 Vali Acc: 0.300 Test Loss: 3.330 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.882870674133301
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.300 Test Loss: 3.159 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.660749673843384
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.151 Vali Acc: 0.280 Test Loss: 3.151 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.9926018714904785
Epoch: 1, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.751 Vali Acc: 0.280 Test Loss: 1.751 Test Acc: 0.280
Validation loss decreased (inf --> -0.279982).  Saving model ...
Epoch: 2 cost time: 2.8752713203430176
Epoch: 2, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.715 Vali Acc: 0.240 Test Loss: 1.715 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9357168674468994
Epoch: 3, Steps: 4 | Train Loss: 0.824 Vali Loss: 1.688 Vali Acc: 0.340 Test Loss: 1.688 Test Acc: 0.340
Validation loss decreased (-0.279982 --> -0.339983).  Saving model ...
Epoch: 4 cost time: 2.800319194793701
Epoch: 4, Steps: 4 | Train Loss: 0.401 Vali Loss: 2.056 Vali Acc: 0.280 Test Loss: 2.056 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4643478393554688
Epoch: 5, Steps: 4 | Train Loss: 0.340 Vali Loss: 2.100 Vali Acc: 0.300 Test Loss: 2.100 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7242536544799805
Epoch: 6, Steps: 4 | Train Loss: 0.057 Vali Loss: 2.071 Vali Acc: 0.320 Test Loss: 2.071 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8129351139068604
Epoch: 7, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.555 Vali Acc: 0.280 Test Loss: 2.555 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.713571786880493
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.740 Vali Acc: 0.300 Test Loss: 2.740 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.58687686920166
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.806 Vali Acc: 0.320 Test Loss: 2.806 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0141525268554688
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.775 Vali Acc: 0.340 Test Loss: 2.775 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9335250854492188
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.902 Vali Acc: 0.320 Test Loss: 2.902 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9035000801086426
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.048 Vali Acc: 0.280 Test Loss: 3.048 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8942267894744873
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.260 Test Loss: 3.170 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.468451261520386
Epoch: 1, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.671 Vali Acc: 0.240 Test Loss: 1.671 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.762892007827759
Epoch: 2, Steps: 4 | Train Loss: 1.476 Vali Loss: 1.639 Vali Acc: 0.220 Test Loss: 1.639 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8792991638183594
Epoch: 3, Steps: 4 | Train Loss: 0.772 Vali Loss: 1.658 Vali Acc: 0.300 Test Loss: 1.658 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.8085672855377197
Epoch: 4, Steps: 4 | Train Loss: 0.373 Vali Loss: 1.980 Vali Acc: 0.260 Test Loss: 1.980 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8935513496398926
Epoch: 5, Steps: 4 | Train Loss: 0.281 Vali Loss: 2.121 Vali Acc: 0.300 Test Loss: 2.121 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.820517063140869
Epoch: 6, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.034 Vali Acc: 0.220 Test Loss: 2.034 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.769879102706909
Epoch: 7, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.424 Vali Acc: 0.220 Test Loss: 2.424 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.663417100906372
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.530 Vali Acc: 0.260 Test Loss: 2.530 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.07483172416687
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.659 Vali Acc: 0.280 Test Loss: 2.659 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8173885345458984
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.814 Vali Acc: 0.280 Test Loss: 2.814 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.0595383644104004
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.961 Vali Acc: 0.300 Test Loss: 2.961 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5200576782226562
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.084 Vali Acc: 0.300 Test Loss: 3.084 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.767742872238159
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.260 Test Loss: 3.170 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.188406944274902
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.623 Vali Acc: 0.300 Test Loss: 1.623 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.5351943969726562
Epoch: 2, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.567 Vali Acc: 0.260 Test Loss: 1.567 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.791863441467285
Epoch: 3, Steps: 4 | Train Loss: 0.794 Vali Loss: 1.652 Vali Acc: 0.320 Test Loss: 1.652 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 2.6729376316070557
Epoch: 4, Steps: 4 | Train Loss: 0.357 Vali Loss: 2.063 Vali Acc: 0.300 Test Loss: 2.063 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.715634822845459
Epoch: 5, Steps: 4 | Train Loss: 0.237 Vali Loss: 2.146 Vali Acc: 0.300 Test Loss: 2.146 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7246005535125732
Epoch: 6, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.142 Vali Acc: 0.300 Test Loss: 2.142 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6537585258483887
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.544 Vali Acc: 0.300 Test Loss: 2.544 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.389559745788574
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.976 Vali Acc: 0.280 Test Loss: 2.976 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.550964832305908
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.365 Vali Acc: 0.260 Test Loss: 3.365 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5490643978118896
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.570 Vali Acc: 0.260 Test Loss: 3.570 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.263477325439453
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.660 Vali Acc: 0.240 Test Loss: 3.660 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6327357292175293
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.688 Vali Acc: 0.260 Test Loss: 3.688 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3424019813537598
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.680 Vali Acc: 0.240 Test Loss: 3.680 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.6595165729522705
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.674 Vali Acc: 0.180 Test Loss: 1.674 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.7818527221679688
Epoch: 2, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.599 Vali Acc: 0.280 Test Loss: 1.599 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.9190328121185303
Epoch: 3, Steps: 4 | Train Loss: 0.867 Vali Loss: 1.641 Vali Acc: 0.320 Test Loss: 1.641 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 2.8999156951904297
Epoch: 4, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.987 Vali Acc: 0.240 Test Loss: 1.987 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.690971612930298
Epoch: 5, Steps: 4 | Train Loss: 0.205 Vali Loss: 2.026 Vali Acc: 0.260 Test Loss: 2.026 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7808876037597656
Epoch: 6, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.054 Vali Acc: 0.360 Test Loss: 2.054 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359979).  Saving model ...
Epoch: 7 cost time: 2.1818695068359375
Epoch: 7, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.419 Vali Acc: 0.320 Test Loss: 2.419 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7775509357452393
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.729 Vali Acc: 0.300 Test Loss: 2.729 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.537625551223755
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.951 Vali Acc: 0.260 Test Loss: 2.951 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5969626903533936
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.054 Vali Acc: 0.260 Test Loss: 3.054 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.658576011657715
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.103 Vali Acc: 0.300 Test Loss: 3.103 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.920506000518799
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.128 Vali Acc: 0.280 Test Loss: 3.128 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.609212875366211
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.132 Vali Acc: 0.280 Test Loss: 3.132 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8847763538360596
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.135 Vali Acc: 0.260 Test Loss: 3.135 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.71750545501709
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.131 Vali Acc: 0.280 Test Loss: 3.131 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8429949283599854
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.117 Vali Acc: 0.280 Test Loss: 3.117 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.3483216762542725
Epoch: 1, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.8254642486572266
Epoch: 2, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.607 Vali Acc: 0.200 Test Loss: 1.607 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6092233657836914
Epoch: 3, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.600 Vali Acc: 0.260 Test Loss: 1.600 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 2.570119857788086
Epoch: 4, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.784 Vali Acc: 0.300 Test Loss: 1.784 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299982).  Saving model ...
Epoch: 5 cost time: 2.2742886543273926
Epoch: 5, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
Validation loss decreased (-0.299982 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 2.6361610889434814
Epoch: 6, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.730 Vali Acc: 0.320 Test Loss: 1.730 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 2.517606258392334
Epoch: 7, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.973 Vali Acc: 0.260 Test Loss: 1.973 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.65177059173584
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.290 Vali Acc: 0.280 Test Loss: 2.290 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7719500064849854
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.381 Vali Acc: 0.320 Test Loss: 2.381 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6209990978240967
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.400 Vali Acc: 0.280 Test Loss: 2.400 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6219794750213623
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.280 Test Loss: 2.432 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.47526478767395
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.260 Test Loss: 2.456 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.615865707397461
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.260 Test Loss: 2.455 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2540090084075928
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.439 Vali Acc: 0.260 Test Loss: 2.439 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4479432106018066
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.421 Vali Acc: 0.240 Test Loss: 2.421 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.41570782661438
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.260 Test Loss: 2.402 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.9628448486328125
Epoch: 1, Steps: 4 | Train Loss: 1.614 Vali Loss: 1.709 Vali Acc: 0.100 Test Loss: 1.709 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 2.617537498474121
Epoch: 2, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.640 Vali Acc: 0.140 Test Loss: 1.640 Test Acc: 0.140
Validation loss decreased (-0.099983 --> -0.139984).  Saving model ...
Epoch: 3 cost time: 2.647318124771118
Epoch: 3, Steps: 4 | Train Loss: 1.166 Vali Loss: 1.643 Vali Acc: 0.140 Test Loss: 1.643 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.471133232116699
Epoch: 4, Steps: 4 | Train Loss: 0.787 Vali Loss: 1.771 Vali Acc: 0.220 Test Loss: 1.771 Test Acc: 0.220
Validation loss decreased (-0.139984 --> -0.219982).  Saving model ...
Epoch: 5 cost time: 2.200538158416748
Epoch: 5, Steps: 4 | Train Loss: 0.538 Vali Loss: 1.741 Vali Acc: 0.200 Test Loss: 1.741 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2946653366088867
Epoch: 6, Steps: 4 | Train Loss: 0.272 Vali Loss: 1.758 Vali Acc: 0.240 Test Loss: 1.758 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239982).  Saving model ...
Epoch: 7 cost time: 2.4814000129699707
Epoch: 7, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
Validation loss decreased (-0.239982 --> -0.239983).  Saving model ...
Epoch: 8 cost time: 2.60233211517334
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.917 Vali Acc: 0.280 Test Loss: 1.917 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279981).  Saving model ...
Epoch: 9 cost time: 2.242461681365967
Epoch: 9, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.769 Vali Acc: 0.320 Test Loss: 1.769 Test Acc: 0.320
Validation loss decreased (-0.279981 --> -0.319982).  Saving model ...
Epoch: 10 cost time: 2.9926347732543945
Epoch: 10, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.643 Vali Acc: 0.300 Test Loss: 1.643 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7208375930786133
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.853 Vali Acc: 0.320 Test Loss: 1.853 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8205456733703613
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9402987957000732
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.600 Vali Acc: 0.320 Test Loss: 1.600 Test Acc: 0.320
Validation loss decreased (-0.319982 --> -0.319984).  Saving model ...
Epoch: 14 cost time: 2.5444107055664062
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9515419006347656
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.300 Test Loss: 1.664 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6479780673980713
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.300 Test Loss: 1.594 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0334794521331787
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.320 Test Loss: 1.514 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 18 cost time: 2.8223249912261963
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.300 Test Loss: 1.469 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.802431583404541
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.300 Test Loss: 1.476 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.736063003540039
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.499 Vali Acc: 0.300 Test Loss: 1.499 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.811662197113037
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.300 Test Loss: 1.481 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2899646759033203
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.280 Test Loss: 1.467 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7483294010162354
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.300 Test Loss: 1.468 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5398409366607666
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.340 Test Loss: 1.531 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 25 cost time: 2.5961811542510986
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.360 Test Loss: 1.588 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359984).  Saving model ...
Epoch: 26 cost time: 2.7460126876831055
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.360 Test Loss: 1.615 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7490291595458984
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.400 Test Loss: 1.617 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399984).  Saving model ...
Epoch: 28 cost time: 2.520066976547241
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.360 Test Loss: 1.606 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.892240524291992
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.360 Test Loss: 1.604 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.62640380859375
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.360 Test Loss: 1.596 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.446030855178833
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.380 Test Loss: 1.590 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.6121177673339844
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.380 Test Loss: 1.590 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.317966938018799
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.380 Test Loss: 1.592 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.270162343978882
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.380 Test Loss: 1.580 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.02587628364563
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.400 Test Loss: 1.573 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399984).  Saving model ...
Epoch: 36 cost time: 2.707477331161499
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.400 Test Loss: 1.604 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.4408369064331055
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.420 Test Loss: 1.705 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419983).  Saving model ...
Epoch: 38 cost time: 2.8810744285583496
Epoch: 38, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.420 Test Loss: 1.769 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.7364308834075928
Epoch: 39, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.420 Test Loss: 1.794 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.907364845275879
Epoch: 40, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.420 Test Loss: 1.798 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.9207253456115723
Epoch: 41, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.420 Test Loss: 1.782 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.6368491649627686
Epoch: 42, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.400 Test Loss: 1.751 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.6622183322906494
Epoch: 43, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.420 Test Loss: 1.721 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.732642650604248
Epoch: 44, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.420 Test Loss: 1.696 Test Acc: 0.420
Validation loss decreased (-0.419983 --> -0.419983).  Saving model ...
Epoch: 45 cost time: 2.867440938949585
Epoch: 45, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.673 Vali Acc: 0.400 Test Loss: 1.673 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.624173879623413
Epoch: 46, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.400 Test Loss: 1.639 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.988804578781128
Epoch: 47, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.420 Test Loss: 1.605 Test Acc: 0.420
Validation loss decreased (-0.419983 --> -0.419984).  Saving model ...
Epoch: 48 cost time: 2.6350810527801514
Epoch: 48, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.380 Test Loss: 1.574 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.773346424102783
Epoch: 49, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.400 Test Loss: 1.578 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.7918355464935303
Epoch: 50, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.420 Test Loss: 1.596 Test Acc: 0.420
Validation loss decreased (-0.419984 --> -0.419984).  Saving model ...
Epoch: 51 cost time: 2.7121055126190186
Epoch: 51, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.420 Test Loss: 1.614 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.7791879177093506
Epoch: 52, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.420 Test Loss: 1.639 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.803433656692505
Epoch: 53, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.400 Test Loss: 1.667 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.87872052192688
Epoch: 54, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.420 Test Loss: 1.693 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.6829257011413574
Epoch: 55, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.420 Test Loss: 1.717 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.5016636848449707
Epoch: 56, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.420 Test Loss: 1.747 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.5006179809570312
Epoch: 57, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.420 Test Loss: 1.767 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.676297664642334
Epoch: 58, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.400 Test Loss: 1.770 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.1806719303131104
Epoch: 59, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.400 Test Loss: 1.768 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.4169821739196777
Epoch: 60, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.420 Test Loss: 1.758 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.1581971645355225
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.610 Vali Acc: 0.200 Test Loss: 1.610 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.6579198837280273
Epoch: 2, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.563 Vali Acc: 0.240 Test Loss: 1.563 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.5306475162506104
Epoch: 3, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.583 Vali Acc: 0.220 Test Loss: 1.583 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3855702877044678
Epoch: 4, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.680 Vali Acc: 0.280 Test Loss: 1.680 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 2.8766725063323975
Epoch: 5, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.637 Vali Acc: 0.160 Test Loss: 1.637 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5006015300750732
Epoch: 6, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.770789623260498
Epoch: 7, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.625 Vali Acc: 0.160 Test Loss: 1.625 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.813676118850708
Epoch: 8, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.847 Vali Acc: 0.200 Test Loss: 1.847 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6195952892303467
Epoch: 9, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.810 Vali Acc: 0.200 Test Loss: 1.810 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.881748914718628
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.574 Vali Acc: 0.260 Test Loss: 1.574 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.714564323425293
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9559600353240967
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.615 Vali Acc: 0.280 Test Loss: 1.615 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 13 cost time: 2.881876230239868
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.685 Vali Acc: 0.280 Test Loss: 1.685 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6111693382263184
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.939 Vali Acc: 0.260 Test Loss: 1.939 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.698943853378296
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.886 Vali Acc: 0.320 Test Loss: 1.886 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319981).  Saving model ...
Epoch: 16 cost time: 2.8035218715667725
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.360 Test Loss: 1.719 Test Acc: 0.360
Validation loss decreased (-0.319981 --> -0.359983).  Saving model ...
Epoch: 17 cost time: 2.5225167274475098
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.320 Test Loss: 1.637 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.797637701034546
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.300 Test Loss: 1.615 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6758012771606445
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.300 Test Loss: 1.612 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.785465955734253
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.280 Test Loss: 1.625 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8645782470703125
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.300 Test Loss: 1.670 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.796137571334839
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.320 Test Loss: 1.715 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8967926502227783
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.340 Test Loss: 1.750 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8306453227996826
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.340 Test Loss: 1.777 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6401076316833496
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.340 Test Loss: 1.794 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9292383193969727
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.340 Test Loss: 1.794 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 13661189
model size : 71.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8138370513916016
Epoch: 1, Steps: 4 | Train Loss: 1.779 Vali Loss: 1.697 Vali Acc: 0.180 Test Loss: 1.697 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.2883713245391846
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.686 Vali Acc: 0.240 Test Loss: 1.686 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.9854304790496826
Epoch: 3, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.720 Vali Acc: 0.260 Test Loss: 1.720 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 2.3817079067230225
Epoch: 4, Steps: 4 | Train Loss: 0.636 Vali Loss: 1.807 Vali Acc: 0.280 Test Loss: 1.807 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 5 cost time: 2.185905694961548
Epoch: 5, Steps: 4 | Train Loss: 0.567 Vali Loss: 1.858 Vali Acc: 0.260 Test Loss: 1.858 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1359543800354004
Epoch: 6, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.784 Vali Acc: 0.320 Test Loss: 1.784 Test Acc: 0.320
Validation loss decreased (-0.279982 --> -0.319982).  Saving model ...
Epoch: 7 cost time: 2.08099627494812
Epoch: 7, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.998 Vali Acc: 0.360 Test Loss: 1.998 Test Acc: 0.360
Validation loss decreased (-0.319982 --> -0.359980).  Saving model ...
Epoch: 8 cost time: 2.2157084941864014
Epoch: 8, Steps: 4 | Train Loss: 0.241 Vali Loss: 2.130 Vali Acc: 0.300 Test Loss: 2.130 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3703434467315674
Epoch: 9, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.073 Vali Acc: 0.280 Test Loss: 2.073 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2063655853271484
Epoch: 10, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.436 Vali Acc: 0.320 Test Loss: 2.436 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3193366527557373
Epoch: 11, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.746 Vali Acc: 0.280 Test Loss: 2.746 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0136420726776123
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.615 Vali Acc: 0.260 Test Loss: 2.615 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.878049373626709
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.503 Vali Acc: 0.320 Test Loss: 2.503 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0026323795318604
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.492 Vali Acc: 0.320 Test Loss: 2.492 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.250601291656494
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.536 Vali Acc: 0.300 Test Loss: 2.536 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.113816022872925
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.561 Vali Acc: 0.320 Test Loss: 2.561 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9756972789764404
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.622 Vali Acc: 0.320 Test Loss: 2.622 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.2143144607543945
Epoch: 1, Steps: 4 | Train Loss: 1.775 Vali Loss: 1.729 Vali Acc: 0.240 Test Loss: 1.729 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.4694809913635254
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.732 Vali Acc: 0.220 Test Loss: 1.732 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.256174325942993
Epoch: 3, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.734 Vali Acc: 0.240 Test Loss: 1.734 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4376070499420166
Epoch: 4, Steps: 4 | Train Loss: 0.636 Vali Loss: 1.799 Vali Acc: 0.240 Test Loss: 1.799 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0914642810821533
Epoch: 5, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.866 Vali Acc: 0.240 Test Loss: 1.866 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1875102519989014
Epoch: 6, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.780 Vali Acc: 0.260 Test Loss: 1.780 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259982).  Saving model ...
Epoch: 7 cost time: 2.1525347232818604
Epoch: 7, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.968 Vali Acc: 0.280 Test Loss: 1.968 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279980).  Saving model ...
Epoch: 8 cost time: 2.2287285327911377
Epoch: 8, Steps: 4 | Train Loss: 0.243 Vali Loss: 2.113 Vali Acc: 0.260 Test Loss: 2.113 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2244842052459717
Epoch: 9, Steps: 4 | Train Loss: 0.067 Vali Loss: 2.062 Vali Acc: 0.280 Test Loss: 2.062 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.021740436553955
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.396 Vali Acc: 0.280 Test Loss: 2.396 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.067596435546875
Epoch: 11, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.643 Vali Acc: 0.280 Test Loss: 2.643 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0029613971710205
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.553 Vali Acc: 0.240 Test Loss: 2.553 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2015223503112793
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.491 Vali Acc: 0.260 Test Loss: 2.491 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2658579349517822
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.496 Vali Acc: 0.260 Test Loss: 2.496 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0791759490966797
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.533 Vali Acc: 0.260 Test Loss: 2.533 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.199984073638916
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.543 Vali Acc: 0.260 Test Loss: 2.543 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1444029808044434
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.240 Test Loss: 2.584 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8136115074157715
Epoch: 1, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.717 Vali Acc: 0.160 Test Loss: 1.717 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.991337776184082
Epoch: 2, Steps: 4 | Train Loss: 1.512 Vali Loss: 1.720 Vali Acc: 0.240 Test Loss: 1.720 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 2.1243507862091064
Epoch: 3, Steps: 4 | Train Loss: 1.070 Vali Loss: 1.751 Vali Acc: 0.240 Test Loss: 1.751 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9315924644470215
Epoch: 4, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.855 Vali Acc: 0.240 Test Loss: 1.855 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9665241241455078
Epoch: 5, Steps: 4 | Train Loss: 0.534 Vali Loss: 1.953 Vali Acc: 0.260 Test Loss: 1.953 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259980).  Saving model ...
Epoch: 6 cost time: 1.805281639099121
Epoch: 6, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.903 Vali Acc: 0.280 Test Loss: 1.903 Test Acc: 0.280
Validation loss decreased (-0.259980 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 2.10016131401062
Epoch: 7, Steps: 4 | Train Loss: 0.107 Vali Loss: 2.143 Vali Acc: 0.240 Test Loss: 2.143 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9795570373535156
Epoch: 8, Steps: 4 | Train Loss: 0.177 Vali Loss: 2.305 Vali Acc: 0.280 Test Loss: 2.305 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0357062816619873
Epoch: 9, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.322 Vali Acc: 0.280 Test Loss: 2.322 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9994738101959229
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.647 Vali Acc: 0.240 Test Loss: 2.647 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9063334465026855
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.953 Vali Acc: 0.240 Test Loss: 2.953 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9657514095306396
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.028 Vali Acc: 0.240 Test Loss: 3.028 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.226642608642578
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.006 Vali Acc: 0.260 Test Loss: 3.006 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0925233364105225
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.946 Vali Acc: 0.260 Test Loss: 2.946 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9836699962615967
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.926 Vali Acc: 0.260 Test Loss: 2.926 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1649441719055176
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.926 Vali Acc: 0.260 Test Loss: 2.926 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.232678651809692
Epoch: 1, Steps: 4 | Train Loss: 1.715 Vali Loss: 1.715 Vali Acc: 0.120 Test Loss: 1.715 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.9099164009094238
Epoch: 2, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.692 Vali Acc: 0.200 Test Loss: 1.692 Test Acc: 0.200
Validation loss decreased (-0.119983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 2.0553016662597656
Epoch: 3, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.694 Vali Acc: 0.220 Test Loss: 1.694 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.9920942783355713
Epoch: 4, Steps: 4 | Train Loss: 0.596 Vali Loss: 1.794 Vali Acc: 0.260 Test Loss: 1.794 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259982).  Saving model ...
Epoch: 5 cost time: 2.0922892093658447
Epoch: 5, Steps: 4 | Train Loss: 0.526 Vali Loss: 1.839 Vali Acc: 0.260 Test Loss: 1.839 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.965806245803833
Epoch: 6, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.784 Vali Acc: 0.320 Test Loss: 1.784 Test Acc: 0.320
Validation loss decreased (-0.259982 --> -0.319982).  Saving model ...
Epoch: 7 cost time: 1.95546555519104
Epoch: 7, Steps: 4 | Train Loss: 0.099 Vali Loss: 2.000 Vali Acc: 0.320 Test Loss: 2.000 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1174092292785645
Epoch: 8, Steps: 4 | Train Loss: 0.144 Vali Loss: 2.104 Vali Acc: 0.300 Test Loss: 2.104 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0193397998809814
Epoch: 9, Steps: 4 | Train Loss: 0.036 Vali Loss: 2.108 Vali Acc: 0.280 Test Loss: 2.108 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.137896776199341
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.359 Vali Acc: 0.280 Test Loss: 2.359 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.11553692817688
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.706 Vali Acc: 0.280 Test Loss: 2.706 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1320791244506836
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.879 Vali Acc: 0.300 Test Loss: 2.879 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0380806922912598
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.853 Vali Acc: 0.300 Test Loss: 2.853 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.005913019180298
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.759 Vali Acc: 0.280 Test Loss: 2.759 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0840322971343994
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.695 Vali Acc: 0.280 Test Loss: 2.695 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0554795265197754
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.665 Vali Acc: 0.280 Test Loss: 2.665 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.704299211502075
Epoch: 1, Steps: 4 | Train Loss: 1.693 Vali Loss: 1.756 Vali Acc: 0.140 Test Loss: 1.756 Test Acc: 0.140
Validation loss decreased (inf --> -0.139982).  Saving model ...
Epoch: 2 cost time: 1.8701891899108887
Epoch: 2, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.753 Vali Acc: 0.180 Test Loss: 1.753 Test Acc: 0.180
Validation loss decreased (-0.139982 --> -0.179982).  Saving model ...
Epoch: 3 cost time: 1.8051791191101074
Epoch: 3, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.764 Vali Acc: 0.200 Test Loss: 1.764 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.9436137676239014
Epoch: 4, Steps: 4 | Train Loss: 0.601 Vali Loss: 1.820 Vali Acc: 0.240 Test Loss: 1.820 Test Acc: 0.240
Validation loss decreased (-0.199982 --> -0.239982).  Saving model ...
Epoch: 5 cost time: 1.9586634635925293
Epoch: 5, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.883 Vali Acc: 0.280 Test Loss: 1.883 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279981).  Saving model ...
Epoch: 6 cost time: 1.9817371368408203
Epoch: 6, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.858 Vali Acc: 0.220 Test Loss: 1.858 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.013777017593384
Epoch: 7, Steps: 4 | Train Loss: 0.089 Vali Loss: 2.050 Vali Acc: 0.260 Test Loss: 2.050 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7427823543548584
Epoch: 8, Steps: 4 | Train Loss: 0.150 Vali Loss: 2.159 Vali Acc: 0.280 Test Loss: 2.159 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8340258598327637
Epoch: 9, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.140 Vali Acc: 0.260 Test Loss: 2.140 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8721654415130615
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.342 Vali Acc: 0.240 Test Loss: 2.342 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8663678169250488
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.665 Vali Acc: 0.240 Test Loss: 2.665 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0235235691070557
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.819 Vali Acc: 0.240 Test Loss: 2.819 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8785037994384766
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.851 Vali Acc: 0.220 Test Loss: 2.851 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.934337854385376
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.817 Vali Acc: 0.220 Test Loss: 2.817 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.379412889480591
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.765 Vali Acc: 0.240 Test Loss: 2.765 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8968563079833984
Epoch: 1, Steps: 4 | Train Loss: 1.743 Vali Loss: 1.724 Vali Acc: 0.160 Test Loss: 1.724 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.9475955963134766
Epoch: 2, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.667 Vali Acc: 0.200 Test Loss: 1.667 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 2.1489133834838867
Epoch: 3, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.677 Vali Acc: 0.220 Test Loss: 1.677 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.884681224822998
Epoch: 4, Steps: 4 | Train Loss: 0.605 Vali Loss: 1.784 Vali Acc: 0.180 Test Loss: 1.784 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9027435779571533
Epoch: 5, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.859 Vali Acc: 0.280 Test Loss: 1.859 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279981).  Saving model ...
Epoch: 6 cost time: 1.9743292331695557
Epoch: 6, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.857 Vali Acc: 0.200 Test Loss: 1.857 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.911325216293335
Epoch: 7, Steps: 4 | Train Loss: 0.075 Vali Loss: 2.079 Vali Acc: 0.260 Test Loss: 2.079 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1049373149871826
Epoch: 8, Steps: 4 | Train Loss: 0.089 Vali Loss: 2.184 Vali Acc: 0.260 Test Loss: 2.184 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.995344877243042
Epoch: 9, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.255 Vali Acc: 0.180 Test Loss: 2.255 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0974576473236084
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.493 Vali Acc: 0.240 Test Loss: 2.493 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0574610233306885
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.763 Vali Acc: 0.260 Test Loss: 2.763 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.039116621017456
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.968 Vali Acc: 0.240 Test Loss: 2.968 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.092770576477051
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.074 Vali Acc: 0.240 Test Loss: 3.074 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0063364505767822
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.100 Vali Acc: 0.240 Test Loss: 3.100 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.997098684310913
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.066 Vali Acc: 0.240 Test Loss: 3.066 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7674875259399414
Epoch: 1, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.858 Vali Acc: 0.200 Test Loss: 1.858 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 1.8541288375854492
Epoch: 2, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.808 Vali Acc: 0.200 Test Loss: 1.808 Test Acc: 0.200
Validation loss decreased (-0.199981 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 1.9982223510742188
Epoch: 3, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.830 Vali Acc: 0.220 Test Loss: 1.830 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219982).  Saving model ...
Epoch: 4 cost time: 1.9451322555541992
Epoch: 4, Steps: 4 | Train Loss: 0.611 Vali Loss: 1.933 Vali Acc: 0.200 Test Loss: 1.933 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.107961416244507
Epoch: 5, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.940 Vali Acc: 0.260 Test Loss: 1.940 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259981).  Saving model ...
Epoch: 6 cost time: 2.2095518112182617
Epoch: 6, Steps: 4 | Train Loss: 0.185 Vali Loss: 1.929 Vali Acc: 0.220 Test Loss: 1.929 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8767659664154053
Epoch: 7, Steps: 4 | Train Loss: 0.106 Vali Loss: 2.145 Vali Acc: 0.220 Test Loss: 2.145 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.017400026321411
Epoch: 8, Steps: 4 | Train Loss: 0.133 Vali Loss: 2.260 Vali Acc: 0.260 Test Loss: 2.260 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.13222074508667
Epoch: 9, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.280 Vali Acc: 0.280 Test Loss: 2.280 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279977).  Saving model ...
Epoch: 10 cost time: 1.978696346282959
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.405 Vali Acc: 0.240 Test Loss: 2.405 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.798508882522583
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.592 Vali Acc: 0.260 Test Loss: 2.592 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9209277629852295
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.702 Vali Acc: 0.260 Test Loss: 2.702 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9385924339294434
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.725 Vali Acc: 0.260 Test Loss: 2.725 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9525234699249268
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.703 Vali Acc: 0.260 Test Loss: 2.703 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9661979675292969
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.668 Vali Acc: 0.260 Test Loss: 2.668 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.122514009475708
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.639 Vali Acc: 0.260 Test Loss: 2.639 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0931596755981445
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.626 Vali Acc: 0.260 Test Loss: 2.626 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1807210445404053
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.619 Vali Acc: 0.260 Test Loss: 2.619 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1905758380889893
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.619 Vali Acc: 0.260 Test Loss: 2.619 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7418429851531982
Epoch: 1, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.715 Vali Acc: 0.140 Test Loss: 1.715 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.9863488674163818
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.669 Vali Acc: 0.180 Test Loss: 1.669 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.9717309474945068
Epoch: 3, Steps: 4 | Train Loss: 1.220 Vali Loss: 1.672 Vali Acc: 0.120 Test Loss: 1.672 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8748805522918701
Epoch: 4, Steps: 4 | Train Loss: 0.683 Vali Loss: 1.721 Vali Acc: 0.180 Test Loss: 1.721 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.855980396270752
Epoch: 5, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.707 Vali Acc: 0.200 Test Loss: 1.707 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 6 cost time: 2.0395607948303223
Epoch: 6, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.725 Vali Acc: 0.200 Test Loss: 1.725 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9626843929290771
Epoch: 7, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.856 Vali Acc: 0.180 Test Loss: 1.856 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9656269550323486
Epoch: 8, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.832 Vali Acc: 0.280 Test Loss: 1.832 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279982).  Saving model ...
Epoch: 9 cost time: 1.9897053241729736
Epoch: 9, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.924 Vali Acc: 0.260 Test Loss: 1.924 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1369967460632324
Epoch: 10, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.012 Vali Acc: 0.280 Test Loss: 2.012 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.167714834213257
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.114 Vali Acc: 0.260 Test Loss: 2.114 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9145488739013672
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.169 Vali Acc: 0.240 Test Loss: 2.169 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8461627960205078
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.153 Vali Acc: 0.220 Test Loss: 2.153 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9016351699829102
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.112 Vali Acc: 0.220 Test Loss: 2.112 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9265072345733643
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.080 Vali Acc: 0.240 Test Loss: 2.080 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0241448879241943
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.069 Vali Acc: 0.260 Test Loss: 2.069 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.966259241104126
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.080 Vali Acc: 0.240 Test Loss: 2.080 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0707509517669678
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.090 Vali Acc: 0.240 Test Loss: 2.090 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.81052303314209
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.733 Vali Acc: 0.220 Test Loss: 1.733 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 2.005527973175049
Epoch: 2, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.686 Vali Acc: 0.220 Test Loss: 1.686 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.8958899974822998
Epoch: 3, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.698 Vali Acc: 0.180 Test Loss: 1.698 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.061020612716675
Epoch: 4, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.763 Vali Acc: 0.160 Test Loss: 1.763 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8512177467346191
Epoch: 5, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.781 Vali Acc: 0.240 Test Loss: 1.781 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239982).  Saving model ...
Epoch: 6 cost time: 2.0136377811431885
Epoch: 6, Steps: 4 | Train Loss: 0.517 Vali Loss: 1.785 Vali Acc: 0.220 Test Loss: 1.785 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.841522216796875
Epoch: 7, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.845 Vali Acc: 0.200 Test Loss: 1.845 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.880220651626587
Epoch: 8, Steps: 4 | Train Loss: 0.500 Vali Loss: 1.842 Vali Acc: 0.240 Test Loss: 1.842 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7746074199676514
Epoch: 9, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.976 Vali Acc: 0.200 Test Loss: 1.976 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8327040672302246
Epoch: 10, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.898 Vali Acc: 0.200 Test Loss: 1.898 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.969449758529663
Epoch: 11, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.975 Vali Acc: 0.200 Test Loss: 1.975 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0351808071136475
Epoch: 12, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.922 Vali Acc: 0.240 Test Loss: 1.922 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0037200450897217
Epoch: 13, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.685 Vali Acc: 0.280 Test Loss: 1.685 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279983).  Saving model ...
Epoch: 14 cost time: 2.05808424949646
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.767 Vali Acc: 0.280 Test Loss: 1.767 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9559683799743652
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.093745470046997
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.976 Vali Acc: 0.240 Test Loss: 1.976 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8330037593841553
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.036 Vali Acc: 0.300 Test Loss: 2.036 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299980).  Saving model ...
Epoch: 18 cost time: 1.9281072616577148
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.006 Vali Acc: 0.360 Test Loss: 2.006 Test Acc: 0.360
Validation loss decreased (-0.299980 --> -0.359980).  Saving model ...
Epoch: 19 cost time: 1.863732099533081
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.934 Vali Acc: 0.360 Test Loss: 1.934 Test Acc: 0.360
Validation loss decreased (-0.359980 --> -0.359981).  Saving model ...
Epoch: 20 cost time: 1.88661527633667
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.870 Vali Acc: 0.300 Test Loss: 1.870 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0605826377868652
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.320 Test Loss: 1.851 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9428584575653076
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.832 Vali Acc: 0.300 Test Loss: 1.832 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9942445755004883
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.826 Vali Acc: 0.280 Test Loss: 1.826 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8121047019958496
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.300 Test Loss: 1.801 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.099820137023926
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.280 Test Loss: 1.786 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2618343830108643
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.785 Vali Acc: 0.220 Test Loss: 1.785 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.147733211517334
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.220 Test Loss: 1.794 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.063203811645508
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.240 Test Loss: 1.808 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.276411771774292
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.260 Test Loss: 1.829 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.75351881980896
Epoch: 1, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.710 Vali Acc: 0.180 Test Loss: 1.710 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.7823190689086914
Epoch: 2, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.667 Vali Acc: 0.280 Test Loss: 1.667 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 2.0547611713409424
Epoch: 3, Steps: 4 | Train Loss: 1.253 Vali Loss: 1.687 Vali Acc: 0.280 Test Loss: 1.687 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8988502025604248
Epoch: 4, Steps: 4 | Train Loss: 0.916 Vali Loss: 1.733 Vali Acc: 0.200 Test Loss: 1.733 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9322445392608643
Epoch: 5, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.739 Vali Acc: 0.260 Test Loss: 1.739 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9047291278839111
Epoch: 6, Steps: 4 | Train Loss: 0.474 Vali Loss: 1.711 Vali Acc: 0.220 Test Loss: 1.711 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.00358247756958
Epoch: 7, Steps: 4 | Train Loss: 0.338 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.907029390335083
Epoch: 8, Steps: 4 | Train Loss: 0.409 Vali Loss: 1.796 Vali Acc: 0.200 Test Loss: 1.796 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.13484787940979
Epoch: 9, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.831 Vali Acc: 0.200 Test Loss: 1.831 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0089359283447266
Epoch: 10, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.801 Vali Acc: 0.200 Test Loss: 1.801 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0254852771759033
Epoch: 11, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.895 Vali Acc: 0.240 Test Loss: 1.895 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.917494535446167
Epoch: 12, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.944 Vali Acc: 0.220 Test Loss: 1.944 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 7158277
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.709862470626831
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.676 Vali Acc: 0.200 Test Loss: 1.676 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.017138719558716
Epoch: 2, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.715 Vali Acc: 0.200 Test Loss: 1.715 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9730072021484375
Epoch: 3, Steps: 4 | Train Loss: 1.204 Vali Loss: 1.753 Vali Acc: 0.160 Test Loss: 1.753 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1688997745513916
Epoch: 4, Steps: 4 | Train Loss: 0.689 Vali Loss: 1.778 Vali Acc: 0.200 Test Loss: 1.778 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0553016662597656
Epoch: 5, Steps: 4 | Train Loss: 0.364 Vali Loss: 1.896 Vali Acc: 0.280 Test Loss: 1.896 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279981).  Saving model ...
Epoch: 6 cost time: 2.066382646560669
Epoch: 6, Steps: 4 | Train Loss: 0.397 Vali Loss: 2.098 Vali Acc: 0.300 Test Loss: 2.098 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299979).  Saving model ...
Epoch: 7 cost time: 2.085885763168335
Epoch: 7, Steps: 4 | Train Loss: 0.204 Vali Loss: 2.161 Vali Acc: 0.240 Test Loss: 2.161 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0412895679473877
Epoch: 8, Steps: 4 | Train Loss: 0.069 Vali Loss: 2.151 Vali Acc: 0.280 Test Loss: 2.151 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8569488525390625
Epoch: 9, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.425 Vali Acc: 0.300 Test Loss: 2.425 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.856391191482544
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.616 Vali Acc: 0.260 Test Loss: 2.616 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9270365238189697
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.597 Vali Acc: 0.260 Test Loss: 2.597 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8341240882873535
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.565 Vali Acc: 0.260 Test Loss: 2.565 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.884631872177124
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.587 Vali Acc: 0.280 Test Loss: 2.587 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.94850492477417
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.644 Vali Acc: 0.300 Test Loss: 2.644 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0418663024902344
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.681 Vali Acc: 0.300 Test Loss: 2.681 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9884858131408691
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.705 Vali Acc: 0.300 Test Loss: 2.705 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.440978765487671
Epoch: 1, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.948533058166504
Epoch: 2, Steps: 4 | Train Loss: 1.465 Vali Loss: 1.666 Vali Acc: 0.140 Test Loss: 1.666 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1035540103912354
Epoch: 3, Steps: 4 | Train Loss: 1.202 Vali Loss: 1.709 Vali Acc: 0.180 Test Loss: 1.709 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1959996223449707
Epoch: 4, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.738 Vali Acc: 0.200 Test Loss: 1.738 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0858259201049805
Epoch: 5, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.828 Vali Acc: 0.220 Test Loss: 1.828 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3186302185058594
Epoch: 6, Steps: 4 | Train Loss: 0.424 Vali Loss: 2.013 Vali Acc: 0.320 Test Loss: 2.013 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319980).  Saving model ...
Epoch: 7 cost time: 2.049915313720703
Epoch: 7, Steps: 4 | Train Loss: 0.209 Vali Loss: 2.111 Vali Acc: 0.220 Test Loss: 2.111 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8365662097930908
Epoch: 8, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.095 Vali Acc: 0.240 Test Loss: 2.095 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0709712505340576
Epoch: 9, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.341 Vali Acc: 0.280 Test Loss: 2.341 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9387390613555908
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.510 Vali Acc: 0.260 Test Loss: 2.510 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0423383712768555
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.495 Vali Acc: 0.260 Test Loss: 2.495 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9269888401031494
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.456 Vali Acc: 0.240 Test Loss: 2.456 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.985633373260498
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.487 Vali Acc: 0.240 Test Loss: 2.487 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1001405715942383
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.553 Vali Acc: 0.240 Test Loss: 2.553 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.064997673034668
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.588 Vali Acc: 0.220 Test Loss: 2.588 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0530800819396973
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.599 Vali Acc: 0.240 Test Loss: 2.599 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6335928440093994
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.679 Vali Acc: 0.200 Test Loss: 1.679 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.8783302307128906
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.706 Vali Acc: 0.180 Test Loss: 1.706 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5944340229034424
Epoch: 3, Steps: 4 | Train Loss: 1.172 Vali Loss: 1.770 Vali Acc: 0.240 Test Loss: 1.770 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239982).  Saving model ...
Epoch: 4 cost time: 1.8351061344146729
Epoch: 4, Steps: 4 | Train Loss: 0.680 Vali Loss: 1.831 Vali Acc: 0.220 Test Loss: 1.831 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8454341888427734
Epoch: 5, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.964 Vali Acc: 0.240 Test Loss: 1.964 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7384922504425049
Epoch: 6, Steps: 4 | Train Loss: 0.424 Vali Loss: 2.198 Vali Acc: 0.260 Test Loss: 2.198 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259978).  Saving model ...
Epoch: 7 cost time: 1.8017723560333252
Epoch: 7, Steps: 4 | Train Loss: 0.189 Vali Loss: 2.326 Vali Acc: 0.240 Test Loss: 2.326 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7953946590423584
Epoch: 8, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.351 Vali Acc: 0.260 Test Loss: 2.351 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8753080368041992
Epoch: 9, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.655 Vali Acc: 0.260 Test Loss: 2.655 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.158608913421631
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.917 Vali Acc: 0.260 Test Loss: 2.917 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1292810440063477
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.942 Vali Acc: 0.260 Test Loss: 2.942 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.857679843902588
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.903 Vali Acc: 0.300 Test Loss: 2.903 Test Acc: 0.300
Validation loss decreased (-0.259978 --> -0.299971).  Saving model ...
Epoch: 13 cost time: 1.95444917678833
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.890 Vali Acc: 0.280 Test Loss: 2.890 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9858043193817139
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.918 Vali Acc: 0.280 Test Loss: 2.918 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9886119365692139
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.953 Vali Acc: 0.280 Test Loss: 2.953 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.037501335144043
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.981 Vali Acc: 0.280 Test Loss: 2.981 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8692340850830078
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.012 Vali Acc: 0.260 Test Loss: 3.012 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7987120151519775
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.040 Vali Acc: 0.260 Test Loss: 3.040 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0751068592071533
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.073 Vali Acc: 0.280 Test Loss: 3.073 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9126839637756348
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.126 Vali Acc: 0.280 Test Loss: 3.126 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9106266498565674
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.153 Vali Acc: 0.260 Test Loss: 3.153 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7597758769989014
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.173 Vali Acc: 0.260 Test Loss: 3.173 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.00027871131897
Epoch: 1, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.002871513366699
Epoch: 2, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.664 Vali Acc: 0.220 Test Loss: 1.664 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0201632976531982
Epoch: 3, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.707 Vali Acc: 0.320 Test Loss: 1.707 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 2.0610203742980957
Epoch: 4, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.724 Vali Acc: 0.220 Test Loss: 1.724 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8539013862609863
Epoch: 5, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.869 Vali Acc: 0.300 Test Loss: 1.869 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9627721309661865
Epoch: 6, Steps: 4 | Train Loss: 0.388 Vali Loss: 2.076 Vali Acc: 0.360 Test Loss: 2.076 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359979).  Saving model ...
Epoch: 7 cost time: 1.821192741394043
Epoch: 7, Steps: 4 | Train Loss: 0.166 Vali Loss: 2.208 Vali Acc: 0.260 Test Loss: 2.208 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9551749229431152
Epoch: 8, Steps: 4 | Train Loss: 0.055 Vali Loss: 2.245 Vali Acc: 0.300 Test Loss: 2.245 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.76442289352417
Epoch: 9, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.477 Vali Acc: 0.300 Test Loss: 2.477 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0227508544921875
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.705 Vali Acc: 0.280 Test Loss: 2.705 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.919060230255127
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.773 Vali Acc: 0.280 Test Loss: 2.773 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0228779315948486
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.735 Vali Acc: 0.280 Test Loss: 2.735 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9685733318328857
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.685 Vali Acc: 0.280 Test Loss: 2.685 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.030993938446045
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.671 Vali Acc: 0.300 Test Loss: 2.671 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.965113878250122
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.675 Vali Acc: 0.320 Test Loss: 2.675 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9267444610595703
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.691 Vali Acc: 0.320 Test Loss: 2.691 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.430399179458618
Epoch: 1, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.612 Vali Acc: 0.220 Test Loss: 1.612 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.836233377456665
Epoch: 2, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.658 Vali Acc: 0.200 Test Loss: 1.658 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0924949645996094
Epoch: 3, Steps: 4 | Train Loss: 1.172 Vali Loss: 1.705 Vali Acc: 0.240 Test Loss: 1.705 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.9479551315307617
Epoch: 4, Steps: 4 | Train Loss: 0.651 Vali Loss: 1.702 Vali Acc: 0.220 Test Loss: 1.702 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0668845176696777
Epoch: 5, Steps: 4 | Train Loss: 0.348 Vali Loss: 1.866 Vali Acc: 0.220 Test Loss: 1.866 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9463963508605957
Epoch: 6, Steps: 4 | Train Loss: 0.365 Vali Loss: 2.073 Vali Acc: 0.220 Test Loss: 2.073 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0774364471435547
Epoch: 7, Steps: 4 | Train Loss: 0.151 Vali Loss: 2.179 Vali Acc: 0.220 Test Loss: 2.179 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0429062843322754
Epoch: 8, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.203 Vali Acc: 0.240 Test Loss: 2.203 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.984647512435913
Epoch: 9, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.392 Vali Acc: 0.240 Test Loss: 2.392 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0345635414123535
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.551 Vali Acc: 0.220 Test Loss: 2.551 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8610854148864746
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.641 Vali Acc: 0.200 Test Loss: 2.641 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8197145462036133
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.667 Vali Acc: 0.200 Test Loss: 2.667 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.836815357208252
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.655 Vali Acc: 0.220 Test Loss: 2.655 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.941819667816162
Epoch: 1, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.595 Vali Acc: 0.260 Test Loss: 1.595 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.9355576038360596
Epoch: 2, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.632 Vali Acc: 0.220 Test Loss: 1.632 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0810844898223877
Epoch: 3, Steps: 4 | Train Loss: 1.201 Vali Loss: 1.660 Vali Acc: 0.280 Test Loss: 1.660 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.7736732959747314
Epoch: 4, Steps: 4 | Train Loss: 0.643 Vali Loss: 1.641 Vali Acc: 0.180 Test Loss: 1.641 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.066913604736328
Epoch: 5, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.819 Vali Acc: 0.240 Test Loss: 1.819 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.728346586227417
Epoch: 6, Steps: 4 | Train Loss: 0.342 Vali Loss: 2.061 Vali Acc: 0.240 Test Loss: 2.061 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8308920860290527
Epoch: 7, Steps: 4 | Train Loss: 0.119 Vali Loss: 2.140 Vali Acc: 0.220 Test Loss: 2.140 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9495842456817627
Epoch: 8, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.192 Vali Acc: 0.200 Test Loss: 2.192 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9602463245391846
Epoch: 9, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.463 Vali Acc: 0.220 Test Loss: 2.463 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9315454959869385
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.644 Vali Acc: 0.220 Test Loss: 2.644 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8824896812438965
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.697 Vali Acc: 0.220 Test Loss: 2.697 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9386191368103027
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.690 Vali Acc: 0.220 Test Loss: 2.690 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8985371589660645
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.666 Vali Acc: 0.220 Test Loss: 2.666 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.985083818435669
Epoch: 1, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.665 Vali Acc: 0.240 Test Loss: 1.665 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.0528972148895264
Epoch: 2, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.691 Vali Acc: 0.220 Test Loss: 1.691 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0342814922332764
Epoch: 3, Steps: 4 | Train Loss: 1.200 Vali Loss: 1.729 Vali Acc: 0.240 Test Loss: 1.729 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9989829063415527
Epoch: 4, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.699 Vali Acc: 0.180 Test Loss: 1.699 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8584234714508057
Epoch: 5, Steps: 4 | Train Loss: 0.361 Vali Loss: 1.820 Vali Acc: 0.240 Test Loss: 1.820 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8871521949768066
Epoch: 6, Steps: 4 | Train Loss: 0.360 Vali Loss: 2.039 Vali Acc: 0.240 Test Loss: 2.039 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8754174709320068
Epoch: 7, Steps: 4 | Train Loss: 0.141 Vali Loss: 2.125 Vali Acc: 0.220 Test Loss: 2.125 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8265032768249512
Epoch: 8, Steps: 4 | Train Loss: 0.057 Vali Loss: 2.129 Vali Acc: 0.260 Test Loss: 2.129 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259979).  Saving model ...
Epoch: 9 cost time: 1.8990755081176758
Epoch: 9, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.267 Vali Acc: 0.280 Test Loss: 2.267 Test Acc: 0.280
Validation loss decreased (-0.259979 --> -0.279977).  Saving model ...
Epoch: 10 cost time: 1.8413519859313965
Epoch: 10, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.501 Vali Acc: 0.260 Test Loss: 2.501 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0262913703918457
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.648 Vali Acc: 0.280 Test Loss: 2.648 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9618656635284424
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.681 Vali Acc: 0.280 Test Loss: 2.681 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.96982741355896
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.650 Vali Acc: 0.240 Test Loss: 2.650 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.122636079788208
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.618 Vali Acc: 0.240 Test Loss: 2.618 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.052489757537842
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.602 Vali Acc: 0.260 Test Loss: 2.602 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1017589569091797
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.596 Vali Acc: 0.260 Test Loss: 2.596 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9234528541564941
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.607 Vali Acc: 0.260 Test Loss: 2.607 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8678367137908936
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.628 Vali Acc: 0.280 Test Loss: 2.628 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.84371018409729
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.653 Vali Acc: 0.280 Test Loss: 2.653 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3327479362487793
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.595 Vali Acc: 0.100 Test Loss: 1.595 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.8102376461029053
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.634 Vali Acc: 0.260 Test Loss: 1.634 Test Acc: 0.260
Validation loss decreased (-0.099984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.851548671722412
Epoch: 3, Steps: 4 | Train Loss: 1.298 Vali Loss: 1.681 Vali Acc: 0.240 Test Loss: 1.681 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.852435827255249
Epoch: 4, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.597 Vali Acc: 0.180 Test Loss: 1.597 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9032645225524902
Epoch: 5, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.620 Vali Acc: 0.220 Test Loss: 1.620 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9177372455596924
Epoch: 6, Steps: 4 | Train Loss: 0.409 Vali Loss: 1.694 Vali Acc: 0.240 Test Loss: 1.694 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8093268871307373
Epoch: 7, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.781 Vali Acc: 0.220 Test Loss: 1.781 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8602488040924072
Epoch: 8, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.839 Vali Acc: 0.260 Test Loss: 1.839 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7469828128814697
Epoch: 9, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.882 Vali Acc: 0.280 Test Loss: 1.882 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279981).  Saving model ...
Epoch: 10 cost time: 1.8947904109954834
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.987 Vali Acc: 0.260 Test Loss: 1.987 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9186601638793945
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.033 Vali Acc: 0.240 Test Loss: 2.033 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8366937637329102
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.009 Vali Acc: 0.220 Test Loss: 2.009 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7896966934204102
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.978 Vali Acc: 0.220 Test Loss: 1.978 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6896305084228516
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.969 Vali Acc: 0.220 Test Loss: 1.969 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6318492889404297
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.985 Vali Acc: 0.220 Test Loss: 1.985 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.807854413986206
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.012 Vali Acc: 0.220 Test Loss: 2.012 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9150416851043701
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.052 Vali Acc: 0.240 Test Loss: 2.052 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.969508171081543
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.092 Vali Acc: 0.240 Test Loss: 2.092 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9471654891967773
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.120 Vali Acc: 0.240 Test Loss: 2.120 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.497544765472412
Epoch: 1, Steps: 4 | Train Loss: 1.630 Vali Loss: 1.571 Vali Acc: 0.220 Test Loss: 1.571 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.930147409439087
Epoch: 2, Steps: 4 | Train Loss: 1.544 Vali Loss: 1.603 Vali Acc: 0.260 Test Loss: 1.603 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.8523828983306885
Epoch: 3, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8356072902679443
Epoch: 4, Steps: 4 | Train Loss: 0.987 Vali Loss: 1.628 Vali Acc: 0.240 Test Loss: 1.628 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.745847225189209
Epoch: 5, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9527747631072998
Epoch: 6, Steps: 4 | Train Loss: 0.754 Vali Loss: 1.625 Vali Acc: 0.260 Test Loss: 1.625 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.874389886856079
Epoch: 7, Steps: 4 | Train Loss: 0.602 Vali Loss: 1.732 Vali Acc: 0.240 Test Loss: 1.732 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9873459339141846
Epoch: 8, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.871 Vali Acc: 0.180 Test Loss: 1.871 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7870244979858398
Epoch: 9, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.736 Vali Acc: 0.240 Test Loss: 1.736 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8996763229370117
Epoch: 10, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.647 Vali Acc: 0.260 Test Loss: 1.647 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0200679302215576
Epoch: 11, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.795 Vali Acc: 0.260 Test Loss: 1.795 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.871715784072876
Epoch: 12, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.859 Vali Acc: 0.180 Test Loss: 1.859 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1953864097595215
Epoch: 1, Steps: 4 | Train Loss: 1.727 Vali Loss: 1.550 Vali Acc: 0.220 Test Loss: 1.550 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8240077495574951
Epoch: 2, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.8138055801391602
Epoch: 3, Steps: 4 | Train Loss: 1.354 Vali Loss: 1.671 Vali Acc: 0.200 Test Loss: 1.671 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9936439990997314
Epoch: 4, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.611 Vali Acc: 0.220 Test Loss: 1.611 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8694791793823242
Epoch: 5, Steps: 4 | Train Loss: 0.741 Vali Loss: 1.613 Vali Acc: 0.160 Test Loss: 1.613 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8004765510559082
Epoch: 6, Steps: 4 | Train Loss: 0.812 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.929739236831665
Epoch: 7, Steps: 4 | Train Loss: 0.454 Vali Loss: 1.662 Vali Acc: 0.220 Test Loss: 1.662 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8274645805358887
Epoch: 8, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.754 Vali Acc: 0.240 Test Loss: 1.754 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.984853982925415
Epoch: 9, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.715 Vali Acc: 0.200 Test Loss: 1.715 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9987199306488037
Epoch: 10, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.637 Vali Acc: 0.200 Test Loss: 1.637 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8808214664459229
Epoch: 11, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.577 Vali Acc: 0.320 Test Loss: 1.577 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 12 cost time: 2.222933053970337
Epoch: 12, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.609 Vali Acc: 0.260 Test Loss: 1.609 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.035046339035034
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.680 Vali Acc: 0.180 Test Loss: 1.680 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8197650909423828
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.694 Vali Acc: 0.240 Test Loss: 1.694 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0064942836761475
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.699 Vali Acc: 0.240 Test Loss: 1.699 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8621795177459717
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.686 Vali Acc: 0.260 Test Loss: 1.686 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.818305492401123
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.703 Vali Acc: 0.280 Test Loss: 1.703 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7703001499176025
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.717 Vali Acc: 0.260 Test Loss: 1.717 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8308029174804688
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.280 Test Loss: 1.720 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8833723068237305
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.300 Test Loss: 1.717 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8781352043151855
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.280 Test Loss: 1.702 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 5585413
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8233296871185303
Epoch: 1, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.628 Vali Acc: 0.220 Test Loss: 1.628 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.046386957168579
Epoch: 2, Steps: 4 | Train Loss: 1.460 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.9202473163604736
Epoch: 3, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.653 Vali Acc: 0.240 Test Loss: 1.653 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.778064489364624
Epoch: 4, Steps: 4 | Train Loss: 0.743 Vali Loss: 1.783 Vali Acc: 0.220 Test Loss: 1.783 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7908365726470947
Epoch: 5, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.761 Vali Acc: 0.280 Test Loss: 1.761 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279982).  Saving model ...
Epoch: 6 cost time: 1.8671092987060547
Epoch: 6, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.810 Vali Acc: 0.300 Test Loss: 1.810 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 1.8333203792572021
Epoch: 7, Steps: 4 | Train Loss: 0.124 Vali Loss: 2.203 Vali Acc: 0.280 Test Loss: 2.203 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9122347831726074
Epoch: 8, Steps: 4 | Train Loss: 0.091 Vali Loss: 2.179 Vali Acc: 0.340 Test Loss: 2.179 Test Acc: 0.340
Validation loss decreased (-0.299982 --> -0.339978).  Saving model ...
Epoch: 9 cost time: 1.7492296695709229
Epoch: 9, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.982 Vali Acc: 0.340 Test Loss: 1.982 Test Acc: 0.340
Validation loss decreased (-0.339978 --> -0.339980).  Saving model ...
Epoch: 10 cost time: 1.854321002960205
Epoch: 10, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.209 Vali Acc: 0.300 Test Loss: 2.209 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8176777362823486
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.265 Vali Acc: 0.320 Test Loss: 2.265 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.775282382965088
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.364 Vali Acc: 0.280 Test Loss: 2.364 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.039963960647583
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.510 Vali Acc: 0.280 Test Loss: 2.510 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9508466720581055
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.634 Vali Acc: 0.280 Test Loss: 2.634 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8278789520263672
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.737 Vali Acc: 0.300 Test Loss: 2.737 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8902173042297363
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.844 Vali Acc: 0.280 Test Loss: 2.844 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.903627872467041
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.938 Vali Acc: 0.300 Test Loss: 2.938 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7669768333435059
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.983 Vali Acc: 0.300 Test Loss: 2.983 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0255632400512695
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.955 Vali Acc: 0.300 Test Loss: 2.955 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.699014186859131
Epoch: 1, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.642 Vali Acc: 0.180 Test Loss: 1.642 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.833465814590454
Epoch: 2, Steps: 4 | Train Loss: 1.441 Vali Loss: 1.627 Vali Acc: 0.280 Test Loss: 1.627 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.0907342433929443
Epoch: 3, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.664 Vali Acc: 0.240 Test Loss: 1.664 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8785128593444824
Epoch: 4, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.789 Vali Acc: 0.180 Test Loss: 1.789 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9042961597442627
Epoch: 5, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.779 Vali Acc: 0.280 Test Loss: 1.779 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0018539428710938
Epoch: 6, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.829 Vali Acc: 0.300 Test Loss: 1.829 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 2.0300214290618896
Epoch: 7, Steps: 4 | Train Loss: 0.128 Vali Loss: 2.220 Vali Acc: 0.180 Test Loss: 2.220 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9019496440887451
Epoch: 8, Steps: 4 | Train Loss: 0.090 Vali Loss: 2.185 Vali Acc: 0.280 Test Loss: 2.185 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.019622564315796
Epoch: 9, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.987 Vali Acc: 0.240 Test Loss: 1.987 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8732588291168213
Epoch: 10, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.214 Vali Acc: 0.240 Test Loss: 2.214 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.747636318206787
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.238 Vali Acc: 0.280 Test Loss: 2.238 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9592409133911133
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.325 Vali Acc: 0.240 Test Loss: 2.325 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9068934917449951
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.460 Vali Acc: 0.260 Test Loss: 2.460 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.809767246246338
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.563 Vali Acc: 0.280 Test Loss: 2.563 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9500377178192139
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.638 Vali Acc: 0.240 Test Loss: 2.638 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9922609329223633
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.724 Vali Acc: 0.260 Test Loss: 2.724 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7315690517425537
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.695 Vali Acc: 0.160 Test Loss: 1.695 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.7700183391571045
Epoch: 2, Steps: 4 | Train Loss: 1.465 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 2.0369458198547363
Epoch: 3, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.760 Vali Acc: 0.200 Test Loss: 1.760 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.737661361694336
Epoch: 4, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.898 Vali Acc: 0.260 Test Loss: 1.898 Test Acc: 0.260
Validation loss decreased (-0.199982 --> -0.259981).  Saving model ...
Epoch: 5 cost time: 1.7205724716186523
Epoch: 5, Steps: 4 | Train Loss: 0.384 Vali Loss: 1.907 Vali Acc: 0.300 Test Loss: 1.907 Test Acc: 0.300
Validation loss decreased (-0.259981 --> -0.299981).  Saving model ...
Epoch: 6 cost time: 1.9922349452972412
Epoch: 6, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.954 Vali Acc: 0.260 Test Loss: 1.954 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8055510520935059
Epoch: 7, Steps: 4 | Train Loss: 0.126 Vali Loss: 2.404 Vali Acc: 0.240 Test Loss: 2.404 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8212721347808838
Epoch: 8, Steps: 4 | Train Loss: 0.088 Vali Loss: 2.446 Vali Acc: 0.240 Test Loss: 2.446 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9448962211608887
Epoch: 9, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.244 Vali Acc: 0.240 Test Loss: 2.244 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.923630714416504
Epoch: 10, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.441 Vali Acc: 0.300 Test Loss: 2.441 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.957427740097046
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.561 Vali Acc: 0.260 Test Loss: 2.561 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8224096298217773
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.713 Vali Acc: 0.280 Test Loss: 2.713 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9925856590270996
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.869 Vali Acc: 0.280 Test Loss: 2.869 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8858771324157715
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.964 Vali Acc: 0.260 Test Loss: 2.964 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8651978969573975
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.041 Vali Acc: 0.260 Test Loss: 3.041 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7116446495056152
Epoch: 1, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.699 Vali Acc: 0.180 Test Loss: 1.699 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.9836008548736572
Epoch: 2, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.689 Vali Acc: 0.220 Test Loss: 1.689 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.800077199935913
Epoch: 3, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.730 Vali Acc: 0.240 Test Loss: 1.730 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.7788746356964111
Epoch: 4, Steps: 4 | Train Loss: 0.710 Vali Loss: 1.846 Vali Acc: 0.200 Test Loss: 1.846 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8155624866485596
Epoch: 5, Steps: 4 | Train Loss: 0.360 Vali Loss: 1.823 Vali Acc: 0.280 Test Loss: 1.823 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279982).  Saving model ...
Epoch: 6 cost time: 1.9884777069091797
Epoch: 6, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.866 Vali Acc: 0.260 Test Loss: 1.866 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0492517948150635
Epoch: 7, Steps: 4 | Train Loss: 0.107 Vali Loss: 2.279 Vali Acc: 0.220 Test Loss: 2.279 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.087299108505249
Epoch: 8, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.321 Vali Acc: 0.300 Test Loss: 2.321 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299977).  Saving model ...
Epoch: 9 cost time: 2.1858177185058594
Epoch: 9, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.067 Vali Acc: 0.300 Test Loss: 2.067 Test Acc: 0.300
Validation loss decreased (-0.299977 --> -0.299979).  Saving model ...
Epoch: 10 cost time: 2.0258495807647705
Epoch: 10, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.180 Vali Acc: 0.280 Test Loss: 2.180 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.030449151992798
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.445 Vali Acc: 0.280 Test Loss: 2.445 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.047332286834717
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.607 Vali Acc: 0.260 Test Loss: 2.607 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.933903455734253
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.705 Vali Acc: 0.260 Test Loss: 2.705 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.931422233581543
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.755 Vali Acc: 0.260 Test Loss: 2.755 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9543354511260986
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.793 Vali Acc: 0.340 Test Loss: 2.793 Test Acc: 0.340
Validation loss decreased (-0.299979 --> -0.339972).  Saving model ...
Epoch: 16 cost time: 1.786177396774292
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.871 Vali Acc: 0.300 Test Loss: 2.871 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7475652694702148
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.974 Vali Acc: 0.300 Test Loss: 2.974 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7661166191101074
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.048 Vali Acc: 0.280 Test Loss: 3.048 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.832648754119873
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.054 Vali Acc: 0.280 Test Loss: 3.054 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8122334480285645
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.280 Test Loss: 3.029 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1457698345184326
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.995 Vali Acc: 0.280 Test Loss: 2.995 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9882631301879883
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.953 Vali Acc: 0.280 Test Loss: 2.953 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9310357570648193
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.921 Vali Acc: 0.280 Test Loss: 2.921 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.153167247772217
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.280 Test Loss: 2.895 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.132246971130371
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.891 Vali Acc: 0.280 Test Loss: 2.891 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.451948881149292
Epoch: 1, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.672 Vali Acc: 0.140 Test Loss: 1.672 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.9170329570770264
Epoch: 2, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.663 Vali Acc: 0.180 Test Loss: 1.663 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.762892246246338
Epoch: 3, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.698 Vali Acc: 0.200 Test Loss: 1.698 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.771409034729004
Epoch: 4, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.829 Vali Acc: 0.200 Test Loss: 1.829 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.982255220413208
Epoch: 5, Steps: 4 | Train Loss: 0.388 Vali Loss: 1.821 Vali Acc: 0.260 Test Loss: 1.821 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259982).  Saving model ...
Epoch: 6 cost time: 1.9810502529144287
Epoch: 6, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.833 Vali Acc: 0.220 Test Loss: 1.833 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1167285442352295
Epoch: 7, Steps: 4 | Train Loss: 0.096 Vali Loss: 2.232 Vali Acc: 0.180 Test Loss: 2.232 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9935271739959717
Epoch: 8, Steps: 4 | Train Loss: 0.066 Vali Loss: 2.301 Vali Acc: 0.200 Test Loss: 2.301 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.814143419265747
Epoch: 9, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.037 Vali Acc: 0.160 Test Loss: 2.037 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8982670307159424
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.137 Vali Acc: 0.220 Test Loss: 2.137 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.032644748687744
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.354 Vali Acc: 0.200 Test Loss: 2.354 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8315000534057617
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.532 Vali Acc: 0.200 Test Loss: 2.532 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7553832530975342
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.659 Vali Acc: 0.200 Test Loss: 2.659 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8858203887939453
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.725 Vali Acc: 0.200 Test Loss: 2.725 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.09609055519104
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.764 Vali Acc: 0.200 Test Loss: 2.764 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6742141246795654
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.615 Vali Acc: 0.220 Test Loss: 1.615 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8006603717803955
Epoch: 2, Steps: 4 | Train Loss: 1.514 Vali Loss: 1.633 Vali Acc: 0.220 Test Loss: 1.633 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.908207654953003
Epoch: 3, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.653 Vali Acc: 0.300 Test Loss: 1.653 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.905289649963379
Epoch: 4, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.739 Vali Acc: 0.300 Test Loss: 1.739 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7414665222167969
Epoch: 5, Steps: 4 | Train Loss: 0.384 Vali Loss: 1.776 Vali Acc: 0.240 Test Loss: 1.776 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.892101764678955
Epoch: 6, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.789 Vali Acc: 0.260 Test Loss: 1.789 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.026609182357788
Epoch: 7, Steps: 4 | Train Loss: 0.081 Vali Loss: 2.161 Vali Acc: 0.280 Test Loss: 2.161 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9142072200775146
Epoch: 8, Steps: 4 | Train Loss: 0.043 Vali Loss: 2.267 Vali Acc: 0.280 Test Loss: 2.267 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.952723503112793
Epoch: 9, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.159 Vali Acc: 0.300 Test Loss: 2.159 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9463741779327393
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.241 Vali Acc: 0.300 Test Loss: 2.241 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8957078456878662
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.338 Vali Acc: 0.280 Test Loss: 2.338 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0153074264526367
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.431 Vali Acc: 0.280 Test Loss: 2.431 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9603655338287354
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.526 Vali Acc: 0.300 Test Loss: 2.526 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.42287015914917
Epoch: 1, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.712 Vali Acc: 0.160 Test Loss: 1.712 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.6945607662200928
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.717 Vali Acc: 0.180 Test Loss: 1.717 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.804837703704834
Epoch: 3, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.724 Vali Acc: 0.260 Test Loss: 1.724 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.8913915157318115
Epoch: 4, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.831 Vali Acc: 0.220 Test Loss: 1.831 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8658816814422607
Epoch: 5, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.858 Vali Acc: 0.280 Test Loss: 1.858 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279981).  Saving model ...
Epoch: 6 cost time: 1.806732177734375
Epoch: 6, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.814 Vali Acc: 0.300 Test Loss: 1.814 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 1.8230416774749756
Epoch: 7, Steps: 4 | Train Loss: 0.102 Vali Loss: 2.124 Vali Acc: 0.220 Test Loss: 2.124 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9150757789611816
Epoch: 8, Steps: 4 | Train Loss: 0.061 Vali Loss: 2.318 Vali Acc: 0.260 Test Loss: 2.318 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8368167877197266
Epoch: 9, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.117 Vali Acc: 0.240 Test Loss: 2.117 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7382807731628418
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.067 Vali Acc: 0.220 Test Loss: 2.067 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8218612670898438
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.146 Vali Acc: 0.220 Test Loss: 2.146 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6687531471252441
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.272 Vali Acc: 0.240 Test Loss: 2.272 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7795019149780273
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.412 Vali Acc: 0.240 Test Loss: 2.412 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.712519645690918
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.527 Vali Acc: 0.260 Test Loss: 2.527 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6173820495605469
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.607 Vali Acc: 0.280 Test Loss: 2.607 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7017912864685059
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.672 Vali Acc: 0.280 Test Loss: 2.672 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.690955400466919
Epoch: 1, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.660 Vali Acc: 0.260 Test Loss: 1.660 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.8917994499206543
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.677 Vali Acc: 0.240 Test Loss: 1.677 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9720289707183838
Epoch: 3, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.672 Vali Acc: 0.200 Test Loss: 1.672 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.882652997970581
Epoch: 4, Steps: 4 | Train Loss: 0.812 Vali Loss: 1.683 Vali Acc: 0.320 Test Loss: 1.683 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 1.7365553379058838
Epoch: 5, Steps: 4 | Train Loss: 0.522 Vali Loss: 1.661 Vali Acc: 0.300 Test Loss: 1.661 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7128808498382568
Epoch: 6, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.672 Vali Acc: 0.280 Test Loss: 1.672 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7940783500671387
Epoch: 7, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.758 Vali Acc: 0.360 Test Loss: 1.758 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359982).  Saving model ...
Epoch: 8 cost time: 1.7253000736236572
Epoch: 8, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.798 Vali Acc: 0.380 Test Loss: 1.798 Test Acc: 0.380
Validation loss decreased (-0.359982 --> -0.379982).  Saving model ...
Epoch: 9 cost time: 1.879997968673706
Epoch: 9, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.742 Vali Acc: 0.280 Test Loss: 1.742 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7323188781738281
Epoch: 10, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.777 Vali Acc: 0.320 Test Loss: 1.777 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.781372308731079
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.900 Vali Acc: 0.280 Test Loss: 1.900 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.726128101348877
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.037 Vali Acc: 0.260 Test Loss: 2.037 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.884981632232666
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.142 Vali Acc: 0.220 Test Loss: 2.142 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.937481164932251
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.187 Vali Acc: 0.220 Test Loss: 2.187 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.014599323272705
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.182 Vali Acc: 0.260 Test Loss: 2.182 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8489272594451904
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.184 Vali Acc: 0.300 Test Loss: 2.184 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.950465202331543
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.193 Vali Acc: 0.300 Test Loss: 2.193 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9974682331085205
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.192 Vali Acc: 0.300 Test Loss: 2.192 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.600001335144043
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.549 Vali Acc: 0.220 Test Loss: 1.549 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 2.0021839141845703
Epoch: 2, Steps: 4 | Train Loss: 1.727 Vali Loss: 1.557 Vali Acc: 0.280 Test Loss: 1.557 Test Acc: 0.280
Validation loss decreased (-0.219985 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.026980400085449
Epoch: 3, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.549 Vali Acc: 0.260 Test Loss: 1.549 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0015718936920166
Epoch: 4, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.563 Vali Acc: 0.300 Test Loss: 1.563 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 2.160757303237915
Epoch: 5, Steps: 4 | Train Loss: 0.938 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1496472358703613
Epoch: 6, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.567 Vali Acc: 0.220 Test Loss: 1.567 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.990715503692627
Epoch: 7, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.606 Vali Acc: 0.280 Test Loss: 1.606 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0941295623779297
Epoch: 8, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.633 Vali Acc: 0.300 Test Loss: 1.633 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9901540279388428
Epoch: 9, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.617 Vali Acc: 0.380 Test Loss: 1.617 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379984).  Saving model ...
Epoch: 10 cost time: 1.9355545043945312
Epoch: 10, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.559 Vali Acc: 0.300 Test Loss: 1.559 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0714733600616455
Epoch: 11, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.660 Vali Acc: 0.260 Test Loss: 1.660 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9495611190795898
Epoch: 12, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.597 Vali Acc: 0.300 Test Loss: 1.597 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.01480770111084
Epoch: 13, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.552 Vali Acc: 0.380 Test Loss: 1.552 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 14 cost time: 1.9658808708190918
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.554 Vali Acc: 0.280 Test Loss: 1.554 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.043148994445801
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.487 Vali Acc: 0.340 Test Loss: 1.487 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9774651527404785
Epoch: 16, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.513 Vali Acc: 0.340 Test Loss: 1.513 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0892086029052734
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.639 Vali Acc: 0.340 Test Loss: 1.639 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2267093658447266
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.567 Vali Acc: 0.360 Test Loss: 1.567 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0912511348724365
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.545 Vali Acc: 0.280 Test Loss: 1.545 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9163997173309326
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.806739091873169
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.638 Vali Acc: 0.320 Test Loss: 1.638 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9673292636871338
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.320 Test Loss: 1.694 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.856311321258545
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.340 Test Loss: 1.728 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.493727922439575
Epoch: 1, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.611 Vali Acc: 0.220 Test Loss: 1.611 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.0409815311431885
Epoch: 2, Steps: 4 | Train Loss: 1.602 Vali Loss: 1.600 Vali Acc: 0.220 Test Loss: 1.600 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.9198558330535889
Epoch: 3, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.589 Vali Acc: 0.160 Test Loss: 1.589 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1178696155548096
Epoch: 4, Steps: 4 | Train Loss: 1.023 Vali Loss: 1.591 Vali Acc: 0.180 Test Loss: 1.591 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.849802017211914
Epoch: 5, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.593 Vali Acc: 0.280 Test Loss: 1.593 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.8303921222686768
Epoch: 6, Steps: 4 | Train Loss: 0.529 Vali Loss: 1.611 Vali Acc: 0.300 Test Loss: 1.611 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.7320985794067383
Epoch: 7, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.639 Vali Acc: 0.220 Test Loss: 1.639 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.931633472442627
Epoch: 8, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7315359115600586
Epoch: 9, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.593 Vali Acc: 0.240 Test Loss: 1.593 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9112846851348877
Epoch: 10, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.659 Vali Acc: 0.300 Test Loss: 1.659 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8116209506988525
Epoch: 11, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.805 Vali Acc: 0.220 Test Loss: 1.805 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7632904052734375
Epoch: 12, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.645 Vali Acc: 0.300 Test Loss: 1.645 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7207129001617432
Epoch: 13, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.591 Vali Acc: 0.340 Test Loss: 1.591 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 14 cost time: 1.9439518451690674
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.660 Vali Acc: 0.260 Test Loss: 1.660 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9077699184417725
Epoch: 15, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.665 Vali Acc: 0.280 Test Loss: 1.665 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.043858289718628
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.733 Vali Acc: 0.360 Test Loss: 1.733 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359983).  Saving model ...
Epoch: 17 cost time: 2.0006444454193115
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.884 Vali Acc: 0.340 Test Loss: 1.884 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2786829471588135
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.790 Vali Acc: 0.360 Test Loss: 1.790 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2493696212768555
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9463179111480713
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.691 Vali Acc: 0.300 Test Loss: 1.691 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.811002254486084
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.340 Test Loss: 1.709 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.026096820831299
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.750 Vali Acc: 0.320 Test Loss: 1.750 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.997265338897705
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.380 Test Loss: 1.796 Test Acc: 0.380
Validation loss decreased (-0.359983 --> -0.379982).  Saving model ...
Epoch: 24 cost time: 1.9353327751159668
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.835 Vali Acc: 0.380 Test Loss: 1.835 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7495996952056885
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.870 Vali Acc: 0.380 Test Loss: 1.870 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7983148097991943
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.340 Test Loss: 1.883 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0010602474212646
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.340 Test Loss: 1.882 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.050776720046997
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.878 Vali Acc: 0.340 Test Loss: 1.878 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9736557006835938
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.340 Test Loss: 1.866 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.052144765853882
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.320 Test Loss: 1.843 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.1061267852783203
Epoch: 31, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.320 Test Loss: 1.836 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0535190105438232
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.360 Test Loss: 1.833 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1021454334259033
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.360 Test Loss: 1.836 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 4798981
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.591369867324829
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.820650339126587
Epoch: 2, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.7103323936462402
Epoch: 3, Steps: 4 | Train Loss: 1.232 Vali Loss: 1.666 Vali Acc: 0.340 Test Loss: 1.666 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339983).  Saving model ...
Epoch: 4 cost time: 1.9101252555847168
Epoch: 4, Steps: 4 | Train Loss: 0.699 Vali Loss: 1.659 Vali Acc: 0.340 Test Loss: 1.659 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339983).  Saving model ...
Epoch: 5 cost time: 1.7970185279846191
Epoch: 5, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.745 Vali Acc: 0.300 Test Loss: 1.745 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8042182922363281
Epoch: 6, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.747 Vali Acc: 0.380 Test Loss: 1.747 Test Acc: 0.380
Validation loss decreased (-0.339983 --> -0.379983).  Saving model ...
Epoch: 7 cost time: 2.024759292602539
Epoch: 7, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.886 Vali Acc: 0.380 Test Loss: 1.886 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.82560396194458
Epoch: 8, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.884 Vali Acc: 0.360 Test Loss: 1.884 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8906795978546143
Epoch: 9, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.019 Vali Acc: 0.320 Test Loss: 2.019 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9354519844055176
Epoch: 10, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.113 Vali Acc: 0.340 Test Loss: 2.113 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8674428462982178
Epoch: 11, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.362 Vali Acc: 0.360 Test Loss: 2.362 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.679724931716919
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.663 Vali Acc: 0.360 Test Loss: 2.663 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8385889530181885
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.805 Vali Acc: 0.380 Test Loss: 2.805 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7537446022033691
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.819 Vali Acc: 0.320 Test Loss: 2.819 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8164477348327637
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.771 Vali Acc: 0.320 Test Loss: 2.771 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8151092529296875
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.686 Vali Acc: 0.320 Test Loss: 2.686 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.921107292175293
Epoch: 1, Steps: 4 | Train Loss: 1.726 Vali Loss: 1.605 Vali Acc: 0.220 Test Loss: 1.605 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.053515911102295
Epoch: 2, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0947258472442627
Epoch: 3, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.671 Vali Acc: 0.320 Test Loss: 1.671 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 1.8996179103851318
Epoch: 4, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.661 Vali Acc: 0.340 Test Loss: 1.661 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339983).  Saving model ...
Epoch: 5 cost time: 1.8233823776245117
Epoch: 5, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.703 Vali Acc: 0.300 Test Loss: 1.703 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8358302116394043
Epoch: 6, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.703 Vali Acc: 0.340 Test Loss: 1.703 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9423258304595947
Epoch: 7, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.845 Vali Acc: 0.360 Test Loss: 1.845 Test Acc: 0.360
Validation loss decreased (-0.339983 --> -0.359982).  Saving model ...
Epoch: 8 cost time: 1.883054256439209
Epoch: 8, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.835 Vali Acc: 0.300 Test Loss: 1.835 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9950566291809082
Epoch: 9, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.982 Vali Acc: 0.300 Test Loss: 1.982 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8783490657806396
Epoch: 10, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.988 Vali Acc: 0.320 Test Loss: 1.988 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9092605113983154
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.208 Vali Acc: 0.340 Test Loss: 2.208 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.027411699295044
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.478 Vali Acc: 0.320 Test Loss: 2.478 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.037916660308838
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.636 Vali Acc: 0.300 Test Loss: 2.636 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0355122089385986
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.678 Vali Acc: 0.280 Test Loss: 2.678 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.907529592514038
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.657 Vali Acc: 0.280 Test Loss: 2.657 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9211235046386719
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.591 Vali Acc: 0.280 Test Loss: 2.591 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.957582950592041
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.544 Vali Acc: 0.320 Test Loss: 2.544 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.290928840637207
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.578 Vali Acc: 0.200 Test Loss: 1.578 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.8319578170776367
Epoch: 2, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.607 Vali Acc: 0.160 Test Loss: 1.607 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7173914909362793
Epoch: 3, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.668 Vali Acc: 0.280 Test Loss: 1.668 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 2.0331108570098877
Epoch: 4, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.700 Vali Acc: 0.260 Test Loss: 1.700 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8655595779418945
Epoch: 5, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.760 Vali Acc: 0.260 Test Loss: 1.760 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9751191139221191
Epoch: 6, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.767 Vali Acc: 0.260 Test Loss: 1.767 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8070244789123535
Epoch: 7, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.961 Vali Acc: 0.300 Test Loss: 1.961 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299980).  Saving model ...
Epoch: 8 cost time: 1.9804937839508057
Epoch: 8, Steps: 4 | Train Loss: 0.092 Vali Loss: 2.032 Vali Acc: 0.320 Test Loss: 2.032 Test Acc: 0.320
Validation loss decreased (-0.299980 --> -0.319980).  Saving model ...
Epoch: 9 cost time: 1.8796722888946533
Epoch: 9, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.164 Vali Acc: 0.320 Test Loss: 2.164 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8232150077819824
Epoch: 10, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.262 Vali Acc: 0.300 Test Loss: 2.262 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7782957553863525
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.505 Vali Acc: 0.320 Test Loss: 2.505 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7950243949890137
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.786 Vali Acc: 0.300 Test Loss: 2.786 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9330260753631592
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.993 Vali Acc: 0.300 Test Loss: 2.993 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8303933143615723
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.086 Vali Acc: 0.300 Test Loss: 3.086 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.717937707901001
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.089 Vali Acc: 0.300 Test Loss: 3.089 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7951035499572754
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.035 Vali Acc: 0.300 Test Loss: 3.035 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0073394775390625
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.993 Vali Acc: 0.300 Test Loss: 2.993 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.024784564971924
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.971 Vali Acc: 0.300 Test Loss: 2.971 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.591972589492798
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.562 Vali Acc: 0.240 Test Loss: 1.562 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.8866100311279297
Epoch: 2, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.574 Vali Acc: 0.220 Test Loss: 1.574 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7707998752593994
Epoch: 3, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.599 Vali Acc: 0.320 Test Loss: 1.599 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.9653425216674805
Epoch: 4, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.619 Vali Acc: 0.380 Test Loss: 1.619 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 1.9771323204040527
Epoch: 5, Steps: 4 | Train Loss: 0.401 Vali Loss: 1.652 Vali Acc: 0.300 Test Loss: 1.652 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8698678016662598
Epoch: 6, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.697 Vali Acc: 0.320 Test Loss: 1.697 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8596394062042236
Epoch: 7, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.870 Vali Acc: 0.300 Test Loss: 1.870 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1147289276123047
Epoch: 8, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.841 Vali Acc: 0.280 Test Loss: 1.841 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0225629806518555
Epoch: 9, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.979 Vali Acc: 0.320 Test Loss: 1.979 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.050873279571533
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.135 Vali Acc: 0.260 Test Loss: 2.135 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.120255470275879
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.268 Vali Acc: 0.320 Test Loss: 2.268 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1381640434265137
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.422 Vali Acc: 0.340 Test Loss: 2.422 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0031368732452393
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.546 Vali Acc: 0.360 Test Loss: 2.546 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9619414806365967
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.620 Vali Acc: 0.360 Test Loss: 2.620 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7388687133789062
Epoch: 1, Steps: 4 | Train Loss: 1.744 Vali Loss: 1.628 Vali Acc: 0.200 Test Loss: 1.628 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.219269275665283
Epoch: 2, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.642 Vali Acc: 0.240 Test Loss: 1.642 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.9964241981506348
Epoch: 3, Steps: 4 | Train Loss: 1.227 Vali Loss: 1.684 Vali Acc: 0.300 Test Loss: 1.684 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.9947381019592285
Epoch: 4, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.691 Vali Acc: 0.300 Test Loss: 1.691 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.895376205444336
Epoch: 5, Steps: 4 | Train Loss: 0.429 Vali Loss: 1.732 Vali Acc: 0.200 Test Loss: 1.732 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9412715435028076
Epoch: 6, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.767 Vali Acc: 0.280 Test Loss: 1.767 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7994847297668457
Epoch: 7, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.946 Vali Acc: 0.300 Test Loss: 1.946 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8287055492401123
Epoch: 8, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.917 Vali Acc: 0.280 Test Loss: 1.917 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.060490369796753
Epoch: 9, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.022 Vali Acc: 0.260 Test Loss: 2.022 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8868067264556885
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.174 Vali Acc: 0.260 Test Loss: 2.174 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8617219924926758
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.312 Vali Acc: 0.260 Test Loss: 2.312 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9239614009857178
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.447 Vali Acc: 0.260 Test Loss: 2.447 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9720532894134521
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.552 Vali Acc: 0.260 Test Loss: 2.552 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8462395668029785
Epoch: 1, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.653 Vali Acc: 0.160 Test Loss: 1.653 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.8604342937469482
Epoch: 2, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.7755637168884277
Epoch: 3, Steps: 4 | Train Loss: 1.161 Vali Loss: 1.659 Vali Acc: 0.260 Test Loss: 1.659 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.7458884716033936
Epoch: 4, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.697 Vali Acc: 0.260 Test Loss: 1.697 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.777369499206543
Epoch: 5, Steps: 4 | Train Loss: 0.429 Vali Loss: 1.725 Vali Acc: 0.240 Test Loss: 1.725 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.816802978515625
Epoch: 6, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.810 Vali Acc: 0.220 Test Loss: 1.810 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7737386226654053
Epoch: 7, Steps: 4 | Train Loss: 0.112 Vali Loss: 2.001 Vali Acc: 0.200 Test Loss: 2.001 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7000036239624023
Epoch: 8, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.998 Vali Acc: 0.200 Test Loss: 1.998 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8363335132598877
Epoch: 9, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.133 Vali Acc: 0.260 Test Loss: 2.133 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7520616054534912
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.305 Vali Acc: 0.260 Test Loss: 2.305 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9090824127197266
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.435 Vali Acc: 0.260 Test Loss: 2.435 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7970499992370605
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.537 Vali Acc: 0.240 Test Loss: 2.537 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9981000423431396
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.605 Vali Acc: 0.220 Test Loss: 2.605 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.194380760192871
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.640 Vali Acc: 0.160 Test Loss: 1.640 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.6756091117858887
Epoch: 2, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.647 Vali Acc: 0.200 Test Loss: 1.647 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.7070057392120361
Epoch: 3, Steps: 4 | Train Loss: 1.203 Vali Loss: 1.684 Vali Acc: 0.220 Test Loss: 1.684 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.6252000331878662
Epoch: 4, Steps: 4 | Train Loss: 0.697 Vali Loss: 1.704 Vali Acc: 0.280 Test Loss: 1.704 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 1.8394670486450195
Epoch: 5, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.693 Vali Acc: 0.220 Test Loss: 1.693 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8625805377960205
Epoch: 6, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.774 Vali Acc: 0.220 Test Loss: 1.774 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.76450514793396
Epoch: 7, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.916 Vali Acc: 0.260 Test Loss: 1.916 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8535284996032715
Epoch: 8, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.933 Vali Acc: 0.260 Test Loss: 1.933 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.770784616470337
Epoch: 9, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.116 Vali Acc: 0.240 Test Loss: 2.116 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7528538703918457
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.352 Vali Acc: 0.240 Test Loss: 2.352 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.91912841796875
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.420 Vali Acc: 0.240 Test Loss: 2.420 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8018126487731934
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.435 Vali Acc: 0.240 Test Loss: 2.435 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7455430030822754
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.441 Vali Acc: 0.280 Test Loss: 2.441 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8475964069366455
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.430 Vali Acc: 0.260 Test Loss: 2.430 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6830267906188965
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.695 Vali Acc: 0.220 Test Loss: 1.695 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.8576877117156982
Epoch: 2, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.704 Vali Acc: 0.240 Test Loss: 1.704 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.928600549697876
Epoch: 3, Steps: 4 | Train Loss: 1.268 Vali Loss: 1.742 Vali Acc: 0.180 Test Loss: 1.742 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.837158203125
Epoch: 4, Steps: 4 | Train Loss: 0.750 Vali Loss: 1.730 Vali Acc: 0.300 Test Loss: 1.730 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 2.0314509868621826
Epoch: 5, Steps: 4 | Train Loss: 0.583 Vali Loss: 1.674 Vali Acc: 0.300 Test Loss: 1.674 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 1.7555952072143555
Epoch: 6, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.691 Vali Acc: 0.320 Test Loss: 1.691 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.8483455181121826
Epoch: 7, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.780 Vali Acc: 0.360 Test Loss: 1.780 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359982).  Saving model ...
Epoch: 8 cost time: 1.6784708499908447
Epoch: 8, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.829 Vali Acc: 0.360 Test Loss: 1.829 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7068331241607666
Epoch: 9, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.865 Vali Acc: 0.360 Test Loss: 1.865 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8171825408935547
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.020 Vali Acc: 0.300 Test Loss: 2.020 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7755868434906006
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.085 Vali Acc: 0.240 Test Loss: 2.085 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8264176845550537
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.089 Vali Acc: 0.280 Test Loss: 2.089 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6322057247161865
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.057 Vali Acc: 0.280 Test Loss: 2.057 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8409175872802734
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.992 Vali Acc: 0.320 Test Loss: 1.992 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9664921760559082
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.340 Test Loss: 1.960 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.797255277633667
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.966 Vali Acc: 0.340 Test Loss: 1.966 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9320619106292725
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.023 Vali Acc: 0.300 Test Loss: 2.023 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4817986488342285
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.683 Vali Acc: 0.180 Test Loss: 1.683 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.898782730102539
Epoch: 2, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.694 Vali Acc: 0.140 Test Loss: 1.694 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9151806831359863
Epoch: 3, Steps: 4 | Train Loss: 1.432 Vali Loss: 1.754 Vali Acc: 0.180 Test Loss: 1.754 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8618769645690918
Epoch: 4, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.796 Vali Acc: 0.240 Test Loss: 1.796 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239982).  Saving model ...
Epoch: 5 cost time: 1.831996202468872
Epoch: 5, Steps: 4 | Train Loss: 1.012 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9416635036468506
Epoch: 6, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.680 Vali Acc: 0.260 Test Loss: 1.680 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 1.819908857345581
Epoch: 7, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.743 Vali Acc: 0.260 Test Loss: 1.743 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9654409885406494
Epoch: 8, Steps: 4 | Train Loss: 0.408 Vali Loss: 1.826 Vali Acc: 0.200 Test Loss: 1.826 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9436779022216797
Epoch: 9, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.869 Vali Acc: 0.180 Test Loss: 1.869 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9331049919128418
Epoch: 10, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.896 Vali Acc: 0.200 Test Loss: 1.896 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.103163003921509
Epoch: 11, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.815 Vali Acc: 0.200 Test Loss: 1.815 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8620667457580566
Epoch: 12, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.673 Vali Acc: 0.160 Test Loss: 1.673 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7274127006530762
Epoch: 13, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7798278331756592
Epoch: 14, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.603 Vali Acc: 0.240 Test Loss: 1.603 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8557066917419434
Epoch: 15, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.630 Vali Acc: 0.320 Test Loss: 1.630 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319984).  Saving model ...
Epoch: 16 cost time: 1.858161211013794
Epoch: 16, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.715451955795288
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.788 Vali Acc: 0.280 Test Loss: 1.788 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8856022357940674
Epoch: 18, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.717 Vali Acc: 0.280 Test Loss: 1.717 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7936561107635498
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.518 Vali Acc: 0.280 Test Loss: 1.518 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9682338237762451
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9273676872253418
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.648 Vali Acc: 0.300 Test Loss: 1.648 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9201056957244873
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.320 Test Loss: 1.720 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0929319858551025
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.749 Vali Acc: 0.280 Test Loss: 1.749 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0399694442749023
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.300 Test Loss: 1.754 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.15643572807312
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.280 Test Loss: 1.779 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4564943313598633
Epoch: 1, Steps: 4 | Train Loss: 1.759 Vali Loss: 1.729 Vali Acc: 0.120 Test Loss: 1.729 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.6733038425445557
Epoch: 2, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.750 Vali Acc: 0.220 Test Loss: 1.750 Test Acc: 0.220
Validation loss decreased (-0.119983 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.7482290267944336
Epoch: 3, Steps: 4 | Train Loss: 1.422 Vali Loss: 1.797 Vali Acc: 0.100 Test Loss: 1.797 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.595031976699829
Epoch: 4, Steps: 4 | Train Loss: 1.085 Vali Loss: 1.790 Vali Acc: 0.080 Test Loss: 1.790 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7129426002502441
Epoch: 5, Steps: 4 | Train Loss: 0.995 Vali Loss: 1.735 Vali Acc: 0.160 Test Loss: 1.735 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7527546882629395
Epoch: 6, Steps: 4 | Train Loss: 0.607 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239983).  Saving model ...
Epoch: 7 cost time: 1.876115083694458
Epoch: 7, Steps: 4 | Train Loss: 0.474 Vali Loss: 1.759 Vali Acc: 0.140 Test Loss: 1.759 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.888887643814087
Epoch: 8, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.800 Vali Acc: 0.120 Test Loss: 1.800 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.775871753692627
Epoch: 9, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.818 Vali Acc: 0.120 Test Loss: 1.818 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9103202819824219
Epoch: 10, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.822 Vali Acc: 0.140 Test Loss: 1.822 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.001134157180786
Epoch: 11, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.819 Vali Acc: 0.120 Test Loss: 1.819 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7949237823486328
Epoch: 12, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.754 Vali Acc: 0.140 Test Loss: 1.754 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7070798873901367
Epoch: 13, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.685 Vali Acc: 0.200 Test Loss: 1.685 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7442491054534912
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.651 Vali Acc: 0.280 Test Loss: 1.651 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 15 cost time: 1.8119189739227295
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.699 Vali Acc: 0.340 Test Loss: 1.699 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339983).  Saving model ...
Epoch: 16 cost time: 1.7132148742675781
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.731 Vali Acc: 0.300 Test Loss: 1.731 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6546354293823242
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.805 Vali Acc: 0.280 Test Loss: 1.805 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.652405023574829
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.839 Vali Acc: 0.220 Test Loss: 1.839 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.665435552597046
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.300 Test Loss: 1.730 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.763258695602417
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.685 Vali Acc: 0.260 Test Loss: 1.685 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7944517135620117
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.280 Test Loss: 1.702 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8834898471832275
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.280 Test Loss: 1.744 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8476612567901611
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.320 Test Loss: 1.774 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7443742752075195
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.340 Test Loss: 1.784 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9342224597930908
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.320 Test Loss: 1.805 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4405765
model size : 26.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9677724838256836
Epoch: 1, Steps: 4 | Train Loss: 1.642 Vali Loss: 1.625 Vali Acc: 0.220 Test Loss: 1.625 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9970951080322266
Epoch: 2, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.646 Vali Acc: 0.240 Test Loss: 1.646 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.1015353202819824
Epoch: 3, Steps: 4 | Train Loss: 1.260 Vali Loss: 1.697 Vali Acc: 0.240 Test Loss: 1.697 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.922825813293457
Epoch: 4, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.795 Vali Acc: 0.340 Test Loss: 1.795 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339982).  Saving model ...
Epoch: 5 cost time: 2.0802295207977295
Epoch: 5, Steps: 4 | Train Loss: 0.464 Vali Loss: 1.715 Vali Acc: 0.240 Test Loss: 1.715 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0987675189971924
Epoch: 6, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.932 Vali Acc: 0.260 Test Loss: 1.932 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9618377685546875
Epoch: 7, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.978 Vali Acc: 0.340 Test Loss: 1.978 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9719185829162598
Epoch: 8, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.926 Vali Acc: 0.300 Test Loss: 1.926 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.970597267150879
Epoch: 9, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.237 Vali Acc: 0.300 Test Loss: 2.237 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9556243419647217
Epoch: 10, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.430 Vali Acc: 0.340 Test Loss: 2.430 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.929518699645996
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.302 Vali Acc: 0.380 Test Loss: 2.302 Test Acc: 0.380
Validation loss decreased (-0.339982 --> -0.379977).  Saving model ...
Epoch: 12 cost time: 1.8266229629516602
Epoch: 12, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.371 Vali Acc: 0.340 Test Loss: 2.371 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8743023872375488
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.671 Vali Acc: 0.260 Test Loss: 2.671 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9806320667266846
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.917 Vali Acc: 0.240 Test Loss: 2.917 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.014460325241089
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.937 Vali Acc: 0.260 Test Loss: 2.937 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8785209655761719
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.880 Vali Acc: 0.260 Test Loss: 2.880 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9014256000518799
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.813 Vali Acc: 0.260 Test Loss: 2.813 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9603030681610107
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.752 Vali Acc: 0.280 Test Loss: 2.752 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1008996963500977
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.719 Vali Acc: 0.300 Test Loss: 2.719 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9405901432037354
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.300 Test Loss: 2.708 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9376652240753174
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.720 Vali Acc: 0.300 Test Loss: 2.720 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.469815492630005
Epoch: 1, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.641 Vali Acc: 0.220 Test Loss: 1.641 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.84763503074646
Epoch: 2, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.650 Vali Acc: 0.200 Test Loss: 1.650 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9494349956512451
Epoch: 3, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.698 Vali Acc: 0.220 Test Loss: 1.698 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7758278846740723
Epoch: 4, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.809 Vali Acc: 0.280 Test Loss: 1.809 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279982).  Saving model ...
Epoch: 5 cost time: 2.0286781787872314
Epoch: 5, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.709 Vali Acc: 0.240 Test Loss: 1.709 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8142504692077637
Epoch: 6, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.909 Vali Acc: 0.240 Test Loss: 1.909 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.819835901260376
Epoch: 7, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.944 Vali Acc: 0.280 Test Loss: 1.944 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9673943519592285
Epoch: 8, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.896 Vali Acc: 0.200 Test Loss: 1.896 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9976024627685547
Epoch: 9, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.173 Vali Acc: 0.240 Test Loss: 2.173 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0536413192749023
Epoch: 10, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.384 Vali Acc: 0.280 Test Loss: 2.384 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8743703365325928
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.241 Vali Acc: 0.340 Test Loss: 2.241 Test Acc: 0.340
Validation loss decreased (-0.279982 --> -0.339978).  Saving model ...
Epoch: 12 cost time: 2.0013723373413086
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.256 Vali Acc: 0.300 Test Loss: 2.256 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8827157020568848
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.536 Vali Acc: 0.260 Test Loss: 2.536 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.838639736175537
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.790 Vali Acc: 0.240 Test Loss: 2.790 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7869877815246582
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.829 Vali Acc: 0.240 Test Loss: 2.829 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7820847034454346
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.764 Vali Acc: 0.260 Test Loss: 2.764 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8505842685699463
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.682 Vali Acc: 0.260 Test Loss: 2.682 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.900122880935669
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.607 Vali Acc: 0.260 Test Loss: 2.607 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9163248538970947
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.564 Vali Acc: 0.280 Test Loss: 2.564 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8357086181640625
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.550 Vali Acc: 0.300 Test Loss: 2.550 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.009397268295288
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.563 Vali Acc: 0.300 Test Loss: 2.563 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2125818729400635
Epoch: 1, Steps: 4 | Train Loss: 1.685 Vali Loss: 1.672 Vali Acc: 0.200 Test Loss: 1.672 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.010314464569092
Epoch: 2, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.701 Vali Acc: 0.160 Test Loss: 1.701 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.646921157836914
Epoch: 3, Steps: 4 | Train Loss: 1.234 Vali Loss: 1.763 Vali Acc: 0.180 Test Loss: 1.763 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8194632530212402
Epoch: 4, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.881 Vali Acc: 0.220 Test Loss: 1.881 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219981).  Saving model ...
Epoch: 5 cost time: 1.7540364265441895
Epoch: 5, Steps: 4 | Train Loss: 0.464 Vali Loss: 1.784 Vali Acc: 0.240 Test Loss: 1.784 Test Acc: 0.240
Validation loss decreased (-0.219981 --> -0.239982).  Saving model ...
Epoch: 6 cost time: 1.920337438583374
Epoch: 6, Steps: 4 | Train Loss: 0.247 Vali Loss: 2.023 Vali Acc: 0.240 Test Loss: 2.023 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8983550071716309
Epoch: 7, Steps: 4 | Train Loss: 0.132 Vali Loss: 2.103 Vali Acc: 0.300 Test Loss: 2.103 Test Acc: 0.300
Validation loss decreased (-0.239982 --> -0.299979).  Saving model ...
Epoch: 8 cost time: 1.8255538940429688
Epoch: 8, Steps: 4 | Train Loss: 0.076 Vali Loss: 2.058 Vali Acc: 0.300 Test Loss: 2.058 Test Acc: 0.300
Validation loss decreased (-0.299979 --> -0.299979).  Saving model ...
Epoch: 9 cost time: 1.890296459197998
Epoch: 9, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.327 Vali Acc: 0.260 Test Loss: 2.327 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9023563861846924
Epoch: 10, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.585 Vali Acc: 0.220 Test Loss: 2.585 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9664726257324219
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.586 Vali Acc: 0.260 Test Loss: 2.586 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0356557369232178
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.617 Vali Acc: 0.260 Test Loss: 2.617 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9033586978912354
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.791 Vali Acc: 0.280 Test Loss: 2.791 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9789097309112549
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.971 Vali Acc: 0.280 Test Loss: 2.971 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9994432926177979
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.028 Vali Acc: 0.260 Test Loss: 3.028 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8164520263671875
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.005 Vali Acc: 0.260 Test Loss: 3.005 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.873641014099121
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.954 Vali Acc: 0.280 Test Loss: 2.954 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8023245334625244
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.899 Vali Acc: 0.280 Test Loss: 2.899 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.204514503479004
Epoch: 1, Steps: 4 | Train Loss: 1.770 Vali Loss: 1.654 Vali Acc: 0.200 Test Loss: 1.654 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.0396745204925537
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.681 Vali Acc: 0.200 Test Loss: 1.681 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.022749423980713
Epoch: 3, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.729 Vali Acc: 0.200 Test Loss: 1.729 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1103549003601074
Epoch: 4, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.773 Vali Acc: 0.320 Test Loss: 1.773 Test Acc: 0.320
Validation loss decreased (-0.199983 --> -0.319982).  Saving model ...
Epoch: 5 cost time: 2.039673328399658
Epoch: 5, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.666 Vali Acc: 0.320 Test Loss: 1.666 Test Acc: 0.320
Validation loss decreased (-0.319982 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 2.0043275356292725
Epoch: 6, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.913 Vali Acc: 0.260 Test Loss: 1.913 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9823672771453857
Epoch: 7, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.995 Vali Acc: 0.260 Test Loss: 1.995 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.081869125366211
Epoch: 8, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.901 Vali Acc: 0.280 Test Loss: 1.901 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9102177619934082
Epoch: 9, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.069 Vali Acc: 0.320 Test Loss: 2.069 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9115159511566162
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.280 Vali Acc: 0.260 Test Loss: 2.280 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7366347312927246
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.318 Vali Acc: 0.280 Test Loss: 2.318 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8592970371246338
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.370 Vali Acc: 0.280 Test Loss: 2.370 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.795785665512085
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.444 Vali Acc: 0.260 Test Loss: 2.444 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8809752464294434
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.516 Vali Acc: 0.280 Test Loss: 2.516 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7688970565795898
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.576 Vali Acc: 0.300 Test Loss: 2.576 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6065664291381836
Epoch: 1, Steps: 4 | Train Loss: 1.717 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.7764112949371338
Epoch: 2, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.646 Vali Acc: 0.180 Test Loss: 1.646 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7548017501831055
Epoch: 3, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.699 Vali Acc: 0.140 Test Loss: 1.699 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6631741523742676
Epoch: 4, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.780 Vali Acc: 0.220 Test Loss: 1.780 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219982).  Saving model ...
Epoch: 5 cost time: 1.6125879287719727
Epoch: 5, Steps: 4 | Train Loss: 0.448 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 1.763047695159912
Epoch: 6, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.900 Vali Acc: 0.160 Test Loss: 1.900 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7882473468780518
Epoch: 7, Steps: 4 | Train Loss: 0.117 Vali Loss: 2.008 Vali Acc: 0.220 Test Loss: 2.008 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7052838802337646
Epoch: 8, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.952 Vali Acc: 0.140 Test Loss: 1.952 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8387455940246582
Epoch: 9, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.048 Vali Acc: 0.240 Test Loss: 2.048 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6545920372009277
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.274 Vali Acc: 0.240 Test Loss: 2.274 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9055521488189697
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.309 Vali Acc: 0.260 Test Loss: 2.309 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259977).  Saving model ...
Epoch: 12 cost time: 1.8075742721557617
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.354 Vali Acc: 0.260 Test Loss: 2.354 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8478367328643799
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.429 Vali Acc: 0.280 Test Loss: 2.429 Test Acc: 0.280
Validation loss decreased (-0.259977 --> -0.279976).  Saving model ...
Epoch: 14 cost time: 2.088454246520996
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.488 Vali Acc: 0.240 Test Loss: 2.488 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8785593509674072
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.533 Vali Acc: 0.220 Test Loss: 2.533 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9550814628601074
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.555 Vali Acc: 0.220 Test Loss: 2.555 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9754743576049805
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.560 Vali Acc: 0.220 Test Loss: 2.560 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7770566940307617
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.547 Vali Acc: 0.220 Test Loss: 2.547 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7851340770721436
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.200 Test Loss: 2.548 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7472012042999268
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.560 Vali Acc: 0.200 Test Loss: 2.560 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7835795879364014
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.200 Test Loss: 2.593 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8165700435638428
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.608 Vali Acc: 0.200 Test Loss: 2.608 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8641917705535889
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.602 Vali Acc: 0.200 Test Loss: 2.602 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8623998165130615
Epoch: 1, Steps: 4 | Train Loss: 1.751 Vali Loss: 1.724 Vali Acc: 0.060 Test Loss: 1.724 Test Acc: 0.060
Validation loss decreased (inf --> -0.059983).  Saving model ...
Epoch: 2 cost time: 1.8692433834075928
Epoch: 2, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.683 Vali Acc: 0.100 Test Loss: 1.683 Test Acc: 0.100
Validation loss decreased (-0.059983 --> -0.099983).  Saving model ...
Epoch: 3 cost time: 1.8570663928985596
Epoch: 3, Steps: 4 | Train Loss: 1.301 Vali Loss: 1.706 Vali Acc: 0.160 Test Loss: 1.706 Test Acc: 0.160
Validation loss decreased (-0.099983 --> -0.159983).  Saving model ...
Epoch: 4 cost time: 1.9078915119171143
Epoch: 4, Steps: 4 | Train Loss: 1.047 Vali Loss: 1.826 Vali Acc: 0.220 Test Loss: 1.826 Test Acc: 0.220
Validation loss decreased (-0.159983 --> -0.219982).  Saving model ...
Epoch: 5 cost time: 1.8422837257385254
Epoch: 5, Steps: 4 | Train Loss: 0.477 Vali Loss: 1.757 Vali Acc: 0.240 Test Loss: 1.757 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239982).  Saving model ...
Epoch: 6 cost time: 1.9756293296813965
Epoch: 6, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.887 Vali Acc: 0.200 Test Loss: 1.887 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6947925090789795
Epoch: 7, Steps: 4 | Train Loss: 0.103 Vali Loss: 2.046 Vali Acc: 0.220 Test Loss: 2.046 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8094329833984375
Epoch: 8, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.059 Vali Acc: 0.220 Test Loss: 2.059 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7528069019317627
Epoch: 9, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.093 Vali Acc: 0.260 Test Loss: 2.093 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259979).  Saving model ...
Epoch: 10 cost time: 1.8824892044067383
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.295 Vali Acc: 0.220 Test Loss: 2.295 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.764052391052246
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.407 Vali Acc: 0.260 Test Loss: 2.407 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.699986457824707
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.493 Vali Acc: 0.260 Test Loss: 2.493 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6949348449707031
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.564 Vali Acc: 0.260 Test Loss: 2.564 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7372913360595703
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.601 Vali Acc: 0.260 Test Loss: 2.601 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.016589641571045
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.619 Vali Acc: 0.260 Test Loss: 2.619 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8924996852874756
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.625 Vali Acc: 0.260 Test Loss: 2.625 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.853534460067749
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.625 Vali Acc: 0.260 Test Loss: 2.625 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.905141830444336
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.623 Vali Acc: 0.260 Test Loss: 2.623 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9674408435821533
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.260 Test Loss: 2.639 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6476492881774902
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.652 Vali Acc: 0.180 Test Loss: 1.652 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.7435483932495117
Epoch: 2, Steps: 4 | Train Loss: 1.544 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.8697624206542969
Epoch: 3, Steps: 4 | Train Loss: 1.298 Vali Loss: 1.640 Vali Acc: 0.180 Test Loss: 1.640 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8293702602386475
Epoch: 4, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.756 Vali Acc: 0.260 Test Loss: 1.756 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 5 cost time: 1.778883695602417
Epoch: 5, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.706 Vali Acc: 0.260 Test Loss: 1.706 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.9532227516174316
Epoch: 6, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.846 Vali Acc: 0.240 Test Loss: 1.846 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0613842010498047
Epoch: 7, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.950 Vali Acc: 0.260 Test Loss: 1.950 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9286231994628906
Epoch: 8, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.954 Vali Acc: 0.240 Test Loss: 1.954 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.829399824142456
Epoch: 9, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.923 Vali Acc: 0.280 Test Loss: 1.923 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279981).  Saving model ...
Epoch: 10 cost time: 1.8688337802886963
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.091 Vali Acc: 0.240 Test Loss: 2.091 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9259426593780518
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.259 Vali Acc: 0.220 Test Loss: 2.259 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.016289234161377
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.407 Vali Acc: 0.220 Test Loss: 2.407 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7396411895751953
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.505 Vali Acc: 0.220 Test Loss: 2.505 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7596828937530518
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.541 Vali Acc: 0.280 Test Loss: 2.541 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.770493745803833
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.542 Vali Acc: 0.300 Test Loss: 2.542 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299975).  Saving model ...
Epoch: 16 cost time: 1.7305572032928467
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.528 Vali Acc: 0.320 Test Loss: 2.528 Test Acc: 0.320
Validation loss decreased (-0.299975 --> -0.319975).  Saving model ...
Epoch: 17 cost time: 1.8556756973266602
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.504 Vali Acc: 0.320 Test Loss: 2.504 Test Acc: 0.320
Validation loss decreased (-0.319975 --> -0.319975).  Saving model ...
Epoch: 18 cost time: 1.716822624206543
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.481 Vali Acc: 0.320 Test Loss: 2.481 Test Acc: 0.320
Validation loss decreased (-0.319975 --> -0.319975).  Saving model ...
Epoch: 19 cost time: 1.766998052597046
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.477 Vali Acc: 0.300 Test Loss: 2.477 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.688615083694458
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.483 Vali Acc: 0.300 Test Loss: 2.483 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.782886028289795
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.498 Vali Acc: 0.300 Test Loss: 2.498 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8804540634155273
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.300 Test Loss: 2.509 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7882521152496338
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.510 Vali Acc: 0.300 Test Loss: 2.510 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7332251071929932
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.511 Vali Acc: 0.300 Test Loss: 2.511 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7869420051574707
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.300 Test Loss: 2.513 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.916060209274292
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.519 Vali Acc: 0.280 Test Loss: 2.519 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.868361473083496
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.523 Vali Acc: 0.280 Test Loss: 2.523 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.684560775756836
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.514 Vali Acc: 0.260 Test Loss: 2.514 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7221615314483643
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.642 Vali Acc: 0.240 Test Loss: 1.642 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.6953096389770508
Epoch: 2, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.645 Vali Acc: 0.280 Test Loss: 1.645 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.667220115661621
Epoch: 3, Steps: 4 | Train Loss: 1.414 Vali Loss: 1.644 Vali Acc: 0.240 Test Loss: 1.644 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.05295467376709
Epoch: 4, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.686 Vali Acc: 0.240 Test Loss: 1.686 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8435406684875488
Epoch: 5, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.862069845199585
Epoch: 6, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.668 Vali Acc: 0.320 Test Loss: 1.668 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.8792839050292969
Epoch: 7, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.709 Vali Acc: 0.240 Test Loss: 1.709 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.944007158279419
Epoch: 8, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.743 Vali Acc: 0.220 Test Loss: 1.743 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9326732158660889
Epoch: 9, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.711 Vali Acc: 0.280 Test Loss: 1.711 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7959494590759277
Epoch: 10, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.813 Vali Acc: 0.260 Test Loss: 1.813 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7614152431488037
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.961 Vali Acc: 0.260 Test Loss: 1.961 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9021761417388916
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.064 Vali Acc: 0.260 Test Loss: 2.064 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.774343729019165
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.124 Vali Acc: 0.200 Test Loss: 2.124 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8630497455596924
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.127 Vali Acc: 0.220 Test Loss: 2.127 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7240352630615234
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.104 Vali Acc: 0.240 Test Loss: 2.104 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7627720832824707
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.077 Vali Acc: 0.240 Test Loss: 2.077 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8181710243225098
Epoch: 1, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.774 Vali Acc: 0.160 Test Loss: 1.774 Test Acc: 0.160
Validation loss decreased (inf --> -0.159982).  Saving model ...
Epoch: 2 cost time: 2.017669200897217
Epoch: 2, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.789 Vali Acc: 0.080 Test Loss: 1.789 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.905405044555664
Epoch: 3, Steps: 4 | Train Loss: 1.486 Vali Loss: 1.812 Vali Acc: 0.100 Test Loss: 1.812 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.995138168334961
Epoch: 4, Steps: 4 | Train Loss: 1.284 Vali Loss: 1.884 Vali Acc: 0.080 Test Loss: 1.884 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0438530445098877
Epoch: 5, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.824 Vali Acc: 0.100 Test Loss: 1.824 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.827807903289795
Epoch: 6, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.806 Vali Acc: 0.160 Test Loss: 1.806 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8343501091003418
Epoch: 7, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.824 Vali Acc: 0.100 Test Loss: 1.824 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9230241775512695
Epoch: 8, Steps: 4 | Train Loss: 0.301 Vali Loss: 1.854 Vali Acc: 0.140 Test Loss: 1.854 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9655025005340576
Epoch: 9, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.801 Vali Acc: 0.140 Test Loss: 1.801 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.824690341949463
Epoch: 10, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.799 Vali Acc: 0.160 Test Loss: 1.799 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7908365726470947
Epoch: 11, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.964 Vali Acc: 0.160 Test Loss: 1.964 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.16
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2006025314331055
Epoch: 1, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.755 Vali Acc: 0.200 Test Loss: 1.755 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.7268142700195312
Epoch: 2, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.763 Vali Acc: 0.160 Test Loss: 1.763 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7021567821502686
Epoch: 3, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.785 Vali Acc: 0.160 Test Loss: 1.785 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.779801607131958
Epoch: 4, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.825 Vali Acc: 0.200 Test Loss: 1.825 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8760905265808105
Epoch: 5, Steps: 4 | Train Loss: 0.787 Vali Loss: 1.737 Vali Acc: 0.220 Test Loss: 1.737 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219983).  Saving model ...
Epoch: 6 cost time: 1.882582426071167
Epoch: 6, Steps: 4 | Train Loss: 0.625 Vali Loss: 1.726 Vali Acc: 0.240 Test Loss: 1.726 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 7 cost time: 1.7911505699157715
Epoch: 7, Steps: 4 | Train Loss: 0.339 Vali Loss: 1.726 Vali Acc: 0.200 Test Loss: 1.726 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9985642433166504
Epoch: 8, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.784 Vali Acc: 0.200 Test Loss: 1.784 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.875225305557251
Epoch: 9, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.693 Vali Acc: 0.200 Test Loss: 1.693 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9276950359344482
Epoch: 10, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 11 cost time: 1.8287954330444336
Epoch: 11, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.885 Vali Acc: 0.180 Test Loss: 1.885 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8800311088562012
Epoch: 12, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.893 Vali Acc: 0.200 Test Loss: 1.893 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9249517917633057
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.885 Vali Acc: 0.280 Test Loss: 1.885 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279981).  Saving model ...
Epoch: 14 cost time: 1.8659253120422363
Epoch: 14, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.829 Vali Acc: 0.260 Test Loss: 1.829 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7682216167449951
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7995386123657227
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.798 Vali Acc: 0.260 Test Loss: 1.798 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7471954822540283
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.844 Vali Acc: 0.260 Test Loss: 1.844 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8147141933441162
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.910 Vali Acc: 0.240 Test Loss: 1.910 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9708690643310547
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.943 Vali Acc: 0.300 Test Loss: 1.943 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299981).  Saving model ...
Epoch: 20 cost time: 1.8992643356323242
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.937 Vali Acc: 0.320 Test Loss: 1.937 Test Acc: 0.320
Validation loss decreased (-0.299981 --> -0.319981).  Saving model ...
Epoch: 21 cost time: 1.9156429767608643
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.931 Vali Acc: 0.300 Test Loss: 1.931 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8872654438018799
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.926 Vali Acc: 0.280 Test Loss: 1.926 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8603439331054688
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.918 Vali Acc: 0.260 Test Loss: 1.918 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.869096040725708
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.260 Test Loss: 1.917 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8910629749298096
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.925 Vali Acc: 0.260 Test Loss: 1.925 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.798485279083252
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.280 Test Loss: 1.934 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7508718967437744
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.944 Vali Acc: 0.280 Test Loss: 1.944 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5832433700561523
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.280 Test Loss: 1.935 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.646101951599121
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.280 Test Loss: 1.930 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7244253158569336
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.280 Test Loss: 1.935 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4209157
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.787266492843628
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.625 Vali Acc: 0.180 Test Loss: 1.625 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.0094387531280518
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.672 Vali Acc: 0.200 Test Loss: 1.672 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 2.1452136039733887
Epoch: 3, Steps: 4 | Train Loss: 1.241 Vali Loss: 1.726 Vali Acc: 0.220 Test Loss: 1.726 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.9754002094268799
Epoch: 4, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.707 Vali Acc: 0.240 Test Loss: 1.707 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.9377191066741943
Epoch: 5, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.671 Vali Acc: 0.220 Test Loss: 1.671 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.841804027557373
Epoch: 6, Steps: 4 | Train Loss: 0.529 Vali Loss: 1.742 Vali Acc: 0.260 Test Loss: 1.742 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 1.7969436645507812
Epoch: 7, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.767 Vali Acc: 0.340 Test Loss: 1.767 Test Acc: 0.340
Validation loss decreased (-0.259983 --> -0.339982).  Saving model ...
Epoch: 8 cost time: 1.8386802673339844
Epoch: 8, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.800 Vali Acc: 0.340 Test Loss: 1.800 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7220144271850586
Epoch: 9, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.954 Vali Acc: 0.280 Test Loss: 1.954 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.808164358139038
Epoch: 10, Steps: 4 | Train Loss: 0.271 Vali Loss: 2.027 Vali Acc: 0.340 Test Loss: 2.027 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9490687847137451
Epoch: 11, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.910 Vali Acc: 0.340 Test Loss: 1.910 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9107844829559326
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.039 Vali Acc: 0.340 Test Loss: 2.039 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9813809394836426
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.335 Vali Acc: 0.340 Test Loss: 2.335 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1795074939727783
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.469 Vali Acc: 0.340 Test Loss: 2.469 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9880290031433105
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.372 Vali Acc: 0.320 Test Loss: 2.372 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1976020336151123
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.300 Vali Acc: 0.320 Test Loss: 2.300 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.029113292694092
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.260 Vali Acc: 0.320 Test Loss: 2.260 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.824038028717041
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.634 Vali Acc: 0.220 Test Loss: 1.634 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8714532852172852
Epoch: 2, Steps: 4 | Train Loss: 1.512 Vali Loss: 1.664 Vali Acc: 0.200 Test Loss: 1.664 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.15120005607605
Epoch: 3, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.707 Vali Acc: 0.200 Test Loss: 1.707 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.125274658203125
Epoch: 4, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.691 Vali Acc: 0.240 Test Loss: 1.691 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.9613056182861328
Epoch: 5, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.646 Vali Acc: 0.200 Test Loss: 1.646 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0083436965942383
Epoch: 6, Steps: 4 | Train Loss: 0.526 Vali Loss: 1.697 Vali Acc: 0.240 Test Loss: 1.697 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9146044254302979
Epoch: 7, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.720 Vali Acc: 0.240 Test Loss: 1.720 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8942303657531738
Epoch: 8, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.742 Vali Acc: 0.220 Test Loss: 1.742 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9648432731628418
Epoch: 9, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.868 Vali Acc: 0.260 Test Loss: 1.868 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259981).  Saving model ...
Epoch: 10 cost time: 1.746340036392212
Epoch: 10, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.938 Vali Acc: 0.280 Test Loss: 1.938 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279981).  Saving model ...
Epoch: 11 cost time: 1.808863878250122
Epoch: 11, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.819 Vali Acc: 0.260 Test Loss: 1.819 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8076825141906738
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.939 Vali Acc: 0.280 Test Loss: 1.939 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8602936267852783
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.261 Vali Acc: 0.280 Test Loss: 2.261 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8229608535766602
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.365 Vali Acc: 0.260 Test Loss: 2.365 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7550466060638428
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.242 Vali Acc: 0.300 Test Loss: 2.242 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299978).  Saving model ...
Epoch: 16 cost time: 1.836467981338501
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.168 Vali Acc: 0.320 Test Loss: 2.168 Test Acc: 0.320
Validation loss decreased (-0.299978 --> -0.319978).  Saving model ...
Epoch: 17 cost time: 1.9523968696594238
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.132 Vali Acc: 0.280 Test Loss: 2.132 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8799965381622314
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.126 Vali Acc: 0.260 Test Loss: 2.126 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.009408950805664
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.148 Vali Acc: 0.260 Test Loss: 2.148 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0610499382019043
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.193 Vali Acc: 0.280 Test Loss: 2.193 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0343542098999023
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.243 Vali Acc: 0.280 Test Loss: 2.243 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9770057201385498
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.297 Vali Acc: 0.240 Test Loss: 2.297 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1082589626312256
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.351 Vali Acc: 0.280 Test Loss: 2.351 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9301764965057373
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.377 Vali Acc: 0.260 Test Loss: 2.377 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.894920825958252
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.383 Vali Acc: 0.280 Test Loss: 2.383 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.944725751876831
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.390 Vali Acc: 0.280 Test Loss: 2.390 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.91506028175354
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.659 Vali Acc: 0.220 Test Loss: 1.659 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.9777982234954834
Epoch: 2, Steps: 4 | Train Loss: 1.491 Vali Loss: 1.678 Vali Acc: 0.220 Test Loss: 1.678 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9088246822357178
Epoch: 3, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.728 Vali Acc: 0.220 Test Loss: 1.728 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8618671894073486
Epoch: 4, Steps: 4 | Train Loss: 0.919 Vali Loss: 1.750 Vali Acc: 0.200 Test Loss: 1.750 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8585491180419922
Epoch: 5, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.738 Vali Acc: 0.240 Test Loss: 1.738 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 1.8196260929107666
Epoch: 6, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.787 Vali Acc: 0.280 Test Loss: 1.787 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279982).  Saving model ...
Epoch: 7 cost time: 1.8155393600463867
Epoch: 7, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.823 Vali Acc: 0.260 Test Loss: 1.823 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6844539642333984
Epoch: 8, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.885 Vali Acc: 0.280 Test Loss: 1.885 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8420753479003906
Epoch: 9, Steps: 4 | Train Loss: 0.148 Vali Loss: 2.066 Vali Acc: 0.280 Test Loss: 2.066 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8007936477661133
Epoch: 10, Steps: 4 | Train Loss: 0.228 Vali Loss: 2.169 Vali Acc: 0.260 Test Loss: 2.169 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7337467670440674
Epoch: 11, Steps: 4 | Train Loss: 0.044 Vali Loss: 2.053 Vali Acc: 0.260 Test Loss: 2.053 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.625114917755127
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.169 Vali Acc: 0.260 Test Loss: 2.169 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.693551778793335
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.507 Vali Acc: 0.300 Test Loss: 2.507 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299975).  Saving model ...
Epoch: 14 cost time: 1.721161127090454
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.735 Vali Acc: 0.300 Test Loss: 2.735 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8004133701324463
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.661 Vali Acc: 0.300 Test Loss: 2.661 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7607176303863525
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.569 Vali Acc: 0.300 Test Loss: 2.569 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8818590641021729
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.516 Vali Acc: 0.280 Test Loss: 2.516 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9636552333831787
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.500 Vali Acc: 0.280 Test Loss: 2.500 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8601593971252441
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.503 Vali Acc: 0.280 Test Loss: 2.503 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8396904468536377
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.530 Vali Acc: 0.280 Test Loss: 2.530 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9382047653198242
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.573 Vali Acc: 0.280 Test Loss: 2.573 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7084085941314697
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.633 Vali Acc: 0.280 Test Loss: 2.633 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7388052940368652
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.704 Vali Acc: 0.280 Test Loss: 2.704 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.191552400588989
Epoch: 1, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.635 Vali Acc: 0.260 Test Loss: 1.635 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.1396255493164062
Epoch: 2, Steps: 4 | Train Loss: 1.560 Vali Loss: 1.675 Vali Acc: 0.220 Test Loss: 1.675 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9708974361419678
Epoch: 3, Steps: 4 | Train Loss: 1.275 Vali Loss: 1.725 Vali Acc: 0.260 Test Loss: 1.725 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.191180467605591
Epoch: 4, Steps: 4 | Train Loss: 0.982 Vali Loss: 1.726 Vali Acc: 0.240 Test Loss: 1.726 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0417113304138184
Epoch: 5, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.669 Vali Acc: 0.260 Test Loss: 1.669 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9462840557098389
Epoch: 6, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.728 Vali Acc: 0.280 Test Loss: 1.728 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 7 cost time: 1.9992597103118896
Epoch: 7, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.782 Vali Acc: 0.280 Test Loss: 1.782 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8385350704193115
Epoch: 8, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.808 Vali Acc: 0.340 Test Loss: 1.808 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339982).  Saving model ...
Epoch: 9 cost time: 1.9272661209106445
Epoch: 9, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.915 Vali Acc: 0.320 Test Loss: 1.915 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9258427619934082
Epoch: 10, Steps: 4 | Train Loss: 0.181 Vali Loss: 2.055 Vali Acc: 0.260 Test Loss: 2.055 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8311738967895508
Epoch: 11, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.917 Vali Acc: 0.320 Test Loss: 1.917 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8289103507995605
Epoch: 12, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.987 Vali Acc: 0.340 Test Loss: 1.987 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9230690002441406
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.236 Vali Acc: 0.320 Test Loss: 2.236 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7908527851104736
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.595 Vali Acc: 0.300 Test Loss: 2.595 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7101545333862305
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.630 Vali Acc: 0.320 Test Loss: 2.630 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.946237564086914
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.496 Vali Acc: 0.320 Test Loss: 2.496 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1717400550842285
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.370 Vali Acc: 0.360 Test Loss: 2.370 Test Acc: 0.360
Validation loss decreased (-0.339982 --> -0.359976).  Saving model ...
Epoch: 18 cost time: 1.8176658153533936
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.299 Vali Acc: 0.360 Test Loss: 2.299 Test Acc: 0.360
Validation loss decreased (-0.359976 --> -0.359977).  Saving model ...
Epoch: 19 cost time: 1.8613331317901611
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.272 Vali Acc: 0.360 Test Loss: 2.272 Test Acc: 0.360
Validation loss decreased (-0.359977 --> -0.359977).  Saving model ...
Epoch: 20 cost time: 1.8625402450561523
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.280 Vali Acc: 0.360 Test Loss: 2.280 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8652448654174805
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.310 Vali Acc: 0.360 Test Loss: 2.310 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7258214950561523
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.360 Vali Acc: 0.360 Test Loss: 2.360 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7881438732147217
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.422 Vali Acc: 0.360 Test Loss: 2.422 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.850127935409546
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.469 Vali Acc: 0.360 Test Loss: 2.469 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7337455749511719
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.502 Vali Acc: 0.360 Test Loss: 2.502 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8135943412780762
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.535 Vali Acc: 0.360 Test Loss: 2.535 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8000741004943848
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.548 Vali Acc: 0.380 Test Loss: 2.548 Test Acc: 0.380
Validation loss decreased (-0.359977 --> -0.379975).  Saving model ...
Epoch: 28 cost time: 1.6329963207244873
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.550 Vali Acc: 0.380 Test Loss: 2.550 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5702545642852783
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.541 Vali Acc: 0.380 Test Loss: 2.541 Test Acc: 0.380
Validation loss decreased (-0.379975 --> -0.379975).  Saving model ...
Epoch: 30 cost time: 1.796299695968628
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.529 Vali Acc: 0.380 Test Loss: 2.529 Test Acc: 0.380
Validation loss decreased (-0.379975 --> -0.379975).  Saving model ...
Epoch: 31 cost time: 1.8547694683074951
Epoch: 31, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.515 Vali Acc: 0.360 Test Loss: 2.515 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0087201595306396
Epoch: 32, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.501 Vali Acc: 0.380 Test Loss: 2.501 Test Acc: 0.380
Validation loss decreased (-0.379975 --> -0.379975).  Saving model ...
Epoch: 33 cost time: 1.795060396194458
Epoch: 33, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.494 Vali Acc: 0.380 Test Loss: 2.494 Test Acc: 0.380
Validation loss decreased (-0.379975 --> -0.379975).  Saving model ...
Epoch: 34 cost time: 1.9579076766967773
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.488 Vali Acc: 0.360 Test Loss: 2.488 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.125936269760132
Epoch: 35, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.482 Vali Acc: 0.360 Test Loss: 2.482 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.889880657196045
Epoch: 36, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.474 Vali Acc: 0.360 Test Loss: 2.474 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.837536096572876
Epoch: 37, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.471 Vali Acc: 0.360 Test Loss: 2.471 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8396086692810059
Epoch: 38, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.480 Vali Acc: 0.360 Test Loss: 2.480 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7533819675445557
Epoch: 39, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.487 Vali Acc: 0.360 Test Loss: 2.487 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7073001861572266
Epoch: 40, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.487 Vali Acc: 0.360 Test Loss: 2.487 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8580248355865479
Epoch: 41, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.474 Vali Acc: 0.360 Test Loss: 2.474 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8392689228057861
Epoch: 42, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.471 Vali Acc: 0.360 Test Loss: 2.471 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9137287139892578
Epoch: 43, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.477 Vali Acc: 0.380 Test Loss: 2.477 Test Acc: 0.380
Validation loss decreased (-0.379975 --> -0.379975).  Saving model ...
Epoch: 44 cost time: 1.9149563312530518
Epoch: 44, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.488 Vali Acc: 0.380 Test Loss: 2.488 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9370436668395996
Epoch: 45, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.507 Vali Acc: 0.380 Test Loss: 2.507 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9907503128051758
Epoch: 46, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.380 Test Loss: 2.528 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.3598086833953857
Epoch: 47, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.542 Vali Acc: 0.380 Test Loss: 2.542 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.989069938659668
Epoch: 48, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.380 Test Loss: 2.546 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.9809885025024414
Epoch: 49, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.380 Test Loss: 2.546 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8920142650604248
Epoch: 50, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.543 Vali Acc: 0.380 Test Loss: 2.543 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.805863380432129
Epoch: 51, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.380 Test Loss: 2.540 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.759636640548706
Epoch: 52, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.532 Vali Acc: 0.380 Test Loss: 2.532 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.7411823272705078
Epoch: 53, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.527 Vali Acc: 0.380 Test Loss: 2.527 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7163000106811523
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.671 Vali Acc: 0.140 Test Loss: 1.671 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.8222038745880127
Epoch: 2, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.696 Vali Acc: 0.160 Test Loss: 1.696 Test Acc: 0.160
Validation loss decreased (-0.139983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.7979135513305664
Epoch: 3, Steps: 4 | Train Loss: 1.248 Vali Loss: 1.728 Vali Acc: 0.200 Test Loss: 1.728 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.8834707736968994
Epoch: 4, Steps: 4 | Train Loss: 0.945 Vali Loss: 1.752 Vali Acc: 0.220 Test Loss: 1.752 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219982).  Saving model ...
Epoch: 5 cost time: 1.8181235790252686
Epoch: 5, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.727 Vali Acc: 0.180 Test Loss: 1.727 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6977224349975586
Epoch: 6, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.804 Vali Acc: 0.200 Test Loss: 1.804 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.742931604385376
Epoch: 7, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.854 Vali Acc: 0.180 Test Loss: 1.854 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8243107795715332
Epoch: 8, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.853 Vali Acc: 0.240 Test Loss: 1.853 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239981).  Saving model ...
Epoch: 9 cost time: 1.770460844039917
Epoch: 9, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.994 Vali Acc: 0.240 Test Loss: 1.994 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7439441680908203
Epoch: 10, Steps: 4 | Train Loss: 0.155 Vali Loss: 2.175 Vali Acc: 0.180 Test Loss: 2.175 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8052563667297363
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 2.068 Vali Acc: 0.200 Test Loss: 2.068 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7266793251037598
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.085 Vali Acc: 0.240 Test Loss: 2.085 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7089424133300781
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.266 Vali Acc: 0.180 Test Loss: 2.266 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.748953104019165
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.553 Vali Acc: 0.200 Test Loss: 2.553 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8870127201080322
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.668 Vali Acc: 0.220 Test Loss: 2.668 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.051698684692383
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.632 Vali Acc: 0.220 Test Loss: 2.632 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.872687578201294
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.553 Vali Acc: 0.240 Test Loss: 2.553 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9500172138214111
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.482 Vali Acc: 0.220 Test Loss: 2.482 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7883760929107666
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.590 Vali Acc: 0.280 Test Loss: 1.590 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.6767208576202393
Epoch: 2, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.612 Vali Acc: 0.240 Test Loss: 1.612 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6797220706939697
Epoch: 3, Steps: 4 | Train Loss: 1.276 Vali Loss: 1.629 Vali Acc: 0.240 Test Loss: 1.629 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9054245948791504
Epoch: 4, Steps: 4 | Train Loss: 1.023 Vali Loss: 1.661 Vali Acc: 0.220 Test Loss: 1.661 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7362442016601562
Epoch: 5, Steps: 4 | Train Loss: 0.661 Vali Loss: 1.651 Vali Acc: 0.280 Test Loss: 1.651 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.766660451889038
Epoch: 6, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.731 Vali Acc: 0.240 Test Loss: 1.731 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9180114269256592
Epoch: 7, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.774 Vali Acc: 0.260 Test Loss: 1.774 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.855546474456787
Epoch: 8, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.777 Vali Acc: 0.240 Test Loss: 1.777 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8113529682159424
Epoch: 9, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.945 Vali Acc: 0.260 Test Loss: 1.945 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8749744892120361
Epoch: 10, Steps: 4 | Train Loss: 0.119 Vali Loss: 2.166 Vali Acc: 0.240 Test Loss: 2.166 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8526055812835693
Epoch: 11, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.088 Vali Acc: 0.260 Test Loss: 2.088 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6414875984191895
Epoch: 1, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.550 Vali Acc: 0.260 Test Loss: 1.550 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.711251974105835
Epoch: 2, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.555 Vali Acc: 0.220 Test Loss: 1.555 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.720778226852417
Epoch: 3, Steps: 4 | Train Loss: 1.290 Vali Loss: 1.571 Vali Acc: 0.220 Test Loss: 1.571 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.892509937286377
Epoch: 4, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.000678062438965
Epoch: 5, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.571 Vali Acc: 0.260 Test Loss: 1.571 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8837754726409912
Epoch: 6, Steps: 4 | Train Loss: 0.580 Vali Loss: 1.638 Vali Acc: 0.280 Test Loss: 1.638 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.8503234386444092
Epoch: 7, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.656 Vali Acc: 0.280 Test Loss: 1.656 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7471187114715576
Epoch: 8, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.647 Vali Acc: 0.280 Test Loss: 1.647 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8869414329528809
Epoch: 9, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.775 Vali Acc: 0.260 Test Loss: 1.775 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9958765506744385
Epoch: 10, Steps: 4 | Train Loss: 0.167 Vali Loss: 2.000 Vali Acc: 0.200 Test Loss: 2.000 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9918866157531738
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.965 Vali Acc: 0.240 Test Loss: 1.965 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7893812656402588
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.926 Vali Acc: 0.280 Test Loss: 1.926 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.650587558746338
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.988 Vali Acc: 0.260 Test Loss: 1.988 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8977179527282715
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.121 Vali Acc: 0.240 Test Loss: 2.121 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8321805000305176
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.236 Vali Acc: 0.260 Test Loss: 2.236 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8260860443115234
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.312 Vali Acc: 0.240 Test Loss: 2.312 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7220423221588135
Epoch: 1, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.599 Vali Acc: 0.360 Test Loss: 1.599 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 2.0432190895080566
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.612 Vali Acc: 0.300 Test Loss: 1.612 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.136056661605835
Epoch: 3, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.650 Vali Acc: 0.280 Test Loss: 1.650 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8697855472564697
Epoch: 4, Steps: 4 | Train Loss: 1.159 Vali Loss: 1.689 Vali Acc: 0.320 Test Loss: 1.689 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9890780448913574
Epoch: 5, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.622 Vali Acc: 0.300 Test Loss: 1.622 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.884629249572754
Epoch: 6, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.617 Vali Acc: 0.340 Test Loss: 1.617 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.999640703201294
Epoch: 7, Steps: 4 | Train Loss: 0.592 Vali Loss: 1.640 Vali Acc: 0.380 Test Loss: 1.640 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 1.9397823810577393
Epoch: 8, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.665 Vali Acc: 0.320 Test Loss: 1.665 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7457177639007568
Epoch: 9, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.743 Vali Acc: 0.300 Test Loss: 1.743 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.879929780960083
Epoch: 10, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.813 Vali Acc: 0.260 Test Loss: 1.813 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7619798183441162
Epoch: 11, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.810 Vali Acc: 0.300 Test Loss: 1.810 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9032342433929443
Epoch: 12, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.826 Vali Acc: 0.320 Test Loss: 1.826 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.853346824645996
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.944 Vali Acc: 0.300 Test Loss: 1.944 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.891601800918579
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.143 Vali Acc: 0.200 Test Loss: 2.143 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.013136863708496
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.244 Vali Acc: 0.200 Test Loss: 2.244 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0176987648010254
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.267 Vali Acc: 0.200 Test Loss: 2.267 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9358649253845215
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.228 Vali Acc: 0.220 Test Loss: 2.228 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.439802646636963
Epoch: 1, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.592 Vali Acc: 0.160 Test Loss: 1.592 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.652529239654541
Epoch: 2, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.610 Vali Acc: 0.200 Test Loss: 1.610 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.7385640144348145
Epoch: 3, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.650 Vali Acc: 0.200 Test Loss: 1.650 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.870426893234253
Epoch: 4, Steps: 4 | Train Loss: 1.365 Vali Loss: 1.699 Vali Acc: 0.240 Test Loss: 1.699 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.8324456214904785
Epoch: 5, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7290689945220947
Epoch: 6, Steps: 4 | Train Loss: 1.073 Vali Loss: 1.599 Vali Acc: 0.180 Test Loss: 1.599 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7192177772521973
Epoch: 7, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.596 Vali Acc: 0.160 Test Loss: 1.596 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.789351224899292
Epoch: 8, Steps: 4 | Train Loss: 0.587 Vali Loss: 1.626 Vali Acc: 0.180 Test Loss: 1.626 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8392751216888428
Epoch: 9, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.657 Vali Acc: 0.180 Test Loss: 1.657 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9078481197357178
Epoch: 10, Steps: 4 | Train Loss: 0.526 Vali Loss: 1.672 Vali Acc: 0.240 Test Loss: 1.672 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 11 cost time: 1.8988947868347168
Epoch: 11, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.684 Vali Acc: 0.220 Test Loss: 1.684 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.931713581085205
Epoch: 12, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.673 Vali Acc: 0.240 Test Loss: 1.673 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0062873363494873
Epoch: 13, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.618 Vali Acc: 0.160 Test Loss: 1.618 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8351733684539795
Epoch: 14, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.652 Vali Acc: 0.180 Test Loss: 1.652 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8176977634429932
Epoch: 15, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.628 Vali Acc: 0.160 Test Loss: 1.628 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.787975788116455
Epoch: 16, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.649 Vali Acc: 0.200 Test Loss: 1.649 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8536598682403564
Epoch: 17, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.649 Vali Acc: 0.240 Test Loss: 1.649 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 18 cost time: 1.8074891567230225
Epoch: 18, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.684 Vali Acc: 0.200 Test Loss: 1.684 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6661708354949951
Epoch: 19, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.733 Vali Acc: 0.260 Test Loss: 1.733 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 20 cost time: 1.8736135959625244
Epoch: 20, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.778 Vali Acc: 0.240 Test Loss: 1.778 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6352691650390625
Epoch: 21, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.777 Vali Acc: 0.240 Test Loss: 1.777 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7853055000305176
Epoch: 22, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.754 Vali Acc: 0.240 Test Loss: 1.754 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6802046298980713
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.745 Vali Acc: 0.240 Test Loss: 1.745 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7916221618652344
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.737 Vali Acc: 0.180 Test Loss: 1.737 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8933749198913574
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.730 Vali Acc: 0.180 Test Loss: 1.730 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8044674396514893
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.731 Vali Acc: 0.220 Test Loss: 1.731 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.77059006690979
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.736 Vali Acc: 0.260 Test Loss: 1.736 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7801475524902344
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.754 Vali Acc: 0.220 Test Loss: 1.754 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7951879501342773
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.787 Vali Acc: 0.240 Test Loss: 1.787 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5270447731018066
Epoch: 1, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.554 Vali Acc: 0.180 Test Loss: 1.554 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.7502975463867188
Epoch: 2, Steps: 4 | Train Loss: 1.734 Vali Loss: 1.580 Vali Acc: 0.160 Test Loss: 1.580 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.637897253036499
Epoch: 3, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.798215389251709
Epoch: 4, Steps: 4 | Train Loss: 1.370 Vali Loss: 1.669 Vali Acc: 0.240 Test Loss: 1.669 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7644262313842773
Epoch: 5, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.621 Vali Acc: 0.260 Test Loss: 1.621 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.8060357570648193
Epoch: 6, Steps: 4 | Train Loss: 0.973 Vali Loss: 1.566 Vali Acc: 0.140 Test Loss: 1.566 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.841942548751831
Epoch: 7, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.545 Vali Acc: 0.180 Test Loss: 1.545 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8808300495147705
Epoch: 8, Steps: 4 | Train Loss: 0.513 Vali Loss: 1.554 Vali Acc: 0.180 Test Loss: 1.554 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8197393417358398
Epoch: 9, Steps: 4 | Train Loss: 0.433 Vali Loss: 1.603 Vali Acc: 0.160 Test Loss: 1.603 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9915568828582764
Epoch: 10, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.643 Vali Acc: 0.180 Test Loss: 1.643 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8774418830871582
Epoch: 11, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.619 Vali Acc: 0.220 Test Loss: 1.619 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8814165592193604
Epoch: 12, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.575 Vali Acc: 0.160 Test Loss: 1.575 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8797504901885986
Epoch: 13, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.535 Vali Acc: 0.240 Test Loss: 1.535 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.903205156326294
Epoch: 14, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.573 Vali Acc: 0.200 Test Loss: 1.573 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1113438606262207
Epoch: 15, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.607 Vali Acc: 0.180 Test Loss: 1.607 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2923781
model size : 16.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6077888011932373
Epoch: 1, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.575 Vali Acc: 0.160 Test Loss: 1.575 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.7241334915161133
Epoch: 2, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.548 Vali Acc: 0.200 Test Loss: 1.548 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 1.7515811920166016
Epoch: 3, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.550 Vali Acc: 0.220 Test Loss: 1.550 Test Acc: 0.220
Validation loss decreased (-0.199985 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.7450754642486572
Epoch: 4, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.611 Vali Acc: 0.220 Test Loss: 1.611 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7059154510498047
Epoch: 5, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.655 Vali Acc: 0.260 Test Loss: 1.655 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.6647062301635742
Epoch: 6, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.609 Vali Acc: 0.280 Test Loss: 1.609 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.652848482131958
Epoch: 7, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.695 Vali Acc: 0.320 Test Loss: 1.695 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319983).  Saving model ...
Epoch: 8 cost time: 1.696296215057373
Epoch: 8, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.760 Vali Acc: 0.320 Test Loss: 1.760 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8969471454620361
Epoch: 9, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.729 Vali Acc: 0.320 Test Loss: 1.729 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8902523517608643
Epoch: 10, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.783 Vali Acc: 0.320 Test Loss: 1.783 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.850945234298706
Epoch: 11, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.933 Vali Acc: 0.340 Test Loss: 1.933 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339981).  Saving model ...
Epoch: 12 cost time: 1.8032341003417969
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.984 Vali Acc: 0.300 Test Loss: 1.984 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7591872215270996
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.085 Vali Acc: 0.280 Test Loss: 2.085 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9272496700286865
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.196 Vali Acc: 0.340 Test Loss: 2.196 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8565964698791504
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.285 Vali Acc: 0.340 Test Loss: 2.285 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6874585151672363
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.285 Vali Acc: 0.320 Test Loss: 2.285 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6715357303619385
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.241 Vali Acc: 0.300 Test Loss: 2.241 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7042713165283203
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.208 Vali Acc: 0.320 Test Loss: 2.208 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.720411777496338
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.187 Vali Acc: 0.340 Test Loss: 2.187 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6247694492340088
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.171 Vali Acc: 0.340 Test Loss: 2.171 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8338828086853027
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.187 Vali Acc: 0.320 Test Loss: 2.187 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8156683444976807
Epoch: 1, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.607 Vali Acc: 0.200 Test Loss: 1.607 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.8931009769439697
Epoch: 2, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.561 Vali Acc: 0.200 Test Loss: 1.561 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.8570201396942139
Epoch: 3, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.549 Vali Acc: 0.220 Test Loss: 1.549 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219985).  Saving model ...
Epoch: 4 cost time: 1.76430082321167
Epoch: 4, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.610 Vali Acc: 0.220 Test Loss: 1.610 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.741201400756836
Epoch: 5, Steps: 4 | Train Loss: 0.708 Vali Loss: 1.659 Vali Acc: 0.280 Test Loss: 1.659 Test Acc: 0.280
Validation loss decreased (-0.219985 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.7487850189208984
Epoch: 6, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.592 Vali Acc: 0.260 Test Loss: 1.592 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8138706684112549
Epoch: 7, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.653 Vali Acc: 0.300 Test Loss: 1.653 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 1.8088290691375732
Epoch: 8, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.709 Vali Acc: 0.300 Test Loss: 1.709 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.714770793914795
Epoch: 9, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.670 Vali Acc: 0.300 Test Loss: 1.670 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6737875938415527
Epoch: 10, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.714 Vali Acc: 0.320 Test Loss: 1.714 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 11 cost time: 1.6492927074432373
Epoch: 11, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.840 Vali Acc: 0.320 Test Loss: 1.840 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7747998237609863
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.880 Vali Acc: 0.360 Test Loss: 1.880 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359981).  Saving model ...
Epoch: 13 cost time: 1.8970260620117188
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.973 Vali Acc: 0.300 Test Loss: 1.973 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9175243377685547
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.085 Vali Acc: 0.320 Test Loss: 2.085 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8148705959320068
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.157 Vali Acc: 0.320 Test Loss: 2.157 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8682656288146973
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.135 Vali Acc: 0.320 Test Loss: 2.135 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8807411193847656
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.074 Vali Acc: 0.320 Test Loss: 2.074 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8332343101501465
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.040 Vali Acc: 0.300 Test Loss: 2.040 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.699171543121338
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.019 Vali Acc: 0.320 Test Loss: 2.019 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7064082622528076
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.010 Vali Acc: 0.360 Test Loss: 2.010 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6363015174865723
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.034 Vali Acc: 0.360 Test Loss: 2.034 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.767307996749878
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.074 Vali Acc: 0.380 Test Loss: 2.074 Test Acc: 0.380
Validation loss decreased (-0.359981 --> -0.379979).  Saving model ...
Epoch: 23 cost time: 1.73148775100708
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.131 Vali Acc: 0.380 Test Loss: 2.131 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7967555522918701
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.179 Vali Acc: 0.360 Test Loss: 2.179 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.90213942527771
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.207 Vali Acc: 0.360 Test Loss: 2.207 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6786181926727295
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.206 Vali Acc: 0.360 Test Loss: 2.206 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8279469013214111
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.204 Vali Acc: 0.360 Test Loss: 2.204 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9430100917816162
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.198 Vali Acc: 0.360 Test Loss: 2.198 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8351109027862549
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.190 Vali Acc: 0.360 Test Loss: 2.190 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7843811511993408
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.189 Vali Acc: 0.360 Test Loss: 2.189 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.854207992553711
Epoch: 31, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.189 Vali Acc: 0.360 Test Loss: 2.189 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.843799114227295
Epoch: 32, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.186 Vali Acc: 0.360 Test Loss: 2.186 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.24165415763855
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.640 Vali Acc: 0.140 Test Loss: 1.640 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.55061674118042
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.599 Vali Acc: 0.180 Test Loss: 1.599 Test Acc: 0.180
Validation loss decreased (-0.139984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.58967924118042
Epoch: 3, Steps: 4 | Train Loss: 1.354 Vali Loss: 1.597 Vali Acc: 0.220 Test Loss: 1.597 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.655750036239624
Epoch: 4, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.672 Vali Acc: 0.220 Test Loss: 1.672 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6272826194763184
Epoch: 5, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.753 Vali Acc: 0.260 Test Loss: 1.753 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259982).  Saving model ...
Epoch: 6 cost time: 1.7831735610961914
Epoch: 6, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7764346599578857
Epoch: 7, Steps: 4 | Train Loss: 0.340 Vali Loss: 1.825 Vali Acc: 0.240 Test Loss: 1.825 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8129734992980957
Epoch: 8, Steps: 4 | Train Loss: 0.362 Vali Loss: 1.907 Vali Acc: 0.260 Test Loss: 1.907 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.764047384262085
Epoch: 9, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.879 Vali Acc: 0.260 Test Loss: 1.879 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8348853588104248
Epoch: 10, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.990 Vali Acc: 0.300 Test Loss: 1.990 Test Acc: 0.300
Validation loss decreased (-0.259982 --> -0.299980).  Saving model ...
Epoch: 11 cost time: 1.8061983585357666
Epoch: 11, Steps: 4 | Train Loss: 0.101 Vali Loss: 2.170 Vali Acc: 0.280 Test Loss: 2.170 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.835024118423462
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.243 Vali Acc: 0.240 Test Loss: 2.243 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7154765129089355
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.343 Vali Acc: 0.260 Test Loss: 2.343 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6194345951080322
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.432 Vali Acc: 0.260 Test Loss: 2.432 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.693070650100708
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.504 Vali Acc: 0.280 Test Loss: 2.504 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7828609943389893
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.516 Vali Acc: 0.280 Test Loss: 2.516 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6858515739440918
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.489 Vali Acc: 0.280 Test Loss: 2.489 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7670433521270752
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.469 Vali Acc: 0.280 Test Loss: 2.469 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7290778160095215
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.455 Vali Acc: 0.260 Test Loss: 2.455 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7568981647491455
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.450 Vali Acc: 0.260 Test Loss: 2.450 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.771118640899658
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.612 Vali Acc: 0.140 Test Loss: 1.612 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.609452724456787
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.572 Vali Acc: 0.200 Test Loss: 1.572 Test Acc: 0.200
Validation loss decreased (-0.139984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.6519289016723633
Epoch: 3, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.570 Vali Acc: 0.180 Test Loss: 1.570 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.691347360610962
Epoch: 4, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.642 Vali Acc: 0.220 Test Loss: 1.642 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.5979151725769043
Epoch: 5, Steps: 4 | Train Loss: 0.716 Vali Loss: 1.688 Vali Acc: 0.260 Test Loss: 1.688 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.6203835010528564
Epoch: 6, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.636 Vali Acc: 0.280 Test Loss: 1.636 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.6419799327850342
Epoch: 7, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.723 Vali Acc: 0.240 Test Loss: 1.723 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6444904804229736
Epoch: 8, Steps: 4 | Train Loss: 0.336 Vali Loss: 1.813 Vali Acc: 0.260 Test Loss: 1.813 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7926125526428223
Epoch: 9, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.775 Vali Acc: 0.280 Test Loss: 1.775 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7922496795654297
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.882 Vali Acc: 0.280 Test Loss: 1.882 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7635753154754639
Epoch: 11, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.005 Vali Acc: 0.300 Test Loss: 2.005 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299980).  Saving model ...
Epoch: 12 cost time: 1.8986566066741943
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.061 Vali Acc: 0.300 Test Loss: 2.061 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7528061866760254
Epoch: 13, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.152 Vali Acc: 0.340 Test Loss: 2.152 Test Acc: 0.340
Validation loss decreased (-0.299980 --> -0.339978).  Saving model ...
Epoch: 14 cost time: 1.8717122077941895
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.222 Vali Acc: 0.360 Test Loss: 2.222 Test Acc: 0.360
Validation loss decreased (-0.339978 --> -0.359978).  Saving model ...
Epoch: 15 cost time: 1.837493658065796
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.284 Vali Acc: 0.320 Test Loss: 2.284 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8222899436950684
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.304 Vali Acc: 0.340 Test Loss: 2.304 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6462783813476562
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.304 Vali Acc: 0.320 Test Loss: 2.304 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6151394844055176
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.301 Vali Acc: 0.320 Test Loss: 2.301 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6728014945983887
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.282 Vali Acc: 0.320 Test Loss: 2.282 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.681777000427246
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.247 Vali Acc: 0.340 Test Loss: 2.247 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7805235385894775
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.248 Vali Acc: 0.320 Test Loss: 2.248 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7953088283538818
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.265 Vali Acc: 0.320 Test Loss: 2.265 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7721500396728516
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.304 Vali Acc: 0.340 Test Loss: 2.304 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8198962211608887
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.340 Vali Acc: 0.340 Test Loss: 2.340 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.737595558166504
Epoch: 1, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.636 Vali Acc: 0.180 Test Loss: 1.636 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.9957239627838135
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.603 Vali Acc: 0.220 Test Loss: 1.603 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.6905171871185303
Epoch: 3, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.597 Vali Acc: 0.220 Test Loss: 1.597 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.825941562652588
Epoch: 4, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.648 Vali Acc: 0.260 Test Loss: 1.648 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.82743501663208
Epoch: 5, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.730 Vali Acc: 0.260 Test Loss: 1.730 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7381978034973145
Epoch: 6, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.716 Vali Acc: 0.240 Test Loss: 1.716 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7208929061889648
Epoch: 7, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.789 Vali Acc: 0.220 Test Loss: 1.789 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7084662914276123
Epoch: 8, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.864 Vali Acc: 0.220 Test Loss: 1.864 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7549374103546143
Epoch: 9, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.872 Vali Acc: 0.240 Test Loss: 1.872 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9004452228546143
Epoch: 10, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.931 Vali Acc: 0.220 Test Loss: 1.931 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8737542629241943
Epoch: 11, Steps: 4 | Train Loss: 0.071 Vali Loss: 2.039 Vali Acc: 0.240 Test Loss: 2.039 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.869020700454712
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.109 Vali Acc: 0.260 Test Loss: 2.109 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8782570362091064
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.193 Vali Acc: 0.260 Test Loss: 2.193 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.782897710800171
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.273 Vali Acc: 0.240 Test Loss: 2.273 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.538304567337036
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.6621417999267578
Epoch: 2, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.601 Vali Acc: 0.220 Test Loss: 1.601 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.6529197692871094
Epoch: 3, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.591 Vali Acc: 0.220 Test Loss: 1.591 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.7458059787750244
Epoch: 4, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.7664251327514648
Epoch: 5, Steps: 4 | Train Loss: 0.688 Vali Loss: 1.679 Vali Acc: 0.300 Test Loss: 1.679 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 1.767927885055542
Epoch: 6, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.678 Vali Acc: 0.320 Test Loss: 1.678 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.8092985153198242
Epoch: 7, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.777 Vali Acc: 0.200 Test Loss: 1.777 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8275141716003418
Epoch: 8, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.870 Vali Acc: 0.220 Test Loss: 1.870 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.834883213043213
Epoch: 9, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.880 Vali Acc: 0.300 Test Loss: 1.880 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8610994815826416
Epoch: 10, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.956 Vali Acc: 0.320 Test Loss: 1.956 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7902710437774658
Epoch: 11, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.035 Vali Acc: 0.320 Test Loss: 2.035 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9471120834350586
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.088 Vali Acc: 0.280 Test Loss: 2.088 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9483542442321777
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.193 Vali Acc: 0.220 Test Loss: 2.193 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8505213260650635
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.316 Vali Acc: 0.220 Test Loss: 2.316 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9989335536956787
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.418 Vali Acc: 0.220 Test Loss: 2.418 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8908145427703857
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.453 Vali Acc: 0.220 Test Loss: 2.453 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.414813995361328
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.623 Vali Acc: 0.160 Test Loss: 1.623 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.9517714977264404
Epoch: 2, Steps: 4 | Train Loss: 1.514 Vali Loss: 1.584 Vali Acc: 0.220 Test Loss: 1.584 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.9780604839324951
Epoch: 3, Steps: 4 | Train Loss: 1.366 Vali Loss: 1.567 Vali Acc: 0.240 Test Loss: 1.567 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.918877363204956
Epoch: 4, Steps: 4 | Train Loss: 1.003 Vali Loss: 1.594 Vali Acc: 0.260 Test Loss: 1.594 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.8407409191131592
Epoch: 5, Steps: 4 | Train Loss: 0.710 Vali Loss: 1.656 Vali Acc: 0.260 Test Loss: 1.656 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9779653549194336
Epoch: 6, Steps: 4 | Train Loss: 0.501 Vali Loss: 1.685 Vali Acc: 0.260 Test Loss: 1.685 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9380638599395752
Epoch: 7, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.756 Vali Acc: 0.280 Test Loss: 1.756 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279982).  Saving model ...
Epoch: 8 cost time: 1.8636019229888916
Epoch: 8, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.796 Vali Acc: 0.280 Test Loss: 1.796 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9066746234893799
Epoch: 9, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.800 Vali Acc: 0.300 Test Loss: 1.800 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 1.8343918323516846
Epoch: 10, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.847 Vali Acc: 0.300 Test Loss: 1.847 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6517229080200195
Epoch: 11, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.924 Vali Acc: 0.300 Test Loss: 1.924 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6472351551055908
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.954 Vali Acc: 0.280 Test Loss: 1.954 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6990153789520264
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.026 Vali Acc: 0.280 Test Loss: 2.026 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.859743595123291
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.139 Vali Acc: 0.280 Test Loss: 2.139 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6800940036773682
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.235 Vali Acc: 0.240 Test Loss: 2.235 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.720386266708374
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.255 Vali Acc: 0.240 Test Loss: 2.255 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7465088367462158
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.209 Vali Acc: 0.220 Test Loss: 2.209 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9323651790618896
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.166 Vali Acc: 0.260 Test Loss: 2.166 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.07817006111145
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.129 Vali Acc: 0.260 Test Loss: 2.129 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.377213478088379
Epoch: 1, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.580 Vali Acc: 0.200 Test Loss: 1.580 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.8324031829833984
Epoch: 2, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.558 Vali Acc: 0.200 Test Loss: 1.558 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.865102767944336
Epoch: 3, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.551 Vali Acc: 0.140 Test Loss: 1.551 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.749873399734497
Epoch: 4, Steps: 4 | Train Loss: 1.149 Vali Loss: 1.553 Vali Acc: 0.160 Test Loss: 1.553 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7719130516052246
Epoch: 5, Steps: 4 | Train Loss: 0.802 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.8561530113220215
Epoch: 6, Steps: 4 | Train Loss: 0.533 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8960821628570557
Epoch: 7, Steps: 4 | Train Loss: 0.428 Vali Loss: 1.632 Vali Acc: 0.180 Test Loss: 1.632 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0025174617767334
Epoch: 8, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.681 Vali Acc: 0.220 Test Loss: 1.681 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.920783281326294
Epoch: 9, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.725 Vali Acc: 0.180 Test Loss: 1.725 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8256361484527588
Epoch: 10, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.743 Vali Acc: 0.240 Test Loss: 1.743 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1038565635681152
Epoch: 11, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.777 Vali Acc: 0.220 Test Loss: 1.777 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9254581928253174
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.820 Vali Acc: 0.260 Test Loss: 1.820 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 13 cost time: 1.8331542015075684
Epoch: 13, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.907 Vali Acc: 0.260 Test Loss: 1.907 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8182318210601807
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.023 Vali Acc: 0.260 Test Loss: 2.023 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8789892196655273
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.103 Vali Acc: 0.220 Test Loss: 2.103 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.664489507675171
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.097 Vali Acc: 0.220 Test Loss: 2.097 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8764123916625977
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.046 Vali Acc: 0.240 Test Loss: 2.046 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7964258193969727
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.021 Vali Acc: 0.280 Test Loss: 2.021 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279980).  Saving model ...
Epoch: 19 cost time: 1.8912358283996582
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.011 Vali Acc: 0.320 Test Loss: 2.011 Test Acc: 0.320
Validation loss decreased (-0.279980 --> -0.319980).  Saving model ...
Epoch: 20 cost time: 1.7044143676757812
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.016 Vali Acc: 0.280 Test Loss: 2.016 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8699278831481934
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.040 Vali Acc: 0.260 Test Loss: 2.040 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9400696754455566
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.069 Vali Acc: 0.240 Test Loss: 2.069 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7990107536315918
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.100 Vali Acc: 0.240 Test Loss: 2.100 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8986883163452148
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.124 Vali Acc: 0.220 Test Loss: 2.124 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9107847213745117
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.133 Vali Acc: 0.220 Test Loss: 2.133 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8733816146850586
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.127 Vali Acc: 0.220 Test Loss: 2.127 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6634716987609863
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.123 Vali Acc: 0.240 Test Loss: 2.123 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.663752794265747
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.116 Vali Acc: 0.240 Test Loss: 2.116 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7237129211425781
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.111 Vali Acc: 0.240 Test Loss: 2.111 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.710090398788452
Epoch: 1, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.636 Vali Acc: 0.220 Test Loss: 1.636 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9517078399658203
Epoch: 2, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.622 Vali Acc: 0.180 Test Loss: 1.622 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8631401062011719
Epoch: 3, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.621 Vali Acc: 0.200 Test Loss: 1.621 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.906557559967041
Epoch: 4, Steps: 4 | Train Loss: 1.318 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 2.010923147201538
Epoch: 5, Steps: 4 | Train Loss: 1.120 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0180890560150146
Epoch: 6, Steps: 4 | Train Loss: 0.827 Vali Loss: 1.648 Vali Acc: 0.180 Test Loss: 1.648 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9847359657287598
Epoch: 7, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8388984203338623
Epoch: 8, Steps: 4 | Train Loss: 0.823 Vali Loss: 1.692 Vali Acc: 0.200 Test Loss: 1.692 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8301174640655518
Epoch: 9, Steps: 4 | Train Loss: 0.635 Vali Loss: 1.709 Vali Acc: 0.220 Test Loss: 1.709 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8011395931243896
Epoch: 10, Steps: 4 | Train Loss: 0.444 Vali Loss: 1.704 Vali Acc: 0.160 Test Loss: 1.704 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8868041038513184
Epoch: 11, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.706 Vali Acc: 0.160 Test Loss: 1.706 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8008978366851807
Epoch: 12, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.691 Vali Acc: 0.140 Test Loss: 1.691 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8725793361663818
Epoch: 13, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.680 Vali Acc: 0.200 Test Loss: 1.680 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8701343536376953
Epoch: 14, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.750 Vali Acc: 0.240 Test Loss: 1.750 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 15 cost time: 1.9159400463104248
Epoch: 15, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.725 Vali Acc: 0.160 Test Loss: 1.725 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.115662097930908
Epoch: 16, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.734 Vali Acc: 0.180 Test Loss: 1.734 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.941101312637329
Epoch: 17, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.741 Vali Acc: 0.140 Test Loss: 1.741 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.971670389175415
Epoch: 18, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.799 Vali Acc: 0.200 Test Loss: 1.799 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1801764965057373
Epoch: 19, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.803 Vali Acc: 0.200 Test Loss: 1.803 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2702219486236572
Epoch: 20, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.738 Vali Acc: 0.160 Test Loss: 1.738 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.041887044906616
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.718 Vali Acc: 0.160 Test Loss: 1.718 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8665242195129395
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.707 Vali Acc: 0.220 Test Loss: 1.707 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7627460956573486
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.723 Vali Acc: 0.220 Test Loss: 1.723 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.77889084815979
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.751 Vali Acc: 0.180 Test Loss: 1.751 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8590831756591797
Epoch: 1, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.670 Vali Acc: 0.120 Test Loss: 1.670 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.884660005569458
Epoch: 2, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.659 Vali Acc: 0.140 Test Loss: 1.659 Test Acc: 0.140
Validation loss decreased (-0.119983 --> -0.139983).  Saving model ...
Epoch: 3 cost time: 1.8382673263549805
Epoch: 3, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.658 Vali Acc: 0.140 Test Loss: 1.658 Test Acc: 0.140
Validation loss decreased (-0.139983 --> -0.139983).  Saving model ...
Epoch: 4 cost time: 1.8362977504730225
Epoch: 4, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.659 Vali Acc: 0.120 Test Loss: 1.659 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8950471878051758
Epoch: 5, Steps: 4 | Train Loss: 1.052 Vali Loss: 1.684 Vali Acc: 0.140 Test Loss: 1.684 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8333659172058105
Epoch: 6, Steps: 4 | Train Loss: 0.798 Vali Loss: 1.684 Vali Acc: 0.140 Test Loss: 1.684 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8509111404418945
Epoch: 7, Steps: 4 | Train Loss: 0.721 Vali Loss: 1.675 Vali Acc: 0.160 Test Loss: 1.675 Test Acc: 0.160
Validation loss decreased (-0.139983 --> -0.159983).  Saving model ...
Epoch: 8 cost time: 1.7155952453613281
Epoch: 8, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.718 Vali Acc: 0.160 Test Loss: 1.718 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8362007141113281
Epoch: 9, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.749 Vali Acc: 0.180 Test Loss: 1.749 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 10 cost time: 2.0188169479370117
Epoch: 10, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.723 Vali Acc: 0.160 Test Loss: 1.723 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9824175834655762
Epoch: 11, Steps: 4 | Train Loss: 0.415 Vali Loss: 1.663 Vali Acc: 0.160 Test Loss: 1.663 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8818464279174805
Epoch: 12, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 13 cost time: 1.8760149478912354
Epoch: 13, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.719 Vali Acc: 0.160 Test Loss: 1.719 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8997395038604736
Epoch: 14, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.823 Vali Acc: 0.180 Test Loss: 1.823 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0043771266937256
Epoch: 15, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.753 Vali Acc: 0.240 Test Loss: 1.753 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239982).  Saving model ...
Epoch: 16 cost time: 1.8138201236724854
Epoch: 16, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.696 Vali Acc: 0.180 Test Loss: 1.696 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.947054386138916
Epoch: 17, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.697 Vali Acc: 0.200 Test Loss: 1.697 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8607897758483887
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.721 Vali Acc: 0.180 Test Loss: 1.721 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8620781898498535
Epoch: 19, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.756 Vali Acc: 0.200 Test Loss: 1.756 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9901695251464844
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.786 Vali Acc: 0.180 Test Loss: 1.786 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8106105327606201
Epoch: 21, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.793 Vali Acc: 0.240 Test Loss: 1.793 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8279340267181396
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.756 Vali Acc: 0.180 Test Loss: 1.756 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9234364032745361
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.742 Vali Acc: 0.180 Test Loss: 1.742 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.098918914794922
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.734 Vali Acc: 0.180 Test Loss: 1.734 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.001863956451416
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.200 Test Loss: 1.723 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2137349
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.42264723777771
Epoch: 1, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.8909728527069092
Epoch: 2, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.613 Vali Acc: 0.300 Test Loss: 1.613 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.9400482177734375
Epoch: 3, Steps: 4 | Train Loss: 1.361 Vali Loss: 1.613 Vali Acc: 0.280 Test Loss: 1.613 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9254205226898193
Epoch: 4, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.622 Vali Acc: 0.260 Test Loss: 1.622 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.879622220993042
Epoch: 5, Steps: 4 | Train Loss: 0.698 Vali Loss: 1.681 Vali Acc: 0.320 Test Loss: 1.681 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 2.1274454593658447
Epoch: 6, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.717 Vali Acc: 0.260 Test Loss: 1.717 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9519236087799072
Epoch: 7, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.716 Vali Acc: 0.240 Test Loss: 1.716 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9249460697174072
Epoch: 8, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.727 Vali Acc: 0.300 Test Loss: 1.727 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1756539344787598
Epoch: 9, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.745 Vali Acc: 0.280 Test Loss: 1.745 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.037105083465576
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.786 Vali Acc: 0.320 Test Loss: 1.786 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.214646100997925
Epoch: 11, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.891 Vali Acc: 0.220 Test Loss: 1.891 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.040057897567749
Epoch: 12, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.073 Vali Acc: 0.300 Test Loss: 2.073 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.946498155593872
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.100 Vali Acc: 0.340 Test Loss: 2.100 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339979).  Saving model ...
Epoch: 14 cost time: 2.0683233737945557
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.059 Vali Acc: 0.300 Test Loss: 2.059 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9148929119110107
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.076 Vali Acc: 0.320 Test Loss: 2.076 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9114034175872803
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.202 Vali Acc: 0.320 Test Loss: 2.202 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.923471212387085
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.314 Vali Acc: 0.320 Test Loss: 2.314 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7955102920532227
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.368 Vali Acc: 0.320 Test Loss: 2.368 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8760979175567627
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.368 Vali Acc: 0.320 Test Loss: 2.368 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0107028484344482
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.344 Vali Acc: 0.320 Test Loss: 2.344 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.028960704803467
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.327 Vali Acc: 0.340 Test Loss: 2.327 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.076537609100342
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.311 Vali Acc: 0.340 Test Loss: 2.311 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.191497325897217
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.304 Vali Acc: 0.340 Test Loss: 2.304 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.350436210632324
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.571 Vali Acc: 0.260 Test Loss: 1.571 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.7536430358886719
Epoch: 2, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.583 Vali Acc: 0.300 Test Loss: 1.583 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.5987260341644287
Epoch: 3, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.6146836280822754
Epoch: 4, Steps: 4 | Train Loss: 1.026 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6065266132354736
Epoch: 5, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6637036800384521
Epoch: 6, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.689 Vali Acc: 0.240 Test Loss: 1.689 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6228208541870117
Epoch: 7, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.693 Vali Acc: 0.280 Test Loss: 1.693 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8178911209106445
Epoch: 8, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.695 Vali Acc: 0.280 Test Loss: 1.695 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7502846717834473
Epoch: 9, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.714 Vali Acc: 0.300 Test Loss: 1.714 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7059738636016846
Epoch: 10, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.734 Vali Acc: 0.280 Test Loss: 1.734 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6289410591125488
Epoch: 11, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.868 Vali Acc: 0.260 Test Loss: 1.868 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7864794731140137
Epoch: 12, Steps: 4 | Train Loss: 0.046 Vali Loss: 2.076 Vali Acc: 0.260 Test Loss: 2.076 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7545056343078613
Epoch: 13, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.083 Vali Acc: 0.280 Test Loss: 2.083 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.354541301727295
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.555 Vali Acc: 0.220 Test Loss: 1.555 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.6064088344573975
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.7474708557128906
Epoch: 3, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.576 Vali Acc: 0.240 Test Loss: 1.576 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7210729122161865
Epoch: 4, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7500464916229248
Epoch: 5, Steps: 4 | Train Loss: 0.668 Vali Loss: 1.679 Vali Acc: 0.220 Test Loss: 1.679 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.948868751525879
Epoch: 6, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.742 Vali Acc: 0.240 Test Loss: 1.742 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9074437618255615
Epoch: 7, Steps: 4 | Train Loss: 0.331 Vali Loss: 1.767 Vali Acc: 0.280 Test Loss: 1.767 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8863885402679443
Epoch: 8, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.777 Vali Acc: 0.320 Test Loss: 1.777 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319982).  Saving model ...
Epoch: 9 cost time: 1.8282008171081543
Epoch: 9, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.840 Vali Acc: 0.280 Test Loss: 1.840 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9141221046447754
Epoch: 10, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.901 Vali Acc: 0.260 Test Loss: 1.901 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8483364582061768
Epoch: 11, Steps: 4 | Train Loss: 0.055 Vali Loss: 2.062 Vali Acc: 0.220 Test Loss: 2.062 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8872497081756592
Epoch: 12, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.288 Vali Acc: 0.240 Test Loss: 2.288 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9116790294647217
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.358 Vali Acc: 0.280 Test Loss: 2.358 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7140097618103027
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.321 Vali Acc: 0.220 Test Loss: 2.321 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7451372146606445
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.325 Vali Acc: 0.240 Test Loss: 2.325 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7309162616729736
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.424 Vali Acc: 0.240 Test Loss: 2.424 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6957812309265137
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.511 Vali Acc: 0.240 Test Loss: 2.511 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7053956985473633
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.562 Vali Acc: 0.260 Test Loss: 2.562 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.49623441696167
Epoch: 1, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.600 Vali Acc: 0.200 Test Loss: 1.600 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.911374807357788
Epoch: 2, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.595 Vali Acc: 0.320 Test Loss: 1.595 Test Acc: 0.320
Validation loss decreased (-0.199984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.819336175918579
Epoch: 3, Steps: 4 | Train Loss: 1.328 Vali Loss: 1.588 Vali Acc: 0.300 Test Loss: 1.588 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8089497089385986
Epoch: 4, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.598 Vali Acc: 0.300 Test Loss: 1.598 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6091489791870117
Epoch: 5, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.677 Vali Acc: 0.300 Test Loss: 1.677 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6517584323883057
Epoch: 6, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.709 Vali Acc: 0.320 Test Loss: 1.709 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6466937065124512
Epoch: 7, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.706 Vali Acc: 0.300 Test Loss: 1.706 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6958370208740234
Epoch: 8, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.696 Vali Acc: 0.320 Test Loss: 1.696 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6209936141967773
Epoch: 9, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.756 Vali Acc: 0.300 Test Loss: 1.756 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6046323776245117
Epoch: 10, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.824 Vali Acc: 0.380 Test Loss: 1.824 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379982).  Saving model ...
Epoch: 11 cost time: 1.5936436653137207
Epoch: 11, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.955 Vali Acc: 0.240 Test Loss: 1.955 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6977524757385254
Epoch: 12, Steps: 4 | Train Loss: 0.036 Vali Loss: 2.128 Vali Acc: 0.240 Test Loss: 2.128 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.647451400756836
Epoch: 13, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.170 Vali Acc: 0.320 Test Loss: 2.170 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7854435443878174
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.146 Vali Acc: 0.340 Test Loss: 2.146 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.768007516860962
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.144 Vali Acc: 0.360 Test Loss: 2.144 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0085177421569824
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.207 Vali Acc: 0.360 Test Loss: 2.207 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7925870418548584
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.272 Vali Acc: 0.340 Test Loss: 2.272 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9149887561798096
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.315 Vali Acc: 0.340 Test Loss: 2.315 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9314332008361816
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.333 Vali Acc: 0.340 Test Loss: 2.333 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.818099021911621
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.333 Vali Acc: 0.340 Test Loss: 2.333 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7067878246307373
Epoch: 1, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.023090362548828
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.630 Vali Acc: 0.300 Test Loss: 1.630 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.081643581390381
Epoch: 3, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.665 Vali Acc: 0.300 Test Loss: 1.665 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0349550247192383
Epoch: 4, Steps: 4 | Train Loss: 1.018 Vali Loss: 1.658 Vali Acc: 0.320 Test Loss: 1.658 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 2.4176957607269287
Epoch: 5, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.699 Vali Acc: 0.300 Test Loss: 1.699 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.165849208831787
Epoch: 6, Steps: 4 | Train Loss: 0.688 Vali Loss: 1.722 Vali Acc: 0.220 Test Loss: 1.722 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.115018129348755
Epoch: 7, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.754 Vali Acc: 0.240 Test Loss: 1.754 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9336090087890625
Epoch: 8, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.806 Vali Acc: 0.260 Test Loss: 1.806 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.973844051361084
Epoch: 9, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.907 Vali Acc: 0.280 Test Loss: 1.907 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9192347526550293
Epoch: 10, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.935 Vali Acc: 0.280 Test Loss: 1.935 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7850778102874756
Epoch: 11, Steps: 4 | Train Loss: 0.050 Vali Loss: 2.029 Vali Acc: 0.240 Test Loss: 2.029 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6231961250305176
Epoch: 12, Steps: 4 | Train Loss: 0.040 Vali Loss: 2.191 Vali Acc: 0.260 Test Loss: 2.191 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7229528427124023
Epoch: 13, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.277 Vali Acc: 0.240 Test Loss: 2.277 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.631129503250122
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.267 Vali Acc: 0.240 Test Loss: 2.267 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3756062984466553
Epoch: 1, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.556 Vali Acc: 0.240 Test Loss: 1.556 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.8197689056396484
Epoch: 2, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.554 Vali Acc: 0.320 Test Loss: 1.554 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.7239603996276855
Epoch: 3, Steps: 4 | Train Loss: 1.438 Vali Loss: 1.554 Vali Acc: 0.360 Test Loss: 1.554 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.7255408763885498
Epoch: 4, Steps: 4 | Train Loss: 1.049 Vali Loss: 1.585 Vali Acc: 0.300 Test Loss: 1.585 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8397891521453857
Epoch: 5, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.663 Vali Acc: 0.300 Test Loss: 1.663 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6874678134918213
Epoch: 6, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.714 Vali Acc: 0.240 Test Loss: 1.714 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7299275398254395
Epoch: 7, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.727 Vali Acc: 0.240 Test Loss: 1.727 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7391421794891357
Epoch: 8, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.739 Vali Acc: 0.240 Test Loss: 1.739 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.698429822921753
Epoch: 9, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.839 Vali Acc: 0.260 Test Loss: 1.839 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6953492164611816
Epoch: 10, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.878 Vali Acc: 0.240 Test Loss: 1.878 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7861268520355225
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.951 Vali Acc: 0.220 Test Loss: 1.951 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6967601776123047
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.101 Vali Acc: 0.220 Test Loss: 2.101 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6718237400054932
Epoch: 13, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.203 Vali Acc: 0.200 Test Loss: 2.203 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.609783411026001
Epoch: 1, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.538 Vali Acc: 0.380 Test Loss: 1.538 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 1.9871435165405273
Epoch: 2, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.537 Vali Acc: 0.380 Test Loss: 1.537 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 2.061154365539551
Epoch: 3, Steps: 4 | Train Loss: 1.362 Vali Loss: 1.531 Vali Acc: 0.360 Test Loss: 1.531 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8047583103179932
Epoch: 4, Steps: 4 | Train Loss: 1.093 Vali Loss: 1.551 Vali Acc: 0.340 Test Loss: 1.551 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7391862869262695
Epoch: 5, Steps: 4 | Train Loss: 0.734 Vali Loss: 1.619 Vali Acc: 0.340 Test Loss: 1.619 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8381974697113037
Epoch: 6, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.678 Vali Acc: 0.360 Test Loss: 1.678 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.905944585800171
Epoch: 7, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8969039916992188
Epoch: 8, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.673 Vali Acc: 0.360 Test Loss: 1.673 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6883795261383057
Epoch: 9, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.772 Vali Acc: 0.280 Test Loss: 1.772 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8522212505340576
Epoch: 10, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.833 Vali Acc: 0.300 Test Loss: 1.833 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1665375232696533
Epoch: 11, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.925 Vali Acc: 0.240 Test Loss: 1.925 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0073795318603516
Epoch: 12, Steps: 4 | Train Loss: 0.046 Vali Loss: 2.045 Vali Acc: 0.240 Test Loss: 2.045 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.42374587059021
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.582 Vali Acc: 0.260 Test Loss: 1.582 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.770216703414917
Epoch: 2, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.583 Vali Acc: 0.280 Test Loss: 1.583 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.766874074935913
Epoch: 3, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.580 Vali Acc: 0.360 Test Loss: 1.580 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.7061536312103271
Epoch: 4, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.579 Vali Acc: 0.340 Test Loss: 1.579 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.737121820449829
Epoch: 5, Steps: 4 | Train Loss: 0.853 Vali Loss: 1.618 Vali Acc: 0.420 Test Loss: 1.618 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419984).  Saving model ...
Epoch: 6 cost time: 1.6583101749420166
Epoch: 6, Steps: 4 | Train Loss: 0.835 Vali Loss: 1.655 Vali Acc: 0.360 Test Loss: 1.655 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8847918510437012
Epoch: 7, Steps: 4 | Train Loss: 0.477 Vali Loss: 1.668 Vali Acc: 0.380 Test Loss: 1.668 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6573190689086914
Epoch: 8, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.638 Vali Acc: 0.320 Test Loss: 1.638 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8542101383209229
Epoch: 9, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.684 Vali Acc: 0.320 Test Loss: 1.684 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8962435722351074
Epoch: 10, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.735 Vali Acc: 0.340 Test Loss: 1.735 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.90401029586792
Epoch: 11, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.810 Vali Acc: 0.300 Test Loss: 1.810 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8984053134918213
Epoch: 12, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.897 Vali Acc: 0.340 Test Loss: 1.897 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9011297225952148
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.909 Vali Acc: 0.300 Test Loss: 1.909 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9044225215911865
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.930 Vali Acc: 0.280 Test Loss: 1.930 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.014646291732788
Epoch: 15, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.003 Vali Acc: 0.240 Test Loss: 2.003 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5138583183288574
Epoch: 1, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.912536382675171
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.696 Vali Acc: 0.220 Test Loss: 1.696 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9104456901550293
Epoch: 3, Steps: 4 | Train Loss: 1.439 Vali Loss: 1.699 Vali Acc: 0.220 Test Loss: 1.699 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9570538997650146
Epoch: 4, Steps: 4 | Train Loss: 1.422 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0166590213775635
Epoch: 5, Steps: 4 | Train Loss: 1.066 Vali Loss: 1.730 Vali Acc: 0.260 Test Loss: 1.730 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 2.0375356674194336
Epoch: 6, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.762 Vali Acc: 0.160 Test Loss: 1.762 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9339666366577148
Epoch: 7, Steps: 4 | Train Loss: 0.787 Vali Loss: 1.780 Vali Acc: 0.160 Test Loss: 1.780 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9907827377319336
Epoch: 8, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.717 Vali Acc: 0.220 Test Loss: 1.717 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0019800662994385
Epoch: 9, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.681 Vali Acc: 0.200 Test Loss: 1.681 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8837802410125732
Epoch: 10, Steps: 4 | Train Loss: 0.373 Vali Loss: 1.742 Vali Acc: 0.180 Test Loss: 1.742 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1279892921447754
Epoch: 11, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.813 Vali Acc: 0.220 Test Loss: 1.813 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9095637798309326
Epoch: 12, Steps: 4 | Train Loss: 0.371 Vali Loss: 1.764 Vali Acc: 0.220 Test Loss: 1.764 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8386509418487549
Epoch: 13, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.777 Vali Acc: 0.180 Test Loss: 1.777 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7923738956451416
Epoch: 14, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.752 Vali Acc: 0.200 Test Loss: 1.752 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6589419841766357
Epoch: 15, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.725 Vali Acc: 0.180 Test Loss: 1.725 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8195934295654297
Epoch: 1, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.582 Vali Acc: 0.240 Test Loss: 1.582 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.9040148258209229
Epoch: 2, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.584 Vali Acc: 0.220 Test Loss: 1.584 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.807783842086792
Epoch: 3, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.573 Vali Acc: 0.240 Test Loss: 1.573 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.7956571578979492
Epoch: 4, Steps: 4 | Train Loss: 1.281 Vali Loss: 1.577 Vali Acc: 0.180 Test Loss: 1.577 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8441624641418457
Epoch: 5, Steps: 4 | Train Loss: 1.099 Vali Loss: 1.604 Vali Acc: 0.280 Test Loss: 1.604 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.812556266784668
Epoch: 6, Steps: 4 | Train Loss: 0.987 Vali Loss: 1.632 Vali Acc: 0.260 Test Loss: 1.632 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.033919334411621
Epoch: 7, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.649 Vali Acc: 0.300 Test Loss: 1.649 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 8 cost time: 1.913926362991333
Epoch: 8, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.592 Vali Acc: 0.280 Test Loss: 1.592 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7497751712799072
Epoch: 9, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.557 Vali Acc: 0.300 Test Loss: 1.557 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 10 cost time: 1.8057410717010498
Epoch: 10, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.604 Vali Acc: 0.220 Test Loss: 1.604 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.051520824432373
Epoch: 11, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.680 Vali Acc: 0.160 Test Loss: 1.680 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9254274368286133
Epoch: 12, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.664 Vali Acc: 0.220 Test Loss: 1.664 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9799885749816895
Epoch: 13, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.650 Vali Acc: 0.240 Test Loss: 1.650 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.854661226272583
Epoch: 14, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.623 Vali Acc: 0.220 Test Loss: 1.623 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.964287519454956
Epoch: 15, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.659 Vali Acc: 0.180 Test Loss: 1.659 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9934780597686768
Epoch: 16, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.735 Vali Acc: 0.200 Test Loss: 1.735 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9556612968444824
Epoch: 17, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.777 Vali Acc: 0.180 Test Loss: 1.777 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.935096263885498
Epoch: 18, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.745 Vali Acc: 0.280 Test Loss: 1.745 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7215781211853027
Epoch: 19, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.740 Vali Acc: 0.320 Test Loss: 1.740 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 20 cost time: 1.8150415420532227
Epoch: 20, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.756 Vali Acc: 0.200 Test Loss: 1.756 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8540184497833252
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9647159576416016
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.629 Vali Acc: 0.260 Test Loss: 1.629 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8403635025024414
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.595 Vali Acc: 0.260 Test Loss: 1.595 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8603487014770508
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.603 Vali Acc: 0.280 Test Loss: 1.603 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7547638416290283
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.622 Vali Acc: 0.320 Test Loss: 1.622 Test Acc: 0.320
Validation loss decreased (-0.319983 --> -0.319984).  Saving model ...
Epoch: 26 cost time: 1.8466360569000244
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.646 Vali Acc: 0.360 Test Loss: 1.646 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 27 cost time: 2.0017857551574707
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.675 Vali Acc: 0.380 Test Loss: 1.675 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379983).  Saving model ...
Epoch: 28 cost time: 1.9926927089691162
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.708 Vali Acc: 0.380 Test Loss: 1.708 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9017515182495117
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.735 Vali Acc: 0.280 Test Loss: 1.735 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8879060745239258
Epoch: 30, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.750 Vali Acc: 0.280 Test Loss: 1.750 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.0874974727630615
Epoch: 31, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.761 Vali Acc: 0.280 Test Loss: 1.761 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8350799083709717
Epoch: 32, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.766 Vali Acc: 0.240 Test Loss: 1.766 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.739640474319458
Epoch: 33, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.755 Vali Acc: 0.240 Test Loss: 1.755 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7014133930206299
Epoch: 34, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.796 Vali Acc: 0.220 Test Loss: 1.796 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7447805404663086
Epoch: 35, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.832 Vali Acc: 0.240 Test Loss: 1.832 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6715977191925049
Epoch: 36, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.180 Test Loss: 1.841 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8968558311462402
Epoch: 37, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.200 Test Loss: 1.853 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1744133
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9473228454589844
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.870246410369873
Epoch: 2, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.596 Vali Acc: 0.160 Test Loss: 1.596 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0562384128570557
Epoch: 3, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.585 Vali Acc: 0.220 Test Loss: 1.585 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.134442090988159
Epoch: 4, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.622 Vali Acc: 0.200 Test Loss: 1.622 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8598370552062988
Epoch: 5, Steps: 4 | Train Loss: 0.784 Vali Loss: 1.704 Vali Acc: 0.220 Test Loss: 1.704 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9200329780578613
Epoch: 6, Steps: 4 | Train Loss: 0.549 Vali Loss: 1.723 Vali Acc: 0.200 Test Loss: 1.723 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.010051965713501
Epoch: 7, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.730 Vali Acc: 0.240 Test Loss: 1.730 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.747262954711914
Epoch: 8, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.745 Vali Acc: 0.260 Test Loss: 1.745 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 9 cost time: 1.8966176509857178
Epoch: 9, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.716 Vali Acc: 0.340 Test Loss: 1.716 Test Acc: 0.340
Validation loss decreased (-0.259983 --> -0.339983).  Saving model ...
Epoch: 10 cost time: 1.8839635848999023
Epoch: 10, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.917 Vali Acc: 0.300 Test Loss: 1.917 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8201210498809814
Epoch: 11, Steps: 4 | Train Loss: 0.079 Vali Loss: 2.024 Vali Acc: 0.280 Test Loss: 2.024 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9409897327423096
Epoch: 12, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.127 Vali Acc: 0.300 Test Loss: 2.127 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9223878383636475
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.157 Vali Acc: 0.240 Test Loss: 2.157 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7892937660217285
Epoch: 14, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.232 Vali Acc: 0.300 Test Loss: 2.232 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7202184200286865
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.142 Vali Acc: 0.360 Test Loss: 2.142 Test Acc: 0.360
Validation loss decreased (-0.339983 --> -0.359979).  Saving model ...
Epoch: 16 cost time: 1.6763160228729248
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.082 Vali Acc: 0.380 Test Loss: 2.082 Test Acc: 0.380
Validation loss decreased (-0.359979 --> -0.379979).  Saving model ...
Epoch: 17 cost time: 1.631605863571167
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.103 Vali Acc: 0.380 Test Loss: 2.103 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.887441873550415
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.161 Vali Acc: 0.340 Test Loss: 2.161 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.763866662979126
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.257 Vali Acc: 0.320 Test Loss: 2.257 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.949185848236084
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.356 Vali Acc: 0.280 Test Loss: 2.356 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8862512111663818
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.427 Vali Acc: 0.260 Test Loss: 2.427 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.920551061630249
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.470 Vali Acc: 0.260 Test Loss: 2.470 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.229985237121582
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.490 Vali Acc: 0.260 Test Loss: 2.490 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.005678415298462
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.496 Vali Acc: 0.260 Test Loss: 2.496 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8625998497009277
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.495 Vali Acc: 0.260 Test Loss: 2.495 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1904826164245605
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.494 Vali Acc: 0.280 Test Loss: 2.494 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.495347499847412
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.9602670669555664
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.058091163635254
Epoch: 3, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.627 Vali Acc: 0.180 Test Loss: 1.627 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8791465759277344
Epoch: 4, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.648 Vali Acc: 0.180 Test Loss: 1.648 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9866023063659668
Epoch: 5, Steps: 4 | Train Loss: 0.770 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0039045810699463
Epoch: 6, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.737 Vali Acc: 0.260 Test Loss: 1.737 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 2.000932455062866
Epoch: 7, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.740 Vali Acc: 0.220 Test Loss: 1.740 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9693984985351562
Epoch: 8, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.754 Vali Acc: 0.220 Test Loss: 1.754 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9440674781799316
Epoch: 9, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.724 Vali Acc: 0.240 Test Loss: 1.724 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9437458515167236
Epoch: 10, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.909 Vali Acc: 0.320 Test Loss: 1.909 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319981).  Saving model ...
Epoch: 11 cost time: 1.7600314617156982
Epoch: 11, Steps: 4 | Train Loss: 0.084 Vali Loss: 2.011 Vali Acc: 0.260 Test Loss: 2.011 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8120837211608887
Epoch: 12, Steps: 4 | Train Loss: 0.040 Vali Loss: 2.097 Vali Acc: 0.240 Test Loss: 2.097 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.958655595779419
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.114 Vali Acc: 0.260 Test Loss: 2.114 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8129382133483887
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.135 Vali Acc: 0.260 Test Loss: 2.135 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8792178630828857
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.062 Vali Acc: 0.340 Test Loss: 2.062 Test Acc: 0.340
Validation loss decreased (-0.319981 --> -0.339979).  Saving model ...
Epoch: 16 cost time: 1.894531011581421
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.031 Vali Acc: 0.340 Test Loss: 2.031 Test Acc: 0.340
Validation loss decreased (-0.339979 --> -0.339980).  Saving model ...
Epoch: 17 cost time: 2.013033628463745
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.067 Vali Acc: 0.340 Test Loss: 2.067 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0985264778137207
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.137 Vali Acc: 0.300 Test Loss: 2.137 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9404025077819824
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.235 Vali Acc: 0.300 Test Loss: 2.235 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.033125877380371
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.319 Vali Acc: 0.280 Test Loss: 2.319 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9755911827087402
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.360 Vali Acc: 0.280 Test Loss: 2.360 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2239434719085693
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.370 Vali Acc: 0.280 Test Loss: 2.370 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8414747714996338
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.364 Vali Acc: 0.280 Test Loss: 2.364 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7216691970825195
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.360 Vali Acc: 0.280 Test Loss: 2.360 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6947693824768066
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.357 Vali Acc: 0.280 Test Loss: 2.357 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8021965026855469
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.358 Vali Acc: 0.280 Test Loss: 2.358 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4672114849090576
Epoch: 1, Steps: 4 | Train Loss: 1.695 Vali Loss: 1.689 Vali Acc: 0.180 Test Loss: 1.689 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.9048984050750732
Epoch: 2, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.661 Vali Acc: 0.200 Test Loss: 1.661 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.8538193702697754
Epoch: 3, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.647 Vali Acc: 0.180 Test Loss: 1.647 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9774630069732666
Epoch: 4, Steps: 4 | Train Loss: 1.061 Vali Loss: 1.689 Vali Acc: 0.180 Test Loss: 1.689 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8992598056793213
Epoch: 5, Steps: 4 | Train Loss: 0.780 Vali Loss: 1.793 Vali Acc: 0.180 Test Loss: 1.793 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.934154748916626
Epoch: 6, Steps: 4 | Train Loss: 0.539 Vali Loss: 1.836 Vali Acc: 0.160 Test Loss: 1.836 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.698904037475586
Epoch: 7, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.843 Vali Acc: 0.260 Test Loss: 1.843 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259982).  Saving model ...
Epoch: 8 cost time: 1.8523383140563965
Epoch: 8, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.868 Vali Acc: 0.220 Test Loss: 1.868 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8807156085968018
Epoch: 9, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.838 Vali Acc: 0.260 Test Loss: 1.838 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259982).  Saving model ...
Epoch: 10 cost time: 1.793379306793213
Epoch: 10, Steps: 4 | Train Loss: 0.104 Vali Loss: 2.026 Vali Acc: 0.220 Test Loss: 2.026 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8525373935699463
Epoch: 11, Steps: 4 | Train Loss: 0.074 Vali Loss: 2.189 Vali Acc: 0.260 Test Loss: 2.189 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7126116752624512
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.327 Vali Acc: 0.260 Test Loss: 2.327 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.667832851409912
Epoch: 13, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.347 Vali Acc: 0.280 Test Loss: 2.347 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279977).  Saving model ...
Epoch: 14 cost time: 1.9538688659667969
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.363 Vali Acc: 0.240 Test Loss: 2.363 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.018228054046631
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.279 Vali Acc: 0.240 Test Loss: 2.279 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9991955757141113
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.243 Vali Acc: 0.260 Test Loss: 2.243 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0991382598876953
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.276 Vali Acc: 0.260 Test Loss: 2.276 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2287604808807373
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.350 Vali Acc: 0.220 Test Loss: 2.350 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8892362117767334
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.445 Vali Acc: 0.240 Test Loss: 2.445 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.011125326156616
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.529 Vali Acc: 0.260 Test Loss: 2.529 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8105583190917969
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.581 Vali Acc: 0.260 Test Loss: 2.581 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8645899295806885
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.610 Vali Acc: 0.260 Test Loss: 2.610 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8231017589569092
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.626 Vali Acc: 0.260 Test Loss: 2.626 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.438427209854126
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.686 Vali Acc: 0.220 Test Loss: 1.686 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.6642639636993408
Epoch: 2, Steps: 4 | Train Loss: 1.686 Vali Loss: 1.660 Vali Acc: 0.160 Test Loss: 1.660 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8223178386688232
Epoch: 3, Steps: 4 | Train Loss: 1.276 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.6476173400878906
Epoch: 4, Steps: 4 | Train Loss: 1.052 Vali Loss: 1.672 Vali Acc: 0.180 Test Loss: 1.672 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8879334926605225
Epoch: 5, Steps: 4 | Train Loss: 0.722 Vali Loss: 1.759 Vali Acc: 0.180 Test Loss: 1.759 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.716346025466919
Epoch: 6, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.808 Vali Acc: 0.220 Test Loss: 1.808 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8535337448120117
Epoch: 7, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.807 Vali Acc: 0.220 Test Loss: 1.807 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5851609706878662
Epoch: 8, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.808 Vali Acc: 0.260 Test Loss: 1.808 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259982).  Saving model ...
Epoch: 9 cost time: 1.6983954906463623
Epoch: 9, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.769 Vali Acc: 0.300 Test Loss: 1.769 Test Acc: 0.300
Validation loss decreased (-0.259982 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 1.6773364543914795
Epoch: 10, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.969 Vali Acc: 0.280 Test Loss: 1.969 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7250664234161377
Epoch: 11, Steps: 4 | Train Loss: 0.066 Vali Loss: 2.132 Vali Acc: 0.300 Test Loss: 2.132 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6464228630065918
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.242 Vali Acc: 0.320 Test Loss: 2.242 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319978).  Saving model ...
Epoch: 13 cost time: 1.7072150707244873
Epoch: 13, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.249 Vali Acc: 0.280 Test Loss: 2.249 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6865742206573486
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.261 Vali Acc: 0.320 Test Loss: 2.261 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.759976863861084
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.209 Vali Acc: 0.340 Test Loss: 2.209 Test Acc: 0.340
Validation loss decreased (-0.319978 --> -0.339978).  Saving model ...
Epoch: 16 cost time: 1.8205184936523438
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.179 Vali Acc: 0.340 Test Loss: 2.179 Test Acc: 0.340
Validation loss decreased (-0.339978 --> -0.339978).  Saving model ...
Epoch: 17 cost time: 1.8531711101531982
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.190 Vali Acc: 0.340 Test Loss: 2.190 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9108073711395264
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.223 Vali Acc: 0.340 Test Loss: 2.223 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8193485736846924
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.283 Vali Acc: 0.340 Test Loss: 2.283 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9330625534057617
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.349 Vali Acc: 0.340 Test Loss: 2.349 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8473689556121826
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.403 Vali Acc: 0.320 Test Loss: 2.403 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9313559532165527
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.444 Vali Acc: 0.320 Test Loss: 2.444 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9449639320373535
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.474 Vali Acc: 0.320 Test Loss: 2.474 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8015658855438232
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.496 Vali Acc: 0.320 Test Loss: 2.496 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7405116558074951
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.514 Vali Acc: 0.320 Test Loss: 2.514 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.726557970046997
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.526 Vali Acc: 0.320 Test Loss: 2.526 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5705132484436035
Epoch: 1, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.619 Vali Acc: 0.220 Test Loss: 1.619 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9628331661224365
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.576 Vali Acc: 0.260 Test Loss: 1.576 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.8583474159240723
Epoch: 3, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.556 Vali Acc: 0.160 Test Loss: 1.556 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8255505561828613
Epoch: 4, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.591 Vali Acc: 0.180 Test Loss: 1.591 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7658288478851318
Epoch: 5, Steps: 4 | Train Loss: 0.753 Vali Loss: 1.705 Vali Acc: 0.240 Test Loss: 1.705 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.025038480758667
Epoch: 6, Steps: 4 | Train Loss: 0.529 Vali Loss: 1.812 Vali Acc: 0.200 Test Loss: 1.812 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.816155195236206
Epoch: 7, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.820 Vali Acc: 0.180 Test Loss: 1.820 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.700730562210083
Epoch: 8, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.805 Vali Acc: 0.220 Test Loss: 1.805 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.68021821975708
Epoch: 9, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.773 Vali Acc: 0.200 Test Loss: 1.773 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7171742916107178
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.984 Vali Acc: 0.220 Test Loss: 1.984 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7060811519622803
Epoch: 11, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.145 Vali Acc: 0.180 Test Loss: 2.145 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7421715259552002
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.199 Vali Acc: 0.240 Test Loss: 2.199 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.63242244720459
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.709 Vali Acc: 0.200 Test Loss: 1.709 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.793398141860962
Epoch: 2, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.698 Vali Acc: 0.180 Test Loss: 1.698 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8638916015625
Epoch: 3, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.684 Vali Acc: 0.200 Test Loss: 1.684 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.825188159942627
Epoch: 4, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.697 Vali Acc: 0.180 Test Loss: 1.697 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.877295970916748
Epoch: 5, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.769 Vali Acc: 0.200 Test Loss: 1.769 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.803048849105835
Epoch: 6, Steps: 4 | Train Loss: 0.497 Vali Loss: 1.863 Vali Acc: 0.180 Test Loss: 1.863 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.781315565109253
Epoch: 7, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.890 Vali Acc: 0.200 Test Loss: 1.890 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7552454471588135
Epoch: 8, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.887 Vali Acc: 0.240 Test Loss: 1.887 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239981).  Saving model ...
Epoch: 9 cost time: 1.779813289642334
Epoch: 9, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.861 Vali Acc: 0.200 Test Loss: 1.861 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.740638256072998
Epoch: 10, Steps: 4 | Train Loss: 0.078 Vali Loss: 2.038 Vali Acc: 0.220 Test Loss: 2.038 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7660822868347168
Epoch: 11, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.201 Vali Acc: 0.220 Test Loss: 2.201 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8659336566925049
Epoch: 12, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.282 Vali Acc: 0.280 Test Loss: 2.282 Test Acc: 0.280
Validation loss decreased (-0.239981 --> -0.279977).  Saving model ...
Epoch: 13 cost time: 1.9261579513549805
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.332 Vali Acc: 0.260 Test Loss: 2.332 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9090487957000732
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.352 Vali Acc: 0.260 Test Loss: 2.352 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9000144004821777
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.321 Vali Acc: 0.240 Test Loss: 2.321 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9091863632202148
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.316 Vali Acc: 0.220 Test Loss: 2.316 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9475066661834717
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.344 Vali Acc: 0.220 Test Loss: 2.344 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9811148643493652
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.388 Vali Acc: 0.200 Test Loss: 2.388 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8241996765136719
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.425 Vali Acc: 0.200 Test Loss: 2.425 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.815049648284912
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.448 Vali Acc: 0.220 Test Loss: 2.448 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.813349723815918
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.459 Vali Acc: 0.220 Test Loss: 2.459 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7187154293060303
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.470 Vali Acc: 0.260 Test Loss: 2.470 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5149550437927246
Epoch: 1, Steps: 4 | Train Loss: 1.685 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.8801848888397217
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.608 Vali Acc: 0.200 Test Loss: 1.608 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7523167133331299
Epoch: 3, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.584 Vali Acc: 0.260 Test Loss: 1.584 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.8117687702178955
Epoch: 4, Steps: 4 | Train Loss: 1.122 Vali Loss: 1.598 Vali Acc: 0.260 Test Loss: 1.598 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.716850996017456
Epoch: 5, Steps: 4 | Train Loss: 0.746 Vali Loss: 1.655 Vali Acc: 0.260 Test Loss: 1.655 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8790433406829834
Epoch: 6, Steps: 4 | Train Loss: 0.549 Vali Loss: 1.744 Vali Acc: 0.240 Test Loss: 1.744 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7840609550476074
Epoch: 7, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.774 Vali Acc: 0.220 Test Loss: 1.774 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6421716213226318
Epoch: 8, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.750 Vali Acc: 0.280 Test Loss: 1.750 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 9 cost time: 1.7811543941497803
Epoch: 9, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.707 Vali Acc: 0.280 Test Loss: 1.707 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279983).  Saving model ...
Epoch: 10 cost time: 1.6785645484924316
Epoch: 10, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.868 Vali Acc: 0.260 Test Loss: 1.868 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7805514335632324
Epoch: 11, Steps: 4 | Train Loss: 0.066 Vali Loss: 2.020 Vali Acc: 0.280 Test Loss: 2.020 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8043787479400635
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.083 Vali Acc: 0.280 Test Loss: 2.083 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7139010429382324
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.090 Vali Acc: 0.280 Test Loss: 2.090 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7322535514831543
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.074 Vali Acc: 0.280 Test Loss: 2.074 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.774076223373413
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.047 Vali Acc: 0.240 Test Loss: 2.047 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9911599159240723
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.054 Vali Acc: 0.280 Test Loss: 2.054 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8763651847839355
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.090 Vali Acc: 0.260 Test Loss: 2.090 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.037802219390869
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.130 Vali Acc: 0.280 Test Loss: 2.130 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9451713562011719
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.164 Vali Acc: 0.260 Test Loss: 2.164 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5770151615142822
Epoch: 1, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.633 Vali Acc: 0.180 Test Loss: 1.633 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.9227545261383057
Epoch: 2, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.641 Vali Acc: 0.160 Test Loss: 1.641 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7705399990081787
Epoch: 3, Steps: 4 | Train Loss: 1.279 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.8717834949493408
Epoch: 4, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 1.7185213565826416
Epoch: 5, Steps: 4 | Train Loss: 0.825 Vali Loss: 1.678 Vali Acc: 0.220 Test Loss: 1.678 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9837064743041992
Epoch: 6, Steps: 4 | Train Loss: 0.594 Vali Loss: 1.743 Vali Acc: 0.180 Test Loss: 1.743 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9948854446411133
Epoch: 7, Steps: 4 | Train Loss: 0.387 Vali Loss: 1.770 Vali Acc: 0.260 Test Loss: 1.770 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259982).  Saving model ...
Epoch: 8 cost time: 1.9833402633666992
Epoch: 8, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.766 Vali Acc: 0.200 Test Loss: 1.766 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8750245571136475
Epoch: 9, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.697 Vali Acc: 0.260 Test Loss: 1.697 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259983).  Saving model ...
Epoch: 10 cost time: 1.980297327041626
Epoch: 10, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.770 Vali Acc: 0.280 Test Loss: 1.770 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 11 cost time: 2.1442904472351074
Epoch: 11, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.918 Vali Acc: 0.240 Test Loss: 1.918 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8708651065826416
Epoch: 12, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.017 Vali Acc: 0.280 Test Loss: 2.017 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7686214447021484
Epoch: 13, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.044 Vali Acc: 0.280 Test Loss: 2.044 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7124831676483154
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.042 Vali Acc: 0.220 Test Loss: 2.042 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6246256828308105
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.995 Vali Acc: 0.260 Test Loss: 1.995 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.792565107345581
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.993 Vali Acc: 0.300 Test Loss: 1.993 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299980).  Saving model ...
Epoch: 17 cost time: 1.7191236019134521
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.023 Vali Acc: 0.300 Test Loss: 2.023 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6866462230682373
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.065 Vali Acc: 0.320 Test Loss: 2.065 Test Acc: 0.320
Validation loss decreased (-0.299980 --> -0.319979).  Saving model ...
Epoch: 19 cost time: 1.8297898769378662
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.119 Vali Acc: 0.300 Test Loss: 2.119 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9165940284729004
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.160 Vali Acc: 0.280 Test Loss: 2.160 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7721326351165771
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.185 Vali Acc: 0.260 Test Loss: 2.185 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0576298236846924
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.205 Vali Acc: 0.280 Test Loss: 2.205 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9651100635528564
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.214 Vali Acc: 0.260 Test Loss: 2.214 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.011624336242676
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.225 Vali Acc: 0.280 Test Loss: 2.225 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.820662260055542
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.234 Vali Acc: 0.280 Test Loss: 2.234 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.218306541442871
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.238 Vali Acc: 0.280 Test Loss: 2.238 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8646790981292725
Epoch: 27, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.232 Vali Acc: 0.300 Test Loss: 2.232 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8954458236694336
Epoch: 28, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.211 Vali Acc: 0.300 Test Loss: 2.211 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4829187393188477
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.016450881958008
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.692 Vali Acc: 0.220 Test Loss: 1.692 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8793890476226807
Epoch: 3, Steps: 4 | Train Loss: 1.412 Vali Loss: 1.681 Vali Acc: 0.160 Test Loss: 1.681 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7589595317840576
Epoch: 4, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.671 Vali Acc: 0.140 Test Loss: 1.671 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7535452842712402
Epoch: 5, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.663 Vali Acc: 0.120 Test Loss: 1.663 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8708319664001465
Epoch: 6, Steps: 4 | Train Loss: 0.998 Vali Loss: 1.688 Vali Acc: 0.120 Test Loss: 1.688 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8622572422027588
Epoch: 7, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.712 Vali Acc: 0.140 Test Loss: 1.712 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6615750789642334
Epoch: 8, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.710 Vali Acc: 0.120 Test Loss: 1.710 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7176222801208496
Epoch: 9, Steps: 4 | Train Loss: 0.500 Vali Loss: 1.635 Vali Acc: 0.140 Test Loss: 1.635 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7317373752593994
Epoch: 10, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.669 Vali Acc: 0.120 Test Loss: 1.669 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7726504802703857
Epoch: 11, Steps: 4 | Train Loss: 0.433 Vali Loss: 1.778 Vali Acc: 0.200 Test Loss: 1.778 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6869263648986816
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.744 Vali Acc: 0.140 Test Loss: 1.744 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.863651990890503
Epoch: 2, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.745 Vali Acc: 0.060 Test Loss: 1.745 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9233298301696777
Epoch: 3, Steps: 4 | Train Loss: 1.448 Vali Loss: 1.740 Vali Acc: 0.140 Test Loss: 1.740 Test Acc: 0.140
Validation loss decreased (-0.139983 --> -0.139983).  Saving model ...
Epoch: 4 cost time: 1.9550743103027344
Epoch: 4, Steps: 4 | Train Loss: 1.379 Vali Loss: 1.751 Vali Acc: 0.120 Test Loss: 1.751 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.678978681564331
Epoch: 5, Steps: 4 | Train Loss: 1.107 Vali Loss: 1.752 Vali Acc: 0.120 Test Loss: 1.752 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7816705703735352
Epoch: 6, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.772 Vali Acc: 0.140 Test Loss: 1.772 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.945174217224121
Epoch: 7, Steps: 4 | Train Loss: 0.664 Vali Loss: 1.790 Vali Acc: 0.120 Test Loss: 1.790 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8373723030090332
Epoch: 8, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.777 Vali Acc: 0.100 Test Loss: 1.777 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6353178024291992
Epoch: 9, Steps: 4 | Train Loss: 0.452 Vali Loss: 1.702 Vali Acc: 0.100 Test Loss: 1.702 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8335599899291992
Epoch: 10, Steps: 4 | Train Loss: 0.309 Vali Loss: 1.738 Vali Acc: 0.080 Test Loss: 1.738 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7316763401031494
Epoch: 11, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.862 Vali Acc: 0.080 Test Loss: 1.862 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.676288366317749
Epoch: 12, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.937 Vali Acc: 0.100 Test Loss: 1.937 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8767871856689453
Epoch: 13, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.796 Vali Acc: 0.080 Test Loss: 1.796 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.14
model parameter : 1547525
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.653663396835327
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.650 Vali Acc: 0.260 Test Loss: 1.650 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.8303203582763672
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.655 Vali Acc: 0.300 Test Loss: 1.655 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.7249293327331543
Epoch: 3, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.675 Vali Acc: 0.300 Test Loss: 1.675 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.730912208557129
Epoch: 4, Steps: 4 | Train Loss: 1.009 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8200478553771973
Epoch: 5, Steps: 4 | Train Loss: 0.755 Vali Loss: 1.734 Vali Acc: 0.220 Test Loss: 1.734 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8213136196136475
Epoch: 6, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.769 Vali Acc: 0.260 Test Loss: 1.769 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7737324237823486
Epoch: 7, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.729 Vali Acc: 0.340 Test Loss: 1.729 Test Acc: 0.340
Validation loss decreased (-0.299983 --> -0.339983).  Saving model ...
Epoch: 8 cost time: 1.877380132675171
Epoch: 8, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.839 Vali Acc: 0.260 Test Loss: 1.839 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0178518295288086
Epoch: 9, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.859 Vali Acc: 0.300 Test Loss: 1.859 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9274744987487793
Epoch: 10, Steps: 4 | Train Loss: 0.100 Vali Loss: 2.052 Vali Acc: 0.300 Test Loss: 2.052 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8684639930725098
Epoch: 11, Steps: 4 | Train Loss: 0.060 Vali Loss: 2.033 Vali Acc: 0.280 Test Loss: 2.033 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9151968955993652
Epoch: 12, Steps: 4 | Train Loss: 0.038 Vali Loss: 2.090 Vali Acc: 0.280 Test Loss: 2.090 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9966950416564941
Epoch: 13, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.130 Vali Acc: 0.340 Test Loss: 2.130 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.031386375427246
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.179 Vali Acc: 0.340 Test Loss: 2.179 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.822181224822998
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.260 Vali Acc: 0.320 Test Loss: 2.260 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.957289218902588
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.304 Vali Acc: 0.320 Test Loss: 2.304 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.993492603302002
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.318 Vali Acc: 0.340 Test Loss: 2.318 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6016030311584473
Epoch: 1, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.679 Vali Acc: 0.240 Test Loss: 1.679 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.953596830368042
Epoch: 2, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.673 Vali Acc: 0.180 Test Loss: 1.673 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.881295919418335
Epoch: 3, Steps: 4 | Train Loss: 1.476 Vali Loss: 1.688 Vali Acc: 0.200 Test Loss: 1.688 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9078519344329834
Epoch: 4, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.661 Vali Acc: 0.240 Test Loss: 1.661 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.892242670059204
Epoch: 5, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.757 Vali Acc: 0.200 Test Loss: 1.757 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.792036533355713
Epoch: 6, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.791 Vali Acc: 0.320 Test Loss: 1.791 Test Acc: 0.320
Validation loss decreased (-0.239983 --> -0.319982).  Saving model ...
Epoch: 7 cost time: 1.7154557704925537
Epoch: 7, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.731 Vali Acc: 0.300 Test Loss: 1.731 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7227213382720947
Epoch: 8, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.827 Vali Acc: 0.260 Test Loss: 1.827 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6424171924591064
Epoch: 9, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.857 Vali Acc: 0.300 Test Loss: 1.857 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7285072803497314
Epoch: 10, Steps: 4 | Train Loss: 0.110 Vali Loss: 2.058 Vali Acc: 0.300 Test Loss: 2.058 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7130234241485596
Epoch: 11, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.992 Vali Acc: 0.340 Test Loss: 1.992 Test Acc: 0.340
Validation loss decreased (-0.319982 --> -0.339980).  Saving model ...
Epoch: 12 cost time: 1.78745698928833
Epoch: 12, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.013 Vali Acc: 0.280 Test Loss: 2.013 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7239511013031006
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.051 Vali Acc: 0.340 Test Loss: 2.051 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6447265148162842
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.087 Vali Acc: 0.360 Test Loss: 2.087 Test Acc: 0.360
Validation loss decreased (-0.339980 --> -0.359979).  Saving model ...
Epoch: 15 cost time: 1.7697200775146484
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.158 Vali Acc: 0.360 Test Loss: 2.158 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7994799613952637
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.203 Vali Acc: 0.360 Test Loss: 2.203 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8081839084625244
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.219 Vali Acc: 0.360 Test Loss: 2.219 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.768348217010498
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.225 Vali Acc: 0.340 Test Loss: 2.225 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9546847343444824
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.239 Vali Acc: 0.340 Test Loss: 2.239 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.948077917098999
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.257 Vali Acc: 0.340 Test Loss: 2.257 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7683801651000977
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.263 Vali Acc: 0.340 Test Loss: 2.263 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7619574069976807
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.270 Vali Acc: 0.320 Test Loss: 2.270 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6190552711486816
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.283 Vali Acc: 0.320 Test Loss: 2.283 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.736924648284912
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.297 Vali Acc: 0.320 Test Loss: 2.297 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.634003162384033
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.791 Vali Acc: 0.140 Test Loss: 1.791 Test Acc: 0.140
Validation loss decreased (inf --> -0.139982).  Saving model ...
Epoch: 2 cost time: 1.8981668949127197
Epoch: 2, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.791 Vali Acc: 0.180 Test Loss: 1.791 Test Acc: 0.180
Validation loss decreased (-0.139982 --> -0.179982).  Saving model ...
Epoch: 3 cost time: 1.8642778396606445
Epoch: 3, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.820 Vali Acc: 0.140 Test Loss: 1.820 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8700575828552246
Epoch: 4, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.803 Vali Acc: 0.240 Test Loss: 1.803 Test Acc: 0.240
Validation loss decreased (-0.179982 --> -0.239982).  Saving model ...
Epoch: 5 cost time: 1.8396415710449219
Epoch: 5, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.922 Vali Acc: 0.220 Test Loss: 1.922 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9871926307678223
Epoch: 6, Steps: 4 | Train Loss: 0.618 Vali Loss: 1.983 Vali Acc: 0.320 Test Loss: 1.983 Test Acc: 0.320
Validation loss decreased (-0.239982 --> -0.319980).  Saving model ...
Epoch: 7 cost time: 1.6122279167175293
Epoch: 7, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.957 Vali Acc: 0.280 Test Loss: 1.957 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7821600437164307
Epoch: 8, Steps: 4 | Train Loss: 0.262 Vali Loss: 2.082 Vali Acc: 0.240 Test Loss: 2.082 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8209593296051025
Epoch: 9, Steps: 4 | Train Loss: 0.141 Vali Loss: 2.162 Vali Acc: 0.240 Test Loss: 2.162 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6726429462432861
Epoch: 10, Steps: 4 | Train Loss: 0.104 Vali Loss: 2.385 Vali Acc: 0.280 Test Loss: 2.385 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7932088375091553
Epoch: 11, Steps: 4 | Train Loss: 0.060 Vali Loss: 2.401 Vali Acc: 0.260 Test Loss: 2.401 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.746131420135498
Epoch: 12, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.468 Vali Acc: 0.260 Test Loss: 2.468 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.793139934539795
Epoch: 13, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.515 Vali Acc: 0.260 Test Loss: 2.515 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8228411674499512
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.531 Vali Acc: 0.240 Test Loss: 2.531 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.858102560043335
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.583 Vali Acc: 0.240 Test Loss: 2.583 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.984921932220459
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.625 Vali Acc: 0.240 Test Loss: 2.625 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5045604705810547
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.793 Vali Acc: 0.200 Test Loss: 1.793 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.636258840560913
Epoch: 2, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.789 Vali Acc: 0.140 Test Loss: 1.789 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6184501647949219
Epoch: 3, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.801 Vali Acc: 0.200 Test Loss: 1.801 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6138927936553955
Epoch: 4, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.760 Vali Acc: 0.240 Test Loss: 1.760 Test Acc: 0.240
Validation loss decreased (-0.199982 --> -0.239982).  Saving model ...
Epoch: 5 cost time: 1.7138378620147705
Epoch: 5, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.857 Vali Acc: 0.240 Test Loss: 1.857 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6575183868408203
Epoch: 6, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.888 Vali Acc: 0.340 Test Loss: 1.888 Test Acc: 0.340
Validation loss decreased (-0.239982 --> -0.339981).  Saving model ...
Epoch: 7 cost time: 1.6748151779174805
Epoch: 7, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.860 Vali Acc: 0.320 Test Loss: 1.860 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7285921573638916
Epoch: 8, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.990 Vali Acc: 0.280 Test Loss: 1.990 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.669778823852539
Epoch: 9, Steps: 4 | Train Loss: 0.133 Vali Loss: 2.046 Vali Acc: 0.280 Test Loss: 2.046 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7766318321228027
Epoch: 10, Steps: 4 | Train Loss: 0.093 Vali Loss: 2.208 Vali Acc: 0.280 Test Loss: 2.208 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7239012718200684
Epoch: 11, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.201 Vali Acc: 0.260 Test Loss: 2.201 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8946402072906494
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.259 Vali Acc: 0.280 Test Loss: 2.259 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7417914867401123
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.318 Vali Acc: 0.260 Test Loss: 2.318 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7779436111450195
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.329 Vali Acc: 0.320 Test Loss: 2.329 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8215758800506592
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.373 Vali Acc: 0.340 Test Loss: 2.373 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6383633613586426
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.408 Vali Acc: 0.380 Test Loss: 2.408 Test Acc: 0.380
Validation loss decreased (-0.339981 --> -0.379976).  Saving model ...
Epoch: 17 cost time: 1.7431902885437012
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.424 Vali Acc: 0.380 Test Loss: 2.424 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6868948936462402
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.438 Vali Acc: 0.380 Test Loss: 2.438 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.77647066116333
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.454 Vali Acc: 0.360 Test Loss: 2.454 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.752396821975708
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.475 Vali Acc: 0.340 Test Loss: 2.475 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.646482229232788
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.485 Vali Acc: 0.340 Test Loss: 2.485 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6585655212402344
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.494 Vali Acc: 0.340 Test Loss: 2.494 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.661407232284546
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.508 Vali Acc: 0.320 Test Loss: 2.508 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8148987293243408
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.517 Vali Acc: 0.320 Test Loss: 2.517 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.905543327331543
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.529 Vali Acc: 0.300 Test Loss: 2.529 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8889570236206055
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.567 Vali Acc: 0.300 Test Loss: 2.567 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5409162044525146
Epoch: 1, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.720 Vali Acc: 0.180 Test Loss: 1.720 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.6822483539581299
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.739 Vali Acc: 0.140 Test Loss: 1.739 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6739742755889893
Epoch: 3, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.780 Vali Acc: 0.200 Test Loss: 1.780 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.7496302127838135
Epoch: 4, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.752 Vali Acc: 0.200 Test Loss: 1.752 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 1.6603376865386963
Epoch: 5, Steps: 4 | Train Loss: 0.715 Vali Loss: 1.807 Vali Acc: 0.180 Test Loss: 1.807 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.719278335571289
Epoch: 6, Steps: 4 | Train Loss: 0.610 Vali Loss: 1.828 Vali Acc: 0.260 Test Loss: 1.828 Test Acc: 0.260
Validation loss decreased (-0.199982 --> -0.259982).  Saving model ...
Epoch: 7 cost time: 1.8381023406982422
Epoch: 7, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.827 Vali Acc: 0.240 Test Loss: 1.827 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8189966678619385
Epoch: 8, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.953 Vali Acc: 0.200 Test Loss: 1.953 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7920794486999512
Epoch: 9, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.037 Vali Acc: 0.260 Test Loss: 2.037 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7832129001617432
Epoch: 10, Steps: 4 | Train Loss: 0.076 Vali Loss: 2.217 Vali Acc: 0.280 Test Loss: 2.217 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279978).  Saving model ...
Epoch: 11 cost time: 1.785062551498413
Epoch: 11, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.232 Vali Acc: 0.260 Test Loss: 2.232 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7650678157806396
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.266 Vali Acc: 0.280 Test Loss: 2.266 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8363499641418457
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.284 Vali Acc: 0.260 Test Loss: 2.284 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7829246520996094
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.276 Vali Acc: 0.240 Test Loss: 2.276 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9211931228637695
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.296 Vali Acc: 0.240 Test Loss: 2.296 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.717278242111206
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.330 Vali Acc: 0.260 Test Loss: 2.330 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7191736698150635
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.367 Vali Acc: 0.260 Test Loss: 2.367 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8392245769500732
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.404 Vali Acc: 0.260 Test Loss: 2.404 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7504258155822754
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.440 Vali Acc: 0.240 Test Loss: 2.440 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.760756492614746
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.469 Vali Acc: 0.240 Test Loss: 2.469 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5031790733337402
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.672 Vali Acc: 0.160 Test Loss: 1.672 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.812032699584961
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.662 Vali Acc: 0.160 Test Loss: 1.662 Test Acc: 0.160
Validation loss decreased (-0.159983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.9241437911987305
Epoch: 3, Steps: 4 | Train Loss: 1.407 Vali Loss: 1.683 Vali Acc: 0.240 Test Loss: 1.683 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.7927887439727783
Epoch: 4, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.661 Vali Acc: 0.260 Test Loss: 1.661 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.8767025470733643
Epoch: 5, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.744 Vali Acc: 0.200 Test Loss: 1.744 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7730133533477783
Epoch: 6, Steps: 4 | Train Loss: 0.634 Vali Loss: 1.801 Vali Acc: 0.240 Test Loss: 1.801 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.719010353088379
Epoch: 7, Steps: 4 | Train Loss: 0.449 Vali Loss: 1.778 Vali Acc: 0.220 Test Loss: 1.778 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6734139919281006
Epoch: 8, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.879 Vali Acc: 0.260 Test Loss: 1.879 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6941487789154053
Epoch: 9, Steps: 4 | Train Loss: 0.118 Vali Loss: 2.010 Vali Acc: 0.200 Test Loss: 2.010 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7178618907928467
Epoch: 10, Steps: 4 | Train Loss: 0.075 Vali Loss: 2.209 Vali Acc: 0.240 Test Loss: 2.209 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7687523365020752
Epoch: 11, Steps: 4 | Train Loss: 0.043 Vali Loss: 2.234 Vali Acc: 0.240 Test Loss: 2.234 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7569422721862793
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.285 Vali Acc: 0.260 Test Loss: 2.285 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6495471000671387
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.318 Vali Acc: 0.240 Test Loss: 2.318 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7097458839416504
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.308 Vali Acc: 0.260 Test Loss: 2.308 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4762027263641357
Epoch: 1, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.696 Vali Acc: 0.200 Test Loss: 1.696 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.7792339324951172
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.686 Vali Acc: 0.200 Test Loss: 1.686 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.7938854694366455
Epoch: 3, Steps: 4 | Train Loss: 1.483 Vali Loss: 1.691 Vali Acc: 0.220 Test Loss: 1.691 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.8992886543273926
Epoch: 4, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.644 Vali Acc: 0.280 Test Loss: 1.644 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.628711223602295
Epoch: 5, Steps: 4 | Train Loss: 0.779 Vali Loss: 1.692 Vali Acc: 0.260 Test Loss: 1.692 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7889015674591064
Epoch: 6, Steps: 4 | Train Loss: 0.609 Vali Loss: 1.761 Vali Acc: 0.240 Test Loss: 1.761 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4815597534179688
Epoch: 7, Steps: 4 | Train Loss: 0.449 Vali Loss: 1.745 Vali Acc: 0.300 Test Loss: 1.745 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 1.7827441692352295
Epoch: 8, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.800 Vali Acc: 0.380 Test Loss: 1.800 Test Acc: 0.380
Validation loss decreased (-0.299983 --> -0.379982).  Saving model ...
Epoch: 9 cost time: 1.559297800064087
Epoch: 9, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.887 Vali Acc: 0.280 Test Loss: 1.887 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6749625205993652
Epoch: 10, Steps: 4 | Train Loss: 0.106 Vali Loss: 2.081 Vali Acc: 0.280 Test Loss: 2.081 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6259899139404297
Epoch: 11, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.109 Vali Acc: 0.280 Test Loss: 2.109 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7163264751434326
Epoch: 12, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.106 Vali Acc: 0.280 Test Loss: 2.106 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7138667106628418
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.099 Vali Acc: 0.300 Test Loss: 2.099 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7991077899932861
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.103 Vali Acc: 0.300 Test Loss: 2.103 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7702183723449707
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.120 Vali Acc: 0.280 Test Loss: 2.120 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.844691276550293
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.147 Vali Acc: 0.260 Test Loss: 2.147 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7446048259735107
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.181 Vali Acc: 0.260 Test Loss: 2.181 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7003133296966553
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.223 Vali Acc: 0.260 Test Loss: 2.223 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.451274871826172
Epoch: 1, Steps: 4 | Train Loss: 1.708 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.8478496074676514
Epoch: 2, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7576017379760742
Epoch: 3, Steps: 4 | Train Loss: 1.438 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8104488849639893
Epoch: 4, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.618 Vali Acc: 0.160 Test Loss: 1.618 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8393561840057373
Epoch: 5, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.614 Vali Acc: 0.280 Test Loss: 1.614 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.9736626148223877
Epoch: 6, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.633 Vali Acc: 0.260 Test Loss: 1.633 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9461448192596436
Epoch: 7, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.589 Vali Acc: 0.300 Test Loss: 1.589 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 8 cost time: 2.0210156440734863
Epoch: 8, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.595 Vali Acc: 0.300 Test Loss: 1.595 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0567679405212402
Epoch: 9, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.690 Vali Acc: 0.280 Test Loss: 1.690 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8852384090423584
Epoch: 10, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.817 Vali Acc: 0.300 Test Loss: 1.817 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.022780656814575
Epoch: 11, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.822 Vali Acc: 0.300 Test Loss: 1.822 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9818623065948486
Epoch: 12, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.801 Vali Acc: 0.360 Test Loss: 1.801 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359982).  Saving model ...
Epoch: 13 cost time: 1.8729302883148193
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.790 Vali Acc: 0.300 Test Loss: 1.790 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8887240886688232
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.831 Vali Acc: 0.280 Test Loss: 1.831 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7828352451324463
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.903 Vali Acc: 0.240 Test Loss: 1.903 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8998265266418457
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.977 Vali Acc: 0.240 Test Loss: 1.977 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7744965553283691
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.018 Vali Acc: 0.260 Test Loss: 2.018 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8147637844085693
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.031 Vali Acc: 0.220 Test Loss: 2.031 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.634981393814087
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.026 Vali Acc: 0.220 Test Loss: 2.026 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7203896045684814
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.031 Vali Acc: 0.260 Test Loss: 2.031 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9369630813598633
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.039 Vali Acc: 0.280 Test Loss: 2.039 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9035887718200684
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.060 Vali Acc: 0.280 Test Loss: 2.060 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.527879238128662
Epoch: 1, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.513 Vali Acc: 0.180 Test Loss: 1.513 Test Acc: 0.180
Validation loss decreased (inf --> -0.179985).  Saving model ...
Epoch: 2 cost time: 1.7065486907958984
Epoch: 2, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.519 Vali Acc: 0.160 Test Loss: 1.519 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6978516578674316
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.551 Vali Acc: 0.140 Test Loss: 1.551 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6406903266906738
Epoch: 4, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.532 Vali Acc: 0.160 Test Loss: 1.532 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6247692108154297
Epoch: 5, Steps: 4 | Train Loss: 1.156 Vali Loss: 1.525 Vali Acc: 0.160 Test Loss: 1.525 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7014214992523193
Epoch: 6, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.536 Vali Acc: 0.180 Test Loss: 1.536 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5624985694885254
Epoch: 7, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.523 Vali Acc: 0.180 Test Loss: 1.523 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.696777582168579
Epoch: 8, Steps: 4 | Train Loss: 0.776 Vali Loss: 1.537 Vali Acc: 0.120 Test Loss: 1.537 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7517201900482178
Epoch: 9, Steps: 4 | Train Loss: 0.483 Vali Loss: 1.564 Vali Acc: 0.140 Test Loss: 1.564 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8654930591583252
Epoch: 10, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.625 Vali Acc: 0.140 Test Loss: 1.625 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.802258014678955
Epoch: 11, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.649 Vali Acc: 0.180 Test Loss: 1.649 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6972692012786865
Epoch: 1, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.8146531581878662
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.641 Vali Acc: 0.140 Test Loss: 1.641 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.84635591506958
Epoch: 3, Steps: 4 | Train Loss: 1.402 Vali Loss: 1.671 Vali Acc: 0.140 Test Loss: 1.671 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7750179767608643
Epoch: 4, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.659 Vali Acc: 0.120 Test Loss: 1.659 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8867855072021484
Epoch: 5, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.646 Vali Acc: 0.120 Test Loss: 1.646 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7649922370910645
Epoch: 6, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.649 Vali Acc: 0.100 Test Loss: 1.649 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.784625768661499
Epoch: 7, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.637 Vali Acc: 0.100 Test Loss: 1.637 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.983428716659546
Epoch: 8, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.643 Vali Acc: 0.120 Test Loss: 1.643 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.801095962524414
Epoch: 9, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.663 Vali Acc: 0.120 Test Loss: 1.663 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8529088497161865
Epoch: 10, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.702 Vali Acc: 0.160 Test Loss: 1.702 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9849770069122314
Epoch: 11, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.739 Vali Acc: 0.180 Test Loss: 1.739 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 1449221
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.228935480117798
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.666 Vali Acc: 0.180 Test Loss: 1.666 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.521315336227417
Epoch: 2, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.651 Vali Acc: 0.280 Test Loss: 1.651 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.6866304874420166
Epoch: 3, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.668 Vali Acc: 0.260 Test Loss: 1.668 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9166390895843506
Epoch: 4, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.697 Vali Acc: 0.240 Test Loss: 1.697 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6177818775177002
Epoch: 5, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7542572021484375
Epoch: 6, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.668 Vali Acc: 0.260 Test Loss: 1.668 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0132100582122803
Epoch: 7, Steps: 4 | Train Loss: 0.650 Vali Loss: 1.694 Vali Acc: 0.260 Test Loss: 1.694 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8942184448242188
Epoch: 8, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7528467178344727
Epoch: 9, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.810 Vali Acc: 0.280 Test Loss: 1.810 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.829021692276001
Epoch: 10, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.806 Vali Acc: 0.280 Test Loss: 1.806 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8456368446350098
Epoch: 11, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.819 Vali Acc: 0.220 Test Loss: 1.819 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8170597553253174
Epoch: 12, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.850 Vali Acc: 0.280 Test Loss: 1.850 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.633305072784424
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.666 Vali Acc: 0.180 Test Loss: 1.666 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.853501558303833
Epoch: 2, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.8460164070129395
Epoch: 3, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.9694373607635498
Epoch: 4, Steps: 4 | Train Loss: 1.271 Vali Loss: 1.687 Vali Acc: 0.160 Test Loss: 1.687 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8027844429016113
Epoch: 5, Steps: 4 | Train Loss: 1.005 Vali Loss: 1.686 Vali Acc: 0.240 Test Loss: 1.686 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.827195167541504
Epoch: 6, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7766516208648682
Epoch: 7, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.667 Vali Acc: 0.260 Test Loss: 1.667 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.749624252319336
Epoch: 8, Steps: 4 | Train Loss: 0.644 Vali Loss: 1.734 Vali Acc: 0.220 Test Loss: 1.734 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7064952850341797
Epoch: 9, Steps: 4 | Train Loss: 0.387 Vali Loss: 1.769 Vali Acc: 0.260 Test Loss: 1.769 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8151097297668457
Epoch: 10, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.755 Vali Acc: 0.260 Test Loss: 1.755 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9223289489746094
Epoch: 11, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.746 Vali Acc: 0.260 Test Loss: 1.746 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7303740978240967
Epoch: 12, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.751 Vali Acc: 0.300 Test Loss: 1.751 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299982).  Saving model ...
Epoch: 13 cost time: 1.5875723361968994
Epoch: 13, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.822 Vali Acc: 0.240 Test Loss: 1.822 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8287382125854492
Epoch: 14, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.943 Vali Acc: 0.260 Test Loss: 1.943 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6313283443450928
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.973 Vali Acc: 0.260 Test Loss: 1.973 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9162335395812988
Epoch: 16, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.975 Vali Acc: 0.260 Test Loss: 1.975 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7854034900665283
Epoch: 17, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.990 Vali Acc: 0.260 Test Loss: 1.990 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7976927757263184
Epoch: 18, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.981 Vali Acc: 0.260 Test Loss: 1.981 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6439270973205566
Epoch: 19, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.986 Vali Acc: 0.320 Test Loss: 1.986 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319980).  Saving model ...
Epoch: 20 cost time: 1.7764811515808105
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.003 Vali Acc: 0.300 Test Loss: 2.003 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.724144458770752
Epoch: 21, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.039 Vali Acc: 0.280 Test Loss: 2.039 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7479889392852783
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.078 Vali Acc: 0.280 Test Loss: 2.078 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7513623237609863
Epoch: 23, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.115 Vali Acc: 0.280 Test Loss: 2.115 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5382921695709229
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.153 Vali Acc: 0.280 Test Loss: 2.153 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6702375411987305
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.177 Vali Acc: 0.280 Test Loss: 2.177 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7240397930145264
Epoch: 26, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.172 Vali Acc: 0.280 Test Loss: 2.172 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.648841381072998
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.168 Vali Acc: 0.300 Test Loss: 2.168 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6480693817138672
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.163 Vali Acc: 0.280 Test Loss: 2.163 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5764410495758057
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.158 Vali Acc: 0.300 Test Loss: 2.158 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5146243572235107
Epoch: 1, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.674 Vali Acc: 0.180 Test Loss: 1.674 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.8313262462615967
Epoch: 2, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.669 Vali Acc: 0.180 Test Loss: 1.669 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.8798480033874512
Epoch: 3, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.695 Vali Acc: 0.280 Test Loss: 1.695 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.8922131061553955
Epoch: 4, Steps: 4 | Train Loss: 1.268 Vali Loss: 1.734 Vali Acc: 0.220 Test Loss: 1.734 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8132884502410889
Epoch: 5, Steps: 4 | Train Loss: 1.005 Vali Loss: 1.740 Vali Acc: 0.260 Test Loss: 1.740 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.76645827293396
Epoch: 6, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.704 Vali Acc: 0.220 Test Loss: 1.704 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7960288524627686
Epoch: 7, Steps: 4 | Train Loss: 0.641 Vali Loss: 1.729 Vali Acc: 0.220 Test Loss: 1.729 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6953506469726562
Epoch: 8, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.818 Vali Acc: 0.240 Test Loss: 1.818 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7847707271575928
Epoch: 9, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.882 Vali Acc: 0.340 Test Loss: 1.882 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339981).  Saving model ...
Epoch: 10 cost time: 1.8403675556182861
Epoch: 10, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.893 Vali Acc: 0.340 Test Loss: 1.893 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6393446922302246
Epoch: 11, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.911 Vali Acc: 0.260 Test Loss: 1.911 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8374717235565186
Epoch: 12, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.946 Vali Acc: 0.280 Test Loss: 1.946 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.812145471572876
Epoch: 13, Steps: 4 | Train Loss: 0.102 Vali Loss: 2.051 Vali Acc: 0.260 Test Loss: 2.051 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0479166507720947
Epoch: 14, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.216 Vali Acc: 0.240 Test Loss: 2.216 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.81233549118042
Epoch: 15, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.284 Vali Acc: 0.260 Test Loss: 2.284 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9644389152526855
Epoch: 16, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.322 Vali Acc: 0.260 Test Loss: 2.322 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8814098834991455
Epoch: 17, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.351 Vali Acc: 0.320 Test Loss: 2.351 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8657281398773193
Epoch: 18, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.345 Vali Acc: 0.280 Test Loss: 2.345 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8938143253326416
Epoch: 19, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.354 Vali Acc: 0.300 Test Loss: 2.354 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3189079761505127
Epoch: 1, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.720 Vali Acc: 0.160 Test Loss: 1.720 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.7642710208892822
Epoch: 2, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.725 Vali Acc: 0.220 Test Loss: 1.725 Test Acc: 0.220
Validation loss decreased (-0.159983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.9825940132141113
Epoch: 3, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.753 Vali Acc: 0.320 Test Loss: 1.753 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319982).  Saving model ...
Epoch: 4 cost time: 1.9472503662109375
Epoch: 4, Steps: 4 | Train Loss: 1.264 Vali Loss: 1.790 Vali Acc: 0.260 Test Loss: 1.790 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9597527980804443
Epoch: 5, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.799 Vali Acc: 0.280 Test Loss: 1.799 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.760183334350586
Epoch: 6, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.755 Vali Acc: 0.260 Test Loss: 1.755 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8983745574951172
Epoch: 7, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.769 Vali Acc: 0.280 Test Loss: 1.769 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9929640293121338
Epoch: 8, Steps: 4 | Train Loss: 0.588 Vali Loss: 1.853 Vali Acc: 0.220 Test Loss: 1.853 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8099782466888428
Epoch: 9, Steps: 4 | Train Loss: 0.357 Vali Loss: 1.915 Vali Acc: 0.340 Test Loss: 1.915 Test Acc: 0.340
Validation loss decreased (-0.319982 --> -0.339981).  Saving model ...
Epoch: 10 cost time: 1.6967289447784424
Epoch: 10, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.932 Vali Acc: 0.360 Test Loss: 1.932 Test Acc: 0.360
Validation loss decreased (-0.339981 --> -0.359981).  Saving model ...
Epoch: 11 cost time: 1.6062488555908203
Epoch: 11, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.946 Vali Acc: 0.300 Test Loss: 1.946 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.595808506011963
Epoch: 12, Steps: 4 | Train Loss: 0.125 Vali Loss: 2.001 Vali Acc: 0.300 Test Loss: 2.001 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6888842582702637
Epoch: 13, Steps: 4 | Train Loss: 0.083 Vali Loss: 2.120 Vali Acc: 0.320 Test Loss: 2.120 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6889653205871582
Epoch: 14, Steps: 4 | Train Loss: 0.045 Vali Loss: 2.288 Vali Acc: 0.300 Test Loss: 2.288 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7428781986236572
Epoch: 15, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.369 Vali Acc: 0.320 Test Loss: 2.369 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8665289878845215
Epoch: 16, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.405 Vali Acc: 0.320 Test Loss: 2.405 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.093409299850464
Epoch: 17, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.399 Vali Acc: 0.320 Test Loss: 2.399 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1132795810699463
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.370 Vali Acc: 0.320 Test Loss: 2.370 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0376529693603516
Epoch: 19, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.362 Vali Acc: 0.320 Test Loss: 2.362 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0754058361053467
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.368 Vali Acc: 0.340 Test Loss: 2.368 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6010563373565674
Epoch: 1, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.617 Vali Acc: 0.240 Test Loss: 1.617 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.756476879119873
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7317817211151123
Epoch: 3, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8146007061004639
Epoch: 4, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7916290760040283
Epoch: 5, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.649 Vali Acc: 0.220 Test Loss: 1.649 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8008930683135986
Epoch: 6, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.617 Vali Acc: 0.200 Test Loss: 1.617 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0518414974212646
Epoch: 7, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.635 Vali Acc: 0.220 Test Loss: 1.635 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0457189083099365
Epoch: 8, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8910748958587646
Epoch: 9, Steps: 4 | Train Loss: 0.366 Vali Loss: 1.759 Vali Acc: 0.200 Test Loss: 1.759 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7881243228912354
Epoch: 10, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.751 Vali Acc: 0.200 Test Loss: 1.751 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8288936614990234
Epoch: 11, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.763 Vali Acc: 0.220 Test Loss: 1.763 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2174854278564453
Epoch: 1, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.647 Vali Acc: 0.260 Test Loss: 1.647 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.635941743850708
Epoch: 2, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.626 Vali Acc: 0.280 Test Loss: 1.626 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.6778318881988525
Epoch: 3, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.626 Vali Acc: 0.240 Test Loss: 1.626 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.544288158416748
Epoch: 4, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.642 Vali Acc: 0.260 Test Loss: 1.642 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.719883918762207
Epoch: 5, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.654 Vali Acc: 0.240 Test Loss: 1.654 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6558382511138916
Epoch: 6, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.649 Vali Acc: 0.240 Test Loss: 1.649 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8023722171783447
Epoch: 7, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.689 Vali Acc: 0.220 Test Loss: 1.689 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7173051834106445
Epoch: 8, Steps: 4 | Train Loss: 0.593 Vali Loss: 1.786 Vali Acc: 0.240 Test Loss: 1.786 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8612091541290283
Epoch: 9, Steps: 4 | Train Loss: 0.349 Vali Loss: 1.837 Vali Acc: 0.340 Test Loss: 1.837 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339982).  Saving model ...
Epoch: 10 cost time: 1.6702818870544434
Epoch: 10, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.846 Vali Acc: 0.320 Test Loss: 1.846 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.777095079421997
Epoch: 11, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.890 Vali Acc: 0.260 Test Loss: 1.890 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.056792736053467
Epoch: 12, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.978 Vali Acc: 0.280 Test Loss: 1.978 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7745130062103271
Epoch: 13, Steps: 4 | Train Loss: 0.075 Vali Loss: 2.086 Vali Acc: 0.280 Test Loss: 2.086 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8317606449127197
Epoch: 14, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.208 Vali Acc: 0.280 Test Loss: 2.208 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7176868915557861
Epoch: 15, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.279 Vali Acc: 0.280 Test Loss: 2.279 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8358254432678223
Epoch: 16, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.319 Vali Acc: 0.280 Test Loss: 2.319 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7709951400756836
Epoch: 17, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.334 Vali Acc: 0.260 Test Loss: 2.334 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8496463298797607
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.330 Vali Acc: 0.260 Test Loss: 2.330 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8787176609039307
Epoch: 19, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.339 Vali Acc: 0.240 Test Loss: 2.339 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.898970365524292
Epoch: 1, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.639 Vali Acc: 0.140 Test Loss: 1.639 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.9557290077209473
Epoch: 2, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.620 Vali Acc: 0.260 Test Loss: 1.620 Test Acc: 0.260
Validation loss decreased (-0.139984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.9940261840820312
Epoch: 3, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.619 Vali Acc: 0.220 Test Loss: 1.619 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9877209663391113
Epoch: 4, Steps: 4 | Train Loss: 1.250 Vali Loss: 1.635 Vali Acc: 0.280 Test Loss: 1.635 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.7191872596740723
Epoch: 5, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.646 Vali Acc: 0.280 Test Loss: 1.646 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9421920776367188
Epoch: 6, Steps: 4 | Train Loss: 0.790 Vali Loss: 1.628 Vali Acc: 0.240 Test Loss: 1.628 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7294504642486572
Epoch: 7, Steps: 4 | Train Loss: 0.681 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7184817790985107
Epoch: 8, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.708 Vali Acc: 0.220 Test Loss: 1.708 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7056708335876465
Epoch: 9, Steps: 4 | Train Loss: 0.415 Vali Loss: 1.785 Vali Acc: 0.200 Test Loss: 1.785 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9571938514709473
Epoch: 10, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.778 Vali Acc: 0.220 Test Loss: 1.778 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.696274995803833
Epoch: 11, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.782 Vali Acc: 0.180 Test Loss: 1.782 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7941868305206299
Epoch: 12, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.865 Vali Acc: 0.240 Test Loss: 1.865 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8634130954742432
Epoch: 13, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.963 Vali Acc: 0.240 Test Loss: 1.963 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.058134078979492
Epoch: 14, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.056 Vali Acc: 0.240 Test Loss: 2.056 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2297215461730957
Epoch: 1, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.685 Vali Acc: 0.120 Test Loss: 1.685 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.559279441833496
Epoch: 2, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.677 Vali Acc: 0.100 Test Loss: 1.677 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6472299098968506
Epoch: 3, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.676 Vali Acc: 0.100 Test Loss: 1.676 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.608560562133789
Epoch: 4, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.696 Vali Acc: 0.140 Test Loss: 1.696 Test Acc: 0.140
Validation loss decreased (-0.119983 --> -0.139983).  Saving model ...
Epoch: 5 cost time: 1.5914740562438965
Epoch: 5, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.701 Vali Acc: 0.200 Test Loss: 1.701 Test Acc: 0.200
Validation loss decreased (-0.139983 --> -0.199983).  Saving model ...
Epoch: 6 cost time: 1.582322359085083
Epoch: 6, Steps: 4 | Train Loss: 0.887 Vali Loss: 1.663 Vali Acc: 0.220 Test Loss: 1.663 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 7 cost time: 1.5264427661895752
Epoch: 7, Steps: 4 | Train Loss: 0.728 Vali Loss: 1.634 Vali Acc: 0.180 Test Loss: 1.634 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6902287006378174
Epoch: 8, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.658 Vali Acc: 0.200 Test Loss: 1.658 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.646859884262085
Epoch: 9, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.697 Vali Acc: 0.220 Test Loss: 1.697 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6700289249420166
Epoch: 10, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.690 Vali Acc: 0.260 Test Loss: 1.690 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 11 cost time: 1.9065930843353271
Epoch: 11, Steps: 4 | Train Loss: 0.267 Vali Loss: 1.696 Vali Acc: 0.240 Test Loss: 1.696 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7906291484832764
Epoch: 12, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.741 Vali Acc: 0.180 Test Loss: 1.741 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8155522346496582
Epoch: 13, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.817 Vali Acc: 0.220 Test Loss: 1.817 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.834338903427124
Epoch: 14, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.905 Vali Acc: 0.260 Test Loss: 1.905 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9127562046051025
Epoch: 15, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.958 Vali Acc: 0.220 Test Loss: 1.958 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.792398452758789
Epoch: 16, Steps: 4 | Train Loss: 0.045 Vali Loss: 2.008 Vali Acc: 0.260 Test Loss: 2.008 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.955979824066162
Epoch: 17, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.012 Vali Acc: 0.260 Test Loss: 2.012 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8846862316131592
Epoch: 18, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.955 Vali Acc: 0.240 Test Loss: 1.955 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6287972927093506
Epoch: 19, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.934 Vali Acc: 0.240 Test Loss: 1.934 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.732661485671997
Epoch: 20, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.945 Vali Acc: 0.240 Test Loss: 1.945 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3904595375061035
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.692 Vali Acc: 0.160 Test Loss: 1.692 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.9683632850646973
Epoch: 2, Steps: 4 | Train Loss: 1.803 Vali Loss: 1.691 Vali Acc: 0.140 Test Loss: 1.691 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0058512687683105
Epoch: 3, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.698 Vali Acc: 0.160 Test Loss: 1.698 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9234325885772705
Epoch: 4, Steps: 4 | Train Loss: 1.468 Vali Loss: 1.722 Vali Acc: 0.140 Test Loss: 1.722 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.896392583847046
Epoch: 5, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.735 Vali Acc: 0.160 Test Loss: 1.735 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8162264823913574
Epoch: 6, Steps: 4 | Train Loss: 1.227 Vali Loss: 1.709 Vali Acc: 0.160 Test Loss: 1.709 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7617614269256592
Epoch: 7, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.677 Vali Acc: 0.200 Test Loss: 1.677 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 8 cost time: 1.8050456047058105
Epoch: 8, Steps: 4 | Train Loss: 1.104 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 9 cost time: 1.610846757888794
Epoch: 9, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.694 Vali Acc: 0.200 Test Loss: 1.694 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.647414207458496
Epoch: 10, Steps: 4 | Train Loss: 0.849 Vali Loss: 1.726 Vali Acc: 0.180 Test Loss: 1.726 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6567285060882568
Epoch: 11, Steps: 4 | Train Loss: 0.696 Vali Loss: 1.730 Vali Acc: 0.180 Test Loss: 1.730 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6293413639068604
Epoch: 12, Steps: 4 | Train Loss: 0.541 Vali Loss: 1.743 Vali Acc: 0.220 Test Loss: 1.743 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 13 cost time: 1.640249490737915
Epoch: 13, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.742 Vali Acc: 0.180 Test Loss: 1.742 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7022953033447266
Epoch: 14, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.748 Vali Acc: 0.180 Test Loss: 1.748 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.846332311630249
Epoch: 15, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.774 Vali Acc: 0.200 Test Loss: 1.774 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.764509916305542
Epoch: 16, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.816 Vali Acc: 0.200 Test Loss: 1.816 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7969295978546143
Epoch: 17, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.801 Vali Acc: 0.140 Test Loss: 1.801 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9886853694915771
Epoch: 18, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.740 Vali Acc: 0.160 Test Loss: 1.740 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7862272262573242
Epoch: 19, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.757 Vali Acc: 0.160 Test Loss: 1.757 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.764960527420044
Epoch: 20, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.774 Vali Acc: 0.140 Test Loss: 1.774 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7670073509216309
Epoch: 21, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.820 Vali Acc: 0.160 Test Loss: 1.820 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8646483421325684
Epoch: 22, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.833 Vali Acc: 0.180 Test Loss: 1.833 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.404585123062134
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.690 Vali Acc: 0.100 Test Loss: 1.690 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 1.881636381149292
Epoch: 2, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.690 Vali Acc: 0.080 Test Loss: 1.690 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8892841339111328
Epoch: 3, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.704 Vali Acc: 0.080 Test Loss: 1.704 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.053560733795166
Epoch: 4, Steps: 4 | Train Loss: 1.467 Vali Loss: 1.727 Vali Acc: 0.100 Test Loss: 1.727 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9962944984436035
Epoch: 5, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.743 Vali Acc: 0.080 Test Loss: 1.743 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0506412982940674
Epoch: 6, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.718 Vali Acc: 0.120 Test Loss: 1.718 Test Acc: 0.120
Validation loss decreased (-0.099983 --> -0.119983).  Saving model ...
Epoch: 7 cost time: 1.9966504573822021
Epoch: 7, Steps: 4 | Train Loss: 0.949 Vali Loss: 1.689 Vali Acc: 0.180 Test Loss: 1.689 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 8 cost time: 2.102193832397461
Epoch: 8, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.684 Vali Acc: 0.140 Test Loss: 1.684 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9706361293792725
Epoch: 9, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.707 Vali Acc: 0.120 Test Loss: 1.707 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0434281826019287
Epoch: 10, Steps: 4 | Train Loss: 0.709 Vali Loss: 1.732 Vali Acc: 0.120 Test Loss: 1.732 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8537511825561523
Epoch: 11, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.721 Vali Acc: 0.120 Test Loss: 1.721 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8431124687194824
Epoch: 12, Steps: 4 | Train Loss: 0.489 Vali Loss: 1.727 Vali Acc: 0.100 Test Loss: 1.727 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7886962890625
Epoch: 13, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.735 Vali Acc: 0.140 Test Loss: 1.735 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.835634708404541
Epoch: 14, Steps: 4 | Train Loss: 0.339 Vali Loss: 1.746 Vali Acc: 0.060 Test Loss: 1.746 Test Acc: 0.060
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7300968170166016
Epoch: 15, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.761 Vali Acc: 0.080 Test Loss: 1.761 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7347221374511719
Epoch: 16, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.785 Vali Acc: 0.100 Test Loss: 1.785 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6869304180145264
Epoch: 17, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.787 Vali Acc: 0.120 Test Loss: 1.787 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 1298053
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5855298042297363
Epoch: 1, Steps: 4 | Train Loss: 1.838 Vali Loss: 1.746 Vali Acc: 0.160 Test Loss: 1.746 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.7582471370697021
Epoch: 2, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.717 Vali Acc: 0.120 Test Loss: 1.717 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7916114330291748
Epoch: 3, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.708 Vali Acc: 0.200 Test Loss: 1.708 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.7588703632354736
Epoch: 4, Steps: 4 | Train Loss: 1.443 Vali Loss: 1.706 Vali Acc: 0.200 Test Loss: 1.706 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 1.683922290802002
Epoch: 5, Steps: 4 | Train Loss: 1.202 Vali Loss: 1.701 Vali Acc: 0.300 Test Loss: 1.701 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 1.7902648448944092
Epoch: 6, Steps: 4 | Train Loss: 0.963 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 1.7494869232177734
Epoch: 7, Steps: 4 | Train Loss: 0.620 Vali Loss: 1.721 Vali Acc: 0.280 Test Loss: 1.721 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7559161186218262
Epoch: 8, Steps: 4 | Train Loss: 0.533 Vali Loss: 1.764 Vali Acc: 0.280 Test Loss: 1.764 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8298954963684082
Epoch: 9, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.785 Vali Acc: 0.280 Test Loss: 1.785 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0318915843963623
Epoch: 10, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.797 Vali Acc: 0.280 Test Loss: 1.797 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9860363006591797
Epoch: 11, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.826 Vali Acc: 0.260 Test Loss: 1.826 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.032309055328369
Epoch: 12, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.852 Vali Acc: 0.320 Test Loss: 1.852 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319981).  Saving model ...
Epoch: 13 cost time: 2.1553056240081787
Epoch: 13, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.888 Vali Acc: 0.340 Test Loss: 1.888 Test Acc: 0.340
Validation loss decreased (-0.319981 --> -0.339981).  Saving model ...
Epoch: 14 cost time: 2.0001044273376465
Epoch: 14, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.953 Vali Acc: 0.320 Test Loss: 1.953 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9360883235931396
Epoch: 15, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.923 Vali Acc: 0.300 Test Loss: 1.923 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9016411304473877
Epoch: 16, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.939 Vali Acc: 0.340 Test Loss: 1.939 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.883044719696045
Epoch: 17, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.994 Vali Acc: 0.340 Test Loss: 1.994 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8596744537353516
Epoch: 18, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.046 Vali Acc: 0.300 Test Loss: 2.046 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9900004863739014
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.105 Vali Acc: 0.280 Test Loss: 2.105 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.763028621673584
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.149 Vali Acc: 0.300 Test Loss: 2.149 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9823822975158691
Epoch: 21, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.200 Vali Acc: 0.300 Test Loss: 2.200 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0755293369293213
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.274 Vali Acc: 0.300 Test Loss: 2.274 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0020103454589844
Epoch: 23, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.311 Vali Acc: 0.300 Test Loss: 2.311 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4285051822662354
Epoch: 1, Steps: 4 | Train Loss: 1.822 Vali Loss: 1.689 Vali Acc: 0.140 Test Loss: 1.689 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.7853493690490723
Epoch: 2, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.675 Vali Acc: 0.120 Test Loss: 1.675 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9087026119232178
Epoch: 3, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.672 Vali Acc: 0.220 Test Loss: 1.672 Test Acc: 0.220
Validation loss decreased (-0.139983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.969825029373169
Epoch: 4, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.669 Vali Acc: 0.260 Test Loss: 1.669 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.88395094871521
Epoch: 5, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.660 Vali Acc: 0.300 Test Loss: 1.660 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 1.946714162826538
Epoch: 6, Steps: 4 | Train Loss: 0.944 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.8467326164245605
Epoch: 7, Steps: 4 | Train Loss: 0.626 Vali Loss: 1.667 Vali Acc: 0.300 Test Loss: 1.667 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.896376132965088
Epoch: 8, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.712 Vali Acc: 0.280 Test Loss: 1.712 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8455004692077637
Epoch: 9, Steps: 4 | Train Loss: 0.582 Vali Loss: 1.735 Vali Acc: 0.320 Test Loss: 1.735 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 10 cost time: 1.8195538520812988
Epoch: 10, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.741 Vali Acc: 0.320 Test Loss: 1.741 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8483526706695557
Epoch: 11, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.767 Vali Acc: 0.300 Test Loss: 1.767 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.905165672302246
Epoch: 12, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.802 Vali Acc: 0.300 Test Loss: 1.802 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.772627830505371
Epoch: 13, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.828 Vali Acc: 0.320 Test Loss: 1.828 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9085443019866943
Epoch: 14, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.854 Vali Acc: 0.320 Test Loss: 1.854 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7340657711029053
Epoch: 15, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.801 Vali Acc: 0.340 Test Loss: 1.801 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339982).  Saving model ...
Epoch: 16 cost time: 1.9618346691131592
Epoch: 16, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.816 Vali Acc: 0.320 Test Loss: 1.816 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9260358810424805
Epoch: 17, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.873 Vali Acc: 0.320 Test Loss: 1.873 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9645569324493408
Epoch: 18, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.908 Vali Acc: 0.280 Test Loss: 1.908 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0590269565582275
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.970 Vali Acc: 0.320 Test Loss: 1.970 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.000412940979004
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.010 Vali Acc: 0.320 Test Loss: 2.010 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9840199947357178
Epoch: 21, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.054 Vali Acc: 0.300 Test Loss: 2.054 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9576663970947266
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.125 Vali Acc: 0.340 Test Loss: 2.125 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7430408000946045
Epoch: 23, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.152 Vali Acc: 0.340 Test Loss: 2.152 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7590179443359375
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.152 Vali Acc: 0.340 Test Loss: 2.152 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8644981384277344
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.130 Vali Acc: 0.300 Test Loss: 2.130 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4370996952056885
Epoch: 1, Steps: 4 | Train Loss: 1.833 Vali Loss: 1.667 Vali Acc: 0.220 Test Loss: 1.667 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.9353172779083252
Epoch: 2, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.658 Vali Acc: 0.180 Test Loss: 1.658 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8885083198547363
Epoch: 3, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.670 Vali Acc: 0.200 Test Loss: 1.670 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.946437120437622
Epoch: 4, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.679 Vali Acc: 0.260 Test Loss: 1.679 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.9282031059265137
Epoch: 5, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.680 Vali Acc: 0.320 Test Loss: 1.680 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 1.9120497703552246
Epoch: 6, Steps: 4 | Train Loss: 0.922 Vali Loss: 1.666 Vali Acc: 0.340 Test Loss: 1.666 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339983).  Saving model ...
Epoch: 7 cost time: 1.8400328159332275
Epoch: 7, Steps: 4 | Train Loss: 0.601 Vali Loss: 1.698 Vali Acc: 0.320 Test Loss: 1.698 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7215995788574219
Epoch: 8, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.751 Vali Acc: 0.300 Test Loss: 1.751 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6530184745788574
Epoch: 9, Steps: 4 | Train Loss: 0.561 Vali Loss: 1.803 Vali Acc: 0.260 Test Loss: 1.803 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6510097980499268
Epoch: 10, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.831 Vali Acc: 0.300 Test Loss: 1.831 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7469446659088135
Epoch: 11, Steps: 4 | Train Loss: 0.179 Vali Loss: 1.864 Vali Acc: 0.300 Test Loss: 1.864 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5961709022521973
Epoch: 12, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.904 Vali Acc: 0.380 Test Loss: 1.904 Test Acc: 0.380
Validation loss decreased (-0.339983 --> -0.379981).  Saving model ...
Epoch: 13 cost time: 1.6723387241363525
Epoch: 13, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.982 Vali Acc: 0.300 Test Loss: 1.982 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6185076236724854
Epoch: 14, Steps: 4 | Train Loss: 0.065 Vali Loss: 2.049 Vali Acc: 0.320 Test Loss: 2.049 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7603073120117188
Epoch: 15, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.015 Vali Acc: 0.300 Test Loss: 2.015 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8357830047607422
Epoch: 16, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.045 Vali Acc: 0.300 Test Loss: 2.045 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8202273845672607
Epoch: 17, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.111 Vali Acc: 0.300 Test Loss: 2.111 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8869736194610596
Epoch: 18, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.166 Vali Acc: 0.300 Test Loss: 2.166 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7914512157440186
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.249 Vali Acc: 0.320 Test Loss: 2.249 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7555015087127686
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.310 Vali Acc: 0.320 Test Loss: 2.310 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.823127031326294
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.377 Vali Acc: 0.300 Test Loss: 2.377 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.824589729309082
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.461 Vali Acc: 0.300 Test Loss: 2.461 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.292095422744751
Epoch: 1, Steps: 4 | Train Loss: 1.837 Vali Loss: 1.695 Vali Acc: 0.160 Test Loss: 1.695 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.716430425643921
Epoch: 2, Steps: 4 | Train Loss: 1.642 Vali Loss: 1.675 Vali Acc: 0.180 Test Loss: 1.675 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.8776891231536865
Epoch: 3, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.672 Vali Acc: 0.220 Test Loss: 1.672 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.9637434482574463
Epoch: 4, Steps: 4 | Train Loss: 1.378 Vali Loss: 1.682 Vali Acc: 0.260 Test Loss: 1.682 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 2.0508627891540527
Epoch: 5, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.695 Vali Acc: 0.260 Test Loss: 1.695 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8879332542419434
Epoch: 6, Steps: 4 | Train Loss: 0.895 Vali Loss: 1.698 Vali Acc: 0.240 Test Loss: 1.698 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.963257074356079
Epoch: 7, Steps: 4 | Train Loss: 0.567 Vali Loss: 1.734 Vali Acc: 0.320 Test Loss: 1.734 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319983).  Saving model ...
Epoch: 8 cost time: 2.044017791748047
Epoch: 8, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.788 Vali Acc: 0.280 Test Loss: 1.788 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7999889850616455
Epoch: 9, Steps: 4 | Train Loss: 0.529 Vali Loss: 1.841 Vali Acc: 0.280 Test Loss: 1.841 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7352924346923828
Epoch: 10, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.869 Vali Acc: 0.260 Test Loss: 1.869 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6866273880004883
Epoch: 11, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.910 Vali Acc: 0.260 Test Loss: 1.910 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6657593250274658
Epoch: 12, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.948 Vali Acc: 0.300 Test Loss: 1.948 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7108771800994873
Epoch: 13, Steps: 4 | Train Loss: 0.078 Vali Loss: 2.008 Vali Acc: 0.320 Test Loss: 2.008 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7397727966308594
Epoch: 14, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.063 Vali Acc: 0.340 Test Loss: 2.063 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339979).  Saving model ...
Epoch: 15 cost time: 1.6763668060302734
Epoch: 15, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.033 Vali Acc: 0.360 Test Loss: 2.033 Test Acc: 0.360
Validation loss decreased (-0.339979 --> -0.359980).  Saving model ...
Epoch: 16 cost time: 1.6950242519378662
Epoch: 16, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.048 Vali Acc: 0.340 Test Loss: 2.048 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7396087646484375
Epoch: 17, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.085 Vali Acc: 0.260 Test Loss: 2.085 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8750848770141602
Epoch: 18, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.116 Vali Acc: 0.280 Test Loss: 2.116 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8827629089355469
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.184 Vali Acc: 0.280 Test Loss: 2.184 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9375369548797607
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.240 Vali Acc: 0.280 Test Loss: 2.240 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8024919033050537
Epoch: 21, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.302 Vali Acc: 0.280 Test Loss: 2.302 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8206126689910889
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.380 Vali Acc: 0.280 Test Loss: 2.380 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7554421424865723
Epoch: 23, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.416 Vali Acc: 0.280 Test Loss: 2.416 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.662428617477417
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.424 Vali Acc: 0.320 Test Loss: 2.424 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.675898551940918
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.409 Vali Acc: 0.340 Test Loss: 2.409 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.092996835708618
Epoch: 1, Steps: 4 | Train Loss: 1.837 Vali Loss: 1.677 Vali Acc: 0.200 Test Loss: 1.677 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.6755554676055908
Epoch: 2, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.655 Vali Acc: 0.200 Test Loss: 1.655 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.8291683197021484
Epoch: 3, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.639 Vali Acc: 0.160 Test Loss: 1.639 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7209534645080566
Epoch: 4, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.638 Vali Acc: 0.200 Test Loss: 1.638 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 5 cost time: 1.8012077808380127
Epoch: 5, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.645 Vali Acc: 0.220 Test Loss: 1.645 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 6 cost time: 1.643157958984375
Epoch: 6, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.644 Vali Acc: 0.220 Test Loss: 1.644 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 7 cost time: 1.890260934829712
Epoch: 7, Steps: 4 | Train Loss: 0.600 Vali Loss: 1.664 Vali Acc: 0.320 Test Loss: 1.664 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319983).  Saving model ...
Epoch: 8 cost time: 1.7886638641357422
Epoch: 8, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.683 Vali Acc: 0.300 Test Loss: 1.683 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9153034687042236
Epoch: 9, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.723 Vali Acc: 0.280 Test Loss: 1.723 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.750880479812622
Epoch: 10, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.745 Vali Acc: 0.300 Test Loss: 1.745 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6536200046539307
Epoch: 11, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.762 Vali Acc: 0.260 Test Loss: 1.762 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.597576379776001
Epoch: 12, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.764 Vali Acc: 0.220 Test Loss: 1.764 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.824295997619629
Epoch: 13, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.801 Vali Acc: 0.260 Test Loss: 1.801 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6713881492614746
Epoch: 14, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.838 Vali Acc: 0.260 Test Loss: 1.838 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.686105489730835
Epoch: 15, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.829 Vali Acc: 0.260 Test Loss: 1.829 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7179687023162842
Epoch: 16, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.851 Vali Acc: 0.260 Test Loss: 1.851 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6896357536315918
Epoch: 17, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.887 Vali Acc: 0.260 Test Loss: 1.887 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.608642339706421
Epoch: 1, Steps: 4 | Train Loss: 1.878 Vali Loss: 1.682 Vali Acc: 0.300 Test Loss: 1.682 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.7243456840515137
Epoch: 2, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.733682632446289
Epoch: 3, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.648 Vali Acc: 0.260 Test Loss: 1.648 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7022347450256348
Epoch: 4, Steps: 4 | Train Loss: 1.392 Vali Loss: 1.662 Vali Acc: 0.280 Test Loss: 1.662 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8215646743774414
Epoch: 5, Steps: 4 | Train Loss: 1.177 Vali Loss: 1.675 Vali Acc: 0.280 Test Loss: 1.675 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6503961086273193
Epoch: 6, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.675 Vali Acc: 0.320 Test Loss: 1.675 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.57576322555542
Epoch: 7, Steps: 4 | Train Loss: 0.578 Vali Loss: 1.705 Vali Acc: 0.300 Test Loss: 1.705 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5952954292297363
Epoch: 8, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.734 Vali Acc: 0.260 Test Loss: 1.734 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5741891860961914
Epoch: 9, Steps: 4 | Train Loss: 0.514 Vali Loss: 1.792 Vali Acc: 0.240 Test Loss: 1.792 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9732606410980225
Epoch: 10, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.821 Vali Acc: 0.240 Test Loss: 1.821 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9700922966003418
Epoch: 11, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.853 Vali Acc: 0.260 Test Loss: 1.853 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.805342435836792
Epoch: 12, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.896 Vali Acc: 0.300 Test Loss: 1.896 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7108349800109863
Epoch: 13, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.950 Vali Acc: 0.260 Test Loss: 1.950 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8812520503997803
Epoch: 14, Steps: 4 | Train Loss: 0.050 Vali Loss: 2.016 Vali Acc: 0.260 Test Loss: 2.016 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7348017692565918
Epoch: 15, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.030 Vali Acc: 0.300 Test Loss: 2.030 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7537858486175537
Epoch: 16, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.067 Vali Acc: 0.260 Test Loss: 2.067 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.609863042831421
Epoch: 1, Steps: 4 | Train Loss: 1.854 Vali Loss: 1.764 Vali Acc: 0.220 Test Loss: 1.764 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.8321847915649414
Epoch: 2, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.717 Vali Acc: 0.240 Test Loss: 1.717 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.8112554550170898
Epoch: 3, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.669 Vali Acc: 0.220 Test Loss: 1.669 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9811677932739258
Epoch: 4, Steps: 4 | Train Loss: 1.418 Vali Loss: 1.649 Vali Acc: 0.220 Test Loss: 1.649 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0740504264831543
Epoch: 5, Steps: 4 | Train Loss: 1.196 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7929065227508545
Epoch: 6, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.661 Vali Acc: 0.280 Test Loss: 1.661 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 7 cost time: 2.013183116912842
Epoch: 7, Steps: 4 | Train Loss: 0.677 Vali Loss: 1.706 Vali Acc: 0.280 Test Loss: 1.706 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9917080402374268
Epoch: 8, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.751 Vali Acc: 0.260 Test Loss: 1.751 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1431350708007812
Epoch: 9, Steps: 4 | Train Loss: 0.555 Vali Loss: 1.797 Vali Acc: 0.260 Test Loss: 1.797 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0143051147460938
Epoch: 10, Steps: 4 | Train Loss: 0.299 Vali Loss: 1.787 Vali Acc: 0.280 Test Loss: 1.787 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.923295021057129
Epoch: 11, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.773 Vali Acc: 0.280 Test Loss: 1.773 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7852063179016113
Epoch: 12, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.803 Vali Acc: 0.360 Test Loss: 1.803 Test Acc: 0.360
Validation loss decreased (-0.279983 --> -0.359982).  Saving model ...
Epoch: 13 cost time: 1.8568565845489502
Epoch: 13, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.871 Vali Acc: 0.340 Test Loss: 1.871 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8543686866760254
Epoch: 14, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.935 Vali Acc: 0.300 Test Loss: 1.935 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8235416412353516
Epoch: 15, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.918 Vali Acc: 0.300 Test Loss: 1.918 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8813433647155762
Epoch: 16, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.947 Vali Acc: 0.300 Test Loss: 1.947 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.853872537612915
Epoch: 17, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.996 Vali Acc: 0.300 Test Loss: 1.996 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.987905502319336
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.029 Vali Acc: 0.320 Test Loss: 2.029 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.977888584136963
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.082 Vali Acc: 0.340 Test Loss: 2.082 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0586960315704346
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.123 Vali Acc: 0.320 Test Loss: 2.123 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0966875553131104
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.177 Vali Acc: 0.300 Test Loss: 2.177 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.061910629272461
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.263 Vali Acc: 0.300 Test Loss: 2.263 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3363749980926514
Epoch: 1, Steps: 4 | Train Loss: 1.766 Vali Loss: 1.691 Vali Acc: 0.220 Test Loss: 1.691 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.6207859516143799
Epoch: 2, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.670 Vali Acc: 0.220 Test Loss: 1.670 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.6844782829284668
Epoch: 3, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.642 Vali Acc: 0.180 Test Loss: 1.642 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6632003784179688
Epoch: 4, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.631 Vali Acc: 0.140 Test Loss: 1.631 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6929130554199219
Epoch: 5, Steps: 4 | Train Loss: 1.192 Vali Loss: 1.632 Vali Acc: 0.120 Test Loss: 1.632 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8273911476135254
Epoch: 6, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.631 Vali Acc: 0.140 Test Loss: 1.631 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8935356140136719
Epoch: 7, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.643 Vali Acc: 0.240 Test Loss: 1.643 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 8 cost time: 1.8415236473083496
Epoch: 8, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.658 Vali Acc: 0.280 Test Loss: 1.658 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 9 cost time: 1.8153011798858643
Epoch: 9, Steps: 4 | Train Loss: 0.635 Vali Loss: 1.699 Vali Acc: 0.240 Test Loss: 1.699 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9054336547851562
Epoch: 10, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.707 Vali Acc: 0.300 Test Loss: 1.707 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 11 cost time: 1.9908931255340576
Epoch: 11, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.677 Vali Acc: 0.300 Test Loss: 1.677 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 12 cost time: 1.7753939628601074
Epoch: 12, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.661 Vali Acc: 0.320 Test Loss: 1.661 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 13 cost time: 1.8664190769195557
Epoch: 13, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.695 Vali Acc: 0.280 Test Loss: 1.695 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6323704719543457
Epoch: 14, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.762 Vali Acc: 0.240 Test Loss: 1.762 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6257150173187256
Epoch: 15, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.782 Vali Acc: 0.260 Test Loss: 1.782 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8099324703216553
Epoch: 16, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.826 Vali Acc: 0.240 Test Loss: 1.826 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6035761833190918
Epoch: 17, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.865 Vali Acc: 0.220 Test Loss: 1.865 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8573276996612549
Epoch: 18, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.862 Vali Acc: 0.220 Test Loss: 1.862 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7531437873840332
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.896 Vali Acc: 0.220 Test Loss: 1.896 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8237106800079346
Epoch: 20, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.921 Vali Acc: 0.220 Test Loss: 1.921 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.057516574859619
Epoch: 21, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.967 Vali Acc: 0.240 Test Loss: 1.967 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.924516201019287
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.059 Vali Acc: 0.220 Test Loss: 2.059 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.30082368850708
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.682 Vali Acc: 0.120 Test Loss: 1.682 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.708456039428711
Epoch: 2, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.685 Vali Acc: 0.120 Test Loss: 1.685 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7364387512207031
Epoch: 3, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.691 Vali Acc: 0.120 Test Loss: 1.691 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6521430015563965
Epoch: 4, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.707 Vali Acc: 0.160 Test Loss: 1.707 Test Acc: 0.160
Validation loss decreased (-0.119983 --> -0.159983).  Saving model ...
Epoch: 5 cost time: 1.7718918323516846
Epoch: 5, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.721 Vali Acc: 0.180 Test Loss: 1.721 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 6 cost time: 1.6586766242980957
Epoch: 6, Steps: 4 | Train Loss: 1.328 Vali Loss: 1.716 Vali Acc: 0.180 Test Loss: 1.716 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179983).  Saving model ...
Epoch: 7 cost time: 1.71608304977417
Epoch: 7, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179983).  Saving model ...
Epoch: 8 cost time: 1.6604440212249756
Epoch: 8, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.671 Vali Acc: 0.120 Test Loss: 1.671 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3412060737609863
Epoch: 9, Steps: 4 | Train Loss: 0.995 Vali Loss: 1.663 Vali Acc: 0.140 Test Loss: 1.663 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9803156852722168
Epoch: 10, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.697 Vali Acc: 0.120 Test Loss: 1.697 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8775479793548584
Epoch: 11, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.700 Vali Acc: 0.120 Test Loss: 1.700 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.802833080291748
Epoch: 12, Steps: 4 | Train Loss: 0.597 Vali Loss: 1.689 Vali Acc: 0.120 Test Loss: 1.689 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8375277519226074
Epoch: 13, Steps: 4 | Train Loss: 0.530 Vali Loss: 1.685 Vali Acc: 0.200 Test Loss: 1.685 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 14 cost time: 1.7502384185791016
Epoch: 14, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.688 Vali Acc: 0.160 Test Loss: 1.688 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.836437463760376
Epoch: 15, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.692 Vali Acc: 0.140 Test Loss: 1.692 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6125404834747314
Epoch: 16, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.717 Vali Acc: 0.140 Test Loss: 1.717 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5978212356567383
Epoch: 17, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.691 Vali Acc: 0.160 Test Loss: 1.691 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6005938053131104
Epoch: 18, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.691 Vali Acc: 0.160 Test Loss: 1.691 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6906116008758545
Epoch: 19, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.692 Vali Acc: 0.220 Test Loss: 1.692 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 20 cost time: 1.612034797668457
Epoch: 20, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.728 Vali Acc: 0.180 Test Loss: 1.728 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7027502059936523
Epoch: 21, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.723 Vali Acc: 0.160 Test Loss: 1.723 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7948682308197021
Epoch: 22, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.745 Vali Acc: 0.200 Test Loss: 1.745 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5283784866333008
Epoch: 23, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.771 Vali Acc: 0.220 Test Loss: 1.771 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6655209064483643
Epoch: 24, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.704 Vali Acc: 0.200 Test Loss: 1.704 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8830609321594238
Epoch: 25, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.660 Vali Acc: 0.160 Test Loss: 1.660 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.729193925857544
Epoch: 26, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8911080360412598
Epoch: 27, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.707 Vali Acc: 0.140 Test Loss: 1.707 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7148747444152832
Epoch: 28, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.747 Vali Acc: 0.160 Test Loss: 1.747 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7808122634887695
Epoch: 29, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.758 Vali Acc: 0.220 Test Loss: 1.758 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5413177013397217
Epoch: 1, Steps: 4 | Train Loss: 1.766 Vali Loss: 1.586 Vali Acc: 0.160 Test Loss: 1.586 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.8509018421173096
Epoch: 2, Steps: 4 | Train Loss: 1.793 Vali Loss: 1.587 Vali Acc: 0.180 Test Loss: 1.587 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.9254841804504395
Epoch: 3, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.595 Vali Acc: 0.120 Test Loss: 1.595 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8779735565185547
Epoch: 4, Steps: 4 | Train Loss: 1.443 Vali Loss: 1.615 Vali Acc: 0.160 Test Loss: 1.615 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.947676181793213
Epoch: 5, Steps: 4 | Train Loss: 1.475 Vali Loss: 1.630 Vali Acc: 0.180 Test Loss: 1.630 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2398698329925537
Epoch: 6, Steps: 4 | Train Loss: 1.197 Vali Loss: 1.628 Vali Acc: 0.200 Test Loss: 1.628 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 7 cost time: 2.0321733951568604
Epoch: 7, Steps: 4 | Train Loss: 1.021 Vali Loss: 1.621 Vali Acc: 0.160 Test Loss: 1.621 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1412909030914307
Epoch: 8, Steps: 4 | Train Loss: 0.902 Vali Loss: 1.603 Vali Acc: 0.180 Test Loss: 1.603 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0089244842529297
Epoch: 9, Steps: 4 | Train Loss: 0.958 Vali Loss: 1.605 Vali Acc: 0.160 Test Loss: 1.605 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9780497550964355
Epoch: 10, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.637 Vali Acc: 0.120 Test Loss: 1.637 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0611438751220703
Epoch: 11, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.641 Vali Acc: 0.140 Test Loss: 1.641 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.908205509185791
Epoch: 12, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.636 Vali Acc: 0.140 Test Loss: 1.636 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.835623025894165
Epoch: 13, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.631 Vali Acc: 0.200 Test Loss: 1.631 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7888286113739014
Epoch: 14, Steps: 4 | Train Loss: 0.372 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 15 cost time: 2.0153884887695312
Epoch: 15, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.602 Vali Acc: 0.220 Test Loss: 1.602 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7821614742279053
Epoch: 16, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.601 Vali Acc: 0.200 Test Loss: 1.601 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6944060325622559
Epoch: 17, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.598 Vali Acc: 0.180 Test Loss: 1.598 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6956496238708496
Epoch: 18, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.605 Vali Acc: 0.180 Test Loss: 1.605 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8066163063049316
Epoch: 19, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.642 Vali Acc: 0.200 Test Loss: 1.642 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0029056072235107
Epoch: 20, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.687 Vali Acc: 0.200 Test Loss: 1.687 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.037684679031372
Epoch: 21, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.700 Vali Acc: 0.180 Test Loss: 1.700 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1223196983337402
Epoch: 22, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.721 Vali Acc: 0.200 Test Loss: 1.721 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8130302429199219
Epoch: 23, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8984692096710205
Epoch: 24, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.691 Vali Acc: 0.220 Test Loss: 1.691 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 904837
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.306203603744507
Epoch: 1, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.609 Vali Acc: 0.220 Test Loss: 1.609 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.7491497993469238
Epoch: 2, Steps: 4 | Train Loss: 1.756 Vali Loss: 1.575 Vali Acc: 0.240 Test Loss: 1.575 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.8628740310668945
Epoch: 3, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.558 Vali Acc: 0.260 Test Loss: 1.558 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 2.0049450397491455
Epoch: 4, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.555 Vali Acc: 0.320 Test Loss: 1.555 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.8307335376739502
Epoch: 5, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.567 Vali Acc: 0.360 Test Loss: 1.567 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 6 cost time: 1.8404512405395508
Epoch: 6, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.570 Vali Acc: 0.380 Test Loss: 1.570 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 7 cost time: 1.9501914978027344
Epoch: 7, Steps: 4 | Train Loss: 0.662 Vali Loss: 1.571 Vali Acc: 0.360 Test Loss: 1.571 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1103947162628174
Epoch: 8, Steps: 4 | Train Loss: 0.480 Vali Loss: 1.613 Vali Acc: 0.320 Test Loss: 1.613 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8277556896209717
Epoch: 9, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.636 Vali Acc: 0.300 Test Loss: 1.636 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.846548080444336
Epoch: 10, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.658 Vali Acc: 0.280 Test Loss: 1.658 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.789208173751831
Epoch: 11, Steps: 4 | Train Loss: 0.371 Vali Loss: 1.704 Vali Acc: 0.280 Test Loss: 1.704 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7156989574432373
Epoch: 12, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.696 Vali Acc: 0.360 Test Loss: 1.696 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8351049423217773
Epoch: 13, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.759 Vali Acc: 0.320 Test Loss: 1.759 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9677832126617432
Epoch: 14, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.824 Vali Acc: 0.300 Test Loss: 1.824 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0362699031829834
Epoch: 15, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.801 Vali Acc: 0.320 Test Loss: 1.801 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.026125431060791
Epoch: 16, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.739 Vali Acc: 0.320 Test Loss: 1.739 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1698195934295654
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.613 Vali Acc: 0.200 Test Loss: 1.613 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.6920912265777588
Epoch: 2, Steps: 4 | Train Loss: 1.756 Vali Loss: 1.580 Vali Acc: 0.220 Test Loss: 1.580 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.7536594867706299
Epoch: 3, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.560 Vali Acc: 0.300 Test Loss: 1.560 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.7655062675476074
Epoch: 4, Steps: 4 | Train Loss: 1.419 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.8524603843688965
Epoch: 5, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.569 Vali Acc: 0.340 Test Loss: 1.569 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.6539320945739746
Epoch: 6, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.573 Vali Acc: 0.340 Test Loss: 1.573 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6683785915374756
Epoch: 7, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.574 Vali Acc: 0.360 Test Loss: 1.574 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 8 cost time: 1.905651569366455
Epoch: 8, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.617 Vali Acc: 0.280 Test Loss: 1.617 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0046803951263428
Epoch: 9, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.641 Vali Acc: 0.280 Test Loss: 1.641 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8183538913726807
Epoch: 10, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.663 Vali Acc: 0.300 Test Loss: 1.663 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9391953945159912
Epoch: 11, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.712 Vali Acc: 0.300 Test Loss: 1.712 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8070969581604004
Epoch: 12, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.713 Vali Acc: 0.380 Test Loss: 1.713 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379983).  Saving model ...
Epoch: 13 cost time: 1.9159791469573975
Epoch: 13, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.778 Vali Acc: 0.300 Test Loss: 1.778 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8174846172332764
Epoch: 14, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.827 Vali Acc: 0.280 Test Loss: 1.827 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9621343612670898
Epoch: 15, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.780 Vali Acc: 0.320 Test Loss: 1.780 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7965583801269531
Epoch: 16, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.726 Vali Acc: 0.260 Test Loss: 1.726 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6530396938323975
Epoch: 17, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.789 Vali Acc: 0.260 Test Loss: 1.789 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.710494041442871
Epoch: 18, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.936 Vali Acc: 0.280 Test Loss: 1.936 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8443362712860107
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.092 Vali Acc: 0.260 Test Loss: 2.092 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7903251647949219
Epoch: 20, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.164 Vali Acc: 0.280 Test Loss: 2.164 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9514904022216797
Epoch: 21, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.148 Vali Acc: 0.260 Test Loss: 2.148 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6556832790374756
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.073 Vali Acc: 0.260 Test Loss: 2.073 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5454041957855225
Epoch: 1, Steps: 4 | Train Loss: 1.634 Vali Loss: 1.638 Vali Acc: 0.200 Test Loss: 1.638 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.9438626766204834
Epoch: 2, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.606 Vali Acc: 0.280 Test Loss: 1.606 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.0795557498931885
Epoch: 3, Steps: 4 | Train Loss: 1.432 Vali Loss: 1.585 Vali Acc: 0.260 Test Loss: 1.585 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.934567928314209
Epoch: 4, Steps: 4 | Train Loss: 1.363 Vali Loss: 1.585 Vali Acc: 0.280 Test Loss: 1.585 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.9681451320648193
Epoch: 5, Steps: 4 | Train Loss: 1.248 Vali Loss: 1.613 Vali Acc: 0.300 Test Loss: 1.613 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.7791767120361328
Epoch: 6, Steps: 4 | Train Loss: 0.803 Vali Loss: 1.633 Vali Acc: 0.320 Test Loss: 1.633 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 1.866076946258545
Epoch: 7, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.648 Vali Acc: 0.320 Test Loss: 1.648 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8544652462005615
Epoch: 8, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.700 Vali Acc: 0.300 Test Loss: 1.700 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9758028984069824
Epoch: 9, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8944244384765625
Epoch: 10, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.772 Vali Acc: 0.300 Test Loss: 1.772 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.28356671333313
Epoch: 11, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.855 Vali Acc: 0.260 Test Loss: 1.855 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3545281887054443
Epoch: 12, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.898 Vali Acc: 0.280 Test Loss: 1.898 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0229382514953613
Epoch: 13, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.999 Vali Acc: 0.260 Test Loss: 1.999 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0856637954711914
Epoch: 14, Steps: 4 | Train Loss: 0.088 Vali Loss: 2.055 Vali Acc: 0.260 Test Loss: 2.055 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0120601654052734
Epoch: 15, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.012 Vali Acc: 0.240 Test Loss: 2.012 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9643218517303467
Epoch: 16, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.994 Vali Acc: 0.300 Test Loss: 1.994 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5249223709106445
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.672 Vali Acc: 0.240 Test Loss: 1.672 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.7847137451171875
Epoch: 2, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.8264029026031494
Epoch: 3, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.626 Vali Acc: 0.300 Test Loss: 1.626 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 2.0047426223754883
Epoch: 4, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.627 Vali Acc: 0.280 Test Loss: 1.627 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7844884395599365
Epoch: 5, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.651 Vali Acc: 0.300 Test Loss: 1.651 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9962069988250732
Epoch: 6, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.667 Vali Acc: 0.320 Test Loss: 1.667 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.8248889446258545
Epoch: 7, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.680 Vali Acc: 0.320 Test Loss: 1.680 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9013316631317139
Epoch: 8, Steps: 4 | Train Loss: 0.452 Vali Loss: 1.732 Vali Acc: 0.300 Test Loss: 1.732 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0933375358581543
Epoch: 9, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.761 Vali Acc: 0.300 Test Loss: 1.761 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9735560417175293
Epoch: 10, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.797 Vali Acc: 0.300 Test Loss: 1.797 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7866969108581543
Epoch: 11, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.857 Vali Acc: 0.280 Test Loss: 1.857 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0554282665252686
Epoch: 12, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.877 Vali Acc: 0.300 Test Loss: 1.877 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8744728565216064
Epoch: 13, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.980 Vali Acc: 0.300 Test Loss: 1.980 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8512868881225586
Epoch: 14, Steps: 4 | Train Loss: 0.072 Vali Loss: 2.065 Vali Acc: 0.300 Test Loss: 2.065 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8801558017730713
Epoch: 15, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.074 Vali Acc: 0.300 Test Loss: 2.074 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8948228359222412
Epoch: 16, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.009 Vali Acc: 0.320 Test Loss: 2.009 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6979925632476807
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.713 Vali Acc: 0.200 Test Loss: 1.713 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.8803000450134277
Epoch: 2, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.671 Vali Acc: 0.260 Test Loss: 1.671 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 2.0306413173675537
Epoch: 3, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.724146842956543
Epoch: 4, Steps: 4 | Train Loss: 1.366 Vali Loss: 1.621 Vali Acc: 0.260 Test Loss: 1.621 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.890289306640625
Epoch: 5, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.641 Vali Acc: 0.280 Test Loss: 1.641 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.8073351383209229
Epoch: 6, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.656 Vali Acc: 0.300 Test Loss: 1.656 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 1.7479877471923828
Epoch: 7, Steps: 4 | Train Loss: 0.688 Vali Loss: 1.671 Vali Acc: 0.280 Test Loss: 1.671 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8166272640228271
Epoch: 8, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.723 Vali Acc: 0.260 Test Loss: 1.723 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9216833114624023
Epoch: 9, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.761 Vali Acc: 0.220 Test Loss: 1.761 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7628514766693115
Epoch: 10, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.803 Vali Acc: 0.220 Test Loss: 1.803 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6747829914093018
Epoch: 11, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.853 Vali Acc: 0.200 Test Loss: 1.853 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8981084823608398
Epoch: 12, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.857 Vali Acc: 0.200 Test Loss: 1.857 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8495454788208008
Epoch: 13, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.948 Vali Acc: 0.220 Test Loss: 1.948 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8179004192352295
Epoch: 14, Steps: 4 | Train Loss: 0.087 Vali Loss: 2.025 Vali Acc: 0.200 Test Loss: 2.025 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8897526264190674
Epoch: 15, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.955 Vali Acc: 0.240 Test Loss: 1.955 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9237167835235596
Epoch: 16, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.854 Vali Acc: 0.220 Test Loss: 1.854 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2594361305236816
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.689 Vali Acc: 0.160 Test Loss: 1.689 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.541327714920044
Epoch: 2, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.654 Vali Acc: 0.240 Test Loss: 1.654 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.6726515293121338
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.865809440612793
Epoch: 4, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.619 Vali Acc: 0.280 Test Loss: 1.619 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.8432190418243408
Epoch: 5, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.641 Vali Acc: 0.280 Test Loss: 1.641 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8608267307281494
Epoch: 6, Steps: 4 | Train Loss: 0.806 Vali Loss: 1.663 Vali Acc: 0.300 Test Loss: 1.663 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 1.9683301448822021
Epoch: 7, Steps: 4 | Train Loss: 0.633 Vali Loss: 1.680 Vali Acc: 0.220 Test Loss: 1.680 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.060150384902954
Epoch: 8, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.727 Vali Acc: 0.220 Test Loss: 1.727 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0221691131591797
Epoch: 9, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.761 Vali Acc: 0.240 Test Loss: 1.761 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.589606761932373
Epoch: 10, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.821 Vali Acc: 0.240 Test Loss: 1.821 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8482091426849365
Epoch: 11, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.888 Vali Acc: 0.240 Test Loss: 1.888 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1356935501098633
Epoch: 12, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.890 Vali Acc: 0.220 Test Loss: 1.890 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7550411224365234
Epoch: 13, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.964 Vali Acc: 0.260 Test Loss: 1.964 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8568825721740723
Epoch: 14, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.045 Vali Acc: 0.300 Test Loss: 2.045 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0059776306152344
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.047 Vali Acc: 0.260 Test Loss: 2.047 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8169527053833008
Epoch: 16, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.002 Vali Acc: 0.240 Test Loss: 2.002 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.100774526596069
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.2442259788513184
Epoch: 2, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.701 Vali Acc: 0.220 Test Loss: 1.701 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 2.095836639404297
Epoch: 3, Steps: 4 | Train Loss: 1.512 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 2.1983611583709717
Epoch: 4, Steps: 4 | Train Loss: 1.318 Vali Loss: 1.650 Vali Acc: 0.260 Test Loss: 1.650 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 2.0294206142425537
Epoch: 5, Steps: 4 | Train Loss: 1.225 Vali Loss: 1.658 Vali Acc: 0.260 Test Loss: 1.658 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0909624099731445
Epoch: 6, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.661 Vali Acc: 0.260 Test Loss: 1.661 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.188641309738159
Epoch: 7, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.669 Vali Acc: 0.240 Test Loss: 1.669 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.25722336769104
Epoch: 8, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.707 Vali Acc: 0.260 Test Loss: 1.707 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.041449785232544
Epoch: 9, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.744 Vali Acc: 0.220 Test Loss: 1.744 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0719552040100098
Epoch: 10, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.787 Vali Acc: 0.220 Test Loss: 1.787 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0261337757110596
Epoch: 11, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.811 Vali Acc: 0.200 Test Loss: 1.811 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.373164653778076
Epoch: 12, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0358381271362305
Epoch: 13, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.867 Vali Acc: 0.240 Test Loss: 1.867 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1617183685302734
Epoch: 14, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.953 Vali Acc: 0.240 Test Loss: 1.953 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.967273712158203
Epoch: 1, Steps: 4 | Train Loss: 1.693 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.2539727687835693
Epoch: 2, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.705 Vali Acc: 0.260 Test Loss: 1.705 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.9262897968292236
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.679 Vali Acc: 0.300 Test Loss: 1.679 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.110819101333618
Epoch: 4, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.664 Vali Acc: 0.280 Test Loss: 1.664 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.32010817527771
Epoch: 5, Steps: 4 | Train Loss: 1.168 Vali Loss: 1.671 Vali Acc: 0.260 Test Loss: 1.671 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0544919967651367
Epoch: 6, Steps: 4 | Train Loss: 0.914 Vali Loss: 1.669 Vali Acc: 0.260 Test Loss: 1.669 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.776564359664917
Epoch: 7, Steps: 4 | Train Loss: 0.770 Vali Loss: 1.664 Vali Acc: 0.280 Test Loss: 1.664 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9420678615570068
Epoch: 8, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.677 Vali Acc: 0.280 Test Loss: 1.677 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8984007835388184
Epoch: 9, Steps: 4 | Train Loss: 0.512 Vali Loss: 1.681 Vali Acc: 0.300 Test Loss: 1.681 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.03745436668396
Epoch: 10, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.709 Vali Acc: 0.280 Test Loss: 1.709 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.909778118133545
Epoch: 11, Steps: 4 | Train Loss: 0.365 Vali Loss: 1.739 Vali Acc: 0.260 Test Loss: 1.739 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9410312175750732
Epoch: 12, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.760 Vali Acc: 0.300 Test Loss: 1.760 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.915271520614624
Epoch: 13, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.802 Vali Acc: 0.300 Test Loss: 1.802 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.706587076187134
Epoch: 1, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.766 Vali Acc: 0.160 Test Loss: 1.766 Test Acc: 0.160
Validation loss decreased (inf --> -0.159982).  Saving model ...
Epoch: 2 cost time: 1.9723114967346191
Epoch: 2, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.751 Vali Acc: 0.160 Test Loss: 1.751 Test Acc: 0.160
Validation loss decreased (-0.159982 --> -0.159982).  Saving model ...
Epoch: 3 cost time: 2.204979419708252
Epoch: 3, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.735 Vali Acc: 0.220 Test Loss: 1.735 Test Acc: 0.220
Validation loss decreased (-0.159982 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.9480996131896973
Epoch: 4, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.729 Vali Acc: 0.220 Test Loss: 1.729 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 1.9042911529541016
Epoch: 5, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.731 Vali Acc: 0.240 Test Loss: 1.731 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 2.0000202655792236
Epoch: 6, Steps: 4 | Train Loss: 1.306 Vali Loss: 1.729 Vali Acc: 0.260 Test Loss: 1.729 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 2.0462565422058105
Epoch: 7, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.723 Vali Acc: 0.280 Test Loss: 1.723 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 8 cost time: 1.938450813293457
Epoch: 8, Steps: 4 | Train Loss: 0.887 Vali Loss: 1.729 Vali Acc: 0.260 Test Loss: 1.729 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8122262954711914
Epoch: 9, Steps: 4 | Train Loss: 0.881 Vali Loss: 1.715 Vali Acc: 0.220 Test Loss: 1.715 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8960034847259521
Epoch: 10, Steps: 4 | Train Loss: 0.685 Vali Loss: 1.732 Vali Acc: 0.220 Test Loss: 1.732 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9509479999542236
Epoch: 11, Steps: 4 | Train Loss: 0.811 Vali Loss: 1.739 Vali Acc: 0.200 Test Loss: 1.739 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7908945083618164
Epoch: 12, Steps: 4 | Train Loss: 0.568 Vali Loss: 1.761 Vali Acc: 0.280 Test Loss: 1.761 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9639956951141357
Epoch: 13, Steps: 4 | Train Loss: 0.464 Vali Loss: 1.763 Vali Acc: 0.200 Test Loss: 1.763 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.807723045349121
Epoch: 14, Steps: 4 | Train Loss: 0.517 Vali Loss: 1.733 Vali Acc: 0.240 Test Loss: 1.733 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.921191930770874
Epoch: 15, Steps: 4 | Train Loss: 0.512 Vali Loss: 1.714 Vali Acc: 0.180 Test Loss: 1.714 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1381783485412598
Epoch: 16, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.708 Vali Acc: 0.220 Test Loss: 1.708 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9391543865203857
Epoch: 17, Steps: 4 | Train Loss: 0.362 Vali Loss: 1.718 Vali Acc: 0.200 Test Loss: 1.718 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4080348014831543
Epoch: 1, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.677 Vali Acc: 0.160 Test Loss: 1.677 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.9644036293029785
Epoch: 2, Steps: 4 | Train Loss: 1.782 Vali Loss: 1.665 Vali Acc: 0.160 Test Loss: 1.665 Test Acc: 0.160
Validation loss decreased (-0.159983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.7385711669921875
Epoch: 3, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.653 Vali Acc: 0.140 Test Loss: 1.653 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.003314971923828
Epoch: 4, Steps: 4 | Train Loss: 1.435 Vali Loss: 1.648 Vali Acc: 0.140 Test Loss: 1.648 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6419050693511963
Epoch: 5, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.650 Vali Acc: 0.160 Test Loss: 1.650 Test Acc: 0.160
Validation loss decreased (-0.159983 --> -0.159984).  Saving model ...
Epoch: 6 cost time: 1.7653474807739258
Epoch: 6, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.652 Vali Acc: 0.140 Test Loss: 1.652 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6700010299682617
Epoch: 7, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.653 Vali Acc: 0.160 Test Loss: 1.653 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7246081829071045
Epoch: 8, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.655 Vali Acc: 0.160 Test Loss: 1.655 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6574108600616455
Epoch: 9, Steps: 4 | Train Loss: 0.876 Vali Loss: 1.637 Vali Acc: 0.160 Test Loss: 1.637 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 10 cost time: 1.6664340496063232
Epoch: 10, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.643 Vali Acc: 0.180 Test Loss: 1.643 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 11 cost time: 1.7598049640655518
Epoch: 11, Steps: 4 | Train Loss: 0.767 Vali Loss: 1.654 Vali Acc: 0.200 Test Loss: 1.654 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199983).  Saving model ...
Epoch: 12 cost time: 1.7010736465454102
Epoch: 12, Steps: 4 | Train Loss: 0.557 Vali Loss: 1.680 Vali Acc: 0.180 Test Loss: 1.680 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7301833629608154
Epoch: 13, Steps: 4 | Train Loss: 0.400 Vali Loss: 1.685 Vali Acc: 0.160 Test Loss: 1.685 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.737966775894165
Epoch: 14, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.655 Vali Acc: 0.120 Test Loss: 1.655 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6977550983428955
Epoch: 15, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.649 Vali Acc: 0.180 Test Loss: 1.649 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8957056999206543
Epoch: 16, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.650 Vali Acc: 0.180 Test Loss: 1.650 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8276760578155518
Epoch: 17, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7702488899230957
Epoch: 18, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.643 Vali Acc: 0.120 Test Loss: 1.643 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6812975406646729
Epoch: 19, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.653 Vali Acc: 0.180 Test Loss: 1.653 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6892857551574707
Epoch: 20, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.679 Vali Acc: 0.260 Test Loss: 1.679 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 21 cost time: 1.7119214534759521
Epoch: 21, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.666 Vali Acc: 0.260 Test Loss: 1.666 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 22 cost time: 1.831911325454712
Epoch: 22, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8262205123901367
Epoch: 23, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.688 Vali Acc: 0.200 Test Loss: 1.688 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8411641120910645
Epoch: 24, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.712 Vali Acc: 0.240 Test Loss: 1.712 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.775541067123413
Epoch: 25, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.737 Vali Acc: 0.180 Test Loss: 1.737 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.890230417251587
Epoch: 26, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.745 Vali Acc: 0.200 Test Loss: 1.745 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8390612602233887
Epoch: 27, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.756 Vali Acc: 0.220 Test Loss: 1.756 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8737046718597412
Epoch: 28, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.747 Vali Acc: 0.220 Test Loss: 1.747 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.856086015701294
Epoch: 29, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.736 Vali Acc: 0.240 Test Loss: 1.736 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8641934394836426
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.736 Vali Acc: 0.220 Test Loss: 1.736 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.787682056427002
Epoch: 31, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 708229
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7212393283843994
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.3139054775238037
Epoch: 2, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.577 Vali Acc: 0.200 Test Loss: 1.577 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.053520917892456
Epoch: 3, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.553 Vali Acc: 0.240 Test Loss: 1.553 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.930048942565918
Epoch: 4, Steps: 4 | Train Loss: 1.210 Vali Loss: 1.552 Vali Acc: 0.280 Test Loss: 1.552 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.8342959880828857
Epoch: 5, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.567 Vali Acc: 0.300 Test Loss: 1.567 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.7209620475769043
Epoch: 6, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.614 Vali Acc: 0.300 Test Loss: 1.614 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9354290962219238
Epoch: 7, Steps: 4 | Train Loss: 0.680 Vali Loss: 1.652 Vali Acc: 0.300 Test Loss: 1.652 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.871161937713623
Epoch: 8, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.686 Vali Acc: 0.300 Test Loss: 1.686 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8569092750549316
Epoch: 9, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.682 Vali Acc: 0.340 Test Loss: 1.682 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339983).  Saving model ...
Epoch: 10 cost time: 1.8978657722473145
Epoch: 10, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.702 Vali Acc: 0.320 Test Loss: 1.702 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.038745641708374
Epoch: 11, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.749 Vali Acc: 0.280 Test Loss: 1.749 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7292876243591309
Epoch: 12, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.809 Vali Acc: 0.320 Test Loss: 1.809 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.851449728012085
Epoch: 13, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.791 Vali Acc: 0.280 Test Loss: 1.791 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7997820377349854
Epoch: 14, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.834 Vali Acc: 0.260 Test Loss: 1.834 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6906497478485107
Epoch: 15, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.904 Vali Acc: 0.280 Test Loss: 1.904 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8343174457550049
Epoch: 16, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.963 Vali Acc: 0.300 Test Loss: 1.963 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.973071813583374
Epoch: 17, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.952 Vali Acc: 0.280 Test Loss: 1.952 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.825441837310791
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.939 Vali Acc: 0.280 Test Loss: 1.939 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8882386684417725
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.973 Vali Acc: 0.260 Test Loss: 1.973 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7020790576934814
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.624 Vali Acc: 0.280 Test Loss: 1.624 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 2.0595078468322754
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.577 Vali Acc: 0.280 Test Loss: 1.577 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.013287305831909
Epoch: 3, Steps: 4 | Train Loss: 1.440 Vali Loss: 1.558 Vali Acc: 0.240 Test Loss: 1.558 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1652536392211914
Epoch: 4, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.561 Vali Acc: 0.280 Test Loss: 1.561 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 2.268001079559326
Epoch: 5, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 2.030064582824707
Epoch: 6, Steps: 4 | Train Loss: 0.777 Vali Loss: 1.637 Vali Acc: 0.320 Test Loss: 1.637 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 2.1693336963653564
Epoch: 7, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.677 Vali Acc: 0.320 Test Loss: 1.677 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.078511953353882
Epoch: 8, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.707 Vali Acc: 0.280 Test Loss: 1.707 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.28001070022583
Epoch: 9, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.692 Vali Acc: 0.280 Test Loss: 1.692 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1290457248687744
Epoch: 10, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.704 Vali Acc: 0.300 Test Loss: 1.704 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9827001094818115
Epoch: 11, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.749 Vali Acc: 0.300 Test Loss: 1.749 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.071166515350342
Epoch: 12, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.815 Vali Acc: 0.300 Test Loss: 1.815 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2130095958709717
Epoch: 13, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.795 Vali Acc: 0.300 Test Loss: 1.795 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9380030632019043
Epoch: 14, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.819 Vali Acc: 0.300 Test Loss: 1.819 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.396228313446045
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.861 Vali Acc: 0.320 Test Loss: 1.861 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0391604900360107
Epoch: 16, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.901 Vali Acc: 0.320 Test Loss: 1.901 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.018208265304565
Epoch: 1, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.1391513347625732
Epoch: 2, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.577 Vali Acc: 0.280 Test Loss: 1.577 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.9510157108306885
Epoch: 3, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.560 Vali Acc: 0.300 Test Loss: 1.560 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 2.0928945541381836
Epoch: 4, Steps: 4 | Train Loss: 1.234 Vali Loss: 1.566 Vali Acc: 0.300 Test Loss: 1.566 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.063643217086792
Epoch: 5, Steps: 4 | Train Loss: 1.124 Vali Loss: 1.585 Vali Acc: 0.300 Test Loss: 1.585 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.094414710998535
Epoch: 6, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.09965181350708
Epoch: 7, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.701 Vali Acc: 0.300 Test Loss: 1.701 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9688754081726074
Epoch: 8, Steps: 4 | Train Loss: 0.551 Vali Loss: 1.743 Vali Acc: 0.300 Test Loss: 1.743 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9449806213378906
Epoch: 9, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.737 Vali Acc: 0.300 Test Loss: 1.737 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.069807291030884
Epoch: 10, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.744 Vali Acc: 0.280 Test Loss: 1.744 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0307278633117676
Epoch: 11, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.791 Vali Acc: 0.280 Test Loss: 1.791 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.977670431137085
Epoch: 12, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.857 Vali Acc: 0.300 Test Loss: 1.857 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.920785665512085
Epoch: 13, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.880 Vali Acc: 0.280 Test Loss: 1.880 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.728058338165283
Epoch: 1, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.607 Vali Acc: 0.280 Test Loss: 1.607 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.9330174922943115
Epoch: 2, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0222012996673584
Epoch: 3, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.582 Vali Acc: 0.220 Test Loss: 1.582 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.368607521057129
Epoch: 4, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.590 Vali Acc: 0.220 Test Loss: 1.590 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3097989559173584
Epoch: 5, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.597 Vali Acc: 0.240 Test Loss: 1.597 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1828773021698
Epoch: 6, Steps: 4 | Train Loss: 0.752 Vali Loss: 1.636 Vali Acc: 0.220 Test Loss: 1.636 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.115438461303711
Epoch: 7, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.676 Vali Acc: 0.220 Test Loss: 1.676 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2872085571289062
Epoch: 8, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.700 Vali Acc: 0.240 Test Loss: 1.700 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0823864936828613
Epoch: 9, Steps: 4 | Train Loss: 0.362 Vali Loss: 1.692 Vali Acc: 0.240 Test Loss: 1.692 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.857879638671875
Epoch: 10, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.710 Vali Acc: 0.280 Test Loss: 1.710 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.143681764602661
Epoch: 11, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.748 Vali Acc: 0.260 Test Loss: 1.748 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8290252685546875
Epoch: 1, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.596 Vali Acc: 0.240 Test Loss: 1.596 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.9795634746551514
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.572 Vali Acc: 0.280 Test Loss: 1.572 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.8989028930664062
Epoch: 3, Steps: 4 | Train Loss: 1.460 Vali Loss: 1.561 Vali Acc: 0.320 Test Loss: 1.561 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 2.084317207336426
Epoch: 4, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.566 Vali Acc: 0.280 Test Loss: 1.566 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0511112213134766
Epoch: 5, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.579 Vali Acc: 0.260 Test Loss: 1.579 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.041041135787964
Epoch: 6, Steps: 4 | Train Loss: 0.794 Vali Loss: 1.613 Vali Acc: 0.240 Test Loss: 1.613 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9288749694824219
Epoch: 7, Steps: 4 | Train Loss: 0.670 Vali Loss: 1.650 Vali Acc: 0.240 Test Loss: 1.650 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.96669340133667
Epoch: 8, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.679 Vali Acc: 0.240 Test Loss: 1.679 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.67820143699646
Epoch: 9, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.681 Vali Acc: 0.260 Test Loss: 1.681 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1835262775421143
Epoch: 10, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.704 Vali Acc: 0.260 Test Loss: 1.704 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8133418560028076
Epoch: 11, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.731 Vali Acc: 0.240 Test Loss: 1.731 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9389581680297852
Epoch: 12, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.793 Vali Acc: 0.260 Test Loss: 1.793 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7937703132629395
Epoch: 13, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.809 Vali Acc: 0.300 Test Loss: 1.809 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.838759422302246
Epoch: 1, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.582 Vali Acc: 0.260 Test Loss: 1.582 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.01375150680542
Epoch: 2, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.564 Vali Acc: 0.280 Test Loss: 1.564 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.0360755920410156
Epoch: 3, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.552 Vali Acc: 0.320 Test Loss: 1.552 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 2.033318042755127
Epoch: 4, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.903388500213623
Epoch: 5, Steps: 4 | Train Loss: 1.094 Vali Loss: 1.560 Vali Acc: 0.300 Test Loss: 1.560 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0930445194244385
Epoch: 6, Steps: 4 | Train Loss: 0.847 Vali Loss: 1.601 Vali Acc: 0.300 Test Loss: 1.601 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.777343511581421
Epoch: 7, Steps: 4 | Train Loss: 0.648 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9815118312835693
Epoch: 8, Steps: 4 | Train Loss: 0.530 Vali Loss: 1.662 Vali Acc: 0.300 Test Loss: 1.662 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9111175537109375
Epoch: 9, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.670 Vali Acc: 0.380 Test Loss: 1.670 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379983).  Saving model ...
Epoch: 10 cost time: 1.9768319129943848
Epoch: 10, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.691 Vali Acc: 0.360 Test Loss: 1.691 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9788289070129395
Epoch: 11, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.714 Vali Acc: 0.360 Test Loss: 1.714 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.936450481414795
Epoch: 12, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.767 Vali Acc: 0.360 Test Loss: 1.767 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0864579677581787
Epoch: 13, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.810 Vali Acc: 0.280 Test Loss: 1.810 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9395062923431396
Epoch: 14, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.868 Vali Acc: 0.300 Test Loss: 1.868 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8955001831054688
Epoch: 15, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.923 Vali Acc: 0.340 Test Loss: 1.923 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8311760425567627
Epoch: 16, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.961 Vali Acc: 0.340 Test Loss: 1.961 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8104867935180664
Epoch: 17, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.975 Vali Acc: 0.400 Test Loss: 1.975 Test Acc: 0.400
Validation loss decreased (-0.379983 --> -0.399980).  Saving model ...
Epoch: 18 cost time: 2.0228617191314697
Epoch: 18, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.990 Vali Acc: 0.400 Test Loss: 1.990 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.130450487136841
Epoch: 19, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.029 Vali Acc: 0.420 Test Loss: 2.029 Test Acc: 0.420
Validation loss decreased (-0.399980 --> -0.419980).  Saving model ...
Epoch: 20 cost time: 2.059575319290161
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.064 Vali Acc: 0.400 Test Loss: 2.064 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0099899768829346
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.102 Vali Acc: 0.400 Test Loss: 2.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9514858722686768
Epoch: 22, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.124 Vali Acc: 0.400 Test Loss: 2.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9620935916900635
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.140 Vali Acc: 0.380 Test Loss: 2.140 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.045215368270874
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.152 Vali Acc: 0.380 Test Loss: 2.152 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.888674020767212
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.174 Vali Acc: 0.340 Test Loss: 2.174 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9481360912322998
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.192 Vali Acc: 0.340 Test Loss: 2.192 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.00899338722229
Epoch: 27, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.202 Vali Acc: 0.340 Test Loss: 2.202 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.0483994483947754
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.206 Vali Acc: 0.380 Test Loss: 2.206 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8311302661895752
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.217 Vali Acc: 0.400 Test Loss: 2.217 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6762423515319824
Epoch: 1, Steps: 4 | Train Loss: 1.655 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.0354673862457275
Epoch: 2, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.618 Vali Acc: 0.260 Test Loss: 1.618 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.8937687873840332
Epoch: 3, Steps: 4 | Train Loss: 1.465 Vali Loss: 1.599 Vali Acc: 0.300 Test Loss: 1.599 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.9395055770874023
Epoch: 4, Steps: 4 | Train Loss: 1.260 Vali Loss: 1.599 Vali Acc: 0.260 Test Loss: 1.599 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8660082817077637
Epoch: 5, Steps: 4 | Train Loss: 1.165 Vali Loss: 1.602 Vali Acc: 0.280 Test Loss: 1.602 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0927278995513916
Epoch: 6, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9074900150299072
Epoch: 7, Steps: 4 | Train Loss: 0.718 Vali Loss: 1.679 Vali Acc: 0.260 Test Loss: 1.679 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9217031002044678
Epoch: 8, Steps: 4 | Train Loss: 0.625 Vali Loss: 1.702 Vali Acc: 0.280 Test Loss: 1.702 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0330069065093994
Epoch: 9, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.973618745803833
Epoch: 10, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.699 Vali Acc: 0.260 Test Loss: 1.699 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0078649520874023
Epoch: 11, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.719 Vali Acc: 0.280 Test Loss: 1.719 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.042179822921753
Epoch: 12, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.775 Vali Acc: 0.260 Test Loss: 1.775 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1308181285858154
Epoch: 13, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.808 Vali Acc: 0.300 Test Loss: 1.808 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6469271183013916
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.019749164581299
Epoch: 2, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.604 Vali Acc: 0.220 Test Loss: 1.604 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.079360246658325
Epoch: 3, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.594 Vali Acc: 0.260 Test Loss: 1.594 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.998666524887085
Epoch: 4, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.589 Vali Acc: 0.260 Test Loss: 1.589 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.9496276378631592
Epoch: 5, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.583 Vali Acc: 0.260 Test Loss: 1.583 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.9178338050842285
Epoch: 6, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.597 Vali Acc: 0.200 Test Loss: 1.597 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9792604446411133
Epoch: 7, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.624 Vali Acc: 0.200 Test Loss: 1.624 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8788723945617676
Epoch: 8, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8463761806488037
Epoch: 9, Steps: 4 | Train Loss: 0.541 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9300243854522705
Epoch: 10, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7901818752288818
Epoch: 11, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.690 Vali Acc: 0.220 Test Loss: 1.690 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8134450912475586
Epoch: 12, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.698 Vali Acc: 0.220 Test Loss: 1.698 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.915522813796997
Epoch: 13, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8847088813781738
Epoch: 14, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.797 Vali Acc: 0.220 Test Loss: 1.797 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0015108585357666
Epoch: 15, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.852 Vali Acc: 0.240 Test Loss: 1.852 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4871420860290527
Epoch: 1, Steps: 4 | Train Loss: 1.727 Vali Loss: 1.531 Vali Acc: 0.280 Test Loss: 1.531 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.9421119689941406
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.523 Vali Acc: 0.260 Test Loss: 1.523 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0084855556488037
Epoch: 3, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.514 Vali Acc: 0.280 Test Loss: 1.514 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 2.012436866760254
Epoch: 4, Steps: 4 | Train Loss: 1.418 Vali Loss: 1.507 Vali Acc: 0.240 Test Loss: 1.507 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0106892585754395
Epoch: 5, Steps: 4 | Train Loss: 1.386 Vali Loss: 1.499 Vali Acc: 0.240 Test Loss: 1.499 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0166802406311035
Epoch: 6, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.508 Vali Acc: 0.280 Test Loss: 1.508 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 7 cost time: 2.2276835441589355
Epoch: 7, Steps: 4 | Train Loss: 1.104 Vali Loss: 1.529 Vali Acc: 0.260 Test Loss: 1.529 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1944618225097656
Epoch: 8, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.551 Vali Acc: 0.240 Test Loss: 1.551 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.069511890411377
Epoch: 9, Steps: 4 | Train Loss: 0.916 Vali Loss: 1.538 Vali Acc: 0.220 Test Loss: 1.538 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.071843147277832
Epoch: 10, Steps: 4 | Train Loss: 0.705 Vali Loss: 1.524 Vali Acc: 0.180 Test Loss: 1.524 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8649866580963135
Epoch: 11, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.517 Vali Acc: 0.220 Test Loss: 1.517 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9674787521362305
Epoch: 12, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.506 Vali Acc: 0.220 Test Loss: 1.506 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0566773414611816
Epoch: 13, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.526 Vali Acc: 0.240 Test Loss: 1.526 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8977627754211426
Epoch: 14, Steps: 4 | Train Loss: 0.372 Vali Loss: 1.558 Vali Acc: 0.220 Test Loss: 1.558 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.685797929763794
Epoch: 15, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.550 Vali Acc: 0.240 Test Loss: 1.550 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9232823848724365
Epoch: 16, Steps: 4 | Train Loss: 0.265 Vali Loss: 1.562 Vali Acc: 0.220 Test Loss: 1.562 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6527440547943115
Epoch: 1, Steps: 4 | Train Loss: 1.754 Vali Loss: 1.636 Vali Acc: 0.160 Test Loss: 1.636 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.8444714546203613
Epoch: 2, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.628 Vali Acc: 0.160 Test Loss: 1.628 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 2.004622220993042
Epoch: 3, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.621 Vali Acc: 0.180 Test Loss: 1.621 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.9393723011016846
Epoch: 4, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.616 Vali Acc: 0.180 Test Loss: 1.616 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 2.0154495239257812
Epoch: 5, Steps: 4 | Train Loss: 1.315 Vali Loss: 1.610 Vali Acc: 0.160 Test Loss: 1.610 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1951913833618164
Epoch: 6, Steps: 4 | Train Loss: 1.191 Vali Loss: 1.623 Vali Acc: 0.160 Test Loss: 1.623 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9338417053222656
Epoch: 7, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.636 Vali Acc: 0.220 Test Loss: 1.636 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 8 cost time: 1.9670825004577637
Epoch: 8, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.650 Vali Acc: 0.260 Test Loss: 1.650 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 9 cost time: 1.725236177444458
Epoch: 9, Steps: 4 | Train Loss: 0.848 Vali Loss: 1.631 Vali Acc: 0.200 Test Loss: 1.631 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.897496223449707
Epoch: 10, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.624 Vali Acc: 0.180 Test Loss: 1.624 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7280375957489014
Epoch: 11, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.621 Vali Acc: 0.180 Test Loss: 1.621 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.897244930267334
Epoch: 12, Steps: 4 | Train Loss: 0.536 Vali Loss: 1.611 Vali Acc: 0.180 Test Loss: 1.611 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7581570148468018
Epoch: 13, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.624 Vali Acc: 0.220 Test Loss: 1.624 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9515774250030518
Epoch: 14, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8095195293426514
Epoch: 15, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.652 Vali Acc: 0.200 Test Loss: 1.652 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8819501399993896
Epoch: 16, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.636 Vali Acc: 0.180 Test Loss: 1.636 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7529091835021973
Epoch: 17, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.586 Vali Acc: 0.180 Test Loss: 1.586 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8638026714324951
Epoch: 18, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.588 Vali Acc: 0.220 Test Loss: 1.588 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 609925
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.495255947113037
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.9234399795532227
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.634 Vali Acc: 0.380 Test Loss: 1.634 Test Acc: 0.380
Validation loss decreased (-0.239984 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 1.8737473487854004
Epoch: 3, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.657 Vali Acc: 0.260 Test Loss: 1.657 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9107768535614014
Epoch: 4, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.683 Vali Acc: 0.220 Test Loss: 1.683 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8849375247955322
Epoch: 5, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.676 Vali Acc: 0.260 Test Loss: 1.676 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7388193607330322
Epoch: 6, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.652 Vali Acc: 0.280 Test Loss: 1.652 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9043383598327637
Epoch: 7, Steps: 4 | Train Loss: 0.663 Vali Loss: 1.684 Vali Acc: 0.260 Test Loss: 1.684 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8104913234710693
Epoch: 8, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.703 Vali Acc: 0.320 Test Loss: 1.703 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0840914249420166
Epoch: 9, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.716 Vali Acc: 0.380 Test Loss: 1.716 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9360415935516357
Epoch: 10, Steps: 4 | Train Loss: 0.344 Vali Loss: 1.783 Vali Acc: 0.320 Test Loss: 1.783 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1107656955718994
Epoch: 11, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.826 Vali Acc: 0.300 Test Loss: 1.826 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0566813945770264
Epoch: 12, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.812 Vali Acc: 0.320 Test Loss: 1.812 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8152098655700684
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.605 Vali Acc: 0.280 Test Loss: 1.605 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 2.0409317016601562
Epoch: 2, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.631 Vali Acc: 0.300 Test Loss: 1.631 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.993408203125
Epoch: 3, Steps: 4 | Train Loss: 1.413 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0176870822906494
Epoch: 4, Steps: 4 | Train Loss: 1.306 Vali Loss: 1.683 Vali Acc: 0.260 Test Loss: 1.683 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9935390949249268
Epoch: 5, Steps: 4 | Train Loss: 1.178 Vali Loss: 1.680 Vali Acc: 0.200 Test Loss: 1.680 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1275408267974854
Epoch: 6, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.654 Vali Acc: 0.280 Test Loss: 1.654 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.095876932144165
Epoch: 7, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9301121234893799
Epoch: 8, Steps: 4 | Train Loss: 0.496 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.097992420196533
Epoch: 9, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.707 Vali Acc: 0.340 Test Loss: 1.707 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339983).  Saving model ...
Epoch: 10 cost time: 2.1973226070404053
Epoch: 10, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.774 Vali Acc: 0.300 Test Loss: 1.774 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.874598741531372
Epoch: 11, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.810 Vali Acc: 0.280 Test Loss: 1.810 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1224896907806396
Epoch: 12, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.795 Vali Acc: 0.340 Test Loss: 1.795 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.03533935546875
Epoch: 13, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.793 Vali Acc: 0.340 Test Loss: 1.793 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2060883045196533
Epoch: 14, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.789 Vali Acc: 0.320 Test Loss: 1.789 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1731925010681152
Epoch: 15, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.817 Vali Acc: 0.280 Test Loss: 1.817 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.05243182182312
Epoch: 16, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.865 Vali Acc: 0.260 Test Loss: 1.865 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3074052333831787
Epoch: 17, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.924 Vali Acc: 0.280 Test Loss: 1.924 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2632579803466797
Epoch: 18, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.055 Vali Acc: 0.280 Test Loss: 2.055 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2241194248199463
Epoch: 19, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.072 Vali Acc: 0.280 Test Loss: 2.072 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2966041564941406
Epoch: 1, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.595 Vali Acc: 0.200 Test Loss: 1.595 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.7543962001800537
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.622 Vali Acc: 0.260 Test Loss: 1.622 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.838688611984253
Epoch: 3, Steps: 4 | Train Loss: 1.444 Vali Loss: 1.649 Vali Acc: 0.200 Test Loss: 1.649 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8769125938415527
Epoch: 4, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.682 Vali Acc: 0.160 Test Loss: 1.682 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8218584060668945
Epoch: 5, Steps: 4 | Train Loss: 1.166 Vali Loss: 1.690 Vali Acc: 0.200 Test Loss: 1.690 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.880397081375122
Epoch: 6, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.679 Vali Acc: 0.240 Test Loss: 1.679 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8696248531341553
Epoch: 7, Steps: 4 | Train Loss: 0.644 Vali Loss: 1.733 Vali Acc: 0.240 Test Loss: 1.733 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7852885723114014
Epoch: 8, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.767 Vali Acc: 0.320 Test Loss: 1.767 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319982).  Saving model ...
Epoch: 9 cost time: 1.805476427078247
Epoch: 9, Steps: 4 | Train Loss: 0.463 Vali Loss: 1.793 Vali Acc: 0.320 Test Loss: 1.793 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8350000381469727
Epoch: 10, Steps: 4 | Train Loss: 0.357 Vali Loss: 1.880 Vali Acc: 0.300 Test Loss: 1.880 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7890005111694336
Epoch: 11, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.946 Vali Acc: 0.280 Test Loss: 1.946 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.894230842590332
Epoch: 12, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.956 Vali Acc: 0.300 Test Loss: 1.956 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.915177822113037
Epoch: 13, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.972 Vali Acc: 0.300 Test Loss: 1.972 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7954943180084229
Epoch: 14, Steps: 4 | Train Loss: 0.087 Vali Loss: 2.000 Vali Acc: 0.300 Test Loss: 2.000 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8105764389038086
Epoch: 15, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.047 Vali Acc: 0.320 Test Loss: 2.047 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8922860622406006
Epoch: 16, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.126 Vali Acc: 0.320 Test Loss: 2.126 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.095564365386963
Epoch: 17, Steps: 4 | Train Loss: 0.043 Vali Loss: 2.218 Vali Acc: 0.300 Test Loss: 2.218 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0770580768585205
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.373 Vali Acc: 0.300 Test Loss: 2.373 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2144827842712402
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.577 Vali Acc: 0.160 Test Loss: 1.577 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.803985595703125
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.596 Vali Acc: 0.180 Test Loss: 1.596 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.6941108703613281
Epoch: 3, Steps: 4 | Train Loss: 1.441 Vali Loss: 1.615 Vali Acc: 0.140 Test Loss: 1.615 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9895765781402588
Epoch: 4, Steps: 4 | Train Loss: 1.311 Vali Loss: 1.642 Vali Acc: 0.160 Test Loss: 1.642 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.59360671043396
Epoch: 5, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.644 Vali Acc: 0.160 Test Loss: 1.644 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9677565097808838
Epoch: 6, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.636 Vali Acc: 0.200 Test Loss: 1.636 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 7 cost time: 1.7132456302642822
Epoch: 7, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.679 Vali Acc: 0.200 Test Loss: 1.679 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9959495067596436
Epoch: 8, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.697 Vali Acc: 0.260 Test Loss: 1.697 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259983).  Saving model ...
Epoch: 9 cost time: 1.881042242050171
Epoch: 9, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.714 Vali Acc: 0.240 Test Loss: 1.714 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9681601524353027
Epoch: 10, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.799 Vali Acc: 0.280 Test Loss: 1.799 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 11 cost time: 1.8007276058197021
Epoch: 11, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.882 Vali Acc: 0.220 Test Loss: 1.882 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8115026950836182
Epoch: 12, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.918 Vali Acc: 0.260 Test Loss: 1.918 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.162890672683716
Epoch: 13, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.925 Vali Acc: 0.280 Test Loss: 1.925 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0159683227539062
Epoch: 14, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.943 Vali Acc: 0.300 Test Loss: 1.943 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299981).  Saving model ...
Epoch: 15 cost time: 2.155971050262451
Epoch: 15, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.982 Vali Acc: 0.300 Test Loss: 1.982 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7863564491271973
Epoch: 16, Steps: 4 | Train Loss: 0.046 Vali Loss: 2.049 Vali Acc: 0.300 Test Loss: 2.049 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8978424072265625
Epoch: 17, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.154 Vali Acc: 0.280 Test Loss: 2.154 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0307159423828125
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.311 Vali Acc: 0.260 Test Loss: 2.311 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.894641637802124
Epoch: 19, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.346 Vali Acc: 0.240 Test Loss: 2.346 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7630271911621094
Epoch: 20, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.269 Vali Acc: 0.260 Test Loss: 2.269 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7375762462615967
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.232 Vali Acc: 0.280 Test Loss: 2.232 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.736802101135254
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.228 Vali Acc: 0.260 Test Loss: 2.228 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7872860431671143
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.232 Vali Acc: 0.260 Test Loss: 2.232 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8394687175750732
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.245 Vali Acc: 0.260 Test Loss: 2.245 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9175848960876465
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.553 Vali Acc: 0.220 Test Loss: 1.553 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9438865184783936
Epoch: 2, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 2.2006001472473145
Epoch: 3, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.580 Vali Acc: 0.280 Test Loss: 1.580 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.992908239364624
Epoch: 4, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.600 Vali Acc: 0.200 Test Loss: 1.600 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0916635990142822
Epoch: 5, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.606 Vali Acc: 0.200 Test Loss: 1.606 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7687742710113525
Epoch: 6, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.602 Vali Acc: 0.260 Test Loss: 1.602 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1393883228302
Epoch: 7, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.644 Vali Acc: 0.200 Test Loss: 1.644 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9791159629821777
Epoch: 8, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8416244983673096
Epoch: 9, Steps: 4 | Train Loss: 0.440 Vali Loss: 1.663 Vali Acc: 0.220 Test Loss: 1.663 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9361004829406738
Epoch: 10, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.732 Vali Acc: 0.220 Test Loss: 1.732 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.705092430114746
Epoch: 11, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.790 Vali Acc: 0.160 Test Loss: 1.790 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8793184757232666
Epoch: 12, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.823 Vali Acc: 0.200 Test Loss: 1.823 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.675285577774048
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.544 Vali Acc: 0.220 Test Loss: 1.544 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 2.094363212585449
Epoch: 2, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.556 Vali Acc: 0.180 Test Loss: 1.556 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8122823238372803
Epoch: 3, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.558 Vali Acc: 0.220 Test Loss: 1.558 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8494362831115723
Epoch: 4, Steps: 4 | Train Loss: 1.322 Vali Loss: 1.572 Vali Acc: 0.240 Test Loss: 1.572 Test Acc: 0.240
Validation loss decreased (-0.219985 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.9093067646026611
Epoch: 5, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.577 Vali Acc: 0.240 Test Loss: 1.577 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.945251226425171
Epoch: 6, Steps: 4 | Train Loss: 0.920 Vali Loss: 1.579 Vali Acc: 0.280 Test Loss: 1.579 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.9220287799835205
Epoch: 7, Steps: 4 | Train Loss: 0.666 Vali Loss: 1.631 Vali Acc: 0.240 Test Loss: 1.631 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.052520751953125
Epoch: 8, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.649 Vali Acc: 0.260 Test Loss: 1.649 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0915732383728027
Epoch: 9, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.646 Vali Acc: 0.280 Test Loss: 1.646 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.130073308944702
Epoch: 10, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.718 Vali Acc: 0.280 Test Loss: 1.718 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1144518852233887
Epoch: 11, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.794 Vali Acc: 0.260 Test Loss: 1.794 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9165308475494385
Epoch: 12, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.841 Vali Acc: 0.280 Test Loss: 1.841 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7727439403533936
Epoch: 13, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.822 Vali Acc: 0.300 Test Loss: 1.822 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299982).  Saving model ...
Epoch: 14 cost time: 2.0367910861968994
Epoch: 14, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.822 Vali Acc: 0.300 Test Loss: 1.822 Test Acc: 0.300
Validation loss decreased (-0.299982 --> -0.299982).  Saving model ...
Epoch: 15 cost time: 1.9908058643341064
Epoch: 15, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.854 Vali Acc: 0.300 Test Loss: 1.854 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.853104829788208
Epoch: 16, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.924 Vali Acc: 0.300 Test Loss: 1.924 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9099700450897217
Epoch: 17, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.025 Vali Acc: 0.300 Test Loss: 2.025 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0288829803466797
Epoch: 18, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.163 Vali Acc: 0.300 Test Loss: 2.163 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.149099111557007
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.222 Vali Acc: 0.300 Test Loss: 2.222 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.165998697280884
Epoch: 20, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.201 Vali Acc: 0.320 Test Loss: 2.201 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319978).  Saving model ...
Epoch: 21 cost time: 2.2556333541870117
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.172 Vali Acc: 0.300 Test Loss: 2.172 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.969170331954956
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.157 Vali Acc: 0.280 Test Loss: 2.157 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.131263256072998
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.152 Vali Acc: 0.300 Test Loss: 2.152 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.202709674835205
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.161 Vali Acc: 0.300 Test Loss: 2.161 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9592461585998535
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.174 Vali Acc: 0.300 Test Loss: 2.174 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1218888759613037
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.194 Vali Acc: 0.300 Test Loss: 2.194 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9970710277557373
Epoch: 27, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.214 Vali Acc: 0.300 Test Loss: 2.214 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8620009422302246
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.245 Vali Acc: 0.320 Test Loss: 2.245 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.135969638824463
Epoch: 29, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.265 Vali Acc: 0.320 Test Loss: 2.265 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8433308601379395
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.276 Vali Acc: 0.320 Test Loss: 2.276 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7753889560699463
Epoch: 1, Steps: 4 | Train Loss: 1.738 Vali Loss: 1.626 Vali Acc: 0.200 Test Loss: 1.626 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.9080846309661865
Epoch: 2, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.634 Vali Acc: 0.220 Test Loss: 1.634 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.8851542472839355
Epoch: 3, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.633 Vali Acc: 0.280 Test Loss: 1.633 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.914966344833374
Epoch: 4, Steps: 4 | Train Loss: 1.340 Vali Loss: 1.641 Vali Acc: 0.280 Test Loss: 1.641 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.142622947692871
Epoch: 5, Steps: 4 | Train Loss: 1.156 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7293071746826172
Epoch: 6, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.640 Vali Acc: 0.260 Test Loss: 1.640 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9057576656341553
Epoch: 7, Steps: 4 | Train Loss: 0.670 Vali Loss: 1.680 Vali Acc: 0.240 Test Loss: 1.680 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8627581596374512
Epoch: 8, Steps: 4 | Train Loss: 0.494 Vali Loss: 1.693 Vali Acc: 0.260 Test Loss: 1.693 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9188563823699951
Epoch: 9, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.690 Vali Acc: 0.340 Test Loss: 1.690 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339983).  Saving model ...
Epoch: 10 cost time: 1.8743252754211426
Epoch: 10, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.762 Vali Acc: 0.320 Test Loss: 1.762 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.054086446762085
Epoch: 11, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.823 Vali Acc: 0.280 Test Loss: 1.823 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8247137069702148
Epoch: 12, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.869 Vali Acc: 0.280 Test Loss: 1.869 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8738508224487305
Epoch: 13, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.869 Vali Acc: 0.280 Test Loss: 1.869 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1716272830963135
Epoch: 14, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.855 Vali Acc: 0.320 Test Loss: 1.855 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.888563871383667
Epoch: 15, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.872 Vali Acc: 0.340 Test Loss: 1.872 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.83713960647583
Epoch: 16, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.930 Vali Acc: 0.340 Test Loss: 1.930 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9432640075683594
Epoch: 17, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.039 Vali Acc: 0.320 Test Loss: 2.039 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9323630332946777
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.185 Vali Acc: 0.280 Test Loss: 2.185 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1979634761810303
Epoch: 19, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.236 Vali Acc: 0.260 Test Loss: 2.236 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.449732542037964
Epoch: 1, Steps: 4 | Train Loss: 1.745 Vali Loss: 1.587 Vali Acc: 0.220 Test Loss: 1.587 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9100241661071777
Epoch: 2, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.596 Vali Acc: 0.220 Test Loss: 1.596 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.78971529006958
Epoch: 3, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.595 Vali Acc: 0.200 Test Loss: 1.595 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6502530574798584
Epoch: 4, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.607 Vali Acc: 0.180 Test Loss: 1.607 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.807884693145752
Epoch: 5, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.606 Vali Acc: 0.180 Test Loss: 1.606 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9381897449493408
Epoch: 6, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.599 Vali Acc: 0.220 Test Loss: 1.599 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6451311111450195
Epoch: 7, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8922982215881348
Epoch: 8, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.626 Vali Acc: 0.280 Test Loss: 1.626 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 9 cost time: 1.8237614631652832
Epoch: 9, Steps: 4 | Train Loss: 0.549 Vali Loss: 1.599 Vali Acc: 0.360 Test Loss: 1.599 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359984).  Saving model ...
Epoch: 10 cost time: 1.8173363208770752
Epoch: 10, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.646 Vali Acc: 0.360 Test Loss: 1.646 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8137164115905762
Epoch: 11, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.686 Vali Acc: 0.300 Test Loss: 1.686 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8968994617462158
Epoch: 12, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.711 Vali Acc: 0.300 Test Loss: 1.711 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.846738576889038
Epoch: 13, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.698 Vali Acc: 0.320 Test Loss: 1.698 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7896168231964111
Epoch: 14, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.685 Vali Acc: 0.260 Test Loss: 1.685 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8898670673370361
Epoch: 15, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8202261924743652
Epoch: 16, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.827 Vali Acc: 0.300 Test Loss: 1.827 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8831114768981934
Epoch: 17, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.952 Vali Acc: 0.280 Test Loss: 1.952 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1766517162323
Epoch: 18, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.060 Vali Acc: 0.220 Test Loss: 2.060 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.898223638534546
Epoch: 19, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.047 Vali Acc: 0.200 Test Loss: 2.047 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.778343439102173
Epoch: 1, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.605 Vali Acc: 0.280 Test Loss: 1.605 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.9859766960144043
Epoch: 2, Steps: 4 | Train Loss: 1.782 Vali Loss: 1.610 Vali Acc: 0.280 Test Loss: 1.610 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9457519054412842
Epoch: 3, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.607 Vali Acc: 0.280 Test Loss: 1.607 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.932105302810669
Epoch: 4, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.608 Vali Acc: 0.280 Test Loss: 1.608 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8255634307861328
Epoch: 5, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.600 Vali Acc: 0.280 Test Loss: 1.600 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 2.254387855529785
Epoch: 6, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.596 Vali Acc: 0.280 Test Loss: 1.596 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.706958293914795
Epoch: 7, Steps: 4 | Train Loss: 1.033 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0584042072296143
Epoch: 8, Steps: 4 | Train Loss: 0.949 Vali Loss: 1.629 Vali Acc: 0.240 Test Loss: 1.629 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.79701828956604
Epoch: 9, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.627 Vali Acc: 0.200 Test Loss: 1.627 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.908886432647705
Epoch: 10, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.648 Vali Acc: 0.260 Test Loss: 1.648 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9249646663665771
Epoch: 11, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.658 Vali Acc: 0.260 Test Loss: 1.658 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0490283966064453
Epoch: 12, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9813334941864014
Epoch: 13, Steps: 4 | Train Loss: 0.463 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8153631687164307
Epoch: 14, Steps: 4 | Train Loss: 0.397 Vali Loss: 1.600 Vali Acc: 0.200 Test Loss: 1.600 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2692201137542725
Epoch: 15, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.932027816772461
Epoch: 16, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.686 Vali Acc: 0.200 Test Loss: 1.686 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5378994941711426
Epoch: 1, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.601 Vali Acc: 0.180 Test Loss: 1.601 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.865699291229248
Epoch: 2, Steps: 4 | Train Loss: 1.743 Vali Loss: 1.606 Vali Acc: 0.200 Test Loss: 1.606 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.9111530780792236
Epoch: 3, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 2.1884312629699707
Epoch: 4, Steps: 4 | Train Loss: 1.401 Vali Loss: 1.613 Vali Acc: 0.180 Test Loss: 1.613 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9495956897735596
Epoch: 5, Steps: 4 | Train Loss: 1.437 Vali Loss: 1.615 Vali Acc: 0.200 Test Loss: 1.615 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.082763433456421
Epoch: 6, Steps: 4 | Train Loss: 1.204 Vali Loss: 1.606 Vali Acc: 0.240 Test Loss: 1.606 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.8757808208465576
Epoch: 7, Steps: 4 | Train Loss: 0.997 Vali Loss: 1.610 Vali Acc: 0.200 Test Loss: 1.610 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1574957370758057
Epoch: 8, Steps: 4 | Train Loss: 0.886 Vali Loss: 1.624 Vali Acc: 0.240 Test Loss: 1.624 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8798882961273193
Epoch: 9, Steps: 4 | Train Loss: 0.907 Vali Loss: 1.625 Vali Acc: 0.140 Test Loss: 1.625 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9956698417663574
Epoch: 10, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.643 Vali Acc: 0.140 Test Loss: 1.643 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9126553535461426
Epoch: 11, Steps: 4 | Train Loss: 0.733 Vali Loss: 1.652 Vali Acc: 0.160 Test Loss: 1.652 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7125096321105957
Epoch: 12, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.653 Vali Acc: 0.160 Test Loss: 1.653 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9084789752960205
Epoch: 13, Steps: 4 | Train Loss: 0.418 Vali Loss: 1.638 Vali Acc: 0.200 Test Loss: 1.638 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2869842052459717
Epoch: 14, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.622 Vali Acc: 0.260 Test Loss: 1.622 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 15 cost time: 2.069570541381836
Epoch: 15, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.140052318572998
Epoch: 16, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.700 Vali Acc: 0.180 Test Loss: 1.700 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8536567687988281
Epoch: 17, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.717 Vali Acc: 0.180 Test Loss: 1.717 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.904557466506958
Epoch: 18, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.713 Vali Acc: 0.200 Test Loss: 1.713 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9322688579559326
Epoch: 19, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.709 Vali Acc: 0.200 Test Loss: 1.709 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.036924123764038
Epoch: 20, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.689 Vali Acc: 0.220 Test Loss: 1.689 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1773111820220947
Epoch: 21, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.676 Vali Acc: 0.180 Test Loss: 1.676 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.078556537628174
Epoch: 22, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.710 Vali Acc: 0.200 Test Loss: 1.710 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9270131587982178
Epoch: 23, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.745 Vali Acc: 0.220 Test Loss: 1.745 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8202059268951416
Epoch: 24, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.768 Vali Acc: 0.220 Test Loss: 1.768 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 560773
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3331308364868164
Epoch: 1, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.659 Vali Acc: 0.240 Test Loss: 1.659 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.1392834186553955
Epoch: 2, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.628 Vali Acc: 0.120 Test Loss: 1.628 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9574222564697266
Epoch: 3, Steps: 4 | Train Loss: 1.490 Vali Loss: 1.604 Vali Acc: 0.120 Test Loss: 1.604 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8122894763946533
Epoch: 4, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.586 Vali Acc: 0.220 Test Loss: 1.586 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.04079532623291
Epoch: 5, Steps: 4 | Train Loss: 1.232 Vali Loss: 1.579 Vali Acc: 0.240 Test Loss: 1.579 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.9841830730438232
Epoch: 6, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9596271514892578
Epoch: 7, Steps: 4 | Train Loss: 1.151 Vali Loss: 1.597 Vali Acc: 0.220 Test Loss: 1.597 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7195870876312256
Epoch: 8, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.618 Vali Acc: 0.180 Test Loss: 1.618 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.873349666595459
Epoch: 9, Steps: 4 | Train Loss: 0.790 Vali Loss: 1.623 Vali Acc: 0.200 Test Loss: 1.623 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8387112617492676
Epoch: 10, Steps: 4 | Train Loss: 0.618 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 11 cost time: 2.126417636871338
Epoch: 11, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.610 Vali Acc: 0.300 Test Loss: 1.610 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 12 cost time: 1.9781429767608643
Epoch: 12, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.061249256134033
Epoch: 13, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.629 Vali Acc: 0.320 Test Loss: 1.629 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 14 cost time: 1.897904634475708
Epoch: 14, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.628 Vali Acc: 0.320 Test Loss: 1.628 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 15 cost time: 1.8682537078857422
Epoch: 15, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.670 Vali Acc: 0.300 Test Loss: 1.670 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9759228229522705
Epoch: 16, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.676 Vali Acc: 0.280 Test Loss: 1.676 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9412848949432373
Epoch: 17, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.683 Vali Acc: 0.320 Test Loss: 1.683 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9709036350250244
Epoch: 18, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.712 Vali Acc: 0.340 Test Loss: 1.712 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339983).  Saving model ...
Epoch: 19 cost time: 2.0632383823394775
Epoch: 19, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.742 Vali Acc: 0.320 Test Loss: 1.742 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.11092209815979
Epoch: 20, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.804 Vali Acc: 0.340 Test Loss: 1.804 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2917568683624268
Epoch: 21, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.822 Vali Acc: 0.320 Test Loss: 1.822 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8487753868103027
Epoch: 22, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.816 Vali Acc: 0.300 Test Loss: 1.816 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9385128021240234
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.813 Vali Acc: 0.340 Test Loss: 1.813 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0040438175201416
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.840 Vali Acc: 0.340 Test Loss: 1.840 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9599440097808838
Epoch: 25, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.909 Vali Acc: 0.340 Test Loss: 1.909 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0556480884552
Epoch: 26, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.963 Vali Acc: 0.360 Test Loss: 1.963 Test Acc: 0.360
Validation loss decreased (-0.339983 --> -0.359980).  Saving model ...
Epoch: 27 cost time: 1.7952470779418945
Epoch: 27, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.989 Vali Acc: 0.360 Test Loss: 1.989 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9450201988220215
Epoch: 28, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.990 Vali Acc: 0.360 Test Loss: 1.990 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8237545490264893
Epoch: 29, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.973 Vali Acc: 0.340 Test Loss: 1.973 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.980015754699707
Epoch: 30, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.966 Vali Acc: 0.320 Test Loss: 1.966 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7835309505462646
Epoch: 31, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.959 Vali Acc: 0.320 Test Loss: 1.959 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0891427993774414
Epoch: 32, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.959 Vali Acc: 0.320 Test Loss: 1.959 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9182965755462646
Epoch: 33, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.961 Vali Acc: 0.320 Test Loss: 1.961 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8460907936096191
Epoch: 34, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.964 Vali Acc: 0.340 Test Loss: 1.964 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9005489349365234
Epoch: 35, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.971 Vali Acc: 0.320 Test Loss: 1.971 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.118115186691284
Epoch: 36, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.983 Vali Acc: 0.320 Test Loss: 1.983 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6416022777557373
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.640 Vali Acc: 0.160 Test Loss: 1.640 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.0052578449249268
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.610 Vali Acc: 0.120 Test Loss: 1.610 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6355805397033691
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.587 Vali Acc: 0.180 Test Loss: 1.587 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.8725576400756836
Epoch: 4, Steps: 4 | Train Loss: 1.348 Vali Loss: 1.569 Vali Acc: 0.180 Test Loss: 1.569 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 1.724686622619629
Epoch: 5, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.560 Vali Acc: 0.240 Test Loss: 1.560 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.7136685848236084
Epoch: 6, Steps: 4 | Train Loss: 1.173 Vali Loss: 1.576 Vali Acc: 0.200 Test Loss: 1.576 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8195528984069824
Epoch: 7, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.567 Vali Acc: 0.220 Test Loss: 1.567 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8139705657958984
Epoch: 8, Steps: 4 | Train Loss: 0.957 Vali Loss: 1.580 Vali Acc: 0.220 Test Loss: 1.580 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9089562892913818
Epoch: 9, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.576 Vali Acc: 0.260 Test Loss: 1.576 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 10 cost time: 1.896608591079712
Epoch: 10, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.580 Vali Acc: 0.260 Test Loss: 1.580 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8635382652282715
Epoch: 11, Steps: 4 | Train Loss: 0.626 Vali Loss: 1.558 Vali Acc: 0.280 Test Loss: 1.558 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 12 cost time: 1.98952317237854
Epoch: 12, Steps: 4 | Train Loss: 0.408 Vali Loss: 1.564 Vali Acc: 0.280 Test Loss: 1.564 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8655939102172852
Epoch: 13, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.579 Vali Acc: 0.280 Test Loss: 1.579 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8641557693481445
Epoch: 14, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.580 Vali Acc: 0.280 Test Loss: 1.580 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8589863777160645
Epoch: 15, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.625 Vali Acc: 0.280 Test Loss: 1.625 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8264553546905518
Epoch: 16, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.081071376800537
Epoch: 17, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.603 Vali Acc: 0.240 Test Loss: 1.603 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8355488777160645
Epoch: 18, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.626 Vali Acc: 0.280 Test Loss: 1.626 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1327595710754395
Epoch: 19, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.650 Vali Acc: 0.340 Test Loss: 1.650 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 20 cost time: 2.0427086353302
Epoch: 20, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.086758613586426
Epoch: 21, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.709 Vali Acc: 0.320 Test Loss: 1.709 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9668328762054443
Epoch: 22, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.706 Vali Acc: 0.340 Test Loss: 1.706 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7935082912445068
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.707 Vali Acc: 0.300 Test Loss: 1.707 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0590720176696777
Epoch: 24, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.735 Vali Acc: 0.320 Test Loss: 1.735 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.058511734008789
Epoch: 25, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.801 Vali Acc: 0.300 Test Loss: 1.801 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9939868450164795
Epoch: 26, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.848 Vali Acc: 0.260 Test Loss: 1.848 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.031071662902832
Epoch: 27, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.865 Vali Acc: 0.300 Test Loss: 1.865 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.865006923675537
Epoch: 28, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.860 Vali Acc: 0.300 Test Loss: 1.860 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.108304023742676
Epoch: 29, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.845 Vali Acc: 0.320 Test Loss: 1.845 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.542809009552002
Epoch: 1, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.681 Vali Acc: 0.140 Test Loss: 1.681 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.9944181442260742
Epoch: 2, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.655 Vali Acc: 0.160 Test Loss: 1.655 Test Acc: 0.160
Validation loss decreased (-0.139983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 2.0036556720733643
Epoch: 3, Steps: 4 | Train Loss: 1.464 Vali Loss: 1.632 Vali Acc: 0.180 Test Loss: 1.632 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 2.0918900966644287
Epoch: 4, Steps: 4 | Train Loss: 1.352 Vali Loss: 1.612 Vali Acc: 0.180 Test Loss: 1.612 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 2.0030622482299805
Epoch: 5, Steps: 4 | Train Loss: 1.235 Vali Loss: 1.607 Vali Acc: 0.260 Test Loss: 1.607 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 2.0294735431671143
Epoch: 6, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.631 Vali Acc: 0.280 Test Loss: 1.631 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 2.0574421882629395
Epoch: 7, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.634 Vali Acc: 0.260 Test Loss: 1.634 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.074923276901245
Epoch: 8, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.663 Vali Acc: 0.260 Test Loss: 1.663 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9985630512237549
Epoch: 9, Steps: 4 | Train Loss: 0.780 Vali Loss: 1.677 Vali Acc: 0.240 Test Loss: 1.677 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9093101024627686
Epoch: 10, Steps: 4 | Train Loss: 0.608 Vali Loss: 1.703 Vali Acc: 0.220 Test Loss: 1.703 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.806272029876709
Epoch: 11, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8663761615753174
Epoch: 12, Steps: 4 | Train Loss: 0.394 Vali Loss: 1.718 Vali Acc: 0.260 Test Loss: 1.718 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9101521968841553
Epoch: 13, Steps: 4 | Train Loss: 0.522 Vali Loss: 1.753 Vali Acc: 0.240 Test Loss: 1.753 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8266396522521973
Epoch: 14, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.785 Vali Acc: 0.260 Test Loss: 1.785 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7881264686584473
Epoch: 15, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.862 Vali Acc: 0.200 Test Loss: 1.862 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.876244306564331
Epoch: 16, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.892 Vali Acc: 0.180 Test Loss: 1.892 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4469950199127197
Epoch: 1, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.678 Vali Acc: 0.240 Test Loss: 1.678 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.8054475784301758
Epoch: 2, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.653 Vali Acc: 0.140 Test Loss: 1.653 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7977397441864014
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.791921854019165
Epoch: 4, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.613 Vali Acc: 0.220 Test Loss: 1.613 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7961430549621582
Epoch: 5, Steps: 4 | Train Loss: 1.217 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6903064250946045
Epoch: 6, Steps: 4 | Train Loss: 1.096 Vali Loss: 1.628 Vali Acc: 0.220 Test Loss: 1.628 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.801123857498169
Epoch: 7, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 8 cost time: 2.018770694732666
Epoch: 8, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.650 Vali Acc: 0.240 Test Loss: 1.650 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9172899723052979
Epoch: 9, Steps: 4 | Train Loss: 0.790 Vali Loss: 1.659 Vali Acc: 0.260 Test Loss: 1.659 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 10 cost time: 1.7651572227478027
Epoch: 10, Steps: 4 | Train Loss: 0.657 Vali Loss: 1.674 Vali Acc: 0.220 Test Loss: 1.674 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7892026901245117
Epoch: 11, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.649 Vali Acc: 0.240 Test Loss: 1.649 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8641533851623535
Epoch: 12, Steps: 4 | Train Loss: 0.372 Vali Loss: 1.651 Vali Acc: 0.260 Test Loss: 1.651 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 13 cost time: 1.8541882038116455
Epoch: 13, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.673 Vali Acc: 0.260 Test Loss: 1.673 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.876662015914917
Epoch: 14, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.703 Vali Acc: 0.260 Test Loss: 1.703 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7563879489898682
Epoch: 15, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.772 Vali Acc: 0.240 Test Loss: 1.772 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.983489990234375
Epoch: 16, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.764 Vali Acc: 0.220 Test Loss: 1.764 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8588893413543701
Epoch: 17, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.753 Vali Acc: 0.280 Test Loss: 1.753 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 18 cost time: 1.855851650238037
Epoch: 18, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.785 Vali Acc: 0.240 Test Loss: 1.785 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6356422901153564
Epoch: 19, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.823 Vali Acc: 0.260 Test Loss: 1.823 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7959256172180176
Epoch: 20, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.904 Vali Acc: 0.260 Test Loss: 1.904 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8865056037902832
Epoch: 21, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.936 Vali Acc: 0.240 Test Loss: 1.936 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7482600212097168
Epoch: 22, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.934 Vali Acc: 0.220 Test Loss: 1.934 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8642017841339111
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.918 Vali Acc: 0.280 Test Loss: 1.918 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8940577507019043
Epoch: 24, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.944 Vali Acc: 0.280 Test Loss: 1.944 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.716108798980713
Epoch: 25, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.020 Vali Acc: 0.260 Test Loss: 2.020 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.076918125152588
Epoch: 26, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.059 Vali Acc: 0.300 Test Loss: 2.059 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299979).  Saving model ...
Epoch: 27 cost time: 1.808107852935791
Epoch: 27, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.065 Vali Acc: 0.200 Test Loss: 2.065 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7698156833648682
Epoch: 28, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.043 Vali Acc: 0.220 Test Loss: 2.043 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7735066413879395
Epoch: 29, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.026 Vali Acc: 0.220 Test Loss: 2.026 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.831153392791748
Epoch: 30, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.023 Vali Acc: 0.240 Test Loss: 2.023 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7274510860443115
Epoch: 31, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.014 Vali Acc: 0.240 Test Loss: 2.014 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7925031185150146
Epoch: 32, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.012 Vali Acc: 0.240 Test Loss: 2.012 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5997593402862549
Epoch: 33, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.018 Vali Acc: 0.240 Test Loss: 2.018 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8374192714691162
Epoch: 34, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.023 Vali Acc: 0.260 Test Loss: 2.023 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7519862651824951
Epoch: 35, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.037 Vali Acc: 0.280 Test Loss: 2.037 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.844214916229248
Epoch: 36, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.052 Vali Acc: 0.260 Test Loss: 2.052 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9918625354766846
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.646 Vali Acc: 0.280 Test Loss: 1.646 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 2.126774549484253
Epoch: 2, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.629 Vali Acc: 0.200 Test Loss: 1.629 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.005131721496582
Epoch: 3, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.621 Vali Acc: 0.200 Test Loss: 1.621 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8721249103546143
Epoch: 4, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.612 Vali Acc: 0.180 Test Loss: 1.612 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.880612850189209
Epoch: 5, Steps: 4 | Train Loss: 1.213 Vali Loss: 1.608 Vali Acc: 0.160 Test Loss: 1.608 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.895353078842163
Epoch: 6, Steps: 4 | Train Loss: 1.178 Vali Loss: 1.632 Vali Acc: 0.160 Test Loss: 1.632 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8538999557495117
Epoch: 7, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.638 Vali Acc: 0.200 Test Loss: 1.638 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6131999492645264
Epoch: 8, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7371456623077393
Epoch: 9, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.691 Vali Acc: 0.160 Test Loss: 1.691 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8226864337921143
Epoch: 10, Steps: 4 | Train Loss: 0.608 Vali Loss: 1.726 Vali Acc: 0.200 Test Loss: 1.726 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9498286247253418
Epoch: 11, Steps: 4 | Train Loss: 0.571 Vali Loss: 1.729 Vali Acc: 0.180 Test Loss: 1.729 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7681336402893066
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.669 Vali Acc: 0.220 Test Loss: 1.669 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.8583683967590332
Epoch: 2, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9808216094970703
Epoch: 3, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.7402873039245605
Epoch: 4, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.569 Vali Acc: 0.220 Test Loss: 1.569 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0389912128448486
Epoch: 5, Steps: 4 | Train Loss: 1.269 Vali Loss: 1.554 Vali Acc: 0.220 Test Loss: 1.554 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8010609149932861
Epoch: 6, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.572 Vali Acc: 0.200 Test Loss: 1.572 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.994349479675293
Epoch: 7, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.583 Vali Acc: 0.220 Test Loss: 1.583 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.923969030380249
Epoch: 8, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8038976192474365
Epoch: 9, Steps: 4 | Train Loss: 0.787 Vali Loss: 1.645 Vali Acc: 0.240 Test Loss: 1.645 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8591883182525635
Epoch: 10, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.681 Vali Acc: 0.220 Test Loss: 1.681 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.895681619644165
Epoch: 11, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.673 Vali Acc: 0.220 Test Loss: 1.673 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7911887168884277
Epoch: 12, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.679 Vali Acc: 0.280 Test Loss: 1.679 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 13 cost time: 1.9772851467132568
Epoch: 13, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.718 Vali Acc: 0.280 Test Loss: 1.718 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6887028217315674
Epoch: 14, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.760 Vali Acc: 0.240 Test Loss: 1.760 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6962628364562988
Epoch: 15, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.847 Vali Acc: 0.260 Test Loss: 1.847 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0180649757385254
Epoch: 16, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.881 Vali Acc: 0.260 Test Loss: 1.881 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1028335094451904
Epoch: 17, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.912 Vali Acc: 0.260 Test Loss: 1.912 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0504298210144043
Epoch: 18, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.974 Vali Acc: 0.260 Test Loss: 1.974 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0503857135772705
Epoch: 19, Steps: 4 | Train Loss: 0.045 Vali Loss: 2.020 Vali Acc: 0.220 Test Loss: 2.020 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1076431274414062
Epoch: 20, Steps: 4 | Train Loss: 0.033 Vali Loss: 2.078 Vali Acc: 0.240 Test Loss: 2.078 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.038386344909668
Epoch: 21, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.085 Vali Acc: 0.240 Test Loss: 2.085 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.107006549835205
Epoch: 22, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.082 Vali Acc: 0.240 Test Loss: 2.082 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3899052143096924
Epoch: 1, Steps: 4 | Train Loss: 1.747 Vali Loss: 1.605 Vali Acc: 0.200 Test Loss: 1.605 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.8563930988311768
Epoch: 2, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.576 Vali Acc: 0.280 Test Loss: 1.576 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.955331802368164
Epoch: 3, Steps: 4 | Train Loss: 1.618 Vali Loss: 1.558 Vali Acc: 0.280 Test Loss: 1.558 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.9379911422729492
Epoch: 4, Steps: 4 | Train Loss: 1.418 Vali Loss: 1.546 Vali Acc: 0.340 Test Loss: 1.546 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.8978466987609863
Epoch: 5, Steps: 4 | Train Loss: 1.319 Vali Loss: 1.540 Vali Acc: 0.280 Test Loss: 1.540 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9255764484405518
Epoch: 6, Steps: 4 | Train Loss: 1.244 Vali Loss: 1.556 Vali Acc: 0.260 Test Loss: 1.556 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9293022155761719
Epoch: 7, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.553 Vali Acc: 0.280 Test Loss: 1.553 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.725154161453247
Epoch: 8, Steps: 4 | Train Loss: 0.982 Vali Loss: 1.567 Vali Acc: 0.280 Test Loss: 1.567 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.951030969619751
Epoch: 9, Steps: 4 | Train Loss: 0.842 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8135385513305664
Epoch: 10, Steps: 4 | Train Loss: 0.733 Vali Loss: 1.575 Vali Acc: 0.300 Test Loss: 1.575 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8416688442230225
Epoch: 11, Steps: 4 | Train Loss: 0.695 Vali Loss: 1.557 Vali Acc: 0.300 Test Loss: 1.557 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.836709976196289
Epoch: 12, Steps: 4 | Train Loss: 0.440 Vali Loss: 1.563 Vali Acc: 0.280 Test Loss: 1.563 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9087364673614502
Epoch: 13, Steps: 4 | Train Loss: 0.541 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.77034592628479
Epoch: 14, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4408552646636963
Epoch: 1, Steps: 4 | Train Loss: 1.698 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.8894922733306885
Epoch: 2, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.9879813194274902
Epoch: 3, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.605 Vali Acc: 0.180 Test Loss: 1.605 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.812337875366211
Epoch: 4, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.595 Vali Acc: 0.200 Test Loss: 1.595 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 5 cost time: 1.7716460227966309
Epoch: 5, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.589 Vali Acc: 0.180 Test Loss: 1.589 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0717337131500244
Epoch: 6, Steps: 4 | Train Loss: 1.330 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 7 cost time: 1.8483798503875732
Epoch: 7, Steps: 4 | Train Loss: 1.217 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 8 cost time: 1.822519302368164
Epoch: 8, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.632 Vali Acc: 0.240 Test Loss: 1.632 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9354453086853027
Epoch: 9, Steps: 4 | Train Loss: 0.871 Vali Loss: 1.646 Vali Acc: 0.240 Test Loss: 1.646 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9808669090270996
Epoch: 10, Steps: 4 | Train Loss: 0.767 Vali Loss: 1.664 Vali Acc: 0.260 Test Loss: 1.664 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9083068370819092
Epoch: 11, Steps: 4 | Train Loss: 0.680 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 12 cost time: 1.744455337524414
Epoch: 12, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.656 Vali Acc: 0.260 Test Loss: 1.656 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8051612377166748
Epoch: 13, Steps: 4 | Train Loss: 0.592 Vali Loss: 1.678 Vali Acc: 0.200 Test Loss: 1.678 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7734088897705078
Epoch: 14, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.707 Vali Acc: 0.240 Test Loss: 1.707 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9212687015533447
Epoch: 15, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.755 Vali Acc: 0.260 Test Loss: 1.755 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9210784435272217
Epoch: 16, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.766 Vali Acc: 0.320 Test Loss: 1.766 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319982).  Saving model ...
Epoch: 17 cost time: 1.866295576095581
Epoch: 17, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.775 Vali Acc: 0.320 Test Loss: 1.775 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7043697834014893
Epoch: 18, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.818 Vali Acc: 0.300 Test Loss: 1.818 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.015413522720337
Epoch: 19, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.851 Vali Acc: 0.260 Test Loss: 1.851 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.877500295639038
Epoch: 20, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.911 Vali Acc: 0.240 Test Loss: 1.911 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8345439434051514
Epoch: 21, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.937 Vali Acc: 0.240 Test Loss: 1.937 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7594635486602783
Epoch: 22, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.954 Vali Acc: 0.280 Test Loss: 1.954 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9615964889526367
Epoch: 23, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.956 Vali Acc: 0.300 Test Loss: 1.956 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8119428157806396
Epoch: 24, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.992 Vali Acc: 0.300 Test Loss: 1.992 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9698848724365234
Epoch: 25, Steps: 4 | Train Loss: 0.033 Vali Loss: 2.065 Vali Acc: 0.260 Test Loss: 2.065 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.960198163986206
Epoch: 26, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.084 Vali Acc: 0.260 Test Loss: 2.084 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.387990951538086
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.808807373046875
Epoch: 2, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.706 Vali Acc: 0.160 Test Loss: 1.706 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9900085926055908
Epoch: 3, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.699 Vali Acc: 0.160 Test Loss: 1.699 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7633304595947266
Epoch: 4, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.689 Vali Acc: 0.200 Test Loss: 1.689 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 1.9345176219940186
Epoch: 5, Steps: 4 | Train Loss: 1.425 Vali Loss: 1.676 Vali Acc: 0.180 Test Loss: 1.676 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9990944862365723
Epoch: 6, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.677 Vali Acc: 0.200 Test Loss: 1.677 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 1.809488296508789
Epoch: 7, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.675 Vali Acc: 0.180 Test Loss: 1.675 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1570205688476562
Epoch: 8, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.680 Vali Acc: 0.200 Test Loss: 1.680 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9374985694885254
Epoch: 9, Steps: 4 | Train Loss: 1.117 Vali Loss: 1.686 Vali Acc: 0.200 Test Loss: 1.686 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8338148593902588
Epoch: 10, Steps: 4 | Train Loss: 1.172 Vali Loss: 1.695 Vali Acc: 0.180 Test Loss: 1.695 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8594741821289062
Epoch: 11, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.678 Vali Acc: 0.200 Test Loss: 1.678 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7740824222564697
Epoch: 12, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.663 Vali Acc: 0.160 Test Loss: 1.663 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8150968551635742
Epoch: 13, Steps: 4 | Train Loss: 0.816 Vali Loss: 1.666 Vali Acc: 0.200 Test Loss: 1.666 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 14 cost time: 1.947526454925537
Epoch: 14, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.669 Vali Acc: 0.160 Test Loss: 1.669 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.822509527206421
Epoch: 15, Steps: 4 | Train Loss: 0.773 Vali Loss: 1.672 Vali Acc: 0.140 Test Loss: 1.672 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.157313346862793
Epoch: 16, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.660 Vali Acc: 0.180 Test Loss: 1.660 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7479538917541504
Epoch: 17, Steps: 4 | Train Loss: 0.496 Vali Loss: 1.662 Vali Acc: 0.160 Test Loss: 1.662 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8834161758422852
Epoch: 18, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.668 Vali Acc: 0.160 Test Loss: 1.668 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.990774393081665
Epoch: 19, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.648 Vali Acc: 0.180 Test Loss: 1.648 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.885249137878418
Epoch: 20, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.650 Vali Acc: 0.180 Test Loss: 1.650 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0195610523223877
Epoch: 21, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.662 Vali Acc: 0.200 Test Loss: 1.662 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 22 cost time: 1.7321135997772217
Epoch: 22, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.673 Vali Acc: 0.240 Test Loss: 1.673 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239983).  Saving model ...
Epoch: 23 cost time: 1.8388569355010986
Epoch: 23, Steps: 4 | Train Loss: 0.235 Vali Loss: 1.671 Vali Acc: 0.240 Test Loss: 1.671 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 24 cost time: 1.6861708164215088
Epoch: 24, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.680 Vali Acc: 0.220 Test Loss: 1.680 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0025761127471924
Epoch: 25, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.694 Vali Acc: 0.220 Test Loss: 1.694 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8731091022491455
Epoch: 26, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.670 Vali Acc: 0.260 Test Loss: 1.670 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 27 cost time: 1.8292722702026367
Epoch: 27, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.656 Vali Acc: 0.240 Test Loss: 1.656 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8692231178283691
Epoch: 28, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.633 Vali Acc: 0.220 Test Loss: 1.633 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7646536827087402
Epoch: 29, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8430516719818115
Epoch: 30, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.644 Vali Acc: 0.240 Test Loss: 1.644 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8321175575256348
Epoch: 31, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.653 Vali Acc: 0.260 Test Loss: 1.653 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 32 cost time: 1.8026883602142334
Epoch: 32, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.666 Vali Acc: 0.240 Test Loss: 1.666 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8388993740081787
Epoch: 33, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.686 Vali Acc: 0.240 Test Loss: 1.686 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8396053314208984
Epoch: 34, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.702 Vali Acc: 0.280 Test Loss: 1.702 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 35 cost time: 1.7012085914611816
Epoch: 35, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.716 Vali Acc: 0.280 Test Loss: 1.716 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9204685688018799
Epoch: 36, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.693 Vali Acc: 0.260 Test Loss: 1.693 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.787214756011963
Epoch: 37, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.675 Vali Acc: 0.240 Test Loss: 1.675 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0900228023529053
Epoch: 38, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.659 Vali Acc: 0.220 Test Loss: 1.659 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.0875518321990967
Epoch: 39, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.661 Vali Acc: 0.220 Test Loss: 1.661 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7502925395965576
Epoch: 40, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.671 Vali Acc: 0.220 Test Loss: 1.671 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.0428433418273926
Epoch: 41, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.653 Vali Acc: 0.200 Test Loss: 1.653 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.7876708507537842
Epoch: 42, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.647 Vali Acc: 0.260 Test Loss: 1.647 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9806253910064697
Epoch: 43, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.658 Vali Acc: 0.260 Test Loss: 1.658 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.3442676067352295
Epoch: 44, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.677 Vali Acc: 0.260 Test Loss: 1.677 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6097092628479004
Epoch: 1, Steps: 4 | Train Loss: 1.710 Vali Loss: 1.693 Vali Acc: 0.260 Test Loss: 1.693 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.7812209129333496
Epoch: 2, Steps: 4 | Train Loss: 1.759 Vali Loss: 1.689 Vali Acc: 0.220 Test Loss: 1.689 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.115868091583252
Epoch: 3, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.684 Vali Acc: 0.220 Test Loss: 1.684 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8641884326934814
Epoch: 4, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.681 Vali Acc: 0.220 Test Loss: 1.681 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8713252544403076
Epoch: 5, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.675 Vali Acc: 0.200 Test Loss: 1.675 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0533668994903564
Epoch: 6, Steps: 4 | Train Loss: 1.490 Vali Loss: 1.683 Vali Acc: 0.220 Test Loss: 1.683 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.862964391708374
Epoch: 7, Steps: 4 | Train Loss: 1.375 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.265254020690918
Epoch: 8, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.686 Vali Acc: 0.220 Test Loss: 1.686 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8232858180999756
Epoch: 9, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.688 Vali Acc: 0.200 Test Loss: 1.688 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8610432147979736
Epoch: 10, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.699 Vali Acc: 0.180 Test Loss: 1.699 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8637893199920654
Epoch: 11, Steps: 4 | Train Loss: 1.028 Vali Loss: 1.681 Vali Acc: 0.180 Test Loss: 1.681 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 608069
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.59147310256958
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.720 Vali Acc: 0.160 Test Loss: 1.720 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.8813955783843994
Epoch: 2, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.715 Vali Acc: 0.180 Test Loss: 1.715 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.763096570968628
Epoch: 3, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.717 Vali Acc: 0.220 Test Loss: 1.717 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.7368526458740234
Epoch: 4, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.734 Vali Acc: 0.240 Test Loss: 1.734 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.6883926391601562
Epoch: 5, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.729 Vali Acc: 0.240 Test Loss: 1.729 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 1.8033442497253418
Epoch: 6, Steps: 4 | Train Loss: 1.118 Vali Loss: 1.737 Vali Acc: 0.240 Test Loss: 1.737 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.824256181716919
Epoch: 7, Steps: 4 | Train Loss: 0.958 Vali Loss: 1.722 Vali Acc: 0.280 Test Loss: 1.722 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 8 cost time: 1.9052691459655762
Epoch: 8, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.712 Vali Acc: 0.260 Test Loss: 1.712 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8251194953918457
Epoch: 9, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.713 Vali Acc: 0.260 Test Loss: 1.713 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.836531162261963
Epoch: 10, Steps: 4 | Train Loss: 0.592 Vali Loss: 1.735 Vali Acc: 0.280 Test Loss: 1.735 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8656091690063477
Epoch: 11, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.753 Vali Acc: 0.280 Test Loss: 1.753 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8091695308685303
Epoch: 12, Steps: 4 | Train Loss: 0.494 Vali Loss: 1.758 Vali Acc: 0.280 Test Loss: 1.758 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6811497211456299
Epoch: 13, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.741 Vali Acc: 0.300 Test Loss: 1.741 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 14 cost time: 1.7127339839935303
Epoch: 14, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.718 Vali Acc: 0.240 Test Loss: 1.718 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7760670185089111
Epoch: 15, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.741 Vali Acc: 0.260 Test Loss: 1.741 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7204196453094482
Epoch: 16, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.795 Vali Acc: 0.280 Test Loss: 1.795 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6369845867156982
Epoch: 17, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.855 Vali Acc: 0.280 Test Loss: 1.855 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8602538108825684
Epoch: 18, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.868 Vali Acc: 0.320 Test Loss: 1.868 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319981).  Saving model ...
Epoch: 19 cost time: 1.8513615131378174
Epoch: 19, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.890 Vali Acc: 0.320 Test Loss: 1.890 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7509503364562988
Epoch: 20, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.910 Vali Acc: 0.340 Test Loss: 1.910 Test Acc: 0.340
Validation loss decreased (-0.319981 --> -0.339981).  Saving model ...
Epoch: 21 cost time: 2.0329127311706543
Epoch: 21, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.966 Vali Acc: 0.340 Test Loss: 1.966 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8170897960662842
Epoch: 22, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.052 Vali Acc: 0.340 Test Loss: 2.052 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8456506729125977
Epoch: 23, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.110 Vali Acc: 0.300 Test Loss: 2.110 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7698533535003662
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.110 Vali Acc: 0.320 Test Loss: 2.110 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9482266902923584
Epoch: 25, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.085 Vali Acc: 0.340 Test Loss: 2.085 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0434117317199707
Epoch: 26, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.051 Vali Acc: 0.340 Test Loss: 2.051 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7738776206970215
Epoch: 27, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.046 Vali Acc: 0.340 Test Loss: 2.046 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7494804859161377
Epoch: 28, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.049 Vali Acc: 0.340 Test Loss: 2.049 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.003000497817993
Epoch: 29, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.069 Vali Acc: 0.340 Test Loss: 2.069 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7103989124298096
Epoch: 30, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.092 Vali Acc: 0.320 Test Loss: 2.092 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.654902219772339
Epoch: 1, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.707 Vali Acc: 0.220 Test Loss: 1.707 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 2.0658795833587646
Epoch: 2, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.700 Vali Acc: 0.180 Test Loss: 1.700 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0048582553863525
Epoch: 3, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.700 Vali Acc: 0.220 Test Loss: 1.700 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.8962602615356445
Epoch: 4, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.716 Vali Acc: 0.220 Test Loss: 1.716 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9831254482269287
Epoch: 5, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.710 Vali Acc: 0.240 Test Loss: 1.710 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 1.898240089416504
Epoch: 6, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.718 Vali Acc: 0.200 Test Loss: 1.718 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9773311614990234
Epoch: 7, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.701 Vali Acc: 0.220 Test Loss: 1.701 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9730923175811768
Epoch: 8, Steps: 4 | Train Loss: 0.889 Vali Loss: 1.691 Vali Acc: 0.200 Test Loss: 1.691 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.841726541519165
Epoch: 9, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.688 Vali Acc: 0.200 Test Loss: 1.688 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.907090187072754
Epoch: 10, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.706 Vali Acc: 0.220 Test Loss: 1.706 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8685758113861084
Epoch: 11, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.721 Vali Acc: 0.240 Test Loss: 1.721 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.830618143081665
Epoch: 12, Steps: 4 | Train Loss: 0.511 Vali Loss: 1.733 Vali Acc: 0.220 Test Loss: 1.733 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8014428615570068
Epoch: 13, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.721 Vali Acc: 0.220 Test Loss: 1.721 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9398655891418457
Epoch: 14, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.695 Vali Acc: 0.260 Test Loss: 1.695 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 15 cost time: 1.815192461013794
Epoch: 15, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.712 Vali Acc: 0.260 Test Loss: 1.712 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.847052812576294
Epoch: 16, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.764 Vali Acc: 0.240 Test Loss: 1.764 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9037952423095703
Epoch: 17, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.821 Vali Acc: 0.220 Test Loss: 1.821 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8901431560516357
Epoch: 18, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.822 Vali Acc: 0.220 Test Loss: 1.822 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8813576698303223
Epoch: 19, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.818 Vali Acc: 0.220 Test Loss: 1.818 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9231154918670654
Epoch: 20, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.813 Vali Acc: 0.240 Test Loss: 1.813 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7585339546203613
Epoch: 21, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.850 Vali Acc: 0.260 Test Loss: 1.850 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.822378158569336
Epoch: 22, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.920 Vali Acc: 0.220 Test Loss: 1.920 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8880386352539062
Epoch: 23, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.968 Vali Acc: 0.220 Test Loss: 1.968 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0039260387420654
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.958 Vali Acc: 0.240 Test Loss: 1.958 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3092663288116455
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.7516252994537354
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.661099910736084
Epoch: 3, Steps: 4 | Train Loss: 1.488 Vali Loss: 1.660 Vali Acc: 0.220 Test Loss: 1.660 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.761704921722412
Epoch: 4, Steps: 4 | Train Loss: 1.366 Vali Loss: 1.674 Vali Acc: 0.280 Test Loss: 1.674 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 1.7485401630401611
Epoch: 5, Steps: 4 | Train Loss: 1.275 Vali Loss: 1.671 Vali Acc: 0.240 Test Loss: 1.671 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9788463115692139
Epoch: 6, Steps: 4 | Train Loss: 1.118 Vali Loss: 1.682 Vali Acc: 0.220 Test Loss: 1.682 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.703848123550415
Epoch: 7, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.673 Vali Acc: 0.200 Test Loss: 1.673 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.025388717651367
Epoch: 8, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.670 Vali Acc: 0.220 Test Loss: 1.670 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0042717456817627
Epoch: 9, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6489734649658203
Epoch: 10, Steps: 4 | Train Loss: 0.602 Vali Loss: 1.702 Vali Acc: 0.220 Test Loss: 1.702 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9220924377441406
Epoch: 11, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.729 Vali Acc: 0.220 Test Loss: 1.729 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6335029602050781
Epoch: 12, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.748 Vali Acc: 0.240 Test Loss: 1.748 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.748579978942871
Epoch: 13, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.741 Vali Acc: 0.220 Test Loss: 1.741 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.817836046218872
Epoch: 14, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.722 Vali Acc: 0.240 Test Loss: 1.722 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4636905193328857
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.680 Vali Acc: 0.160 Test Loss: 1.680 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.8275048732757568
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.667 Vali Acc: 0.160 Test Loss: 1.667 Test Acc: 0.160
Validation loss decreased (-0.159983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.736631155014038
Epoch: 3, Steps: 4 | Train Loss: 1.459 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
Validation loss decreased (-0.159983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.8926441669464111
Epoch: 4, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.667 Vali Acc: 0.180 Test Loss: 1.667 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8260202407836914
Epoch: 5, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.661 Vali Acc: 0.160 Test Loss: 1.661 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9881994724273682
Epoch: 6, Steps: 4 | Train Loss: 1.095 Vali Loss: 1.670 Vali Acc: 0.180 Test Loss: 1.670 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.103938579559326
Epoch: 7, Steps: 4 | Train Loss: 1.002 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 8 cost time: 2.014070987701416
Epoch: 8, Steps: 4 | Train Loss: 0.843 Vali Loss: 1.649 Vali Acc: 0.160 Test Loss: 1.649 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9270954132080078
Epoch: 9, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.655 Vali Acc: 0.160 Test Loss: 1.655 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7683813571929932
Epoch: 10, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.674 Vali Acc: 0.180 Test Loss: 1.674 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9365885257720947
Epoch: 11, Steps: 4 | Train Loss: 0.454 Vali Loss: 1.689 Vali Acc: 0.200 Test Loss: 1.689 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7355389595031738
Epoch: 12, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.690 Vali Acc: 0.220 Test Loss: 1.690 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6326615810394287
Epoch: 13, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.675 Vali Acc: 0.220 Test Loss: 1.675 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8620786666870117
Epoch: 14, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.651 Vali Acc: 0.260 Test Loss: 1.651 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 15 cost time: 1.822737455368042
Epoch: 15, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.665 Vali Acc: 0.240 Test Loss: 1.665 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.923597812652588
Epoch: 16, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.709 Vali Acc: 0.220 Test Loss: 1.709 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8583707809448242
Epoch: 17, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.763 Vali Acc: 0.200 Test Loss: 1.763 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8383979797363281
Epoch: 18, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.776 Vali Acc: 0.280 Test Loss: 1.776 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 19 cost time: 1.7204668521881104
Epoch: 19, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.786 Vali Acc: 0.280 Test Loss: 1.786 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7761940956115723
Epoch: 20, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.793 Vali Acc: 0.300 Test Loss: 1.793 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299982).  Saving model ...
Epoch: 21 cost time: 1.7455854415893555
Epoch: 21, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.836 Vali Acc: 0.300 Test Loss: 1.836 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8566851615905762
Epoch: 22, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.938 Vali Acc: 0.240 Test Loss: 1.938 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.734187126159668
Epoch: 23, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.019 Vali Acc: 0.260 Test Loss: 2.019 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7050812244415283
Epoch: 24, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.031 Vali Acc: 0.260 Test Loss: 2.031 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.735410451889038
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.991 Vali Acc: 0.260 Test Loss: 1.991 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6952457427978516
Epoch: 26, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.917 Vali Acc: 0.280 Test Loss: 1.917 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8482508659362793
Epoch: 27, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.878 Vali Acc: 0.280 Test Loss: 1.878 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.806854486465454
Epoch: 28, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.863 Vali Acc: 0.260 Test Loss: 1.863 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8061773777008057
Epoch: 29, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.872 Vali Acc: 0.260 Test Loss: 1.872 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6794395446777344
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.887 Vali Acc: 0.260 Test Loss: 1.887 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6159708499908447
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.747 Vali Acc: 0.160 Test Loss: 1.747 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.8045177459716797
Epoch: 2, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.717 Vali Acc: 0.160 Test Loss: 1.717 Test Acc: 0.160
Validation loss decreased (-0.159983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.8481841087341309
Epoch: 3, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.694 Vali Acc: 0.220 Test Loss: 1.694 Test Acc: 0.220
Validation loss decreased (-0.159983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 2.032191038131714
Epoch: 4, Steps: 4 | Train Loss: 1.376 Vali Loss: 1.694 Vali Acc: 0.220 Test Loss: 1.694 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 1.850100040435791
Epoch: 5, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.689 Vali Acc: 0.180 Test Loss: 1.689 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8850691318511963
Epoch: 6, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.702 Vali Acc: 0.180 Test Loss: 1.702 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6839313507080078
Epoch: 7, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.707 Vali Acc: 0.200 Test Loss: 1.707 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.933258056640625
Epoch: 8, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.710 Vali Acc: 0.160 Test Loss: 1.710 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1292660236358643
Epoch: 9, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.726 Vali Acc: 0.160 Test Loss: 1.726 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.998854160308838
Epoch: 10, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.749 Vali Acc: 0.160 Test Loss: 1.749 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.59800124168396
Epoch: 11, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.776 Vali Acc: 0.160 Test Loss: 1.776 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8685314655303955
Epoch: 12, Steps: 4 | Train Loss: 0.443 Vali Loss: 1.796 Vali Acc: 0.180 Test Loss: 1.796 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8947968482971191
Epoch: 13, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.813 Vali Acc: 0.160 Test Loss: 1.813 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9578828811645508
Epoch: 14, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.823 Vali Acc: 0.140 Test Loss: 1.823 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6018731594085693
Epoch: 1, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.663 Vali Acc: 0.260 Test Loss: 1.663 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.8740482330322266
Epoch: 2, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.653 Vali Acc: 0.240 Test Loss: 1.653 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.780569076538086
Epoch: 3, Steps: 4 | Train Loss: 1.432 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.903921127319336
Epoch: 4, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.150815486907959
Epoch: 5, Steps: 4 | Train Loss: 1.251 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8815174102783203
Epoch: 6, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.039167881011963
Epoch: 7, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.652 Vali Acc: 0.220 Test Loss: 1.652 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.879415512084961
Epoch: 8, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.647 Vali Acc: 0.280 Test Loss: 1.647 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279984).  Saving model ...
Epoch: 9 cost time: 1.7340424060821533
Epoch: 9, Steps: 4 | Train Loss: 0.681 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9174964427947998
Epoch: 10, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8593947887420654
Epoch: 11, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.688 Vali Acc: 0.260 Test Loss: 1.688 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7657947540283203
Epoch: 12, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.688 Vali Acc: 0.340 Test Loss: 1.688 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339983).  Saving model ...
Epoch: 13 cost time: 1.9159207344055176
Epoch: 13, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.690 Vali Acc: 0.340 Test Loss: 1.690 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9159557819366455
Epoch: 14, Steps: 4 | Train Loss: 0.264 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0098330974578857
Epoch: 15, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.725 Vali Acc: 0.340 Test Loss: 1.725 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0736637115478516
Epoch: 16, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.777 Vali Acc: 0.320 Test Loss: 1.777 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.042534828186035
Epoch: 17, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.826 Vali Acc: 0.260 Test Loss: 1.826 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9948077201843262
Epoch: 18, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.842 Vali Acc: 0.240 Test Loss: 1.842 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0399107933044434
Epoch: 19, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.853 Vali Acc: 0.280 Test Loss: 1.853 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9521193504333496
Epoch: 20, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.871 Vali Acc: 0.280 Test Loss: 1.871 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.856886863708496
Epoch: 21, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.931 Vali Acc: 0.280 Test Loss: 1.931 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8929591178894043
Epoch: 22, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.017 Vali Acc: 0.260 Test Loss: 2.017 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5137035846710205
Epoch: 1, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.657 Vali Acc: 0.160 Test Loss: 1.657 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.6909663677215576
Epoch: 2, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.643 Vali Acc: 0.180 Test Loss: 1.643 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.7400648593902588
Epoch: 3, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.668574571609497
Epoch: 4, Steps: 4 | Train Loss: 1.358 Vali Loss: 1.642 Vali Acc: 0.220 Test Loss: 1.642 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.7021403312683105
Epoch: 5, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.634 Vali Acc: 0.200 Test Loss: 1.634 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7790064811706543
Epoch: 6, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 7 cost time: 1.6505653858184814
Epoch: 7, Steps: 4 | Train Loss: 1.002 Vali Loss: 1.629 Vali Acc: 0.220 Test Loss: 1.629 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 8 cost time: 1.818732738494873
Epoch: 8, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.624 Vali Acc: 0.220 Test Loss: 1.624 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 9 cost time: 1.8036952018737793
Epoch: 9, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.631 Vali Acc: 0.220 Test Loss: 1.631 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.800194263458252
Epoch: 10, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.646 Vali Acc: 0.200 Test Loss: 1.646 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8013386726379395
Epoch: 11, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9156014919281006
Epoch: 12, Steps: 4 | Train Loss: 0.468 Vali Loss: 1.677 Vali Acc: 0.220 Test Loss: 1.677 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7647490501403809
Epoch: 13, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.680 Vali Acc: 0.220 Test Loss: 1.680 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8023707866668701
Epoch: 14, Steps: 4 | Train Loss: 0.299 Vali Loss: 1.680 Vali Acc: 0.260 Test Loss: 1.680 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 15 cost time: 1.7425537109375
Epoch: 15, Steps: 4 | Train Loss: 0.264 Vali Loss: 1.710 Vali Acc: 0.260 Test Loss: 1.710 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7647626399993896
Epoch: 16, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.750 Vali Acc: 0.260 Test Loss: 1.750 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7734391689300537
Epoch: 17, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.811 Vali Acc: 0.200 Test Loss: 1.811 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7324295043945312
Epoch: 18, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.847 Vali Acc: 0.200 Test Loss: 1.847 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7744712829589844
Epoch: 19, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.857 Vali Acc: 0.220 Test Loss: 1.857 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9528474807739258
Epoch: 20, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.873 Vali Acc: 0.240 Test Loss: 1.873 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8356478214263916
Epoch: 21, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.949 Vali Acc: 0.240 Test Loss: 1.949 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0783379077911377
Epoch: 22, Steps: 4 | Train Loss: 0.037 Vali Loss: 2.032 Vali Acc: 0.240 Test Loss: 2.032 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9806911945343018
Epoch: 23, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.070 Vali Acc: 0.240 Test Loss: 2.070 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8775410652160645
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.046 Vali Acc: 0.240 Test Loss: 2.046 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3027703762054443
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.637 Vali Acc: 0.160 Test Loss: 1.637 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.7052574157714844
Epoch: 2, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.8276593685150146
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.621 Vali Acc: 0.180 Test Loss: 1.621 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.8412470817565918
Epoch: 4, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.626 Vali Acc: 0.200 Test Loss: 1.626 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 5 cost time: 1.8379154205322266
Epoch: 5, Steps: 4 | Train Loss: 1.359 Vali Loss: 1.616 Vali Acc: 0.200 Test Loss: 1.616 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 6 cost time: 1.7239501476287842
Epoch: 6, Steps: 4 | Train Loss: 1.253 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.7550091743469238
Epoch: 7, Steps: 4 | Train Loss: 1.124 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.817169427871704
Epoch: 8, Steps: 4 | Train Loss: 0.976 Vali Loss: 1.598 Vali Acc: 0.200 Test Loss: 1.598 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8737082481384277
Epoch: 9, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.605 Vali Acc: 0.200 Test Loss: 1.605 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8401460647583008
Epoch: 10, Steps: 4 | Train Loss: 0.755 Vali Loss: 1.608 Vali Acc: 0.240 Test Loss: 1.608 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 11 cost time: 1.8384466171264648
Epoch: 11, Steps: 4 | Train Loss: 0.661 Vali Loss: 1.620 Vali Acc: 0.220 Test Loss: 1.620 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7734875679016113
Epoch: 12, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.630 Vali Acc: 0.240 Test Loss: 1.630 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7068407535552979
Epoch: 13, Steps: 4 | Train Loss: 0.433 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8172717094421387
Epoch: 14, Steps: 4 | Train Loss: 0.428 Vali Loss: 1.664 Vali Acc: 0.220 Test Loss: 1.664 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8420629501342773
Epoch: 15, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.670 Vali Acc: 0.200 Test Loss: 1.670 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.902158498764038
Epoch: 16, Steps: 4 | Train Loss: 0.265 Vali Loss: 1.669 Vali Acc: 0.240 Test Loss: 1.669 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9388318061828613
Epoch: 17, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.701 Vali Acc: 0.260 Test Loss: 1.701 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 18 cost time: 1.7420446872711182
Epoch: 18, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.729 Vali Acc: 0.220 Test Loss: 1.729 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7124831676483154
Epoch: 19, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.760 Vali Acc: 0.220 Test Loss: 1.760 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8258707523345947
Epoch: 20, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.793 Vali Acc: 0.240 Test Loss: 1.793 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7940607070922852
Epoch: 21, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.841 Vali Acc: 0.260 Test Loss: 1.841 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7065858840942383
Epoch: 22, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.897 Vali Acc: 0.260 Test Loss: 1.897 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6630253791809082
Epoch: 23, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.945 Vali Acc: 0.220 Test Loss: 1.945 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8738820552825928
Epoch: 24, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.949 Vali Acc: 0.220 Test Loss: 1.949 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.842350959777832
Epoch: 25, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.916 Vali Acc: 0.220 Test Loss: 1.916 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.852217435836792
Epoch: 26, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.901 Vali Acc: 0.220 Test Loss: 1.901 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9076147079467773
Epoch: 27, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.914 Vali Acc: 0.260 Test Loss: 1.914 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.612802267074585
Epoch: 1, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.679 Vali Acc: 0.200 Test Loss: 1.679 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.0180227756500244
Epoch: 2, Steps: 4 | Train Loss: 1.630 Vali Loss: 1.672 Vali Acc: 0.180 Test Loss: 1.672 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9502463340759277
Epoch: 3, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.668 Vali Acc: 0.180 Test Loss: 1.668 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9431254863739014
Epoch: 4, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.675 Vali Acc: 0.200 Test Loss: 1.675 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 1.9447526931762695
Epoch: 5, Steps: 4 | Train Loss: 1.430 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 6 cost time: 2.1827380657196045
Epoch: 6, Steps: 4 | Train Loss: 1.355 Vali Loss: 1.672 Vali Acc: 0.200 Test Loss: 1.672 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9110150337219238
Epoch: 7, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.662 Vali Acc: 0.200 Test Loss: 1.662 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 8 cost time: 1.8856732845306396
Epoch: 8, Steps: 4 | Train Loss: 1.191 Vali Loss: 1.654 Vali Acc: 0.220 Test Loss: 1.654 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 9 cost time: 2.0100510120391846
Epoch: 9, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 10 cost time: 2.21268367767334
Epoch: 10, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.639 Vali Acc: 0.260 Test Loss: 1.639 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 11 cost time: 2.2301650047302246
Epoch: 11, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.633 Vali Acc: 0.260 Test Loss: 1.633 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 12 cost time: 1.8771147727966309
Epoch: 12, Steps: 4 | Train Loss: 0.900 Vali Loss: 1.629 Vali Acc: 0.240 Test Loss: 1.629 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8170421123504639
Epoch: 13, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.642 Vali Acc: 0.220 Test Loss: 1.642 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4215664863586426
Epoch: 14, Steps: 4 | Train Loss: 0.845 Vali Loss: 1.644 Vali Acc: 0.220 Test Loss: 1.644 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.381519079208374
Epoch: 15, Steps: 4 | Train Loss: 0.725 Vali Loss: 1.642 Vali Acc: 0.260 Test Loss: 1.642 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.213407039642334
Epoch: 16, Steps: 4 | Train Loss: 0.566 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.869797706604004
Epoch: 17, Steps: 4 | Train Loss: 0.522 Vali Loss: 1.646 Vali Acc: 0.220 Test Loss: 1.646 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.117764949798584
Epoch: 18, Steps: 4 | Train Loss: 0.427 Vali Loss: 1.654 Vali Acc: 0.220 Test Loss: 1.654 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.4325406551361084
Epoch: 19, Steps: 4 | Train Loss: 0.712 Vali Loss: 1.675 Vali Acc: 0.220 Test Loss: 1.675 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2651169300079346
Epoch: 20, Steps: 4 | Train Loss: 0.424 Vali Loss: 1.664 Vali Acc: 0.260 Test Loss: 1.664 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2646422386169434
Epoch: 21, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.663 Vali Acc: 0.240 Test Loss: 1.663 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5227439403533936
Epoch: 1, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.734 Vali Acc: 0.180 Test Loss: 1.734 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.0786590576171875
Epoch: 2, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.727 Vali Acc: 0.160 Test Loss: 1.727 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3570961952209473
Epoch: 3, Steps: 4 | Train Loss: 1.711 Vali Loss: 1.723 Vali Acc: 0.180 Test Loss: 1.723 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179983).  Saving model ...
Epoch: 4 cost time: 1.9661483764648438
Epoch: 4, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.732 Vali Acc: 0.180 Test Loss: 1.732 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2136037349700928
Epoch: 5, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.728 Vali Acc: 0.200 Test Loss: 1.728 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 6 cost time: 1.9451630115509033
Epoch: 6, Steps: 4 | Train Loss: 1.252 Vali Loss: 1.735 Vali Acc: 0.180 Test Loss: 1.735 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0518765449523926
Epoch: 7, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.727 Vali Acc: 0.180 Test Loss: 1.727 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.02502703666687
Epoch: 8, Steps: 4 | Train Loss: 1.180 Vali Loss: 1.719 Vali Acc: 0.160 Test Loss: 1.719 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9697778224945068
Epoch: 9, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.716 Vali Acc: 0.140 Test Loss: 1.716 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1505343914031982
Epoch: 10, Steps: 4 | Train Loss: 1.019 Vali Loss: 1.708 Vali Acc: 0.180 Test Loss: 1.708 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1702980995178223
Epoch: 11, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.703 Vali Acc: 0.180 Test Loss: 1.703 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1820449829101562
Epoch: 12, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.704 Vali Acc: 0.200 Test Loss: 1.704 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 13 cost time: 2.158064365386963
Epoch: 13, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.710 Vali Acc: 0.180 Test Loss: 1.710 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.28595232963562
Epoch: 14, Steps: 4 | Train Loss: 0.690 Vali Loss: 1.700 Vali Acc: 0.160 Test Loss: 1.700 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1025547981262207
Epoch: 15, Steps: 4 | Train Loss: 0.711 Vali Loss: 1.696 Vali Acc: 0.160 Test Loss: 1.696 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.009211778640747
Epoch: 16, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.689 Vali Acc: 0.180 Test Loss: 1.689 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.252096652984619
Epoch: 17, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.156273126602173
Epoch: 18, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.716 Vali Acc: 0.160 Test Loss: 1.716 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1767945289611816
Epoch: 19, Steps: 4 | Train Loss: 0.586 Vali Loss: 1.723 Vali Acc: 0.140 Test Loss: 1.723 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0951461791992188
Epoch: 20, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.693 Vali Acc: 0.200 Test Loss: 1.693 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 21 cost time: 2.034478187561035
Epoch: 21, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.674 Vali Acc: 0.220 Test Loss: 1.674 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 22 cost time: 2.0691049098968506
Epoch: 22, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.672 Vali Acc: 0.220 Test Loss: 1.672 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 23 cost time: 2.0914838314056396
Epoch: 23, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.655 Vali Acc: 0.240 Test Loss: 1.655 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 24 cost time: 1.9721052646636963
Epoch: 24, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 25 cost time: 2.1115236282348633
Epoch: 25, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.600 Vali Acc: 0.240 Test Loss: 1.600 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 26 cost time: 2.2450110912323
Epoch: 26, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 27 cost time: 2.123126745223999
Epoch: 27, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.04421067237854
Epoch: 28, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.632 Vali Acc: 0.240 Test Loss: 1.632 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9141829013824463
Epoch: 29, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.656 Vali Acc: 0.240 Test Loss: 1.656 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.216078996658325
Epoch: 30, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8789877891540527
Epoch: 31, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.658 Vali Acc: 0.260 Test Loss: 1.658 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 32 cost time: 2.0665342807769775
Epoch: 32, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0505237579345703
Epoch: 33, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.667 Vali Acc: 0.260 Test Loss: 1.667 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8768582344055176
Epoch: 34, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.666 Vali Acc: 0.260 Test Loss: 1.666 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9292285442352295
Epoch: 35, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 36 cost time: 1.9598658084869385
Epoch: 36, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.645 Vali Acc: 0.240 Test Loss: 1.645 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8482260704040527
Epoch: 37, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.113112211227417
Epoch: 38, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9620845317840576
Epoch: 39, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.619 Vali Acc: 0.260 Test Loss: 1.619 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 40 cost time: 2.22194242477417
Epoch: 40, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.604 Vali Acc: 0.260 Test Loss: 1.604 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 41 cost time: 1.9388482570648193
Epoch: 41, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.604 Vali Acc: 0.240 Test Loss: 1.604 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.01035737991333
Epoch: 42, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.627 Vali Acc: 0.260 Test Loss: 1.627 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0455496311187744
Epoch: 43, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.642 Vali Acc: 0.240 Test Loss: 1.642 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.0463850498199463
Epoch: 44, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.1032824516296387
Epoch: 45, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.656 Vali Acc: 0.260 Test Loss: 1.656 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.00138258934021
Epoch: 46, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.641 Vali Acc: 0.300 Test Loss: 1.641 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 47 cost time: 2.193093776702881
Epoch: 47, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.631 Vali Acc: 0.300 Test Loss: 1.631 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 48 cost time: 2.020968198776245
Epoch: 48, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.623 Vali Acc: 0.300 Test Loss: 1.623 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 49 cost time: 1.8574833869934082
Epoch: 49, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.621 Vali Acc: 0.300 Test Loss: 1.621 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 50 cost time: 2.143841505050659
Epoch: 50, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.624 Vali Acc: 0.260 Test Loss: 1.624 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9887194633483887
Epoch: 51, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.628 Vali Acc: 0.260 Test Loss: 1.628 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.0321571826934814
Epoch: 52, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.632 Vali Acc: 0.260 Test Loss: 1.632 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.0013153553009033
Epoch: 53, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.636 Vali Acc: 0.260 Test Loss: 1.636 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.0918264389038086
Epoch: 54, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.637 Vali Acc: 0.280 Test Loss: 1.637 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.2566633224487305
Epoch: 55, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.634 Vali Acc: 0.280 Test Loss: 1.634 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.8373892307281494
Epoch: 56, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.633 Vali Acc: 0.280 Test Loss: 1.633 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.9848136901855469
Epoch: 57, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.636 Vali Acc: 0.280 Test Loss: 1.636 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 2.0399301052093506
Epoch: 58, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.9882583618164062
Epoch: 59, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 411461
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5491931438446045
Epoch: 1, Steps: 4 | Train Loss: 1.740 Vali Loss: 1.687 Vali Acc: 0.300 Test Loss: 1.687 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.833643913269043
Epoch: 2, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2062950134277344
Epoch: 3, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8771271705627441
Epoch: 4, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.626 Vali Acc: 0.280 Test Loss: 1.626 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1613218784332275
Epoch: 5, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.625 Vali Acc: 0.340 Test Loss: 1.625 Test Acc: 0.340
Validation loss decreased (-0.299983 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.8801908493041992
Epoch: 6, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.632 Vali Acc: 0.340 Test Loss: 1.632 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9292693138122559
Epoch: 7, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.635 Vali Acc: 0.380 Test Loss: 1.635 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 1.8265104293823242
Epoch: 8, Steps: 4 | Train Loss: 0.858 Vali Loss: 1.636 Vali Acc: 0.340 Test Loss: 1.636 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7181193828582764
Epoch: 9, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.657 Vali Acc: 0.320 Test Loss: 1.657 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8219435214996338
Epoch: 10, Steps: 4 | Train Loss: 0.718 Vali Loss: 1.673 Vali Acc: 0.320 Test Loss: 1.673 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8681066036224365
Epoch: 11, Steps: 4 | Train Loss: 0.549 Vali Loss: 1.688 Vali Acc: 0.300 Test Loss: 1.688 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9184911251068115
Epoch: 12, Steps: 4 | Train Loss: 0.428 Vali Loss: 1.694 Vali Acc: 0.300 Test Loss: 1.694 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8802359104156494
Epoch: 13, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.672 Vali Acc: 0.300 Test Loss: 1.672 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6665575504302979
Epoch: 14, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.653 Vali Acc: 0.320 Test Loss: 1.653 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.900712490081787
Epoch: 15, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.673 Vali Acc: 0.320 Test Loss: 1.673 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.846653938293457
Epoch: 16, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.706 Vali Acc: 0.320 Test Loss: 1.706 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.042417287826538
Epoch: 17, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.746 Vali Acc: 0.300 Test Loss: 1.746 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6118595600128174
Epoch: 1, Steps: 4 | Train Loss: 1.744 Vali Loss: 1.726 Vali Acc: 0.180 Test Loss: 1.726 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.075108766555786
Epoch: 2, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.698 Vali Acc: 0.140 Test Loss: 1.698 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0183956623077393
Epoch: 3, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 2.019902467727661
Epoch: 4, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.662 Vali Acc: 0.240 Test Loss: 1.662 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.9342732429504395
Epoch: 5, Steps: 4 | Train Loss: 1.301 Vali Loss: 1.663 Vali Acc: 0.240 Test Loss: 1.663 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1978349685668945
Epoch: 6, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.671 Vali Acc: 0.260 Test Loss: 1.671 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 2.314613103866577
Epoch: 7, Steps: 4 | Train Loss: 1.042 Vali Loss: 1.673 Vali Acc: 0.280 Test Loss: 1.673 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 8 cost time: 2.163328170776367
Epoch: 8, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.673 Vali Acc: 0.340 Test Loss: 1.673 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339983).  Saving model ...
Epoch: 9 cost time: 2.0603253841400146
Epoch: 9, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.694 Vali Acc: 0.320 Test Loss: 1.694 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.251133918762207
Epoch: 10, Steps: 4 | Train Loss: 0.755 Vali Loss: 1.707 Vali Acc: 0.280 Test Loss: 1.707 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2323784828186035
Epoch: 11, Steps: 4 | Train Loss: 0.565 Vali Loss: 1.718 Vali Acc: 0.300 Test Loss: 1.718 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0791759490966797
Epoch: 12, Steps: 4 | Train Loss: 0.443 Vali Loss: 1.723 Vali Acc: 0.280 Test Loss: 1.723 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1368443965911865
Epoch: 13, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.707 Vali Acc: 0.280 Test Loss: 1.707 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.109776496887207
Epoch: 14, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.687 Vali Acc: 0.280 Test Loss: 1.687 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0767879486083984
Epoch: 15, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.705 Vali Acc: 0.260 Test Loss: 1.705 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0018837451934814
Epoch: 16, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.732 Vali Acc: 0.240 Test Loss: 1.732 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9915897846221924
Epoch: 17, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.766 Vali Acc: 0.260 Test Loss: 1.766 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9497253894805908
Epoch: 18, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.805 Vali Acc: 0.320 Test Loss: 1.805 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7630808353424072
Epoch: 1, Steps: 4 | Train Loss: 1.754 Vali Loss: 1.722 Vali Acc: 0.220 Test Loss: 1.722 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 2.0936646461486816
Epoch: 2, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.697 Vali Acc: 0.220 Test Loss: 1.697 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.824514627456665
Epoch: 3, Steps: 4 | Train Loss: 1.571 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.9113428592681885
Epoch: 4, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.662 Vali Acc: 0.260 Test Loss: 1.662 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.88789963722229
Epoch: 5, Steps: 4 | Train Loss: 1.313 Vali Loss: 1.662 Vali Acc: 0.260 Test Loss: 1.662 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0722711086273193
Epoch: 6, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.674 Vali Acc: 0.300 Test Loss: 1.674 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 1.937798261642456
Epoch: 7, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.681 Vali Acc: 0.340 Test Loss: 1.681 Test Acc: 0.340
Validation loss decreased (-0.299983 --> -0.339983).  Saving model ...
Epoch: 8 cost time: 2.1371448040008545
Epoch: 8, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.692 Vali Acc: 0.340 Test Loss: 1.692 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9908359050750732
Epoch: 9, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8267462253570557
Epoch: 10, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.742 Vali Acc: 0.300 Test Loss: 1.742 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8265204429626465
Epoch: 11, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.755 Vali Acc: 0.280 Test Loss: 1.755 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8836629390716553
Epoch: 12, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.765 Vali Acc: 0.320 Test Loss: 1.765 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.962386131286621
Epoch: 13, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.751 Vali Acc: 0.320 Test Loss: 1.751 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8607356548309326
Epoch: 14, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.726 Vali Acc: 0.380 Test Loss: 1.726 Test Acc: 0.380
Validation loss decreased (-0.339983 --> -0.379983).  Saving model ...
Epoch: 15 cost time: 1.781886100769043
Epoch: 15, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.743 Vali Acc: 0.400 Test Loss: 1.743 Test Acc: 0.400
Validation loss decreased (-0.379983 --> -0.399983).  Saving model ...
Epoch: 16 cost time: 2.0125620365142822
Epoch: 16, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.783 Vali Acc: 0.320 Test Loss: 1.783 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9496393203735352
Epoch: 17, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.840 Vali Acc: 0.340 Test Loss: 1.840 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9987385272979736
Epoch: 18, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.891 Vali Acc: 0.320 Test Loss: 1.891 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7965869903564453
Epoch: 19, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.914 Vali Acc: 0.320 Test Loss: 1.914 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.927884817123413
Epoch: 20, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.950 Vali Acc: 0.300 Test Loss: 1.950 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9786648750305176
Epoch: 21, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.980 Vali Acc: 0.280 Test Loss: 1.980 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7292990684509277
Epoch: 22, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.008 Vali Acc: 0.280 Test Loss: 2.008 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8826780319213867
Epoch: 23, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.016 Vali Acc: 0.320 Test Loss: 2.016 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8545405864715576
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.016 Vali Acc: 0.340 Test Loss: 2.016 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.94948148727417
Epoch: 25, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.008 Vali Acc: 0.340 Test Loss: 2.008 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.4
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5316967964172363
Epoch: 1, Steps: 4 | Train Loss: 1.770 Vali Loss: 1.699 Vali Acc: 0.200 Test Loss: 1.699 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.8386073112487793
Epoch: 2, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.675 Vali Acc: 0.200 Test Loss: 1.675 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.9400362968444824
Epoch: 3, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.657 Vali Acc: 0.260 Test Loss: 1.657 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.6642811298370361
Epoch: 4, Steps: 4 | Train Loss: 1.457 Vali Loss: 1.642 Vali Acc: 0.220 Test Loss: 1.642 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.939155101776123
Epoch: 5, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.638 Vali Acc: 0.260 Test Loss: 1.638 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.9288790225982666
Epoch: 6, Steps: 4 | Train Loss: 1.111 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.7600009441375732
Epoch: 7, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.931971549987793
Epoch: 8, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.641 Vali Acc: 0.300 Test Loss: 1.641 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 1.7179725170135498
Epoch: 9, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.658 Vali Acc: 0.240 Test Loss: 1.658 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.04435396194458
Epoch: 10, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.668 Vali Acc: 0.260 Test Loss: 1.668 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.030067205429077
Epoch: 11, Steps: 4 | Train Loss: 0.549 Vali Loss: 1.676 Vali Acc: 0.260 Test Loss: 1.676 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.036015033721924
Epoch: 12, Steps: 4 | Train Loss: 0.448 Vali Loss: 1.675 Vali Acc: 0.240 Test Loss: 1.675 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.99928879737854
Epoch: 13, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.657 Vali Acc: 0.320 Test Loss: 1.657 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 14 cost time: 2.004411220550537
Epoch: 14, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.633 Vali Acc: 0.340 Test Loss: 1.633 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339984).  Saving model ...
Epoch: 15 cost time: 1.8816936016082764
Epoch: 15, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.644 Vali Acc: 0.320 Test Loss: 1.644 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.786665439605713
Epoch: 16, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.678 Vali Acc: 0.320 Test Loss: 1.678 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7636663913726807
Epoch: 17, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.726 Vali Acc: 0.340 Test Loss: 1.726 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0480499267578125
Epoch: 18, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.771 Vali Acc: 0.360 Test Loss: 1.771 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359982).  Saving model ...
Epoch: 19 cost time: 1.8579277992248535
Epoch: 19, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.785 Vali Acc: 0.340 Test Loss: 1.785 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9424610137939453
Epoch: 20, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.802 Vali Acc: 0.340 Test Loss: 1.802 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8767421245574951
Epoch: 21, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.812 Vali Acc: 0.320 Test Loss: 1.812 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9037525653839111
Epoch: 22, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.833 Vali Acc: 0.320 Test Loss: 1.833 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7718026638031006
Epoch: 23, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.837 Vali Acc: 0.340 Test Loss: 1.837 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8567211627960205
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.832 Vali Acc: 0.340 Test Loss: 1.832 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8088531494140625
Epoch: 25, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.819 Vali Acc: 0.340 Test Loss: 1.819 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8339755535125732
Epoch: 26, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.812 Vali Acc: 0.360 Test Loss: 1.812 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.713778018951416
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.806 Vali Acc: 0.340 Test Loss: 1.806 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9430029392242432
Epoch: 28, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.819 Vali Acc: 0.340 Test Loss: 1.819 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.515251636505127
Epoch: 1, Steps: 4 | Train Loss: 1.817 Vali Loss: 1.609 Vali Acc: 0.240 Test Loss: 1.609 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.119220733642578
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.593 Vali Acc: 0.300 Test Loss: 1.593 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.8763091564178467
Epoch: 3, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.585 Vali Acc: 0.280 Test Loss: 1.585 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.103349447250366
Epoch: 4, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.578 Vali Acc: 0.280 Test Loss: 1.578 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9380712509155273
Epoch: 5, Steps: 4 | Train Loss: 1.338 Vali Loss: 1.580 Vali Acc: 0.280 Test Loss: 1.580 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8854331970214844
Epoch: 6, Steps: 4 | Train Loss: 1.156 Vali Loss: 1.591 Vali Acc: 0.280 Test Loss: 1.591 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8490464687347412
Epoch: 7, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.603 Vali Acc: 0.320 Test Loss: 1.603 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 8 cost time: 1.9880380630493164
Epoch: 8, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.619 Vali Acc: 0.300 Test Loss: 1.619 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.072169542312622
Epoch: 9, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.650 Vali Acc: 0.300 Test Loss: 1.650 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0670344829559326
Epoch: 10, Steps: 4 | Train Loss: 0.772 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8930845260620117
Epoch: 11, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.710 Vali Acc: 0.280 Test Loss: 1.710 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.028141975402832
Epoch: 12, Steps: 4 | Train Loss: 0.461 Vali Loss: 1.738 Vali Acc: 0.340 Test Loss: 1.738 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339983).  Saving model ...
Epoch: 13 cost time: 2.16208815574646
Epoch: 13, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.750 Vali Acc: 0.340 Test Loss: 1.750 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1906981468200684
Epoch: 14, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.748 Vali Acc: 0.320 Test Loss: 1.748 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4620108604431152
Epoch: 15, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.754 Vali Acc: 0.340 Test Loss: 1.754 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2095115184783936
Epoch: 16, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.784 Vali Acc: 0.320 Test Loss: 1.784 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9634487628936768
Epoch: 17, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.847 Vali Acc: 0.300 Test Loss: 1.847 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1242899894714355
Epoch: 18, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.915 Vali Acc: 0.300 Test Loss: 1.915 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.316678524017334
Epoch: 19, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.963 Vali Acc: 0.300 Test Loss: 1.963 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0934383869171143
Epoch: 20, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.016 Vali Acc: 0.280 Test Loss: 2.016 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4453461170196533
Epoch: 21, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.058 Vali Acc: 0.200 Test Loss: 2.058 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2110161781311035
Epoch: 22, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.094 Vali Acc: 0.200 Test Loss: 2.094 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6321442127227783
Epoch: 1, Steps: 4 | Train Loss: 1.788 Vali Loss: 1.660 Vali Acc: 0.180 Test Loss: 1.660 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.8417541980743408
Epoch: 2, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.642 Vali Acc: 0.160 Test Loss: 1.642 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9020476341247559
Epoch: 3, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.628 Vali Acc: 0.140 Test Loss: 1.628 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8619508743286133
Epoch: 4, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.7691490650177002
Epoch: 5, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.615 Vali Acc: 0.260 Test Loss: 1.615 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.9407901763916016
Epoch: 6, Steps: 4 | Train Loss: 1.215 Vali Loss: 1.620 Vali Acc: 0.220 Test Loss: 1.620 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7777891159057617
Epoch: 7, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8059558868408203
Epoch: 8, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7646493911743164
Epoch: 9, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.647 Vali Acc: 0.280 Test Loss: 1.647 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 10 cost time: 1.6352229118347168
Epoch: 10, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.667 Vali Acc: 0.260 Test Loss: 1.667 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7835772037506104
Epoch: 11, Steps: 4 | Train Loss: 0.615 Vali Loss: 1.684 Vali Acc: 0.280 Test Loss: 1.684 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9532830715179443
Epoch: 12, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8057243824005127
Epoch: 13, Steps: 4 | Train Loss: 0.321 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.900846004486084
Epoch: 14, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.685 Vali Acc: 0.240 Test Loss: 1.685 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9332716464996338
Epoch: 15, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.692 Vali Acc: 0.300 Test Loss: 1.692 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 16 cost time: 1.7940893173217773
Epoch: 16, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.725 Vali Acc: 0.280 Test Loss: 1.725 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0904412269592285
Epoch: 17, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.781 Vali Acc: 0.300 Test Loss: 1.781 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.756544589996338
Epoch: 18, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.820 Vali Acc: 0.300 Test Loss: 1.820 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8067207336425781
Epoch: 19, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.847 Vali Acc: 0.280 Test Loss: 1.847 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6954662799835205
Epoch: 20, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.887 Vali Acc: 0.260 Test Loss: 1.887 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.834984302520752
Epoch: 21, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.925 Vali Acc: 0.280 Test Loss: 1.925 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.90999174118042
Epoch: 22, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.972 Vali Acc: 0.280 Test Loss: 1.972 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7391769886016846
Epoch: 23, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.973 Vali Acc: 0.280 Test Loss: 1.973 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7889325618743896
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.959 Vali Acc: 0.300 Test Loss: 1.959 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.924262285232544
Epoch: 25, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.931 Vali Acc: 0.360 Test Loss: 1.931 Test Acc: 0.360
Validation loss decreased (-0.299983 --> -0.359981).  Saving model ...
Epoch: 26 cost time: 1.8853411674499512
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.903 Vali Acc: 0.340 Test Loss: 1.903 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.741140365600586
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.877 Vali Acc: 0.360 Test Loss: 1.877 Test Acc: 0.360
Validation loss decreased (-0.359981 --> -0.359981).  Saving model ...
Epoch: 28 cost time: 1.5907933712005615
Epoch: 28, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.891 Vali Acc: 0.380 Test Loss: 1.891 Test Acc: 0.380
Validation loss decreased (-0.359981 --> -0.379981).  Saving model ...
Epoch: 29 cost time: 1.7748818397521973
Epoch: 29, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.921 Vali Acc: 0.380 Test Loss: 1.921 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6722488403320312
Epoch: 30, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.957 Vali Acc: 0.380 Test Loss: 1.957 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8630359172821045
Epoch: 31, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.995 Vali Acc: 0.320 Test Loss: 1.995 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8208990097045898
Epoch: 32, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.027 Vali Acc: 0.320 Test Loss: 2.027 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8832893371582031
Epoch: 33, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.049 Vali Acc: 0.340 Test Loss: 2.049 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7690529823303223
Epoch: 34, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.063 Vali Acc: 0.320 Test Loss: 2.063 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7348148822784424
Epoch: 35, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.074 Vali Acc: 0.320 Test Loss: 2.074 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7235729694366455
Epoch: 36, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.083 Vali Acc: 0.320 Test Loss: 2.083 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.002103328704834
Epoch: 37, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.082 Vali Acc: 0.340 Test Loss: 2.082 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.147684097290039
Epoch: 38, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.089 Vali Acc: 0.320 Test Loss: 2.089 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3781557083129883
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.681 Vali Acc: 0.180 Test Loss: 1.681 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.6953773498535156
Epoch: 2, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.672 Vali Acc: 0.140 Test Loss: 1.672 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8374595642089844
Epoch: 3, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.672 Vali Acc: 0.140 Test Loss: 1.672 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8410017490386963
Epoch: 4, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.671 Vali Acc: 0.240 Test Loss: 1.671 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.8840887546539307
Epoch: 5, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.678 Vali Acc: 0.240 Test Loss: 1.678 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.088009834289551
Epoch: 6, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.689 Vali Acc: 0.220 Test Loss: 1.689 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.747739553451538
Epoch: 7, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.692 Vali Acc: 0.220 Test Loss: 1.692 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8989121913909912
Epoch: 8, Steps: 4 | Train Loss: 0.938 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.784364938735962
Epoch: 9, Steps: 4 | Train Loss: 0.758 Vali Loss: 1.713 Vali Acc: 0.260 Test Loss: 1.713 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 10 cost time: 2.012117624282837
Epoch: 10, Steps: 4 | Train Loss: 0.813 Vali Loss: 1.729 Vali Acc: 0.260 Test Loss: 1.729 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9371068477630615
Epoch: 11, Steps: 4 | Train Loss: 0.681 Vali Loss: 1.748 Vali Acc: 0.260 Test Loss: 1.748 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7186682224273682
Epoch: 12, Steps: 4 | Train Loss: 0.524 Vali Loss: 1.755 Vali Acc: 0.220 Test Loss: 1.755 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9372708797454834
Epoch: 13, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.751 Vali Acc: 0.220 Test Loss: 1.751 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7879316806793213
Epoch: 14, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.751 Vali Acc: 0.200 Test Loss: 1.751 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8811218738555908
Epoch: 15, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.757 Vali Acc: 0.300 Test Loss: 1.757 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299982).  Saving model ...
Epoch: 16 cost time: 1.80521559715271
Epoch: 16, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.788 Vali Acc: 0.320 Test Loss: 1.788 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319982).  Saving model ...
Epoch: 17 cost time: 1.8697803020477295
Epoch: 17, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.836 Vali Acc: 0.280 Test Loss: 1.836 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7543797492980957
Epoch: 18, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.883 Vali Acc: 0.280 Test Loss: 1.883 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.751985788345337
Epoch: 19, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.909 Vali Acc: 0.240 Test Loss: 1.909 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.669748306274414
Epoch: 20, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.938 Vali Acc: 0.260 Test Loss: 1.938 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7455675601959229
Epoch: 21, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.979 Vali Acc: 0.260 Test Loss: 1.979 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7786085605621338
Epoch: 22, Steps: 4 | Train Loss: 0.044 Vali Loss: 2.031 Vali Acc: 0.240 Test Loss: 2.031 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7459635734558105
Epoch: 23, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.030 Vali Acc: 0.220 Test Loss: 2.030 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6673352718353271
Epoch: 24, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.015 Vali Acc: 0.220 Test Loss: 2.015 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7812919616699219
Epoch: 25, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.001 Vali Acc: 0.220 Test Loss: 2.001 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6653048992156982
Epoch: 26, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.987 Vali Acc: 0.220 Test Loss: 1.987 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5228497982025146
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.753 Vali Acc: 0.240 Test Loss: 1.753 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 1.98809814453125
Epoch: 2, Steps: 4 | Train Loss: 1.742 Vali Loss: 1.742 Vali Acc: 0.240 Test Loss: 1.742 Test Acc: 0.240
Validation loss decreased (-0.239982 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.9177250862121582
Epoch: 3, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.736 Vali Acc: 0.280 Test Loss: 1.736 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 2.0159316062927246
Epoch: 4, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.729 Vali Acc: 0.260 Test Loss: 1.729 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8949904441833496
Epoch: 5, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.728 Vali Acc: 0.280 Test Loss: 1.728 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.7765130996704102
Epoch: 6, Steps: 4 | Train Loss: 1.212 Vali Loss: 1.732 Vali Acc: 0.320 Test Loss: 1.732 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.9612772464752197
Epoch: 7, Steps: 4 | Train Loss: 1.191 Vali Loss: 1.735 Vali Acc: 0.320 Test Loss: 1.735 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.892268419265747
Epoch: 8, Steps: 4 | Train Loss: 0.938 Vali Loss: 1.736 Vali Acc: 0.300 Test Loss: 1.736 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8638825416564941
Epoch: 9, Steps: 4 | Train Loss: 0.791 Vali Loss: 1.759 Vali Acc: 0.320 Test Loss: 1.759 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0802001953125
Epoch: 10, Steps: 4 | Train Loss: 0.867 Vali Loss: 1.785 Vali Acc: 0.260 Test Loss: 1.785 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8422472476959229
Epoch: 11, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.810 Vali Acc: 0.220 Test Loss: 1.810 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8512787818908691
Epoch: 12, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.819 Vali Acc: 0.200 Test Loss: 1.819 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.163170337677002
Epoch: 13, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.803 Vali Acc: 0.260 Test Loss: 1.803 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8079321384429932
Epoch: 14, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.794 Vali Acc: 0.260 Test Loss: 1.794 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9873096942901611
Epoch: 15, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.796 Vali Acc: 0.280 Test Loss: 1.796 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.017183780670166
Epoch: 16, Steps: 4 | Train Loss: 0.300 Vali Loss: 1.834 Vali Acc: 0.280 Test Loss: 1.834 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.778949499130249
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.616 Vali Acc: 0.280 Test Loss: 1.616 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.9753468036651611
Epoch: 2, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.609 Vali Acc: 0.300 Test Loss: 1.609 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.2860312461853027
Epoch: 3, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.602 Vali Acc: 0.320 Test Loss: 1.602 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 2.0791537761688232
Epoch: 4, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.597 Vali Acc: 0.320 Test Loss: 1.597 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.8877780437469482
Epoch: 5, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.599 Vali Acc: 0.300 Test Loss: 1.599 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0423569679260254
Epoch: 6, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.603 Vali Acc: 0.300 Test Loss: 1.603 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.237319231033325
Epoch: 7, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.598 Vali Acc: 0.280 Test Loss: 1.598 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1038715839385986
Epoch: 8, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.596 Vali Acc: 0.280 Test Loss: 1.596 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3817381858825684
Epoch: 9, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.600 Vali Acc: 0.300 Test Loss: 1.600 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.084460496902466
Epoch: 10, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.598 Vali Acc: 0.320 Test Loss: 1.598 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.973358154296875
Epoch: 11, Steps: 4 | Train Loss: 1.230 Vali Loss: 1.600 Vali Acc: 0.320 Test Loss: 1.600 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.893815279006958
Epoch: 12, Steps: 4 | Train Loss: 0.956 Vali Loss: 1.587 Vali Acc: 0.320 Test Loss: 1.587 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 13 cost time: 1.943650484085083
Epoch: 13, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.573 Vali Acc: 0.340 Test Loss: 1.573 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 14 cost time: 1.9490585327148438
Epoch: 14, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.563 Vali Acc: 0.320 Test Loss: 1.563 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.009455680847168
Epoch: 15, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.560 Vali Acc: 0.240 Test Loss: 1.560 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9693455696105957
Epoch: 16, Steps: 4 | Train Loss: 0.820 Vali Loss: 1.552 Vali Acc: 0.260 Test Loss: 1.552 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9945271015167236
Epoch: 17, Steps: 4 | Train Loss: 0.529 Vali Loss: 1.555 Vali Acc: 0.280 Test Loss: 1.555 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1580445766448975
Epoch: 18, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.564 Vali Acc: 0.300 Test Loss: 1.564 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.967494010925293
Epoch: 19, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.563 Vali Acc: 0.300 Test Loss: 1.563 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.152221441268921
Epoch: 20, Steps: 4 | Train Loss: 0.349 Vali Loss: 1.565 Vali Acc: 0.300 Test Loss: 1.565 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9980931282043457
Epoch: 21, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.552 Vali Acc: 0.300 Test Loss: 1.552 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9040517807006836
Epoch: 22, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.553 Vali Acc: 0.260 Test Loss: 1.553 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1327712535858154
Epoch: 23, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.532 Vali Acc: 0.240 Test Loss: 1.532 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2550032138824463
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.650 Vali Acc: 0.180 Test Loss: 1.650 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.0029401779174805
Epoch: 2, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.7832472324371338
Epoch: 3, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.7899911403656006
Epoch: 4, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.628 Vali Acc: 0.240 Test Loss: 1.628 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.6751563549041748
Epoch: 5, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.629 Vali Acc: 0.220 Test Loss: 1.629 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.918642282485962
Epoch: 6, Steps: 4 | Train Loss: 1.373 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.042793035507202
Epoch: 7, Steps: 4 | Train Loss: 1.364 Vali Loss: 1.633 Vali Acc: 0.260 Test Loss: 1.633 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 8 cost time: 1.8617146015167236
Epoch: 8, Steps: 4 | Train Loss: 1.310 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.820302963256836
Epoch: 9, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.645 Vali Acc: 0.200 Test Loss: 1.645 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6935772895812988
Epoch: 10, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.648 Vali Acc: 0.220 Test Loss: 1.648 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7236275672912598
Epoch: 11, Steps: 4 | Train Loss: 1.161 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0258522033691406
Epoch: 12, Steps: 4 | Train Loss: 0.889 Vali Loss: 1.644 Vali Acc: 0.240 Test Loss: 1.644 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7978551387786865
Epoch: 13, Steps: 4 | Train Loss: 0.759 Vali Loss: 1.631 Vali Acc: 0.220 Test Loss: 1.631 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.034001350402832
Epoch: 14, Steps: 4 | Train Loss: 0.598 Vali Loss: 1.618 Vali Acc: 0.220 Test Loss: 1.618 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0148608684539795
Epoch: 15, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.616 Vali Acc: 0.200 Test Loss: 1.616 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9946033954620361
Epoch: 16, Steps: 4 | Train Loss: 0.705 Vali Loss: 1.614 Vali Acc: 0.180 Test Loss: 1.614 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8696675300598145
Epoch: 17, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.622 Vali Acc: 0.180 Test Loss: 1.622 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 313157
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2885732650756836
Epoch: 1, Steps: 4 | Train Loss: 1.647 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.5931165218353271
Epoch: 2, Steps: 4 | Train Loss: 1.729 Vali Loss: 1.588 Vali Acc: 0.260 Test Loss: 1.588 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.8226664066314697
Epoch: 3, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.577 Vali Acc: 0.240 Test Loss: 1.577 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6842365264892578
Epoch: 4, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.574 Vali Acc: 0.240 Test Loss: 1.574 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7810626029968262
Epoch: 5, Steps: 4 | Train Loss: 1.323 Vali Loss: 1.583 Vali Acc: 0.200 Test Loss: 1.583 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7074284553527832
Epoch: 6, Steps: 4 | Train Loss: 1.276 Vali Loss: 1.578 Vali Acc: 0.200 Test Loss: 1.578 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9617152214050293
Epoch: 7, Steps: 4 | Train Loss: 1.036 Vali Loss: 1.565 Vali Acc: 0.280 Test Loss: 1.565 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.6979422569274902
Epoch: 8, Steps: 4 | Train Loss: 0.842 Vali Loss: 1.562 Vali Acc: 0.280 Test Loss: 1.562 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 9 cost time: 1.678441047668457
Epoch: 9, Steps: 4 | Train Loss: 0.794 Vali Loss: 1.576 Vali Acc: 0.280 Test Loss: 1.576 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.818680763244629
Epoch: 10, Steps: 4 | Train Loss: 0.569 Vali Loss: 1.582 Vali Acc: 0.280 Test Loss: 1.582 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8587241172790527
Epoch: 11, Steps: 4 | Train Loss: 0.527 Vali Loss: 1.609 Vali Acc: 0.260 Test Loss: 1.609 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7854790687561035
Epoch: 12, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.639 Vali Acc: 0.260 Test Loss: 1.639 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7117843627929688
Epoch: 13, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8573722839355469
Epoch: 14, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.603 Vali Acc: 0.300 Test Loss: 1.603 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 15 cost time: 1.888932228088379
Epoch: 15, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.599 Vali Acc: 0.320 Test Loss: 1.599 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 16 cost time: 1.8430771827697754
Epoch: 16, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.624 Vali Acc: 0.300 Test Loss: 1.624 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7214713096618652
Epoch: 17, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.673 Vali Acc: 0.280 Test Loss: 1.673 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8523876667022705
Epoch: 18, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.745 Vali Acc: 0.320 Test Loss: 1.745 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9731991291046143
Epoch: 19, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.782 Vali Acc: 0.320 Test Loss: 1.782 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6271789073944092
Epoch: 20, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.791 Vali Acc: 0.320 Test Loss: 1.791 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9805121421813965
Epoch: 21, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.823 Vali Acc: 0.300 Test Loss: 1.823 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6815969944000244
Epoch: 22, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.852 Vali Acc: 0.320 Test Loss: 1.852 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7658793926239014
Epoch: 23, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.861 Vali Acc: 0.300 Test Loss: 1.861 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8034164905548096
Epoch: 24, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.852 Vali Acc: 0.340 Test Loss: 1.852 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339981).  Saving model ...
Epoch: 25 cost time: 1.897493839263916
Epoch: 25, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.845 Vali Acc: 0.300 Test Loss: 1.845 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7803480625152588
Epoch: 26, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.844 Vali Acc: 0.320 Test Loss: 1.844 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.900048017501831
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.864 Vali Acc: 0.320 Test Loss: 1.864 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9352402687072754
Epoch: 28, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.885 Vali Acc: 0.320 Test Loss: 1.885 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1062941551208496
Epoch: 29, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.909 Vali Acc: 0.360 Test Loss: 1.909 Test Acc: 0.360
Validation loss decreased (-0.339981 --> -0.359981).  Saving model ...
Epoch: 30 cost time: 2.021307945251465
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.929 Vali Acc: 0.360 Test Loss: 1.929 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8829338550567627
Epoch: 31, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.952 Vali Acc: 0.320 Test Loss: 1.952 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7467455863952637
Epoch: 32, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.974 Vali Acc: 0.320 Test Loss: 1.974 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.854781150817871
Epoch: 33, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.995 Vali Acc: 0.320 Test Loss: 1.995 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8441152572631836
Epoch: 34, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.015 Vali Acc: 0.320 Test Loss: 2.015 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8415727615356445
Epoch: 35, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.033 Vali Acc: 0.320 Test Loss: 2.033 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8973023891448975
Epoch: 36, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.045 Vali Acc: 0.320 Test Loss: 2.045 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8172199726104736
Epoch: 37, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.056 Vali Acc: 0.340 Test Loss: 2.056 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.763486623764038
Epoch: 38, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.070 Vali Acc: 0.360 Test Loss: 2.070 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7959697246551514
Epoch: 39, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.080 Vali Acc: 0.360 Test Loss: 2.080 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5011978149414062
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8422319889068604
Epoch: 2, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.623 Vali Acc: 0.220 Test Loss: 1.623 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.0071980953216553
Epoch: 3, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.615 Vali Acc: 0.240 Test Loss: 1.615 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.833949089050293
Epoch: 4, Steps: 4 | Train Loss: 1.427 Vali Loss: 1.615 Vali Acc: 0.240 Test Loss: 1.615 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.776731014251709
Epoch: 5, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7410194873809814
Epoch: 6, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.622 Vali Acc: 0.220 Test Loss: 1.622 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8704006671905518
Epoch: 7, Steps: 4 | Train Loss: 1.062 Vali Loss: 1.608 Vali Acc: 0.240 Test Loss: 1.608 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 8 cost time: 1.85209059715271
Epoch: 8, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.604 Vali Acc: 0.300 Test Loss: 1.604 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 1.7483882904052734
Epoch: 9, Steps: 4 | Train Loss: 0.846 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8669722080230713
Epoch: 10, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8303189277648926
Epoch: 11, Steps: 4 | Train Loss: 0.554 Vali Loss: 1.646 Vali Acc: 0.220 Test Loss: 1.646 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8102989196777344
Epoch: 12, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.678 Vali Acc: 0.220 Test Loss: 1.678 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.04328989982605
Epoch: 13, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.676 Vali Acc: 0.200 Test Loss: 1.676 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.890096664428711
Epoch: 14, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8678791522979736
Epoch: 15, Steps: 4 | Train Loss: 0.243 Vali Loss: 1.603 Vali Acc: 0.280 Test Loss: 1.603 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8799407482147217
Epoch: 16, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0534024238586426
Epoch: 17, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.661 Vali Acc: 0.280 Test Loss: 1.661 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2215685844421387
Epoch: 18, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.733 Vali Acc: 0.220 Test Loss: 1.733 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.813535451889038
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.886909008026123
Epoch: 2, Steps: 4 | Train Loss: 1.718 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.1241188049316406
Epoch: 3, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.606 Vali Acc: 0.240 Test Loss: 1.606 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.9861397743225098
Epoch: 4, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.604 Vali Acc: 0.240 Test Loss: 1.604 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 2.004406690597534
Epoch: 5, Steps: 4 | Train Loss: 1.369 Vali Loss: 1.615 Vali Acc: 0.220 Test Loss: 1.615 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1390697956085205
Epoch: 6, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.614 Vali Acc: 0.220 Test Loss: 1.614 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.02974534034729
Epoch: 7, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6932873725891113
Epoch: 8, Steps: 4 | Train Loss: 0.834 Vali Loss: 1.610 Vali Acc: 0.300 Test Loss: 1.610 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 1.8537731170654297
Epoch: 9, Steps: 4 | Train Loss: 0.838 Vali Loss: 1.631 Vali Acc: 0.280 Test Loss: 1.631 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.934325933456421
Epoch: 10, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.638 Vali Acc: 0.280 Test Loss: 1.638 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8314330577850342
Epoch: 11, Steps: 4 | Train Loss: 0.537 Vali Loss: 1.673 Vali Acc: 0.240 Test Loss: 1.673 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.048394203186035
Epoch: 12, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.721 Vali Acc: 0.220 Test Loss: 1.721 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0655949115753174
Epoch: 13, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.737 Vali Acc: 0.260 Test Loss: 1.737 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8987338542938232
Epoch: 14, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.695 Vali Acc: 0.280 Test Loss: 1.695 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.961984395980835
Epoch: 15, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.677 Vali Acc: 0.300 Test Loss: 1.677 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9141786098480225
Epoch: 16, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.701 Vali Acc: 0.300 Test Loss: 1.701 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6796729564666748
Epoch: 17, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.763 Vali Acc: 0.320 Test Loss: 1.763 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319982).  Saving model ...
Epoch: 18 cost time: 1.7512540817260742
Epoch: 18, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.843 Vali Acc: 0.280 Test Loss: 1.843 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.060586452484131
Epoch: 19, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.886 Vali Acc: 0.280 Test Loss: 1.886 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8411519527435303
Epoch: 20, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.898 Vali Acc: 0.280 Test Loss: 1.898 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9737143516540527
Epoch: 21, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.932 Vali Acc: 0.300 Test Loss: 1.932 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9660134315490723
Epoch: 22, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.962 Vali Acc: 0.280 Test Loss: 1.962 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7157220840454102
Epoch: 23, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.947 Vali Acc: 0.320 Test Loss: 1.947 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8427035808563232
Epoch: 24, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.931 Vali Acc: 0.320 Test Loss: 1.931 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8644261360168457
Epoch: 25, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.925 Vali Acc: 0.320 Test Loss: 1.925 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8519275188446045
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.926 Vali Acc: 0.320 Test Loss: 1.926 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9692692756652832
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.947 Vali Acc: 0.300 Test Loss: 1.947 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4757614135742188
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.629 Vali Acc: 0.220 Test Loss: 1.629 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8376250267028809
Epoch: 2, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.9454834461212158
Epoch: 3, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.627 Vali Acc: 0.200 Test Loss: 1.627 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.855858564376831
Epoch: 4, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.628 Vali Acc: 0.200 Test Loss: 1.628 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.794212818145752
Epoch: 5, Steps: 4 | Train Loss: 1.352 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.862863540649414
Epoch: 6, Steps: 4 | Train Loss: 1.275 Vali Loss: 1.624 Vali Acc: 0.220 Test Loss: 1.624 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7962408065795898
Epoch: 7, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.609 Vali Acc: 0.220 Test Loss: 1.609 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8716671466827393
Epoch: 8, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9814491271972656
Epoch: 9, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 10 cost time: 1.9070985317230225
Epoch: 10, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7039375305175781
Epoch: 11, Steps: 4 | Train Loss: 0.520 Vali Loss: 1.653 Vali Acc: 0.240 Test Loss: 1.653 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.787660837173462
Epoch: 12, Steps: 4 | Train Loss: 0.432 Vali Loss: 1.693 Vali Acc: 0.280 Test Loss: 1.693 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 13 cost time: 1.7512199878692627
Epoch: 13, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.701 Vali Acc: 0.240 Test Loss: 1.701 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8277950286865234
Epoch: 14, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.652 Vali Acc: 0.300 Test Loss: 1.652 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 15 cost time: 1.814586877822876
Epoch: 15, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.623 Vali Acc: 0.300 Test Loss: 1.623 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299984).  Saving model ...
Epoch: 16 cost time: 1.7656493186950684
Epoch: 16, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9111006259918213
Epoch: 17, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.704 Vali Acc: 0.300 Test Loss: 1.704 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9243957996368408
Epoch: 18, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.789 Vali Acc: 0.280 Test Loss: 1.789 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8840277194976807
Epoch: 19, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.840 Vali Acc: 0.280 Test Loss: 1.840 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.904062271118164
Epoch: 20, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.848 Vali Acc: 0.300 Test Loss: 1.848 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.063157320022583
Epoch: 21, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.871 Vali Acc: 0.280 Test Loss: 1.871 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2936952114105225
Epoch: 22, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.873 Vali Acc: 0.300 Test Loss: 1.873 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2159159183502197
Epoch: 23, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.843 Vali Acc: 0.340 Test Loss: 1.843 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339982).  Saving model ...
Epoch: 24 cost time: 2.1310524940490723
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.825 Vali Acc: 0.320 Test Loss: 1.825 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2520270347595215
Epoch: 25, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.819 Vali Acc: 0.360 Test Loss: 1.819 Test Acc: 0.360
Validation loss decreased (-0.339982 --> -0.359982).  Saving model ...
Epoch: 26 cost time: 2.319530725479126
Epoch: 26, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.814 Vali Acc: 0.360 Test Loss: 1.814 Test Acc: 0.360
Validation loss decreased (-0.359982 --> -0.359982).  Saving model ...
Epoch: 27 cost time: 2.3517775535583496
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.828 Vali Acc: 0.340 Test Loss: 1.828 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3573386669158936
Epoch: 28, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.846 Vali Acc: 0.320 Test Loss: 1.846 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.112799644470215
Epoch: 29, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.870 Vali Acc: 0.300 Test Loss: 1.870 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1756880283355713
Epoch: 30, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.893 Vali Acc: 0.300 Test Loss: 1.893 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2537624835968018
Epoch: 31, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.914 Vali Acc: 0.300 Test Loss: 1.914 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1887404918670654
Epoch: 32, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.930 Vali Acc: 0.300 Test Loss: 1.930 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.065263509750366
Epoch: 33, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.946 Vali Acc: 0.320 Test Loss: 1.946 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.2236170768737793
Epoch: 34, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.962 Vali Acc: 0.320 Test Loss: 1.962 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0452487468719482
Epoch: 35, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.977 Vali Acc: 0.320 Test Loss: 1.977 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.2523419857025146
Epoch: 36, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.988 Vali Acc: 0.320 Test Loss: 1.988 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.329745292663574
Epoch: 1, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.585 Vali Acc: 0.200 Test Loss: 1.585 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.7060132026672363
Epoch: 2, Steps: 4 | Train Loss: 1.792 Vali Loss: 1.580 Vali Acc: 0.180 Test Loss: 1.580 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8403573036193848
Epoch: 3, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.578 Vali Acc: 0.200 Test Loss: 1.578 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.6799657344818115
Epoch: 4, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.581 Vali Acc: 0.220 Test Loss: 1.581 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.8619918823242188
Epoch: 5, Steps: 4 | Train Loss: 1.313 Vali Loss: 1.596 Vali Acc: 0.220 Test Loss: 1.596 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.714367151260376
Epoch: 6, Steps: 4 | Train Loss: 1.255 Vali Loss: 1.602 Vali Acc: 0.220 Test Loss: 1.602 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.001868963241577
Epoch: 7, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.600 Vali Acc: 0.180 Test Loss: 1.600 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6853601932525635
Epoch: 8, Steps: 4 | Train Loss: 0.843 Vali Loss: 1.603 Vali Acc: 0.180 Test Loss: 1.603 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8492650985717773
Epoch: 9, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.616 Vali Acc: 0.200 Test Loss: 1.616 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8250486850738525
Epoch: 10, Steps: 4 | Train Loss: 0.568 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7561256885528564
Epoch: 11, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.657 Vali Acc: 0.180 Test Loss: 1.657 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.755232572555542
Epoch: 12, Steps: 4 | Train Loss: 0.432 Vali Loss: 1.707 Vali Acc: 0.180 Test Loss: 1.707 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.719428539276123
Epoch: 13, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.730 Vali Acc: 0.180 Test Loss: 1.730 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7175705432891846
Epoch: 14, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.704 Vali Acc: 0.200 Test Loss: 1.704 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4438087940216064
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.634 Vali Acc: 0.320 Test Loss: 1.634 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.8564565181732178
Epoch: 2, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.628 Vali Acc: 0.280 Test Loss: 1.628 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7348768711090088
Epoch: 3, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.625 Vali Acc: 0.280 Test Loss: 1.625 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8400342464447021
Epoch: 4, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.626 Vali Acc: 0.280 Test Loss: 1.626 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9973199367523193
Epoch: 5, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.636 Vali Acc: 0.260 Test Loss: 1.636 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.029313087463379
Epoch: 6, Steps: 4 | Train Loss: 1.217 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0840682983398438
Epoch: 7, Steps: 4 | Train Loss: 1.059 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7888834476470947
Epoch: 8, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.637 Vali Acc: 0.200 Test Loss: 1.637 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.814349889755249
Epoch: 9, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.649 Vali Acc: 0.200 Test Loss: 1.649 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0063271522521973
Epoch: 10, Steps: 4 | Train Loss: 0.576 Vali Loss: 1.649 Vali Acc: 0.220 Test Loss: 1.649 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.824354648590088
Epoch: 11, Steps: 4 | Train Loss: 0.513 Vali Loss: 1.679 Vali Acc: 0.200 Test Loss: 1.679 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5929107666015625
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.564 Vali Acc: 0.240 Test Loss: 1.564 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.9634997844696045
Epoch: 2, Steps: 4 | Train Loss: 1.707 Vali Loss: 1.559 Vali Acc: 0.220 Test Loss: 1.559 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9045193195343018
Epoch: 3, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.555 Vali Acc: 0.260 Test Loss: 1.555 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 2.2583343982696533
Epoch: 4, Steps: 4 | Train Loss: 1.474 Vali Loss: 1.555 Vali Acc: 0.280 Test Loss: 1.555 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 2.0251309871673584
Epoch: 5, Steps: 4 | Train Loss: 1.378 Vali Loss: 1.566 Vali Acc: 0.280 Test Loss: 1.566 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.172494649887085
Epoch: 6, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2243640422821045
Epoch: 7, Steps: 4 | Train Loss: 1.061 Vali Loss: 1.567 Vali Acc: 0.280 Test Loss: 1.567 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.814631462097168
Epoch: 8, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.568 Vali Acc: 0.260 Test Loss: 1.568 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.927011489868164
Epoch: 9, Steps: 4 | Train Loss: 0.858 Vali Loss: 1.583 Vali Acc: 0.300 Test Loss: 1.583 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 10 cost time: 1.8098833560943604
Epoch: 10, Steps: 4 | Train Loss: 0.612 Vali Loss: 1.584 Vali Acc: 0.300 Test Loss: 1.584 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9058091640472412
Epoch: 11, Steps: 4 | Train Loss: 0.571 Vali Loss: 1.605 Vali Acc: 0.280 Test Loss: 1.605 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.140087127685547
Epoch: 12, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7505989074707031
Epoch: 13, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.649 Vali Acc: 0.200 Test Loss: 1.649 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2801918983459473
Epoch: 14, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.623 Vali Acc: 0.240 Test Loss: 1.623 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1413252353668213
Epoch: 15, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.608 Vali Acc: 0.220 Test Loss: 1.608 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9187912940979004
Epoch: 16, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.624 Vali Acc: 0.220 Test Loss: 1.624 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1056134700775146
Epoch: 17, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.675 Vali Acc: 0.220 Test Loss: 1.675 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.08434796333313
Epoch: 18, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.752 Vali Acc: 0.220 Test Loss: 1.752 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.075838088989258
Epoch: 19, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.803 Vali Acc: 0.220 Test Loss: 1.803 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.548461437225342
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.597 Vali Acc: 0.220 Test Loss: 1.597 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8548965454101562
Epoch: 2, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.596 Vali Acc: 0.240 Test Loss: 1.596 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.9500625133514404
Epoch: 3, Steps: 4 | Train Loss: 1.489 Vali Loss: 1.597 Vali Acc: 0.220 Test Loss: 1.597 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.134908437728882
Epoch: 4, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.599 Vali Acc: 0.220 Test Loss: 1.599 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8486831188201904
Epoch: 5, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.603 Vali Acc: 0.280 Test Loss: 1.603 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.9680273532867432
Epoch: 6, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.601 Vali Acc: 0.340 Test Loss: 1.601 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 7 cost time: 1.8597784042358398
Epoch: 7, Steps: 4 | Train Loss: 1.122 Vali Loss: 1.595 Vali Acc: 0.300 Test Loss: 1.595 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8294577598571777
Epoch: 8, Steps: 4 | Train Loss: 0.905 Vali Loss: 1.589 Vali Acc: 0.280 Test Loss: 1.589 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1217942237854004
Epoch: 9, Steps: 4 | Train Loss: 0.928 Vali Loss: 1.592 Vali Acc: 0.280 Test Loss: 1.592 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8731834888458252
Epoch: 10, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.584 Vali Acc: 0.260 Test Loss: 1.584 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8077173233032227
Epoch: 11, Steps: 4 | Train Loss: 0.600 Vali Loss: 1.591 Vali Acc: 0.300 Test Loss: 1.591 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9237492084503174
Epoch: 12, Steps: 4 | Train Loss: 0.586 Vali Loss: 1.616 Vali Acc: 0.300 Test Loss: 1.616 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8228652477264404
Epoch: 13, Steps: 4 | Train Loss: 0.458 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9087340831756592
Epoch: 14, Steps: 4 | Train Loss: 0.330 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9237051010131836
Epoch: 15, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9378979206085205
Epoch: 16, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.794240951538086
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.642 Vali Acc: 0.200 Test Loss: 1.642 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.265634059906006
Epoch: 2, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.642 Vali Acc: 0.220 Test Loss: 1.642 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.2381083965301514
Epoch: 3, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.644 Vali Acc: 0.220 Test Loss: 1.644 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.029906988143921
Epoch: 4, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0202853679656982
Epoch: 5, Steps: 4 | Train Loss: 1.409 Vali Loss: 1.646 Vali Acc: 0.180 Test Loss: 1.646 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8877997398376465
Epoch: 6, Steps: 4 | Train Loss: 1.372 Vali Loss: 1.647 Vali Acc: 0.180 Test Loss: 1.647 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.054190158843994
Epoch: 7, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.650 Vali Acc: 0.180 Test Loss: 1.650 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.06593656539917
Epoch: 8, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.652 Vali Acc: 0.140 Test Loss: 1.652 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9763076305389404
Epoch: 9, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.661 Vali Acc: 0.180 Test Loss: 1.661 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.121027708053589
Epoch: 10, Steps: 4 | Train Loss: 0.952 Vali Loss: 1.658 Vali Acc: 0.180 Test Loss: 1.658 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2400624752044678
Epoch: 11, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.659 Vali Acc: 0.180 Test Loss: 1.659 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.136347770690918
Epoch: 12, Steps: 4 | Train Loss: 0.902 Vali Loss: 1.666 Vali Acc: 0.160 Test Loss: 1.666 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8353090286254883
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.685 Vali Acc: 0.140 Test Loss: 1.685 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.9084367752075195
Epoch: 2, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.687 Vali Acc: 0.120 Test Loss: 1.687 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1585371494293213
Epoch: 3, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.692 Vali Acc: 0.140 Test Loss: 1.692 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1687865257263184
Epoch: 4, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.691 Vali Acc: 0.140 Test Loss: 1.691 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.945465326309204
Epoch: 5, Steps: 4 | Train Loss: 1.434 Vali Loss: 1.696 Vali Acc: 0.140 Test Loss: 1.696 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.204763174057007
Epoch: 6, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.699 Vali Acc: 0.160 Test Loss: 1.699 Test Acc: 0.160
Validation loss decreased (-0.139983 --> -0.159983).  Saving model ...
Epoch: 7 cost time: 2.234360933303833
Epoch: 7, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.705 Vali Acc: 0.160 Test Loss: 1.705 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.005295991897583
Epoch: 8, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.707 Vali Acc: 0.160 Test Loss: 1.707 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1066720485687256
Epoch: 9, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 10 cost time: 2.035891056060791
Epoch: 10, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.723 Vali Acc: 0.200 Test Loss: 1.723 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1495466232299805
Epoch: 11, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.722 Vali Acc: 0.200 Test Loss: 1.722 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.235234260559082
Epoch: 12, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.733 Vali Acc: 0.180 Test Loss: 1.733 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2666916847229004
Epoch: 13, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.720 Vali Acc: 0.160 Test Loss: 1.720 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2264344692230225
Epoch: 14, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.693 Vali Acc: 0.160 Test Loss: 1.693 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2403266429901123
Epoch: 15, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.673 Vali Acc: 0.140 Test Loss: 1.673 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1759586334228516
Epoch: 16, Steps: 4 | Train Loss: 0.630 Vali Loss: 1.662 Vali Acc: 0.160 Test Loss: 1.662 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.300096273422241
Epoch: 17, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.673 Vali Acc: 0.160 Test Loss: 1.673 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.116192579269409
Epoch: 18, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.700 Vali Acc: 0.120 Test Loss: 1.700 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1212925910949707
Epoch: 19, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.715 Vali Acc: 0.180 Test Loss: 1.715 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 264005
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         135                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7837798595428467
Epoch: 1, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.624 Vali Acc: 0.200 Test Loss: 1.624 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.9827733039855957
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.630 Vali Acc: 0.200 Test Loss: 1.630 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0346839427948
Epoch: 3, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.626 Vali Acc: 0.200 Test Loss: 1.626 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8926308155059814
Epoch: 4, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.627 Vali Acc: 0.260 Test Loss: 1.627 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 2.057295322418213
Epoch: 5, Steps: 4 | Train Loss: 1.277 Vali Loss: 1.631 Vali Acc: 0.220 Test Loss: 1.631 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9855122566223145
Epoch: 6, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.630 Vali Acc: 0.240 Test Loss: 1.630 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.870983600616455
Epoch: 7, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9461679458618164
Epoch: 8, Steps: 4 | Train Loss: 0.892 Vali Loss: 1.626 Vali Acc: 0.200 Test Loss: 1.626 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9302544593811035
Epoch: 9, Steps: 4 | Train Loss: 0.773 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8984692096710205
Epoch: 10, Steps: 4 | Train Loss: 0.598 Vali Loss: 1.618 Vali Acc: 0.260 Test Loss: 1.618 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 11 cost time: 2.0216026306152344
Epoch: 11, Steps: 4 | Train Loss: 0.483 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 12 cost time: 1.9063665866851807
Epoch: 12, Steps: 4 | Train Loss: 0.573 Vali Loss: 1.623 Vali Acc: 0.300 Test Loss: 1.623 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 13 cost time: 2.1136231422424316
Epoch: 13, Steps: 4 | Train Loss: 0.323 Vali Loss: 1.638 Vali Acc: 0.320 Test Loss: 1.638 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 14 cost time: 1.9936776161193848
Epoch: 14, Steps: 4 | Train Loss: 0.366 Vali Loss: 1.646 Vali Acc: 0.320 Test Loss: 1.646 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0452373027801514
Epoch: 15, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.669 Vali Acc: 0.320 Test Loss: 1.669 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1658146381378174
Epoch: 16, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.723 Vali Acc: 0.340 Test Loss: 1.723 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339983).  Saving model ...
Epoch: 17 cost time: 1.8703668117523193
Epoch: 17, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.721 Vali Acc: 0.340 Test Loss: 1.721 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339983).  Saving model ...
Epoch: 18 cost time: 1.94291353225708
Epoch: 18, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.696 Vali Acc: 0.340 Test Loss: 1.696 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339983).  Saving model ...
Epoch: 19 cost time: 1.9411721229553223
Epoch: 19, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.674 Vali Acc: 0.340 Test Loss: 1.674 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339983).  Saving model ...
Epoch: 20 cost time: 1.916346788406372
Epoch: 20, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.678 Vali Acc: 0.320 Test Loss: 1.678 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9616291522979736
Epoch: 21, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.698 Vali Acc: 0.360 Test Loss: 1.698 Test Acc: 0.360
Validation loss decreased (-0.339983 --> -0.359983).  Saving model ...
Epoch: 22 cost time: 1.8983771800994873
Epoch: 22, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.738 Vali Acc: 0.360 Test Loss: 1.738 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9264285564422607
Epoch: 23, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.779 Vali Acc: 0.360 Test Loss: 1.779 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8538155555725098
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.803 Vali Acc: 0.360 Test Loss: 1.803 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9316461086273193
Epoch: 25, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.813 Vali Acc: 0.320 Test Loss: 1.813 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7697978019714355
Epoch: 26, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.825 Vali Acc: 0.320 Test Loss: 1.825 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9624948501586914
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.840 Vali Acc: 0.320 Test Loss: 1.840 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8435029983520508
Epoch: 28, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.858 Vali Acc: 0.320 Test Loss: 1.858 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.2934494018554688
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.892 Vali Acc: 0.340 Test Loss: 1.892 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.198486804962158
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.907 Vali Acc: 0.340 Test Loss: 1.907 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2484347820281982
Epoch: 31, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.907 Vali Acc: 0.340 Test Loss: 1.907 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         108                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.060038328170776
Epoch: 1, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.036411762237549
Epoch: 2, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.662 Vali Acc: 0.200 Test Loss: 1.662 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 2.1950998306274414
Epoch: 3, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 2.3664748668670654
Epoch: 4, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 2.036201238632202
Epoch: 5, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.661 Vali Acc: 0.280 Test Loss: 1.661 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.165374517440796
Epoch: 6, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.661 Vali Acc: 0.260 Test Loss: 1.661 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.216813802719116
Epoch: 7, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.658 Vali Acc: 0.200 Test Loss: 1.658 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0725505352020264
Epoch: 8, Steps: 4 | Train Loss: 0.918 Vali Loss: 1.655 Vali Acc: 0.180 Test Loss: 1.655 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8441271781921387
Epoch: 9, Steps: 4 | Train Loss: 0.781 Vali Loss: 1.653 Vali Acc: 0.180 Test Loss: 1.653 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.036938190460205
Epoch: 10, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.643 Vali Acc: 0.180 Test Loss: 1.643 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0978188514709473
Epoch: 11, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.635 Vali Acc: 0.220 Test Loss: 1.635 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3281075954437256
Epoch: 12, Steps: 4 | Train Loss: 0.596 Vali Loss: 1.643 Vali Acc: 0.280 Test Loss: 1.643 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 13 cost time: 1.8777241706848145
Epoch: 13, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.654 Vali Acc: 0.300 Test Loss: 1.654 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 14 cost time: 2.013871431350708
Epoch: 14, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.661 Vali Acc: 0.280 Test Loss: 1.661 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.179229259490967
Epoch: 15, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.686 Vali Acc: 0.260 Test Loss: 1.686 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5103704929351807
Epoch: 16, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.738 Vali Acc: 0.220 Test Loss: 1.738 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2227625846862793
Epoch: 17, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.720 Vali Acc: 0.220 Test Loss: 1.720 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3605871200561523
Epoch: 18, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.679 Vali Acc: 0.260 Test Loss: 1.679 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4492719173431396
Epoch: 19, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.651 Vali Acc: 0.280 Test Loss: 1.651 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3901736736297607
Epoch: 20, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.661 Vali Acc: 0.280 Test Loss: 1.661 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4342448711395264
Epoch: 21, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.685 Vali Acc: 0.320 Test Loss: 1.685 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 22 cost time: 2.626478910446167
Epoch: 22, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.721 Vali Acc: 0.320 Test Loss: 1.721 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2980399131774902
Epoch: 23, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.746 Vali Acc: 0.300 Test Loss: 1.746 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3332602977752686
Epoch: 24, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.753 Vali Acc: 0.300 Test Loss: 1.753 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.32598614692688
Epoch: 25, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.746 Vali Acc: 0.280 Test Loss: 1.746 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.60524320602417
Epoch: 26, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.748 Vali Acc: 0.320 Test Loss: 1.748 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4905858039855957
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.758 Vali Acc: 0.320 Test Loss: 1.758 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.6847944259643555
Epoch: 28, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.776 Vali Acc: 0.300 Test Loss: 1.776 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.338717460632324
Epoch: 29, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.815 Vali Acc: 0.300 Test Loss: 1.815 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.728156566619873
Epoch: 30, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.827 Vali Acc: 0.320 Test Loss: 1.827 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.7602460384368896
Epoch: 31, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.824 Vali Acc: 0.320 Test Loss: 1.824 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5190980434417725
Epoch: 1, Steps: 4 | Train Loss: 1.614 Vali Loss: 1.677 Vali Acc: 0.160 Test Loss: 1.677 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.9920845031738281
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.684 Vali Acc: 0.180 Test Loss: 1.684 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.9875133037567139
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 2.013808012008667
Epoch: 4, Steps: 4 | Train Loss: 1.381 Vali Loss: 1.686 Vali Acc: 0.260 Test Loss: 1.686 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.951639175415039
Epoch: 5, Steps: 4 | Train Loss: 1.254 Vali Loss: 1.695 Vali Acc: 0.200 Test Loss: 1.695 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2765657901763916
Epoch: 6, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.702 Vali Acc: 0.220 Test Loss: 1.702 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1348395347595215
Epoch: 7, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.707 Vali Acc: 0.280 Test Loss: 1.707 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 8 cost time: 2.1656851768493652
Epoch: 8, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.714 Vali Acc: 0.280 Test Loss: 1.714 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1352524757385254
Epoch: 9, Steps: 4 | Train Loss: 0.749 Vali Loss: 1.722 Vali Acc: 0.260 Test Loss: 1.722 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.175828218460083
Epoch: 10, Steps: 4 | Train Loss: 0.594 Vali Loss: 1.718 Vali Acc: 0.220 Test Loss: 1.718 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2810566425323486
Epoch: 11, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.719 Vali Acc: 0.240 Test Loss: 1.719 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4333009719848633
Epoch: 12, Steps: 4 | Train Loss: 0.582 Vali Loss: 1.729 Vali Acc: 0.240 Test Loss: 1.729 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1049156188964844
Epoch: 13, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.745 Vali Acc: 0.260 Test Loss: 1.745 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4406237602233887
Epoch: 14, Steps: 4 | Train Loss: 0.386 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1473066806793213
Epoch: 15, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.809 Vali Acc: 0.240 Test Loss: 1.809 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.268355369567871
Epoch: 16, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.874 Vali Acc: 0.240 Test Loss: 1.874 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.205381393432617
Epoch: 17, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.867 Vali Acc: 0.240 Test Loss: 1.867 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         54                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.798586845397949
Epoch: 1, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.640 Vali Acc: 0.160 Test Loss: 1.640 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.028510093688965
Epoch: 2, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.643 Vali Acc: 0.140 Test Loss: 1.643 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9298105239868164
Epoch: 3, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.635 Vali Acc: 0.160 Test Loss: 1.635 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 4 cost time: 2.1589200496673584
Epoch: 4, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.635 Vali Acc: 0.180 Test Loss: 1.635 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 2.22873854637146
Epoch: 5, Steps: 4 | Train Loss: 1.265 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 6 cost time: 2.0097262859344482
Epoch: 6, Steps: 4 | Train Loss: 1.213 Vali Loss: 1.640 Vali Acc: 0.220 Test Loss: 1.640 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3069562911987305
Epoch: 7, Steps: 4 | Train Loss: 0.956 Vali Loss: 1.641 Vali Acc: 0.280 Test Loss: 1.641 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 2.157494068145752
Epoch: 8, Steps: 4 | Train Loss: 0.869 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 2.0311996936798096
Epoch: 9, Steps: 4 | Train Loss: 0.801 Vali Loss: 1.653 Vali Acc: 0.300 Test Loss: 1.653 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.181185722351074
Epoch: 10, Steps: 4 | Train Loss: 0.585 Vali Loss: 1.649 Vali Acc: 0.320 Test Loss: 1.649 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 11 cost time: 2.0444724559783936
Epoch: 11, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.155850887298584
Epoch: 12, Steps: 4 | Train Loss: 0.569 Vali Loss: 1.649 Vali Acc: 0.300 Test Loss: 1.649 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.084486246109009
Epoch: 13, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.672 Vali Acc: 0.300 Test Loss: 1.672 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.085528612136841
Epoch: 14, Steps: 4 | Train Loss: 0.370 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.215514659881592
Epoch: 15, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.739 Vali Acc: 0.300 Test Loss: 1.739 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2314345836639404
Epoch: 16, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.810 Vali Acc: 0.340 Test Loss: 1.810 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339982).  Saving model ...
Epoch: 17 cost time: 1.9404382705688477
Epoch: 17, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.812 Vali Acc: 0.340 Test Loss: 1.812 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1382405757904053
Epoch: 18, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.785 Vali Acc: 0.340 Test Loss: 1.785 Test Acc: 0.340
Validation loss decreased (-0.339982 --> -0.339982).  Saving model ...
Epoch: 19 cost time: 2.306718587875366
Epoch: 19, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.766 Vali Acc: 0.300 Test Loss: 1.766 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.34930682182312
Epoch: 20, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.778 Vali Acc: 0.300 Test Loss: 1.778 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.373265266418457
Epoch: 21, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.808 Vali Acc: 0.320 Test Loss: 1.808 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.4566471576690674
Epoch: 22, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.850 Vali Acc: 0.340 Test Loss: 1.850 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3600783348083496
Epoch: 23, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.884 Vali Acc: 0.340 Test Loss: 1.884 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2130286693573
Epoch: 24, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.901 Vali Acc: 0.340 Test Loss: 1.901 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2442424297332764
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.909 Vali Acc: 0.340 Test Loss: 1.909 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.24426007270813
Epoch: 26, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.920 Vali Acc: 0.320 Test Loss: 1.920 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3836748600006104
Epoch: 27, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.934 Vali Acc: 0.320 Test Loss: 1.934 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.228076457977295
Epoch: 28, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.951 Vali Acc: 0.340 Test Loss: 1.951 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.532920598983765
Epoch: 1, Steps: 4 | Train Loss: 1.698 Vali Loss: 1.645 Vali Acc: 0.200 Test Loss: 1.645 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.731091260910034
Epoch: 2, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.648 Vali Acc: 0.200 Test Loss: 1.648 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.431213855743408
Epoch: 3, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.646 Vali Acc: 0.200 Test Loss: 1.646 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.564319372177124
Epoch: 4, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.650 Vali Acc: 0.220 Test Loss: 1.650 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 2.2787046432495117
Epoch: 5, Steps: 4 | Train Loss: 1.238 Vali Loss: 1.660 Vali Acc: 0.160 Test Loss: 1.660 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.396366596221924
Epoch: 6, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.672 Vali Acc: 0.180 Test Loss: 1.672 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5162110328674316
Epoch: 7, Steps: 4 | Train Loss: 0.945 Vali Loss: 1.686 Vali Acc: 0.140 Test Loss: 1.686 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2836177349090576
Epoch: 8, Steps: 4 | Train Loss: 0.940 Vali Loss: 1.700 Vali Acc: 0.140 Test Loss: 1.700 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.220381259918213
Epoch: 9, Steps: 4 | Train Loss: 0.791 Vali Loss: 1.715 Vali Acc: 0.140 Test Loss: 1.715 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.422337293624878
Epoch: 10, Steps: 4 | Train Loss: 0.634 Vali Loss: 1.720 Vali Acc: 0.160 Test Loss: 1.720 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3411333560943604
Epoch: 11, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.716 Vali Acc: 0.180 Test Loss: 1.716 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7714741230010986
Epoch: 12, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7162656784057617
Epoch: 13, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.763 Vali Acc: 0.200 Test Loss: 1.763 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6876959800720215
Epoch: 14, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.795 Vali Acc: 0.200 Test Loss: 1.795 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.541723728179932
Epoch: 1, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.602 Vali Acc: 0.180 Test Loss: 1.602 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.7022411823272705
Epoch: 2, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.255800247192383
Epoch: 3, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.604 Vali Acc: 0.220 Test Loss: 1.604 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 2.336519241333008
Epoch: 4, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.607 Vali Acc: 0.200 Test Loss: 1.607 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2435829639434814
Epoch: 5, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.392453670501709
Epoch: 6, Steps: 4 | Train Loss: 1.181 Vali Loss: 1.625 Vali Acc: 0.220 Test Loss: 1.625 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.314319133758545
Epoch: 7, Steps: 4 | Train Loss: 0.962 Vali Loss: 1.631 Vali Acc: 0.200 Test Loss: 1.631 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.364522933959961
Epoch: 8, Steps: 4 | Train Loss: 0.902 Vali Loss: 1.636 Vali Acc: 0.200 Test Loss: 1.636 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4081130027770996
Epoch: 9, Steps: 4 | Train Loss: 0.863 Vali Loss: 1.644 Vali Acc: 0.200 Test Loss: 1.644 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2576329708099365
Epoch: 10, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.648 Vali Acc: 0.200 Test Loss: 1.648 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.30949068069458
Epoch: 11, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.646 Vali Acc: 0.220 Test Loss: 1.646 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2922768592834473
Epoch: 12, Steps: 4 | Train Loss: 0.611 Vali Loss: 1.654 Vali Acc: 0.220 Test Loss: 1.654 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2515361309051514
Epoch: 13, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.679 Vali Acc: 0.220 Test Loss: 1.679 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.091693639755249
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.565 Vali Acc: 0.320 Test Loss: 1.565 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 2.378718376159668
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.571 Vali Acc: 0.320 Test Loss: 1.571 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.34140944480896
Epoch: 3, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.572 Vali Acc: 0.300 Test Loss: 1.572 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.455005645751953
Epoch: 4, Steps: 4 | Train Loss: 1.451 Vali Loss: 1.579 Vali Acc: 0.300 Test Loss: 1.579 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2720460891723633
Epoch: 5, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.591 Vali Acc: 0.300 Test Loss: 1.591 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.474733591079712
Epoch: 6, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.600 Vali Acc: 0.300 Test Loss: 1.600 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.140772581100464
Epoch: 7, Steps: 4 | Train Loss: 1.064 Vali Loss: 1.608 Vali Acc: 0.260 Test Loss: 1.608 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.502955198287964
Epoch: 8, Steps: 4 | Train Loss: 0.964 Vali Loss: 1.614 Vali Acc: 0.260 Test Loss: 1.614 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.49955153465271
Epoch: 9, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.618 Vali Acc: 0.260 Test Loss: 1.618 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3466837406158447
Epoch: 10, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.620 Vali Acc: 0.240 Test Loss: 1.620 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.258052349090576
Epoch: 11, Steps: 4 | Train Loss: 0.542 Vali Loss: 1.617 Vali Acc: 0.280 Test Loss: 1.617 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.571067810058594
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 2.853363275527954
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5578866004943848
Epoch: 3, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2186074256896973
Epoch: 4, Steps: 4 | Train Loss: 1.444 Vali Loss: 1.538 Vali Acc: 0.220 Test Loss: 1.538 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.367490530014038
Epoch: 5, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.554396629333496
Epoch: 6, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.548 Vali Acc: 0.300 Test Loss: 1.548 Test Acc: 0.300
Validation loss decreased (-0.239985 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 2.3463006019592285
Epoch: 7, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.547 Vali Acc: 0.340 Test Loss: 1.547 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339985).  Saving model ...
Epoch: 8 cost time: 2.4533872604370117
Epoch: 8, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.543 Vali Acc: 0.300 Test Loss: 1.543 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2257533073425293
Epoch: 9, Steps: 4 | Train Loss: 1.016 Vali Loss: 1.542 Vali Acc: 0.280 Test Loss: 1.542 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.118525505065918
Epoch: 10, Steps: 4 | Train Loss: 0.811 Vali Loss: 1.542 Vali Acc: 0.280 Test Loss: 1.542 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.441612958908081
Epoch: 11, Steps: 4 | Train Loss: 0.585 Vali Loss: 1.535 Vali Acc: 0.300 Test Loss: 1.535 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3571126461029053
Epoch: 12, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.533 Vali Acc: 0.280 Test Loss: 1.533 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3743467330932617
Epoch: 13, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.552 Vali Acc: 0.320 Test Loss: 1.552 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.249094247817993
Epoch: 14, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.590 Vali Acc: 0.280 Test Loss: 1.590 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3788199424743652
Epoch: 15, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.635 Vali Acc: 0.280 Test Loss: 1.635 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2934279441833496
Epoch: 16, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.696 Vali Acc: 0.260 Test Loss: 1.696 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.445916175842285
Epoch: 17, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.721 Vali Acc: 0.280 Test Loss: 1.721 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.512704133987427
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.589 Vali Acc: 0.160 Test Loss: 1.589 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.3481433391571045
Epoch: 2, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.592 Vali Acc: 0.180 Test Loss: 1.592 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 2.2512524127960205
Epoch: 3, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.592 Vali Acc: 0.200 Test Loss: 1.592 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 2.532458543777466
Epoch: 4, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.596 Vali Acc: 0.200 Test Loss: 1.596 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.561622381210327
Epoch: 5, Steps: 4 | Train Loss: 1.448 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 2.510167360305786
Epoch: 6, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.598 Vali Acc: 0.200 Test Loss: 1.598 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.362424850463867
Epoch: 7, Steps: 4 | Train Loss: 1.294 Vali Loss: 1.594 Vali Acc: 0.220 Test Loss: 1.594 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3670105934143066
Epoch: 8, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.591 Vali Acc: 0.160 Test Loss: 1.591 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.333996295928955
Epoch: 9, Steps: 4 | Train Loss: 1.252 Vali Loss: 1.590 Vali Acc: 0.180 Test Loss: 1.590 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.414107322692871
Epoch: 10, Steps: 4 | Train Loss: 1.068 Vali Loss: 1.592 Vali Acc: 0.200 Test Loss: 1.592 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1804800033569336
Epoch: 11, Steps: 4 | Train Loss: 0.896 Vali Loss: 1.585 Vali Acc: 0.220 Test Loss: 1.585 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.403796672821045
Epoch: 12, Steps: 4 | Train Loss: 1.047 Vali Loss: 1.566 Vali Acc: 0.220 Test Loss: 1.566 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.190115213394165
Epoch: 13, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.556 Vali Acc: 0.180 Test Loss: 1.556 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1757967472076416
Epoch: 14, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.549 Vali Acc: 0.160 Test Loss: 1.549 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.378438711166382
Epoch: 15, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.555 Vali Acc: 0.160 Test Loss: 1.555 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 239429
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
fourier enhanced block used!
modes=32, index=[0, 2, 4, 8, 13, 22, 28, 30, 34, 35, 37, 39, 58, 65, 69, 75, 78, 81, 83, 87, 89, 90, 96, 105, 106, 111, 112, 117, 120, 121, 126, 129]
fourier enhanced block used!
modes=32, index=[0, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21, 24, 26, 28, 29, 33, 39, 40, 41, 47, 50, 51, 52, 54, 58, 59, 60, 61, 63, 64, 66]
 fourier enhanced cross attention used!
modes_q=32, index_q=[1, 2, 4, 5, 6, 8, 12, 14, 15, 16, 20, 21, 22, 23, 25, 28, 29, 30, 31, 33, 36, 37, 42, 45, 46, 50, 51, 57, 58, 60, 61, 64]
modes_kv=32, index_kv=[0, 4, 29, 34, 35, 37, 45, 50, 52, 57, 58, 67, 71, 77, 83, 89, 90, 91, 92, 99, 102, 105, 109, 112, 113, 121, 124, 126, 127, 132, 133, 134]
>>>>>>>start training : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.475584983825684
Epoch: 1, Steps: 4 | Train Loss: 1.709 Vali Loss: 1.602 Vali Acc: 0.140 Test Loss: 1.602 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 2.195570707321167
Epoch: 2, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.606 Vali Acc: 0.140 Test Loss: 1.606 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2539596557617188
Epoch: 3, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.608 Vali Acc: 0.160 Test Loss: 1.608 Test Acc: 0.160
Validation loss decreased (-0.139984 --> -0.159984).  Saving model ...
Epoch: 4 cost time: 2.442678689956665
Epoch: 4, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.610 Vali Acc: 0.160 Test Loss: 1.610 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.161924123764038
Epoch: 5, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.613 Vali Acc: 0.160 Test Loss: 1.613 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3643693923950195
Epoch: 6, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.610 Vali Acc: 0.180 Test Loss: 1.610 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 7 cost time: 2.518057346343994
Epoch: 7, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.605 Vali Acc: 0.160 Test Loss: 1.605 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4742860794067383
Epoch: 8, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.599 Vali Acc: 0.160 Test Loss: 1.599 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.79744029045105
Epoch: 9, Steps: 4 | Train Loss: 1.202 Vali Loss: 1.593 Vali Acc: 0.140 Test Loss: 1.593 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6212544441223145
Epoch: 10, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.592 Vali Acc: 0.100 Test Loss: 1.592 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.771022081375122
Epoch: 11, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.586 Vali Acc: 0.140 Test Loss: 1.586 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5869874954223633
Epoch: 12, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.571 Vali Acc: 0.140 Test Loss: 1.571 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6103625297546387
Epoch: 13, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.569 Vali Acc: 0.140 Test Loss: 1.569 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.389016628265381
Epoch: 14, Steps: 4 | Train Loss: 0.801 Vali Loss: 1.574 Vali Acc: 0.160 Test Loss: 1.574 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3034441471099854
Epoch: 15, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.580 Vali Acc: 0.140 Test Loss: 1.580 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4340426921844482
Epoch: 16, Steps: 4 | Train Loss: 0.576 Vali Loss: 1.596 Vali Acc: 0.140 Test Loss: 1.596 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_FEDformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 239429
model size : 2.16MB
