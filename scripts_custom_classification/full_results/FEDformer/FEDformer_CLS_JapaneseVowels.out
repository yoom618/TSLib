Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.543484926223755
Epoch: 1, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.623 Vali Acc: 0.638 Test Loss: 1.623 Test Acc: 0.638
Validation loss decreased (inf --> -0.637822).  Saving model ...
Epoch: 2 cost time: 3.2804336547851562
Epoch: 2, Steps: 17 | Train Loss: 1.309 Vali Loss: 0.974 Vali Acc: 0.735 Test Loss: 0.974 Test Acc: 0.735
Validation loss decreased (-0.637822 --> -0.735125).  Saving model ...
Epoch: 3 cost time: 3.131706476211548
Epoch: 3, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.548 Vali Acc: 0.857 Test Loss: 0.548 Test Acc: 0.857
Validation loss decreased (-0.735125 --> -0.856751).  Saving model ...
Epoch: 4 cost time: 3.1529057025909424
Epoch: 4, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.342 Vali Acc: 0.895 Test Loss: 0.342 Test Acc: 0.895
Validation loss decreased (-0.856751 --> -0.894591).  Saving model ...
Epoch: 5 cost time: 3.405240774154663
Epoch: 5, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.894591 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 3.085153579711914
Epoch: 6, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2551069259643555
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.945944 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 2.8189995288848877
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.123595714569092
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1702589988708496
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3388350009918213
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2744603157043457
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 3.1522560119628906
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 3.442291021347046
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 3.2128026485443115
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5032308101654053
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.330122232437134
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1043241024017334
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.156797409057617
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1989147663116455
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.247745990753174
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0580248832702637
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8903019428253174
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.910750150680542
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.668618679046631
Epoch: 1, Steps: 17 | Train Loss: 2.113 Vali Loss: 1.727 Vali Acc: 0.589 Test Loss: 1.727 Test Acc: 0.589
Validation loss decreased (inf --> -0.589172).  Saving model ...
Epoch: 2 cost time: 3.225965738296509
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.069 Vali Acc: 0.727 Test Loss: 1.069 Test Acc: 0.727
Validation loss decreased (-0.589172 --> -0.727016).  Saving model ...
Epoch: 3 cost time: 3.334277868270874
Epoch: 3, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.590 Vali Acc: 0.851 Test Loss: 0.590 Test Acc: 0.851
Validation loss decreased (-0.727016 --> -0.851345).  Saving model ...
Epoch: 4 cost time: 3.2379701137542725
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.415 Vali Acc: 0.876 Test Loss: 0.415 Test Acc: 0.876
Validation loss decreased (-0.851345 --> -0.875672).  Saving model ...
Epoch: 5 cost time: 3.5692362785339355
Epoch: 5, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
Validation loss decreased (-0.875672 --> -0.927025).  Saving model ...
Epoch: 6 cost time: 3.3715298175811768
Epoch: 6, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
Validation loss decreased (-0.927025 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 3.589956283569336
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.932430 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 3.4531314373016357
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1150858402252197
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 3.275371551513672
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5492501258850098
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.624821901321411
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.344588279724121
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.294790267944336
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 3.2437901496887207
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.101909637451172
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3211307525634766
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.13857364654541
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4902851581573486
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5026042461395264
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.24958872795105
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 3.3637256622314453
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.190000534057617
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4361624717712402
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2480409145355225
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 3.2161989212036133
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.375476837158203
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3241076469421387
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2195851802825928
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3860676288604736
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.1338768005371094
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.158315420150757
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4485766887664795
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.2412941455841064
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.1122334003448486
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.895643472671509
Epoch: 1, Steps: 17 | Train Loss: 2.129 Vali Loss: 1.850 Vali Acc: 0.522 Test Loss: 1.850 Test Acc: 0.522
Validation loss decreased (inf --> -0.521603).  Saving model ...
Epoch: 2 cost time: 3.309375524520874
Epoch: 2, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.250 Vali Acc: 0.692 Test Loss: 1.250 Test Acc: 0.692
Validation loss decreased (-0.521603 --> -0.691879).  Saving model ...
Epoch: 3 cost time: 3.20835542678833
Epoch: 3, Steps: 17 | Train Loss: 0.872 Vali Loss: 0.699 Vali Acc: 0.843 Test Loss: 0.699 Test Acc: 0.843
Validation loss decreased (-0.691879 --> -0.843236).  Saving model ...
Epoch: 4 cost time: 3.44197416305542
Epoch: 4, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.469 Vali Acc: 0.854 Test Loss: 0.469 Test Acc: 0.854
Validation loss decreased (-0.843236 --> -0.854049).  Saving model ...
Epoch: 5 cost time: 3.1354944705963135
Epoch: 5, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
Validation loss decreased (-0.854049 --> -0.913511).  Saving model ...
Epoch: 6 cost time: 3.203842878341675
Epoch: 6, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.51238751411438
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.914 Test Loss: 0.276 Test Acc: 0.914
Validation loss decreased (-0.913511 --> -0.913511).  Saving model ...
Epoch: 8 cost time: 3.285046100616455
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.927 Test Loss: 0.232 Test Acc: 0.927
Validation loss decreased (-0.913511 --> -0.927025).  Saving model ...
Epoch: 9 cost time: 3.279092788696289
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
Validation loss decreased (-0.927025 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 3.193622350692749
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.237299919128418
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5674500465393066
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 13 cost time: 3.319091796875
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.5179965496063232
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 3.4805893898010254
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 3.3303287029266357
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.306370258331299
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.884208917617798
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.164461851119995
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 3.372387409210205
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.279768466949463
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.298801898956299
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3450636863708496
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.434819221496582
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3204057216644287
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 3.240509510040283
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 3.1319527626037598
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3508784770965576
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2148756980895996
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 3.477471113204956
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.280130624771118
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 3.198307991027832
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.332714080810547
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.065871238708496
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.021198272705078
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.272683620452881
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2217984199523926
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 3.2953789234161377
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 2.993541717529297
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.8687639236450195
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.3836708068847656
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.1105427742004395
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.942014455795288
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.3511834144592285
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.1672208309173584
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.2087204456329346
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.333444833755493
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.018531322479248
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.683236122131348
Epoch: 1, Steps: 17 | Train Loss: 2.132 Vali Loss: 1.868 Vali Acc: 0.516 Test Loss: 1.868 Test Acc: 0.516
Validation loss decreased (inf --> -0.516198).  Saving model ...
Epoch: 2 cost time: 2.812631368637085
Epoch: 2, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.247 Vali Acc: 0.741 Test Loss: 1.247 Test Acc: 0.741
Validation loss decreased (-0.516198 --> -0.740528).  Saving model ...
Epoch: 3 cost time: 3.107604503631592
Epoch: 3, Steps: 17 | Train Loss: 0.967 Vali Loss: 0.654 Vali Acc: 0.838 Test Loss: 0.654 Test Acc: 0.838
Validation loss decreased (-0.740528 --> -0.837831).  Saving model ...
Epoch: 4 cost time: 3.1589691638946533
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.424 Vali Acc: 0.868 Test Loss: 0.424 Test Acc: 0.868
Validation loss decreased (-0.837831 --> -0.867563).  Saving model ...
Epoch: 5 cost time: 3.3508999347686768
Epoch: 5, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.867563 --> -0.902700).  Saving model ...
Epoch: 6 cost time: 3.40570330619812
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.902700 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 3.0934948921203613
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1089556217193604
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0691704750061035
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.940539 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 3.1486027240753174
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.332543134689331
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1590843200683594
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 3.1162350177764893
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1413354873657227
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2632758617401123
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2048051357269287
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.198580265045166
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1834325790405273
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.121997833251953
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.3234848976135254
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.080049753189087
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.951861619949341
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.795209169387817
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 1.829 Vali Acc: 0.522 Test Loss: 1.829 Test Acc: 0.522
Validation loss decreased (inf --> -0.521603).  Saving model ...
Epoch: 2 cost time: 3.114628553390503
Epoch: 2, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.134 Vali Acc: 0.789 Test Loss: 1.134 Test Acc: 0.789
Validation loss decreased (-0.521603 --> -0.789178).  Saving model ...
Epoch: 3 cost time: 3.2827248573303223
Epoch: 3, Steps: 17 | Train Loss: 1.061 Vali Loss: 0.561 Vali Acc: 0.854 Test Loss: 0.561 Test Acc: 0.854
Validation loss decreased (-0.789178 --> -0.854048).  Saving model ...
Epoch: 4 cost time: 3.1878366470336914
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.377 Vali Acc: 0.878 Test Loss: 0.377 Test Acc: 0.878
Validation loss decreased (-0.854048 --> -0.878375).  Saving model ...
Epoch: 5 cost time: 3.1544651985168457
Epoch: 5, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.300 Vali Acc: 0.905 Test Loss: 0.300 Test Acc: 0.905
Validation loss decreased (-0.878375 --> -0.905402).  Saving model ...
Epoch: 6 cost time: 3.087393045425415
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.905402 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 3.1259357929229736
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3643524646759033
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.223 Vali Acc: 0.924 Test Loss: 0.223 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.180379867553711
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.945944 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 3.1288235187530518
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.330500841140747
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.221472978591919
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.219041585922241
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.199089527130127
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3081164360046387
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2641284465789795
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.221843719482422
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 3.3314359188079834
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1952545642852783
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.273811101913452
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4018094539642334
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5425148010253906
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3572611808776855
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.6981101036071777
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4734995365142822
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3303346633911133
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.503441095352173
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.0685625076293945
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 1.804 Vali Acc: 0.543 Test Loss: 1.804 Test Acc: 0.543
Validation loss decreased (inf --> -0.543225).  Saving model ...
Epoch: 2 cost time: 3.1637046337127686
Epoch: 2, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.100 Vali Acc: 0.792 Test Loss: 1.100 Test Acc: 0.792
Validation loss decreased (-0.543225 --> -0.791881).  Saving model ...
Epoch: 3 cost time: 3.2421762943267822
Epoch: 3, Steps: 17 | Train Loss: 0.996 Vali Loss: 0.567 Vali Acc: 0.865 Test Loss: 0.567 Test Acc: 0.865
Validation loss decreased (-0.791881 --> -0.864859).  Saving model ...
Epoch: 4 cost time: 3.5668177604675293
Epoch: 4, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
Validation loss decreased (-0.864859 --> -0.883780).  Saving model ...
Epoch: 5 cost time: 3.324216842651367
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.297 Vali Acc: 0.916 Test Loss: 0.297 Test Acc: 0.916
Validation loss decreased (-0.883780 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 3.400359630584717
Epoch: 6, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.139 Vali Acc: 0.943 Test Loss: 0.139 Test Acc: 0.943
Validation loss decreased (-0.916213 --> -0.943242).  Saving model ...
Epoch: 7 cost time: 3.3162424564361572
Epoch: 7, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.415665864944458
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4375970363616943
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.943242 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 3.3673810958862305
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1262307167053223
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.404850482940674
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6444523334503174
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.372955799102783
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4031457901000977
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 3.5682530403137207
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 3.326474905014038
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 3.1323678493499756
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1873815059661865
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1602580547332764
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3515360355377197
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 3.5124351978302
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.236121416091919
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.195653200149536
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.17585825920105
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.9853620529174805
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 3.139698028564453
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1929852962493896
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.163754463195801
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.3712897300720215
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0869734287261963
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 3.3010683059692383
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5144166946411133
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.267977237701416
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.315995693206787
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.132659912109375
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.219877243041992
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.3111777305603027
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.267824172973633
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.202347993850708
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 3.360107898712158
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 3.2752954959869385
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.5355288982391357
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.322012186050415
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.24554181098938
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.200676202774048
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.414422035217285
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.1586244106292725
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.5843238830566406
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.5673272609710693
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.330997943878174
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.202543497085571
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
Validation loss decreased (inf --> -0.083762).  Saving model ...
Epoch: 2 cost time: 3.3698060512542725
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.185152530670166
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5022096633911133
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 5 cost time: 3.383228063583374
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 6 cost time: 3.518979549407959
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2233808040618896
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.350066661834717
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6081080436706543
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1433966159820557
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4144790172576904
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.568960428237915
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 13 cost time: 3.3557753562927246
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.567589044570923
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 15 cost time: 3.420747995376587
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.256643295288086
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.106163740158081
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.084 Test Loss: 2.196 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.280489444732666
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.333240032196045
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1691794395446777
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.383924961090088
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3572475910186768
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.314697265625
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.4916136264801025
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.08378378378378379
model parameter : 12497929
model size : 67.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.349765777587891
Epoch: 1, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.687 Vali Acc: 0.568 Test Loss: 1.687 Test Acc: 0.568
Validation loss decreased (inf --> -0.567551).  Saving model ...
Epoch: 2 cost time: 3.5353031158447266
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.078 Vali Acc: 0.714 Test Loss: 1.078 Test Acc: 0.714
Validation loss decreased (-0.567551 --> -0.713503).  Saving model ...
Epoch: 3 cost time: 3.3719286918640137
Epoch: 3, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.621 Vali Acc: 0.843 Test Loss: 0.621 Test Acc: 0.843
Validation loss decreased (-0.713503 --> -0.843237).  Saving model ...
Epoch: 4 cost time: 3.5315122604370117
Epoch: 4, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.318 Vali Acc: 0.908 Test Loss: 0.318 Test Acc: 0.908
Validation loss decreased (-0.843237 --> -0.908105).  Saving model ...
Epoch: 5 cost time: 3.204873561859131
Epoch: 5, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.236 Vali Acc: 0.938 Test Loss: 0.236 Test Acc: 0.938
Validation loss decreased (-0.908105 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 3.218071699142456
Epoch: 6, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.221031427383423
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 3.056509017944336
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 3.3212311267852783
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 3.153902292251587
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 3.2559897899627686
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.996659278869629
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 3.1402533054351807
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2060599327087402
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.225541114807129
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 3.0018317699432373
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2909095287323
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 3.2471885681152344
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1363441944122314
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.337129592895508
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.250673532485962
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2164306640625
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2037363052368164
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.368607997894287
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.28406023979187
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.366541624069214
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.370868682861328
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.79533052444458
Epoch: 1, Steps: 17 | Train Loss: 2.073 Vali Loss: 1.777 Vali Acc: 0.559 Test Loss: 1.777 Test Acc: 0.559
Validation loss decreased (inf --> -0.559442).  Saving model ...
Epoch: 2 cost time: 3.077812671661377
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.164 Vali Acc: 0.711 Test Loss: 1.164 Test Acc: 0.711
Validation loss decreased (-0.559442 --> -0.710799).  Saving model ...
Epoch: 3 cost time: 3.211411952972412
Epoch: 3, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
Validation loss decreased (-0.710799 --> -0.821615).  Saving model ...
Epoch: 4 cost time: 3.065016508102417
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.821615 --> -0.899997).  Saving model ...
Epoch: 5 cost time: 3.15525484085083
Epoch: 5, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.257 Vali Acc: 0.927 Test Loss: 0.257 Test Acc: 0.927
Validation loss decreased (-0.899997 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 3.192671298980713
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.202 Vali Acc: 0.924 Test Loss: 0.202 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1430249214172363
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
Validation loss decreased (-0.927024 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 3.1205503940582275
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.315469264984131
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0434210300445557
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 3.3778562545776367
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2029643058776855
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.244513750076294
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 3.301539182662964
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2926535606384277
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 3.40376877784729
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.413217067718506
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 3.186803102493286
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2651402950286865
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 3.402400016784668
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3956515789031982
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.224374532699585
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1779143810272217
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 3.4401276111602783
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 3.3088059425354004
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 3.266040563583374
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.374345541000366
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3379454612731934
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 29 cost time: 3.253234386444092
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3846094608306885
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.657106399536133
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3368542194366455
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.4738729000091553
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.2443630695343018
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3304121494293213
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.2501978874206543
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.402998208999634
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.191206932067871
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.7459611892700195
Epoch: 1, Steps: 17 | Train Loss: 2.130 Vali Loss: 1.898 Vali Acc: 0.459 Test Loss: 1.898 Test Acc: 0.459
Validation loss decreased (inf --> -0.459440).  Saving model ...
Epoch: 2 cost time: 3.1523020267486572
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.331 Vali Acc: 0.651 Test Loss: 1.331 Test Acc: 0.651
Validation loss decreased (-0.459440 --> -0.651338).  Saving model ...
Epoch: 3 cost time: 3.0315451622009277
Epoch: 3, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
Validation loss decreased (-0.651338 --> -0.821615).  Saving model ...
Epoch: 4 cost time: 3.136863946914673
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
Validation loss decreased (-0.821615 --> -0.878374).  Saving model ...
Epoch: 5 cost time: 2.9799554347991943
Epoch: 5, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.290 Vali Acc: 0.914 Test Loss: 0.290 Test Acc: 0.914
Validation loss decreased (-0.878374 --> -0.913511).  Saving model ...
Epoch: 6 cost time: 3.2766058444976807
Epoch: 6, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.230 Vali Acc: 0.916 Test Loss: 0.230 Test Acc: 0.916
Validation loss decreased (-0.913511 --> -0.916214).  Saving model ...
Epoch: 7 cost time: 3.1490402221679688
Epoch: 7, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.916214 --> -0.921619).  Saving model ...
Epoch: 8 cost time: 2.9383962154388428
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
Validation loss decreased (-0.921619 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 3.157334089279175
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 3.2287163734436035
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 2.920562267303467
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 3.1523325443267822
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9351325035095215
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 3.0406455993652344
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9721899032592773
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.865762948989868
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 3.0265092849731445
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 18 cost time: 2.9880731105804443
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 3.0198614597320557
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 3.2049219608306885
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1599373817443848
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.175539016723633
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2207398414611816
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0115609169006348
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.959679365158081
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4448490142822266
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 2.966653823852539
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9999592304229736
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 3.4383277893066406
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3901655673980713
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2545886039733887
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.041189432144165
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.0786473751068115
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.9540340900421143
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.0942091941833496
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.31249737739563
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.059781551361084
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.269218683242798
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.864758729934692
Epoch: 1, Steps: 17 | Train Loss: 2.163 Vali Loss: 1.900 Vali Acc: 0.438 Test Loss: 1.900 Test Acc: 0.438
Validation loss decreased (inf --> -0.437819).  Saving model ...
Epoch: 2 cost time: 3.0850446224212646
Epoch: 2, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.306 Vali Acc: 0.730 Test Loss: 1.306 Test Acc: 0.730
Validation loss decreased (-0.437819 --> -0.729717).  Saving model ...
Epoch: 3 cost time: 3.333038568496704
Epoch: 3, Steps: 17 | Train Loss: 1.026 Vali Loss: 0.657 Vali Acc: 0.851 Test Loss: 0.657 Test Acc: 0.851
Validation loss decreased (-0.729717 --> -0.851345).  Saving model ...
Epoch: 4 cost time: 2.9874494075775146
Epoch: 4, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
Validation loss decreased (-0.851345 --> -0.883780).  Saving model ...
Epoch: 5 cost time: 3.237327814102173
Epoch: 5, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.271 Vali Acc: 0.919 Test Loss: 0.271 Test Acc: 0.919
Validation loss decreased (-0.883780 --> -0.918916).  Saving model ...
Epoch: 6 cost time: 3.1351935863494873
Epoch: 6, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929728).  Saving model ...
Epoch: 7 cost time: 3.1911652088165283
Epoch: 7, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.927 Test Loss: 0.222 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1759891510009766
Epoch: 8, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.929728 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 3.210564374923706
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.247441291809082
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2630159854888916
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.1231086254119873
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 3.3102359771728516
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 3.3501126766204834
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 3.4005415439605713
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.2704710960388184
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.366420030593872
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2353768348693848
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2954559326171875
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 3.3111817836761475
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.299038887023926
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1309776306152344
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3346807956695557
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.140366792678833
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9944043159484863
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2825767993927
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2243733406066895
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1141510009765625
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.03749680519104
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.855920791625977
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 1.841 Vali Acc: 0.497 Test Loss: 1.841 Test Acc: 0.497
Validation loss decreased (inf --> -0.497279).  Saving model ...
Epoch: 2 cost time: 3.1687145233154297
Epoch: 2, Steps: 17 | Train Loss: 1.815 Vali Loss: 1.165 Vali Acc: 0.765 Test Loss: 1.165 Test Acc: 0.765
Validation loss decreased (-0.497279 --> -0.764853).  Saving model ...
Epoch: 3 cost time: 3.3206357955932617
Epoch: 3, Steps: 17 | Train Loss: 1.113 Vali Loss: 0.612 Vali Acc: 0.824 Test Loss: 0.612 Test Acc: 0.824
Validation loss decreased (-0.764853 --> -0.824318).  Saving model ...
Epoch: 4 cost time: 3.4124224185943604
Epoch: 4, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.405 Vali Acc: 0.876 Test Loss: 0.405 Test Acc: 0.876
Validation loss decreased (-0.824318 --> -0.875672).  Saving model ...
Epoch: 5 cost time: 3.3587417602539062
Epoch: 5, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
Validation loss decreased (-0.875672 --> -0.918916).  Saving model ...
Epoch: 6 cost time: 3.35634183883667
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929728).  Saving model ...
Epoch: 7 cost time: 3.265962839126587
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.150690793991089
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.929728 --> -0.948647).  Saving model ...
Epoch: 9 cost time: 3.363609790802002
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1071672439575195
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 3.169950008392334
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 3.1199350357055664
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1558563709259033
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0890722274780273
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1534221172332764
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.4187421798706055
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3380379676818848
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2955446243286133
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.431208372116089
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3727619647979736
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3172194957733154
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8095948696136475
Epoch: 1, Steps: 17 | Train Loss: 2.162 Vali Loss: 1.864 Vali Acc: 0.462 Test Loss: 1.864 Test Acc: 0.462
Validation loss decreased (inf --> -0.462144).  Saving model ...
Epoch: 2 cost time: 3.0881364345550537
Epoch: 2, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.178 Vali Acc: 0.741 Test Loss: 1.178 Test Acc: 0.741
Validation loss decreased (-0.462144 --> -0.740529).  Saving model ...
Epoch: 3 cost time: 3.1212897300720215
Epoch: 3, Steps: 17 | Train Loss: 1.058 Vali Loss: 0.605 Vali Acc: 0.824 Test Loss: 0.605 Test Acc: 0.824
Validation loss decreased (-0.740529 --> -0.824318).  Saving model ...
Epoch: 4 cost time: 3.0950355529785156
Epoch: 4, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.377 Vali Acc: 0.876 Test Loss: 0.377 Test Acc: 0.876
Validation loss decreased (-0.824318 --> -0.875672).  Saving model ...
Epoch: 5 cost time: 3.10266375541687
Epoch: 5, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
Validation loss decreased (-0.875672 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 3.1738178730010986
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 3.2931976318359375
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.335653066635132
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.177980899810791
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.927 Test Loss: 0.186 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.450989246368408
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 11 cost time: 3.376605749130249
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.4164724349975586
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 3.4200754165649414
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.424384832382202
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0707671642303467
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 3.2391982078552246
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.223546266555786
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2508857250213623
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 3.4150125980377197
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 3.44730806350708
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.497281312942505
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3315317630767822
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5712602138519287
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.282181739807129
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.350933313369751
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.609652519226074
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.241940498352051
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.3401777744293213
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.243199348449707
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.077406406402588
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
Validation loss decreased (inf --> -0.094573).  Saving model ...
Epoch: 2 cost time: 3.085080862045288
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1243655681610107
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 4 cost time: 3.107787609100342
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 5 cost time: 3.119652509689331
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1657114028930664
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 7 cost time: 3.252573251724243
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.183739185333252
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2783925533294678
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.337512254714966
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.217367172241211
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 12 cost time: 3.3270375728607178
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2918131351470947
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3079400062561035
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3668107986450195
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.437577247619629
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.149559497833252
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3598804473876953
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.4104151725769043
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3772337436676025
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.5589792728424072
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.095 Test Loss: 2.197 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.0945945945945946
model parameter : 9352201
model size : 55.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.700483560562134
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 1.797 Vali Acc: 0.627 Test Loss: 1.797 Test Acc: 0.627
Validation loss decreased (inf --> -0.627009).  Saving model ...
Epoch: 2 cost time: 3.2972190380096436
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.123 Vali Acc: 0.741 Test Loss: 1.123 Test Acc: 0.741
Validation loss decreased (-0.627009 --> -0.740529).  Saving model ...
Epoch: 3 cost time: 3.0657732486724854
Epoch: 3, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.641 Vali Acc: 0.857 Test Loss: 0.641 Test Acc: 0.857
Validation loss decreased (-0.740529 --> -0.856750).  Saving model ...
Epoch: 4 cost time: 3.3006579875946045
Epoch: 4, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
Validation loss decreased (-0.856750 --> -0.883780).  Saving model ...
Epoch: 5 cost time: 3.2419397830963135
Epoch: 5, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.266 Vali Acc: 0.905 Test Loss: 0.266 Test Acc: 0.905
Validation loss decreased (-0.883780 --> -0.905403).  Saving model ...
Epoch: 6 cost time: 3.2110238075256348
Epoch: 6, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
Validation loss decreased (-0.905403 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 3.1877853870391846
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 8 cost time: 3.1675548553466797
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.938 Test Loss: 0.151 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4919941425323486
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 3.415890693664551
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3162922859191895
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3189949989318848
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 3.473780632019043
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4016032218933105
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 3.3440756797790527
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2802772521972656
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 3.4870288372039795
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.310490608215332
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 3.1909306049346924
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0835869312286377
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1472795009613037
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.359898328781128
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0461344718933105
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2042996883392334
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.052614212036133
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.3234360218048096
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.232968807220459
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.178173780441284
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8836798667907715
Epoch: 1, Steps: 17 | Train Loss: 2.162 Vali Loss: 1.871 Vali Acc: 0.551 Test Loss: 1.871 Test Acc: 0.551
Validation loss decreased (inf --> -0.551333).  Saving model ...
Epoch: 2 cost time: 3.1343371868133545
Epoch: 2, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.217 Vali Acc: 0.768 Test Loss: 1.217 Test Acc: 0.768
Validation loss decreased (-0.551333 --> -0.767555).  Saving model ...
Epoch: 3 cost time: 3.1884140968322754
Epoch: 3, Steps: 17 | Train Loss: 0.884 Vali Loss: 0.677 Vali Acc: 0.843 Test Loss: 0.677 Test Acc: 0.843
Validation loss decreased (-0.767555 --> -0.843236).  Saving model ...
Epoch: 4 cost time: 3.2320761680603027
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
Validation loss decreased (-0.843236 --> -0.862158).  Saving model ...
Epoch: 5 cost time: 3.7101736068725586
Epoch: 5, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.862158 --> -0.889186).  Saving model ...
Epoch: 6 cost time: 3.0472216606140137
Epoch: 6, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.203 Vali Acc: 0.927 Test Loss: 0.203 Test Acc: 0.927
Validation loss decreased (-0.889186 --> -0.927025).  Saving model ...
Epoch: 7 cost time: 3.0858418941497803
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 3.139275312423706
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943242).  Saving model ...
Epoch: 9 cost time: 2.9707491397857666
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 3.2579610347747803
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 11 cost time: 3.640465497970581
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.1871261596679688
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 3.3444361686706543
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.383100986480713
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 3.428112506866455
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0763986110687256
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.410365104675293
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.284353017807007
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.193368911743164
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.314317226409912
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3281302452087402
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.303666114807129
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.292185068130493
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.170055389404297
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.135375499725342
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1125710010528564
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0236246585845947
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.14182186126709
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8289995193481445
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 1.929 Vali Acc: 0.486 Test Loss: 1.929 Test Acc: 0.486
Validation loss decreased (inf --> -0.486467).  Saving model ...
Epoch: 2 cost time: 3.2192091941833496
Epoch: 2, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.358 Vali Acc: 0.746 Test Loss: 1.358 Test Acc: 0.746
Validation loss decreased (-0.486467 --> -0.745932).  Saving model ...
Epoch: 3 cost time: 3.1996216773986816
Epoch: 3, Steps: 17 | Train Loss: 1.003 Vali Loss: 0.767 Vali Acc: 0.808 Test Loss: 0.767 Test Acc: 0.808
Validation loss decreased (-0.745932 --> -0.808100).  Saving model ...
Epoch: 4 cost time: 3.052363157272339
Epoch: 4, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.447 Vali Acc: 0.857 Test Loss: 0.447 Test Acc: 0.857
Validation loss decreased (-0.808100 --> -0.856752).  Saving model ...
Epoch: 5 cost time: 3.231678009033203
Epoch: 5, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.325 Vali Acc: 0.895 Test Loss: 0.325 Test Acc: 0.895
Validation loss decreased (-0.856752 --> -0.894591).  Saving model ...
Epoch: 6 cost time: 3.2332496643066406
Epoch: 6, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.894591 --> -0.918917).  Saving model ...
Epoch: 7 cost time: 3.480271816253662
Epoch: 7, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.918917 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 3.409205675125122
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 3.5632076263427734
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 3.5084095001220703
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 3.438958168029785
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.24834942817688
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 3.3767037391662598
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.2523627281188965
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 3.3802952766418457
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.212022304534912
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1465699672698975
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3915317058563232
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.2779266834259033
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.216069459915161
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3938450813293457
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.327258586883545
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1043102741241455
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 3.207472324371338
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1923575401306152
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 3.140533924102783
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3467094898223877
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 3.390843391418457
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2932584285736084
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.314532518386841
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.288240432739258
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 32 cost time: 3.31746244430542
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.138493537902832
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.1631414890289307
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 35 cost time: 3.2194275856018066
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.417863130569458
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.272284746170044
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.341254711151123
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.33968186378479
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.123418092727661
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.4009201526641846
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.4104957580566406
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.291505813598633
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.3003158569335938
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.002655744552612
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 1.902 Vali Acc: 0.457 Test Loss: 1.902 Test Acc: 0.457
Validation loss decreased (inf --> -0.456738).  Saving model ...
Epoch: 2 cost time: 3.2897627353668213
Epoch: 2, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.304 Vali Acc: 0.757 Test Loss: 1.304 Test Acc: 0.757
Validation loss decreased (-0.456738 --> -0.756744).  Saving model ...
Epoch: 3 cost time: 3.239755153656006
Epoch: 3, Steps: 17 | Train Loss: 1.074 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.756744 --> -0.829723).  Saving model ...
Epoch: 4 cost time: 3.046720027923584
Epoch: 4, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.422 Vali Acc: 0.868 Test Loss: 0.422 Test Acc: 0.868
Validation loss decreased (-0.829723 --> -0.867563).  Saving model ...
Epoch: 5 cost time: 3.1098642349243164
Epoch: 5, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
Validation loss decreased (-0.867563 --> -0.878375).  Saving model ...
Epoch: 6 cost time: 3.0026724338531494
Epoch: 6, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.878375 --> -0.929728).  Saving model ...
Epoch: 7 cost time: 3.2195348739624023
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.927 Test Loss: 0.206 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.127070188522339
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 3.1923794746398926
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.935133 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 3.357651948928833
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.393892288208008
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2789599895477295
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4474387168884277
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.3340258598327637
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1856350898742676
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0234224796295166
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5384044647216797
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5019659996032715
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.195948600769043
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.536149024963379
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.421377658843994
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.443784236907959
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4563546180725098
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.263920307159424
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 3.2358312606811523
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 26 cost time: 3.1597700119018555
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1866700649261475
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 28 cost time: 3.2733137607574463
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2862024307250977
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4522430896759033
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 3.253666400909424
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 3.3594272136688232
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.0010058879852295
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 3.3536603450775146
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1715846061706543
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 3.513357400894165
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 3.228196859359741
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0626044273376465
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 3.1853139400482178
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.15181565284729
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.188124418258667
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.326084613800049
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.522509813308716
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.6459789276123047
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.3260691165924072
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.3420000076293945
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.5797526836395264
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.3810036182403564
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.016748666763306
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 1.840 Vali Acc: 0.470 Test Loss: 1.840 Test Acc: 0.470
Validation loss decreased (inf --> -0.470252).  Saving model ...
Epoch: 2 cost time: 3.0861172676086426
Epoch: 2, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.200 Vali Acc: 0.754 Test Loss: 1.200 Test Acc: 0.754
Validation loss decreased (-0.470252 --> -0.754042).  Saving model ...
Epoch: 3 cost time: 3.160146951675415
Epoch: 3, Steps: 17 | Train Loss: 1.136 Vali Loss: 0.691 Vali Acc: 0.819 Test Loss: 0.691 Test Acc: 0.819
Validation loss decreased (-0.754042 --> -0.818912).  Saving model ...
Epoch: 4 cost time: 3.0833404064178467
Epoch: 4, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
Validation loss decreased (-0.818912 --> -0.870266).  Saving model ...
Epoch: 5 cost time: 3.1513490676879883
Epoch: 5, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.870266 --> -0.899997).  Saving model ...
Epoch: 6 cost time: 2.8823297023773193
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
Validation loss decreased (-0.899997 --> -0.943242).  Saving model ...
Epoch: 7 cost time: 3.041947841644287
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 3.045192003250122
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.278402805328369
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 3.185136318206787
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.999992609024048
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.22646164894104
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 13 cost time: 3.0586860179901123
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 3.2229268550872803
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0825753211975098
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.194667339324951
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3065364360809326
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.259902000427246
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 3.2797327041625977
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2087209224700928
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.270946979522705
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2293972969055176
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1137142181396484
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.131507635116577
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.288900852203369
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1800613403320312
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.2120094299316406
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 3.2710254192352295
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1082842350006104
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2845804691314697
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.266843318939209
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.3002567291259766
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.3684051036834717
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 34 cost time: 3.1245741844177246
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.257058620452881
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.1021244525909424
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1873176097869873
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.3064262866973877
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.0847549438476562
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.9715354442596436
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.0469610691070557
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.016322135925293
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.151515007019043
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.890503168106079
Epoch: 1, Steps: 17 | Train Loss: 2.152 Vali Loss: 1.848 Vali Acc: 0.481 Test Loss: 1.848 Test Acc: 0.481
Validation loss decreased (inf --> -0.481063).  Saving model ...
Epoch: 2 cost time: 3.2290327548980713
Epoch: 2, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.204 Vali Acc: 0.759 Test Loss: 1.204 Test Acc: 0.759
Validation loss decreased (-0.481063 --> -0.759447).  Saving model ...
Epoch: 3 cost time: 3.2134947776794434
Epoch: 3, Steps: 17 | Train Loss: 1.095 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.759447 --> -0.810804).  Saving model ...
Epoch: 4 cost time: 3.2212281227111816
Epoch: 4, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.393 Vali Acc: 0.881 Test Loss: 0.393 Test Acc: 0.881
Validation loss decreased (-0.810804 --> -0.881077).  Saving model ...
Epoch: 5 cost time: 3.330471992492676
Epoch: 5, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.294 Vali Acc: 0.895 Test Loss: 0.294 Test Acc: 0.895
Validation loss decreased (-0.881077 --> -0.894592).  Saving model ...
Epoch: 6 cost time: 3.3380467891693115
Epoch: 6, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.894592 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 3.2397680282592773
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 3.4706969261169434
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3084235191345215
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.948647 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 3.3703787326812744
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.410055637359619
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3732998371124268
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.414397954940796
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3202664852142334
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4078972339630127
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2307751178741455
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.229106903076172
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1703758239746094
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2868850231170654
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.030470848083496
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (inf --> -0.064843).  Saving model ...
Epoch: 2 cost time: 3.1273305416107178
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 3 cost time: 2.979177951812744
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 4 cost time: 3.367445707321167
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0629093647003174
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 6 cost time: 2.9964473247528076
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0989954471588135
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1062211990356445
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.383845329284668
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.388399839401245
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3665854930877686
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5880820751190186
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.454739570617676
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1956675052642822
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.4062201976776123
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.06486486486486487
model parameter : 7779337
model size : 49.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.798704147338867
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 1.807 Vali Acc: 0.538 Test Loss: 1.807 Test Acc: 0.538
Validation loss decreased (inf --> -0.537820).  Saving model ...
Epoch: 2 cost time: 2.9970149993896484
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.149 Vali Acc: 0.751 Test Loss: 1.149 Test Acc: 0.751
Validation loss decreased (-0.537820 --> -0.751340).  Saving model ...
Epoch: 3 cost time: 2.9934606552124023
Epoch: 3, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.696 Vali Acc: 0.805 Test Loss: 0.696 Test Acc: 0.805
Validation loss decreased (-0.751340 --> -0.805398).  Saving model ...
Epoch: 4 cost time: 3.1234049797058105
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.384 Vali Acc: 0.897 Test Loss: 0.384 Test Acc: 0.897
Validation loss decreased (-0.805398 --> -0.897293).  Saving model ...
Epoch: 5 cost time: 3.251389265060425
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.279 Vali Acc: 0.914 Test Loss: 0.279 Test Acc: 0.914
Validation loss decreased (-0.897293 --> -0.913511).  Saving model ...
Epoch: 6 cost time: 3.0619747638702393
Epoch: 6, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (-0.913511 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 3.0040931701660156
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 8 cost time: 2.99456524848938
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.058283567428589
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 10 cost time: 3.05696964263916
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 11 cost time: 3.0632197856903076
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1152725219726562
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 3.19657826423645
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.387380361557007
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 3.306166887283325
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.436716079711914
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 3.2963197231292725
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.340806245803833
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3614909648895264
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5384223461151123
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.3307344913482666
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 3.4547009468078613
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.353634834289551
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 3.158092975616455
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.63447904586792
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3932836055755615
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.356971502304077
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 3.4283125400543213
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2567055225372314
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1230835914611816
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.119050979614258
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.4472439289093018
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.3967583179473877
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.4761006832122803
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.4177980422973633
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.225862503051758
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.1141293048858643
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.579324722290039
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 1.901 Vali Acc: 0.484 Test Loss: 1.901 Test Acc: 0.484
Validation loss decreased (inf --> -0.483765).  Saving model ...
Epoch: 2 cost time: 3.2170770168304443
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.259 Vali Acc: 0.730 Test Loss: 1.259 Test Acc: 0.730
Validation loss decreased (-0.483765 --> -0.729717).  Saving model ...
Epoch: 3 cost time: 2.9755096435546875
Epoch: 3, Steps: 17 | Train Loss: 0.948 Vali Loss: 0.737 Vali Acc: 0.805 Test Loss: 0.737 Test Acc: 0.805
Validation loss decreased (-0.729717 --> -0.805398).  Saving model ...
Epoch: 4 cost time: 3.3868250846862793
Epoch: 4, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
Validation loss decreased (-0.805398 --> -0.883780).  Saving model ...
Epoch: 5 cost time: 3.2628297805786133
Epoch: 5, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.883780 --> -0.899997).  Saving model ...
Epoch: 6 cost time: 3.0697693824768066
Epoch: 6, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.899997 --> -0.929728).  Saving model ...
Epoch: 7 cost time: 3.1971404552459717
Epoch: 7, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.932 Test Loss: 0.182 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932431).  Saving model ...
Epoch: 8 cost time: 3.2907049655914307
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
Validation loss decreased (-0.932431 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 3.1893863677978516
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 3.2891483306884766
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 3.1851141452789307
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3090810775756836
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.160342216491699
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 3.364301919937134
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.21724534034729
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.188652753829956
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.1106820106506348
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.241257429122925
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0550568103790283
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 3.290343999862671
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.370316743850708
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 3.2175278663635254
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.122323751449585
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 3.1076345443725586
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.328195571899414
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2732725143432617
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.311465263366699
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.070624828338623
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.116140365600586
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 3.0376477241516113
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2058143615722656
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3652281761169434
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.1964545249938965
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 3.1349050998687744
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.0268397331237793
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2757956981658936
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3825933933258057
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.0055758953094482
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.392604351043701
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.288679599761963
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.3037595748901367
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.289443016052246
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.2722761631011963
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.993345737457275
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 1.963 Vali Acc: 0.414 Test Loss: 1.963 Test Acc: 0.414
Validation loss decreased (inf --> -0.413494).  Saving model ...
Epoch: 2 cost time: 3.33073091506958
Epoch: 2, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.386 Vali Acc: 0.716 Test Loss: 1.386 Test Acc: 0.716
Validation loss decreased (-0.413494 --> -0.716202).  Saving model ...
Epoch: 3 cost time: 3.022484302520752
Epoch: 3, Steps: 17 | Train Loss: 1.051 Vali Loss: 0.816 Vali Acc: 0.797 Test Loss: 0.816 Test Acc: 0.797
Validation loss decreased (-0.716202 --> -0.797289).  Saving model ...
Epoch: 4 cost time: 3.1786022186279297
Epoch: 4, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.434 Vali Acc: 0.868 Test Loss: 0.434 Test Acc: 0.868
Validation loss decreased (-0.797289 --> -0.867563).  Saving model ...
Epoch: 5 cost time: 3.131589651107788
Epoch: 5, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.339 Vali Acc: 0.908 Test Loss: 0.339 Test Acc: 0.908
Validation loss decreased (-0.867563 --> -0.908105).  Saving model ...
Epoch: 6 cost time: 3.09023380279541
Epoch: 6, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.232 Vali Acc: 0.924 Test Loss: 0.232 Test Acc: 0.924
Validation loss decreased (-0.908105 --> -0.924322).  Saving model ...
Epoch: 7 cost time: 3.237321138381958
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 8 cost time: 3.3472254276275635
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 3.372117280960083
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 3.2213659286499023
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 3.322972059249878
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 3.0931241512298584
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 3.194368600845337
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 3.1393585205078125
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.042633056640625
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1107184886932373
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.918053388595581
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2666208744049072
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2794291973114014
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 3.299929618835449
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2009377479553223
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.080880880355835
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 3.1762032508850098
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.275843858718872
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 3.285804271697998
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 3.33266019821167
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 3.242447853088379
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2886290550231934
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 3.1137747764587402
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 3.2793166637420654
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1105430126190186
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.1511104106903076
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 33 cost time: 3.216472864151001
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2181389331817627
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0673320293426514
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.329594612121582
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.4796764850616455
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.60571026802063
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.244323968887329
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 3.119109630584717
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.245251417160034
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 42 cost time: 3.210587739944458
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 43 cost time: 3.398320436477661
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2467761039733887
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.9710354804992676
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.289926052093506
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1934399604797363
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.1068849563598633
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.135606527328491
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.2643327713012695
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.692692518234253
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.4959802627563477
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 53 cost time: 3.317666530609131
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.4089107513427734
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 55 cost time: 3.4075427055358887
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 56 cost time: 3.6139087677001953
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.394562244415283
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.373276472091675
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 59 cost time: 3.1476566791534424
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.358285903930664
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.3013744354248047
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 62 cost time: 3.32859206199646
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 63 cost time: 2.9619967937469482
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.1205995082855225
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 65 cost time: 2.9797887802124023
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 66 cost time: 3.1840710639953613
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.4316062927246094
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.0428569316864014
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.283259630203247
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.1593220233917236
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 71 cost time: 3.0333521366119385
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.192305326461792
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.150575876235962
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 74 cost time: 3.408996105194092
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 3.20190691947937
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 3.1849520206451416
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 77 cost time: 3.2417054176330566
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 3.4335901737213135
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 3.0526459217071533
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 3.0034170150756836
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 3.3348779678344727
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 82 cost time: 3.381397008895874
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 3.2572638988494873
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 84 cost time: 3.0824549198150635
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 85 cost time: 3.186354398727417
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 86 cost time: 3.1209473609924316
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 3.316556692123413
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 3.117262363433838
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 3.544534683227539
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 3.2829477787017822
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 3.4405839443206787
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 3.30161714553833
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 3.2745585441589355
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 3.152514934539795
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 3.385193347930908
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.894208192825317
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 1.946 Vali Acc: 0.419 Test Loss: 1.946 Test Acc: 0.419
Validation loss decreased (inf --> -0.418899).  Saving model ...
Epoch: 2 cost time: 3.3251585960388184
Epoch: 2, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.340 Vali Acc: 0.743 Test Loss: 1.340 Test Acc: 0.743
Validation loss decreased (-0.418899 --> -0.743230).  Saving model ...
Epoch: 3 cost time: 3.2096261978149414
Epoch: 3, Steps: 17 | Train Loss: 1.122 Vali Loss: 0.760 Vali Acc: 0.816 Test Loss: 0.760 Test Acc: 0.816
Validation loss decreased (-0.743230 --> -0.816209).  Saving model ...
Epoch: 4 cost time: 3.039830207824707
Epoch: 4, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.407 Vali Acc: 0.873 Test Loss: 0.407 Test Acc: 0.873
Validation loss decreased (-0.816209 --> -0.872969).  Saving model ...
Epoch: 5 cost time: 3.299748182296753
Epoch: 5, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.340 Vali Acc: 0.897 Test Loss: 0.340 Test Acc: 0.897
Validation loss decreased (-0.872969 --> -0.897294).  Saving model ...
Epoch: 6 cost time: 3.165872097015381
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.232 Vali Acc: 0.924 Test Loss: 0.232 Test Acc: 0.924
Validation loss decreased (-0.897294 --> -0.924322).  Saving model ...
Epoch: 7 cost time: 3.301586866378784
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
Validation loss decreased (-0.924322 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 3.198129892349243
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 3.2333004474639893
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 3.3116002082824707
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2906429767608643
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0709803104400635
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2635586261749268
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.2545065879821777
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3055777549743652
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.344949245452881
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2795534133911133
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.428422689437866
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6384756565093994
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.234633207321167
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6131701469421387
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.080284833908081
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.173097848892212
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.600534915924072
Epoch: 1, Steps: 17 | Train Loss: 2.202 Vali Loss: 1.875 Vali Acc: 0.446 Test Loss: 1.875 Test Acc: 0.446
Validation loss decreased (inf --> -0.445927).  Saving model ...
Epoch: 2 cost time: 3.357834577560425
Epoch: 2, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.162 Vali Acc: 0.789 Test Loss: 1.162 Test Acc: 0.789
Validation loss decreased (-0.445927 --> -0.789178).  Saving model ...
Epoch: 3 cost time: 3.1240651607513428
Epoch: 3, Steps: 17 | Train Loss: 1.153 Vali Loss: 0.691 Vali Acc: 0.819 Test Loss: 0.691 Test Acc: 0.819
Validation loss decreased (-0.789178 --> -0.818912).  Saving model ...
Epoch: 4 cost time: 2.992702007293701
Epoch: 4, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
Validation loss decreased (-0.818912 --> -0.881077).  Saving model ...
Epoch: 5 cost time: 3.074704647064209
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.336 Vali Acc: 0.892 Test Loss: 0.336 Test Acc: 0.892
Validation loss decreased (-0.881077 --> -0.891889).  Saving model ...
Epoch: 6 cost time: 3.039436101913452
Epoch: 6, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0478060245513916
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.197 Vali Acc: 0.919 Test Loss: 0.197 Test Acc: 0.919
Validation loss decreased (-0.891889 --> -0.918917).  Saving model ...
Epoch: 8 cost time: 3.0572335720062256
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.918917 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 3.055711269378662
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 3.131157636642456
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.169 Vali Acc: 0.932 Test Loss: 0.169 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0784831047058105
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1689774990081787
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0155599117279053
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.941 Test Loss: 0.149 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.93222975730896
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0854434967041016
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0897815227508545
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1708219051361084
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.233738660812378
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0769193172454834
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 3.0798723697662354
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.041588306427002
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 3.0504748821258545
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1998202800750732
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.091702938079834
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1031408309936523
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.063352584838867
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 27 cost time: 3.2012197971343994
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 3.0994298458099365
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8545188903808594
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9009759426116943
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.9986650943756104
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.913865327835083
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.996575355529785
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.0943996906280518
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.1201884746551514
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.0042641162872314
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.946 Test Loss: 0.140 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.098698616027832
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.2366554737091064
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 1.867 Vali Acc: 0.443 Test Loss: 1.867 Test Acc: 0.443
Validation loss decreased (inf --> -0.443225).  Saving model ...
Epoch: 2 cost time: 3.2317464351654053
Epoch: 2, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.179 Vali Acc: 0.749 Test Loss: 1.179 Test Acc: 0.749
Validation loss decreased (-0.443225 --> -0.748637).  Saving model ...
Epoch: 3 cost time: 3.317044496536255
Epoch: 3, Steps: 17 | Train Loss: 1.150 Vali Loss: 0.688 Vali Acc: 0.816 Test Loss: 0.688 Test Acc: 0.816
Validation loss decreased (-0.748637 --> -0.816209).  Saving model ...
Epoch: 4 cost time: 3.2599399089813232
Epoch: 4, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
Validation loss decreased (-0.816209 --> -0.878375).  Saving model ...
Epoch: 5 cost time: 3.2357070446014404
Epoch: 5, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.348 Vali Acc: 0.892 Test Loss: 0.348 Test Acc: 0.892
Validation loss decreased (-0.878375 --> -0.891888).  Saving model ...
Epoch: 6 cost time: 3.30437970161438
Epoch: 6, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.891888 --> -0.921619).  Saving model ...
Epoch: 7 cost time: 3.4492907524108887
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.198 Vali Acc: 0.927 Test Loss: 0.198 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 8 cost time: 3.634854555130005
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.927025 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 3.5907089710235596
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 3.4636757373809814
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3884570598602295
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3401939868927
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.490628480911255
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 3.362912178039551
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1789844036102295
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.44598126411438
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3652896881103516
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 3.3149240016937256
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 3.2135002613067627
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 3.073272705078125
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2721800804138184
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9979636669158936
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 3.1821837425231934
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 3.2152113914489746
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 3.2907700538635254
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 26 cost time: 3.1041159629821777
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2188470363616943
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2122371196746826
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.5394339561462402
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.330378293991089
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3438057899475098
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.1567113399505615
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.3643500804901123
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3171353340148926
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.273831367492676
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.90744686126709
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
Validation loss decreased (inf --> -0.237816).  Saving model ...
Epoch: 2 cost time: 3.0021913051605225
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.907440662384033
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9504377841949463
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5087296962738037
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
Validation loss decreased (-0.237816 --> -0.237816).  Saving model ...
Epoch: 6 cost time: 3.406864881515503
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.702237844467163
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.547032594680786
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6006271839141846
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.31607723236084
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7278125286102295
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5906059741973877
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.001769304275513
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7564175128936768
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.442084789276123
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.238 Test Loss: 2.196 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.23783783783783785
model parameter : 6992905
model size : 46.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.398728132247925
Epoch: 1, Steps: 17 | Train Loss: 2.097 Vali Loss: 1.793 Vali Acc: 0.524 Test Loss: 1.793 Test Acc: 0.524
Validation loss decreased (inf --> -0.524306).  Saving model ...
Epoch: 2 cost time: 4.280065536499023
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.192 Vali Acc: 0.689 Test Loss: 1.192 Test Acc: 0.689
Validation loss decreased (-0.524306 --> -0.689177).  Saving model ...
Epoch: 3 cost time: 4.4274001121521
Epoch: 3, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.694 Vali Acc: 0.814 Test Loss: 0.694 Test Acc: 0.814
Validation loss decreased (-0.689177 --> -0.813507).  Saving model ...
Epoch: 4 cost time: 3.4295501708984375
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
Validation loss decreased (-0.813507 --> -0.862158).  Saving model ...
Epoch: 5 cost time: 3.6143200397491455
Epoch: 5, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
Validation loss decreased (-0.862158 --> -0.932430).  Saving model ...
Epoch: 6 cost time: 3.2698445320129395
Epoch: 6, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 3.196826934814453
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 3.0641868114471436
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.198014259338379
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 3.175271987915039
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.31093692779541
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.374843120574951
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3248307704925537
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.173802375793457
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 3.435459852218628
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.25815749168396
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 3.213747024536133
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 3.3441805839538574
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.107621192932129
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3986103534698486
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1617090702056885
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 3.1552538871765137
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 3.4665937423706055
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.230419874191284
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.40401554107666
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 3.344855546951294
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1954290866851807
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.206413745880127
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2611827850341797
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 3.245102882385254
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3708302974700928
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.0619583129882812
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4446985721588135
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.5443050861358643
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.353250026702881
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.3126344680786133
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.420011043548584
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3620707988739014
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.4494986534118652
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.891373634338379
Epoch: 1, Steps: 17 | Train Loss: 2.134 Vali Loss: 1.873 Vali Acc: 0.495 Test Loss: 1.873 Test Acc: 0.495
Validation loss decreased (inf --> -0.494576).  Saving model ...
Epoch: 2 cost time: 3.101287364959717
Epoch: 2, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.289 Vali Acc: 0.673 Test Loss: 1.289 Test Acc: 0.673
Validation loss decreased (-0.494576 --> -0.672960).  Saving model ...
Epoch: 3 cost time: 3.576188802719116
Epoch: 3, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.728 Vali Acc: 0.838 Test Loss: 0.728 Test Acc: 0.838
Validation loss decreased (-0.672960 --> -0.837831).  Saving model ...
Epoch: 4 cost time: 3.8353219032287598
Epoch: 4, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
Validation loss decreased (-0.837831 --> -0.859455).  Saving model ...
Epoch: 5 cost time: 3.897416830062866
Epoch: 5, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
Validation loss decreased (-0.859455 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 4.0577051639556885
Epoch: 6, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.210 Vali Acc: 0.932 Test Loss: 0.210 Test Acc: 0.932
Validation loss decreased (-0.916213 --> -0.932430).  Saving model ...
Epoch: 7 cost time: 3.9366941452026367
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.194 Vali Acc: 0.927 Test Loss: 0.194 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.467988967895508
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 3.8911876678466797
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 3.938281774520874
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 3.8336730003356934
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.922677993774414
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 3.663736581802368
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 4.031696796417236
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 3.920016288757324
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.00787878036499
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.983363151550293
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 4.029090166091919
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 3.857243776321411
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9690349102020264
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8615095615386963
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.873530149459839
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 3.919174909591675
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6787731647491455
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8836371898651123
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.956777334213257
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 3.8329384326934814
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.199697971343994
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9214999675750732
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 4.212934255599976
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.0402655601501465
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.7762503623962402
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 33 cost time: 4.2779552936553955
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.8797097206115723
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.136259317398071
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.8871748447418213
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.9628705978393555
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.9763872623443604
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.809349775314331
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.9801993370056152
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.571794033050537
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.828505277633667
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 43 cost time: 3.74879789352417
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 44 cost time: 3.7683615684509277
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.102489233016968
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.008533716201782
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 4.067215204238892
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.0982506275177
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 4.056441783905029
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 4.4104530811309814
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 4.4218480587005615
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.8649487495422363
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 53 cost time: 4.208206653594971
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.9617676734924316
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.902217388153076
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.8858678340911865
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.7387778759002686
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.6133525371551514
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.67724609375
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.931373357772827
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.9396867752075195
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 4.013210773468018
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.07834529876709
Epoch: 1, Steps: 17 | Train Loss: 2.161 Vali Loss: 1.934 Vali Acc: 0.432 Test Loss: 1.934 Test Acc: 0.432
Validation loss decreased (inf --> -0.432413).  Saving model ...
Epoch: 2 cost time: 3.7956840991973877
Epoch: 2, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.407 Vali Acc: 0.659 Test Loss: 1.407 Test Acc: 0.659
Validation loss decreased (-0.432413 --> -0.659445).  Saving model ...
Epoch: 3 cost time: 3.8243885040283203
Epoch: 3, Steps: 17 | Train Loss: 1.067 Vali Loss: 0.793 Vali Acc: 0.811 Test Loss: 0.793 Test Acc: 0.811
Validation loss decreased (-0.659445 --> -0.810803).  Saving model ...
Epoch: 4 cost time: 4.0388054847717285
Epoch: 4, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.810803 --> -0.837833).  Saving model ...
Epoch: 5 cost time: 3.549766778945923
Epoch: 5, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.308 Vali Acc: 0.908 Test Loss: 0.308 Test Acc: 0.908
Validation loss decreased (-0.837833 --> -0.908105).  Saving model ...
Epoch: 6 cost time: 3.6913249492645264
Epoch: 6, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.246 Vali Acc: 0.916 Test Loss: 0.246 Test Acc: 0.916
Validation loss decreased (-0.908105 --> -0.916214).  Saving model ...
Epoch: 7 cost time: 3.8855178356170654
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.916214 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 3.8447153568267822
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.683833360671997
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.463165044784546
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.932 Test Loss: 0.203 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3979597091674805
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943242).  Saving model ...
Epoch: 12 cost time: 3.7361104488372803
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 3.654547929763794
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.766303062438965
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.947368860244751
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.807079792022705
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7398345470428467
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4296374320983887
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2913331985473633
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.661594867706299
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 3.674065589904785
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 3.5905730724334717
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6743171215057373
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7825613021850586
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 3.446254253387451
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.575174570083618
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 3.4744184017181396
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 3.8277018070220947
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8218133449554443
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.562720775604248
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 3.6063807010650635
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 32 cost time: 3.8095977306365967
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 33 cost time: 3.9179799556732178
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.7983028888702393
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.687842845916748
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.7807319164276123
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.21081018447876
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.926480293273926
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.9026198387145996
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.6816627979278564
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.0037901401519775
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.16165828704834
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.252190828323364
Epoch: 1, Steps: 17 | Train Loss: 2.168 Vali Loss: 1.952 Vali Acc: 0.408 Test Loss: 1.952 Test Acc: 0.408
Validation loss decreased (inf --> -0.408089).  Saving model ...
Epoch: 2 cost time: 3.407431125640869
Epoch: 2, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.376 Vali Acc: 0.684 Test Loss: 1.376 Test Acc: 0.684
Validation loss decreased (-0.408089 --> -0.683770).  Saving model ...
Epoch: 3 cost time: 3.67767596244812
Epoch: 3, Steps: 17 | Train Loss: 1.129 Vali Loss: 0.769 Vali Acc: 0.805 Test Loss: 0.769 Test Acc: 0.805
Validation loss decreased (-0.683770 --> -0.805398).  Saving model ...
Epoch: 4 cost time: 3.670598268508911
Epoch: 4, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
Validation loss decreased (-0.805398 --> -0.840536).  Saving model ...
Epoch: 5 cost time: 3.6589608192443848
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.303 Vali Acc: 0.895 Test Loss: 0.303 Test Acc: 0.895
Validation loss decreased (-0.840536 --> -0.894592).  Saving model ...
Epoch: 6 cost time: 3.3808557987213135
Epoch: 6, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.268 Vali Acc: 0.914 Test Loss: 0.268 Test Acc: 0.914
Validation loss decreased (-0.894592 --> -0.913511).  Saving model ...
Epoch: 7 cost time: 3.7377994060516357
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
Validation loss decreased (-0.913511 --> -0.932430).  Saving model ...
Epoch: 8 cost time: 3.8208374977111816
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.250 Vali Acc: 0.916 Test Loss: 0.250 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5761306285858154
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 3.623457908630371
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.928102970123291
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.766573667526245
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.598296642303467
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.422358274459839
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.717625856399536
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6827456951141357
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 3.4337284564971924
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 3.39725399017334
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.531107187271118
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.691906213760376
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.710700273513794
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6794300079345703
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.4815120697021484
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.7278223037719727
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.452286720275879
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.786933183670044
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.897026777267456
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.309514999389648
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 1.900 Vali Acc: 0.400 Test Loss: 1.900 Test Acc: 0.400
Validation loss decreased (inf --> -0.399981).  Saving model ...
Epoch: 2 cost time: 3.79901123046875
Epoch: 2, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.257 Vali Acc: 0.719 Test Loss: 1.257 Test Acc: 0.719
Validation loss decreased (-0.399981 --> -0.718906).  Saving model ...
Epoch: 3 cost time: 3.6939241886138916
Epoch: 3, Steps: 17 | Train Loss: 1.206 Vali Loss: 0.690 Vali Acc: 0.816 Test Loss: 0.690 Test Acc: 0.816
Validation loss decreased (-0.718906 --> -0.816209).  Saving model ...
Epoch: 4 cost time: 3.6908118724823
Epoch: 4, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.478 Vali Acc: 0.851 Test Loss: 0.478 Test Acc: 0.851
Validation loss decreased (-0.816209 --> -0.851347).  Saving model ...
Epoch: 5 cost time: 3.676961898803711
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.262 Vali Acc: 0.916 Test Loss: 0.262 Test Acc: 0.916
Validation loss decreased (-0.851347 --> -0.916214).  Saving model ...
Epoch: 6 cost time: 3.456031322479248
Epoch: 6, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
Validation loss decreased (-0.916214 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 3.669330358505249
Epoch: 7, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.575427532196045
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4557206630706787
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945945).  Saving model ...
Epoch: 10 cost time: 3.767977237701416
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.945945 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 3.5038506984710693
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3888676166534424
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 13 cost time: 3.699646234512329
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 14 cost time: 3.8004322052001953
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7375011444091797
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 3.808685779571533
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 3.7809267044067383
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.020211696624756
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 3.920194625854492
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 3.7662301063537598
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.682997465133667
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.680283546447754
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.315857172012329
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.504085063934326
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.332594633102417
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5369062423706055
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.744649648666382
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 3.9181621074676514
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8588879108428955
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.619288921356201
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.755514621734619
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6229279041290283
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.536947250366211
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.8309481143951416
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.057330369949341
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.1466264724731445
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.721022605895996
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.4775590896606445
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 1.898 Vali Acc: 0.403 Test Loss: 1.898 Test Acc: 0.403
Validation loss decreased (inf --> -0.402684).  Saving model ...
Epoch: 2 cost time: 3.7043356895446777
Epoch: 2, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.259 Vali Acc: 0.703 Test Loss: 1.259 Test Acc: 0.703
Validation loss decreased (-0.402684 --> -0.702690).  Saving model ...
Epoch: 3 cost time: 3.651998281478882
Epoch: 3, Steps: 17 | Train Loss: 1.172 Vali Loss: 0.694 Vali Acc: 0.814 Test Loss: 0.694 Test Acc: 0.814
Validation loss decreased (-0.702690 --> -0.813507).  Saving model ...
Epoch: 4 cost time: 3.575576066970825
Epoch: 4, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.480 Vali Acc: 0.849 Test Loss: 0.480 Test Acc: 0.849
Validation loss decreased (-0.813507 --> -0.848644).  Saving model ...
Epoch: 5 cost time: 3.7452681064605713
Epoch: 5, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.267 Vali Acc: 0.916 Test Loss: 0.267 Test Acc: 0.916
Validation loss decreased (-0.848644 --> -0.916214).  Saving model ...
Epoch: 6 cost time: 3.4195477962493896
Epoch: 6, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (-0.916214 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 3.5718610286712646
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 3.4514074325561523
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3997960090637207
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.941 Test Loss: 0.150 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.610614776611328
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 3.867488145828247
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 3.2103960514068604
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 3.4586892127990723
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.574810028076172
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 3.468599796295166
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6670920848846436
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.531787633895874
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 3.3068230152130127
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 3.4744293689727783
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3907480239868164
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 3.604184150695801
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.414222240447998
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3970787525177
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.399003505706787
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.343284845352173
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.272441864013672
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5954031944274902
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5067648887634277
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.4625110626220703
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.3871145248413086
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.297010660171509
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
Validation loss decreased (inf --> -0.083762).  Saving model ...
Epoch: 2 cost time: 3.998579263687134
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 3 cost time: 3.6742630004882812
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.196338176727295
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 5 cost time: 4.027327537536621
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 6 cost time: 4.394021511077881
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8691701889038086
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8389742374420166
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.973376989364624
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.620548725128174
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.953195333480835
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 12 cost time: 3.9663431644439697
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6231114864349365
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.620820999145508
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.667692184448242
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8316099643707275
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.736677408218384
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.745777130126953
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5815396308898926
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.813951015472412
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6580560207366943
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.08378378378378379
model parameter : 6599689
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.528315782546997
Epoch: 1, Steps: 17 | Train Loss: 2.156 Vali Loss: 1.893 Vali Acc: 0.459 Test Loss: 1.893 Test Acc: 0.459
Validation loss decreased (inf --> -0.459441).  Saving model ...
Epoch: 2 cost time: 3.663745641708374
Epoch: 2, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.367 Vali Acc: 0.703 Test Loss: 1.367 Test Acc: 0.703
Validation loss decreased (-0.459441 --> -0.702689).  Saving model ...
Epoch: 3 cost time: 3.892712354660034
Epoch: 3, Steps: 17 | Train Loss: 1.115 Vali Loss: 0.938 Vali Acc: 0.781 Test Loss: 0.938 Test Acc: 0.781
Validation loss decreased (-0.702689 --> -0.781072).  Saving model ...
Epoch: 4 cost time: 3.3743937015533447
Epoch: 4, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.630 Vali Acc: 0.857 Test Loss: 0.630 Test Acc: 0.857
Validation loss decreased (-0.781072 --> -0.856750).  Saving model ...
Epoch: 5 cost time: 3.656324863433838
Epoch: 5, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.856750 --> -0.902699).  Saving model ...
Epoch: 6 cost time: 3.5631117820739746
Epoch: 6, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
Validation loss decreased (-0.902699 --> -0.918916).  Saving model ...
Epoch: 7 cost time: 3.512458324432373
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.918916 --> -0.940538).  Saving model ...
Epoch: 8 cost time: 3.642714262008667
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 3.8457748889923096
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 3.662363290786743
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 3.5430386066436768
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 3.544156551361084
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 3.6765594482421875
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 3.7052507400512695
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.925715208053589
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 3.6338701248168945
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 3.718416452407837
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7206268310546875
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.702558994293213
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.703608751296997
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 3.9146676063537598
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6693642139434814
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.674020528793335
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.00255823135376
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6270041465759277
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.153550863265991
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.6434733867645264
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.324910879135132
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.999221086502075
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.457650184631348
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.76913046836853
Epoch: 1, Steps: 17 | Train Loss: 2.168 Vali Loss: 1.951 Vali Acc: 0.419 Test Loss: 1.951 Test Acc: 0.419
Validation loss decreased (inf --> -0.418899).  Saving model ...
Epoch: 2 cost time: 3.5877270698547363
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.480 Vali Acc: 0.678 Test Loss: 1.480 Test Acc: 0.678
Validation loss decreased (-0.418899 --> -0.678364).  Saving model ...
Epoch: 3 cost time: 3.866257905960083
Epoch: 3, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.036 Vali Acc: 0.770 Test Loss: 1.036 Test Acc: 0.770
Validation loss decreased (-0.678364 --> -0.770260).  Saving model ...
Epoch: 4 cost time: 3.8179898262023926
Epoch: 4, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.704 Vali Acc: 0.830 Test Loss: 0.704 Test Acc: 0.830
Validation loss decreased (-0.770260 --> -0.829723).  Saving model ...
Epoch: 5 cost time: 3.7258803844451904
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
Validation loss decreased (-0.829723 --> -0.883779).  Saving model ...
Epoch: 6 cost time: 3.6396241188049316
Epoch: 6, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.319 Vali Acc: 0.905 Test Loss: 0.319 Test Acc: 0.905
Validation loss decreased (-0.883779 --> -0.905402).  Saving model ...
Epoch: 7 cost time: 3.7457995414733887
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
Validation loss decreased (-0.905402 --> -0.918916).  Saving model ...
Epoch: 8 cost time: 3.5001494884490967
Epoch: 8, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 3.652714729309082
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 4.026976823806763
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8089535236358643
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 3.6665501594543457
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 3.587847948074341
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 3.5423989295959473
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 3.9666190147399902
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6598479747772217
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 3.695816993713379
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.700950860977173
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6931824684143066
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.693361520767212
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 3.400847911834717
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8098483085632324
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.626692533493042
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.456458568572998
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.779435157775879
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.624964475631714
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.6439476013183594
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.890599489212036
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.629638910293579
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.773693084716797
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.794906139373779
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.002 Vali Acc: 0.365 Test Loss: 2.002 Test Acc: 0.365
Validation loss decreased (inf --> -0.364845).  Saving model ...
Epoch: 2 cost time: 3.5101571083068848
Epoch: 2, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.626 Vali Acc: 0.614 Test Loss: 1.626 Test Acc: 0.614
Validation loss decreased (-0.364845 --> -0.613497).  Saving model ...
Epoch: 3 cost time: 3.8806862831115723
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.201 Vali Acc: 0.719 Test Loss: 1.201 Test Acc: 0.719
Validation loss decreased (-0.613497 --> -0.718907).  Saving model ...
Epoch: 4 cost time: 3.6088500022888184
Epoch: 4, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
Validation loss decreased (-0.718907 --> -0.789181).  Saving model ...
Epoch: 5 cost time: 3.6324896812438965
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
Validation loss decreased (-0.789181 --> -0.870265).  Saving model ...
Epoch: 6 cost time: 3.4974725246429443
Epoch: 6, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.360 Vali Acc: 0.892 Test Loss: 0.360 Test Acc: 0.892
Validation loss decreased (-0.870265 --> -0.891888).  Saving model ...
Epoch: 7 cost time: 3.66951584815979
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.294 Vali Acc: 0.908 Test Loss: 0.294 Test Acc: 0.908
Validation loss decreased (-0.891888 --> -0.908105).  Saving model ...
Epoch: 8 cost time: 3.67720365524292
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.078621864318848
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
Validation loss decreased (-0.908105 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 3.7099807262420654
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 3.69130802154541
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.770768880844116
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 4.083008766174316
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.8073976039886475
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.119031667709351
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.978069543838501
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 4.170581817626953
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.3446855545043945
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 3.9861536026000977
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.1629862785339355
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 3.8294599056243896
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 3.849576473236084
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 3.963454246520996
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9493539333343506
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 3.860860586166382
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 4.050509214401245
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 4.033746719360352
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.179335832595825
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.217889070510864
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8491804599761963
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.9303977489471436
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.552065134048462
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.995213270187378
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.685072183609009
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.731539011001587
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.722508668899536
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.014609336853027
Epoch: 1, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.027 Vali Acc: 0.341 Test Loss: 2.027 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 3.229785680770874
Epoch: 2, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.660 Vali Acc: 0.611 Test Loss: 1.660 Test Acc: 0.611
Validation loss decreased (-0.340520 --> -0.610794).  Saving model ...
Epoch: 3 cost time: 3.342275857925415
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.206 Vali Acc: 0.749 Test Loss: 1.206 Test Acc: 0.749
Validation loss decreased (-0.610794 --> -0.748637).  Saving model ...
Epoch: 4 cost time: 3.271510124206543
Epoch: 4, Steps: 17 | Train Loss: 1.014 Vali Loss: 0.821 Vali Acc: 0.795 Test Loss: 0.821 Test Acc: 0.795
Validation loss decreased (-0.748637 --> -0.794586).  Saving model ...
Epoch: 5 cost time: 3.2524375915527344
Epoch: 5, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
Validation loss decreased (-0.794586 --> -0.859454).  Saving model ...
Epoch: 6 cost time: 3.3335888385772705
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.859454 --> -0.889185).  Saving model ...
Epoch: 7 cost time: 3.5084972381591797
Epoch: 7, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.316 Vali Acc: 0.905 Test Loss: 0.316 Test Acc: 0.905
Validation loss decreased (-0.889185 --> -0.905402).  Saving model ...
Epoch: 8 cost time: 3.366407871246338
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.905402 --> -0.921619).  Saving model ...
Epoch: 9 cost time: 3.267136335372925
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.921619 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 3.4606432914733887
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 3.70725679397583
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.038102149963379
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 3.5650031566619873
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 3.482898712158203
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.656161308288574
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.34725022315979
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 3.284451484680176
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4029057025909424
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5786757469177246
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 3.299708843231201
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 3.436228036880493
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 3.3407554626464844
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4749319553375244
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8959197998046875
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.065761566162109
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6199586391448975
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.544017791748047
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.4362618923187256
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 3.5249509811401367
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.9896059036254883
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 3.5443320274353027
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 3.563286542892456
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4954965114593506
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.6476376056671143
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.614931583404541
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.275094747543335
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.4499311447143555
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.6105310916900635
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 3.3549273014068604
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.556182861328125
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 41 cost time: 3.3151087760925293
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 42 cost time: 3.4020891189575195
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 43 cost time: 3.626629114151001
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.6440701484680176
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.386136770248413
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.4714744091033936
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 47 cost time: 3.298463821411133
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 48 cost time: 3.714219093322754
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.4892830848693848
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.8384852409362793
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.5460400581359863
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.5447614192962646
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.801894426345825
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.5367095470428467
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 55 cost time: 3.187040328979492
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.6014795303344727
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.3608124256134033
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.5868237018585205
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.5251102447509766
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 60 cost time: 3.458482503890991
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.326911211013794
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.413630485534668
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.484877109527588
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 3.9200599193573
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.7542619705200195
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.3989336490631104
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 3.657830238342285
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 4.093135833740234
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 3.7061686515808105
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.049806833267212
Epoch: 1, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.002 Vali Acc: 0.330 Test Loss: 2.002 Test Acc: 0.330
Validation loss decreased (inf --> -0.329710).  Saving model ...
Epoch: 2 cost time: 3.5947470664978027
Epoch: 2, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.607 Vali Acc: 0.676 Test Loss: 1.607 Test Acc: 0.676
Validation loss decreased (-0.329710 --> -0.675660).  Saving model ...
Epoch: 3 cost time: 3.60943603515625
Epoch: 3, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.113 Vali Acc: 0.800 Test Loss: 1.113 Test Acc: 0.800
Validation loss decreased (-0.675660 --> -0.799989).  Saving model ...
Epoch: 4 cost time: 3.4859375953674316
Epoch: 4, Steps: 17 | Train Loss: 1.127 Vali Loss: 0.785 Vali Acc: 0.805 Test Loss: 0.785 Test Acc: 0.805
Validation loss decreased (-0.799989 --> -0.805398).  Saving model ...
Epoch: 5 cost time: 3.2701988220214844
Epoch: 5, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.475 Vali Acc: 0.868 Test Loss: 0.475 Test Acc: 0.868
Validation loss decreased (-0.805398 --> -0.867563).  Saving model ...
Epoch: 6 cost time: 3.362544536590576
Epoch: 6, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.331 Vali Acc: 0.905 Test Loss: 0.331 Test Acc: 0.905
Validation loss decreased (-0.867563 --> -0.905402).  Saving model ...
Epoch: 7 cost time: 3.5441412925720215
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
Validation loss decreased (-0.905402 --> -0.927025).  Saving model ...
Epoch: 8 cost time: 3.321408748626709
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929728).  Saving model ...
Epoch: 9 cost time: 3.6063852310180664
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.929728 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 3.5232717990875244
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4178075790405273
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.938 Test Loss: 0.151 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4987428188323975
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.592817544937134
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.4683494567871094
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 3.560450315475464
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 16 cost time: 3.6777567863464355
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 3.3866183757781982
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 3.5513720512390137
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.320922613143921
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2979960441589355
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5225422382354736
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 3.4314827919006348
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 3.491205930709839
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8238577842712402
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6749258041381836
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9013352394104004
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 27 cost time: 4.076187372207642
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.752017021179199
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.578793525695801
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.718965530395508
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.914231300354004
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.524799346923828
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.5673916339874268
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.7246413230895996
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.547748565673828
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.491687059402466
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.139472007751465
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.007 Vali Acc: 0.327 Test Loss: 2.007 Test Acc: 0.327
Validation loss decreased (inf --> -0.327007).  Saving model ...
Epoch: 2 cost time: 3.8452420234680176
Epoch: 2, Steps: 17 | Train Loss: 1.907 Vali Loss: 1.582 Vali Acc: 0.670 Test Loss: 1.582 Test Acc: 0.670
Validation loss decreased (-0.327007 --> -0.670254).  Saving model ...
Epoch: 3 cost time: 4.165268898010254
Epoch: 3, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.080 Vali Acc: 0.803 Test Loss: 1.080 Test Acc: 0.803
Validation loss decreased (-0.670254 --> -0.802692).  Saving model ...
Epoch: 4 cost time: 3.8008015155792236
Epoch: 4, Steps: 17 | Train Loss: 1.027 Vali Loss: 0.746 Vali Acc: 0.797 Test Loss: 0.746 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7595674991607666
Epoch: 5, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.446 Vali Acc: 0.895 Test Loss: 0.446 Test Acc: 0.895
Validation loss decreased (-0.802692 --> -0.894590).  Saving model ...
Epoch: 6 cost time: 4.057368040084839
Epoch: 6, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.328 Vali Acc: 0.905 Test Loss: 0.328 Test Acc: 0.905
Validation loss decreased (-0.894590 --> -0.905402).  Saving model ...
Epoch: 7 cost time: 4.209898948669434
Epoch: 7, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
Validation loss decreased (-0.905402 --> -0.927025).  Saving model ...
Epoch: 8 cost time: 4.10164475440979
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5264892578125
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943242).  Saving model ...
Epoch: 10 cost time: 3.5116002559661865
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.730614423751831
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.583214282989502
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.938 Test Loss: 0.149 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.602630138397217
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.7701306343078613
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7242181301116943
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 4.011654615402222
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 3.795283555984497
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 3.732414484024048
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.927950382232666
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 3.6884231567382812
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 3.6186037063598633
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4764533042907715
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7703051567077637
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.502387523651123
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.7021846771240234
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.5360021591186523
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.612553119659424
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.7986104488372803
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.5396900177001953
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.7844324111938477
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.477332353591919
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
Validation loss decreased (inf --> -0.064843).  Saving model ...
Epoch: 2 cost time: 3.789050579071045
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.018728256225586
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 4 cost time: 4.030980587005615
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
Validation loss decreased (-0.064843 --> -0.078356).  Saving model ...
Epoch: 5 cost time: 3.4398765563964844
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.552025556564331
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.919170618057251
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8155062198638916
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.7341792583465576
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 10 cost time: 3.9495744705200195
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5204997062683105
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.029549598693848
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 13 cost time: 3.623857021331787
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5912113189697266
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5817298889160156
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
Validation loss decreased (-0.078356 --> -0.237816).  Saving model ...
Epoch: 16 cost time: 3.699315071105957
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8645782470703125
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6397087574005127
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.762636184692383
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
Validation loss decreased (-0.237816 --> -0.237816).  Saving model ...
Epoch: 20 cost time: 4.1014723777771
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
Validation loss decreased (-0.237816 --> -0.237816).  Saving model ...
Epoch: 21 cost time: 4.50125527381897
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8524670600891113
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8052031993865967
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6624908447265625
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.653623580932617
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.9297235012054443
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4801604747772217
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.726242780685425
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.065 Test Loss: 2.197 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.3539090156555176
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.4825432300567627
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.23783783783783785
model parameter : 4741641
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.318335294723511
Epoch: 1, Steps: 17 | Train Loss: 2.140 Vali Loss: 1.910 Vali Acc: 0.476 Test Loss: 1.910 Test Acc: 0.476
Validation loss decreased (inf --> -0.475657).  Saving model ...
Epoch: 2 cost time: 3.867666721343994
Epoch: 2, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.421 Vali Acc: 0.684 Test Loss: 1.421 Test Acc: 0.684
Validation loss decreased (-0.475657 --> -0.683770).  Saving model ...
Epoch: 3 cost time: 3.6993274688720703
Epoch: 3, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.024 Vali Acc: 0.762 Test Loss: 1.024 Test Acc: 0.762
Validation loss decreased (-0.683770 --> -0.762152).  Saving model ...
Epoch: 4 cost time: 3.7633233070373535
Epoch: 4, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.695 Vali Acc: 0.838 Test Loss: 0.695 Test Acc: 0.838
Validation loss decreased (-0.762152 --> -0.837831).  Saving model ...
Epoch: 5 cost time: 3.964698076248169
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
Validation loss decreased (-0.837831 --> -0.889185).  Saving model ...
Epoch: 6 cost time: 3.729814052581787
Epoch: 6, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.295 Vali Acc: 0.927 Test Loss: 0.295 Test Acc: 0.927
Validation loss decreased (-0.889185 --> -0.927024).  Saving model ...
Epoch: 7 cost time: 3.6192750930786133
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 3.392866849899292
Epoch: 8, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.204 Vali Acc: 0.938 Test Loss: 0.204 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 3.456666946411133
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 10 cost time: 3.4468297958374023
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 11 cost time: 3.5163915157318115
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 3.318669557571411
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4920732975006104
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6858108043670654
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 3.977782726287842
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7949752807617188
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.946 Test Loss: 0.138 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6430580615997314
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 3.7602789402008057
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6619458198547363
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8826210498809814
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 3.9975485801696777
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7701849937438965
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7971646785736084
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 3.576632499694824
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.955463409423828
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5709877014160156
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 3.709491729736328
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4646589756011963
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.367647409439087
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6492886543273926
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 3.885805606842041
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 32 cost time: 3.9698076248168945
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.8349106311798096
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.737208366394043
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6142544746398926
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.729807138442993
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.7343215942382812
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.8354332447052
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.9165923595428467
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.867393970489502
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.689629077911377
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.249988794326782
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 1.960 Vali Acc: 0.438 Test Loss: 1.960 Test Acc: 0.438
Validation loss decreased (inf --> -0.437818).  Saving model ...
Epoch: 2 cost time: 3.561049461364746
Epoch: 2, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.541 Vali Acc: 0.646 Test Loss: 1.541 Test Acc: 0.646
Validation loss decreased (-0.437818 --> -0.645931).  Saving model ...
Epoch: 3 cost time: 4.151276111602783
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.125 Vali Acc: 0.749 Test Loss: 1.125 Test Acc: 0.749
Validation loss decreased (-0.645931 --> -0.748637).  Saving model ...
Epoch: 4 cost time: 4.0523481369018555
Epoch: 4, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.756 Vali Acc: 0.811 Test Loss: 0.756 Test Acc: 0.811
Validation loss decreased (-0.748637 --> -0.810803).  Saving model ...
Epoch: 5 cost time: 3.6793131828308105
Epoch: 5, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.495 Vali Acc: 0.868 Test Loss: 0.495 Test Acc: 0.868
Validation loss decreased (-0.810803 --> -0.867563).  Saving model ...
Epoch: 6 cost time: 3.6168694496154785
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.330 Vali Acc: 0.924 Test Loss: 0.330 Test Acc: 0.924
Validation loss decreased (-0.867563 --> -0.924321).  Saving model ...
Epoch: 7 cost time: 3.7316348552703857
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6306514739990234
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935133).  Saving model ...
Epoch: 9 cost time: 3.805232048034668
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6462483406066895
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.199 Vali Acc: 0.927 Test Loss: 0.199 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4631426334381104
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 3.5232160091400146
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 13 cost time: 3.3748435974121094
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.935 Test Loss: 0.167 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3023157119750977
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 3.818024158477783
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3492681980133057
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 3.5981223583221436
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 3.7198104858398438
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 3.611457586288452
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7733068466186523
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 3.3498475551605225
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9264183044433594
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 23 cost time: 3.5683372020721436
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 3.808128833770752
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7116994857788086
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.527404546737671
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 3.3835315704345703
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7195379734039307
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.399502992630005
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4326345920562744
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 3.3862099647521973
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 32 cost time: 3.4622676372528076
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1996731758117676
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.3931121826171875
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 3.71737003326416
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.487459659576416
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.234094619750977
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.550429344177246
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.044782638549805
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.384822130203247
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.6462409496307373
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.4961371421813965
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.5202388763427734
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.594322443008423
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.775293350219727
Epoch: 1, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.016 Vali Acc: 0.354 Test Loss: 2.016 Test Acc: 0.354
Validation loss decreased (inf --> -0.354034).  Saving model ...
Epoch: 2 cost time: 3.134194850921631
Epoch: 2, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.683 Vali Acc: 0.589 Test Loss: 1.683 Test Acc: 0.589
Validation loss decreased (-0.354034 --> -0.589172).  Saving model ...
Epoch: 3 cost time: 3.6184563636779785
Epoch: 3, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.285 Vali Acc: 0.714 Test Loss: 1.285 Test Acc: 0.714
Validation loss decreased (-0.589172 --> -0.713501).  Saving model ...
Epoch: 4 cost time: 3.641146421432495
Epoch: 4, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.887 Vali Acc: 0.776 Test Loss: 0.887 Test Acc: 0.776
Validation loss decreased (-0.713501 --> -0.775667).  Saving model ...
Epoch: 5 cost time: 3.7448573112487793
Epoch: 5, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
Validation loss decreased (-0.775667 --> -0.840534).  Saving model ...
Epoch: 6 cost time: 3.7152321338653564
Epoch: 6, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.405 Vali Acc: 0.881 Test Loss: 0.405 Test Acc: 0.881
Validation loss decreased (-0.840534 --> -0.881077).  Saving model ...
Epoch: 7 cost time: 3.483931303024292
Epoch: 7, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.374 Vali Acc: 0.878 Test Loss: 0.374 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.438066244125366
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
Validation loss decreased (-0.881077 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 3.474207878112793
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918917).  Saving model ...
Epoch: 10 cost time: 3.6015665531158447
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.924 Test Loss: 0.222 Test Acc: 0.924
Validation loss decreased (-0.918917 --> -0.924322).  Saving model ...
Epoch: 11 cost time: 3.4325461387634277
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.195 Vali Acc: 0.932 Test Loss: 0.195 Test Acc: 0.932
Validation loss decreased (-0.924322 --> -0.932430).  Saving model ...
Epoch: 12 cost time: 3.5364041328430176
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.927 Test Loss: 0.195 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3953542709350586
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932431).  Saving model ...
Epoch: 14 cost time: 3.4434778690338135
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
Validation loss decreased (-0.932431 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 3.323660373687744
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 3.433772563934326
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 17 cost time: 3.5287156105041504
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 18 cost time: 3.550719976425171
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6227617263793945
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 3.6033129692077637
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.490684747695923
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.568295478820801
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 23 cost time: 3.5074732303619385
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 24 cost time: 3.7777833938598633
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.379249095916748
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 3.5752813816070557
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 3.6531691551208496
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5635640621185303
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6297447681427
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4740288257598877
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.553271532058716
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 3.3776376247406006
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5491645336151123
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.444981336593628
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.4783973693847656
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.661970376968384
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.64164662361145
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.837672472000122
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.9170339107513428
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.3634250164031982
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.4359965324401855
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.436886548995972
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.066 Vali Acc: 0.276 Test Loss: 2.066 Test Acc: 0.276
Validation loss decreased (inf --> -0.275655).  Saving model ...
Epoch: 2 cost time: 3.726747512817383
Epoch: 2, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.737 Vali Acc: 0.576 Test Loss: 1.737 Test Acc: 0.576
Validation loss decreased (-0.275655 --> -0.575658).  Saving model ...
Epoch: 3 cost time: 3.3653430938720703
Epoch: 3, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.313 Vali Acc: 0.738 Test Loss: 1.313 Test Acc: 0.738
Validation loss decreased (-0.575658 --> -0.737825).  Saving model ...
Epoch: 4 cost time: 3.279893636703491
Epoch: 4, Steps: 17 | Train Loss: 1.119 Vali Loss: 0.895 Vali Acc: 0.808 Test Loss: 0.895 Test Acc: 0.808
Validation loss decreased (-0.737825 --> -0.808099).  Saving model ...
Epoch: 5 cost time: 3.603809356689453
Epoch: 5, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.585 Vali Acc: 0.857 Test Loss: 0.585 Test Acc: 0.857
Validation loss decreased (-0.808099 --> -0.856751).  Saving model ...
Epoch: 6 cost time: 3.580793857574463
Epoch: 6, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.856751 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 3.8358302116394043
Epoch: 7, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.361 Vali Acc: 0.897 Test Loss: 0.361 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.856672763824463
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.899996 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 3.5441155433654785
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7374837398529053
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929728).  Saving model ...
Epoch: 11 cost time: 3.6551740169525146
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
Validation loss decreased (-0.929728 --> -0.937836).  Saving model ...
Epoch: 12 cost time: 3.931838274002075
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 4.101409196853638
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 14 cost time: 3.806969404220581
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 3.9065542221069336
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.474048614501953
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.62774658203125
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 3.8810253143310547
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4855828285217285
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.427563190460205
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 3.6867926120758057
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6404807567596436
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8828938007354736
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 3.782771110534668
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6812055110931396
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.6537888050079346
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.6796274185180664
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5163307189941406
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3130319118499756
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.5406951904296875
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 4.042127370834351
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.592303514480591
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.465419054031372
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.5704450607299805
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.6469273567199707
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.585501194000244
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.482267141342163
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.6755285263061523
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.4597017765045166
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.922126054763794
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.2500691413879395
Epoch: 1, Steps: 17 | Train Loss: 2.234 Vali Loss: 2.097 Vali Acc: 0.230 Test Loss: 2.097 Test Acc: 0.230
Validation loss decreased (inf --> -0.229709).  Saving model ...
Epoch: 2 cost time: 3.582589626312256
Epoch: 2, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.703 Vali Acc: 0.554 Test Loss: 1.703 Test Acc: 0.554
Validation loss decreased (-0.229709 --> -0.554037).  Saving model ...
Epoch: 3 cost time: 3.354163885116577
Epoch: 3, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.196 Vali Acc: 0.778 Test Loss: 1.196 Test Acc: 0.778
Validation loss decreased (-0.554037 --> -0.778366).  Saving model ...
Epoch: 4 cost time: 3.5169806480407715
Epoch: 4, Steps: 17 | Train Loss: 1.220 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
Validation loss decreased (-0.778366 --> -0.802694).  Saving model ...
Epoch: 5 cost time: 3.481067419052124
Epoch: 5, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.586 Vali Acc: 0.805 Test Loss: 0.586 Test Acc: 0.805
Validation loss decreased (-0.802694 --> -0.805400).  Saving model ...
Epoch: 6 cost time: 3.507956027984619
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (-0.805400 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 3.4407222270965576
Epoch: 7, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3448269367218018
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.899996 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 3.2538022994995117
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3519115447998047
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7157957553863525
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 3.3501899242401123
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 3.726706027984619
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.943 Test Loss: 0.140 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.607069253921509
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4935483932495117
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 16 cost time: 3.507403612136841
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 3.5969979763031006
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 3.7327165603637695
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8035688400268555
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.522152900695801
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.560059070587158
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.7086613178253174
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.5179738998413086
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3642568588256836
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.8156940937042236
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7447011470794678
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 3.4804961681365967
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5508854389190674
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6411728858947754
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 3.5229904651641846
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.699091672897339
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.943 Test Loss: 0.125 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.894930124282837
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4410080909729004
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.5053746700286865
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.592801809310913
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.949 Test Loss: 0.121 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.531421661376953
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.342587947845459
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.491464138031006
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.7022533416748047
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.405616521835327
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.072 Vali Acc: 0.238 Test Loss: 2.072 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 3.9590108394622803
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.672 Vali Acc: 0.568 Test Loss: 1.672 Test Acc: 0.568
Validation loss decreased (-0.237817 --> -0.567551).  Saving model ...
Epoch: 3 cost time: 3.459449291229248
Epoch: 3, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.171 Vali Acc: 0.784 Test Loss: 1.171 Test Acc: 0.784
Validation loss decreased (-0.567551 --> -0.783772).  Saving model ...
Epoch: 4 cost time: 3.4978158473968506
Epoch: 4, Steps: 17 | Train Loss: 1.137 Vali Loss: 0.772 Vali Acc: 0.803 Test Loss: 0.772 Test Acc: 0.803
Validation loss decreased (-0.783772 --> -0.802695).  Saving model ...
Epoch: 5 cost time: 3.572399139404297
Epoch: 5, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.526 Vali Acc: 0.849 Test Loss: 0.526 Test Acc: 0.849
Validation loss decreased (-0.802695 --> -0.848643).  Saving model ...
Epoch: 6 cost time: 3.582310676574707
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.353 Vali Acc: 0.897 Test Loss: 0.353 Test Acc: 0.897
Validation loss decreased (-0.848643 --> -0.897294).  Saving model ...
Epoch: 7 cost time: 3.597594976425171
Epoch: 7, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.897294 --> -0.902699).  Saving model ...
Epoch: 8 cost time: 3.7378907203674316
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.902699 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 3.643198013305664
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6322410106658936
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.579375743865967
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 3.312389373779297
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.490989923477173
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7907843589782715
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.932 Test Loss: 0.153 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5396502017974854
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5597188472747803
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 3.6758198738098145
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.545487880706787
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.83654522895813
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9953606128692627
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.66243577003479
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.941 Test Loss: 0.139 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.968938112258911
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.83894419670105
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 24 cost time: 3.634826421737671
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.753133535385132
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 26 cost time: 3.3129658699035645
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.946 Test Loss: 0.130 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4940943717956543
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.7372055053710938
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.649698257446289
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.9310810565948486
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 31 cost time: 3.8459928035736084
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5444719791412354
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.7821576595306396
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.949 Test Loss: 0.124 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.6721835136413574
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 35 cost time: 4.02526593208313
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 3.8786797523498535
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 3.959075927734375
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.818800210952759
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.7913870811462402
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.7872347831726074
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.731085777282715
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 42 cost time: 3.2742135524749756
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.5496394634246826
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.5168557167053223
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.649728775024414
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.5735981464385986
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.7387120723724365
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.808439016342163
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.8337483406066895
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.7964465618133545
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.5075762271881104
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.373880863189697
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 3.463014841079712
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7288501262664795
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 4 cost time: 3.198503255844116
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 5 cost time: 3.39442777633667
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 6 cost time: 3.429675579071045
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.517043352127075
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3942229747772217
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6242010593414307
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.859126567840576
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 11 cost time: 3.6927497386932373
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 12 cost time: 3.73386287689209
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9230172634124756
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.139216184616089
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.530261278152466
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 16 cost time: 3.385948657989502
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 17 cost time: 3.575777053833008
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.448768138885498
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.561819076538086
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.748856782913208
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 21 cost time: 4.1996543407440186
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 22 cost time: 3.3302743434906006
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5055456161499023
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.46889591217041
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.467560291290283
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.822214365005493
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.9171321392059326
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.7200541496276855
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.7701480388641357
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.774034261703491
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.899432420730591
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 32 cost time: 3.5959055423736572
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6582486629486084
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.507216691970825
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6064915657043457
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.6649134159088135
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.488260269165039
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.3964426517486572
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.7151856422424316
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.5569698810577393
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.6584157943725586
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.13513513513513514
model parameter : 3168777
model size : 21.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.628893136978149
Epoch: 1, Steps: 17 | Train Loss: 2.167 Vali Loss: 1.999 Vali Acc: 0.362 Test Loss: 1.999 Test Acc: 0.362
Validation loss decreased (inf --> -0.362142).  Saving model ...
Epoch: 2 cost time: 3.7410998344421387
Epoch: 2, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.531 Vali Acc: 0.654 Test Loss: 1.531 Test Acc: 0.654
Validation loss decreased (-0.362142 --> -0.654039).  Saving model ...
Epoch: 3 cost time: 3.6037518978118896
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.139 Vali Acc: 0.730 Test Loss: 1.139 Test Acc: 0.730
Validation loss decreased (-0.654039 --> -0.729718).  Saving model ...
Epoch: 4 cost time: 3.90801739692688
Epoch: 4, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.774 Vali Acc: 0.811 Test Loss: 0.774 Test Acc: 0.811
Validation loss decreased (-0.729718 --> -0.810803).  Saving model ...
Epoch: 5 cost time: 4.189874172210693
Epoch: 5, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.518 Vali Acc: 0.854 Test Loss: 0.518 Test Acc: 0.854
Validation loss decreased (-0.810803 --> -0.854049).  Saving model ...
Epoch: 6 cost time: 3.6300439834594727
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
Validation loss decreased (-0.854049 --> -0.910807).  Saving model ...
Epoch: 7 cost time: 3.983910083770752
Epoch: 7, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.265 Vali Acc: 0.927 Test Loss: 0.265 Test Acc: 0.927
Validation loss decreased (-0.910807 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 3.684861183166504
Epoch: 8, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 9 cost time: 3.5611233711242676
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 3.411773681640625
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 11 cost time: 3.4457783699035645
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 3.4535462856292725
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 3.76326322555542
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 14 cost time: 3.619793653488159
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9995298385620117
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 16 cost time: 4.068639039993286
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.943242 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.686471700668335
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.808654308319092
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8173470497131348
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 3.6807990074157715
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4930574893951416
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 4.175204038619995
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8662126064300537
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.555433750152588
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5291213989257812
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.407119035720825
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 3.450063705444336
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5174355506896973
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.633169174194336
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.9604599475860596
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.890869379043579
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.5668652057647705
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.775090456008911
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.72344970703125
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.5138332843780518
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.6309316158294678
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.6393139362335205
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.049 Vali Acc: 0.278 Test Loss: 2.049 Test Acc: 0.278
Validation loss decreased (inf --> -0.278358).  Saving model ...
Epoch: 2 cost time: 3.5723156929016113
Epoch: 2, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.646 Vali Acc: 0.649 Test Loss: 1.646 Test Acc: 0.649
Validation loss decreased (-0.278358 --> -0.648632).  Saving model ...
Epoch: 3 cost time: 3.479649782180786
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.245 Vali Acc: 0.719 Test Loss: 1.245 Test Acc: 0.719
Validation loss decreased (-0.648632 --> -0.718906).  Saving model ...
Epoch: 4 cost time: 3.5360522270202637
Epoch: 4, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.863 Vali Acc: 0.792 Test Loss: 0.863 Test Acc: 0.792
Validation loss decreased (-0.718906 --> -0.791883).  Saving model ...
Epoch: 5 cost time: 3.4889073371887207
Epoch: 5, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.575 Vali Acc: 0.851 Test Loss: 0.575 Test Acc: 0.851
Validation loss decreased (-0.791883 --> -0.851346).  Saving model ...
Epoch: 6 cost time: 4.047987699508667
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.373 Vali Acc: 0.895 Test Loss: 0.373 Test Acc: 0.895
Validation loss decreased (-0.851346 --> -0.894591).  Saving model ...
Epoch: 7 cost time: 3.8193256855010986
Epoch: 7, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
Validation loss decreased (-0.894591 --> -0.913511).  Saving model ...
Epoch: 8 cost time: 3.991257429122925
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
Validation loss decreased (-0.913511 --> -0.918916).  Saving model ...
Epoch: 9 cost time: 3.7440667152404785
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
Validation loss decreased (-0.918916 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 3.6340341567993164
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 3.955514669418335
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 12 cost time: 3.8798723220825195
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 4.111750841140747
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 14 cost time: 3.8442859649658203
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3497512340545654
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.7941834926605225
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.4628498554229736
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 3.561065673828125
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.519676685333252
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 3.602755308151245
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9909238815307617
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.904033660888672
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.9487056732177734
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5215423107147217
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.828364849090576
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.770960807800293
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.8339762687683105
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.9046809673309326
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.4612936973571777
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8944408893585205
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.112 Vali Acc: 0.178 Test Loss: 2.112 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 3.2778067588806152
Epoch: 2, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.783 Vali Acc: 0.532 Test Loss: 1.783 Test Acc: 0.532
Validation loss decreased (-0.178357 --> -0.532415).  Saving model ...
Epoch: 3 cost time: 3.498420476913452
Epoch: 3, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.395 Vali Acc: 0.708 Test Loss: 1.395 Test Acc: 0.708
Validation loss decreased (-0.532415 --> -0.708094).  Saving model ...
Epoch: 4 cost time: 3.7146894931793213
Epoch: 4, Steps: 17 | Train Loss: 1.112 Vali Loss: 0.977 Vali Acc: 0.770 Test Loss: 0.977 Test Acc: 0.770
Validation loss decreased (-0.708094 --> -0.770261).  Saving model ...
Epoch: 5 cost time: 3.695633888244629
Epoch: 5, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.651 Vali Acc: 0.824 Test Loss: 0.651 Test Acc: 0.824
Validation loss decreased (-0.770261 --> -0.824318).  Saving model ...
Epoch: 6 cost time: 3.7042932510375977
Epoch: 6, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.424 Vali Acc: 0.881 Test Loss: 0.424 Test Acc: 0.881
Validation loss decreased (-0.824318 --> -0.881077).  Saving model ...
Epoch: 7 cost time: 3.5545759201049805
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.881077 --> -0.902699).  Saving model ...
Epoch: 8 cost time: 3.5256829261779785
Epoch: 8, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.293 Vali Acc: 0.905 Test Loss: 0.293 Test Acc: 0.905
Validation loss decreased (-0.902699 --> -0.905402).  Saving model ...
Epoch: 9 cost time: 3.703855514526367
Epoch: 9, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.905402 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 3.6636829376220703
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.65024995803833
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 3.490543842315674
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 13 cost time: 3.634429931640625
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 3.608175039291382
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7447152137756348
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.6104276180267334
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 3.511017322540283
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5890305042266846
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.930967092514038
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 20 cost time: 4.367947340011597
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.169543266296387
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 4.212264060974121
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 4.1141037940979
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 4.036941051483154
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.071431636810303
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.558122396469116
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.370924472808838
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.62614369392395
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 3.6610653400421143
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.895737886428833
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.547848701477051
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.6996443271636963
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.4288549423217773
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.978949785232544
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 35 cost time: 3.7829596996307373
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 3.6590116024017334
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.961479425430298
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 3.6999709606170654
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.793306827545166
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 3.83357834815979
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.083585977554321
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 42 cost time: 3.821516990661621
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.721101760864258
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.389291286468506
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.059842109680176
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.786996364593506
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.724311590194702
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.700024366378784
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 49 cost time: 3.587703227996826
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.9669580459594727
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.8717219829559326
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.651118278503418
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.7744007110595703
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 54 cost time: 3.9350075721740723
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.684558868408203
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 56 cost time: 3.6174087524414062
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 57 cost time: 3.7678110599517822
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.387925148010254
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.757293939590454
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.7666125297546387
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.5319089889526367
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.58286452293396
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.4653916358947754
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.289369583129883
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.783670425415039
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.6313953399658203
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.3040452003479
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.154 Vali Acc: 0.159 Test Loss: 2.154 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 3.421870470046997
Epoch: 2, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.826 Vali Acc: 0.511 Test Loss: 1.826 Test Acc: 0.511
Validation loss decreased (-0.159438 --> -0.510793).  Saving model ...
Epoch: 3 cost time: 3.4378082752227783
Epoch: 3, Steps: 17 | Train Loss: 1.668 Vali Loss: 1.395 Vali Acc: 0.719 Test Loss: 1.395 Test Acc: 0.719
Validation loss decreased (-0.510793 --> -0.718905).  Saving model ...
Epoch: 4 cost time: 3.5350277423858643
Epoch: 4, Steps: 17 | Train Loss: 1.191 Vali Loss: 0.952 Vali Acc: 0.789 Test Loss: 0.952 Test Acc: 0.789
Validation loss decreased (-0.718905 --> -0.789180).  Saving model ...
Epoch: 5 cost time: 3.868377685546875
Epoch: 5, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.611 Vali Acc: 0.824 Test Loss: 0.611 Test Acc: 0.824
Validation loss decreased (-0.789180 --> -0.824318).  Saving model ...
Epoch: 6 cost time: 3.712325096130371
Epoch: 6, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
Validation loss decreased (-0.824318 --> -0.878374).  Saving model ...
Epoch: 7 cost time: 3.2611100673675537
Epoch: 7, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
Validation loss decreased (-0.878374 --> -0.916213).  Saving model ...
Epoch: 8 cost time: 3.406130790710449
Epoch: 8, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.279 Vali Acc: 0.916 Test Loss: 0.279 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 9 cost time: 3.466933488845825
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.916213 --> -0.929728).  Saving model ...
Epoch: 10 cost time: 3.490385055541992
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 3.533928871154785
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 3.4417507648468018
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5656890869140625
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.932 Test Loss: 0.174 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7590432167053223
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.932 Test Loss: 0.172 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.655947208404541
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 3.6119906902313232
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 17 cost time: 3.962278366088867
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7861695289611816
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3779468536376953
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 20 cost time: 3.3832356929779053
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.501828670501709
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 22 cost time: 3.1502742767333984
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.935 Test Loss: 0.152 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2416083812713623
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945945).  Saving model ...
Epoch: 24 cost time: 3.5050525665283203
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
Validation loss decreased (-0.945945 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 3.24984073638916
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.935 Test Loss: 0.149 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.419238328933716
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.935 Test Loss: 0.140 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2438018321990967
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2944440841674805
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 29 cost time: 3.182771682739258
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.255694627761841
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.36441707611084
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.943 Test Loss: 0.141 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.415583372116089
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.5159718990325928
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.941 Test Loss: 0.142 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4023597240448
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 35 cost time: 3.7114005088806152
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 36 cost time: 3.3102211952209473
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.946 Test Loss: 0.140 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.231696128845215
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.946 Test Loss: 0.140 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4720706939697266
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.63171124458313
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.3305108547210693
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 41 cost time: 3.5248513221740723
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.6281614303588867
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.5643911361694336
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 44 cost time: 3.5382213592529297
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.399082899093628
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.5276525020599365
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.573859930038452
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4505043029785156
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 49 cost time: 3.6102945804595947
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.4251904487609863
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 51 cost time: 3.562513589859009
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.350241184234619
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.3866517543792725
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.662482500076294
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.7839627265930176
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.6762566566467285
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.551279306411743
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.823585033416748
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 4.110882997512817
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 4.089262008666992
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.322778224945068
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.099 Vali Acc: 0.227 Test Loss: 2.099 Test Acc: 0.227
Validation loss decreased (inf --> -0.227006).  Saving model ...
Epoch: 2 cost time: 3.3420116901397705
Epoch: 2, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.704 Vali Acc: 0.581 Test Loss: 1.704 Test Acc: 0.581
Validation loss decreased (-0.227006 --> -0.581064).  Saving model ...
Epoch: 3 cost time: 3.412580728530884
Epoch: 3, Steps: 17 | Train Loss: 1.723 Vali Loss: 1.227 Vali Acc: 0.762 Test Loss: 1.227 Test Acc: 0.762
Validation loss decreased (-0.581064 --> -0.762150).  Saving model ...
Epoch: 4 cost time: 3.380338191986084
Epoch: 4, Steps: 17 | Train Loss: 1.247 Vali Loss: 0.890 Vali Acc: 0.795 Test Loss: 0.890 Test Acc: 0.795
Validation loss decreased (-0.762150 --> -0.794586).  Saving model ...
Epoch: 5 cost time: 3.339287757873535
Epoch: 5, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
Validation loss decreased (-0.794586 --> -0.797291).  Saving model ...
Epoch: 6 cost time: 3.3311214447021484
Epoch: 6, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.342 Vali Acc: 0.908 Test Loss: 0.342 Test Acc: 0.908
Validation loss decreased (-0.797291 --> -0.908105).  Saving model ...
Epoch: 7 cost time: 3.4461052417755127
Epoch: 7, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.908105 --> -0.940538).  Saving model ...
Epoch: 8 cost time: 3.4083282947540283
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.36940598487854
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 3.560699462890625
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 3.658209800720215
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.701223373413086
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5570454597473145
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 3.493901252746582
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.536503553390503
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.550248622894287
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.86641001701355
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3984663486480713
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.202328681945801
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.36421275138855
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.436398983001709
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 3.4959981441497803
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4881958961486816
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 3.447517156600952
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7570769786834717
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 3.6759631633758545
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 3.751399517059326
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.367668390274048
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.37105131149292
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4835610389709473
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.5703563690185547
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4119021892547607
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.5334322452545166
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.2790963649749756
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.322596788406372
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.3085436820983887
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.299695014953613
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.093 Vali Acc: 0.249 Test Loss: 2.093 Test Acc: 0.249
Validation loss decreased (inf --> -0.248628).  Saving model ...
Epoch: 2 cost time: 3.7213733196258545
Epoch: 2, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.690 Vali Acc: 0.592 Test Loss: 1.690 Test Acc: 0.592
Validation loss decreased (-0.248628 --> -0.591875).  Saving model ...
Epoch: 3 cost time: 3.5548131465911865
Epoch: 3, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.215 Vali Acc: 0.743 Test Loss: 1.215 Test Acc: 0.743
Validation loss decreased (-0.591875 --> -0.743231).  Saving model ...
Epoch: 4 cost time: 3.6252450942993164
Epoch: 4, Steps: 17 | Train Loss: 1.194 Vali Loss: 0.865 Vali Acc: 0.786 Test Loss: 0.865 Test Acc: 0.786
Validation loss decreased (-0.743231 --> -0.786478).  Saving model ...
Epoch: 5 cost time: 3.325551986694336
Epoch: 5, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.608 Vali Acc: 0.805 Test Loss: 0.608 Test Acc: 0.805
Validation loss decreased (-0.786478 --> -0.805399).  Saving model ...
Epoch: 6 cost time: 3.4065539836883545
Epoch: 6, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.358 Vali Acc: 0.905 Test Loss: 0.358 Test Acc: 0.905
Validation loss decreased (-0.805399 --> -0.905402).  Saving model ...
Epoch: 7 cost time: 3.6795332431793213
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
Validation loss decreased (-0.905402 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 3.9098007678985596
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.269 Vali Acc: 0.924 Test Loss: 0.269 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7671701908111572
Epoch: 9, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940539).  Saving model ...
Epoch: 10 cost time: 3.68900728225708
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8710930347442627
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.695211410522461
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5715696811676025
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 14 cost time: 3.4847617149353027
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9324398040771484
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.946 Test Loss: 0.140 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.667130947113037
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 3.8793540000915527
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 3.863762140274048
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.123733282089233
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 4.080962181091309
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.194167375564575
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.2124974727630615
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.041698694229126
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 3.7656009197235107
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7331295013427734
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.951 Test Loss: 0.118 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.6020569801330566
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.6409833431243896
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.954 Test Loss: 0.109 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.7272543907165527
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.954 Test Loss: 0.106 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.989032506942749
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.149228572845459
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.954 Test Loss: 0.106 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.8144891262054443
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.9576234817504883
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.528950452804565
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.9547648429870605
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (inf --> -0.083762).  Saving model ...
Epoch: 2 cost time: 3.5822224617004395
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 3 cost time: 3.4083197116851807
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5458130836486816
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.891991138458252
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3546576499938965
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 7 cost time: 3.572174072265625
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4937145709991455
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 9 cost time: 3.4701364040374756
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 10 cost time: 3.794546365737915
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.051664590835571
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.555300235748291
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.541926383972168
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7800581455230713
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7428853511810303
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.537322521209717
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 17 cost time: 3.7232823371887207
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.568349599838257
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.940697431564331
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6733574867248535
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 21 cost time: 3.506603479385376
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5483334064483643
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.29225754737854
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3568012714385986
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 25 cost time: 3.5655393600463867
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.464634418487549
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5401530265808105
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 28 cost time: 4.061614990234375
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6021857261657715
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.422913074493408
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5679962635040283
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 32 cost time: 3.650923728942871
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 33 cost time: 3.38724684715271
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.709528923034668
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.6828088760375977
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.7439889907836914
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.649108409881592
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5568675994873047
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.9003055095672607
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.177989482879639
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 41 cost time: 3.6474437713623047
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 42 cost time: 3.9766087532043457
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
Validation loss decreased (-0.083762 --> -0.083762).  Saving model ...
Epoch: 43 cost time: 3.7749032974243164
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.142216205596924
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.5652952194213867
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.8071038722991943
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.8372786045074463
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.083762 --> -0.108086).  Saving model ...
Epoch: 48 cost time: 3.77516770362854
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.689929723739624
Epoch: 49, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 4.095818996429443
Epoch: 50, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.773517608642578
Epoch: 51, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.8493716716766357
Epoch: 52, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 53 cost time: 4.169647932052612
Epoch: 53, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 54 cost time: 4.000230312347412
Epoch: 54, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 55 cost time: 3.771787405014038
Epoch: 55, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.877124071121216
Epoch: 56, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.704578399658203
Epoch: 57, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.5195226669311523
Epoch: 58, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.552856683731079
Epoch: 59, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.6613106727600098
Epoch: 60, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.6325109004974365
Epoch: 61, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.5305514335632324
Epoch: 62, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.720088243484497
Epoch: 63, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.5374653339385986
Epoch: 64, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.084 Test Loss: 2.198 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.10810810810810811
model parameter : 2382345
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.55025839805603
Epoch: 1, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.020 Vali Acc: 0.424 Test Loss: 2.020 Test Acc: 0.424
Validation loss decreased (inf --> -0.424304).  Saving model ...
Epoch: 2 cost time: 3.75441575050354
Epoch: 2, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.588 Vali Acc: 0.616 Test Loss: 1.588 Test Acc: 0.616
Validation loss decreased (-0.424304 --> -0.616200).  Saving model ...
Epoch: 3 cost time: 4.029112815856934
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.183 Vali Acc: 0.714 Test Loss: 1.183 Test Acc: 0.714
Validation loss decreased (-0.616200 --> -0.713502).  Saving model ...
Epoch: 4 cost time: 4.077419996261597
Epoch: 4, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.849 Vali Acc: 0.789 Test Loss: 0.849 Test Acc: 0.789
Validation loss decreased (-0.713502 --> -0.789181).  Saving model ...
Epoch: 5 cost time: 3.714529514312744
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.562 Vali Acc: 0.859 Test Loss: 0.562 Test Acc: 0.859
Validation loss decreased (-0.789181 --> -0.859454).  Saving model ...
Epoch: 6 cost time: 3.9634342193603516
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.859454 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 3.695660352706909
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.899996 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 3.8223953247070312
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.246 Vali Acc: 0.932 Test Loss: 0.246 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 9 cost time: 3.557781219482422
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 3.7116551399230957
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 11 cost time: 4.054332494735718
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 12 cost time: 3.5940606594085693
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 13 cost time: 3.5306477546691895
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4901037216186523
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 3.559290647506714
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 3.5564942359924316
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7444710731506348
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 3.919902801513672
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 3.7675669193267822
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.709920644760132
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8613946437835693
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8241701126098633
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 4.014854431152344
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.171529531478882
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 3.897550106048584
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8338921070098877
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2956948280334473
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.951 Test Loss: 0.121 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.4242308139801025
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 3.4893910884857178
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 3.4103081226348877
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.6175875663757324
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.034443616867065
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.9216017723083496
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.77848482131958
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.4796764850616455
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 36 cost time: 3.7544398307800293
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.735490560531616
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.9175851345062256
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.799724817276001
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.451359748840332
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.6834497451782227
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.4308054447174072
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 43 cost time: 3.638054132461548
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.603846549987793
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.6357614994049072
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.682454824447632
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 47 cost time: 3.790705680847168
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.033524990081787
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.6438698768615723
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.4827651977539062
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.7137911319732666
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.80946946144104
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.74682354927063
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 54 cost time: 3.6649889945983887
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 55 cost time: 3.761007070541382
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 3.323439836502075
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.836822509765625
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.5472280979156494
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 59 cost time: 3.4755287170410156
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.4030916690826416
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 61 cost time: 3.4302985668182373
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.4963197708129883
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.7295451164245605
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.6692235469818115
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.6897523403167725
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.6389319896698
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.8656561374664307
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.672488212585449
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.6795005798339844
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 3.6933534145355225
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.097974061965942
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.078 Vali Acc: 0.346 Test Loss: 2.078 Test Acc: 0.346
Validation loss decreased (inf --> -0.345925).  Saving model ...
Epoch: 2 cost time: 3.356182813644409
Epoch: 2, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.699 Vali Acc: 0.627 Test Loss: 1.699 Test Acc: 0.627
Validation loss decreased (-0.345925 --> -0.627010).  Saving model ...
Epoch: 3 cost time: 3.802968978881836
Epoch: 3, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.285 Vali Acc: 0.730 Test Loss: 1.285 Test Acc: 0.730
Validation loss decreased (-0.627010 --> -0.729717).  Saving model ...
Epoch: 4 cost time: 3.491349458694458
Epoch: 4, Steps: 17 | Train Loss: 1.034 Vali Loss: 0.916 Vali Acc: 0.803 Test Loss: 0.916 Test Acc: 0.803
Validation loss decreased (-0.729717 --> -0.802694).  Saving model ...
Epoch: 5 cost time: 3.811598539352417
Epoch: 5, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.607 Vali Acc: 0.851 Test Loss: 0.607 Test Acc: 0.851
Validation loss decreased (-0.802694 --> -0.851345).  Saving model ...
Epoch: 6 cost time: 3.3061225414276123
Epoch: 6, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.434 Vali Acc: 0.870 Test Loss: 0.434 Test Acc: 0.870
Validation loss decreased (-0.851345 --> -0.870266).  Saving model ...
Epoch: 7 cost time: 3.493882656097412
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
Validation loss decreased (-0.870266 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 3.647749662399292
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.277 Vali Acc: 0.916 Test Loss: 0.277 Test Acc: 0.916
Validation loss decreased (-0.899997 --> -0.916213).  Saving model ...
Epoch: 9 cost time: 3.4136226177215576
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.225 Vali Acc: 0.924 Test Loss: 0.225 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924322).  Saving model ...
Epoch: 10 cost time: 3.62473726272583
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 3.4812657833099365
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5479681491851807
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 3.4205543994903564
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.5144126415252686
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 3.486637830734253
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 16 cost time: 3.453366756439209
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.250674247741699
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 3.248995542526245
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 3.5825061798095703
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4329833984375
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 3.5607540607452393
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.958625078201294
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7846152782440186
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3284475803375244
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 3.3145976066589355
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 3.79762864112854
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.6301777362823486
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2571985721588135
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1937735080718994
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 3.8588056564331055
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.695096254348755
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4849939346313477
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5973949432373047
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.726962089538574
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.475289821624756
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.799114942550659
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.8607559204101562
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 38 cost time: 3.8124585151672363
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 39 cost time: 3.410139560699463
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3753206729888916
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.5363821983337402
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.306652784347534
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 43 cost time: 3.7127625942230225
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.816481351852417
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.76670503616333
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.840299367904663
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 47 cost time: 3.9419455528259277
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 48 cost time: 3.861100912094116
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.7266845703125
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.8286869525909424
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.943721055984497
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.4537994861602783
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.1884870529174805
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.244839668273926
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 55 cost time: 3.5066030025482178
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 56 cost time: 3.2596306800842285
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 57 cost time: 3.2892050743103027
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 58 cost time: 3.439079999923706
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 59 cost time: 3.420090436935425
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5808632373809814
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.5594441890716553
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.940243721008301
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.4973056316375732
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.553706645965576
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.365771532058716
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.5396223068237305
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.630162239074707
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.723592758178711
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.0514421463012695
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.111 Vali Acc: 0.222 Test Loss: 2.111 Test Acc: 0.222
Validation loss decreased (inf --> -0.221601).  Saving model ...
Epoch: 2 cost time: 3.393545389175415
Epoch: 2, Steps: 17 | Train Loss: 1.963 Vali Loss: 1.806 Vali Acc: 0.554 Test Loss: 1.806 Test Acc: 0.554
Validation loss decreased (-0.221601 --> -0.554036).  Saving model ...
Epoch: 3 cost time: 3.4283573627471924
Epoch: 3, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.417 Vali Acc: 0.719 Test Loss: 1.417 Test Acc: 0.719
Validation loss decreased (-0.554036 --> -0.718905).  Saving model ...
Epoch: 4 cost time: 3.244321823120117
Epoch: 4, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.013 Vali Acc: 0.773 Test Loss: 1.013 Test Acc: 0.773
Validation loss decreased (-0.718905 --> -0.772963).  Saving model ...
Epoch: 5 cost time: 3.8819777965545654
Epoch: 5, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.647 Vali Acc: 0.824 Test Loss: 0.647 Test Acc: 0.824
Validation loss decreased (-0.772963 --> -0.824318).  Saving model ...
Epoch: 6 cost time: 3.7472779750823975
Epoch: 6, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
Validation loss decreased (-0.824318 --> -0.862158).  Saving model ...
Epoch: 7 cost time: 3.814189910888672
Epoch: 7, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
Validation loss decreased (-0.862158 --> -0.878375).  Saving model ...
Epoch: 8 cost time: 4.021965026855469
Epoch: 8, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.293 Vali Acc: 0.905 Test Loss: 0.293 Test Acc: 0.905
Validation loss decreased (-0.878375 --> -0.905402).  Saving model ...
Epoch: 9 cost time: 3.5234580039978027
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.248 Vali Acc: 0.908 Test Loss: 0.248 Test Acc: 0.908
Validation loss decreased (-0.905402 --> -0.908106).  Saving model ...
Epoch: 10 cost time: 3.3853213787078857
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.946 Test Loss: 0.212 Test Acc: 0.946
Validation loss decreased (-0.908106 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 3.494365930557251
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.207 Vali Acc: 0.919 Test Loss: 0.207 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4588422775268555
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.938 Test Loss: 0.176 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6287007331848145
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4569387435913086
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.259206533432007
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2574479579925537
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.768660545349121
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.8660709857940674
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 3.904106616973877
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.124322891235352
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 3.987703561782837
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 4.282283544540405
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.913092613220215
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.398853540420532
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.7647290229797363
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 26 cost time: 3.8194339275360107
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 27 cost time: 3.684210777282715
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6703298091888428
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 3.4585907459259033
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 3.4906294345855713
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8069050312042236
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5674586296081543
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.541059970855713
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.162346124649048
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.8778505325317383
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.173941135406494
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.769636869430542
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.430591344833374
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 4.150434255599976
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.460814952850342
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.512394666671753
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 42 cost time: 4.135802745819092
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 43 cost time: 4.100910186767578
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.8323659896850586
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.085881471633911
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.78141188621521
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 4.158564805984497
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 4.048718214035034
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.854525566101074
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.7706191539764404
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.982355833053589
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 4.0070390701293945
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 53 cost time: 3.789958953857422
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.244619369506836
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.7510969638824463
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.9317426681518555
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 4.360019207000732
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.969193458557129
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.8946354389190674
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.5521702766418457
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.662372589111328
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.7293617725372314
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.394381999969482
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.129 Vali Acc: 0.211 Test Loss: 2.129 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 3.6354312896728516
Epoch: 2, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.830 Vali Acc: 0.514 Test Loss: 1.830 Test Acc: 0.514
Validation loss decreased (-0.210790 --> -0.513495).  Saving model ...
Epoch: 3 cost time: 3.569221258163452
Epoch: 3, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.416 Vali Acc: 0.724 Test Loss: 1.416 Test Acc: 0.724
Validation loss decreased (-0.513495 --> -0.724310).  Saving model ...
Epoch: 4 cost time: 3.5762648582458496
Epoch: 4, Steps: 17 | Train Loss: 1.219 Vali Loss: 0.997 Vali Acc: 0.803 Test Loss: 0.997 Test Acc: 0.803
Validation loss decreased (-0.724310 --> -0.802693).  Saving model ...
Epoch: 5 cost time: 3.5961551666259766
Epoch: 5, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.632 Vali Acc: 0.857 Test Loss: 0.632 Test Acc: 0.857
Validation loss decreased (-0.802693 --> -0.856750).  Saving model ...
Epoch: 6 cost time: 3.369292736053467
Epoch: 6, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.446 Vali Acc: 0.873 Test Loss: 0.446 Test Acc: 0.873
Validation loss decreased (-0.856750 --> -0.872969).  Saving model ...
Epoch: 7 cost time: 3.3881750106811523
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.872969 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 3.282825469970703
Epoch: 8, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.910808).  Saving model ...
Epoch: 9 cost time: 3.357064962387085
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
Validation loss decreased (-0.910808 --> -0.927025).  Saving model ...
Epoch: 10 cost time: 3.4216485023498535
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.927025 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 3.273132801055908
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6638710498809814
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 3.4168362617492676
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.932 Test Loss: 0.190 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7676758766174316
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.737436532974243
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 3.4244070053100586
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 3.632230043411255
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 3.6411139965057373
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4340953826904297
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 3.3799893856048584
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 21 cost time: 3.360206365585327
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.549593448638916
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4866385459899902
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.447261333465576
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.2440037727355957
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.412996292114258
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.3489391803741455
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.776742696762085
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 29 cost time: 3.955374002456665
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.936145544052124
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.004112720489502
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.704596996307373
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.6051583290100098
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.7160799503326416
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.568432569503784
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.5127580165863037
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.5509865283966064
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.40915846824646
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.303901433944702
Epoch: 1, Steps: 17 | Train Loss: 2.271 Vali Loss: 2.090 Vali Acc: 0.243 Test Loss: 2.090 Test Acc: 0.243
Validation loss decreased (inf --> -0.243222).  Saving model ...
Epoch: 2 cost time: 3.722013235092163
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.725 Vali Acc: 0.597 Test Loss: 1.725 Test Acc: 0.597
Validation loss decreased (-0.243222 --> -0.597280).  Saving model ...
Epoch: 3 cost time: 3.8781440258026123
Epoch: 3, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.234 Vali Acc: 0.746 Test Loss: 1.234 Test Acc: 0.746
Validation loss decreased (-0.597280 --> -0.745934).  Saving model ...
Epoch: 4 cost time: 3.7693288326263428
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 0.893 Vali Acc: 0.786 Test Loss: 0.893 Test Acc: 0.786
Validation loss decreased (-0.745934 --> -0.786478).  Saving model ...
Epoch: 5 cost time: 3.8003299236297607
Epoch: 5, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.786478 --> -0.821615).  Saving model ...
Epoch: 6 cost time: 3.7765889167785645
Epoch: 6, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
Validation loss decreased (-0.821615 --> -0.878374).  Saving model ...
Epoch: 7 cost time: 3.9165568351745605
Epoch: 7, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.317 Vali Acc: 0.897 Test Loss: 0.317 Test Acc: 0.897
Validation loss decreased (-0.878374 --> -0.897294).  Saving model ...
Epoch: 8 cost time: 3.922027111053467
Epoch: 8, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.283 Vali Acc: 0.908 Test Loss: 0.283 Test Acc: 0.908
Validation loss decreased (-0.897294 --> -0.908105).  Saving model ...
Epoch: 9 cost time: 3.74208927154541
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
Validation loss decreased (-0.908105 --> -0.932430).  Saving model ...
Epoch: 10 cost time: 3.717109203338623
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 3.375922203063965
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 3.4961893558502197
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.881317615509033
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 3.6482036113739014
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 3.6344995498657227
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 3.807903289794922
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.083872318267822
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 3.7147650718688965
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8922414779663086
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8992137908935547
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.091585397720337
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.557894945144653
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.740058660507202
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.488015651702881
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.677436113357544
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7751598358154297
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.8495023250579834
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.119143724441528
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.075 Vali Acc: 0.270 Test Loss: 2.075 Test Acc: 0.270
Validation loss decreased (inf --> -0.270250).  Saving model ...
Epoch: 2 cost time: 3.65571665763855
Epoch: 2, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.711 Vali Acc: 0.608 Test Loss: 1.711 Test Acc: 0.608
Validation loss decreased (-0.270250 --> -0.608091).  Saving model ...
Epoch: 3 cost time: 3.735691785812378
Epoch: 3, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.211 Vali Acc: 0.797 Test Loss: 1.211 Test Acc: 0.797
Validation loss decreased (-0.608091 --> -0.797285).  Saving model ...
Epoch: 4 cost time: 3.4520976543426514
Epoch: 4, Steps: 17 | Train Loss: 1.246 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
Validation loss decreased (-0.797285 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 3.710927724838257
Epoch: 5, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.564 Vali Acc: 0.849 Test Loss: 0.564 Test Acc: 0.849
Validation loss decreased (-0.799992 --> -0.848643).  Saving model ...
Epoch: 6 cost time: 3.4847750663757324
Epoch: 6, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (-0.848643 --> -0.889185).  Saving model ...
Epoch: 7 cost time: 3.5581753253936768
Epoch: 7, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.889185 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 3.4103641510009766
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.263 Vali Acc: 0.908 Test Loss: 0.263 Test Acc: 0.908
Validation loss decreased (-0.899997 --> -0.908105).  Saving model ...
Epoch: 9 cost time: 3.6077356338500977
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.908105 --> -0.940539).  Saving model ...
Epoch: 10 cost time: 3.3377881050109863
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3308112621307373
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3513495922088623
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 3.3918867111206055
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 3.4908628463745117
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 15 cost time: 3.4399166107177734
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.481269121170044
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4033563137054443
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5367772579193115
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 3.4023361206054688
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3890581130981445
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5930287837982178
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4078962802886963
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.496772289276123
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.356337547302246
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.315948009490967
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 26 cost time: 3.2684738636016846
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3730509281158447
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 3.4629132747650146
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 3.5274946689605713
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 3.4838359355926514
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.633145809173584
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5101943016052246
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 3.8301475048065186
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 3.6761322021484375
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 3.4455645084381104
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.349468231201172
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 37 cost time: 3.459207534790039
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.573227643966675
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3434865474700928
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 40 cost time: 3.607696056365967
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 41 cost time: 3.289644241333008
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.2653512954711914
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 43 cost time: 3.3177757263183594
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.373582124710083
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.29056715965271
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.255160093307495
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 47 cost time: 3.5746939182281494
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 48 cost time: 3.431096315383911
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 3.819485664367676
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 50 cost time: 3.5172958374023438
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.479416847229004
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.443126678466797
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.696777820587158
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.4364144802093506
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.3442845344543457
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.341503381729126
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.476045608520508
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.4145569801330566
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.476625919342041
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.677902460098267
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
Validation loss decreased (inf --> -0.078356).  Saving model ...
Epoch: 2 cost time: 3.814913749694824
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 3 cost time: 3.794964551925659
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 4 cost time: 3.4488015174865723
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.750147581100464
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.534844398498535
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6977906227111816
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6329381465911865
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6559269428253174
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6996991634368896
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.066942453384399
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.613266944885254
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.6669540405273438
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.078 Test Loss: 2.197 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.07837837837837838
model parameter : 1989129
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.547222375869751
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.021 Vali Acc: 0.351 Test Loss: 2.021 Test Acc: 0.351
Validation loss decreased (inf --> -0.351331).  Saving model ...
Epoch: 2 cost time: 3.66691255569458
Epoch: 2, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.607 Vali Acc: 0.678 Test Loss: 1.607 Test Acc: 0.678
Validation loss decreased (-0.351331 --> -0.678362).  Saving model ...
Epoch: 3 cost time: 3.5007338523864746
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.180 Vali Acc: 0.754 Test Loss: 1.180 Test Acc: 0.754
Validation loss decreased (-0.678362 --> -0.754042).  Saving model ...
Epoch: 4 cost time: 3.734684467315674
Epoch: 4, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.837 Vali Acc: 0.789 Test Loss: 0.837 Test Acc: 0.789
Validation loss decreased (-0.754042 --> -0.789181).  Saving model ...
Epoch: 5 cost time: 3.7856783866882324
Epoch: 5, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.549 Vali Acc: 0.865 Test Loss: 0.549 Test Acc: 0.865
Validation loss decreased (-0.789181 --> -0.864859).  Saving model ...
Epoch: 6 cost time: 3.531035900115967
Epoch: 6, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.864859 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 3.621020793914795
Epoch: 7, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
Validation loss decreased (-0.899996 --> -0.937835).  Saving model ...
Epoch: 8 cost time: 3.5401697158813477
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.860522508621216
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 10 cost time: 3.7812085151672363
Epoch: 10, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5854005813598633
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 3.578270435333252
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4986565113067627
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5229990482330322
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.457364320755005
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5927765369415283
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.522822618484497
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.7353920936584473
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 19 cost time: 3.5286006927490234
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 20 cost time: 3.328021287918091
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3119142055511475
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 3.536426544189453
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 23 cost time: 3.8079662322998047
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 3.4981184005737305
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.491955518722534
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.465700387954712
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.951 Test Loss: 0.121 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.507373809814453
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5945217609405518
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.362408399581909
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 30 cost time: 3.37451171875
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.6540215015411377
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 32 cost time: 3.5189754962921143
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.954 Test Loss: 0.112 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.7475483417510986
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.44736385345459
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6201417446136475
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.568821668624878
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 3.736468553543091
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 3.8433783054351807
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 3.7065634727478027
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.059938192367554
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.618211030960083
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.4964473247528076
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 43 cost time: 3.633212089538574
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.7072384357452393
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.478300094604492
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.5913143157958984
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.7785940170288086
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.9021103382110596
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.157435417175293
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.893124580383301
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.861999750137329
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 4.1371259689331055
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.201817035675049
Epoch: 1, Steps: 17 | Train Loss: 2.225 Vali Loss: 2.072 Vali Acc: 0.286 Test Loss: 2.072 Test Acc: 0.286
Validation loss decreased (inf --> -0.286466).  Saving model ...
Epoch: 2 cost time: 3.675957441329956
Epoch: 2, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.721 Vali Acc: 0.619 Test Loss: 1.721 Test Acc: 0.619
Validation loss decreased (-0.286466 --> -0.618902).  Saving model ...
Epoch: 3 cost time: 3.6441779136657715
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.290 Vali Acc: 0.743 Test Loss: 1.290 Test Acc: 0.743
Validation loss decreased (-0.618902 --> -0.743230).  Saving model ...
Epoch: 4 cost time: 3.44874906539917
Epoch: 4, Steps: 17 | Train Loss: 1.037 Vali Loss: 0.904 Vali Acc: 0.797 Test Loss: 0.904 Test Acc: 0.797
Validation loss decreased (-0.743230 --> -0.797288).  Saving model ...
Epoch: 5 cost time: 3.7231345176696777
Epoch: 5, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.588 Vali Acc: 0.857 Test Loss: 0.588 Test Acc: 0.857
Validation loss decreased (-0.797288 --> -0.856751).  Saving model ...
Epoch: 6 cost time: 3.798811435699463
Epoch: 6, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.420 Vali Acc: 0.886 Test Loss: 0.420 Test Acc: 0.886
Validation loss decreased (-0.856751 --> -0.886482).  Saving model ...
Epoch: 7 cost time: 4.132014036178589
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.298 Vali Acc: 0.914 Test Loss: 0.298 Test Acc: 0.914
Validation loss decreased (-0.886482 --> -0.913511).  Saving model ...
Epoch: 8 cost time: 3.828403949737549
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.254 Vali Acc: 0.916 Test Loss: 0.254 Test Acc: 0.916
Validation loss decreased (-0.913511 --> -0.916214).  Saving model ...
Epoch: 9 cost time: 3.911263942718506
Epoch: 9, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.916214 --> -0.929728).  Saving model ...
Epoch: 10 cost time: 3.840179920196533
Epoch: 10, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932431).  Saving model ...
Epoch: 11 cost time: 3.8926329612731934
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.932431 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.9446816444396973
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.949887990951538
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 4.104437589645386
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 3.961946725845337
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.857788324356079
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7117013931274414
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 18 cost time: 3.8494622707366943
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.796518087387085
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 4.042373418807983
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.082789897918701
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 22 cost time: 3.820836067199707
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 3.928232431411743
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9837372303009033
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8869636058807373
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.452597141265869
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.7776038646698
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.671175956726074
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.5221714973449707
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 3.8779330253601074
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.943920373916626
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 32 cost time: 4.024078369140625
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.7296202182769775
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.9628336429595947
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.037232875823975
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.7393460273742676
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 4.012593507766724
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 38 cost time: 3.759211301803589
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.06666374206543
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.465757131576538
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.9309256076812744
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.771280527114868
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.481393814086914
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.640883207321167
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.6539578437805176
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.663259506225586
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.6147310733795166
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.3875572681427
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.104 Vali Acc: 0.216 Test Loss: 2.104 Test Acc: 0.216
Validation loss decreased (inf --> -0.216195).  Saving model ...
Epoch: 2 cost time: 3.9549763202667236
Epoch: 2, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.828 Vali Acc: 0.497 Test Loss: 1.828 Test Acc: 0.497
Validation loss decreased (-0.216195 --> -0.497279).  Saving model ...
Epoch: 3 cost time: 4.1083338260650635
Epoch: 3, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.439 Vali Acc: 0.703 Test Loss: 1.439 Test Acc: 0.703
Validation loss decreased (-0.497279 --> -0.702688).  Saving model ...
Epoch: 4 cost time: 3.967695474624634
Epoch: 4, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.025 Vali Acc: 0.757 Test Loss: 1.025 Test Acc: 0.757
Validation loss decreased (-0.702688 --> -0.756747).  Saving model ...
Epoch: 5 cost time: 3.52424955368042
Epoch: 5, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.637 Vali Acc: 0.851 Test Loss: 0.637 Test Acc: 0.851
Validation loss decreased (-0.756747 --> -0.851345).  Saving model ...
Epoch: 6 cost time: 3.7176239490509033
Epoch: 6, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
Validation loss decreased (-0.851345 --> -0.883779).  Saving model ...
Epoch: 7 cost time: 3.4068896770477295
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.317 Vali Acc: 0.914 Test Loss: 0.317 Test Acc: 0.914
Validation loss decreased (-0.883779 --> -0.913510).  Saving model ...
Epoch: 8 cost time: 3.741992235183716
Epoch: 8, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.263 Vali Acc: 0.927 Test Loss: 0.263 Test Acc: 0.927
Validation loss decreased (-0.913510 --> -0.927024).  Saving model ...
Epoch: 9 cost time: 3.5452423095703125
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.220 Vali Acc: 0.924 Test Loss: 0.220 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5592470169067383
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 3.4844934940338135
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.937836 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 3.4062082767486572
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5700528621673584
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.93573260307312
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 3.7020604610443115
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.805021286010742
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5768237113952637
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 4.338465213775635
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.5866611003875732
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 20 cost time: 3.69832181930542
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.339970350265503
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 3.6974563598632812
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 3.428640365600586
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.391497850418091
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 25 cost time: 3.6309337615966797
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7076215744018555
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8302695751190186
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.434210777282715
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3086259365081787
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 30 cost time: 3.6839852333068848
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 31 cost time: 3.698469400405884
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 32 cost time: 3.6669328212738037
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 3.803722620010376
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.954 Test Loss: 0.116 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.677579164505005
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.516662120819092
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.715538740158081
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.601651430130005
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 3.603031873703003
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.5775716304779053
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.5007805824279785
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.469697952270508
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4793267250061035
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.1613738536834717
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.4012160301208496
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.486172914505005
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.5708627700805664
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.4367926120758057
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.6945273876190186
Epoch: 1, Steps: 17 | Train Loss: 2.235 Vali Loss: 2.122 Vali Acc: 0.195 Test Loss: 2.122 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 3.4940264225006104
Epoch: 2, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.853 Vali Acc: 0.486 Test Loss: 1.853 Test Acc: 0.486
Validation loss decreased (-0.194573 --> -0.486468).  Saving model ...
Epoch: 3 cost time: 3.76911997795105
Epoch: 3, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.433 Vali Acc: 0.724 Test Loss: 1.433 Test Acc: 0.724
Validation loss decreased (-0.486468 --> -0.724310).  Saving model ...
Epoch: 4 cost time: 3.684201717376709
Epoch: 4, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.017 Vali Acc: 0.776 Test Loss: 1.017 Test Acc: 0.776
Validation loss decreased (-0.724310 --> -0.775666).  Saving model ...
Epoch: 5 cost time: 3.526897430419922
Epoch: 5, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.633 Vali Acc: 0.843 Test Loss: 0.633 Test Acc: 0.843
Validation loss decreased (-0.775666 --> -0.843237).  Saving model ...
Epoch: 6 cost time: 3.5672833919525146
Epoch: 6, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.429 Vali Acc: 0.873 Test Loss: 0.429 Test Acc: 0.873
Validation loss decreased (-0.843237 --> -0.872969).  Saving model ...
Epoch: 7 cost time: 3.559574604034424
Epoch: 7, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.317 Vali Acc: 0.916 Test Loss: 0.317 Test Acc: 0.916
Validation loss decreased (-0.872969 --> -0.916213).  Saving model ...
Epoch: 8 cost time: 3.7637176513671875
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.281 Vali Acc: 0.916 Test Loss: 0.281 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 9 cost time: 3.536106586456299
Epoch: 9, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918917).  Saving model ...
Epoch: 10 cost time: 3.5875115394592285
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.204 Vali Acc: 0.927 Test Loss: 0.204 Test Acc: 0.927
Validation loss decreased (-0.918917 --> -0.927025).  Saving model ...
Epoch: 11 cost time: 3.4461112022399902
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 3.6730165481567383
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.762291431427002
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 14 cost time: 3.7371559143066406
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6950557231903076
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943242).  Saving model ...
Epoch: 16 cost time: 3.484771490097046
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.932 Test Loss: 0.181 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6382641792297363
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 18 cost time: 3.6466548442840576
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 3.931995391845703
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.941 Test Loss: 0.147 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.451853036880493
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.941 Test Loss: 0.152 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3464019298553467
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.938 Test Loss: 0.150 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5046908855438232
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.941 Test Loss: 0.148 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3584301471710205
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 3.772653341293335
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945945).  Saving model ...
Epoch: 25 cost time: 3.337545394897461
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.633185625076294
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.373446464538574
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5088837146759033
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
Validation loss decreased (-0.945945 --> -0.945945).  Saving model ...
Epoch: 29 cost time: 3.6192331314086914
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.946 Test Loss: 0.135 Test Acc: 0.946
Validation loss decreased (-0.945945 --> -0.945945).  Saving model ...
Epoch: 30 cost time: 3.594085931777954
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
Validation loss decreased (-0.945945 --> -0.948647).  Saving model ...
Epoch: 31 cost time: 3.7022061347961426
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.643137216567993
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.943 Test Loss: 0.137 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5233590602874756
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.943 Test Loss: 0.142 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.7458934783935547
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.627715826034546
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.3187687397003174
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.946 Test Loss: 0.135 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.4232633113861084
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.943 Test Loss: 0.136 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.3487050533294678
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.943 Test Loss: 0.137 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.3590328693389893
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.3095922470092773
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.943 Test Loss: 0.139 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.243237257003784
Epoch: 1, Steps: 17 | Train Loss: 2.234 Vali Loss: 2.096 Vali Acc: 0.222 Test Loss: 2.096 Test Acc: 0.222
Validation loss decreased (inf --> -0.221601).  Saving model ...
Epoch: 2 cost time: 3.539354085922241
Epoch: 2, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.772 Vali Acc: 0.481 Test Loss: 1.772 Test Acc: 0.481
Validation loss decreased (-0.221601 --> -0.481063).  Saving model ...
Epoch: 3 cost time: 3.4765734672546387
Epoch: 3, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.269 Vali Acc: 0.773 Test Loss: 1.269 Test Acc: 0.773
Validation loss decreased (-0.481063 --> -0.772960).  Saving model ...
Epoch: 4 cost time: 3.5330469608306885
Epoch: 4, Steps: 17 | Train Loss: 1.324 Vali Loss: 0.867 Vali Acc: 0.792 Test Loss: 0.867 Test Acc: 0.792
Validation loss decreased (-0.772960 --> -0.791883).  Saving model ...
Epoch: 5 cost time: 3.894458293914795
Epoch: 5, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.791883 --> -0.837832).  Saving model ...
Epoch: 6 cost time: 3.554572820663452
Epoch: 6, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.379 Vali Acc: 0.897 Test Loss: 0.379 Test Acc: 0.897
Validation loss decreased (-0.837832 --> -0.897294).  Saving model ...
Epoch: 7 cost time: 3.507185935974121
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.897294 --> -0.929727).  Saving model ...
Epoch: 8 cost time: 3.7105870246887207
Epoch: 8, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 3.6609065532684326
Epoch: 9, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.160 Vali Acc: 0.935 Test Loss: 0.160 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5062921047210693
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.937836 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 3.5994176864624023
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.796640634536743
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5940868854522705
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 14 cost time: 3.7097995281219482
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 3.6868460178375244
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8422677516937256
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.1007843017578125
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.891359329223633
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.063632011413574
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7728962898254395
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.3149733543396
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.131387233734131
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.179431915283203
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6308279037475586
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.898898124694824
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.112 Vali Acc: 0.197 Test Loss: 2.112 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 3.292818307876587
Epoch: 2, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.777 Vali Acc: 0.516 Test Loss: 1.777 Test Acc: 0.516
Validation loss decreased (-0.197276 --> -0.516198).  Saving model ...
Epoch: 3 cost time: 3.767483949661255
Epoch: 3, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.288 Vali Acc: 0.746 Test Loss: 1.288 Test Acc: 0.746
Validation loss decreased (-0.516198 --> -0.745933).  Saving model ...
Epoch: 4 cost time: 3.885202169418335
Epoch: 4, Steps: 17 | Train Loss: 1.299 Vali Loss: 0.900 Vali Acc: 0.762 Test Loss: 0.900 Test Acc: 0.762
Validation loss decreased (-0.745933 --> -0.762153).  Saving model ...
Epoch: 5 cost time: 3.503195285797119
Epoch: 5, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.584 Vali Acc: 0.843 Test Loss: 0.584 Test Acc: 0.843
Validation loss decreased (-0.762153 --> -0.843237).  Saving model ...
Epoch: 6 cost time: 3.630582809448242
Epoch: 6, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.417 Vali Acc: 0.873 Test Loss: 0.417 Test Acc: 0.873
Validation loss decreased (-0.843237 --> -0.872969).  Saving model ...
Epoch: 7 cost time: 3.489236354827881
Epoch: 7, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
Validation loss decreased (-0.872969 --> -0.929727).  Saving model ...
Epoch: 8 cost time: 3.772125005722046
Epoch: 8, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 9 cost time: 3.573014974594116
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 3.799126386642456
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.943241 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 3.3218190670013428
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4569766521453857
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3361496925354004
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.943 Test Loss: 0.140 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2018609046936035
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 3.687692403793335
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5977561473846436
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4964232444763184
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.149733781814575
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7669830322265625
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3633623123168945
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.700843095779419
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.804063320159912
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 3.6022047996520996
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.616647720336914
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7203173637390137
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7789177894592285
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.7856569290161133
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 3.428152561187744
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.480611801147461
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.52204966545105
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.6914799213409424
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.448124647140503
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.5337026119232178
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.336357831954956
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.4117627143859863
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.8842856884002686
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 37 cost time: 3.401707887649536
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.556694984436035
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.7839484214782715
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.5226664543151855
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.6069862842559814
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.4693527221679688
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.954 Test Loss: 0.108 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.4975829124450684
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.550076961517334
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.5965585708618164
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.912670850753784
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.58062744140625
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
Validation loss decreased (inf --> -0.237816).  Saving model ...
Epoch: 2 cost time: 3.8238227367401123
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7085018157958984
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.838056802749634
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.061346769332886
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.957719087600708
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9546868801116943
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.7377309799194336
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.370988368988037
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.915116786956787
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5442776679992676
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.197 Vali Acc: 0.238 Test Loss: 2.197 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.23783783783783785
model parameter : 1792521
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.416893005371094
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.074 Vali Acc: 0.295 Test Loss: 2.074 Test Acc: 0.295
Validation loss decreased (inf --> -0.294574).  Saving model ...
Epoch: 2 cost time: 4.0282087326049805
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.674 Vali Acc: 0.576 Test Loss: 1.674 Test Acc: 0.576
Validation loss decreased (-0.294574 --> -0.575659).  Saving model ...
Epoch: 3 cost time: 3.6909382343292236
Epoch: 3, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.329 Vali Acc: 0.684 Test Loss: 1.329 Test Acc: 0.684
Validation loss decreased (-0.575659 --> -0.683770).  Saving model ...
Epoch: 4 cost time: 4.056995630264282
Epoch: 4, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.075 Vali Acc: 0.732 Test Loss: 1.075 Test Acc: 0.732
Validation loss decreased (-0.683770 --> -0.732422).  Saving model ...
Epoch: 5 cost time: 3.693516731262207
Epoch: 5, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.786 Vali Acc: 0.795 Test Loss: 0.786 Test Acc: 0.795
Validation loss decreased (-0.732422 --> -0.794587).  Saving model ...
Epoch: 6 cost time: 3.4697978496551514
Epoch: 6, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.579 Vali Acc: 0.868 Test Loss: 0.579 Test Acc: 0.868
Validation loss decreased (-0.794587 --> -0.867562).  Saving model ...
Epoch: 7 cost time: 3.7141189575195312
Epoch: 7, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
Validation loss decreased (-0.867562 --> -0.889185).  Saving model ...
Epoch: 8 cost time: 3.2522168159484863
Epoch: 8, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.335 Vali Acc: 0.914 Test Loss: 0.335 Test Acc: 0.914
Validation loss decreased (-0.889185 --> -0.913510).  Saving model ...
Epoch: 9 cost time: 3.2527079582214355
Epoch: 9, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.913510 --> -0.929727).  Saving model ...
Epoch: 10 cost time: 3.5441243648529053
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 3.3371644020080566
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 3.54022216796875
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 3.493659496307373
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 3.9631893634796143
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 3.7222042083740234
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 3.2811548709869385
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 3.8270158767700195
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 3.5698416233062744
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6134300231933594
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5296802520751953
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5079727172851562
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 3.0920512676239014
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3688809871673584
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 3.3827898502349854
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4202589988708496
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 3.5346100330352783
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2984719276428223
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6493358612060547
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2487142086029053
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2049102783203125
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 31 cost time: 3.7447080612182617
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.848006248474121
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 3.529099702835083
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5093729496002197
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.5787627696990967
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.5539894104003906
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.5005648136138916
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5978734493255615
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.3789124488830566
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.5180130004882812
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.7121894359588623
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.324017286300659
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.444543361663818
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.106 Vali Acc: 0.216 Test Loss: 2.106 Test Acc: 0.216
Validation loss decreased (inf --> -0.216195).  Saving model ...
Epoch: 2 cost time: 3.5882725715637207
Epoch: 2, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.773 Vali Acc: 0.535 Test Loss: 1.773 Test Acc: 0.535
Validation loss decreased (-0.216195 --> -0.535117).  Saving model ...
Epoch: 3 cost time: 4.096316337585449
Epoch: 3, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.443 Vali Acc: 0.654 Test Loss: 1.443 Test Acc: 0.654
Validation loss decreased (-0.535117 --> -0.654040).  Saving model ...
Epoch: 4 cost time: 4.050434589385986
Epoch: 4, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.185 Vali Acc: 0.716 Test Loss: 1.185 Test Acc: 0.716
Validation loss decreased (-0.654040 --> -0.716204).  Saving model ...
Epoch: 5 cost time: 3.5695223808288574
Epoch: 5, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.889 Vali Acc: 0.781 Test Loss: 0.889 Test Acc: 0.781
Validation loss decreased (-0.716204 --> -0.781072).  Saving model ...
Epoch: 6 cost time: 3.6390650272369385
Epoch: 6, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.674 Vali Acc: 0.846 Test Loss: 0.674 Test Acc: 0.846
Validation loss decreased (-0.781072 --> -0.845939).  Saving model ...
Epoch: 7 cost time: 3.7184789180755615
Epoch: 7, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.490 Vali Acc: 0.889 Test Loss: 0.490 Test Acc: 0.889
Validation loss decreased (-0.845939 --> -0.889184).  Saving model ...
Epoch: 8 cost time: 3.642911434173584
Epoch: 8, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.889184 --> -0.902699).  Saving model ...
Epoch: 9 cost time: 3.693967819213867
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.304 Vali Acc: 0.927 Test Loss: 0.304 Test Acc: 0.927
Validation loss decreased (-0.902699 --> -0.927024).  Saving model ...
Epoch: 10 cost time: 3.874800682067871
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.927 Test Loss: 0.289 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 11 cost time: 3.686021566390991
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.239 Vali Acc: 0.938 Test Loss: 0.239 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 12 cost time: 3.4406211376190186
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 13 cost time: 3.879443407058716
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 3.725109577178955
Epoch: 14, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 3.520594358444214
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.54075026512146
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 3.847334384918213
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6201188564300537
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 3.6111297607421875
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5739905834198
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6804580688476562
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.497994899749756
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 3.338306188583374
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.449371814727783
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 3.411193609237671
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7811496257781982
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 3.9852116107940674
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3575260639190674
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6072428226470947
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 3.852651357650757
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8252410888671875
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3203063011169434
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5267093181610107
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.95194149017334
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.731039047241211
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.478236436843872
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.618586301803589
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3696091175079346
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.5357770919799805
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.996809482574463
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.142 Vali Acc: 0.184 Test Loss: 2.142 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 3.6909351348876953
Epoch: 2, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.889 Vali Acc: 0.470 Test Loss: 1.889 Test Acc: 0.470
Validation loss decreased (-0.183762 --> -0.470251).  Saving model ...
Epoch: 3 cost time: 3.6950974464416504
Epoch: 3, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.608 Vali Acc: 0.619 Test Loss: 1.608 Test Acc: 0.619
Validation loss decreased (-0.470251 --> -0.618903).  Saving model ...
Epoch: 4 cost time: 3.9982564449310303
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.367 Vali Acc: 0.665 Test Loss: 1.367 Test Acc: 0.665
Validation loss decreased (-0.618903 --> -0.664851).  Saving model ...
Epoch: 5 cost time: 3.896595001220703
Epoch: 5, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.056 Vali Acc: 0.751 Test Loss: 1.056 Test Acc: 0.751
Validation loss decreased (-0.664851 --> -0.751341).  Saving model ...
Epoch: 6 cost time: 3.4057023525238037
Epoch: 6, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.800 Vali Acc: 0.819 Test Loss: 0.800 Test Acc: 0.819
Validation loss decreased (-0.751341 --> -0.818911).  Saving model ...
Epoch: 7 cost time: 3.8580336570739746
Epoch: 7, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
Validation loss decreased (-0.818911 --> -0.862156).  Saving model ...
Epoch: 8 cost time: 3.5842723846435547
Epoch: 8, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.455 Vali Acc: 0.881 Test Loss: 0.455 Test Acc: 0.881
Validation loss decreased (-0.862156 --> -0.881077).  Saving model ...
Epoch: 9 cost time: 3.7958984375
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.341 Vali Acc: 0.905 Test Loss: 0.341 Test Acc: 0.905
Validation loss decreased (-0.881077 --> -0.905402).  Saving model ...
Epoch: 10 cost time: 3.771139144897461
Epoch: 10, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.300 Vali Acc: 0.924 Test Loss: 0.300 Test Acc: 0.924
Validation loss decreased (-0.905402 --> -0.924321).  Saving model ...
Epoch: 11 cost time: 3.162046432495117
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.273 Vali Acc: 0.927 Test Loss: 0.273 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 4.0225372314453125
Epoch: 12, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 13 cost time: 3.722308874130249
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929728).  Saving model ...
Epoch: 14 cost time: 3.676154375076294
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.227 Vali Acc: 0.924 Test Loss: 0.227 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.807838201522827
Epoch: 15, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.228 Vali Acc: 0.924 Test Loss: 0.228 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.145626783370972
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.932 Test Loss: 0.211 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932430).  Saving model ...
Epoch: 17 cost time: 3.655362844467163
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 18 cost time: 3.8409454822540283
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 19 cost time: 3.6674840450286865
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4863572120666504
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.547027111053467
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4996819496154785
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.705836534500122
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6893677711486816
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.767122745513916
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 26 cost time: 3.464674472808838
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 27 cost time: 3.7377541065216064
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9579780101776123
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8301942348480225
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.029764175415039
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 31 cost time: 3.9312329292297363
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.774077892303467
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4869344234466553
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.5858964920043945
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.5874080657958984
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 36 cost time: 3.417450428009033
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.393115520477295
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.6571812629699707
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.620486259460449
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 3.6984150409698486
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.639599084854126
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.5187766551971436
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.6556670665740967
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 44 cost time: 3.68218731880188
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 45 cost time: 3.7180676460266113
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.738717794418335
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.266916513442993
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.224451780319214
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.4048876762390137
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.249162435531616
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.414560556411743
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.314793109893799
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 53 cost time: 3.47792387008667
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.4954755306243896
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.5472161769866943
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.7546701431274414
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.548445701599121
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.7201852798461914
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.7717206478118896
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.584252119064331
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.6307058334350586
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.8495121002197266
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.164200782775879
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.160 Vali Acc: 0.165 Test Loss: 2.160 Test Acc: 0.165
Validation loss decreased (inf --> -0.164843).  Saving model ...
Epoch: 2 cost time: 3.405277967453003
Epoch: 2, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.933 Vali Acc: 0.427 Test Loss: 1.933 Test Acc: 0.427
Validation loss decreased (-0.164843 --> -0.427008).  Saving model ...
Epoch: 3 cost time: 3.7910799980163574
Epoch: 3, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.658 Vali Acc: 0.649 Test Loss: 1.658 Test Acc: 0.649
Validation loss decreased (-0.427008 --> -0.648632).  Saving model ...
Epoch: 4 cost time: 4.235483884811401
Epoch: 4, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.389 Vali Acc: 0.716 Test Loss: 1.389 Test Acc: 0.716
Validation loss decreased (-0.648632 --> -0.716202).  Saving model ...
Epoch: 5 cost time: 4.050264835357666
Epoch: 5, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.072 Vali Acc: 0.743 Test Loss: 1.072 Test Acc: 0.743
Validation loss decreased (-0.716202 --> -0.743233).  Saving model ...
Epoch: 6 cost time: 3.617644786834717
Epoch: 6, Steps: 17 | Train Loss: 0.903 Vali Loss: 0.801 Vali Acc: 0.811 Test Loss: 0.801 Test Acc: 0.811
Validation loss decreased (-0.743233 --> -0.810803).  Saving model ...
Epoch: 7 cost time: 3.9634623527526855
Epoch: 7, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.568 Vali Acc: 0.854 Test Loss: 0.568 Test Acc: 0.854
Validation loss decreased (-0.810803 --> -0.854048).  Saving model ...
Epoch: 8 cost time: 4.14272141456604
Epoch: 8, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
Validation loss decreased (-0.854048 --> -0.859455).  Saving model ...
Epoch: 9 cost time: 3.594881772994995
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.344 Vali Acc: 0.905 Test Loss: 0.344 Test Acc: 0.905
Validation loss decreased (-0.859455 --> -0.905402).  Saving model ...
Epoch: 10 cost time: 3.365168333053589
Epoch: 10, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
Validation loss decreased (-0.905402 --> -0.910808).  Saving model ...
Epoch: 11 cost time: 3.7738611698150635
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
Validation loss decreased (-0.910808 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 3.8848562240600586
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7971811294555664
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.927024 --> -0.940538).  Saving model ...
Epoch: 14 cost time: 3.87188982963562
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9627742767333984
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.815148115158081
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 17 cost time: 3.9594593048095703
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 4.019302845001221
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 19 cost time: 4.157602310180664
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.114977836608887
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 3.7692670822143555
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.399372100830078
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3329172134399414
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.501534938812256
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4501540660858154
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3946828842163086
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.660794496536255
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3316569328308105
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 29 cost time: 3.527235984802246
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.647606372833252
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.680720806121826
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 3.5915541648864746
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5102267265319824
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.766390800476074
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.7203187942504883
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.7442047595977783
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.4709250926971436
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2723021507263184
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.610599994659424
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.488952398300171
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.240051507949829
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.3139331340789795
Epoch: 1, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.132 Vali Acc: 0.184 Test Loss: 2.132 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 3.3234426975250244
Epoch: 2, Steps: 17 | Train Loss: 2.121 Vali Loss: 1.914 Vali Acc: 0.449 Test Loss: 1.914 Test Acc: 0.449
Validation loss decreased (-0.183762 --> -0.448630).  Saving model ...
Epoch: 3 cost time: 4.11545467376709
Epoch: 3, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.632 Vali Acc: 0.624 Test Loss: 1.632 Test Acc: 0.624
Validation loss decreased (-0.448630 --> -0.624308).  Saving model ...
Epoch: 4 cost time: 3.5088250637054443
Epoch: 4, Steps: 17 | Train Loss: 1.724 Vali Loss: 1.340 Vali Acc: 0.700 Test Loss: 1.340 Test Acc: 0.700
Validation loss decreased (-0.624308 --> -0.699987).  Saving model ...
Epoch: 5 cost time: 3.5650017261505127
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.032 Vali Acc: 0.759 Test Loss: 1.032 Test Acc: 0.759
Validation loss decreased (-0.699987 --> -0.759449).  Saving model ...
Epoch: 6 cost time: 3.7256338596343994
Epoch: 6, Steps: 17 | Train Loss: 1.023 Vali Loss: 0.795 Vali Acc: 0.808 Test Loss: 0.795 Test Acc: 0.808
Validation loss decreased (-0.759449 --> -0.808100).  Saving model ...
Epoch: 7 cost time: 3.646223306655884
Epoch: 7, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.582 Vali Acc: 0.830 Test Loss: 0.582 Test Acc: 0.830
Validation loss decreased (-0.808100 --> -0.829724).  Saving model ...
Epoch: 8 cost time: 3.279322385787964
Epoch: 8, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
Validation loss decreased (-0.829724 --> -0.883780).  Saving model ...
Epoch: 9 cost time: 3.5459020137786865
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.339 Vali Acc: 0.895 Test Loss: 0.339 Test Acc: 0.895
Validation loss decreased (-0.883780 --> -0.894591).  Saving model ...
Epoch: 10 cost time: 3.59592604637146
Epoch: 10, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.282 Vali Acc: 0.916 Test Loss: 0.282 Test Acc: 0.916
Validation loss decreased (-0.894591 --> -0.916213).  Saving model ...
Epoch: 11 cost time: 3.2118613719940186
Epoch: 11, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918916).  Saving model ...
Epoch: 12 cost time: 3.578967332839966
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929728).  Saving model ...
Epoch: 13 cost time: 4.079434633255005
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.226 Vali Acc: 0.932 Test Loss: 0.226 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932430).  Saving model ...
Epoch: 14 cost time: 3.9606881141662598
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
Validation loss decreased (-0.932430 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 4.253766775131226
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.600440263748169
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7941219806671143
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6925032138824463
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8157565593719482
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.876049041748047
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6177620887756348
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.6206648349761963
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.5459706783294678
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.528597831726074
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.267683506011963
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.134 Vali Acc: 0.189 Test Loss: 2.134 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 3.8225104808807373
Epoch: 2, Steps: 17 | Train Loss: 2.056 Vali Loss: 1.882 Vali Acc: 0.503 Test Loss: 1.882 Test Acc: 0.503
Validation loss decreased (-0.189168 --> -0.502684).  Saving model ...
Epoch: 3 cost time: 3.5760765075683594
Epoch: 3, Steps: 17 | Train Loss: 1.855 Vali Loss: 1.573 Vali Acc: 0.703 Test Loss: 1.573 Test Acc: 0.703
Validation loss decreased (-0.502684 --> -0.702687).  Saving model ...
Epoch: 4 cost time: 3.3663086891174316
Epoch: 4, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.277 Vali Acc: 0.762 Test Loss: 1.277 Test Acc: 0.762
Validation loss decreased (-0.702687 --> -0.762149).  Saving model ...
Epoch: 5 cost time: 3.5393781661987305
Epoch: 5, Steps: 17 | Train Loss: 1.286 Vali Loss: 0.959 Vali Acc: 0.786 Test Loss: 0.959 Test Acc: 0.786
Validation loss decreased (-0.762149 --> -0.786477).  Saving model ...
Epoch: 6 cost time: 3.597409963607788
Epoch: 6, Steps: 17 | Train Loss: 0.966 Vali Loss: 0.715 Vali Acc: 0.830 Test Loss: 0.715 Test Acc: 0.830
Validation loss decreased (-0.786477 --> -0.829723).  Saving model ...
Epoch: 7 cost time: 3.754481315612793
Epoch: 7, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.523 Vali Acc: 0.859 Test Loss: 0.523 Test Acc: 0.859
Validation loss decreased (-0.829723 --> -0.859454).  Saving model ...
Epoch: 8 cost time: 3.3511552810668945
Epoch: 8, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
Validation loss decreased (-0.859454 --> -0.889185).  Saving model ...
Epoch: 9 cost time: 3.4032726287841797
Epoch: 9, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.299 Vali Acc: 0.914 Test Loss: 0.299 Test Acc: 0.914
Validation loss decreased (-0.889185 --> -0.913511).  Saving model ...
Epoch: 10 cost time: 3.1769566535949707
Epoch: 10, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.276 Vali Acc: 0.924 Test Loss: 0.276 Test Acc: 0.924
Validation loss decreased (-0.913511 --> -0.924322).  Saving model ...
Epoch: 11 cost time: 3.2996504306793213
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
Validation loss decreased (-0.924322 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 3.555433511734009
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 13 cost time: 3.476653814315796
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3044321537017822
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 3.3325233459472656
Epoch: 15, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.5355076789855957
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3844261169433594
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6619837284088135
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.282691717147827
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.444941282272339
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 3.443695545196533
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4660184383392334
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1863927841186523
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1554789543151855
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.1837456226348877
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 3.3545165061950684
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2237586975097656
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2041444778442383
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6784260272979736
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.216207981109619
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 3.2616524696350098
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2512474060058594
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.6493771076202393
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.5523035526275635
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.3085978031158447
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.6105520725250244
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.45414400100708
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.245561361312866
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.2966578006744385
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 3.3969223499298096
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.36369252204895
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.3367791175842285
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.3829500675201416
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.8661108016967773
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.7576935291290283
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.12856388092041
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 47 cost time: 3.877918243408203
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.7486908435821533
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.6619083881378174
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.510347366333008
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 51 cost time: 3.602808713912964
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.0519800186157227
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.3745391368865967
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.237513780593872
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.3567922115325928
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.2122585773468018
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.486626148223877
Epoch: 57, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.704744815826416
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.7569029331207275
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.3932583332061768
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.193209648132324
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 3.3207993507385254
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 3 cost time: 3.3288426399230957
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 4 cost time: 3.3135318756103516
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2423505783081055
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1610748767852783
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 7 cost time: 3.275489330291748
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 8 cost time: 3.200796604156494
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3716390132904053
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 10 cost time: 3.4033043384552
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.326200246810913
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4278202056884766
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.339914560317993
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2521560192108154
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2112948894500732
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.327054977416992
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2944865226745605
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.252641439437866
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1722004413604736
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.13513513513513514
model parameter : 1993993
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.001899003982544
Epoch: 1, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.099 Vali Acc: 0.224 Test Loss: 2.099 Test Acc: 0.224
Validation loss decreased (inf --> -0.224303).  Saving model ...
Epoch: 2 cost time: 3.055189847946167
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.780 Vali Acc: 0.551 Test Loss: 1.780 Test Acc: 0.551
Validation loss decreased (-0.224303 --> -0.551334).  Saving model ...
Epoch: 3 cost time: 3.2165322303771973
Epoch: 3, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.439 Vali Acc: 0.662 Test Loss: 1.439 Test Acc: 0.662
Validation loss decreased (-0.551334 --> -0.662148).  Saving model ...
Epoch: 4 cost time: 3.324629783630371
Epoch: 4, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.153 Vali Acc: 0.749 Test Loss: 1.153 Test Acc: 0.749
Validation loss decreased (-0.662148 --> -0.748637).  Saving model ...
Epoch: 5 cost time: 3.1732277870178223
Epoch: 5, Steps: 17 | Train Loss: 0.953 Vali Loss: 0.896 Vali Acc: 0.776 Test Loss: 0.896 Test Acc: 0.776
Validation loss decreased (-0.748637 --> -0.775667).  Saving model ...
Epoch: 6 cost time: 3.3681600093841553
Epoch: 6, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.677 Vali Acc: 0.841 Test Loss: 0.677 Test Acc: 0.841
Validation loss decreased (-0.775667 --> -0.840534).  Saving model ...
Epoch: 7 cost time: 3.103494644165039
Epoch: 7, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.511 Vali Acc: 0.881 Test Loss: 0.511 Test Acc: 0.881
Validation loss decreased (-0.840534 --> -0.881076).  Saving model ...
Epoch: 8 cost time: 3.2931618690490723
Epoch: 8, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.881076 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 3.33304500579834
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.320 Vali Acc: 0.914 Test Loss: 0.320 Test Acc: 0.914
Validation loss decreased (-0.899996 --> -0.913510).  Saving model ...
Epoch: 10 cost time: 3.2552781105041504
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.266 Vali Acc: 0.916 Test Loss: 0.266 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916214).  Saving model ...
Epoch: 11 cost time: 3.48268723487854
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.246 Vali Acc: 0.924 Test Loss: 0.246 Test Acc: 0.924
Validation loss decreased (-0.916214 --> -0.924322).  Saving model ...
Epoch: 12 cost time: 3.3017141819000244
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 13 cost time: 3.2266838550567627
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 14 cost time: 3.541332960128784
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 3.568844795227051
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 3.7649433612823486
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 3.3178999423980713
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 3.140383243560791
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 3.338076114654541
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1338677406311035
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 3.4232728481292725
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2822372913360596
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.507962465286255
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 3.9716267585754395
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 4.082679986953735
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6442935466766357
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 3.616584300994873
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 3.607565402984619
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.032184362411499
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9736645221710205
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5439064502716064
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.455078363418579
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.7469844818115234
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 3.5251457691192627
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.415436029434204
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.417426824569702
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.7860002517700195
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.4763376712799072
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.815635919570923
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.69250750541687
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.5262272357940674
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.2945568561553955
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.697970390319824
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 44 cost time: 3.7454440593719482
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3981618881225586
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.504631280899048
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.6945910453796387
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.5303149223327637
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.3684749603271484
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.438778877258301
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 51 cost time: 3.682803153991699
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.083312273025513
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.763265371322632
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.5426673889160156
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.907111883163452
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.55330228805542
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.6566474437713623
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 58 cost time: 3.634275197982788
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.3656163215637207
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.2042150497436523
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.5800414085388184
Epoch: 61, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.3213634490966797
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.2172203063964844
Epoch: 63, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 3.272456169128418
Epoch: 64, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 3.7132668495178223
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 3.537926435470581
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 3.6199114322662354
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.848206281661987
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.157 Vali Acc: 0.149 Test Loss: 2.157 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 3.2319252490997314
Epoch: 2, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.893 Vali Acc: 0.516 Test Loss: 1.893 Test Acc: 0.516
Validation loss decreased (-0.148627 --> -0.516197).  Saving model ...
Epoch: 3 cost time: 3.4936563968658447
Epoch: 3, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.575 Vali Acc: 0.665 Test Loss: 1.575 Test Acc: 0.665
Validation loss decreased (-0.516197 --> -0.664849).  Saving model ...
Epoch: 4 cost time: 3.1038644313812256
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.273 Vali Acc: 0.735 Test Loss: 1.273 Test Acc: 0.735
Validation loss decreased (-0.664849 --> -0.735122).  Saving model ...
Epoch: 5 cost time: 3.391066789627075
Epoch: 5, Steps: 17 | Train Loss: 1.076 Vali Loss: 0.993 Vali Acc: 0.781 Test Loss: 0.993 Test Acc: 0.781
Validation loss decreased (-0.735122 --> -0.781071).  Saving model ...
Epoch: 6 cost time: 3.247408390045166
Epoch: 6, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.753 Vali Acc: 0.795 Test Loss: 0.753 Test Acc: 0.795
Validation loss decreased (-0.781071 --> -0.794587).  Saving model ...
Epoch: 7 cost time: 3.1439592838287354
Epoch: 7, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.563 Vali Acc: 0.851 Test Loss: 0.563 Test Acc: 0.851
Validation loss decreased (-0.794587 --> -0.851346).  Saving model ...
Epoch: 8 cost time: 3.4135899543762207
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.435 Vali Acc: 0.897 Test Loss: 0.435 Test Acc: 0.897
Validation loss decreased (-0.851346 --> -0.897293).  Saving model ...
Epoch: 9 cost time: 3.4525692462921143
Epoch: 9, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.361 Vali Acc: 0.905 Test Loss: 0.361 Test Acc: 0.905
Validation loss decreased (-0.897293 --> -0.905402).  Saving model ...
Epoch: 10 cost time: 3.5677082538604736
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.905402 --> -0.918916).  Saving model ...
Epoch: 11 cost time: 3.307420015335083
Epoch: 11, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.273 Vali Acc: 0.927 Test Loss: 0.273 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 3.4619100093841553
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.240 Vali Acc: 0.919 Test Loss: 0.240 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4574413299560547
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.212 Vali Acc: 0.938 Test Loss: 0.212 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937836).  Saving model ...
Epoch: 14 cost time: 3.5813865661621094
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3458919525146484
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 16 cost time: 3.3051044940948486
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.938 Test Loss: 0.184 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 3.1213815212249756
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943242).  Saving model ...
Epoch: 18 cost time: 3.4996867179870605
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0533816814422607
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.938 Test Loss: 0.179 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4623663425445557
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.17385196685791
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 22 cost time: 3.1092758178710938
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5188088417053223
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3796322345733643
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.377739429473877
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 26 cost time: 3.341648817062378
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.453691005706787
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 28 cost time: 3.877962112426758
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8078553676605225
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.735680103302002
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 3.373985528945923
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1635892391204834
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 33 cost time: 3.3740522861480713
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 34 cost time: 3.3253538608551025
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4613168239593506
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.6212427616119385
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.505300521850586
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.681971549987793
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.4671473503112793
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.7362475395202637
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.583138942718506
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.563868761062622
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 43 cost time: 4.0198283195495605
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.4664413928985596
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 45 cost time: 3.5051019191741943
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.4063093662261963
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.254730463027954
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.5922086238861084
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.4133594036102295
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.3371522426605225
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 51 cost time: 3.8800089359283447
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.7924938201904297
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.786346912384033
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 54 cost time: 3.430602788925171
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.6320300102233887
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.770033597946167
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.6102170944213867
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.765165090560913
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.355192184448242
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.544281244277954
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.7357535362243652
Epoch: 61, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.519361734390259
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.8489019870758057
Epoch: 63, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.657482624053955
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.167 Vali Acc: 0.141 Test Loss: 2.167 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 3.9460630416870117
Epoch: 2, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.975 Vali Acc: 0.373 Test Loss: 1.975 Test Acc: 0.373
Validation loss decreased (-0.140519 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 3.5184998512268066
Epoch: 3, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.725 Vali Acc: 0.603 Test Loss: 1.725 Test Acc: 0.603
Validation loss decreased (-0.372953 --> -0.602685).  Saving model ...
Epoch: 4 cost time: 3.751121759414673
Epoch: 4, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.454 Vali Acc: 0.689 Test Loss: 1.454 Test Acc: 0.689
Validation loss decreased (-0.602685 --> -0.689175).  Saving model ...
Epoch: 5 cost time: 3.206425666809082
Epoch: 5, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.160 Vali Acc: 0.741 Test Loss: 1.160 Test Acc: 0.741
Validation loss decreased (-0.689175 --> -0.740529).  Saving model ...
Epoch: 6 cost time: 3.200482130050659
Epoch: 6, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
Validation loss decreased (-0.740529 --> -0.789180).  Saving model ...
Epoch: 7 cost time: 3.269469976425171
Epoch: 7, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.643 Vali Acc: 0.838 Test Loss: 0.643 Test Acc: 0.838
Validation loss decreased (-0.789180 --> -0.837831).  Saving model ...
Epoch: 8 cost time: 3.46484375
Epoch: 8, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.472 Vali Acc: 0.884 Test Loss: 0.472 Test Acc: 0.884
Validation loss decreased (-0.837831 --> -0.883779).  Saving model ...
Epoch: 9 cost time: 3.586923837661743
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.375 Vali Acc: 0.908 Test Loss: 0.375 Test Acc: 0.908
Validation loss decreased (-0.883779 --> -0.908104).  Saving model ...
Epoch: 10 cost time: 3.300252676010132
Epoch: 10, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.908104 --> -0.921619).  Saving model ...
Epoch: 11 cost time: 3.5577383041381836
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.277 Vali Acc: 0.927 Test Loss: 0.277 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 3.5261449813842773
Epoch: 12, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.233 Vali Acc: 0.924 Test Loss: 0.233 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3292388916015625
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 14 cost time: 3.5657129287719727
Epoch: 14, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 15 cost time: 3.585235834121704
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 16 cost time: 3.762286424636841
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 4.055335521697998
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 18 cost time: 3.370109796524048
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 19 cost time: 3.5437638759613037
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.764500617980957
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 21 cost time: 3.504709243774414
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 3.7665228843688965
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 3.64056396484375
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 24 cost time: 3.320883274078369
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6185765266418457
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 3.212026834487915
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 3.781313180923462
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7061712741851807
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6955037117004395
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 30 cost time: 3.524834632873535
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4040729999542236
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2868058681488037
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.795182943344116
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.369377374649048
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.1466448307037354
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.346982002258301
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.547567129135132
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 3.2749500274658203
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 39 cost time: 3.5532097816467285
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.722100257873535
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.722989797592163
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.415252447128296
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 43 cost time: 3.9482033252716064
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 44 cost time: 3.545975685119629
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.6045567989349365
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.2441556453704834
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.4118099212646484
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.1394524574279785
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.3456151485443115
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.4758944511413574
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.363091468811035
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.75441575050354
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.935131072998047
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8725950717926025
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.132 Vali Acc: 0.176 Test Loss: 2.132 Test Acc: 0.176
Validation loss decreased (inf --> -0.175654).  Saving model ...
Epoch: 2 cost time: 3.563365936279297
Epoch: 2, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.978 Vali Acc: 0.362 Test Loss: 1.978 Test Acc: 0.362
Validation loss decreased (-0.175654 --> -0.362142).  Saving model ...
Epoch: 3 cost time: 3.604219675064087
Epoch: 3, Steps: 17 | Train Loss: 1.883 Vali Loss: 1.748 Vali Acc: 0.586 Test Loss: 1.748 Test Acc: 0.586
Validation loss decreased (-0.362142 --> -0.586469).  Saving model ...
Epoch: 4 cost time: 3.4247307777404785
Epoch: 4, Steps: 17 | Train Loss: 1.649 Vali Loss: 1.480 Vali Acc: 0.686 Test Loss: 1.480 Test Acc: 0.686
Validation loss decreased (-0.586469 --> -0.686472).  Saving model ...
Epoch: 5 cost time: 3.5342671871185303
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.193 Vali Acc: 0.735 Test Loss: 1.193 Test Acc: 0.735
Validation loss decreased (-0.686472 --> -0.735123).  Saving model ...
Epoch: 6 cost time: 3.4041647911071777
Epoch: 6, Steps: 17 | Train Loss: 1.047 Vali Loss: 0.926 Vali Acc: 0.762 Test Loss: 0.926 Test Acc: 0.762
Validation loss decreased (-0.735123 --> -0.762153).  Saving model ...
Epoch: 7 cost time: 3.4732651710510254
Epoch: 7, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.685 Vali Acc: 0.838 Test Loss: 0.685 Test Acc: 0.838
Validation loss decreased (-0.762153 --> -0.837831).  Saving model ...
Epoch: 8 cost time: 3.2997021675109863
Epoch: 8, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.500 Vali Acc: 0.884 Test Loss: 0.500 Test Acc: 0.884
Validation loss decreased (-0.837831 --> -0.883779).  Saving model ...
Epoch: 9 cost time: 3.432692766189575
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.396 Vali Acc: 0.895 Test Loss: 0.396 Test Acc: 0.895
Validation loss decreased (-0.883779 --> -0.894591).  Saving model ...
Epoch: 10 cost time: 3.7880659103393555
Epoch: 10, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.894591 --> -0.902700).  Saving model ...
Epoch: 11 cost time: 3.625883102416992
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.902700 --> -0.918916).  Saving model ...
Epoch: 12 cost time: 3.568204879760742
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 13 cost time: 3.5335183143615723
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 14 cost time: 3.320096731185913
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 3.291512966156006
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.205 Vali Acc: 0.927 Test Loss: 0.205 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.297884464263916
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 3.6131656169891357
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 3.1664459705352783
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.101914405822754
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.140946865081787
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 3.1114888191223145
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.29264760017395
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0816009044647217
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.943 Test Loss: 0.163 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.367692708969116
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.354417085647583
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4252889156341553
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 3.252016544342041
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2126359939575195
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.350759506225586
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 3.4530694484710693
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 3.365471601486206
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.202575922012329
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 33 cost time: 3.26869535446167
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4093973636627197
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.317288398742676
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.0853328704833984
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.1405487060546875
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 38 cost time: 3.1705329418182373
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2954161167144775
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.124739646911621
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.1070733070373535
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4332196712493896
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.5459558963775635
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 44 cost time: 3.2078800201416016
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.264951705932617
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.1230931282043457
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.9675261974334717
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 48 cost time: 3.1598153114318848
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 49 cost time: 3.0944957733154297
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 50 cost time: 3.026566982269287
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 51 cost time: 3.201836585998535
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.244108200073242
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.431459903717041
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.646678924560547
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.3296749591827393
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.2831175327301025
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.3268868923187256
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.3179337978363037
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.19907283782959
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.2875242233276367
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.439007759094238
Epoch: 1, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.138 Vali Acc: 0.203 Test Loss: 2.138 Test Acc: 0.203
Validation loss decreased (inf --> -0.202681).  Saving model ...
Epoch: 2 cost time: 3.1657989025115967
Epoch: 2, Steps: 17 | Train Loss: 2.138 Vali Loss: 1.974 Vali Acc: 0.359 Test Loss: 1.974 Test Acc: 0.359
Validation loss decreased (-0.202681 --> -0.359440).  Saving model ...
Epoch: 3 cost time: 3.209620714187622
Epoch: 3, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.725 Vali Acc: 0.581 Test Loss: 1.725 Test Acc: 0.581
Validation loss decreased (-0.359440 --> -0.581064).  Saving model ...
Epoch: 4 cost time: 3.231412887573242
Epoch: 4, Steps: 17 | Train Loss: 1.758 Vali Loss: 1.433 Vali Acc: 0.705 Test Loss: 1.433 Test Acc: 0.705
Validation loss decreased (-0.581064 --> -0.705391).  Saving model ...
Epoch: 5 cost time: 3.199205160140991
Epoch: 5, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.145 Vali Acc: 0.735 Test Loss: 1.145 Test Acc: 0.735
Validation loss decreased (-0.705391 --> -0.735124).  Saving model ...
Epoch: 6 cost time: 3.553178548812866
Epoch: 6, Steps: 17 | Train Loss: 1.114 Vali Loss: 0.914 Vali Acc: 0.754 Test Loss: 0.914 Test Acc: 0.754
Validation loss decreased (-0.735124 --> -0.754045).  Saving model ...
Epoch: 7 cost time: 3.3916921615600586
Epoch: 7, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.660 Vali Acc: 0.835 Test Loss: 0.660 Test Acc: 0.835
Validation loss decreased (-0.754045 --> -0.835129).  Saving model ...
Epoch: 8 cost time: 3.1594390869140625
Epoch: 8, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.476 Vali Acc: 0.873 Test Loss: 0.476 Test Acc: 0.873
Validation loss decreased (-0.835129 --> -0.872968).  Saving model ...
Epoch: 9 cost time: 3.4095640182495117
Epoch: 9, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.357 Vali Acc: 0.914 Test Loss: 0.357 Test Acc: 0.914
Validation loss decreased (-0.872968 --> -0.913510).  Saving model ...
Epoch: 10 cost time: 3.350640296936035
Epoch: 10, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 11 cost time: 3.526418924331665
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.247 Vali Acc: 0.932 Test Loss: 0.247 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 12 cost time: 3.2041542530059814
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 3.1211776733398438
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 2.9856972694396973
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 3.0173916816711426
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9389374256134033
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 3.2226316928863525
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 3.2684385776519775
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1522879600524902
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3210034370422363
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9536120891571045
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.366769552230835
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8773574829101562
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 3.2113356590270996
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.141291379928589
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1569762229919434
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.27061128616333
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.3121204376220703
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.203888416290283
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0448386669158936
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.12496018409729
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.3800172805786133
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.143078327178955
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 34 cost time: 3.204716444015503
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2926816940307617
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.227065086364746
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.161463499069214
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.9612107276916504
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.388076066970825
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.2724783420562744
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.303222417831421
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.4246721267700195
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 43 cost time: 3.2966084480285645
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.339838743209839
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.307368040084839
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.788060188293457
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.702707529067993
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.4515111446380615
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 49 cost time: 3.43122935295105
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.31642484664917
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.2753405570983887
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.701791763305664
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.729916572570801
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.6221768856048584
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.530423879623413
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.6220595836639404
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.5469415187835693
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.5777626037597656
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.438449859619141
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.120 Vali Acc: 0.192 Test Loss: 2.120 Test Acc: 0.192
Validation loss decreased (inf --> -0.191871).  Saving model ...
Epoch: 2 cost time: 3.1287899017333984
Epoch: 2, Steps: 17 | Train Loss: 2.104 Vali Loss: 1.937 Vali Acc: 0.432 Test Loss: 1.937 Test Acc: 0.432
Validation loss decreased (-0.191871 --> -0.432413).  Saving model ...
Epoch: 3 cost time: 3.1257898807525635
Epoch: 3, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.667 Vali Acc: 0.668 Test Loss: 1.667 Test Acc: 0.668
Validation loss decreased (-0.432413 --> -0.667551).  Saving model ...
Epoch: 4 cost time: 3.238321304321289
Epoch: 4, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.366 Vali Acc: 0.732 Test Loss: 1.366 Test Acc: 0.732
Validation loss decreased (-0.667551 --> -0.732419).  Saving model ...
Epoch: 5 cost time: 3.225666046142578
Epoch: 5, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.089 Vali Acc: 0.732 Test Loss: 1.089 Test Acc: 0.732
Validation loss decreased (-0.732419 --> -0.732422).  Saving model ...
Epoch: 6 cost time: 3.2885289192199707
Epoch: 6, Steps: 17 | Train Loss: 1.029 Vali Loss: 0.882 Vali Acc: 0.754 Test Loss: 0.882 Test Acc: 0.754
Validation loss decreased (-0.732422 --> -0.754045).  Saving model ...
Epoch: 7 cost time: 3.2839720249176025
Epoch: 7, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.658 Vali Acc: 0.795 Test Loss: 0.658 Test Acc: 0.795
Validation loss decreased (-0.754045 --> -0.794588).  Saving model ...
Epoch: 8 cost time: 3.27604079246521
Epoch: 8, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.492 Vali Acc: 0.865 Test Loss: 0.492 Test Acc: 0.865
Validation loss decreased (-0.794588 --> -0.864860).  Saving model ...
Epoch: 9 cost time: 3.274386405944824
Epoch: 9, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.384 Vali Acc: 0.895 Test Loss: 0.384 Test Acc: 0.895
Validation loss decreased (-0.864860 --> -0.894591).  Saving model ...
Epoch: 10 cost time: 3.5487070083618164
Epoch: 10, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.298 Vali Acc: 0.916 Test Loss: 0.298 Test Acc: 0.916
Validation loss decreased (-0.894591 --> -0.916213).  Saving model ...
Epoch: 11 cost time: 3.513378620147705
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 12 cost time: 3.2869553565979004
Epoch: 12, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 13 cost time: 3.118992805480957
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5305230617523193
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 3.6840221881866455
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 16 cost time: 3.2399277687072754
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 3.0587167739868164
Epoch: 17, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 18 cost time: 3.4483442306518555
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4960553646087646
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4030606746673584
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 3.5659945011138916
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.297210693359375
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6100876331329346
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 3.39072585105896
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 3.6855106353759766
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.213895797729492
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 3.243185043334961
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2113795280456543
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1676530838012695
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 3.231348752975464
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4901301860809326
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2320713996887207
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3557910919189453
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.273597478866577
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3503787517547607
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.25018310546875
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.4642138481140137
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.5520336627960205
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.9367570877075195
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.567411422729492
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 3.0969343185424805
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.061349868774414
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 4 cost time: 3.243389129638672
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.469972848892212
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 6 cost time: 3.5919744968414307
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.665285348892212
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 8 cost time: 3.718038558959961
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.613266706466675
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 10 cost time: 3.4736714363098145
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 11 cost time: 3.5221946239471436
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.308647632598877
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 13 cost time: 3.0484561920166016
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 14 cost time: 3.297259569168091
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0984981060028076
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.361241340637207
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.135 Test Loss: 2.199 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5417978763580322
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6030569076538086
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 19 cost time: 3.6287248134613037
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 20 cost time: 3.555644989013672
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6752772331237793
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6909594535827637
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6106741428375244
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 24 cost time: 3.756600856781006
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.589784860610962
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3486220836639404
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 27 cost time: 3.1876635551452637
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5113492012023926
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1551175117492676
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.449664831161499
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 31 cost time: 3.4124598503112793
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5313539505004883
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.6669974327087402
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.7032904624938965
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.5542678833007812
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5940675735473633
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.525430202484131
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.254058361053467
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.037126064300537
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.1951897144317627
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.135 Test Loss: 2.198 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.13513513513513514
model parameter : 1207561
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.689153432846069
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.056 Vali Acc: 0.251 Test Loss: 2.056 Test Acc: 0.251
Validation loss decreased (inf --> -0.251331).  Saving model ...
Epoch: 2 cost time: 3.6055259704589844
Epoch: 2, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.773 Vali Acc: 0.573 Test Loss: 1.773 Test Acc: 0.573
Validation loss decreased (-0.251331 --> -0.572955).  Saving model ...
Epoch: 3 cost time: 3.9046683311462402
Epoch: 3, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.487 Vali Acc: 0.670 Test Loss: 1.487 Test Acc: 0.670
Validation loss decreased (-0.572955 --> -0.670255).  Saving model ...
Epoch: 4 cost time: 3.4157135486602783
Epoch: 4, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.209 Vali Acc: 0.722 Test Loss: 1.209 Test Acc: 0.722
Validation loss decreased (-0.670255 --> -0.721610).  Saving model ...
Epoch: 5 cost time: 3.763252019882202
Epoch: 5, Steps: 17 | Train Loss: 1.029 Vali Loss: 0.959 Vali Acc: 0.762 Test Loss: 0.959 Test Acc: 0.762
Validation loss decreased (-0.721610 --> -0.762153).  Saving model ...
Epoch: 6 cost time: 3.389270067214966
Epoch: 6, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.731 Vali Acc: 0.832 Test Loss: 0.731 Test Acc: 0.832
Validation loss decreased (-0.762153 --> -0.832425).  Saving model ...
Epoch: 7 cost time: 3.56949782371521
Epoch: 7, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.554 Vali Acc: 0.857 Test Loss: 0.554 Test Acc: 0.857
Validation loss decreased (-0.832425 --> -0.856751).  Saving model ...
Epoch: 8 cost time: 3.2742199897766113
Epoch: 8, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.427 Vali Acc: 0.873 Test Loss: 0.427 Test Acc: 0.873
Validation loss decreased (-0.856751 --> -0.872969).  Saving model ...
Epoch: 9 cost time: 3.6008448600769043
Epoch: 9, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.345 Vali Acc: 0.897 Test Loss: 0.345 Test Acc: 0.897
Validation loss decreased (-0.872969 --> -0.897294).  Saving model ...
Epoch: 10 cost time: 3.251911163330078
Epoch: 10, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
Validation loss decreased (-0.897294 --> -0.921619).  Saving model ...
Epoch: 11 cost time: 3.3581552505493164
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 12 cost time: 3.284425735473633
Epoch: 12, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 13 cost time: 3.1883556842803955
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 3.4387941360473633
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 3.302419900894165
Epoch: 15, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 3.6385934352874756
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 17 cost time: 3.48256778717041
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 3.740374803543091
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 3.420764207839966
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 3.3831746578216553
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 3.6155855655670166
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1081089973449707
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.441560745239258
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3554112911224365
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.099656343460083
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 3.2425293922424316
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2811167240142822
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4533774852752686
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.3248281478881836
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.428921699523926
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.579077959060669
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.4070911407470703
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 33 cost time: 3.4241857528686523
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5061824321746826
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.84055757522583
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 3.5203754901885986
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 37 cost time: 3.628419876098633
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.4447832107543945
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.4653713703155518
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.151679754257202
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.310274839401245
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.598378896713257
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.711798906326294
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.4331376552581787
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.537451982498169
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.6371119022369385
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.122593879699707
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.108 Vali Acc: 0.214 Test Loss: 2.108 Test Acc: 0.214
Validation loss decreased (inf --> -0.213492).  Saving model ...
Epoch: 2 cost time: 3.161980628967285
Epoch: 2, Steps: 17 | Train Loss: 2.027 Vali Loss: 1.879 Vali Acc: 0.459 Test Loss: 1.879 Test Acc: 0.459
Validation loss decreased (-0.213492 --> -0.459441).  Saving model ...
Epoch: 3 cost time: 3.252739906311035
Epoch: 3, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.621 Vali Acc: 0.627 Test Loss: 1.621 Test Acc: 0.627
Validation loss decreased (-0.459441 --> -0.627011).  Saving model ...
Epoch: 4 cost time: 3.3711915016174316
Epoch: 4, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.340 Vali Acc: 0.714 Test Loss: 1.340 Test Acc: 0.714
Validation loss decreased (-0.627011 --> -0.713500).  Saving model ...
Epoch: 5 cost time: 3.297970771789551
Epoch: 5, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.063 Vali Acc: 0.757 Test Loss: 1.063 Test Acc: 0.757
Validation loss decreased (-0.713500 --> -0.756746).  Saving model ...
Epoch: 6 cost time: 3.105897903442383
Epoch: 6, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.819 Vali Acc: 0.805 Test Loss: 0.819 Test Acc: 0.805
Validation loss decreased (-0.756746 --> -0.805397).  Saving model ...
Epoch: 7 cost time: 3.643224000930786
Epoch: 7, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.623 Vali Acc: 0.827 Test Loss: 0.623 Test Acc: 0.827
Validation loss decreased (-0.805397 --> -0.827021).  Saving model ...
Epoch: 8 cost time: 3.782172679901123
Epoch: 8, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.481 Vali Acc: 0.876 Test Loss: 0.481 Test Acc: 0.876
Validation loss decreased (-0.827021 --> -0.875671).  Saving model ...
Epoch: 9 cost time: 3.507963180541992
Epoch: 9, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.402 Vali Acc: 0.881 Test Loss: 0.402 Test Acc: 0.881
Validation loss decreased (-0.875671 --> -0.881077).  Saving model ...
Epoch: 10 cost time: 3.5445215702056885
Epoch: 10, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.329 Vali Acc: 0.895 Test Loss: 0.329 Test Acc: 0.895
Validation loss decreased (-0.881077 --> -0.894591).  Saving model ...
Epoch: 11 cost time: 3.4102249145507812
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.894591 --> -0.902700).  Saving model ...
Epoch: 12 cost time: 3.655162811279297
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
Validation loss decreased (-0.902700 --> -0.918916).  Saving model ...
Epoch: 13 cost time: 3.6412885189056396
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 14 cost time: 3.2940258979797363
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929728).  Saving model ...
Epoch: 15 cost time: 3.3985490798950195
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 16 cost time: 3.4688055515289307
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 3.1732192039489746
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 3.3765695095062256
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.48667311668396
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 3.3929929733276367
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4714159965515137
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 3.3170673847198486
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 3.4702694416046143
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 3.402409315109253
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 3.400212526321411
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.714292049407959
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3923418521881104
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3406107425689697
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 3.03349232673645
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 3.191478729248047
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.430403709411621
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.1552884578704834
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3449196815490723
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 3.587584972381592
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6737616062164307
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.4715704917907715
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3468635082244873
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.248685121536255
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.3390204906463623
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.6398372650146484
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 41 cost time: 3.5860161781311035
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.275461435317993
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.497846841812134
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.39316725730896
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.558098554611206
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.2614974975585938
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.314694881439209
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.317790985107422
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.429184675216675
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.4474337100982666
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.735635280609131
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.156 Vali Acc: 0.168 Test Loss: 2.156 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 3.199582815170288
Epoch: 2, Steps: 17 | Train Loss: 2.084 Vali Loss: 1.983 Vali Acc: 0.359 Test Loss: 1.983 Test Acc: 0.359
Validation loss decreased (-0.167546 --> -0.359440).  Saving model ...
Epoch: 3 cost time: 3.1993861198425293
Epoch: 3, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.774 Vali Acc: 0.532 Test Loss: 1.774 Test Acc: 0.532
Validation loss decreased (-0.359440 --> -0.532415).  Saving model ...
Epoch: 4 cost time: 3.063788414001465
Epoch: 4, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.518 Vali Acc: 0.668 Test Loss: 1.518 Test Acc: 0.668
Validation loss decreased (-0.532415 --> -0.667552).  Saving model ...
Epoch: 5 cost time: 3.177248239517212
Epoch: 5, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.238 Vali Acc: 0.749 Test Loss: 1.238 Test Acc: 0.749
Validation loss decreased (-0.667552 --> -0.748636).  Saving model ...
Epoch: 6 cost time: 3.1442856788635254
Epoch: 6, Steps: 17 | Train Loss: 1.012 Vali Loss: 0.973 Vali Acc: 0.786 Test Loss: 0.973 Test Acc: 0.786
Validation loss decreased (-0.748636 --> -0.786477).  Saving model ...
Epoch: 7 cost time: 3.122205972671509
Epoch: 7, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.744 Vali Acc: 0.827 Test Loss: 0.744 Test Acc: 0.827
Validation loss decreased (-0.786477 --> -0.827020).  Saving model ...
Epoch: 8 cost time: 3.2569351196289062
Epoch: 8, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.827020 --> -0.840535).  Saving model ...
Epoch: 9 cost time: 3.0622339248657227
Epoch: 9, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.468 Vali Acc: 0.868 Test Loss: 0.468 Test Acc: 0.868
Validation loss decreased (-0.840535 --> -0.867563).  Saving model ...
Epoch: 10 cost time: 3.147691249847412
Epoch: 10, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.867563 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 3.2716426849365234
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.321 Vali Acc: 0.908 Test Loss: 0.321 Test Acc: 0.908
Validation loss decreased (-0.899996 --> -0.908105).  Saving model ...
Epoch: 12 cost time: 3.264273166656494
Epoch: 12, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.288 Vali Acc: 0.916 Test Loss: 0.288 Test Acc: 0.916
Validation loss decreased (-0.908105 --> -0.916213).  Saving model ...
Epoch: 13 cost time: 3.319190740585327
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 14 cost time: 3.250084400177002
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.229 Vali Acc: 0.924 Test Loss: 0.229 Test Acc: 0.924
Validation loss decreased (-0.921619 --> -0.924322).  Saving model ...
Epoch: 15 cost time: 3.2364490032196045
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
Validation loss decreased (-0.924322 --> -0.927025).  Saving model ...
Epoch: 16 cost time: 3.10438871383667
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.210 Vali Acc: 0.924 Test Loss: 0.210 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1140048503875732
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.927 Test Loss: 0.211 Test Acc: 0.927
Validation loss decreased (-0.927025 --> -0.927025).  Saving model ...
Epoch: 18 cost time: 3.22580623626709
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929728).  Saving model ...
Epoch: 19 cost time: 3.1688382625579834
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
Validation loss decreased (-0.929728 --> -0.937836).  Saving model ...
Epoch: 20 cost time: 3.438413619995117
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8070387840270996
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 22 cost time: 3.779632329940796
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.1097612380981445
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 24 cost time: 3.806180953979492
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 25 cost time: 3.691664218902588
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5691146850585938
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.547877788543701
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.4169423580169678
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.378730297088623
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.2012526988983154
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 3.350708246231079
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.405120611190796
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 33 cost time: 3.7517566680908203
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3591103553771973
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 35 cost time: 3.4219229221343994
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3970086574554443
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 37 cost time: 3.260608434677124
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.25520658493042
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.4356305599212646
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.037055015563965
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.87809419631958
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.8996970653533936
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.9681649208068848
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.9752845764160156
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.041161060333252
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.1409640312194824
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.902554035186768
Epoch: 1, Steps: 17 | Train Loss: 2.243 Vali Loss: 2.162 Vali Acc: 0.132 Test Loss: 2.162 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 3.131265640258789
Epoch: 2, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.001 Vali Acc: 0.335 Test Loss: 2.001 Test Acc: 0.335
Validation loss decreased (-0.132411 --> -0.335115).  Saving model ...
Epoch: 3 cost time: 3.072082281112671
Epoch: 3, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.796 Vali Acc: 0.532 Test Loss: 1.796 Test Acc: 0.532
Validation loss decreased (-0.335115 --> -0.532414).  Saving model ...
Epoch: 4 cost time: 3.449329376220703
Epoch: 4, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.541 Vali Acc: 0.662 Test Loss: 1.541 Test Acc: 0.662
Validation loss decreased (-0.532414 --> -0.662147).  Saving model ...
Epoch: 5 cost time: 3.377358913421631
Epoch: 5, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.264 Vali Acc: 0.732 Test Loss: 1.264 Test Acc: 0.732
Validation loss decreased (-0.662147 --> -0.732420).  Saving model ...
Epoch: 6 cost time: 3.217672824859619
Epoch: 6, Steps: 17 | Train Loss: 1.144 Vali Loss: 0.999 Vali Acc: 0.773 Test Loss: 0.999 Test Acc: 0.773
Validation loss decreased (-0.732420 --> -0.772963).  Saving model ...
Epoch: 7 cost time: 3.216294527053833
Epoch: 7, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.755 Vali Acc: 0.811 Test Loss: 0.755 Test Acc: 0.811
Validation loss decreased (-0.772963 --> -0.810803).  Saving model ...
Epoch: 8 cost time: 3.390402317047119
Epoch: 8, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.585 Vali Acc: 0.854 Test Loss: 0.585 Test Acc: 0.854
Validation loss decreased (-0.810803 --> -0.854048).  Saving model ...
Epoch: 9 cost time: 3.225658893585205
Epoch: 9, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.466 Vali Acc: 0.873 Test Loss: 0.466 Test Acc: 0.873
Validation loss decreased (-0.854048 --> -0.872968).  Saving model ...
Epoch: 10 cost time: 3.4337522983551025
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.872968 --> -0.902699).  Saving model ...
Epoch: 11 cost time: 3.3288824558258057
Epoch: 11, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
Validation loss decreased (-0.902699 --> -0.910808).  Saving model ...
Epoch: 12 cost time: 3.51485013961792
Epoch: 12, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.280 Vali Acc: 0.914 Test Loss: 0.280 Test Acc: 0.914
Validation loss decreased (-0.910808 --> -0.913511).  Saving model ...
Epoch: 13 cost time: 3.3581631183624268
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
Validation loss decreased (-0.913511 --> -0.932430).  Saving model ...
Epoch: 14 cost time: 3.2553975582122803
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 15 cost time: 3.3026788234710693
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 16 cost time: 3.4697818756103516
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 17 cost time: 3.4634199142456055
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 3.2118678092956543
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.161872386932373
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 20 cost time: 3.3262174129486084
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 3.2417027950286865
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 3.4290311336517334
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.950563907623291
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2077128887176514
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 3.442134380340576
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5744121074676514
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 3.1285085678100586
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4273462295532227
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.591195821762085
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5347139835357666
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 3.7823948860168457
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.383483409881592
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 3.187558174133301
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 3.1939895153045654
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2275519371032715
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2206125259399414
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 3.2324225902557373
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 3.372816562652588
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.5919713973999023
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.3433997631073
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.4774138927459717
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4969747066497803
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.5621862411499023
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.791428327560425
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.302738666534424
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.319979429244995
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.1421289443969727
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.266291856765747
Epoch: 1, Steps: 17 | Train Loss: 2.241 Vali Loss: 2.174 Vali Acc: 0.162 Test Loss: 2.174 Test Acc: 0.162
Validation loss decreased (inf --> -0.162140).  Saving model ...
Epoch: 2 cost time: 3.236900806427002
Epoch: 2, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.002 Vali Acc: 0.338 Test Loss: 2.002 Test Acc: 0.338
Validation loss decreased (-0.162140 --> -0.337818).  Saving model ...
Epoch: 3 cost time: 2.992403745651245
Epoch: 3, Steps: 17 | Train Loss: 1.968 Vali Loss: 1.774 Vali Acc: 0.541 Test Loss: 1.774 Test Acc: 0.541
Validation loss decreased (-0.337818 --> -0.540523).  Saving model ...
Epoch: 4 cost time: 3.554011583328247
Epoch: 4, Steps: 17 | Train Loss: 1.795 Vali Loss: 1.483 Vali Acc: 0.708 Test Loss: 1.483 Test Acc: 0.708
Validation loss decreased (-0.540523 --> -0.708093).  Saving model ...
Epoch: 5 cost time: 3.211496591567993
Epoch: 5, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.185 Vali Acc: 0.784 Test Loss: 1.185 Test Acc: 0.784
Validation loss decreased (-0.708093 --> -0.783772).  Saving model ...
Epoch: 6 cost time: 3.3341562747955322
Epoch: 6, Steps: 17 | Train Loss: 1.210 Vali Loss: 0.954 Vali Acc: 0.789 Test Loss: 0.954 Test Acc: 0.789
Validation loss decreased (-0.783772 --> -0.789180).  Saving model ...
Epoch: 7 cost time: 3.28102707862854
Epoch: 7, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.730 Vali Acc: 0.805 Test Loss: 0.730 Test Acc: 0.805
Validation loss decreased (-0.789180 --> -0.805398).  Saving model ...
Epoch: 8 cost time: 3.3026771545410156
Epoch: 8, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.535 Vali Acc: 0.849 Test Loss: 0.535 Test Acc: 0.849
Validation loss decreased (-0.805398 --> -0.848643).  Saving model ...
Epoch: 9 cost time: 3.260283946990967
Epoch: 9, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.390 Vali Acc: 0.881 Test Loss: 0.390 Test Acc: 0.881
Validation loss decreased (-0.848643 --> -0.881077).  Saving model ...
Epoch: 10 cost time: 3.2397727966308594
Epoch: 10, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
Validation loss decreased (-0.881077 --> -0.916213).  Saving model ...
Epoch: 11 cost time: 3.295419692993164
Epoch: 11, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.916213 --> -0.935133).  Saving model ...
Epoch: 12 cost time: 3.121387481689453
Epoch: 12, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.217 Vali Acc: 0.924 Test Loss: 0.217 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.304851770401001
Epoch: 13, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1956934928894043
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 3.4463963508605957
Epoch: 15, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.364966869354248
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2812488079071045
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.417389392852783
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.943 Test Loss: 0.141 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.407975912094116
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 3.2506048679351807
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 3.5077638626098633
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.597031831741333
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5138614177703857
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6240408420562744
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3942062854766846
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 3.5431063175201416
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.951 Test Loss: 0.112 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3545002937316895
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.548126697540283
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 3.4914846420288086
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.954 Test Loss: 0.107 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7761874198913574
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6547279357910156
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7820022106170654
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.954 Test Loss: 0.109 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.582671642303467
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.692471504211426
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.959 Test Loss: 0.097 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 35 cost time: 3.5737993717193604
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.957 Test Loss: 0.092 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.346703290939331
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.2065553665161133
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.196214199066162
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 3.257218360900879
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.959 Test Loss: 0.097 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.2328078746795654
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 3.3529226779937744
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.959 Test Loss: 0.099 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.2633121013641357
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.959 Test Loss: 0.097 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.3358099460601807
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.283954381942749
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.44765043258667
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.957 Test Loss: 0.102 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.4750776290893555
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 47 cost time: 3.581627130508423
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.962 Test Loss: 0.091 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.390864372253418
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 49 cost time: 3.576259136199951
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.462425470352173
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.1978535652160645
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.3075828552246094
Epoch: 52, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.3051092624664307
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 54 cost time: 3.276341676712036
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.264482021331787
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.349249839782715
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.6918091773986816
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.598500967025757
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.567505121231079
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.1816444396972656
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.4297749996185303
Epoch: 61, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.3592512607574463
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.417703151702881
Epoch: 63, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.668916940689087
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.152 Vali Acc: 0.149 Test Loss: 2.152 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 3.6474785804748535
Epoch: 2, Steps: 17 | Train Loss: 2.100 Vali Loss: 1.973 Vali Acc: 0.370 Test Loss: 1.973 Test Acc: 0.370
Validation loss decreased (-0.148627 --> -0.370251).  Saving model ...
Epoch: 3 cost time: 3.275514841079712
Epoch: 3, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.735 Vali Acc: 0.592 Test Loss: 1.735 Test Acc: 0.592
Validation loss decreased (-0.370251 --> -0.591875).  Saving model ...
Epoch: 4 cost time: 3.503784656524658
Epoch: 4, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.446 Vali Acc: 0.678 Test Loss: 1.446 Test Acc: 0.678
Validation loss decreased (-0.591875 --> -0.678364).  Saving model ...
Epoch: 5 cost time: 3.669163703918457
Epoch: 5, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.150 Vali Acc: 0.735 Test Loss: 1.150 Test Acc: 0.735
Validation loss decreased (-0.678364 --> -0.735124).  Saving model ...
Epoch: 6 cost time: 3.7805120944976807
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.919 Vali Acc: 0.749 Test Loss: 0.919 Test Acc: 0.749
Validation loss decreased (-0.735124 --> -0.748639).  Saving model ...
Epoch: 7 cost time: 3.5914838314056396
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.697 Vali Acc: 0.811 Test Loss: 0.697 Test Acc: 0.811
Validation loss decreased (-0.748639 --> -0.810804).  Saving model ...
Epoch: 8 cost time: 3.668361186981201
Epoch: 8, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.512 Vali Acc: 0.851 Test Loss: 0.512 Test Acc: 0.851
Validation loss decreased (-0.810804 --> -0.851346).  Saving model ...
Epoch: 9 cost time: 3.6270017623901367
Epoch: 9, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
Validation loss decreased (-0.851346 --> -0.870266).  Saving model ...
Epoch: 10 cost time: 3.8088841438293457
Epoch: 10, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.300 Vali Acc: 0.905 Test Loss: 0.300 Test Acc: 0.905
Validation loss decreased (-0.870266 --> -0.905402).  Saving model ...
Epoch: 11 cost time: 3.673285484313965
Epoch: 11, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
Validation loss decreased (-0.905402 --> -0.918916).  Saving model ...
Epoch: 12 cost time: 3.253249168395996
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929727).  Saving model ...
Epoch: 13 cost time: 3.230013370513916
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 14 cost time: 3.1516008377075195
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 3.418351173400879
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 3.513922929763794
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.176 Vali Acc: 0.932 Test Loss: 0.176 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.146655797958374
Epoch: 17, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 18 cost time: 3.109391212463379
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 3.337761402130127
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 3.3964765071868896
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 21 cost time: 3.206225872039795
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 3.423961639404297
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4569003582000732
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3412859439849854
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.322382926940918
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 2.9833121299743652
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2972800731658936
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.101442575454712
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2262938022613525
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2010297775268555
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0280849933624268
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.2162117958068848
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.3557748794555664
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3195016384124756
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.146211624145508
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.029279470443726
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 3.587209701538086
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 3 cost time: 3.3222084045410156
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.408259391784668
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 5 cost time: 3.353040933609009
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.136596918106079
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1484458446502686
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.384225368499756
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2654101848602295
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 10 cost time: 3.4004781246185303
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 11 cost time: 3.391127109527588
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4034998416900635
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 13 cost time: 3.2078840732574463
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1852245330810547
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4758520126342773
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1749088764190674
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2465274333953857
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.230794906616211
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2698440551757812
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 20 cost time: 3.0892250537872314
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 21 cost time: 3.1624441146850586
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 22 cost time: 3.174368143081665
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5816943645477295
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 24 cost time: 3.4720821380615234
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6937246322631836
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7392330169677734
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7830069065093994
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.638395071029663
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 29 cost time: 3.6907145977020264
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 30 cost time: 3.8379299640655518
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4191787242889404
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6990435123443604
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.2998318672180176
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.7033650875091553
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.393622398376465
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.550943613052368
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 37 cost time: 3.511004686355591
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.7713348865509033
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 39 cost time: 3.4040656089782715
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.442269802093506
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 41 cost time: 3.345004081726074
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4896109104156494
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.272956132888794
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 44 cost time: 3.4321131706237793
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3503737449645996
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.128192901611328
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.251973867416382
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.166491746902466
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.5847299098968506
Epoch: 49, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.120629072189331
Epoch: 50, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 51 cost time: 3.5442988872528076
Epoch: 51, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 52 cost time: 3.6185874938964844
Epoch: 52, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.3949856758117676
Epoch: 53, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 54 cost time: 3.374131679534912
Epoch: 54, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 55 cost time: 3.3550617694854736
Epoch: 55, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.070265293121338
Epoch: 56, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.513051748275757
Epoch: 57, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.39369535446167
Epoch: 58, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.1585967540740967
Epoch: 59, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.7699103355407715
Epoch: 60, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.61838698387146
Epoch: 61, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.570326805114746
Epoch: 62, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.458827257156372
Epoch: 63, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.2325515747070312
Epoch: 64, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.11891891891891893
model parameter : 814345
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.829446792602539
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.092 Vali Acc: 0.235 Test Loss: 2.092 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 3.3712310791015625
Epoch: 2, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.838 Vali Acc: 0.530 Test Loss: 1.838 Test Acc: 0.530
Validation loss decreased (-0.235114 --> -0.529711).  Saving model ...
Epoch: 3 cost time: 3.135993719100952
Epoch: 3, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.571 Vali Acc: 0.646 Test Loss: 1.571 Test Acc: 0.646
Validation loss decreased (-0.529711 --> -0.645930).  Saving model ...
Epoch: 4 cost time: 3.518115758895874
Epoch: 4, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.304 Vali Acc: 0.695 Test Loss: 1.304 Test Acc: 0.695
Validation loss decreased (-0.645930 --> -0.694582).  Saving model ...
Epoch: 5 cost time: 3.2313854694366455
Epoch: 5, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.050 Vali Acc: 0.749 Test Loss: 1.050 Test Acc: 0.749
Validation loss decreased (-0.694582 --> -0.748638).  Saving model ...
Epoch: 6 cost time: 3.544797897338867
Epoch: 6, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.821 Vali Acc: 0.792 Test Loss: 0.821 Test Acc: 0.792
Validation loss decreased (-0.748638 --> -0.791884).  Saving model ...
Epoch: 7 cost time: 3.361055850982666
Epoch: 7, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.624 Vali Acc: 0.857 Test Loss: 0.624 Test Acc: 0.857
Validation loss decreased (-0.791884 --> -0.856751).  Saving model ...
Epoch: 8 cost time: 3.38896107673645
Epoch: 8, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.484 Vali Acc: 0.873 Test Loss: 0.484 Test Acc: 0.873
Validation loss decreased (-0.856751 --> -0.872968).  Saving model ...
Epoch: 9 cost time: 4.0205395221710205
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.391 Vali Acc: 0.886 Test Loss: 0.391 Test Acc: 0.886
Validation loss decreased (-0.872968 --> -0.886483).  Saving model ...
Epoch: 10 cost time: 3.740551471710205
Epoch: 10, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.324 Vali Acc: 0.914 Test Loss: 0.324 Test Acc: 0.914
Validation loss decreased (-0.886483 --> -0.913510).  Saving model ...
Epoch: 11 cost time: 4.143176555633545
Epoch: 11, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.272 Vali Acc: 0.924 Test Loss: 0.272 Test Acc: 0.924
Validation loss decreased (-0.913510 --> -0.924322).  Saving model ...
Epoch: 12 cost time: 3.5740177631378174
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 13 cost time: 3.518886089324951
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 14 cost time: 3.483088970184326
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 15 cost time: 3.2240686416625977
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 3.4214932918548584
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 3.402101755142212
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.194552421569824
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 3.2014870643615723
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 3.1832897663116455
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5937461853027344
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 3.329446315765381
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 23 cost time: 3.5669665336608887
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3814289569854736
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 3.396932363510132
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4164955615997314
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.320591688156128
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 3.1811392307281494
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.314824342727661
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 3.1930947303771973
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.270646810531616
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.208146333694458
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3269999027252197
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.1711411476135254
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.062363386154175
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.286508798599243
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.2133631706237793
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.2963180541992188
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.282500982284546
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.9041008949279785
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.131 Vali Acc: 0.189 Test Loss: 2.131 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 3.1754024028778076
Epoch: 2, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.928 Vali Acc: 0.468 Test Loss: 1.928 Test Acc: 0.468
Validation loss decreased (-0.189168 --> -0.467548).  Saving model ...
Epoch: 3 cost time: 3.4021105766296387
Epoch: 3, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.691 Vali Acc: 0.630 Test Loss: 1.691 Test Acc: 0.630
Validation loss decreased (-0.467548 --> -0.629713).  Saving model ...
Epoch: 4 cost time: 3.2858338356018066
Epoch: 4, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.430 Vali Acc: 0.676 Test Loss: 1.430 Test Acc: 0.676
Validation loss decreased (-0.629713 --> -0.675661).  Saving model ...
Epoch: 5 cost time: 3.413301706314087
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.157 Vali Acc: 0.741 Test Loss: 1.157 Test Acc: 0.741
Validation loss decreased (-0.675661 --> -0.740529).  Saving model ...
Epoch: 6 cost time: 3.112950325012207
Epoch: 6, Steps: 17 | Train Loss: 0.962 Vali Loss: 0.902 Vali Acc: 0.789 Test Loss: 0.902 Test Acc: 0.789
Validation loss decreased (-0.740529 --> -0.789180).  Saving model ...
Epoch: 7 cost time: 3.2364883422851562
Epoch: 7, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.683 Vali Acc: 0.841 Test Loss: 0.683 Test Acc: 0.841
Validation loss decreased (-0.789180 --> -0.840534).  Saving model ...
Epoch: 8 cost time: 3.163257598876953
Epoch: 8, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
Validation loss decreased (-0.840534 --> -0.859454).  Saving model ...
Epoch: 9 cost time: 3.0877811908721924
Epoch: 9, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.435 Vali Acc: 0.878 Test Loss: 0.435 Test Acc: 0.878
Validation loss decreased (-0.859454 --> -0.878374).  Saving model ...
Epoch: 10 cost time: 3.249758720397949
Epoch: 10, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
Validation loss decreased (-0.878374 --> -0.889186).  Saving model ...
Epoch: 11 cost time: 3.202895402908325
Epoch: 11, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.307 Vali Acc: 0.916 Test Loss: 0.307 Test Acc: 0.916
Validation loss decreased (-0.889186 --> -0.916213).  Saving model ...
Epoch: 12 cost time: 3.193242311477661
Epoch: 12, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 13 cost time: 3.1573374271392822
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.253 Vali Acc: 0.932 Test Loss: 0.253 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 14 cost time: 3.536172389984131
Epoch: 14, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 15 cost time: 3.463937759399414
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 16 cost time: 3.232229471206665
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 3.0791738033294678
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 18 cost time: 3.195155143737793
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 19 cost time: 3.1299571990966797
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 20 cost time: 3.2959351539611816
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 3.292109727859497
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 3.3651235103607178
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 23 cost time: 3.211613416671753
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 24 cost time: 3.4161293506622314
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 2.9664087295532227
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2451109886169434
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2534852027893066
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2981348037719727
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 3.3776192665100098
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.242382764816284
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.5757243633270264
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3297245502471924
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.453120708465576
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 3.079423666000366
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 3.3194971084594727
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 3.25839900970459
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 37 cost time: 3.2502429485321045
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.1786274909973145
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 3.143862009048462
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.2158710956573486
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.1173298358917236
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 42 cost time: 3.3141698837280273
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1293060779571533
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1881284713745117
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.197861671447754
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.9655978679656982
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.7926816940307617
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.0977985858917236
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.221376657485962
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.0148518085479736
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.052314519882202
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.492905855178833
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.153 Vali Acc: 0.168 Test Loss: 2.153 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 3.1211771965026855
Epoch: 2, Steps: 17 | Train Loss: 2.056 Vali Loss: 2.000 Vali Acc: 0.359 Test Loss: 2.000 Test Acc: 0.359
Validation loss decreased (-0.167546 --> -0.359439).  Saving model ...
Epoch: 3 cost time: 3.016148805618286
Epoch: 3, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.811 Vali Acc: 0.549 Test Loss: 1.811 Test Acc: 0.549
Validation loss decreased (-0.359439 --> -0.548631).  Saving model ...
Epoch: 4 cost time: 3.1955127716064453
Epoch: 4, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.580 Vali Acc: 0.627 Test Loss: 1.580 Test Acc: 0.627
Validation loss decreased (-0.548631 --> -0.627011).  Saving model ...
Epoch: 5 cost time: 3.397777557373047
Epoch: 5, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.310 Vali Acc: 0.692 Test Loss: 1.310 Test Acc: 0.692
Validation loss decreased (-0.627011 --> -0.691879).  Saving model ...
Epoch: 6 cost time: 3.3481802940368652
Epoch: 6, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.027 Vali Acc: 0.765 Test Loss: 1.027 Test Acc: 0.765
Validation loss decreased (-0.691879 --> -0.764855).  Saving model ...
Epoch: 7 cost time: 3.3381571769714355
Epoch: 7, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.774 Vali Acc: 0.819 Test Loss: 0.774 Test Acc: 0.819
Validation loss decreased (-0.764855 --> -0.818911).  Saving model ...
Epoch: 8 cost time: 3.247349262237549
Epoch: 8, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.818911 --> -0.840535).  Saving model ...
Epoch: 9 cost time: 3.144972801208496
Epoch: 9, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.487 Vali Acc: 0.868 Test Loss: 0.487 Test Acc: 0.868
Validation loss decreased (-0.840535 --> -0.867563).  Saving model ...
Epoch: 10 cost time: 3.2523019313812256
Epoch: 10, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.867563 --> -0.889185).  Saving model ...
Epoch: 11 cost time: 3.254866361618042
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.344 Vali Acc: 0.897 Test Loss: 0.344 Test Acc: 0.897
Validation loss decreased (-0.889185 --> -0.897294).  Saving model ...
Epoch: 12 cost time: 3.092357873916626
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.309 Vali Acc: 0.908 Test Loss: 0.309 Test Acc: 0.908
Validation loss decreased (-0.897294 --> -0.908105).  Saving model ...
Epoch: 13 cost time: 3.28200101852417
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.279 Vali Acc: 0.924 Test Loss: 0.279 Test Acc: 0.924
Validation loss decreased (-0.908105 --> -0.924322).  Saving model ...
Epoch: 14 cost time: 3.300844192504883
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.924322 --> -0.935133).  Saving model ...
Epoch: 15 cost time: 3.260559320449829
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 16 cost time: 3.2191267013549805
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 17 cost time: 3.0505175590515137
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.632370710372925
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 19 cost time: 3.6984074115753174
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 3.6047189235687256
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 3.5047762393951416
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 3.0646588802337646
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 3.531769275665283
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.268747329711914
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2980258464813232
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 3.246000289916992
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3714194297790527
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.524561882019043
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.5105412006378174
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5054197311401367
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 3.4536478519439697
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3695483207702637
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.3056352138519287
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3160037994384766
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2510900497436523
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.038121223449707
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.2961390018463135
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.955021619796753
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.5125184059143066
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.324554920196533
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.568930387496948
Epoch: 1, Steps: 17 | Train Loss: 2.177 Vali Loss: 2.172 Vali Acc: 0.138 Test Loss: 2.172 Test Acc: 0.138
Validation loss decreased (inf --> -0.137816).  Saving model ...
Epoch: 2 cost time: 2.9587574005126953
Epoch: 2, Steps: 17 | Train Loss: 2.081 Vali Loss: 2.031 Vali Acc: 0.319 Test Loss: 2.031 Test Acc: 0.319
Validation loss decreased (-0.137816 --> -0.318899).  Saving model ...
Epoch: 3 cost time: 3.0098180770874023
Epoch: 3, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.850 Vali Acc: 0.495 Test Loss: 1.850 Test Acc: 0.495
Validation loss decreased (-0.318899 --> -0.494576).  Saving model ...
Epoch: 4 cost time: 2.925366163253784
Epoch: 4, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.608 Vali Acc: 0.603 Test Loss: 1.608 Test Acc: 0.603
Validation loss decreased (-0.494576 --> -0.602687).  Saving model ...
Epoch: 5 cost time: 2.701117992401123
Epoch: 5, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.319 Vali Acc: 0.684 Test Loss: 1.319 Test Acc: 0.684
Validation loss decreased (-0.602687 --> -0.683771).  Saving model ...
Epoch: 6 cost time: 2.8819613456726074
Epoch: 6, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.034 Vali Acc: 0.743 Test Loss: 1.034 Test Acc: 0.743
Validation loss decreased (-0.683771 --> -0.743233).  Saving model ...
Epoch: 7 cost time: 3.0164334774017334
Epoch: 7, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.799 Vali Acc: 0.795 Test Loss: 0.799 Test Acc: 0.795
Validation loss decreased (-0.743233 --> -0.794587).  Saving model ...
Epoch: 8 cost time: 2.789785146713257
Epoch: 8, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.615 Vali Acc: 0.832 Test Loss: 0.615 Test Acc: 0.832
Validation loss decreased (-0.794587 --> -0.832426).  Saving model ...
Epoch: 9 cost time: 2.709228277206421
Epoch: 9, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.832426 --> -0.859455).  Saving model ...
Epoch: 10 cost time: 2.8016273975372314
Epoch: 10, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.859455 --> -0.883780).  Saving model ...
Epoch: 11 cost time: 2.796175718307495
Epoch: 11, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.345 Vali Acc: 0.897 Test Loss: 0.345 Test Acc: 0.897
Validation loss decreased (-0.883780 --> -0.897294).  Saving model ...
Epoch: 12 cost time: 3.028458595275879
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.302 Vali Acc: 0.916 Test Loss: 0.302 Test Acc: 0.916
Validation loss decreased (-0.897294 --> -0.916213).  Saving model ...
Epoch: 13 cost time: 2.8609557151794434
Epoch: 13, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.259 Vali Acc: 0.927 Test Loss: 0.259 Test Acc: 0.927
Validation loss decreased (-0.916213 --> -0.927024).  Saving model ...
Epoch: 14 cost time: 2.9866981506347656
Epoch: 14, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
Validation loss decreased (-0.927024 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 3.013725519180298
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 3.1691980361938477
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 17 cost time: 3.021865129470825
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 2.886244773864746
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8634612560272217
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8787178993225098
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.775526762008667
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.818495750427246
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.824101209640503
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.806136131286621
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8776838779449463
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8285512924194336
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.0261526107788086
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 28 cost time: 3.2374372482299805
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4371631145477295
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.3162996768951416
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 3.338355541229248
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5734610557556152
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5858612060546875
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.29681134223938
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.1597683429718018
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.2421796321868896
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.1586031913757324
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.2209279537200928
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.4659321308135986
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.5051045417785645
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.235702276229858
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.163 Vali Acc: 0.154 Test Loss: 2.163 Test Acc: 0.154
Validation loss decreased (inf --> -0.154032).  Saving model ...
Epoch: 2 cost time: 3.416560173034668
Epoch: 2, Steps: 17 | Train Loss: 2.097 Vali Loss: 2.005 Vali Acc: 0.324 Test Loss: 2.005 Test Acc: 0.324
Validation loss decreased (-0.154032 --> -0.324304).  Saving model ...
Epoch: 3 cost time: 3.140136241912842
Epoch: 3, Steps: 17 | Train Loss: 2.004 Vali Loss: 1.785 Vali Acc: 0.532 Test Loss: 1.785 Test Acc: 0.532
Validation loss decreased (-0.324304 --> -0.532415).  Saving model ...
Epoch: 4 cost time: 3.226351261138916
Epoch: 4, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.508 Vali Acc: 0.632 Test Loss: 1.508 Test Acc: 0.632
Validation loss decreased (-0.532415 --> -0.632417).  Saving model ...
Epoch: 5 cost time: 3.1398072242736816
Epoch: 5, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.249 Vali Acc: 0.668 Test Loss: 1.249 Test Acc: 0.668
Validation loss decreased (-0.632417 --> -0.667555).  Saving model ...
Epoch: 6 cost time: 3.103994131088257
Epoch: 6, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.667555 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 3.209073543548584
Epoch: 7, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.786 Vali Acc: 0.770 Test Loss: 0.786 Test Acc: 0.770
Validation loss decreased (-0.699990 --> -0.770262).  Saving model ...
Epoch: 8 cost time: 3.0737264156341553
Epoch: 8, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.591 Vali Acc: 0.811 Test Loss: 0.591 Test Acc: 0.811
Validation loss decreased (-0.770262 --> -0.810805).  Saving model ...
Epoch: 9 cost time: 3.3116235733032227
Epoch: 9, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.481 Vali Acc: 0.843 Test Loss: 0.481 Test Acc: 0.843
Validation loss decreased (-0.810805 --> -0.843238).  Saving model ...
Epoch: 10 cost time: 3.3251988887786865
Epoch: 10, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (-0.843238 --> -0.883780).  Saving model ...
Epoch: 11 cost time: 3.2390553951263428
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.883780 --> -0.889186).  Saving model ...
Epoch: 12 cost time: 3.2819197177886963
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.311 Vali Acc: 0.897 Test Loss: 0.311 Test Acc: 0.897
Validation loss decreased (-0.889186 --> -0.897294).  Saving model ...
Epoch: 13 cost time: 3.149536371231079
Epoch: 13, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.897294 --> -0.910808).  Saving model ...
Epoch: 14 cost time: 3.218776226043701
Epoch: 14, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.242 Vali Acc: 0.916 Test Loss: 0.242 Test Acc: 0.916
Validation loss decreased (-0.910808 --> -0.916214).  Saving model ...
Epoch: 15 cost time: 3.3225269317626953
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916214 --> -0.921620).  Saving model ...
Epoch: 16 cost time: 3.316169023513794
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
Validation loss decreased (-0.921620 --> -0.927025).  Saving model ...
Epoch: 17 cost time: 2.760122776031494
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.183 Vali Acc: 0.932 Test Loss: 0.183 Test Acc: 0.932
Validation loss decreased (-0.927025 --> -0.932431).  Saving model ...
Epoch: 18 cost time: 2.802917003631592
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.184 Vali Acc: 0.932 Test Loss: 0.184 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.742161512374878
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
Validation loss decreased (-0.932431 --> -0.935133).  Saving model ...
Epoch: 20 cost time: 2.809986114501953
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 21 cost time: 2.8516032695770264
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0720739364624023
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.935 Test Loss: 0.159 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.977083921432495
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.941 Test Loss: 0.147 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 24 cost time: 3.0132369995117188
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.938 Test Loss: 0.146 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.122514486312866
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0759012699127197
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.935 Test Loss: 0.166 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.103536367416382
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.941 Test Loss: 0.148 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9531874656677246
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.938 Test Loss: 0.142 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7515389919281006
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 30 cost time: 2.7806906700134277
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 31 cost time: 2.871471405029297
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9212117195129395
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.9249863624572754
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.943 Test Loss: 0.143 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.6622321605682373
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.7811648845672607
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.0097644329071045
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 37 cost time: 3.0534844398498535
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 38 cost time: 3.035917282104492
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.381070137023926
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.946 Test Loss: 0.132 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.1310062408447266
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.207641839981079
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.10455060005188
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.943 Test Loss: 0.130 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.0074515342712402
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.946 Test Loss: 0.125 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.021888494491577
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.946 Test Loss: 0.128 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.9379239082336426
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.851712942123413
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.891092538833618
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8888421058654785
Epoch: 1, Steps: 17 | Train Loss: 2.167 Vali Loss: 2.152 Vali Acc: 0.154 Test Loss: 2.152 Test Acc: 0.154
Validation loss decreased (inf --> -0.154033).  Saving model ...
Epoch: 2 cost time: 3.1272568702697754
Epoch: 2, Steps: 17 | Train Loss: 2.094 Vali Loss: 1.986 Vali Acc: 0.330 Test Loss: 1.986 Test Acc: 0.330
Validation loss decreased (-0.154033 --> -0.329710).  Saving model ...
Epoch: 3 cost time: 3.3557865619659424
Epoch: 3, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.762 Vali Acc: 0.551 Test Loss: 1.762 Test Acc: 0.551
Validation loss decreased (-0.329710 --> -0.551334).  Saving model ...
Epoch: 4 cost time: 3.2128591537475586
Epoch: 4, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.470 Vali Acc: 0.689 Test Loss: 1.470 Test Acc: 0.689
Validation loss decreased (-0.551334 --> -0.689174).  Saving model ...
Epoch: 5 cost time: 3.1240334510803223
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.188 Vali Acc: 0.724 Test Loss: 1.188 Test Acc: 0.724
Validation loss decreased (-0.689174 --> -0.724312).  Saving model ...
Epoch: 6 cost time: 3.170650005340576
Epoch: 6, Steps: 17 | Train Loss: 1.179 Vali Loss: 0.943 Vali Acc: 0.757 Test Loss: 0.943 Test Acc: 0.757
Validation loss decreased (-0.724312 --> -0.756747).  Saving model ...
Epoch: 7 cost time: 2.9843673706054688
Epoch: 7, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.720 Vali Acc: 0.795 Test Loss: 0.720 Test Acc: 0.795
Validation loss decreased (-0.756747 --> -0.794587).  Saving model ...
Epoch: 8 cost time: 3.0285260677337646
Epoch: 8, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.794587 --> -0.840535).  Saving model ...
Epoch: 9 cost time: 3.087918758392334
Epoch: 9, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.418 Vali Acc: 0.873 Test Loss: 0.418 Test Acc: 0.873
Validation loss decreased (-0.840535 --> -0.872969).  Saving model ...
Epoch: 10 cost time: 3.038181781768799
Epoch: 10, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.352 Vali Acc: 0.897 Test Loss: 0.352 Test Acc: 0.897
Validation loss decreased (-0.872969 --> -0.897294).  Saving model ...
Epoch: 11 cost time: 3.2346839904785156
Epoch: 11, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.289 Vali Acc: 0.905 Test Loss: 0.289 Test Acc: 0.905
Validation loss decreased (-0.897294 --> -0.905403).  Saving model ...
Epoch: 12 cost time: 3.2363290786743164
Epoch: 12, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.271 Vali Acc: 0.916 Test Loss: 0.271 Test Acc: 0.916
Validation loss decreased (-0.905403 --> -0.916214).  Saving model ...
Epoch: 13 cost time: 3.237431287765503
Epoch: 13, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.238 Vali Acc: 0.914 Test Loss: 0.238 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4057960510253906
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.215 Vali Acc: 0.924 Test Loss: 0.215 Test Acc: 0.924
Validation loss decreased (-0.916214 --> -0.924322).  Saving model ...
Epoch: 15 cost time: 3.065059185028076
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
Validation loss decreased (-0.924322 --> -0.935133).  Saving model ...
Epoch: 16 cost time: 3.2750039100646973
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.184 Vali Acc: 0.932 Test Loss: 0.184 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.211146354675293
Epoch: 17, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 3.3272886276245117
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.071383237838745
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.935 Test Loss: 0.154 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.235980749130249
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945945).  Saving model ...
Epoch: 21 cost time: 3.1985769271850586
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
Validation loss decreased (-0.945945 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 3.339322805404663
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.943 Test Loss: 0.137 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3111205101013184
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.946 Test Loss: 0.129 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.227276563644409
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 25 cost time: 3.321819543838501
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3070828914642334
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.943 Test Loss: 0.131 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3413281440734863
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6287245750427246
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.949 Test Loss: 0.117 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.7195322513580322
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 3.3882412910461426
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.345722198486328
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.1910204887390137
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.132523775100708
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.216888189315796
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 3.0806760787963867
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 3.2223525047302246
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.959 Test Loss: 0.098 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2217633724212646
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 38 cost time: 2.8473305702209473
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0870180130004883
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.0901942253112793
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.2412354946136475
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.349106788635254
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.985992431640625
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.351411819458008
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.3321242332458496
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.5194506645202637
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.4122254848480225
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.726405143737793
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.065 Test Loss: 2.199 Test Acc: 0.065
Validation loss decreased (inf --> -0.064843).  Saving model ...
Epoch: 2 cost time: 3.4484410285949707
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.065 Test Loss: 2.199 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 3 cost time: 3.5226809978485107
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.065 Test Loss: 2.199 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 4 cost time: 3.0375735759735107
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 5 cost time: 3.0847856998443604
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 6 cost time: 3.123296022415161
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 7 cost time: 3.1797356605529785
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.199688673019409
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3199284076690674
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4186651706695557
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 11 cost time: 3.4093339443206787
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 12 cost time: 3.398974657058716
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 13 cost time: 3.4620566368103027
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5024940967559814
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 15 cost time: 3.248288631439209
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0806992053985596
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3937580585479736
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 18 cost time: 3.024845600128174
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 19 cost time: 3.3303422927856445
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2319014072418213
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.026047706604004
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 22 cost time: 3.1977295875549316
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1497888565063477
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1096787452697754
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2676749229431152
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.4598026275634766
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4667482376098633
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 28 cost time: 3.362504005432129
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
Validation loss decreased (-0.064843 --> -0.064843).  Saving model ...
Epoch: 29 cost time: 3.1850805282592773
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3166921138763428
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.1703667640686035
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
Validation loss decreased (-0.064843 --> -0.094573).  Saving model ...
Epoch: 32 cost time: 3.1169116497039795
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2514095306396484
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.549687385559082
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.3541488647460938
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.3753299713134766
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.3119680881500244
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2992329597473145
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 39 cost time: 3.1241469383239746
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.4591009616851807
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.0826895236968994
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.302988290786743
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.2640082836151123
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.2548389434814453
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.2332260608673096
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.1667256355285645
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.2085025310516357
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.2137928009033203
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.065 Test Loss: 2.198 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.0945945945945946
model parameter : 617737
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.2901153564453125
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.129 Vali Acc: 0.189 Test Loss: 2.129 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 3.2348732948303223
Epoch: 2, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.871 Vali Acc: 0.527 Test Loss: 1.871 Test Acc: 0.527
Validation loss decreased (-0.189168 --> -0.527008).  Saving model ...
Epoch: 3 cost time: 3.030242919921875
Epoch: 3, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.587 Vali Acc: 0.676 Test Loss: 1.587 Test Acc: 0.676
Validation loss decreased (-0.527008 --> -0.675660).  Saving model ...
Epoch: 4 cost time: 2.9852850437164307
Epoch: 4, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.337 Vali Acc: 0.719 Test Loss: 1.337 Test Acc: 0.719
Validation loss decreased (-0.675660 --> -0.718906).  Saving model ...
Epoch: 5 cost time: 2.9605329036712646
Epoch: 5, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.092 Vali Acc: 0.759 Test Loss: 1.092 Test Acc: 0.759
Validation loss decreased (-0.718906 --> -0.759449).  Saving model ...
Epoch: 6 cost time: 3.0832014083862305
Epoch: 6, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.861 Vali Acc: 0.803 Test Loss: 0.861 Test Acc: 0.803
Validation loss decreased (-0.759449 --> -0.802694).  Saving model ...
Epoch: 7 cost time: 3.0074594020843506
Epoch: 7, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.659 Vali Acc: 0.846 Test Loss: 0.659 Test Acc: 0.846
Validation loss decreased (-0.802694 --> -0.845939).  Saving model ...
Epoch: 8 cost time: 3.0380642414093018
Epoch: 8, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.500 Vali Acc: 0.884 Test Loss: 0.500 Test Acc: 0.884
Validation loss decreased (-0.845939 --> -0.883779).  Saving model ...
Epoch: 9 cost time: 3.092106819152832
Epoch: 9, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.883779 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 3.6459853649139404
Epoch: 10, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.334 Vali Acc: 0.919 Test Loss: 0.334 Test Acc: 0.919
Validation loss decreased (-0.899996 --> -0.918916).  Saving model ...
Epoch: 11 cost time: 3.384337902069092
Epoch: 11, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.273 Vali Acc: 0.927 Test Loss: 0.273 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927024).  Saving model ...
Epoch: 12 cost time: 3.422396659851074
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.241 Vali Acc: 0.938 Test Loss: 0.241 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 3.5815560817718506
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 14 cost time: 3.2007319927215576
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 3.6575264930725098
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.605776309967041
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2857275009155273
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 3.3632378578186035
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 3.1664841175079346
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 20 cost time: 3.0706660747528076
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 3.0888428688049316
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 3.4844536781311035
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 3.277352809906006
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2239158153533936
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.297457218170166
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4461405277252197
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.600682497024536
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.2632687091827393
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.0584969520568848
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 3.0872981548309326
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3934831619262695
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 32 cost time: 3.2830970287323
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.952524423599243
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.0571656227111816
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0908730030059814
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 36 cost time: 3.345738649368286
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.522428035736084
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4409563541412354
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 39 cost time: 3.1318905353546143
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 40 cost time: 3.371164560317993
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.264371871948242
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 42 cost time: 2.891899824142456
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.4409966468811035
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.2715260982513428
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.470890998840332
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.5521206855773926
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.2797415256500244
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 48 cost time: 3.3337998390197754
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.3156521320343018
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.421114206314087
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.696654796600342
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 4.177185773849487
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 53 cost time: 3.256272792816162
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.286367654800415
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.0362296104431152
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.2405457496643066
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 57 cost time: 3.3589086532592773
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.062134027481079
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.228576898574829
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.297457695007324
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.1989874839782715
Epoch: 61, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.395846366882324
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.2018415927886963
Epoch: 63, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.7025156021118164
Epoch: 64, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.1321144104003906
Epoch: 65, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.281646966934204
Epoch: 66, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.418691158294678
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 2.164 Vali Acc: 0.132 Test Loss: 2.164 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 2.975027561187744
Epoch: 2, Steps: 17 | Train Loss: 2.058 Vali Loss: 1.957 Vali Acc: 0.416 Test Loss: 1.957 Test Acc: 0.416
Validation loss decreased (-0.132411 --> -0.416197).  Saving model ...
Epoch: 3 cost time: 2.9592583179473877
Epoch: 3, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.707 Vali Acc: 0.641 Test Loss: 1.707 Test Acc: 0.641
Validation loss decreased (-0.416197 --> -0.640523).  Saving model ...
Epoch: 4 cost time: 3.110018730163574
Epoch: 4, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.457 Vali Acc: 0.678 Test Loss: 1.457 Test Acc: 0.678
Validation loss decreased (-0.640523 --> -0.678364).  Saving model ...
Epoch: 5 cost time: 2.9100475311279297
Epoch: 5, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.186 Vali Acc: 0.735 Test Loss: 1.186 Test Acc: 0.735
Validation loss decreased (-0.678364 --> -0.735123).  Saving model ...
Epoch: 6 cost time: 3.3688502311706543
Epoch: 6, Steps: 17 | Train Loss: 0.979 Vali Loss: 0.923 Vali Acc: 0.803 Test Loss: 0.923 Test Acc: 0.803
Validation loss decreased (-0.735123 --> -0.802693).  Saving model ...
Epoch: 7 cost time: 3.521495819091797
Epoch: 7, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.703 Vali Acc: 0.808 Test Loss: 0.703 Test Acc: 0.808
Validation loss decreased (-0.802693 --> -0.808101).  Saving model ...
Epoch: 8 cost time: 3.1968655586242676
Epoch: 8, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.537 Vali Acc: 0.868 Test Loss: 0.537 Test Acc: 0.868
Validation loss decreased (-0.808101 --> -0.867562).  Saving model ...
Epoch: 9 cost time: 3.1127171516418457
Epoch: 9, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.436 Vali Acc: 0.886 Test Loss: 0.436 Test Acc: 0.886
Validation loss decreased (-0.867562 --> -0.886482).  Saving model ...
Epoch: 10 cost time: 3.2158288955688477
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.362 Vali Acc: 0.905 Test Loss: 0.362 Test Acc: 0.905
Validation loss decreased (-0.886482 --> -0.905402).  Saving model ...
Epoch: 11 cost time: 3.0923573970794678
Epoch: 11, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.905402 --> -0.918916).  Saving model ...
Epoch: 12 cost time: 3.0320422649383545
Epoch: 12, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 13 cost time: 3.1085283756256104
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
Validation loss decreased (-0.921619 --> -0.935133).  Saving model ...
Epoch: 14 cost time: 3.0618371963500977
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 3.0717902183532715
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2922475337982178
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 17 cost time: 3.2072243690490723
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.369386672973633
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 3.337275505065918
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 3.1575334072113037
Epoch: 20, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 21 cost time: 3.3020949363708496
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.620957374572754
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 23 cost time: 3.3448877334594727
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0136914253234863
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 3.1186716556549072
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 2.9712071418762207
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0979878902435303
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.929485559463501
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.0432634353637695
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0667195320129395
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2632813453674316
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.154280662536621
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.012725830078125
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.998924493789673
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.879060983657837
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.187460899353027
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.184 Vali Acc: 0.108 Test Loss: 2.184 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 2.7724645137786865
Epoch: 2, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.028 Vali Acc: 0.300 Test Loss: 2.028 Test Acc: 0.300
Validation loss decreased (-0.108086 --> -0.299980).  Saving model ...
Epoch: 3 cost time: 2.864119291305542
Epoch: 3, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.828 Vali Acc: 0.541 Test Loss: 1.828 Test Acc: 0.541
Validation loss decreased (-0.299980 --> -0.540522).  Saving model ...
Epoch: 4 cost time: 3.000276565551758
Epoch: 4, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.611 Vali Acc: 0.616 Test Loss: 1.611 Test Acc: 0.616
Validation loss decreased (-0.540522 --> -0.616200).  Saving model ...
Epoch: 5 cost time: 3.311289072036743
Epoch: 5, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.350 Vali Acc: 0.686 Test Loss: 1.350 Test Acc: 0.686
Validation loss decreased (-0.616200 --> -0.686473).  Saving model ...
Epoch: 6 cost time: 3.2305774688720703
Epoch: 6, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.071 Vali Acc: 0.727 Test Loss: 1.071 Test Acc: 0.727
Validation loss decreased (-0.686473 --> -0.727016).  Saving model ...
Epoch: 7 cost time: 3.1160993576049805
Epoch: 7, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.817 Vali Acc: 0.803 Test Loss: 0.817 Test Acc: 0.803
Validation loss decreased (-0.727016 --> -0.802695).  Saving model ...
Epoch: 8 cost time: 3.107304096221924
Epoch: 8, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.605 Vali Acc: 0.849 Test Loss: 0.605 Test Acc: 0.849
Validation loss decreased (-0.802695 --> -0.848643).  Saving model ...
Epoch: 9 cost time: 3.1148595809936523
Epoch: 9, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.506 Vali Acc: 0.859 Test Loss: 0.506 Test Acc: 0.859
Validation loss decreased (-0.848643 --> -0.859454).  Saving model ...
Epoch: 10 cost time: 3.2538321018218994
Epoch: 10, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
Validation loss decreased (-0.859454 --> -0.870266).  Saving model ...
Epoch: 11 cost time: 2.977241039276123
Epoch: 11, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.870266 --> -0.889186).  Saving model ...
Epoch: 12 cost time: 2.9768192768096924
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.889186 --> -0.902700).  Saving model ...
Epoch: 13 cost time: 2.9856748580932617
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.902700 --> -0.910808).  Saving model ...
Epoch: 14 cost time: 3.014669179916382
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
Validation loss decreased (-0.910808 --> -0.924322).  Saving model ...
Epoch: 15 cost time: 2.939035415649414
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.924322 --> -0.929727).  Saving model ...
Epoch: 16 cost time: 3.0406267642974854
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 3.564211845397949
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 3.185713291168213
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 3.4155218601226807
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 3.390915632247925
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 3.2947378158569336
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 3.377349376678467
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 3.365247964859009
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0360426902770996
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 3.1297993659973145
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 3.1455540657043457
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9322545528411865
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2987513542175293
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.262683868408203
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 3.384002447128296
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 3.574986457824707
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.494394063949585
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.250918388366699
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.311357021331787
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.9393181800842285
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.2511723041534424
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.8433337211608887
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.037778854370117
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.145012855529785
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.0277092456817627
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.837198972702026
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.179 Vali Acc: 0.100 Test Loss: 2.179 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 3.2427501678466797
Epoch: 2, Steps: 17 | Train Loss: 2.095 Vali Loss: 2.038 Vali Acc: 0.251 Test Loss: 2.038 Test Acc: 0.251
Validation loss decreased (-0.099978 --> -0.251331).  Saving model ...
Epoch: 3 cost time: 3.218538284301758
Epoch: 3, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.843 Vali Acc: 0.508 Test Loss: 1.843 Test Acc: 0.508
Validation loss decreased (-0.251331 --> -0.508090).  Saving model ...
Epoch: 4 cost time: 3.28328013420105
Epoch: 4, Steps: 17 | Train Loss: 1.758 Vali Loss: 1.608 Vali Acc: 0.635 Test Loss: 1.608 Test Acc: 0.635
Validation loss decreased (-0.508090 --> -0.635119).  Saving model ...
Epoch: 5 cost time: 3.452620267868042
Epoch: 5, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.315 Vali Acc: 0.735 Test Loss: 1.315 Test Acc: 0.735
Validation loss decreased (-0.635119 --> -0.735122).  Saving model ...
Epoch: 6 cost time: 3.052030324935913
Epoch: 6, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.024 Vali Acc: 0.776 Test Loss: 1.024 Test Acc: 0.776
Validation loss decreased (-0.735122 --> -0.775665).  Saving model ...
Epoch: 7 cost time: 3.115302562713623
Epoch: 7, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.788 Vali Acc: 0.781 Test Loss: 0.788 Test Acc: 0.781
Validation loss decreased (-0.775665 --> -0.781073).  Saving model ...
Epoch: 8 cost time: 2.9631643295288086
Epoch: 8, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.574 Vali Acc: 0.868 Test Loss: 0.574 Test Acc: 0.868
Validation loss decreased (-0.781073 --> -0.867562).  Saving model ...
Epoch: 9 cost time: 3.0745768547058105
Epoch: 9, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0903520584106445
Epoch: 10, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.393 Vali Acc: 0.876 Test Loss: 0.393 Test Acc: 0.876
Validation loss decreased (-0.867562 --> -0.875672).  Saving model ...
Epoch: 11 cost time: 2.8876121044158936
Epoch: 11, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.332 Vali Acc: 0.897 Test Loss: 0.332 Test Acc: 0.897
Validation loss decreased (-0.875672 --> -0.897294).  Saving model ...
Epoch: 12 cost time: 2.991337299346924
Epoch: 12, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.297 Vali Acc: 0.914 Test Loss: 0.297 Test Acc: 0.914
Validation loss decreased (-0.897294 --> -0.913511).  Saving model ...
Epoch: 13 cost time: 3.352932929992676
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
Validation loss decreased (-0.913511 --> -0.918916).  Saving model ...
Epoch: 14 cost time: 3.2064967155456543
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
Validation loss decreased (-0.918916 --> -0.932430).  Saving model ...
Epoch: 15 cost time: 3.1226646900177
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1876132488250732
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 17 cost time: 2.981506109237671
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9936959743499756
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 19 cost time: 2.7514865398406982
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 20 cost time: 2.8011906147003174
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 3.1911017894744873
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 22 cost time: 2.8360342979431152
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 23 cost time: 3.075227737426758
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0818989276885986
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 3.180997371673584
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 2.977424383163452
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.961848497390747
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 2.9449617862701416
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0693836212158203
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2640647888183594
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0601940155029297
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2519938945770264
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 33 cost time: 3.185807466506958
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0071403980255127
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.990434408187866
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.0143003463745117
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.419241428375244
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.9077906608581543
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.0904667377471924
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.0811221599578857
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.941526174545288
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.081580877304077
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.59261155128479
Epoch: 1, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.214 Vali Acc: 0.122 Test Loss: 2.214 Test Acc: 0.122
Validation loss decreased (inf --> -0.121599).  Saving model ...
Epoch: 2 cost time: 3.1380794048309326
Epoch: 2, Steps: 17 | Train Loss: 2.152 Vali Loss: 2.056 Vali Acc: 0.281 Test Loss: 2.056 Test Acc: 0.281
Validation loss decreased (-0.121599 --> -0.281061).  Saving model ...
Epoch: 3 cost time: 2.9733572006225586
Epoch: 3, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.820 Vali Acc: 0.554 Test Loss: 1.820 Test Acc: 0.554
Validation loss decreased (-0.281061 --> -0.554036).  Saving model ...
Epoch: 4 cost time: 3.046393394470215
Epoch: 4, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.538 Vali Acc: 0.705 Test Loss: 1.538 Test Acc: 0.705
Validation loss decreased (-0.554036 --> -0.705390).  Saving model ...
Epoch: 5 cost time: 3.033613920211792
Epoch: 5, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.251 Vali Acc: 0.732 Test Loss: 1.251 Test Acc: 0.732
Validation loss decreased (-0.705390 --> -0.732420).  Saving model ...
Epoch: 6 cost time: 3.03837513923645
Epoch: 6, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.020 Vali Acc: 0.732 Test Loss: 1.020 Test Acc: 0.732
Validation loss decreased (-0.732420 --> -0.732422).  Saving model ...
Epoch: 7 cost time: 2.9640462398529053
Epoch: 7, Steps: 17 | Train Loss: 0.923 Vali Loss: 0.799 Vali Acc: 0.770 Test Loss: 0.799 Test Acc: 0.770
Validation loss decreased (-0.732422 --> -0.770262).  Saving model ...
Epoch: 8 cost time: 2.951418399810791
Epoch: 8, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.555 Vali Acc: 0.835 Test Loss: 0.555 Test Acc: 0.835
Validation loss decreased (-0.770262 --> -0.835130).  Saving model ...
Epoch: 9 cost time: 2.91379976272583
Epoch: 9, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.835130 --> -0.840536).  Saving model ...
Epoch: 10 cost time: 2.930830240249634
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
Validation loss decreased (-0.840536 --> -0.883780).  Saving model ...
Epoch: 11 cost time: 2.6634507179260254
Epoch: 11, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.271 Vali Acc: 0.905 Test Loss: 0.271 Test Acc: 0.905
Validation loss decreased (-0.883780 --> -0.905403).  Saving model ...
Epoch: 12 cost time: 2.919609308242798
Epoch: 12, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.251 Vali Acc: 0.914 Test Loss: 0.251 Test Acc: 0.914
Validation loss decreased (-0.905403 --> -0.913511).  Saving model ...
Epoch: 13 cost time: 2.7844326496124268
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.913511 --> -0.940538).  Saving model ...
Epoch: 14 cost time: 3.146446943283081
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 15 cost time: 2.9987101554870605
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1116394996643066
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 17 cost time: 3.088007926940918
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 2.944334030151367
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.130300521850586
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.86659574508667
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.654430389404297
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.671079635620117
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.65254807472229
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 2.593416452407837
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.45709490776062
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7990176677703857
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.784778118133545
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 28 cost time: 3.058062791824341
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.911815881729126
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8696043491363525
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.069282293319702
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.0196352005004883
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.8890538215637207
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8772809505462646
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.6928954124450684
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.974795341491699
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.621185302734375
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.386236190795898
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.199 Vali Acc: 0.105 Test Loss: 2.199 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 2.9004194736480713
Epoch: 2, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.045 Vali Acc: 0.243 Test Loss: 2.045 Test Acc: 0.243
Validation loss decreased (-0.105383 --> -0.243223).  Saving model ...
Epoch: 3 cost time: 3.0782113075256348
Epoch: 3, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.819 Vali Acc: 0.511 Test Loss: 1.819 Test Acc: 0.511
Validation loss decreased (-0.243223 --> -0.510793).  Saving model ...
Epoch: 4 cost time: 3.255002498626709
Epoch: 4, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.549 Vali Acc: 0.646 Test Loss: 1.549 Test Acc: 0.646
Validation loss decreased (-0.510793 --> -0.645930).  Saving model ...
Epoch: 5 cost time: 3.4120614528656006
Epoch: 5, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.253 Vali Acc: 0.751 Test Loss: 1.253 Test Acc: 0.751
Validation loss decreased (-0.645930 --> -0.751339).  Saving model ...
Epoch: 6 cost time: 2.8173916339874268
Epoch: 6, Steps: 17 | Train Loss: 1.257 Vali Loss: 0.999 Vali Acc: 0.757 Test Loss: 0.999 Test Acc: 0.757
Validation loss decreased (-0.751339 --> -0.756747).  Saving model ...
Epoch: 7 cost time: 3.242123603820801
Epoch: 7, Steps: 17 | Train Loss: 0.944 Vali Loss: 0.796 Vali Acc: 0.781 Test Loss: 0.796 Test Acc: 0.781
Validation loss decreased (-0.756747 --> -0.781073).  Saving model ...
Epoch: 8 cost time: 2.980149745941162
Epoch: 8, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.583 Vali Acc: 0.832 Test Loss: 0.583 Test Acc: 0.832
Validation loss decreased (-0.781073 --> -0.832427).  Saving model ...
Epoch: 9 cost time: 2.89693284034729
Epoch: 9, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.498 Vali Acc: 0.830 Test Loss: 0.498 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.793503522872925
Epoch: 10, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.389 Vali Acc: 0.868 Test Loss: 0.389 Test Acc: 0.868
Validation loss decreased (-0.832427 --> -0.867564).  Saving model ...
Epoch: 11 cost time: 2.762807846069336
Epoch: 11, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.867564 --> -0.889186).  Saving model ...
Epoch: 12 cost time: 2.88379168510437
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.300 Vali Acc: 0.892 Test Loss: 0.300 Test Acc: 0.892
Validation loss decreased (-0.889186 --> -0.891889).  Saving model ...
Epoch: 13 cost time: 3.2374160289764404
Epoch: 13, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.271 Vali Acc: 0.905 Test Loss: 0.271 Test Acc: 0.905
Validation loss decreased (-0.891889 --> -0.905403).  Saving model ...
Epoch: 14 cost time: 3.1476919651031494
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
Validation loss decreased (-0.905403 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 2.908604860305786
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3385813236236572
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2122256755828857
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.185 Vali Acc: 0.938 Test Loss: 0.185 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0576670169830322
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 3.236530303955078
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.284855365753174
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 3.1457793712615967
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 22 cost time: 3.128544569015503
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4195756912231445
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 24 cost time: 3.2173750400543213
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0820069313049316
Epoch: 25, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.079083204269409
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 3.0852744579315186
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 3.239917516708374
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2751047611236572
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 3.4254536628723145
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.175504684448242
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.162377119064331
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.160341501235962
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.2887332439422607
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.902850866317749
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.9999217987060547
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.837505578994751
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.847334146499634
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.7368462085723877
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 2.7783615589141846
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.991727590560913
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.164431571960449
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.2341270446777344
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.989305019378662
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.8817803859710693
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.699063777923584
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.114323139190674
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.7431535720825195
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.953676462173462
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.052502155303955
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 2.905595064163208
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 3 cost time: 2.9813199043273926
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 4 cost time: 2.975919485092163
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8830466270446777
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.948798894882202
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.019073247909546
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0562214851379395
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 9 cost time: 2.8512489795684814
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9588205814361572
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8976378440856934
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 12 cost time: 2.8599720001220703
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 13 cost time: 2.986863613128662
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.946934700012207
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.966768980026245
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.126063108444214
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0818288326263428
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0367143154144287
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0039491653442383
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.063307285308838
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.988119125366211
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.922992706298828
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.10810810810810811
model parameter : 519433
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.866274356842041
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.092 Vali Acc: 0.243 Test Loss: 2.092 Test Acc: 0.243
Validation loss decreased (inf --> -0.243222).  Saving model ...
Epoch: 2 cost time: 2.5461249351501465
Epoch: 2, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.858 Vali Acc: 0.468 Test Loss: 1.858 Test Acc: 0.468
Validation loss decreased (-0.243222 --> -0.467549).  Saving model ...
Epoch: 3 cost time: 2.833085536956787
Epoch: 3, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.623 Vali Acc: 0.586 Test Loss: 1.623 Test Acc: 0.586
Validation loss decreased (-0.467549 --> -0.586470).  Saving model ...
Epoch: 4 cost time: 2.7051475048065186
Epoch: 4, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.410 Vali Acc: 0.668 Test Loss: 1.410 Test Acc: 0.668
Validation loss decreased (-0.586470 --> -0.667553).  Saving model ...
Epoch: 5 cost time: 2.6500730514526367
Epoch: 5, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.226 Vali Acc: 0.716 Test Loss: 1.226 Test Acc: 0.716
Validation loss decreased (-0.667553 --> -0.716204).  Saving model ...
Epoch: 6 cost time: 2.682199001312256
Epoch: 6, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.031 Vali Acc: 0.776 Test Loss: 1.031 Test Acc: 0.776
Validation loss decreased (-0.716204 --> -0.775665).  Saving model ...
Epoch: 7 cost time: 2.8241772651672363
Epoch: 7, Steps: 17 | Train Loss: 0.869 Vali Loss: 0.867 Vali Acc: 0.816 Test Loss: 0.867 Test Acc: 0.816
Validation loss decreased (-0.775665 --> -0.816208).  Saving model ...
Epoch: 8 cost time: 2.918569803237915
Epoch: 8, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.710 Vali Acc: 0.849 Test Loss: 0.710 Test Acc: 0.849
Validation loss decreased (-0.816208 --> -0.848642).  Saving model ...
Epoch: 9 cost time: 2.973788261413574
Epoch: 9, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.610 Vali Acc: 0.865 Test Loss: 0.610 Test Acc: 0.865
Validation loss decreased (-0.848642 --> -0.864859).  Saving model ...
Epoch: 10 cost time: 2.7188198566436768
Epoch: 10, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.526 Vali Acc: 0.881 Test Loss: 0.526 Test Acc: 0.881
Validation loss decreased (-0.864859 --> -0.881076).  Saving model ...
Epoch: 11 cost time: 2.787446975708008
Epoch: 11, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.489 Vali Acc: 0.892 Test Loss: 0.489 Test Acc: 0.892
Validation loss decreased (-0.881076 --> -0.891887).  Saving model ...
Epoch: 12 cost time: 3.4367945194244385
Epoch: 12, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.400 Vali Acc: 0.911 Test Loss: 0.400 Test Acc: 0.911
Validation loss decreased (-0.891887 --> -0.910807).  Saving model ...
Epoch: 13 cost time: 3.08882212638855
Epoch: 13, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
Validation loss decreased (-0.910807 --> -0.910807).  Saving model ...
Epoch: 14 cost time: 3.0264029502868652
Epoch: 14, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.325 Vali Acc: 0.916 Test Loss: 0.325 Test Acc: 0.916
Validation loss decreased (-0.910807 --> -0.916213).  Saving model ...
Epoch: 15 cost time: 2.8477702140808105
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.916213 --> -0.929727).  Saving model ...
Epoch: 16 cost time: 2.9326131343841553
Epoch: 16, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7830188274383545
Epoch: 17, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 18 cost time: 2.992746114730835
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 19 cost time: 2.9259185791015625
Epoch: 19, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.077641725540161
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0659875869750977
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 22 cost time: 3.119065761566162
Epoch: 22, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.07961368560791
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.98441481590271
Epoch: 24, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 25 cost time: 3.1227223873138428
Epoch: 25, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8850154876708984
Epoch: 26, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 2.9398250579833984
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.830519437789917
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 29 cost time: 2.9215176105499268
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.048064947128296
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8862688541412354
Epoch: 31, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.8009841442108154
Epoch: 32, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.9617934226989746
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.9748635292053223
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.954139471054077
Epoch: 35, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.0549099445343018
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.2327263355255127
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.0840811729431152
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.20772647857666
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 2.119 Vali Acc: 0.173 Test Loss: 2.119 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 2.7834489345550537
Epoch: 2, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.920 Vali Acc: 0.408 Test Loss: 1.920 Test Acc: 0.408
Validation loss decreased (-0.172952 --> -0.408089).  Saving model ...
Epoch: 3 cost time: 2.6575562953948975
Epoch: 3, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.703 Vali Acc: 0.573 Test Loss: 1.703 Test Acc: 0.573
Validation loss decreased (-0.408089 --> -0.572956).  Saving model ...
Epoch: 4 cost time: 2.797872304916382
Epoch: 4, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.504 Vali Acc: 0.632 Test Loss: 1.504 Test Acc: 0.632
Validation loss decreased (-0.572956 --> -0.632417).  Saving model ...
Epoch: 5 cost time: 2.9761555194854736
Epoch: 5, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.325 Vali Acc: 0.684 Test Loss: 1.325 Test Acc: 0.684
Validation loss decreased (-0.632417 --> -0.683771).  Saving model ...
Epoch: 6 cost time: 3.217338800430298
Epoch: 6, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.138 Vali Acc: 0.738 Test Loss: 1.138 Test Acc: 0.738
Validation loss decreased (-0.683771 --> -0.737826).  Saving model ...
Epoch: 7 cost time: 3.3459079265594482
Epoch: 7, Steps: 17 | Train Loss: 0.989 Vali Loss: 0.962 Vali Acc: 0.786 Test Loss: 0.962 Test Acc: 0.786
Validation loss decreased (-0.737826 --> -0.786477).  Saving model ...
Epoch: 8 cost time: 3.2409918308258057
Epoch: 8, Steps: 17 | Train Loss: 0.829 Vali Loss: 0.803 Vali Acc: 0.811 Test Loss: 0.803 Test Acc: 0.811
Validation loss decreased (-0.786477 --> -0.810803).  Saving model ...
Epoch: 9 cost time: 3.1681058406829834
Epoch: 9, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.682 Vali Acc: 0.835 Test Loss: 0.682 Test Acc: 0.835
Validation loss decreased (-0.810803 --> -0.835128).  Saving model ...
Epoch: 10 cost time: 2.991290330886841
Epoch: 10, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
Validation loss decreased (-0.835128 --> -0.862156).  Saving model ...
Epoch: 11 cost time: 3.0811331272125244
Epoch: 11, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
Validation loss decreased (-0.862156 --> -0.878373).  Saving model ...
Epoch: 12 cost time: 2.9586985111236572
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
Validation loss decreased (-0.878373 --> -0.883779).  Saving model ...
Epoch: 13 cost time: 2.9660918712615967
Epoch: 13, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.883779 --> -0.902699).  Saving model ...
Epoch: 14 cost time: 2.8486552238464355
Epoch: 14, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.349 Vali Acc: 0.905 Test Loss: 0.349 Test Acc: 0.905
Validation loss decreased (-0.902699 --> -0.905402).  Saving model ...
Epoch: 15 cost time: 3.0557568073272705
Epoch: 15, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
Validation loss decreased (-0.905402 --> -0.910808).  Saving model ...
Epoch: 16 cost time: 2.8211820125579834
Epoch: 16, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
Validation loss decreased (-0.910808 --> -0.916213).  Saving model ...
Epoch: 17 cost time: 3.0092012882232666
Epoch: 17, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.272 Vali Acc: 0.924 Test Loss: 0.272 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924322).  Saving model ...
Epoch: 18 cost time: 3.2093183994293213
Epoch: 18, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.250 Vali Acc: 0.924 Test Loss: 0.250 Test Acc: 0.924
Validation loss decreased (-0.924322 --> -0.924322).  Saving model ...
Epoch: 19 cost time: 3.1612415313720703
Epoch: 19, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2997941970825195
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.924322 --> -0.929727).  Saving model ...
Epoch: 21 cost time: 3.276505708694458
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 22 cost time: 3.0513675212860107
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2276368141174316
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1507205963134766
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 25 cost time: 3.0523929595947266
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.816089630126953
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 3.012022018432617
Epoch: 27, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.026890277862549
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9068217277526855
Epoch: 29, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.004831552505493
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.3203446865081787
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.214855670928955
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.125300645828247
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.1428167819976807
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.1903958320617676
Epoch: 35, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 3.102797746658325
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.1058225631713867
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.049684762954712
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.1882784366607666
Epoch: 39, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 2.936535358428955
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.23545503616333
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.185715675354004
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.390307664871216
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.4100961685180664
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.234884262084961
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.328152656555176
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.2964060306549072
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.198101758956909
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.2257909774780273
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.152144432067871
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.170 Vali Acc: 0.178 Test Loss: 2.170 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 2.838425874710083
Epoch: 2, Steps: 17 | Train Loss: 2.071 Vali Loss: 2.026 Vali Acc: 0.308 Test Loss: 2.026 Test Acc: 0.308
Validation loss decreased (-0.178357 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 3.1043598651885986
Epoch: 3, Steps: 17 | Train Loss: 1.956 Vali Loss: 1.854 Vali Acc: 0.481 Test Loss: 1.854 Test Acc: 0.481
Validation loss decreased (-0.308088 --> -0.481063).  Saving model ...
Epoch: 4 cost time: 2.7158429622650146
Epoch: 4, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.683 Vali Acc: 0.570 Test Loss: 1.683 Test Acc: 0.570
Validation loss decreased (-0.481063 --> -0.570253).  Saving model ...
Epoch: 5 cost time: 2.8380579948425293
Epoch: 5, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.525 Vali Acc: 0.627 Test Loss: 1.525 Test Acc: 0.627
Validation loss decreased (-0.570253 --> -0.627012).  Saving model ...
Epoch: 6 cost time: 2.750978946685791
Epoch: 6, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.349 Vali Acc: 0.665 Test Loss: 1.349 Test Acc: 0.665
Validation loss decreased (-0.627012 --> -0.664851).  Saving model ...
Epoch: 7 cost time: 2.734405040740967
Epoch: 7, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.158 Vali Acc: 0.743 Test Loss: 1.158 Test Acc: 0.743
Validation loss decreased (-0.664851 --> -0.743232).  Saving model ...
Epoch: 8 cost time: 2.779745101928711
Epoch: 8, Steps: 17 | Train Loss: 0.983 Vali Loss: 0.970 Vali Acc: 0.781 Test Loss: 0.970 Test Acc: 0.781
Validation loss decreased (-0.743232 --> -0.781071).  Saving model ...
Epoch: 9 cost time: 2.7594079971313477
Epoch: 9, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.803 Vali Acc: 0.803 Test Loss: 0.803 Test Acc: 0.803
Validation loss decreased (-0.781071 --> -0.802695).  Saving model ...
Epoch: 10 cost time: 2.9802944660186768
Epoch: 10, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.683 Vali Acc: 0.819 Test Loss: 0.683 Test Acc: 0.819
Validation loss decreased (-0.802695 --> -0.818912).  Saving model ...
Epoch: 11 cost time: 2.849069356918335
Epoch: 11, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.616 Vali Acc: 0.830 Test Loss: 0.616 Test Acc: 0.830
Validation loss decreased (-0.818912 --> -0.829724).  Saving model ...
Epoch: 12 cost time: 2.8793528079986572
Epoch: 12, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.520 Vali Acc: 0.849 Test Loss: 0.520 Test Acc: 0.849
Validation loss decreased (-0.829724 --> -0.848643).  Saving model ...
Epoch: 13 cost time: 2.6864044666290283
Epoch: 13, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.469 Vali Acc: 0.868 Test Loss: 0.469 Test Acc: 0.868
Validation loss decreased (-0.848643 --> -0.867563).  Saving model ...
Epoch: 14 cost time: 2.863821506500244
Epoch: 14, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (-0.867563 --> -0.889185).  Saving model ...
Epoch: 15 cost time: 2.8955612182617188
Epoch: 15, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.375 Vali Acc: 0.908 Test Loss: 0.375 Test Acc: 0.908
Validation loss decreased (-0.889185 --> -0.908104).  Saving model ...
Epoch: 16 cost time: 2.640336036682129
Epoch: 16, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6445271968841553
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.314 Vali Acc: 0.916 Test Loss: 0.314 Test Acc: 0.916
Validation loss decreased (-0.908104 --> -0.916213).  Saving model ...
Epoch: 18 cost time: 2.844794273376465
Epoch: 18, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 19 cost time: 2.803032875061035
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7715351581573486
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 21 cost time: 2.8919849395751953
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7594761848449707
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0346243381500244
Epoch: 23, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 24 cost time: 3.105647325515747
Epoch: 24, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 25 cost time: 2.8994736671447754
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 26 cost time: 2.877763509750366
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.203 Vali Acc: 0.938 Test Loss: 0.203 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8870785236358643
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 28 cost time: 2.9955711364746094
Epoch: 28, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 2.8886823654174805
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.559558153152466
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.813976287841797
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.7433979511260986
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.8440933227539062
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.6579883098602295
Epoch: 34, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.8128960132598877
Epoch: 35, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 36 cost time: 2.879147529602051
Epoch: 36, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 37 cost time: 3.122699499130249
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0070271492004395
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.716346502304077
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.9155027866363525
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.961134672164917
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 42 cost time: 2.7165722846984863
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.8025126457214355
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.8600993156433105
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 2.9615821838378906
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.7748513221740723
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.8703112602233887
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.8624112606048584
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.9344406127929688
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 50 cost time: 3.09865665435791
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.957014799118042
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.147045612335205
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 53 cost time: 3.019493341445923
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.005667209625244
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.9198858737945557
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.8509178161621094
Epoch: 56, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.7954494953155518
Epoch: 57, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.8854055404663086
Epoch: 58, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.7597544193267822
Epoch: 59, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.7667393684387207
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.8693931102752686
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.013549566268921
Epoch: 62, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 63 cost time: 3.18306827545166
Epoch: 63, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.143723726272583
Epoch: 64, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.9348888397216797
Epoch: 65, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.9651122093200684
Epoch: 66, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.9720983505249023
Epoch: 67, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 68 cost time: 3.0270514488220215
Epoch: 68, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.2940173149108887
Epoch: 69, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.202481746673584
Epoch: 70, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 71 cost time: 3.075408458709717
Epoch: 71, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.255629062652588
Epoch: 72, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.1770005226135254
Epoch: 73, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.992534637451172
Epoch: 74, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.28671932220459
Epoch: 75, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.2821755409240723
Epoch: 76, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.1697511672973633
Epoch: 77, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 78 cost time: 3.186450719833374
Epoch: 78, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 79 cost time: 3.3178586959838867
Epoch: 79, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 80 cost time: 3.013749837875366
Epoch: 80, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 81 cost time: 2.7490622997283936
Epoch: 81, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 3.275740146636963
Epoch: 82, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 3.1086833477020264
Epoch: 83, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 3.424210786819458
Epoch: 84, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 85 cost time: 3.2699594497680664
Epoch: 85, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 3.4120287895202637
Epoch: 86, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 3.298736333847046
Epoch: 87, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 3.1833765506744385
Epoch: 88, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 3.350409507751465
Epoch: 89, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 3.080919027328491
Epoch: 90, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 3.336289644241333
Epoch: 91, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 2.922442674636841
Epoch: 92, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 2.9483449459075928
Epoch: 93, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 3.157810688018799
Epoch: 94, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.430566310882568
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.190 Vali Acc: 0.173 Test Loss: 2.190 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 3.2796213626861572
Epoch: 2, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.074 Vali Acc: 0.303 Test Loss: 2.074 Test Acc: 0.303
Validation loss decreased (-0.172951 --> -0.302682).  Saving model ...
Epoch: 3 cost time: 3.2519118785858154
Epoch: 3, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.927 Vali Acc: 0.432 Test Loss: 1.927 Test Acc: 0.432
Validation loss decreased (-0.302682 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 3.10137677192688
Epoch: 4, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.766 Vali Acc: 0.522 Test Loss: 1.766 Test Acc: 0.522
Validation loss decreased (-0.432413 --> -0.521604).  Saving model ...
Epoch: 5 cost time: 3.065166711807251
Epoch: 5, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.613 Vali Acc: 0.589 Test Loss: 1.613 Test Acc: 0.589
Validation loss decreased (-0.521604 --> -0.589173).  Saving model ...
Epoch: 6 cost time: 3.2852067947387695
Epoch: 6, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.448 Vali Acc: 0.630 Test Loss: 1.448 Test Acc: 0.630
Validation loss decreased (-0.589173 --> -0.629715).  Saving model ...
Epoch: 7 cost time: 2.790930986404419
Epoch: 7, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.267 Vali Acc: 0.684 Test Loss: 1.267 Test Acc: 0.684
Validation loss decreased (-0.629715 --> -0.683771).  Saving model ...
Epoch: 8 cost time: 3.0153567790985107
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.072 Vali Acc: 0.735 Test Loss: 1.072 Test Acc: 0.735
Validation loss decreased (-0.683771 --> -0.735124).  Saving model ...
Epoch: 9 cost time: 2.706803560256958
Epoch: 9, Steps: 17 | Train Loss: 0.903 Vali Loss: 0.889 Vali Acc: 0.803 Test Loss: 0.889 Test Acc: 0.803
Validation loss decreased (-0.735124 --> -0.802694).  Saving model ...
Epoch: 10 cost time: 2.895536184310913
Epoch: 10, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.758 Vali Acc: 0.808 Test Loss: 0.758 Test Acc: 0.808
Validation loss decreased (-0.802694 --> -0.808101).  Saving model ...
Epoch: 11 cost time: 2.9182329177856445
Epoch: 11, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.663 Vali Acc: 0.827 Test Loss: 0.663 Test Acc: 0.827
Validation loss decreased (-0.808101 --> -0.827020).  Saving model ...
Epoch: 12 cost time: 2.949950695037842
Epoch: 12, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.571 Vali Acc: 0.843 Test Loss: 0.571 Test Acc: 0.843
Validation loss decreased (-0.827020 --> -0.843238).  Saving model ...
Epoch: 13 cost time: 3.0535566806793213
Epoch: 13, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.518 Vali Acc: 0.862 Test Loss: 0.518 Test Acc: 0.862
Validation loss decreased (-0.843238 --> -0.862157).  Saving model ...
Epoch: 14 cost time: 3.365963935852051
Epoch: 14, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.450 Vali Acc: 0.884 Test Loss: 0.450 Test Acc: 0.884
Validation loss decreased (-0.862157 --> -0.883779).  Saving model ...
Epoch: 15 cost time: 3.209012985229492
Epoch: 15, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.883779 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 3.1057491302490234
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.361 Vali Acc: 0.905 Test Loss: 0.361 Test Acc: 0.905
Validation loss decreased (-0.899996 --> -0.905402).  Saving model ...
Epoch: 17 cost time: 3.018807888031006
Epoch: 17, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.352 Vali Acc: 0.916 Test Loss: 0.352 Test Acc: 0.916
Validation loss decreased (-0.905402 --> -0.916213).  Saving model ...
Epoch: 18 cost time: 3.1024367809295654
Epoch: 18, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.289 Vali Acc: 0.927 Test Loss: 0.289 Test Acc: 0.927
Validation loss decreased (-0.916213 --> -0.927024).  Saving model ...
Epoch: 19 cost time: 3.3970372676849365
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.301 Vali Acc: 0.924 Test Loss: 0.301 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.987767219543457
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 21 cost time: 2.9481568336486816
Epoch: 21, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 22 cost time: 2.9922292232513428
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.030930995941162
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 24 cost time: 2.973151445388794
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.892935037612915
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.163785934448242
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.937836 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 3.2066047191619873
Epoch: 27, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.142272710800171
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.191709518432617
Epoch: 29, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 30 cost time: 3.3440840244293213
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3955299854278564
Epoch: 31, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4910013675689697
Epoch: 32, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.853170394897461
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.210498809814453
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.244957447052002
Epoch: 35, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.989483594894409
Epoch: 36, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.2579421997070312
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.1695849895477295
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.505800724029541
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.330310821533203
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.223 Vali Acc: 0.105 Test Loss: 2.223 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 2.8723974227905273
Epoch: 2, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.125 Vali Acc: 0.211 Test Loss: 2.125 Test Acc: 0.211
Validation loss decreased (-0.105383 --> -0.210790).  Saving model ...
Epoch: 3 cost time: 2.7955942153930664
Epoch: 3, Steps: 17 | Train Loss: 2.103 Vali Loss: 1.992 Vali Acc: 0.373 Test Loss: 1.992 Test Acc: 0.373
Validation loss decreased (-0.210790 --> -0.372953).  Saving model ...
Epoch: 4 cost time: 2.8718514442443848
Epoch: 4, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
Validation loss decreased (-0.372953 --> -0.527009).  Saving model ...
Epoch: 5 cost time: 2.9772725105285645
Epoch: 5, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.666 Vali Acc: 0.595 Test Loss: 1.666 Test Acc: 0.595
Validation loss decreased (-0.527009 --> -0.594578).  Saving model ...
Epoch: 6 cost time: 2.909078359603882
Epoch: 6, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.478 Vali Acc: 0.643 Test Loss: 1.478 Test Acc: 0.643
Validation loss decreased (-0.594578 --> -0.643228).  Saving model ...
Epoch: 7 cost time: 2.917825222015381
Epoch: 7, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.310 Vali Acc: 0.638 Test Loss: 1.310 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7439229488372803
Epoch: 8, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.124 Vali Acc: 0.668 Test Loss: 1.124 Test Acc: 0.668
Validation loss decreased (-0.643228 --> -0.667556).  Saving model ...
Epoch: 9 cost time: 3.37996244430542
Epoch: 9, Steps: 17 | Train Loss: 0.975 Vali Loss: 0.872 Vali Acc: 0.773 Test Loss: 0.872 Test Acc: 0.773
Validation loss decreased (-0.667556 --> -0.772964).  Saving model ...
Epoch: 10 cost time: 3.13474178314209
Epoch: 10, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.715 Vali Acc: 0.808 Test Loss: 0.715 Test Acc: 0.808
Validation loss decreased (-0.772964 --> -0.808101).  Saving model ...
Epoch: 11 cost time: 3.1690125465393066
Epoch: 11, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.590 Vali Acc: 0.868 Test Loss: 0.590 Test Acc: 0.868
Validation loss decreased (-0.808101 --> -0.867562).  Saving model ...
Epoch: 12 cost time: 3.1363883018493652
Epoch: 12, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.490 Vali Acc: 0.886 Test Loss: 0.490 Test Acc: 0.886
Validation loss decreased (-0.867562 --> -0.886482).  Saving model ...
Epoch: 13 cost time: 3.2451119422912598
Epoch: 13, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
Validation loss decreased (-0.886482 --> -0.910807).  Saving model ...
Epoch: 14 cost time: 2.906113862991333
Epoch: 14, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.349 Vali Acc: 0.927 Test Loss: 0.349 Test Acc: 0.927
Validation loss decreased (-0.910807 --> -0.927024).  Saving model ...
Epoch: 15 cost time: 3.1837899684906006
Epoch: 15, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.327 Vali Acc: 0.919 Test Loss: 0.327 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2239949703216553
Epoch: 16, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.129452705383301
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 18 cost time: 2.9279980659484863
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 19 cost time: 3.0213215351104736
Epoch: 19, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 20 cost time: 3.1036934852600098
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 2.9461212158203125
Epoch: 21, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0756866931915283
Epoch: 22, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1828935146331787
Epoch: 23, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 24 cost time: 2.9568660259246826
Epoch: 24, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.987276792526245
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.842623710632324
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.088488817214966
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.847651958465576
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 3.0251123905181885
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9424562454223633
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8370072841644287
Epoch: 31, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.111309289932251
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 3.0102336406707764
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0534825325012207
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.932 Test Loss: 0.188 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.975567102432251
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.967184066772461
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9123687744140625
Epoch: 37, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 38 cost time: 3.1668665409088135
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.817103862762451
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.7378928661346436
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.9654600620269775
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.2520787715911865
Epoch: 42, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.9629275798797607
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.028841018676758
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.2752766609191895
Epoch: 45, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.0458199977874756
Epoch: 46, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.1722288131713867
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.289980888366699
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.200 Vali Acc: 0.105 Test Loss: 2.200 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 3.088810443878174
Epoch: 2, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.065 Vali Acc: 0.265 Test Loss: 2.065 Test Acc: 0.265
Validation loss decreased (-0.105383 --> -0.264844).  Saving model ...
Epoch: 3 cost time: 2.8877975940704346
Epoch: 3, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.893 Vali Acc: 0.468 Test Loss: 1.893 Test Acc: 0.468
Validation loss decreased (-0.264844 --> -0.467549).  Saving model ...
Epoch: 4 cost time: 2.8260104656219482
Epoch: 4, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.711 Vali Acc: 0.597 Test Loss: 1.711 Test Acc: 0.597
Validation loss decreased (-0.467549 --> -0.597280).  Saving model ...
Epoch: 5 cost time: 2.7043752670288086
Epoch: 5, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.540 Vali Acc: 0.630 Test Loss: 1.540 Test Acc: 0.630
Validation loss decreased (-0.597280 --> -0.629714).  Saving model ...
Epoch: 6 cost time: 2.7212729454040527
Epoch: 6, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.350 Vali Acc: 0.670 Test Loss: 1.350 Test Acc: 0.670
Validation loss decreased (-0.629714 --> -0.670257).  Saving model ...
Epoch: 7 cost time: 2.7871954441070557
Epoch: 7, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.169 Vali Acc: 0.735 Test Loss: 1.169 Test Acc: 0.735
Validation loss decreased (-0.670257 --> -0.735123).  Saving model ...
Epoch: 8 cost time: 2.7691006660461426
Epoch: 8, Steps: 17 | Train Loss: 1.129 Vali Loss: 0.988 Vali Acc: 0.751 Test Loss: 0.988 Test Acc: 0.751
Validation loss decreased (-0.735123 --> -0.751341).  Saving model ...
Epoch: 9 cost time: 2.883901596069336
Epoch: 9, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.777 Vali Acc: 0.841 Test Loss: 0.777 Test Acc: 0.841
Validation loss decreased (-0.751341 --> -0.840533).  Saving model ...
Epoch: 10 cost time: 3.0398740768432617
Epoch: 10, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.633 Vali Acc: 0.865 Test Loss: 0.633 Test Acc: 0.865
Validation loss decreased (-0.840533 --> -0.864859).  Saving model ...
Epoch: 11 cost time: 2.9447977542877197
Epoch: 11, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.510 Vali Acc: 0.897 Test Loss: 0.510 Test Acc: 0.897
Validation loss decreased (-0.864859 --> -0.897292).  Saving model ...
Epoch: 12 cost time: 2.9870996475219727
Epoch: 12, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
Validation loss decreased (-0.897292 --> -0.910807).  Saving model ...
Epoch: 13 cost time: 2.812699794769287
Epoch: 13, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
Validation loss decreased (-0.910807 --> -0.918915).  Saving model ...
Epoch: 14 cost time: 2.841975688934326
Epoch: 14, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.292 Vali Acc: 0.949 Test Loss: 0.292 Test Acc: 0.949
Validation loss decreased (-0.918915 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 2.5652780532836914
Epoch: 15, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.287 Vali Acc: 0.935 Test Loss: 0.287 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5764806270599365
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.804900884628296
Epoch: 17, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.238 Vali Acc: 0.927 Test Loss: 0.238 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6617774963378906
Epoch: 18, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7904345989227295
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7784926891326904
Epoch: 20, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.786818027496338
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.339901924133301
Epoch: 22, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9855635166168213
Epoch: 23, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 24 cost time: 3.1041977405548096
Epoch: 24, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.050863027572632
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.173637866973877
Epoch: 26, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.018819570541382
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.945507764816284
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0108540058135986
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 2.93806529045105
Epoch: 30, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.97704815864563
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8884658813476562
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3704254627227783
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.289438486099243
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.2684590816497803
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.1778740882873535
Epoch: 36, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.011948347091675
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.05077862739563
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.063559055328369
Epoch: 39, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.107774019241333
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 2.8788199424743652
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 3 cost time: 2.80705189704895
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0856900215148926
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 5 cost time: 3.037837028503418
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8896825313568115
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0051605701446533
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.96228289604187
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0896220207214355
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
Validation loss decreased (-0.135113 --> -0.135113).  Saving model ...
Epoch: 10 cost time: 3.084075689315796
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.72528076171875
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9540185928344727
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.886028289794922
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9161384105682373
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0011563301086426
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.82877516746521
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.044201374053955
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.065 Test Loss: 2.196 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.218204975128174
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0431394577026367
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.13513513513513514
model parameter : 902793
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.392347812652588
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.114 Vali Acc: 0.254 Test Loss: 2.114 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 3.0219860076904297
Epoch: 2, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.918 Vali Acc: 0.414 Test Loss: 1.918 Test Acc: 0.414
Validation loss decreased (-0.254033 --> -0.413494).  Saving model ...
Epoch: 3 cost time: 2.881115436553955
Epoch: 3, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.699 Vali Acc: 0.538 Test Loss: 1.699 Test Acc: 0.538
Validation loss decreased (-0.413494 --> -0.537821).  Saving model ...
Epoch: 4 cost time: 2.9556522369384766
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.494 Vali Acc: 0.665 Test Loss: 1.494 Test Acc: 0.665
Validation loss decreased (-0.537821 --> -0.664850).  Saving model ...
Epoch: 5 cost time: 2.7662758827209473
Epoch: 5, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.307 Vali Acc: 0.722 Test Loss: 1.307 Test Acc: 0.722
Validation loss decreased (-0.664850 --> -0.721609).  Saving model ...
Epoch: 6 cost time: 3.079954147338867
Epoch: 6, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.141 Vali Acc: 0.751 Test Loss: 1.141 Test Acc: 0.751
Validation loss decreased (-0.721609 --> -0.751340).  Saving model ...
Epoch: 7 cost time: 3.1356313228607178
Epoch: 7, Steps: 17 | Train Loss: 0.984 Vali Loss: 0.960 Vali Acc: 0.776 Test Loss: 0.960 Test Acc: 0.776
Validation loss decreased (-0.751340 --> -0.775666).  Saving model ...
Epoch: 8 cost time: 2.98551607131958
Epoch: 8, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.805 Vali Acc: 0.832 Test Loss: 0.805 Test Acc: 0.832
Validation loss decreased (-0.775666 --> -0.832424).  Saving model ...
Epoch: 9 cost time: 3.3939626216888428
Epoch: 9, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.671 Vali Acc: 0.851 Test Loss: 0.671 Test Acc: 0.851
Validation loss decreased (-0.832424 --> -0.851345).  Saving model ...
Epoch: 10 cost time: 3.2094650268554688
Epoch: 10, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.572 Vali Acc: 0.870 Test Loss: 0.572 Test Acc: 0.870
Validation loss decreased (-0.851345 --> -0.870265).  Saving model ...
Epoch: 11 cost time: 3.397226572036743
Epoch: 11, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.477 Vali Acc: 0.903 Test Loss: 0.477 Test Acc: 0.903
Validation loss decreased (-0.870265 --> -0.902698).  Saving model ...
Epoch: 12 cost time: 3.2736151218414307
Epoch: 12, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.424 Vali Acc: 0.903 Test Loss: 0.424 Test Acc: 0.903
Validation loss decreased (-0.902698 --> -0.902698).  Saving model ...
Epoch: 13 cost time: 3.110747814178467
Epoch: 13, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.365 Vali Acc: 0.927 Test Loss: 0.365 Test Acc: 0.927
Validation loss decreased (-0.902698 --> -0.927023).  Saving model ...
Epoch: 14 cost time: 3.247011184692383
Epoch: 14, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.331 Vali Acc: 0.927 Test Loss: 0.331 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 15 cost time: 2.827198028564453
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.302 Vali Acc: 0.938 Test Loss: 0.302 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 16 cost time: 3.3329734802246094
Epoch: 16, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1304664611816406
Epoch: 17, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 2.866179943084717
Epoch: 18, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 3.208310127258301
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3156707286834717
Epoch: 20, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 21 cost time: 3.139010429382324
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 3.1190621852874756
Epoch: 22, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.065640449523926
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 3.27679443359375
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 3.1475753784179688
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 26 cost time: 2.9868385791778564
Epoch: 26, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 27 cost time: 2.9129350185394287
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 2.7853777408599854
Epoch: 28, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.973527669906616
Epoch: 29, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0072896480560303
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.854292869567871
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 3.0948898792266846
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3705077171325684
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.315579891204834
Epoch: 34, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.292909622192383
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 3.4409570693969727
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.1781656742095947
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.245440721511841
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 2.9414172172546387
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 3.092101812362671
Epoch: 40, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2175827026367188
Epoch: 41, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1168949604034424
Epoch: 42, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.072854518890381
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.4082870483398438
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.2764647006988525
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.5499770641326904
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.4664883613586426
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.0074620246887207
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.1064796447753906
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.972991704940796
Epoch: 1, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.132 Vali Acc: 0.230 Test Loss: 2.132 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 2.6833083629608154
Epoch: 2, Steps: 17 | Train Loss: 2.081 Vali Loss: 1.978 Vali Acc: 0.327 Test Loss: 1.978 Test Acc: 0.327
Validation loss decreased (-0.229708 --> -0.327007).  Saving model ...
Epoch: 3 cost time: 3.0648255348205566
Epoch: 3, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.794 Vali Acc: 0.500 Test Loss: 1.794 Test Acc: 0.500
Validation loss decreased (-0.327007 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 2.9375298023223877
Epoch: 4, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.611 Vali Acc: 0.619 Test Loss: 1.611 Test Acc: 0.619
Validation loss decreased (-0.499982 --> -0.618903).  Saving model ...
Epoch: 5 cost time: 2.8109283447265625
Epoch: 5, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.430 Vali Acc: 0.684 Test Loss: 1.430 Test Acc: 0.684
Validation loss decreased (-0.618903 --> -0.683769).  Saving model ...
Epoch: 6 cost time: 2.739309310913086
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.265 Vali Acc: 0.711 Test Loss: 1.265 Test Acc: 0.711
Validation loss decreased (-0.683769 --> -0.710798).  Saving model ...
Epoch: 7 cost time: 3.071269989013672
Epoch: 7, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.085 Vali Acc: 0.762 Test Loss: 1.085 Test Acc: 0.762
Validation loss decreased (-0.710798 --> -0.762151).  Saving model ...
Epoch: 8 cost time: 2.978487491607666
Epoch: 8, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.923 Vali Acc: 0.797 Test Loss: 0.923 Test Acc: 0.797
Validation loss decreased (-0.762151 --> -0.797288).  Saving model ...
Epoch: 9 cost time: 2.8530521392822266
Epoch: 9, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.777 Vali Acc: 0.830 Test Loss: 0.777 Test Acc: 0.830
Validation loss decreased (-0.797288 --> -0.829722).  Saving model ...
Epoch: 10 cost time: 3.0264251232147217
Epoch: 10, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.657 Vali Acc: 0.862 Test Loss: 0.657 Test Acc: 0.862
Validation loss decreased (-0.829722 --> -0.862156).  Saving model ...
Epoch: 11 cost time: 3.0500853061676025
Epoch: 11, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.552 Vali Acc: 0.881 Test Loss: 0.552 Test Acc: 0.881
Validation loss decreased (-0.862156 --> -0.881076).  Saving model ...
Epoch: 12 cost time: 3.219796895980835
Epoch: 12, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.478 Vali Acc: 0.897 Test Loss: 0.478 Test Acc: 0.897
Validation loss decreased (-0.881076 --> -0.897293).  Saving model ...
Epoch: 13 cost time: 3.0810232162475586
Epoch: 13, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.425 Vali Acc: 0.908 Test Loss: 0.425 Test Acc: 0.908
Validation loss decreased (-0.897293 --> -0.908104).  Saving model ...
Epoch: 14 cost time: 3.2514917850494385
Epoch: 14, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.390 Vali Acc: 0.908 Test Loss: 0.390 Test Acc: 0.908
Validation loss decreased (-0.908104 --> -0.908104).  Saving model ...
Epoch: 15 cost time: 3.2844059467315674
Epoch: 15, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.351 Vali Acc: 0.908 Test Loss: 0.351 Test Acc: 0.908
Validation loss decreased (-0.908104 --> -0.908105).  Saving model ...
Epoch: 16 cost time: 3.049086093902588
Epoch: 16, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.302 Vali Acc: 0.914 Test Loss: 0.302 Test Acc: 0.914
Validation loss decreased (-0.908105 --> -0.913510).  Saving model ...
Epoch: 17 cost time: 2.882946491241455
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.283 Vali Acc: 0.924 Test Loss: 0.283 Test Acc: 0.924
Validation loss decreased (-0.913510 --> -0.924321).  Saving model ...
Epoch: 18 cost time: 2.9947638511657715
Epoch: 18, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929727).  Saving model ...
Epoch: 19 cost time: 3.153188943862915
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 20 cost time: 2.963963270187378
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 21 cost time: 2.6977555751800537
Epoch: 21, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 22 cost time: 2.8609671592712402
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 23 cost time: 2.966806411743164
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.185 Vali Acc: 0.932 Test Loss: 0.185 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.969003200531006
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8594772815704346
Epoch: 25, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 3.0310604572296143
Epoch: 26, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0548226833343506
Epoch: 27, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 3.01554799079895
Epoch: 28, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9414355754852295
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 30 cost time: 2.7524900436401367
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.8395986557006836
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.6854000091552734
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.736846923828125
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.033111810684204
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 35 cost time: 2.8656527996063232
Epoch: 35, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 3.0840468406677246
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.100109338760376
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.0001232624053955
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 39 cost time: 3.14847993850708
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0356979370117188
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.160503387451172
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.994450092315674
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.8334028720855713
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.2272629737854004
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.897388458251953
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.0609610080718994
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.8418920040130615
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.0124878883361816
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.475162029266357
Epoch: 1, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.155 Vali Acc: 0.197 Test Loss: 2.155 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 3.209388494491577
Epoch: 2, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.040 Vali Acc: 0.365 Test Loss: 2.040 Test Acc: 0.365
Validation loss decreased (-0.197276 --> -0.364844).  Saving model ...
Epoch: 3 cost time: 3.0460293292999268
Epoch: 3, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.898 Vali Acc: 0.530 Test Loss: 1.898 Test Acc: 0.530
Validation loss decreased (-0.364844 --> -0.529711).  Saving model ...
Epoch: 4 cost time: 3.243342399597168
Epoch: 4, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.750 Vali Acc: 0.619 Test Loss: 1.750 Test Acc: 0.619
Validation loss decreased (-0.529711 --> -0.618901).  Saving model ...
Epoch: 5 cost time: 2.687103748321533
Epoch: 5, Steps: 17 | Train Loss: 1.665 Vali Loss: 1.585 Vali Acc: 0.657 Test Loss: 1.585 Test Acc: 0.657
Validation loss decreased (-0.618901 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 3.0473525524139404
Epoch: 6, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.419 Vali Acc: 0.681 Test Loss: 1.419 Test Acc: 0.681
Validation loss decreased (-0.656741 --> -0.681067).  Saving model ...
Epoch: 7 cost time: 2.654773712158203
Epoch: 7, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.238 Vali Acc: 0.724 Test Loss: 1.238 Test Acc: 0.724
Validation loss decreased (-0.681067 --> -0.724312).  Saving model ...
Epoch: 8 cost time: 2.8502919673919678
Epoch: 8, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.059 Vali Acc: 0.757 Test Loss: 1.059 Test Acc: 0.757
Validation loss decreased (-0.724312 --> -0.756746).  Saving model ...
Epoch: 9 cost time: 2.9469869136810303
Epoch: 9, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.898 Vali Acc: 0.784 Test Loss: 0.898 Test Acc: 0.784
Validation loss decreased (-0.756746 --> -0.783775).  Saving model ...
Epoch: 10 cost time: 2.869938611984253
Epoch: 10, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.757 Vali Acc: 0.816 Test Loss: 0.757 Test Acc: 0.816
Validation loss decreased (-0.783775 --> -0.816209).  Saving model ...
Epoch: 11 cost time: 2.8725056648254395
Epoch: 11, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.638 Vali Acc: 0.832 Test Loss: 0.638 Test Acc: 0.832
Validation loss decreased (-0.816209 --> -0.832426).  Saving model ...
Epoch: 12 cost time: 2.9564263820648193
Epoch: 12, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
Validation loss decreased (-0.832426 --> -0.862157).  Saving model ...
Epoch: 13 cost time: 3.0264065265655518
Epoch: 13, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.496 Vali Acc: 0.868 Test Loss: 0.496 Test Acc: 0.868
Validation loss decreased (-0.862157 --> -0.867563).  Saving model ...
Epoch: 14 cost time: 2.9702978134155273
Epoch: 14, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.468 Vali Acc: 0.868 Test Loss: 0.468 Test Acc: 0.868
Validation loss decreased (-0.867563 --> -0.867563).  Saving model ...
Epoch: 15 cost time: 2.9633541107177734
Epoch: 15, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.424 Vali Acc: 0.881 Test Loss: 0.424 Test Acc: 0.881
Validation loss decreased (-0.867563 --> -0.881077).  Saving model ...
Epoch: 16 cost time: 2.9018805027008057
Epoch: 16, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.881077 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 3.0471580028533936
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.883631706237793
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 3.0871670246124268
Epoch: 19, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.290 Vali Acc: 0.924 Test Loss: 0.290 Test Acc: 0.924
Validation loss decreased (-0.899997 --> -0.924321).  Saving model ...
Epoch: 20 cost time: 2.7361764907836914
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7805943489074707
Epoch: 21, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.241 Vali Acc: 0.924 Test Loss: 0.241 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924322).  Saving model ...
Epoch: 22 cost time: 2.8271803855895996
Epoch: 22, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.924322 --> -0.929727).  Saving model ...
Epoch: 23 cost time: 2.835874319076538
Epoch: 23, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.932 Test Loss: 0.226 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 24 cost time: 2.973950147628784
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 25 cost time: 3.1107373237609863
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 3.0739195346832275
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 2.879321575164795
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.210557460784912
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1883084774017334
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1316025257110596
Epoch: 30, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.929666757583618
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.885563373565674
Epoch: 32, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 33 cost time: 2.9728915691375732
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0535073280334473
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0261120796203613
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.127021312713623
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.3132574558258057
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.140164375305176
Epoch: 38, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 39 cost time: 3.158409357070923
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.075934648513794
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.169306755065918
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.0535993576049805
Epoch: 42, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.8744280338287354
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.8212907314300537
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.989823818206787
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.0844669342041016
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.8520760536193848
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.9086780548095703
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.251227378845215
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.198 Vali Acc: 0.141 Test Loss: 2.198 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 2.9470670223236084
Epoch: 2, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.101 Vali Acc: 0.254 Test Loss: 2.101 Test Acc: 0.254
Validation loss decreased (-0.140519 --> -0.254033).  Saving model ...
Epoch: 3 cost time: 2.9617221355438232
Epoch: 3, Steps: 17 | Train Loss: 2.031 Vali Loss: 1.974 Vali Acc: 0.424 Test Loss: 1.974 Test Acc: 0.424
Validation loss decreased (-0.254033 --> -0.424305).  Saving model ...
Epoch: 4 cost time: 2.9737844467163086
Epoch: 4, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.834 Vali Acc: 0.535 Test Loss: 1.834 Test Acc: 0.535
Validation loss decreased (-0.424305 --> -0.535117).  Saving model ...
Epoch: 5 cost time: 2.6655709743499756
Epoch: 5, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.674 Vali Acc: 0.638 Test Loss: 1.674 Test Acc: 0.638
Validation loss decreased (-0.535117 --> -0.637821).  Saving model ...
Epoch: 6 cost time: 2.630838394165039
Epoch: 6, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.500 Vali Acc: 0.673 Test Loss: 1.500 Test Acc: 0.673
Validation loss decreased (-0.637821 --> -0.672958).  Saving model ...
Epoch: 7 cost time: 2.9414191246032715
Epoch: 7, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.304 Vali Acc: 0.716 Test Loss: 1.304 Test Acc: 0.716
Validation loss decreased (-0.672958 --> -0.716203).  Saving model ...
Epoch: 8 cost time: 2.5778183937072754
Epoch: 8, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.099 Vali Acc: 0.762 Test Loss: 1.099 Test Acc: 0.762
Validation loss decreased (-0.716203 --> -0.762151).  Saving model ...
Epoch: 9 cost time: 2.842390537261963
Epoch: 9, Steps: 17 | Train Loss: 0.961 Vali Loss: 0.903 Vali Acc: 0.789 Test Loss: 0.903 Test Acc: 0.789
Validation loss decreased (-0.762151 --> -0.789180).  Saving model ...
Epoch: 10 cost time: 2.9636971950531006
Epoch: 10, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.755 Vali Acc: 0.819 Test Loss: 0.755 Test Acc: 0.819
Validation loss decreased (-0.789180 --> -0.818911).  Saving model ...
Epoch: 11 cost time: 3.0384511947631836
Epoch: 11, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.634 Vali Acc: 0.846 Test Loss: 0.634 Test Acc: 0.846
Validation loss decreased (-0.818911 --> -0.845940).  Saving model ...
Epoch: 12 cost time: 3.202087163925171
Epoch: 12, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.558 Vali Acc: 0.862 Test Loss: 0.558 Test Acc: 0.862
Validation loss decreased (-0.845940 --> -0.862157).  Saving model ...
Epoch: 13 cost time: 3.2241265773773193
Epoch: 13, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.06144380569458
Epoch: 14, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.449 Vali Acc: 0.886 Test Loss: 0.449 Test Acc: 0.886
Validation loss decreased (-0.862157 --> -0.886482).  Saving model ...
Epoch: 15 cost time: 3.122812032699585
Epoch: 15, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.409 Vali Acc: 0.892 Test Loss: 0.409 Test Acc: 0.892
Validation loss decreased (-0.886482 --> -0.891888).  Saving model ...
Epoch: 16 cost time: 3.111035108566284
Epoch: 16, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.359 Vali Acc: 0.908 Test Loss: 0.359 Test Acc: 0.908
Validation loss decreased (-0.891888 --> -0.908105).  Saving model ...
Epoch: 17 cost time: 3.086665630340576
Epoch: 17, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.323 Vali Acc: 0.914 Test Loss: 0.323 Test Acc: 0.914
Validation loss decreased (-0.908105 --> -0.913510).  Saving model ...
Epoch: 18 cost time: 3.0375616550445557
Epoch: 18, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918916).  Saving model ...
Epoch: 19 cost time: 2.7974138259887695
Epoch: 19, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.275 Vali Acc: 0.927 Test Loss: 0.275 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927024).  Saving model ...
Epoch: 20 cost time: 2.8647892475128174
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.249 Vali Acc: 0.924 Test Loss: 0.249 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0580880641937256
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929728).  Saving model ...
Epoch: 22 cost time: 2.84490704536438
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.249 Vali Acc: 0.924 Test Loss: 0.249 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9609928131103516
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.221 Vali Acc: 0.924 Test Loss: 0.221 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.929293394088745
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 25 cost time: 2.977691888809204
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 26 cost time: 2.8068134784698486
Epoch: 26, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 27 cost time: 3.1840076446533203
Epoch: 27, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 28 cost time: 2.9544825553894043
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.005229949951172
Epoch: 29, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943242).  Saving model ...
Epoch: 30 cost time: 2.7937655448913574
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.66275691986084
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.6248767375946045
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.935 Test Loss: 0.172 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.6406328678131104
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.5866940021514893
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 35 cost time: 2.475849151611328
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954053).  Saving model ...
Epoch: 36 cost time: 2.5732522010803223
Epoch: 36, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.8764572143554688
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.8459219932556152
Epoch: 38, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.0422110557556152
Epoch: 39, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.8630614280700684
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 41 cost time: 2.8266189098358154
Epoch: 41, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.9455697536468506
Epoch: 42, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 43 cost time: 2.967209815979004
Epoch: 43, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.755084753036499
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.789123773574829
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 46 cost time: 2.6231024265289307
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.746939182281494
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.829860210418701
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.70336651802063
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.856541633605957
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.0799736976623535
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.90487003326416
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.7700374126434326
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.912607192993164
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.820683240890503
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.161785125732422
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.220 Vali Acc: 0.135 Test Loss: 2.220 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 2.8404853343963623
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.131 Vali Acc: 0.241 Test Loss: 2.131 Test Acc: 0.241
Validation loss decreased (-0.135113 --> -0.240519).  Saving model ...
Epoch: 3 cost time: 2.8307204246520996
Epoch: 3, Steps: 17 | Train Loss: 2.108 Vali Loss: 2.008 Vali Acc: 0.349 Test Loss: 2.008 Test Acc: 0.349
Validation loss decreased (-0.240519 --> -0.348629).  Saving model ...
Epoch: 4 cost time: 2.9827353954315186
Epoch: 4, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.865 Vali Acc: 0.495 Test Loss: 1.865 Test Acc: 0.495
Validation loss decreased (-0.348629 --> -0.494576).  Saving model ...
Epoch: 5 cost time: 2.9133598804473877
Epoch: 5, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.691 Vali Acc: 0.611 Test Loss: 1.691 Test Acc: 0.611
Validation loss decreased (-0.494576 --> -0.610794).  Saving model ...
Epoch: 6 cost time: 3.0332748889923096
Epoch: 6, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.512 Vali Acc: 0.630 Test Loss: 1.512 Test Acc: 0.630
Validation loss decreased (-0.610794 --> -0.629715).  Saving model ...
Epoch: 7 cost time: 3.0581717491149902
Epoch: 7, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.315 Vali Acc: 0.686 Test Loss: 1.315 Test Acc: 0.686
Validation loss decreased (-0.629715 --> -0.686473).  Saving model ...
Epoch: 8 cost time: 3.190366744995117
Epoch: 8, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.112 Vali Acc: 0.705 Test Loss: 1.112 Test Acc: 0.705
Validation loss decreased (-0.686473 --> -0.705394).  Saving model ...
Epoch: 9 cost time: 3.1597416400909424
Epoch: 9, Steps: 17 | Train Loss: 0.990 Vali Loss: 0.907 Vali Acc: 0.776 Test Loss: 0.907 Test Acc: 0.776
Validation loss decreased (-0.705394 --> -0.775667).  Saving model ...
Epoch: 10 cost time: 3.220174551010132
Epoch: 10, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.770 Vali Acc: 0.792 Test Loss: 0.770 Test Acc: 0.792
Validation loss decreased (-0.775667 --> -0.791884).  Saving model ...
Epoch: 11 cost time: 3.1232550144195557
Epoch: 11, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.621 Vali Acc: 0.830 Test Loss: 0.621 Test Acc: 0.830
Validation loss decreased (-0.791884 --> -0.829724).  Saving model ...
Epoch: 12 cost time: 3.0101499557495117
Epoch: 12, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.564 Vali Acc: 0.835 Test Loss: 0.564 Test Acc: 0.835
Validation loss decreased (-0.829724 --> -0.835129).  Saving model ...
Epoch: 13 cost time: 3.026461601257324
Epoch: 13, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.487 Vali Acc: 0.868 Test Loss: 0.487 Test Acc: 0.868
Validation loss decreased (-0.835129 --> -0.867563).  Saving model ...
Epoch: 14 cost time: 2.7702081203460693
Epoch: 14, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
Validation loss decreased (-0.867563 --> -0.870266).  Saving model ...
Epoch: 15 cost time: 3.0270345211029053
Epoch: 15, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
Validation loss decreased (-0.870266 --> -0.889185).  Saving model ...
Epoch: 16 cost time: 3.0652899742126465
Epoch: 16, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.371 Vali Acc: 0.895 Test Loss: 0.371 Test Acc: 0.895
Validation loss decreased (-0.889185 --> -0.894591).  Saving model ...
Epoch: 17 cost time: 2.9262382984161377
Epoch: 17, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.306 Vali Acc: 0.924 Test Loss: 0.306 Test Acc: 0.924
Validation loss decreased (-0.894591 --> -0.924321).  Saving model ...
Epoch: 18 cost time: 3.1913890838623047
Epoch: 18, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
Validation loss decreased (-0.924321 --> -0.932430).  Saving model ...
Epoch: 19 cost time: 3.1449108123779297
Epoch: 19, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.260 Vali Acc: 0.932 Test Loss: 0.260 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2371556758880615
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 2.961298704147339
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 22 cost time: 3.215317964553833
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3622615337371826
Epoch: 23, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 24 cost time: 2.9321236610412598
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 2.9779465198516846
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 2.770167112350464
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 27 cost time: 3.1169023513793945
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 2.9271514415740967
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.362698793411255
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 3.6032938957214355
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 31 cost time: 2.7985730171203613
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9078221321105957
Epoch: 32, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.3192293643951416
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.949 Test Loss: 0.117 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.297689914703369
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 3.1156704425811768
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.06860089302063
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.125643491744995
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.0362589359283447
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.0627236366271973
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.83396053314209
Epoch: 40, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.2917404174804688
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.12235164642334
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.0789449214935303
Epoch: 43, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.294857978820801
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.109807252883911
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.207 Vali Acc: 0.168 Test Loss: 2.207 Test Acc: 0.168
Validation loss decreased (inf --> -0.167545).  Saving model ...
Epoch: 2 cost time: 2.857825994491577
Epoch: 2, Steps: 17 | Train Loss: 2.117 Vali Loss: 2.102 Vali Acc: 0.262 Test Loss: 2.102 Test Acc: 0.262
Validation loss decreased (-0.167545 --> -0.262141).  Saving model ...
Epoch: 3 cost time: 2.4901556968688965
Epoch: 3, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.954 Vali Acc: 0.446 Test Loss: 1.954 Test Acc: 0.446
Validation loss decreased (-0.262141 --> -0.445926).  Saving model ...
Epoch: 4 cost time: 2.6341755390167236
Epoch: 4, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.788 Vali Acc: 0.586 Test Loss: 1.788 Test Acc: 0.586
Validation loss decreased (-0.445926 --> -0.586469).  Saving model ...
Epoch: 5 cost time: 2.6308536529541016
Epoch: 5, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.595 Vali Acc: 0.678 Test Loss: 1.595 Test Acc: 0.678
Validation loss decreased (-0.586469 --> -0.678362).  Saving model ...
Epoch: 6 cost time: 2.520627737045288
Epoch: 6, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.405 Vali Acc: 0.714 Test Loss: 1.405 Test Acc: 0.714
Validation loss decreased (-0.678362 --> -0.713499).  Saving model ...
Epoch: 7 cost time: 2.569584369659424
Epoch: 7, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.192 Vali Acc: 0.762 Test Loss: 1.192 Test Acc: 0.762
Validation loss decreased (-0.713499 --> -0.762150).  Saving model ...
Epoch: 8 cost time: 2.581835985183716
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 0.985 Vali Acc: 0.768 Test Loss: 0.985 Test Acc: 0.768
Validation loss decreased (-0.762150 --> -0.767558).  Saving model ...
Epoch: 9 cost time: 2.729741334915161
Epoch: 9, Steps: 17 | Train Loss: 0.912 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.767558 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 2.782435894012451
Epoch: 10, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.688 Vali Acc: 0.835 Test Loss: 0.688 Test Acc: 0.835
Validation loss decreased (-0.799992 --> -0.835128).  Saving model ...
Epoch: 11 cost time: 2.7949302196502686
Epoch: 11, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.566 Vali Acc: 0.859 Test Loss: 0.566 Test Acc: 0.859
Validation loss decreased (-0.835128 --> -0.859454).  Saving model ...
Epoch: 12 cost time: 2.722306489944458
Epoch: 12, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.500 Vali Acc: 0.868 Test Loss: 0.500 Test Acc: 0.868
Validation loss decreased (-0.859454 --> -0.867563).  Saving model ...
Epoch: 13 cost time: 2.923632860183716
Epoch: 13, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.867563 --> -0.889185).  Saving model ...
Epoch: 14 cost time: 2.9608662128448486
Epoch: 14, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8903794288635254
Epoch: 15, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.364 Vali Acc: 0.905 Test Loss: 0.364 Test Acc: 0.905
Validation loss decreased (-0.889185 --> -0.905402).  Saving model ...
Epoch: 16 cost time: 2.638002395629883
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
Validation loss decreased (-0.905402 --> -0.910807).  Saving model ...
Epoch: 17 cost time: 2.662156343460083
Epoch: 17, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
Validation loss decreased (-0.910807 --> -0.910808).  Saving model ...
Epoch: 18 cost time: 2.8127968311309814
Epoch: 18, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.261 Vali Acc: 0.938 Test Loss: 0.261 Test Acc: 0.938
Validation loss decreased (-0.910808 --> -0.937835).  Saving model ...
Epoch: 19 cost time: 3.033999443054199
Epoch: 19, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8369388580322266
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 21 cost time: 2.7531933784484863
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 2.8539838790893555
Epoch: 22, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.985548973083496
Epoch: 23, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 2.87373948097229
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.831636905670166
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 2.8553895950317383
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8037803173065186
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8340492248535156
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8972089290618896
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9755966663360596
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.1016533374786377
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.9489824771881104
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.9172468185424805
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1852023601531982
Epoch: 34, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.862095832824707
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.067003011703491
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
Validation loss decreased (inf --> -0.078356).  Saving model ...
Epoch: 2 cost time: 2.7090494632720947
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.753485679626465
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8414649963378906
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.823761463165283
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7949371337890625
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.936657190322876
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0531387329101562
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1509804725646973
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.0656380653381348
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0953705310821533
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.07837837837837838
model parameter : 509577
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.041348218917847
Epoch: 1, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.061 Vali Acc: 0.270 Test Loss: 2.061 Test Acc: 0.270
Validation loss decreased (inf --> -0.270250).  Saving model ...
Epoch: 2 cost time: 3.0781795978546143
Epoch: 2, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.921 Vali Acc: 0.405 Test Loss: 1.921 Test Acc: 0.405
Validation loss decreased (-0.270250 --> -0.405386).  Saving model ...
Epoch: 3 cost time: 2.5437862873077393
Epoch: 3, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.759 Vali Acc: 0.570 Test Loss: 1.759 Test Acc: 0.570
Validation loss decreased (-0.405386 --> -0.570253).  Saving model ...
Epoch: 4 cost time: 2.7392446994781494
Epoch: 4, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.577 Vali Acc: 0.635 Test Loss: 1.577 Test Acc: 0.635
Validation loss decreased (-0.570253 --> -0.635119).  Saving model ...
Epoch: 5 cost time: 2.921431303024292
Epoch: 5, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.406 Vali Acc: 0.689 Test Loss: 1.406 Test Acc: 0.689
Validation loss decreased (-0.635119 --> -0.689175).  Saving model ...
Epoch: 6 cost time: 2.79654860496521
Epoch: 6, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.216 Vali Acc: 0.724 Test Loss: 1.216 Test Acc: 0.724
Validation loss decreased (-0.689175 --> -0.724312).  Saving model ...
Epoch: 7 cost time: 3.016918897628784
Epoch: 7, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.042 Vali Acc: 0.762 Test Loss: 1.042 Test Acc: 0.762
Validation loss decreased (-0.724312 --> -0.762152).  Saving model ...
Epoch: 8 cost time: 2.917086601257324
Epoch: 8, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.868 Vali Acc: 0.805 Test Loss: 0.868 Test Acc: 0.805
Validation loss decreased (-0.762152 --> -0.805397).  Saving model ...
Epoch: 9 cost time: 2.9314398765563965
Epoch: 9, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.714 Vali Acc: 0.838 Test Loss: 0.714 Test Acc: 0.838
Validation loss decreased (-0.805397 --> -0.837831).  Saving model ...
Epoch: 10 cost time: 3.0902438163757324
Epoch: 10, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.601 Vali Acc: 0.862 Test Loss: 0.601 Test Acc: 0.862
Validation loss decreased (-0.837831 --> -0.862156).  Saving model ...
Epoch: 11 cost time: 3.2064108848571777
Epoch: 11, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.505 Vali Acc: 0.873 Test Loss: 0.505 Test Acc: 0.873
Validation loss decreased (-0.862156 --> -0.872968).  Saving model ...
Epoch: 12 cost time: 2.926482677459717
Epoch: 12, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.445 Vali Acc: 0.881 Test Loss: 0.445 Test Acc: 0.881
Validation loss decreased (-0.872968 --> -0.881077).  Saving model ...
Epoch: 13 cost time: 2.819699287414551
Epoch: 13, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.385 Vali Acc: 0.905 Test Loss: 0.385 Test Acc: 0.905
Validation loss decreased (-0.881077 --> -0.905402).  Saving model ...
Epoch: 14 cost time: 2.7105939388275146
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.338 Vali Acc: 0.924 Test Loss: 0.338 Test Acc: 0.924
Validation loss decreased (-0.905402 --> -0.924321).  Saving model ...
Epoch: 15 cost time: 2.6572694778442383
Epoch: 15, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9933712482452393
Epoch: 16, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.883399248123169
Epoch: 17, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929727).  Saving model ...
Epoch: 18 cost time: 2.9516587257385254
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.929727 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 3.242447853088379
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 20 cost time: 3.0295393466949463
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.04841947555542
Epoch: 21, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1719515323638916
Epoch: 22, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 3.1355621814727783
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.896267890930176
Epoch: 24, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 2.811204671859741
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 3.019207239151001
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.87699031829834
Epoch: 27, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 2.9774255752563477
Epoch: 28, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.832005500793457
Epoch: 29, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.97225022315979
Epoch: 30, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.1582581996917725
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.0519955158233643
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 3.0299477577209473
Epoch: 33, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0355498790740967
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.02298641204834
Epoch: 35, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.276186943054199
Epoch: 36, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 2.9699957370758057
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 3.1745967864990234
Epoch: 38, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.868194818496704
Epoch: 39, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.0001022815704346
Epoch: 40, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.938586950302124
Epoch: 41, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.9588263034820557
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.0520083904266357
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.10029673576355
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.1158370971679688
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.8679773807525635
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.1762068271636963
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.0086376667022705
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.108 Vali Acc: 0.249 Test Loss: 2.108 Test Acc: 0.249
Validation loss decreased (inf --> -0.248628).  Saving model ...
Epoch: 2 cost time: 2.848217725753784
Epoch: 2, Steps: 17 | Train Loss: 2.117 Vali Loss: 1.995 Vali Acc: 0.403 Test Loss: 1.995 Test Acc: 0.403
Validation loss decreased (-0.248628 --> -0.402683).  Saving model ...
Epoch: 3 cost time: 2.725538969039917
Epoch: 3, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.859 Vali Acc: 0.532 Test Loss: 1.859 Test Acc: 0.532
Validation loss decreased (-0.402683 --> -0.532414).  Saving model ...
Epoch: 4 cost time: 2.9805002212524414
Epoch: 4, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.691 Vali Acc: 0.635 Test Loss: 1.691 Test Acc: 0.635
Validation loss decreased (-0.532414 --> -0.635118).  Saving model ...
Epoch: 5 cost time: 2.633115530014038
Epoch: 5, Steps: 17 | Train Loss: 1.600 Vali Loss: 1.523 Vali Acc: 0.673 Test Loss: 1.523 Test Acc: 0.673
Validation loss decreased (-0.635118 --> -0.672958).  Saving model ...
Epoch: 6 cost time: 2.83132266998291
Epoch: 6, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.328 Vali Acc: 0.708 Test Loss: 1.328 Test Acc: 0.708
Validation loss decreased (-0.672958 --> -0.708095).  Saving model ...
Epoch: 7 cost time: 2.9064254760742188
Epoch: 7, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.138 Vali Acc: 0.765 Test Loss: 1.138 Test Acc: 0.765
Validation loss decreased (-0.708095 --> -0.764853).  Saving model ...
Epoch: 8 cost time: 3.211177110671997
Epoch: 8, Steps: 17 | Train Loss: 0.975 Vali Loss: 0.954 Vali Acc: 0.781 Test Loss: 0.954 Test Acc: 0.781
Validation loss decreased (-0.764853 --> -0.781072).  Saving model ...
Epoch: 9 cost time: 2.8508822917938232
Epoch: 9, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.786 Vali Acc: 0.824 Test Loss: 0.786 Test Acc: 0.824
Validation loss decreased (-0.781072 --> -0.824316).  Saving model ...
Epoch: 10 cost time: 2.964338541030884
Epoch: 10, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.658 Vali Acc: 0.846 Test Loss: 0.658 Test Acc: 0.846
Validation loss decreased (-0.824316 --> -0.845939).  Saving model ...
Epoch: 11 cost time: 3.269608736038208
Epoch: 11, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.549 Vali Acc: 0.873 Test Loss: 0.549 Test Acc: 0.873
Validation loss decreased (-0.845939 --> -0.872967).  Saving model ...
Epoch: 12 cost time: 3.1168556213378906
Epoch: 12, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
Validation loss decreased (-0.872967 --> -0.878374).  Saving model ...
Epoch: 13 cost time: 2.777212619781494
Epoch: 13, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.417 Vali Acc: 0.892 Test Loss: 0.417 Test Acc: 0.892
Validation loss decreased (-0.878374 --> -0.891888).  Saving model ...
Epoch: 14 cost time: 2.7602479457855225
Epoch: 14, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.891888 --> -0.902699).  Saving model ...
Epoch: 15 cost time: 2.9995832443237305
Epoch: 15, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
Validation loss decreased (-0.902699 --> -0.910808).  Saving model ...
Epoch: 16 cost time: 3.0111582279205322
Epoch: 16, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.300 Vali Acc: 0.908 Test Loss: 0.300 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.008096694946289
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.277 Vali Acc: 0.914 Test Loss: 0.277 Test Acc: 0.914
Validation loss decreased (-0.910808 --> -0.913511).  Saving model ...
Epoch: 18 cost time: 2.7345473766326904
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.256 Vali Acc: 0.916 Test Loss: 0.256 Test Acc: 0.916
Validation loss decreased (-0.913511 --> -0.916214).  Saving model ...
Epoch: 19 cost time: 3.2458596229553223
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
Validation loss decreased (-0.916214 --> -0.918917).  Saving model ...
Epoch: 20 cost time: 3.1621668338775635
Epoch: 20, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
Validation loss decreased (-0.918917 --> -0.927025).  Saving model ...
Epoch: 21 cost time: 3.433988571166992
Epoch: 21, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 22 cost time: 3.374539375305176
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 23 cost time: 3.190732955932617
Epoch: 23, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6447815895080566
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 25 cost time: 3.1581075191497803
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.090482234954834
Epoch: 26, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.167 Vali Acc: 0.946 Test Loss: 0.167 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 3.134080648422241
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.258943557739258
Epoch: 28, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.334968090057373
Epoch: 29, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0588016510009766
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.3140318393707275
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.079127550125122
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 33 cost time: 3.0088627338409424
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2770094871520996
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.2674710750579834
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 36 cost time: 3.296595335006714
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 37 cost time: 3.0805180072784424
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.943 Test Loss: 0.144 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.4611196517944336
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.9320008754730225
Epoch: 39, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.914870500564575
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.827718734741211
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.943 Test Loss: 0.147 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.0536839962005615
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.321547269821167
Epoch: 43, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 44 cost time: 2.9741642475128174
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.208036422729492
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.134064197540283
Epoch: 46, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.320803642272949
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 48 cost time: 3.1175243854522705
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.1762967109680176
Epoch: 49, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.85383677482605
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.407400131225586
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.056246042251587
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.1952030658721924
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.059938430786133
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.098369836807251
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.0266964435577393
Epoch: 56, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.127861976623535
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.454272031784058
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.151 Vali Acc: 0.222 Test Loss: 2.151 Test Acc: 0.222
Validation loss decreased (inf --> -0.221600).  Saving model ...
Epoch: 2 cost time: 2.7212560176849365
Epoch: 2, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.072 Vali Acc: 0.319 Test Loss: 2.072 Test Acc: 0.319
Validation loss decreased (-0.221600 --> -0.318898).  Saving model ...
Epoch: 3 cost time: 2.750737428665161
Epoch: 3, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.975 Vali Acc: 0.414 Test Loss: 1.975 Test Acc: 0.414
Validation loss decreased (-0.318898 --> -0.413494).  Saving model ...
Epoch: 4 cost time: 2.7471847534179688
Epoch: 4, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.841 Vali Acc: 0.535 Test Loss: 1.841 Test Acc: 0.535
Validation loss decreased (-0.413494 --> -0.535117).  Saving model ...
Epoch: 5 cost time: 2.7920093536376953
Epoch: 5, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.700 Vali Acc: 0.595 Test Loss: 1.700 Test Acc: 0.595
Validation loss decreased (-0.535117 --> -0.594578).  Saving model ...
Epoch: 6 cost time: 2.7490198612213135
Epoch: 6, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.527 Vali Acc: 0.632 Test Loss: 1.527 Test Acc: 0.632
Validation loss decreased (-0.594578 --> -0.632417).  Saving model ...
Epoch: 7 cost time: 2.989224672317505
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.346 Vali Acc: 0.670 Test Loss: 1.346 Test Acc: 0.670
Validation loss decreased (-0.632417 --> -0.670257).  Saving model ...
Epoch: 8 cost time: 3.0727648735046387
Epoch: 8, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.153 Vali Acc: 0.705 Test Loss: 1.153 Test Acc: 0.705
Validation loss decreased (-0.670257 --> -0.705394).  Saving model ...
Epoch: 9 cost time: 2.994619846343994
Epoch: 9, Steps: 17 | Train Loss: 0.933 Vali Loss: 0.955 Vali Acc: 0.768 Test Loss: 0.955 Test Acc: 0.768
Validation loss decreased (-0.705394 --> -0.767558).  Saving model ...
Epoch: 10 cost time: 3.1745944023132324
Epoch: 10, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.801 Vali Acc: 0.808 Test Loss: 0.801 Test Acc: 0.808
Validation loss decreased (-0.767558 --> -0.808100).  Saving model ...
Epoch: 11 cost time: 3.0395009517669678
Epoch: 11, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.657 Vali Acc: 0.824 Test Loss: 0.657 Test Acc: 0.824
Validation loss decreased (-0.808100 --> -0.824318).  Saving model ...
Epoch: 12 cost time: 3.0187008380889893
Epoch: 12, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.563 Vali Acc: 0.835 Test Loss: 0.563 Test Acc: 0.835
Validation loss decreased (-0.824318 --> -0.835130).  Saving model ...
Epoch: 13 cost time: 3.0102968215942383
Epoch: 13, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
Validation loss decreased (-0.835130 --> -0.870265).  Saving model ...
Epoch: 14 cost time: 2.8692214488983154
Epoch: 14, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.870265 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 2.9863576889038086
Epoch: 15, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.378 Vali Acc: 0.905 Test Loss: 0.378 Test Acc: 0.905
Validation loss decreased (-0.899996 --> -0.905402).  Saving model ...
Epoch: 16 cost time: 2.948173999786377
Epoch: 16, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.342 Vali Acc: 0.914 Test Loss: 0.342 Test Acc: 0.914
Validation loss decreased (-0.905402 --> -0.913510).  Saving model ...
Epoch: 17 cost time: 3.0440785884857178
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.317 Vali Acc: 0.916 Test Loss: 0.317 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 18 cost time: 2.9639744758605957
Epoch: 18, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.282 Vali Acc: 0.924 Test Loss: 0.282 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924322).  Saving model ...
Epoch: 19 cost time: 3.2560794353485107
Epoch: 19, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
Validation loss decreased (-0.924322 --> -0.932430).  Saving model ...
Epoch: 20 cost time: 3.2489044666290283
Epoch: 20, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 21 cost time: 3.112717628479004
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 22 cost time: 3.3891208171844482
Epoch: 22, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 23 cost time: 3.0660746097564697
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.139946222305298
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.202 Vali Acc: 0.938 Test Loss: 0.202 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 25 cost time: 3.126305341720581
Epoch: 25, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 26 cost time: 2.8115386962890625
Epoch: 26, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 2.992452383041382
Epoch: 27, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8938798904418945
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.035053014755249
Epoch: 29, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 30 cost time: 2.7431464195251465
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1358094215393066
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.973876953125
Epoch: 32, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 3.1522462368011475
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.202479839324951
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 2.892317295074463
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 2.9063827991485596
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.175696849822998
Epoch: 37, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.759286642074585
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.0392906665802
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 2.944535493850708
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.0519418716430664
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.972919225692749
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.011549472808838
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 44 cost time: 3.1349260807037354
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.0444464683532715
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.0959465503692627
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.0135350227355957
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.034193277359009
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.3046908378601074
Epoch: 49, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.1157279014587402
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.0627222061157227
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.8773951530456543
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.9798126220703125
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.563333034515381
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.152 Vali Acc: 0.230 Test Loss: 2.152 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 3.120525598526001
Epoch: 2, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.084 Vali Acc: 0.286 Test Loss: 2.084 Test Acc: 0.286
Validation loss decreased (-0.229708 --> -0.286466).  Saving model ...
Epoch: 3 cost time: 2.916429042816162
Epoch: 3, Steps: 17 | Train Loss: 2.096 Vali Loss: 1.999 Vali Acc: 0.381 Test Loss: 1.999 Test Acc: 0.381
Validation loss decreased (-0.286466 --> -0.381061).  Saving model ...
Epoch: 4 cost time: 3.074909210205078
Epoch: 4, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.879 Vali Acc: 0.505 Test Loss: 1.879 Test Acc: 0.505
Validation loss decreased (-0.381061 --> -0.505387).  Saving model ...
Epoch: 5 cost time: 3.101335048675537
Epoch: 5, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.743 Vali Acc: 0.592 Test Loss: 1.743 Test Acc: 0.592
Validation loss decreased (-0.505387 --> -0.591874).  Saving model ...
Epoch: 6 cost time: 3.3129966259002686
Epoch: 6, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.572 Vali Acc: 0.668 Test Loss: 1.572 Test Acc: 0.668
Validation loss decreased (-0.591874 --> -0.667552).  Saving model ...
Epoch: 7 cost time: 2.8801796436309814
Epoch: 7, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.384 Vali Acc: 0.695 Test Loss: 1.384 Test Acc: 0.695
Validation loss decreased (-0.667552 --> -0.694581).  Saving model ...
Epoch: 8 cost time: 2.797497510910034
Epoch: 8, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.173 Vali Acc: 0.751 Test Loss: 1.173 Test Acc: 0.751
Validation loss decreased (-0.694581 --> -0.751340).  Saving model ...
Epoch: 9 cost time: 2.9788310527801514
Epoch: 9, Steps: 17 | Train Loss: 1.056 Vali Loss: 0.966 Vali Acc: 0.768 Test Loss: 0.966 Test Acc: 0.768
Validation loss decreased (-0.751340 --> -0.767558).  Saving model ...
Epoch: 10 cost time: 2.9618492126464844
Epoch: 10, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.798 Vali Acc: 0.808 Test Loss: 0.798 Test Acc: 0.808
Validation loss decreased (-0.767558 --> -0.808100).  Saving model ...
Epoch: 11 cost time: 2.7828545570373535
Epoch: 11, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.664 Vali Acc: 0.827 Test Loss: 0.664 Test Acc: 0.827
Validation loss decreased (-0.808100 --> -0.827020).  Saving model ...
Epoch: 12 cost time: 2.9801383018493652
Epoch: 12, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.568 Vali Acc: 0.851 Test Loss: 0.568 Test Acc: 0.851
Validation loss decreased (-0.827020 --> -0.851346).  Saving model ...
Epoch: 13 cost time: 3.276069164276123
Epoch: 13, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.488 Vali Acc: 0.865 Test Loss: 0.488 Test Acc: 0.865
Validation loss decreased (-0.851346 --> -0.864860).  Saving model ...
Epoch: 14 cost time: 3.1196391582489014
Epoch: 14, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.431 Vali Acc: 0.878 Test Loss: 0.431 Test Acc: 0.878
Validation loss decreased (-0.864860 --> -0.878374).  Saving model ...
Epoch: 15 cost time: 2.923079252243042
Epoch: 15, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.398 Vali Acc: 0.886 Test Loss: 0.398 Test Acc: 0.886
Validation loss decreased (-0.878374 --> -0.886483).  Saving model ...
Epoch: 16 cost time: 2.993622064590454
Epoch: 16, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.351 Vali Acc: 0.897 Test Loss: 0.351 Test Acc: 0.897
Validation loss decreased (-0.886483 --> -0.897294).  Saving model ...
Epoch: 17 cost time: 3.0918309688568115
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.315 Vali Acc: 0.908 Test Loss: 0.315 Test Acc: 0.908
Validation loss decreased (-0.897294 --> -0.908105).  Saving model ...
Epoch: 18 cost time: 2.982990264892578
Epoch: 18, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.289 Vali Acc: 0.914 Test Loss: 0.289 Test Acc: 0.914
Validation loss decreased (-0.908105 --> -0.913511).  Saving model ...
Epoch: 19 cost time: 3.173877000808716
Epoch: 19, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.913511 --> -0.918916).  Saving model ...
Epoch: 20 cost time: 3.0189812183380127
Epoch: 20, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929727).  Saving model ...
Epoch: 21 cost time: 2.993821859359741
Epoch: 21, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 22 cost time: 2.9751901626586914
Epoch: 22, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 23 cost time: 3.005305051803589
Epoch: 23, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 3.3144032955169678
Epoch: 24, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 25 cost time: 3.143315315246582
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.089902877807617
Epoch: 26, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.963268995285034
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 28 cost time: 3.0670082569122314
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 3.1827030181884766
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8223519325256348
Epoch: 30, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.1397924423217773
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.26055908203125
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.0141241550445557
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.966545343399048
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.1160123348236084
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.118018388748169
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.088125228881836
Epoch: 37, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 38 cost time: 3.0884711742401123
Epoch: 38, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.9550225734710693
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.926384210586548
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.981933832168579
Epoch: 41, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.919912576675415
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.127809762954712
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.094754934310913
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 2.6495766639709473
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.998138666152954
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1423122882843018
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.1856625080108643
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.9064793586730957
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.0543277263641357
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.1894936561584473
Epoch: 51, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.0407421588897705
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.7076940536499023
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.9933812618255615
Epoch: 54, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.4519267082214355
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.112 Vali Acc: 0.197 Test Loss: 2.112 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 2.875389575958252
Epoch: 2, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.050 Vali Acc: 0.265 Test Loss: 2.050 Test Acc: 0.265
Validation loss decreased (-0.197276 --> -0.264844).  Saving model ...
Epoch: 3 cost time: 2.992643356323242
Epoch: 3, Steps: 17 | Train Loss: 2.127 Vali Loss: 1.964 Vali Acc: 0.414 Test Loss: 1.964 Test Acc: 0.414
Validation loss decreased (-0.264844 --> -0.413494).  Saving model ...
Epoch: 4 cost time: 2.9847514629364014
Epoch: 4, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.842 Vali Acc: 0.557 Test Loss: 1.842 Test Acc: 0.557
Validation loss decreased (-0.413494 --> -0.556738).  Saving model ...
Epoch: 5 cost time: 3.0620670318603516
Epoch: 5, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.705 Vali Acc: 0.627 Test Loss: 1.705 Test Acc: 0.627
Validation loss decreased (-0.556738 --> -0.627010).  Saving model ...
Epoch: 6 cost time: 2.9533417224884033
Epoch: 6, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.530 Vali Acc: 0.711 Test Loss: 1.530 Test Acc: 0.711
Validation loss decreased (-0.627010 --> -0.710796).  Saving model ...
Epoch: 7 cost time: 2.849871873855591
Epoch: 7, Steps: 17 | Train Loss: 1.600 Vali Loss: 1.342 Vali Acc: 0.705 Test Loss: 1.342 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2354302406311035
Epoch: 8, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.149 Vali Acc: 0.719 Test Loss: 1.149 Test Acc: 0.719
Validation loss decreased (-0.710796 --> -0.718907).  Saving model ...
Epoch: 9 cost time: 2.8797202110290527
Epoch: 9, Steps: 17 | Train Loss: 1.085 Vali Loss: 0.948 Vali Acc: 0.746 Test Loss: 0.948 Test Acc: 0.746
Validation loss decreased (-0.718907 --> -0.745936).  Saving model ...
Epoch: 10 cost time: 2.7891719341278076
Epoch: 10, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.754 Vali Acc: 0.819 Test Loss: 0.754 Test Acc: 0.819
Validation loss decreased (-0.745936 --> -0.818911).  Saving model ...
Epoch: 11 cost time: 2.8086085319519043
Epoch: 11, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.615 Vali Acc: 0.851 Test Loss: 0.615 Test Acc: 0.851
Validation loss decreased (-0.818911 --> -0.851345).  Saving model ...
Epoch: 12 cost time: 3.355454683303833
Epoch: 12, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.516 Vali Acc: 0.857 Test Loss: 0.516 Test Acc: 0.857
Validation loss decreased (-0.851345 --> -0.856752).  Saving model ...
Epoch: 13 cost time: 3.3691182136535645
Epoch: 13, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
Validation loss decreased (-0.856752 --> -0.918915).  Saving model ...
Epoch: 14 cost time: 3.455286979675293
Epoch: 14, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.360 Vali Acc: 0.905 Test Loss: 0.360 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3353865146636963
Epoch: 15, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 16 cost time: 2.94677734375
Epoch: 16, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (-0.921618 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 3.279137134552002
Epoch: 17, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.073200225830078
Epoch: 18, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.952983856201172
Epoch: 19, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.857553482055664
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
Validation loss decreased (-0.943241 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 2.918008804321289
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.985671043395996
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.774746894836426
Epoch: 23, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8460843563079834
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8522980213165283
Epoch: 25, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.8246419429779053
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.854750394821167
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.8823633193969727
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.949110746383667
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.7141807079315186
Epoch: 30, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7071621417999268
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.132 Vali Acc: 0.224 Test Loss: 2.132 Test Acc: 0.224
Validation loss decreased (inf --> -0.224303).  Saving model ...
Epoch: 2 cost time: 2.6251003742218018
Epoch: 2, Steps: 17 | Train Loss: 2.138 Vali Loss: 2.059 Vali Acc: 0.297 Test Loss: 2.059 Test Acc: 0.297
Validation loss decreased (-0.224303 --> -0.297277).  Saving model ...
Epoch: 3 cost time: 2.7211902141571045
Epoch: 3, Steps: 17 | Train Loss: 2.098 Vali Loss: 1.959 Vali Acc: 0.430 Test Loss: 1.959 Test Acc: 0.430
Validation loss decreased (-0.297277 --> -0.429710).  Saving model ...
Epoch: 4 cost time: 2.9587137699127197
Epoch: 4, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.820 Vali Acc: 0.608 Test Loss: 1.820 Test Acc: 0.608
Validation loss decreased (-0.429710 --> -0.608090).  Saving model ...
Epoch: 5 cost time: 2.962656021118164
Epoch: 5, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.667 Vali Acc: 0.703 Test Loss: 1.667 Test Acc: 0.703
Validation loss decreased (-0.608090 --> -0.702686).  Saving model ...
Epoch: 6 cost time: 2.9603970050811768
Epoch: 6, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.478 Vali Acc: 0.757 Test Loss: 1.478 Test Acc: 0.757
Validation loss decreased (-0.702686 --> -0.756742).  Saving model ...
Epoch: 7 cost time: 2.9111740589141846
Epoch: 7, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.282 Vali Acc: 0.754 Test Loss: 1.282 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9774937629699707
Epoch: 8, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.093 Vali Acc: 0.751 Test Loss: 1.093 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.83974552154541
Epoch: 9, Steps: 17 | Train Loss: 1.048 Vali Loss: 0.914 Vali Acc: 0.773 Test Loss: 0.914 Test Acc: 0.773
Validation loss decreased (-0.756742 --> -0.772964).  Saving model ...
Epoch: 10 cost time: 2.931428909301758
Epoch: 10, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.758 Vali Acc: 0.811 Test Loss: 0.758 Test Acc: 0.811
Validation loss decreased (-0.772964 --> -0.810803).  Saving model ...
Epoch: 11 cost time: 2.758455514907837
Epoch: 11, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.644 Vali Acc: 0.824 Test Loss: 0.644 Test Acc: 0.824
Validation loss decreased (-0.810803 --> -0.824318).  Saving model ...
Epoch: 12 cost time: 2.732544183731079
Epoch: 12, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.558 Vali Acc: 0.843 Test Loss: 0.558 Test Acc: 0.843
Validation loss decreased (-0.824318 --> -0.843238).  Saving model ...
Epoch: 13 cost time: 2.623690366744995
Epoch: 13, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.467 Vali Acc: 0.884 Test Loss: 0.467 Test Acc: 0.884
Validation loss decreased (-0.843238 --> -0.883779).  Saving model ...
Epoch: 14 cost time: 2.8427131175994873
Epoch: 14, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
Validation loss decreased (-0.883779 --> -0.883779).  Saving model ...
Epoch: 15 cost time: 2.9426355361938477
Epoch: 15, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.406 Vali Acc: 0.892 Test Loss: 0.406 Test Acc: 0.892
Validation loss decreased (-0.883779 --> -0.891888).  Saving model ...
Epoch: 16 cost time: 2.8375632762908936
Epoch: 16, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.342 Vali Acc: 0.905 Test Loss: 0.342 Test Acc: 0.905
Validation loss decreased (-0.891888 --> -0.905402).  Saving model ...
Epoch: 17 cost time: 2.9472498893737793
Epoch: 17, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.905402 --> -0.918916).  Saving model ...
Epoch: 18 cost time: 2.9438090324401855
Epoch: 18, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.291 Vali Acc: 0.924 Test Loss: 0.291 Test Acc: 0.924
Validation loss decreased (-0.918916 --> -0.924321).  Saving model ...
Epoch: 19 cost time: 3.024055004119873
Epoch: 19, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8567652702331543
Epoch: 20, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
Validation loss decreased (-0.924321 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 2.8923680782318115
Epoch: 21, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.239 Vali Acc: 0.927 Test Loss: 0.239 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1055924892425537
Epoch: 22, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.770565986633301
Epoch: 23, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 2.7790260314941406
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.650169849395752
Epoch: 25, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 2.789201498031616
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.688542127609253
Epoch: 27, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 28 cost time: 2.646026372909546
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 2.746748924255371
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8341519832611084
Epoch: 30, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.852543592453003
Epoch: 31, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 3.0059008598327637
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.773542881011963
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.9724037647247314
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.9600367546081543
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.047513723373413
Epoch: 36, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.7277214527130127
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.047393798828125
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.79687762260437
Epoch: 39, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.939727783203125
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.938044786453247
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.828788757324219
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
Validation loss decreased (inf --> -0.078356).  Saving model ...
Epoch: 2 cost time: 3.1991679668426514
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.20343017578125
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1830642223358154
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9777956008911133
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8508737087249756
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.737499237060547
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8004989624023438
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8528943061828613
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.801309108734131
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.807255268096924
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.195 Vali Acc: 0.078 Test Loss: 2.195 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.07837837837837838
model parameter : 312969
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.351557016372681
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.113 Vali Acc: 0.243 Test Loss: 2.113 Test Acc: 0.243
Validation loss decreased (inf --> -0.243222).  Saving model ...
Epoch: 2 cost time: 3.1407759189605713
Epoch: 2, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.966 Vali Acc: 0.405 Test Loss: 1.966 Test Acc: 0.405
Validation loss decreased (-0.243222 --> -0.405386).  Saving model ...
Epoch: 3 cost time: 2.876314163208008
Epoch: 3, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.806 Vali Acc: 0.559 Test Loss: 1.806 Test Acc: 0.559
Validation loss decreased (-0.405386 --> -0.559441).  Saving model ...
Epoch: 4 cost time: 3.0241663455963135
Epoch: 4, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.622 Vali Acc: 0.627 Test Loss: 1.622 Test Acc: 0.627
Validation loss decreased (-0.559441 --> -0.627011).  Saving model ...
Epoch: 5 cost time: 2.862245798110962
Epoch: 5, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.458 Vali Acc: 0.657 Test Loss: 1.458 Test Acc: 0.657
Validation loss decreased (-0.627011 --> -0.656742).  Saving model ...
Epoch: 6 cost time: 3.0370700359344482
Epoch: 6, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.287 Vali Acc: 0.695 Test Loss: 1.287 Test Acc: 0.695
Validation loss decreased (-0.656742 --> -0.694582).  Saving model ...
Epoch: 7 cost time: 2.7534589767456055
Epoch: 7, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.106 Vali Acc: 0.738 Test Loss: 1.106 Test Acc: 0.738
Validation loss decreased (-0.694582 --> -0.737827).  Saving model ...
Epoch: 8 cost time: 2.6872081756591797
Epoch: 8, Steps: 17 | Train Loss: 0.945 Vali Loss: 0.946 Vali Acc: 0.765 Test Loss: 0.946 Test Acc: 0.765
Validation loss decreased (-0.737827 --> -0.764855).  Saving model ...
Epoch: 9 cost time: 2.9187493324279785
Epoch: 9, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.792 Vali Acc: 0.808 Test Loss: 0.792 Test Acc: 0.808
Validation loss decreased (-0.764855 --> -0.808100).  Saving model ...
Epoch: 10 cost time: 2.960033893585205
Epoch: 10, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.666 Vali Acc: 0.830 Test Loss: 0.666 Test Acc: 0.830
Validation loss decreased (-0.808100 --> -0.829723).  Saving model ...
Epoch: 11 cost time: 2.8448450565338135
Epoch: 11, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.578 Vali Acc: 0.843 Test Loss: 0.578 Test Acc: 0.843
Validation loss decreased (-0.829723 --> -0.843237).  Saving model ...
Epoch: 12 cost time: 2.9257378578186035
Epoch: 12, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
Validation loss decreased (-0.843237 --> -0.859454).  Saving model ...
Epoch: 13 cost time: 3.050750494003296
Epoch: 13, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.438 Vali Acc: 0.886 Test Loss: 0.438 Test Acc: 0.886
Validation loss decreased (-0.859454 --> -0.886482).  Saving model ...
Epoch: 14 cost time: 2.8764700889587402
Epoch: 14, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
Validation loss decreased (-0.886482 --> -0.902699).  Saving model ...
Epoch: 15 cost time: 3.026533603668213
Epoch: 15, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.347 Vali Acc: 0.908 Test Loss: 0.347 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 16 cost time: 3.0441956520080566
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9895360469818115
Epoch: 17, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.290 Vali Acc: 0.905 Test Loss: 0.290 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6957337856292725
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.908105 --> -0.910808).  Saving model ...
Epoch: 19 cost time: 2.866868495941162
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.246 Vali Acc: 0.916 Test Loss: 0.246 Test Acc: 0.916
Validation loss decreased (-0.910808 --> -0.916214).  Saving model ...
Epoch: 20 cost time: 2.8505704402923584
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.238 Vali Acc: 0.914 Test Loss: 0.238 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.208254098892212
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
Validation loss decreased (-0.916214 --> -0.932430).  Saving model ...
Epoch: 22 cost time: 2.8737401962280273
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 23 cost time: 2.945002555847168
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.199 Vali Acc: 0.927 Test Loss: 0.199 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.330979108810425
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.391479015350342
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 26 cost time: 3.0847525596618652
Epoch: 26, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 27 cost time: 3.187995195388794
Epoch: 27, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 28 cost time: 3.6800856590270996
Epoch: 28, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 3.183938980102539
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 30 cost time: 3.158398151397705
Epoch: 30, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.903646230697632
Epoch: 31, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.879669427871704
Epoch: 32, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 33 cost time: 2.6821951866149902
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 3.0082240104675293
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 35 cost time: 2.9080331325531006
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.214710235595703
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.2250051498413086
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 3.1155900955200195
Epoch: 38, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 39 cost time: 3.0409131050109863
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3372113704681396
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.2118849754333496
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.9729020595550537
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.1485579013824463
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.7861030101776123
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 2.844259023666382
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.044337749481201
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.16797137260437
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.2538981437683105
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.2081618309020996
Epoch: 49, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.160092830657959
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.1198313236236572
Epoch: 51, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.3639400005340576
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.9857964515686035
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.855292797088623
Epoch: 54, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.261298418045044
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.164 Vali Acc: 0.173 Test Loss: 2.164 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 3.1014204025268555
Epoch: 2, Steps: 17 | Train Loss: 2.104 Vali Loss: 2.045 Vali Acc: 0.357 Test Loss: 2.045 Test Acc: 0.357
Validation loss decreased (-0.172951 --> -0.356736).  Saving model ...
Epoch: 3 cost time: 2.9280903339385986
Epoch: 3, Steps: 17 | Train Loss: 1.952 Vali Loss: 1.906 Vali Acc: 0.514 Test Loss: 1.906 Test Acc: 0.514
Validation loss decreased (-0.356736 --> -0.513494).  Saving model ...
Epoch: 4 cost time: 3.2748472690582275
Epoch: 4, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.739 Vali Acc: 0.643 Test Loss: 1.739 Test Acc: 0.643
Validation loss decreased (-0.513494 --> -0.643226).  Saving model ...
Epoch: 5 cost time: 3.066051721572876
Epoch: 5, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.579 Vali Acc: 0.670 Test Loss: 1.579 Test Acc: 0.670
Validation loss decreased (-0.643226 --> -0.670254).  Saving model ...
Epoch: 6 cost time: 3.266845703125
Epoch: 6, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.404 Vali Acc: 0.692 Test Loss: 1.404 Test Acc: 0.692
Validation loss decreased (-0.670254 --> -0.691878).  Saving model ...
Epoch: 7 cost time: 3.1445224285125732
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.207 Vali Acc: 0.722 Test Loss: 1.207 Test Acc: 0.722
Validation loss decreased (-0.691878 --> -0.721610).  Saving model ...
Epoch: 8 cost time: 3.213406562805176
Epoch: 8, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.030 Vali Acc: 0.749 Test Loss: 1.030 Test Acc: 0.749
Validation loss decreased (-0.721610 --> -0.748638).  Saving model ...
Epoch: 9 cost time: 2.8628554344177246
Epoch: 9, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.864 Vali Acc: 0.786 Test Loss: 0.864 Test Acc: 0.786
Validation loss decreased (-0.748638 --> -0.786478).  Saving model ...
Epoch: 10 cost time: 2.607414960861206
Epoch: 10, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.726 Vali Acc: 0.819 Test Loss: 0.726 Test Acc: 0.819
Validation loss decreased (-0.786478 --> -0.818912).  Saving model ...
Epoch: 11 cost time: 2.8623147010803223
Epoch: 11, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.818912 --> -0.821615).  Saving model ...
Epoch: 12 cost time: 3.1408369541168213
Epoch: 12, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.549 Vali Acc: 0.846 Test Loss: 0.549 Test Acc: 0.846
Validation loss decreased (-0.821615 --> -0.845940).  Saving model ...
Epoch: 13 cost time: 2.938997983932495
Epoch: 13, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.482 Vali Acc: 0.876 Test Loss: 0.482 Test Acc: 0.876
Validation loss decreased (-0.845940 --> -0.875671).  Saving model ...
Epoch: 14 cost time: 2.835937023162842
Epoch: 14, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.425 Vali Acc: 0.886 Test Loss: 0.425 Test Acc: 0.886
Validation loss decreased (-0.875671 --> -0.886482).  Saving model ...
Epoch: 15 cost time: 3.1040830612182617
Epoch: 15, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.386 Vali Acc: 0.886 Test Loss: 0.386 Test Acc: 0.886
Validation loss decreased (-0.886482 --> -0.886483).  Saving model ...
Epoch: 16 cost time: 2.9802732467651367
Epoch: 16, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.356 Vali Acc: 0.905 Test Loss: 0.356 Test Acc: 0.905
Validation loss decreased (-0.886483 --> -0.905402).  Saving model ...
Epoch: 17 cost time: 3.1123173236846924
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (-0.905402 --> -0.910808).  Saving model ...
Epoch: 18 cost time: 3.626262903213501
Epoch: 18, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.287 Vali Acc: 0.916 Test Loss: 0.287 Test Acc: 0.916
Validation loss decreased (-0.910808 --> -0.916213).  Saving model ...
Epoch: 19 cost time: 3.0858676433563232
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.272 Vali Acc: 0.914 Test Loss: 0.272 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.901726484298706
Epoch: 20, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.258 Vali Acc: 0.924 Test Loss: 0.258 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924322).  Saving model ...
Epoch: 21 cost time: 2.8331713676452637
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.924322 --> -0.935133).  Saving model ...
Epoch: 22 cost time: 2.9614744186401367
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 23 cost time: 3.023710012435913
Epoch: 23, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 24 cost time: 2.932802200317383
Epoch: 24, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.030398368835449
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 26 cost time: 3.2831742763519287
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 27 cost time: 3.464738368988037
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.252284288406372
Epoch: 28, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 29 cost time: 3.410886287689209
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 30 cost time: 3.0461814403533936
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 31 cost time: 3.099255323410034
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 32 cost time: 3.134390354156494
Epoch: 32, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.9946863651275635
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.047325849533081
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 35 cost time: 3.0514848232269287
Epoch: 35, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1096034049987793
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.3556063175201416
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.12977933883667
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.2118465900421143
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.0690598487854004
Epoch: 40, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.192528009414673
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.322481155395508
Epoch: 42, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.1024394035339355
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.5629777908325195
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.634152412414551
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.190 Vali Acc: 0.151 Test Loss: 2.190 Test Acc: 0.151
Validation loss decreased (inf --> -0.151329).  Saving model ...
Epoch: 2 cost time: 2.7673559188842773
Epoch: 2, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.106 Vali Acc: 0.235 Test Loss: 2.106 Test Acc: 0.235
Validation loss decreased (-0.151329 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 2.8887622356414795
Epoch: 3, Steps: 17 | Train Loss: 2.020 Vali Loss: 2.004 Vali Acc: 0.381 Test Loss: 2.004 Test Acc: 0.381
Validation loss decreased (-0.235114 --> -0.381061).  Saving model ...
Epoch: 4 cost time: 2.6609065532684326
Epoch: 4, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.872 Vali Acc: 0.549 Test Loss: 1.872 Test Acc: 0.549
Validation loss decreased (-0.381061 --> -0.548630).  Saving model ...
Epoch: 5 cost time: 2.739361524581909
Epoch: 5, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.740 Vali Acc: 0.592 Test Loss: 1.740 Test Acc: 0.592
Validation loss decreased (-0.548630 --> -0.591874).  Saving model ...
Epoch: 6 cost time: 2.4532132148742676
Epoch: 6, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.580 Vali Acc: 0.665 Test Loss: 1.580 Test Acc: 0.665
Validation loss decreased (-0.591874 --> -0.664849).  Saving model ...
Epoch: 7 cost time: 2.7115330696105957
Epoch: 7, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.389 Vali Acc: 0.689 Test Loss: 1.389 Test Acc: 0.689
Validation loss decreased (-0.664849 --> -0.689175).  Saving model ...
Epoch: 8 cost time: 2.866644859313965
Epoch: 8, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.209 Vali Acc: 0.714 Test Loss: 1.209 Test Acc: 0.714
Validation loss decreased (-0.689175 --> -0.713501).  Saving model ...
Epoch: 9 cost time: 2.9632740020751953
Epoch: 9, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.031 Vali Acc: 0.768 Test Loss: 1.031 Test Acc: 0.768
Validation loss decreased (-0.713501 --> -0.767557).  Saving model ...
Epoch: 10 cost time: 2.9614315032958984
Epoch: 10, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.874 Vali Acc: 0.786 Test Loss: 0.874 Test Acc: 0.786
Validation loss decreased (-0.767557 --> -0.786478).  Saving model ...
Epoch: 11 cost time: 2.9207589626312256
Epoch: 11, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.756 Vali Acc: 0.805 Test Loss: 0.756 Test Acc: 0.805
Validation loss decreased (-0.786478 --> -0.805398).  Saving model ...
Epoch: 12 cost time: 3.0741870403289795
Epoch: 12, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.643 Vali Acc: 0.835 Test Loss: 0.643 Test Acc: 0.835
Validation loss decreased (-0.805398 --> -0.835129).  Saving model ...
Epoch: 13 cost time: 2.934325933456421
Epoch: 13, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
Validation loss decreased (-0.835129 --> -0.859454).  Saving model ...
Epoch: 14 cost time: 3.1728413105010986
Epoch: 14, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859454 --> -0.859455).  Saving model ...
Epoch: 15 cost time: 3.0767931938171387
Epoch: 15, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.426 Vali Acc: 0.873 Test Loss: 0.426 Test Acc: 0.873
Validation loss decreased (-0.859455 --> -0.872969).  Saving model ...
Epoch: 16 cost time: 3.119649887084961
Epoch: 16, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
Validation loss decreased (-0.872969 --> -0.889185).  Saving model ...
Epoch: 17 cost time: 3.091726541519165
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.338 Vali Acc: 0.908 Test Loss: 0.338 Test Acc: 0.908
Validation loss decreased (-0.889185 --> -0.908105).  Saving model ...
Epoch: 18 cost time: 3.2692036628723145
Epoch: 18, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.289 Vali Acc: 0.927 Test Loss: 0.289 Test Acc: 0.927
Validation loss decreased (-0.908105 --> -0.927024).  Saving model ...
Epoch: 19 cost time: 3.311232805252075
Epoch: 19, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.268 Vali Acc: 0.924 Test Loss: 0.268 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.008234977722168
Epoch: 20, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8398265838623047
Epoch: 21, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 2.993896961212158
Epoch: 22, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 2.942765235900879
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.866100549697876
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 2.7868499755859375
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 2.786447763442993
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 2.898589611053467
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 28 cost time: 2.9722273349761963
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 2.9403040409088135
Epoch: 29, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.846506118774414
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 31 cost time: 3.234592914581299
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9621219635009766
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.918670892715454
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.6678974628448486
Epoch: 34, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.699235200881958
Epoch: 35, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.6102454662323
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.9333655834198
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.854961633682251
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 39 cost time: 2.925743579864502
Epoch: 39, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.96479868888855
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.08587384223938
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.3693015575408936
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 43 cost time: 2.9959282875061035
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.1216256618499756
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.0022780895233154
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.9572715759277344
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1375246047973633
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.8160829544067383
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.7744221687316895
Epoch: 49, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.072234869003296
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.9099955558776855
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.9523279666900635
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.3515565395355225
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.206 Vali Acc: 0.119 Test Loss: 2.206 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 3.0167222023010254
Epoch: 2, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.131 Vali Acc: 0.159 Test Loss: 2.131 Test Acc: 0.159
Validation loss decreased (-0.118897 --> -0.159438).  Saving model ...
Epoch: 3 cost time: 3.0656280517578125
Epoch: 3, Steps: 17 | Train Loss: 2.057 Vali Loss: 2.038 Vali Acc: 0.249 Test Loss: 2.038 Test Acc: 0.249
Validation loss decreased (-0.159438 --> -0.248628).  Saving model ...
Epoch: 4 cost time: 3.1134181022644043
Epoch: 4, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.913 Vali Acc: 0.435 Test Loss: 1.913 Test Acc: 0.435
Validation loss decreased (-0.248628 --> -0.435116).  Saving model ...
Epoch: 5 cost time: 3.0126094818115234
Epoch: 5, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.783 Vali Acc: 0.535 Test Loss: 1.783 Test Acc: 0.535
Validation loss decreased (-0.435116 --> -0.535117).  Saving model ...
Epoch: 6 cost time: 2.9234442710876465
Epoch: 6, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.619 Vali Acc: 0.654 Test Loss: 1.619 Test Acc: 0.654
Validation loss decreased (-0.535117 --> -0.654038).  Saving model ...
Epoch: 7 cost time: 2.692166328430176
Epoch: 7, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.417 Vali Acc: 0.705 Test Loss: 1.417 Test Acc: 0.705
Validation loss decreased (-0.654038 --> -0.705391).  Saving model ...
Epoch: 8 cost time: 2.543915033340454
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.220 Vali Acc: 0.730 Test Loss: 1.220 Test Acc: 0.730
Validation loss decreased (-0.705391 --> -0.729718).  Saving model ...
Epoch: 9 cost time: 3.0020828247070312
Epoch: 9, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.016 Vali Acc: 0.754 Test Loss: 1.016 Test Acc: 0.754
Validation loss decreased (-0.729718 --> -0.754044).  Saving model ...
Epoch: 10 cost time: 2.8085246086120605
Epoch: 10, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.828 Vali Acc: 0.786 Test Loss: 0.828 Test Acc: 0.786
Validation loss decreased (-0.754044 --> -0.786478).  Saving model ...
Epoch: 11 cost time: 3.1858365535736084
Epoch: 11, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.697 Vali Acc: 0.814 Test Loss: 0.697 Test Acc: 0.814
Validation loss decreased (-0.786478 --> -0.813507).  Saving model ...
Epoch: 12 cost time: 3.1477553844451904
Epoch: 12, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.581 Vali Acc: 0.846 Test Loss: 0.581 Test Acc: 0.846
Validation loss decreased (-0.813507 --> -0.845940).  Saving model ...
Epoch: 13 cost time: 3.0093302726745605
Epoch: 13, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.497 Vali Acc: 0.876 Test Loss: 0.497 Test Acc: 0.876
Validation loss decreased (-0.845940 --> -0.875671).  Saving model ...
Epoch: 14 cost time: 3.253582715988159
Epoch: 14, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.441 Vali Acc: 0.878 Test Loss: 0.441 Test Acc: 0.878
Validation loss decreased (-0.875671 --> -0.878374).  Saving model ...
Epoch: 15 cost time: 3.106513500213623
Epoch: 15, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.394 Vali Acc: 0.892 Test Loss: 0.394 Test Acc: 0.892
Validation loss decreased (-0.878374 --> -0.891888).  Saving model ...
Epoch: 16 cost time: 3.250054121017456
Epoch: 16, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.347 Vali Acc: 0.914 Test Loss: 0.347 Test Acc: 0.914
Validation loss decreased (-0.891888 --> -0.913510).  Saving model ...
Epoch: 17 cost time: 3.0655224323272705
Epoch: 17, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.317 Vali Acc: 0.916 Test Loss: 0.317 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 18 cost time: 2.9717087745666504
Epoch: 18, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 19 cost time: 3.1238791942596436
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.263 Vali Acc: 0.924 Test Loss: 0.263 Test Acc: 0.924
Validation loss decreased (-0.921619 --> -0.924322).  Saving model ...
Epoch: 20 cost time: 3.161179304122925
Epoch: 20, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.240 Vali Acc: 0.927 Test Loss: 0.240 Test Acc: 0.927
Validation loss decreased (-0.924322 --> -0.927025).  Saving model ...
Epoch: 21 cost time: 3.1623165607452393
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 22 cost time: 3.2302815914154053
Epoch: 22, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 23 cost time: 3.3462300300598145
Epoch: 23, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3380627632141113
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2913475036621094
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 26 cost time: 3.430732488632202
Epoch: 26, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5283920764923096
Epoch: 27, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 28 cost time: 3.353921413421631
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 3.144538640975952
Epoch: 29, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 3.3861944675445557
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.174112319946289
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 32 cost time: 3.2734086513519287
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1248011589050293
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.194249391555786
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.932 Test Loss: 0.184 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.353191375732422
Epoch: 35, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.335230827331543
Epoch: 36, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 37 cost time: 3.4524528980255127
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.174712896347046
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 39 cost time: 3.306072950363159
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.9250402450561523
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.141160249710083
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.158038854598999
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.1060023307800293
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 44 cost time: 2.804333448410034
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.992619276046753
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.060246229171753
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 47 cost time: 3.2382187843322754
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 48 cost time: 3.0912768840789795
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.1861720085144043
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2139933109283447
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.291682004928589
Epoch: 51, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.0763721466064453
Epoch: 52, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.022160053253174
Epoch: 53, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.009310245513916
Epoch: 54, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.8311309814453125
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.908395290374756
Epoch: 56, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.0573134422302246
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.5391151905059814
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.177 Vali Acc: 0.151 Test Loss: 2.177 Test Acc: 0.151
Validation loss decreased (inf --> -0.151330).  Saving model ...
Epoch: 2 cost time: 3.076202869415283
Epoch: 2, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.103 Vali Acc: 0.208 Test Loss: 2.103 Test Acc: 0.208
Validation loss decreased (-0.151330 --> -0.208087).  Saving model ...
Epoch: 3 cost time: 3.137307643890381
Epoch: 3, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.003 Vali Acc: 0.338 Test Loss: 2.003 Test Acc: 0.338
Validation loss decreased (-0.208087 --> -0.337818).  Saving model ...
Epoch: 4 cost time: 3.534149408340454
Epoch: 4, Steps: 17 | Train Loss: 1.993 Vali Loss: 1.867 Vali Acc: 0.486 Test Loss: 1.867 Test Acc: 0.486
Validation loss decreased (-0.337818 --> -0.486468).  Saving model ...
Epoch: 5 cost time: 2.869270086288452
Epoch: 5, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.720 Vali Acc: 0.616 Test Loss: 1.720 Test Acc: 0.616
Validation loss decreased (-0.486468 --> -0.616199).  Saving model ...
Epoch: 6 cost time: 2.837505578994751
Epoch: 6, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.550 Vali Acc: 0.657 Test Loss: 1.550 Test Acc: 0.657
Validation loss decreased (-0.616199 --> -0.656741).  Saving model ...
Epoch: 7 cost time: 2.720256805419922
Epoch: 7, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.364 Vali Acc: 0.719 Test Loss: 1.364 Test Acc: 0.719
Validation loss decreased (-0.656741 --> -0.718905).  Saving model ...
Epoch: 8 cost time: 3.0566582679748535
Epoch: 8, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.195 Vali Acc: 0.735 Test Loss: 1.195 Test Acc: 0.735
Validation loss decreased (-0.718905 --> -0.735123).  Saving model ...
Epoch: 9 cost time: 2.7818334102630615
Epoch: 9, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.003 Vali Acc: 0.759 Test Loss: 1.003 Test Acc: 0.759
Validation loss decreased (-0.735123 --> -0.759449).  Saving model ...
Epoch: 10 cost time: 2.749840021133423
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.811 Vali Acc: 0.789 Test Loss: 0.811 Test Acc: 0.789
Validation loss decreased (-0.759449 --> -0.789181).  Saving model ...
Epoch: 11 cost time: 3.169138193130493
Epoch: 11, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.652 Vali Acc: 0.830 Test Loss: 0.652 Test Acc: 0.830
Validation loss decreased (-0.789181 --> -0.829723).  Saving model ...
Epoch: 12 cost time: 3.0045418739318848
Epoch: 12, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.527 Vali Acc: 0.886 Test Loss: 0.527 Test Acc: 0.886
Validation loss decreased (-0.829723 --> -0.886481).  Saving model ...
Epoch: 13 cost time: 3.0180938243865967
Epoch: 13, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.434 Vali Acc: 0.914 Test Loss: 0.434 Test Acc: 0.914
Validation loss decreased (-0.886481 --> -0.913509).  Saving model ...
Epoch: 14 cost time: 3.021374464035034
Epoch: 14, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.378 Vali Acc: 0.919 Test Loss: 0.378 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 15 cost time: 3.1404333114624023
Epoch: 15, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 16 cost time: 3.0610556602478027
Epoch: 16, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921619).  Saving model ...
Epoch: 17 cost time: 2.890256881713867
Epoch: 17, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927024).  Saving model ...
Epoch: 18 cost time: 2.8953683376312256
Epoch: 18, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 19 cost time: 2.764523983001709
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 20 cost time: 2.9325690269470215
Epoch: 20, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.211 Vali Acc: 0.927 Test Loss: 0.211 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9438226222991943
Epoch: 21, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 22 cost time: 3.0988242626190186
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 3.3754942417144775
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.185 Vali Acc: 0.932 Test Loss: 0.185 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.207329750061035
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1221847534179688
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 3.0860397815704346
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2947282791137695
Epoch: 27, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1572749614715576
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.159 Vali Acc: 0.935 Test Loss: 0.159 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2185771465301514
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9852874279022217
Epoch: 30, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.9120357036590576
Epoch: 31, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.078875780105591
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.1879665851593018
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.935 Test Loss: 0.167 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.924384593963623
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2251152992248535
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.687219142913818
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.230 Vali Acc: 0.141 Test Loss: 2.230 Test Acc: 0.141
Validation loss decreased (inf --> -0.140518).  Saving model ...
Epoch: 2 cost time: 3.3666598796844482
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.146 Vali Acc: 0.222 Test Loss: 2.146 Test Acc: 0.222
Validation loss decreased (-0.140518 --> -0.221600).  Saving model ...
Epoch: 3 cost time: 2.929516553878784
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 2.034 Vali Acc: 0.341 Test Loss: 2.034 Test Acc: 0.341
Validation loss decreased (-0.221600 --> -0.340520).  Saving model ...
Epoch: 4 cost time: 2.7354366779327393
Epoch: 4, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.882 Vali Acc: 0.495 Test Loss: 1.882 Test Acc: 0.495
Validation loss decreased (-0.340520 --> -0.494576).  Saving model ...
Epoch: 5 cost time: 2.9603993892669678
Epoch: 5, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.713 Vali Acc: 0.616 Test Loss: 1.713 Test Acc: 0.616
Validation loss decreased (-0.494576 --> -0.616199).  Saving model ...
Epoch: 6 cost time: 2.9278485774993896
Epoch: 6, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.524 Vali Acc: 0.708 Test Loss: 1.524 Test Acc: 0.708
Validation loss decreased (-0.616199 --> -0.708093).  Saving model ...
Epoch: 7 cost time: 3.3649814128875732
Epoch: 7, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.324 Vali Acc: 0.741 Test Loss: 1.324 Test Acc: 0.741
Validation loss decreased (-0.708093 --> -0.740527).  Saving model ...
Epoch: 8 cost time: 2.8750500679016113
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.147 Vali Acc: 0.749 Test Loss: 1.147 Test Acc: 0.749
Validation loss decreased (-0.740527 --> -0.748637).  Saving model ...
Epoch: 9 cost time: 2.8693840503692627
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 0.963 Vali Acc: 0.768 Test Loss: 0.963 Test Acc: 0.768
Validation loss decreased (-0.748637 --> -0.767558).  Saving model ...
Epoch: 10 cost time: 3.0349009037017822
Epoch: 10, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.799 Vali Acc: 0.786 Test Loss: 0.799 Test Acc: 0.786
Validation loss decreased (-0.767558 --> -0.786478).  Saving model ...
Epoch: 11 cost time: 2.9993627071380615
Epoch: 11, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.664 Vali Acc: 0.811 Test Loss: 0.664 Test Acc: 0.811
Validation loss decreased (-0.786478 --> -0.810804).  Saving model ...
Epoch: 12 cost time: 2.906250238418579
Epoch: 12, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.550 Vali Acc: 0.857 Test Loss: 0.550 Test Acc: 0.857
Validation loss decreased (-0.810804 --> -0.856751).  Saving model ...
Epoch: 13 cost time: 3.104034900665283
Epoch: 13, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.455 Vali Acc: 0.892 Test Loss: 0.455 Test Acc: 0.892
Validation loss decreased (-0.856751 --> -0.891887).  Saving model ...
Epoch: 14 cost time: 2.9760937690734863
Epoch: 14, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.392 Vali Acc: 0.892 Test Loss: 0.392 Test Acc: 0.892
Validation loss decreased (-0.891887 --> -0.891888).  Saving model ...
Epoch: 15 cost time: 2.8209433555603027
Epoch: 15, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.353 Vali Acc: 0.905 Test Loss: 0.353 Test Acc: 0.905
Validation loss decreased (-0.891888 --> -0.905402).  Saving model ...
Epoch: 16 cost time: 2.7961833477020264
Epoch: 16, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.313 Vali Acc: 0.914 Test Loss: 0.313 Test Acc: 0.914
Validation loss decreased (-0.905402 --> -0.913510).  Saving model ...
Epoch: 17 cost time: 2.9690887928009033
Epoch: 17, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.283 Vali Acc: 0.927 Test Loss: 0.283 Test Acc: 0.927
Validation loss decreased (-0.913510 --> -0.927024).  Saving model ...
Epoch: 18 cost time: 3.076688766479492
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.256 Vali Acc: 0.932 Test Loss: 0.256 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 19 cost time: 2.897310972213745
Epoch: 19, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 20 cost time: 2.7787861824035645
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.229 Vali Acc: 0.932 Test Loss: 0.229 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.972036123275757
Epoch: 21, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 22 cost time: 3.1446094512939453
Epoch: 22, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 23 cost time: 3.129162311553955
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 24 cost time: 3.4071927070617676
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 3.0726113319396973
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 3.212773323059082
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.272167682647705
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 3.061903953552246
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 29 cost time: 2.773660659790039
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.930429697036743
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 31 cost time: 2.812241315841675
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.7713167667388916
Epoch: 32, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.727019786834717
Epoch: 33, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.9284372329711914
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 35 cost time: 2.80049991607666
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.869105100631714
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0363192558288574
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.8934943675994873
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.0306756496429443
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.802198886871338
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.9043359756469727
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.565901517868042
Epoch: 42, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.7353861331939697
Epoch: 43, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.687746047973633
Epoch: 44, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.359466791152954
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 3.0859508514404297
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.109074354171753
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.008349657058716
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 5 cost time: 3.2449216842651367
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.005258798599243
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.831505298614502
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 8 cost time: 2.777484178543091
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7543230056762695
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8503973484039307
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 11 cost time: 3.0873501300811768
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1773557662963867
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 13 cost time: 3.337930202484131
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 14 cost time: 2.971255302429199
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 15 cost time: 3.1628026962280273
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.93410587310791
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 17 cost time: 3.303499937057495
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.265667200088501
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.081068992614746
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 20 cost time: 2.8473055362701416
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7133421897888184
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.794684886932373
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 23 cost time: 2.890127658843994
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9619221687316895
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0711441040039062
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 26 cost time: 3.114976406097412
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1034469604492188
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.149583339691162
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.119 Test Loss: 2.200 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.033379316329956
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.882513999938965
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 31 cost time: 2.7888662815093994
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.8804335594177246
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 33 cost time: 2.981921434402466
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 34 cost time: 2.8594865798950195
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 35 cost time: 2.9073612689971924
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.148221492767334
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.10129451751709
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.073101758956909
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.0234005451202393
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.1658620834350586
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.0108940601348877
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 42 cost time: 2.7608251571655273
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 43 cost time: 2.8470818996429443
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.652977705001831
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.9032504558563232
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.9551584720611572
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.8235676288604736
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 48 cost time: 3.1005473136901855
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2650468349456787
Epoch: 49, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 50 cost time: 3.037656784057617
Epoch: 50, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.0400776863098145
Epoch: 51, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 52 cost time: 3.0420432090759277
Epoch: 52, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.186084270477295
Epoch: 53, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.21303391456604
Epoch: 54, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.990548610687256
Epoch: 55, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.0692591667175293
Epoch: 56, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.979245185852051
Epoch: 57, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.837161064147949
Epoch: 58, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 59 cost time: 2.938845157623291
Epoch: 59, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.014021635055542
Epoch: 60, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.1114273071289062
Epoch: 61, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 62 cost time: 3.0119383335113525
Epoch: 62, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.220259428024292
Epoch: 63, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 64 cost time: 3.1292150020599365
Epoch: 64, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 65 cost time: 3.405611991882324
Epoch: 65, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.06764817237854
Epoch: 66, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.031691789627075
Epoch: 67, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.084 Test Loss: 2.199 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.940197467803955
Epoch: 68, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 69 cost time: 2.731563091278076
Epoch: 69, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.7612502574920654
Epoch: 70, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 71 cost time: 3.008995532989502
Epoch: 71, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.276358127593994
Epoch: 72, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 73 cost time: 2.9717350006103516
Epoch: 73, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 74 cost time: 2.873627185821533
Epoch: 74, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.8489255905151367
Epoch: 75, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.894620418548584
Epoch: 76, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.7398054599761963
Epoch: 77, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 2.7653069496154785
Epoch: 78, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 79 cost time: 3.1045353412628174
Epoch: 79, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 80 cost time: 3.0556228160858154
Epoch: 80, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.049469232559204
Epoch: 81, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 82 cost time: 3.0945732593536377
Epoch: 82, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 83 cost time: 2.988783121109009
Epoch: 83, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.7356135845184326
Epoch: 84, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.7022554874420166
Epoch: 85, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 2.9344160556793213
Epoch: 86, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 2.673499345779419
Epoch: 87, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 2.8188726902008057
Epoch: 88, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 2.6725590229034424
Epoch: 89, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 2.787895679473877
Epoch: 90, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 2.869961977005005
Epoch: 91, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 2.9708542823791504
Epoch: 92, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.11891891891891893
model parameter : 214665
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.362713813781738
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.127 Vali Acc: 0.216 Test Loss: 2.127 Test Acc: 0.216
Validation loss decreased (inf --> -0.216195).  Saving model ...
Epoch: 2 cost time: 2.8648664951324463
Epoch: 2, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.984 Vali Acc: 0.322 Test Loss: 1.984 Test Acc: 0.322
Validation loss decreased (-0.216195 --> -0.321602).  Saving model ...
Epoch: 3 cost time: 3.0415213108062744
Epoch: 3, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.825 Vali Acc: 0.511 Test Loss: 1.825 Test Acc: 0.511
Validation loss decreased (-0.321602 --> -0.510793).  Saving model ...
Epoch: 4 cost time: 2.6540799140930176
Epoch: 4, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.659 Vali Acc: 0.584 Test Loss: 1.659 Test Acc: 0.584
Validation loss decreased (-0.510793 --> -0.583767).  Saving model ...
Epoch: 5 cost time: 2.8944361209869385
Epoch: 5, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.496 Vali Acc: 0.646 Test Loss: 1.496 Test Acc: 0.646
Validation loss decreased (-0.583767 --> -0.645931).  Saving model ...
Epoch: 6 cost time: 2.9397599697113037
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.347 Vali Acc: 0.695 Test Loss: 1.347 Test Acc: 0.695
Validation loss decreased (-0.645931 --> -0.694581).  Saving model ...
Epoch: 7 cost time: 2.810032367706299
Epoch: 7, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.190 Vali Acc: 0.719 Test Loss: 1.190 Test Acc: 0.719
Validation loss decreased (-0.694581 --> -0.718907).  Saving model ...
Epoch: 8 cost time: 3.0758373737335205
Epoch: 8, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.022 Vali Acc: 0.759 Test Loss: 1.022 Test Acc: 0.759
Validation loss decreased (-0.718907 --> -0.759449).  Saving model ...
Epoch: 9 cost time: 2.956757068634033
Epoch: 9, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.873 Vali Acc: 0.789 Test Loss: 0.873 Test Acc: 0.789
Validation loss decreased (-0.759449 --> -0.789180).  Saving model ...
Epoch: 10 cost time: 3.0814177989959717
Epoch: 10, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.749 Vali Acc: 0.824 Test Loss: 0.749 Test Acc: 0.824
Validation loss decreased (-0.789180 --> -0.824317).  Saving model ...
Epoch: 11 cost time: 2.9744653701782227
Epoch: 11, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.645 Vali Acc: 0.851 Test Loss: 0.645 Test Acc: 0.851
Validation loss decreased (-0.824317 --> -0.851345).  Saving model ...
Epoch: 12 cost time: 3.1349403858184814
Epoch: 12, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.542 Vali Acc: 0.873 Test Loss: 0.542 Test Acc: 0.873
Validation loss decreased (-0.851345 --> -0.872968).  Saving model ...
Epoch: 13 cost time: 3.13004469871521
Epoch: 13, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.482 Vali Acc: 0.886 Test Loss: 0.482 Test Acc: 0.886
Validation loss decreased (-0.872968 --> -0.886482).  Saving model ...
Epoch: 14 cost time: 3.1019043922424316
Epoch: 14, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.426 Vali Acc: 0.892 Test Loss: 0.426 Test Acc: 0.892
Validation loss decreased (-0.886482 --> -0.891888).  Saving model ...
Epoch: 15 cost time: 2.895418882369995
Epoch: 15, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.379 Vali Acc: 0.905 Test Loss: 0.379 Test Acc: 0.905
Validation loss decreased (-0.891888 --> -0.905402).  Saving model ...
Epoch: 16 cost time: 2.8389172554016113
Epoch: 16, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
Validation loss decreased (-0.905402 --> -0.910807).  Saving model ...
Epoch: 17 cost time: 2.849323034286499
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
Validation loss decreased (-0.910807 --> -0.918916).  Saving model ...
Epoch: 18 cost time: 2.9020442962646484
Epoch: 18, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.284 Vali Acc: 0.927 Test Loss: 0.284 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927024).  Saving model ...
Epoch: 19 cost time: 3.2316229343414307
Epoch: 19, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 2.950974941253662
Epoch: 20, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 21 cost time: 3.059664726257324
Epoch: 21, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8531084060668945
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 23 cost time: 3.1395883560180664
Epoch: 23, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 24 cost time: 2.9140396118164062
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 3.2108635902404785
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 26 cost time: 2.8991074562072754
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8890204429626465
Epoch: 27, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 28 cost time: 3.021385431289673
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 29 cost time: 2.8887152671813965
Epoch: 29, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9026012420654297
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 2.9148037433624268
Epoch: 31, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 3.0046072006225586
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 2.8134984970092773
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 34 cost time: 3.0605432987213135
Epoch: 34, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.9761321544647217
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 2.8804073333740234
Epoch: 36, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 2.872673749923706
Epoch: 37, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 2.8507988452911377
Epoch: 38, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 2.7505862712860107
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 2.704450845718384
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 2.960467576980591
Epoch: 41, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.88360595703125
Epoch: 42, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 43 cost time: 3.016463041305542
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 44 cost time: 3.301035165786743
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 45 cost time: 3.1086649894714355
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.873979330062866
Epoch: 46, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.752413511276245
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.552219867706299
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.614755153656006
Epoch: 49, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 50 cost time: 2.6656172275543213
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 51 cost time: 2.9601762294769287
Epoch: 51, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 52 cost time: 2.663116455078125
Epoch: 52, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.8768556118011475
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.893270492553711
Epoch: 54, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.0701045989990234
Epoch: 55, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.971208333969116
Epoch: 56, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.313239336013794
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.9620540142059326
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.9558303356170654
Epoch: 59, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.7553374767303467
Epoch: 60, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.0374345779418945
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.230717658996582
Epoch: 1, Steps: 17 | Train Loss: 2.168 Vali Loss: 2.136 Vali Acc: 0.195 Test Loss: 2.136 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 3.1829116344451904
Epoch: 2, Steps: 17 | Train Loss: 2.100 Vali Loss: 2.020 Vali Acc: 0.305 Test Loss: 2.020 Test Acc: 0.305
Validation loss decreased (-0.194573 --> -0.305385).  Saving model ...
Epoch: 3 cost time: 3.1164212226867676
Epoch: 3, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.889 Vali Acc: 0.481 Test Loss: 1.889 Test Acc: 0.481
Validation loss decreased (-0.305385 --> -0.481062).  Saving model ...
Epoch: 4 cost time: 2.969771146774292
Epoch: 4, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.744 Vali Acc: 0.581 Test Loss: 1.744 Test Acc: 0.581
Validation loss decreased (-0.481062 --> -0.581064).  Saving model ...
Epoch: 5 cost time: 3.0307257175445557
Epoch: 5, Steps: 17 | Train Loss: 1.668 Vali Loss: 1.594 Vali Acc: 0.627 Test Loss: 1.594 Test Acc: 0.627
Validation loss decreased (-0.581064 --> -0.627011).  Saving model ...
Epoch: 6 cost time: 2.9775772094726562
Epoch: 6, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.448 Vali Acc: 0.676 Test Loss: 1.448 Test Acc: 0.676
Validation loss decreased (-0.627011 --> -0.675661).  Saving model ...
Epoch: 7 cost time: 3.2058029174804688
Epoch: 7, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.290 Vali Acc: 0.689 Test Loss: 1.290 Test Acc: 0.689
Validation loss decreased (-0.675661 --> -0.689176).  Saving model ...
Epoch: 8 cost time: 2.8861892223358154
Epoch: 8, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.110 Vali Acc: 0.722 Test Loss: 1.110 Test Acc: 0.722
Validation loss decreased (-0.689176 --> -0.721611).  Saving model ...
Epoch: 9 cost time: 2.7924137115478516
Epoch: 9, Steps: 17 | Train Loss: 0.947 Vali Loss: 0.944 Vali Acc: 0.770 Test Loss: 0.944 Test Acc: 0.770
Validation loss decreased (-0.721611 --> -0.770261).  Saving model ...
Epoch: 10 cost time: 2.8281757831573486
Epoch: 10, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.809 Vali Acc: 0.784 Test Loss: 0.809 Test Acc: 0.784
Validation loss decreased (-0.770261 --> -0.783776).  Saving model ...
Epoch: 11 cost time: 2.866791009902954
Epoch: 11, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.693 Vali Acc: 0.819 Test Loss: 0.693 Test Acc: 0.819
Validation loss decreased (-0.783776 --> -0.818912).  Saving model ...
Epoch: 12 cost time: 2.828505516052246
Epoch: 12, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.577 Vali Acc: 0.862 Test Loss: 0.577 Test Acc: 0.862
Validation loss decreased (-0.818912 --> -0.862156).  Saving model ...
Epoch: 13 cost time: 2.776947021484375
Epoch: 13, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
Validation loss decreased (-0.862156 --> -0.878373).  Saving model ...
Epoch: 14 cost time: 3.1518168449401855
Epoch: 14, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
Validation loss decreased (-0.878373 --> -0.883779).  Saving model ...
Epoch: 15 cost time: 3.0939345359802246
Epoch: 15, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.415 Vali Acc: 0.886 Test Loss: 0.415 Test Acc: 0.886
Validation loss decreased (-0.883779 --> -0.886482).  Saving model ...
Epoch: 16 cost time: 3.22890567779541
Epoch: 16, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.886482 --> -0.902699).  Saving model ...
Epoch: 17 cost time: 3.1544764041900635
Epoch: 17, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.327 Vali Acc: 0.914 Test Loss: 0.327 Test Acc: 0.914
Validation loss decreased (-0.902699 --> -0.913510).  Saving model ...
Epoch: 18 cost time: 2.8987960815429688
Epoch: 18, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7608492374420166
Epoch: 19, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 20 cost time: 2.7195677757263184
Epoch: 20, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 21 cost time: 2.80932354927063
Epoch: 21, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 22 cost time: 2.662900924682617
Epoch: 22, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7119789123535156
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 2.9635276794433594
Epoch: 24, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 2.9138169288635254
Epoch: 25, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 3.0275702476501465
Epoch: 26, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.05977463722229
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0080063343048096
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.110257625579834
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9968321323394775
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.5504562854766846
Epoch: 31, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7436540126800537
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.687013626098633
Epoch: 33, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.8799469470977783
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.9823317527770996
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.544072151184082
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.155 Vali Acc: 0.173 Test Loss: 2.155 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 2.829430103302002
Epoch: 2, Steps: 17 | Train Loss: 2.127 Vali Loss: 2.071 Vali Acc: 0.254 Test Loss: 2.071 Test Acc: 0.254
Validation loss decreased (-0.172951 --> -0.254033).  Saving model ...
Epoch: 3 cost time: 2.966505765914917
Epoch: 3, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.973 Vali Acc: 0.435 Test Loss: 1.973 Test Acc: 0.435
Validation loss decreased (-0.254033 --> -0.435115).  Saving model ...
Epoch: 4 cost time: 2.9374661445617676
Epoch: 4, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.860 Vali Acc: 0.527 Test Loss: 1.860 Test Acc: 0.527
Validation loss decreased (-0.435115 --> -0.527008).  Saving model ...
Epoch: 5 cost time: 2.663114309310913
Epoch: 5, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.738 Vali Acc: 0.589 Test Loss: 1.738 Test Acc: 0.589
Validation loss decreased (-0.527008 --> -0.589172).  Saving model ...
Epoch: 6 cost time: 2.559415102005005
Epoch: 6, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.602 Vali Acc: 0.608 Test Loss: 1.602 Test Acc: 0.608
Validation loss decreased (-0.589172 --> -0.608092).  Saving model ...
Epoch: 7 cost time: 2.7849159240722656
Epoch: 7, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.447 Vali Acc: 0.654 Test Loss: 1.447 Test Acc: 0.654
Validation loss decreased (-0.608092 --> -0.654040).  Saving model ...
Epoch: 8 cost time: 2.7791385650634766
Epoch: 8, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.260 Vali Acc: 0.700 Test Loss: 1.260 Test Acc: 0.700
Validation loss decreased (-0.654040 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 2.720561981201172
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.080 Vali Acc: 0.741 Test Loss: 1.080 Test Acc: 0.741
Validation loss decreased (-0.699987 --> -0.740530).  Saving model ...
Epoch: 10 cost time: 2.6259520053863525
Epoch: 10, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.930 Vali Acc: 0.768 Test Loss: 0.930 Test Acc: 0.768
Validation loss decreased (-0.740530 --> -0.767558).  Saving model ...
Epoch: 11 cost time: 2.9285480976104736
Epoch: 11, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.767558 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 2.874924421310425
Epoch: 12, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.656 Vali Acc: 0.824 Test Loss: 0.656 Test Acc: 0.824
Validation loss decreased (-0.799992 --> -0.824318).  Saving model ...
Epoch: 13 cost time: 2.9741995334625244
Epoch: 13, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.574 Vali Acc: 0.846 Test Loss: 0.574 Test Acc: 0.846
Validation loss decreased (-0.824318 --> -0.845940).  Saving model ...
Epoch: 14 cost time: 3.0133161544799805
Epoch: 14, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.504 Vali Acc: 0.865 Test Loss: 0.504 Test Acc: 0.865
Validation loss decreased (-0.845940 --> -0.864860).  Saving model ...
Epoch: 15 cost time: 2.988276720046997
Epoch: 15, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.444 Vali Acc: 0.873 Test Loss: 0.444 Test Acc: 0.873
Validation loss decreased (-0.864860 --> -0.872969).  Saving model ...
Epoch: 16 cost time: 2.9449732303619385
Epoch: 16, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.411 Vali Acc: 0.886 Test Loss: 0.411 Test Acc: 0.886
Validation loss decreased (-0.872969 --> -0.886482).  Saving model ...
Epoch: 17 cost time: 2.748802423477173
Epoch: 17, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.353 Vali Acc: 0.908 Test Loss: 0.353 Test Acc: 0.908
Validation loss decreased (-0.886482 --> -0.908105).  Saving model ...
Epoch: 18 cost time: 2.6978585720062256
Epoch: 18, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.331 Vali Acc: 0.914 Test Loss: 0.331 Test Acc: 0.914
Validation loss decreased (-0.908105 --> -0.913510).  Saving model ...
Epoch: 19 cost time: 2.701259136199951
Epoch: 19, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.310 Vali Acc: 0.916 Test Loss: 0.310 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 20 cost time: 2.855227470397949
Epoch: 20, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
Validation loss decreased (-0.916213 --> -0.927024).  Saving model ...
Epoch: 21 cost time: 3.0033228397369385
Epoch: 21, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 22 cost time: 2.796795606613159
Epoch: 22, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 23 cost time: 2.982847213745117
Epoch: 23, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 24 cost time: 3.140519857406616
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 25 cost time: 3.1974151134490967
Epoch: 25, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.202 Vali Acc: 0.938 Test Loss: 0.202 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 26 cost time: 2.9825165271759033
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940538).  Saving model ...
Epoch: 27 cost time: 3.150369882583618
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.197 Vali Acc: 0.932 Test Loss: 0.197 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.960007429122925
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 29 cost time: 2.8891825675964355
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 2.8614163398742676
Epoch: 30, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 2.856454372406006
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.670872449874878
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 33 cost time: 2.701399326324463
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 34 cost time: 2.833834409713745
Epoch: 34, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 35 cost time: 2.8914501667022705
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 36 cost time: 2.899935007095337
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 37 cost time: 2.7550899982452393
Epoch: 37, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0537240505218506
Epoch: 38, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.9999067783355713
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 40 cost time: 2.7154688835144043
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 41 cost time: 2.6305763721466064
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.642969846725464
Epoch: 42, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 43 cost time: 2.6658596992492676
Epoch: 43, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 44 cost time: 2.556215286254883
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 2.596881151199341
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 46 cost time: 2.700385808944702
Epoch: 46, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.8714849948883057
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.9982266426086426
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.8444650173187256
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.8642501831054688
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 51 cost time: 2.7365849018096924
Epoch: 51, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.6162428855895996
Epoch: 52, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.656614303588867
Epoch: 53, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.749523639678955
Epoch: 54, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.706696033477783
Epoch: 55, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.773613691329956
Epoch: 56, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.8942983150482178
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.9890079498291016
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.113978624343872
Epoch: 59, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 60 cost time: 3.0764546394348145
Epoch: 60, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 61 cost time: 3.0773770809173584
Epoch: 61, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.1423330307006836
Epoch: 62, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 63 cost time: 2.958118438720703
Epoch: 63, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.7919819355010986
Epoch: 64, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.848886013031006
Epoch: 65, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.9160234928131104
Epoch: 66, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.8474812507629395
Epoch: 67, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.7377328872680664
Epoch: 68, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.9324915409088135
Epoch: 69, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 3.0550570487976074
Epoch: 70, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 3.163576602935791
Epoch: 71, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 3.18778920173645
Epoch: 72, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.256271600723267
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.193 Vali Acc: 0.132 Test Loss: 2.193 Test Acc: 0.132
Validation loss decreased (inf --> -0.132410).  Saving model ...
Epoch: 2 cost time: 2.7426624298095703
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.117 Vali Acc: 0.216 Test Loss: 2.117 Test Acc: 0.216
Validation loss decreased (-0.132410 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 2.883237600326538
Epoch: 3, Steps: 17 | Train Loss: 2.068 Vali Loss: 2.025 Vali Acc: 0.322 Test Loss: 2.025 Test Acc: 0.322
Validation loss decreased (-0.216195 --> -0.321601).  Saving model ...
Epoch: 4 cost time: 2.925577163696289
Epoch: 4, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.913 Vali Acc: 0.462 Test Loss: 1.913 Test Acc: 0.462
Validation loss decreased (-0.321601 --> -0.462143).  Saving model ...
Epoch: 5 cost time: 2.712256908416748
Epoch: 5, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.788 Vali Acc: 0.581 Test Loss: 1.788 Test Acc: 0.581
Validation loss decreased (-0.462143 --> -0.581063).  Saving model ...
Epoch: 6 cost time: 3.221102476119995
Epoch: 6, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.646 Vali Acc: 0.646 Test Loss: 1.646 Test Acc: 0.646
Validation loss decreased (-0.581063 --> -0.645929).  Saving model ...
Epoch: 7 cost time: 2.901413679122925
Epoch: 7, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.482 Vali Acc: 0.686 Test Loss: 1.482 Test Acc: 0.686
Validation loss decreased (-0.645929 --> -0.686472).  Saving model ...
Epoch: 8 cost time: 3.249101400375366
Epoch: 8, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.283 Vali Acc: 0.711 Test Loss: 1.283 Test Acc: 0.711
Validation loss decreased (-0.686472 --> -0.710798).  Saving model ...
Epoch: 9 cost time: 3.0832619667053223
Epoch: 9, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.080 Vali Acc: 0.757 Test Loss: 1.080 Test Acc: 0.757
Validation loss decreased (-0.710798 --> -0.756746).  Saving model ...
Epoch: 10 cost time: 3.2707581520080566
Epoch: 10, Steps: 17 | Train Loss: 0.951 Vali Loss: 0.909 Vali Acc: 0.778 Test Loss: 0.909 Test Acc: 0.778
Validation loss decreased (-0.756746 --> -0.778369).  Saving model ...
Epoch: 11 cost time: 3.369152307510376
Epoch: 11, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.762 Vali Acc: 0.797 Test Loss: 0.762 Test Acc: 0.797
Validation loss decreased (-0.778369 --> -0.797290).  Saving model ...
Epoch: 12 cost time: 2.9368391036987305
Epoch: 12, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.642 Vali Acc: 0.824 Test Loss: 0.642 Test Acc: 0.824
Validation loss decreased (-0.797290 --> -0.824318).  Saving model ...
Epoch: 13 cost time: 2.994926691055298
Epoch: 13, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.555 Vali Acc: 0.843 Test Loss: 0.555 Test Acc: 0.843
Validation loss decreased (-0.824318 --> -0.843238).  Saving model ...
Epoch: 14 cost time: 2.9843013286590576
Epoch: 14, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
Validation loss decreased (-0.843238 --> -0.870265).  Saving model ...
Epoch: 15 cost time: 2.9843223094940186
Epoch: 15, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.430 Vali Acc: 0.886 Test Loss: 0.430 Test Acc: 0.886
Validation loss decreased (-0.870265 --> -0.886482).  Saving model ...
Epoch: 16 cost time: 3.377711296081543
Epoch: 16, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.394 Vali Acc: 0.895 Test Loss: 0.394 Test Acc: 0.895
Validation loss decreased (-0.886482 --> -0.894591).  Saving model ...
Epoch: 17 cost time: 3.1120336055755615
Epoch: 17, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.894591 --> -0.902699).  Saving model ...
Epoch: 18 cost time: 3.0687413215637207
Epoch: 18, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.317 Vali Acc: 0.905 Test Loss: 0.317 Test Acc: 0.905
Validation loss decreased (-0.902699 --> -0.905402).  Saving model ...
Epoch: 19 cost time: 3.0804433822631836
Epoch: 19, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.905402 --> -0.921619).  Saving model ...
Epoch: 20 cost time: 2.829284191131592
Epoch: 20, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.269 Vali Acc: 0.927 Test Loss: 0.269 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927024).  Saving model ...
Epoch: 21 cost time: 2.861252546310425
Epoch: 21, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.239 Vali Acc: 0.932 Test Loss: 0.239 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 22 cost time: 2.7741410732269287
Epoch: 22, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.225 Vali Acc: 0.932 Test Loss: 0.225 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 23 cost time: 2.9490678310394287
Epoch: 23, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 24 cost time: 3.1718075275421143
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 25 cost time: 3.3256115913391113
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2437071800231934
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 3.2294764518737793
Epoch: 27, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 28 cost time: 3.265733242034912
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0953001976013184
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2205402851104736
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 2.717318058013916
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 32 cost time: 3.162904739379883
Epoch: 32, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 2.7235817909240723
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.7354252338409424
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.8601889610290527
Epoch: 35, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 36 cost time: 2.953080177307129
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.970597743988037
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.912940740585327
Epoch: 38, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.0055384635925293
Epoch: 39, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0693917274475098
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.956739664077759
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.8671844005584717
Epoch: 42, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.7893006801605225
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 44 cost time: 3.1739180088043213
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 3.0390377044677734
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.952857255935669
Epoch: 46, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.094109058380127
Epoch: 47, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.2337586879730225
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 49 cost time: 3.2885069847106934
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3793511390686035
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.36074161529541
Epoch: 51, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.1999869346618652
Epoch: 52, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.2178025245666504
Epoch: 53, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 54 cost time: 2.8695504665374756
Epoch: 54, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.9749205112457275
Epoch: 55, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.813310146331787
Epoch: 56, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.9311039447784424
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.0843098163604736
Epoch: 58, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.8988263607025146
Epoch: 59, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.196239471435547
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.2527756690979004
Epoch: 61, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.1933813095092773
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.155919075012207
Epoch: 63, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 64 cost time: 3.2088828086853027
Epoch: 64, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 65 cost time: 3.326765537261963
Epoch: 65, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.1578369140625
Epoch: 66, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.1065926551818848
Epoch: 67, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.9173436164855957
Epoch: 68, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.9246790409088135
Epoch: 69, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.861679792404175
Epoch: 70, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.7965362071990967
Epoch: 71, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 72 cost time: 3.2948172092437744
Epoch: 72, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 3.1591668128967285
Epoch: 73, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 3.1489806175231934
Epoch: 74, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 3.0795180797576904
Epoch: 75, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 3.14626407623291
Epoch: 76, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 2.830869197845459
Epoch: 77, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 2.8945655822753906
Epoch: 78, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 2.845045566558838
Epoch: 79, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 3.017771005630493
Epoch: 80, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 81 cost time: 3.0569818019866943
Epoch: 81, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 3.181302785873413
Epoch: 82, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 3.1132972240448
Epoch: 83, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 3.2967920303344727
Epoch: 84, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 3.4496772289276123
Epoch: 85, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 3.310123920440674
Epoch: 86, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 3.057795763015747
Epoch: 87, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 3.142523765563965
Epoch: 88, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 2.8085806369781494
Epoch: 89, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 3.082559108734131
Epoch: 90, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.028131723403931
Epoch: 1, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.207 Vali Acc: 0.100 Test Loss: 2.207 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 2.935650110244751
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.133 Vali Acc: 0.184 Test Loss: 2.133 Test Acc: 0.184
Validation loss decreased (-0.099978 --> -0.183762).  Saving model ...
Epoch: 3 cost time: 2.9576480388641357
Epoch: 3, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.036 Vali Acc: 0.311 Test Loss: 2.036 Test Acc: 0.311
Validation loss decreased (-0.183762 --> -0.310790).  Saving model ...
Epoch: 4 cost time: 2.914226531982422
Epoch: 4, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.903 Vali Acc: 0.462 Test Loss: 1.903 Test Acc: 0.462
Validation loss decreased (-0.310790 --> -0.462143).  Saving model ...
Epoch: 5 cost time: 2.9393434524536133
Epoch: 5, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.752 Vali Acc: 0.570 Test Loss: 1.752 Test Acc: 0.570
Validation loss decreased (-0.462143 --> -0.570253).  Saving model ...
Epoch: 6 cost time: 3.1351590156555176
Epoch: 6, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.589 Vali Acc: 0.627 Test Loss: 1.589 Test Acc: 0.627
Validation loss decreased (-0.570253 --> -0.627011).  Saving model ...
Epoch: 7 cost time: 2.7635104656219482
Epoch: 7, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.414 Vali Acc: 0.697 Test Loss: 1.414 Test Acc: 0.697
Validation loss decreased (-0.627011 --> -0.697283).  Saving model ...
Epoch: 8 cost time: 2.714047431945801
Epoch: 8, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.241 Vali Acc: 0.703 Test Loss: 1.241 Test Acc: 0.703
Validation loss decreased (-0.697283 --> -0.702690).  Saving model ...
Epoch: 9 cost time: 2.9162092208862305
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.066 Vali Acc: 0.759 Test Loss: 1.066 Test Acc: 0.759
Validation loss decreased (-0.702690 --> -0.759449).  Saving model ...
Epoch: 10 cost time: 2.735196352005005
Epoch: 10, Steps: 17 | Train Loss: 0.933 Vali Loss: 0.886 Vali Acc: 0.805 Test Loss: 0.886 Test Acc: 0.805
Validation loss decreased (-0.759449 --> -0.805397).  Saving model ...
Epoch: 11 cost time: 2.738285779953003
Epoch: 11, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.735 Vali Acc: 0.846 Test Loss: 0.735 Test Acc: 0.846
Validation loss decreased (-0.805397 --> -0.845939).  Saving model ...
Epoch: 12 cost time: 2.9420409202575684
Epoch: 12, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.607 Vali Acc: 0.859 Test Loss: 0.607 Test Acc: 0.859
Validation loss decreased (-0.845939 --> -0.859453).  Saving model ...
Epoch: 13 cost time: 3.1630945205688477
Epoch: 13, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
Validation loss decreased (-0.859453 --> -0.878373).  Saving model ...
Epoch: 14 cost time: 3.1032891273498535
Epoch: 14, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.429 Vali Acc: 0.905 Test Loss: 0.429 Test Acc: 0.905
Validation loss decreased (-0.878373 --> -0.905401).  Saving model ...
Epoch: 15 cost time: 3.0746426582336426
Epoch: 15, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.401 Vali Acc: 0.914 Test Loss: 0.401 Test Acc: 0.914
Validation loss decreased (-0.905401 --> -0.913510).  Saving model ...
Epoch: 16 cost time: 3.032517671585083
Epoch: 16, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918915).  Saving model ...
Epoch: 17 cost time: 3.181363582611084
Epoch: 17, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.312 Vali Acc: 0.932 Test Loss: 0.312 Test Acc: 0.932
Validation loss decreased (-0.918915 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 2.972416639328003
Epoch: 18, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 19 cost time: 3.01774525642395
Epoch: 19, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 20 cost time: 2.7644975185394287
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.250 Vali Acc: 0.932 Test Loss: 0.250 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.850334405899048
Epoch: 21, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 3.037777900695801
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.254 Vali Acc: 0.932 Test Loss: 0.254 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9610607624053955
Epoch: 23, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7721471786499023
Epoch: 24, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 3.0495388507843018
Epoch: 25, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0178985595703125
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9282350540161133
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.979099750518799
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.942063093185425
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8798673152923584
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.8170738220214844
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.7480359077453613
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.9854519367218018
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8959481716156006
Epoch: 34, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.264101982116699
Epoch: 1, Steps: 17 | Train Loss: 2.245 Vali Loss: 2.212 Vali Acc: 0.130 Test Loss: 2.212 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 2.8818585872650146
Epoch: 2, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.135 Vali Acc: 0.197 Test Loss: 2.135 Test Acc: 0.197
Validation loss decreased (-0.129708 --> -0.197276).  Saving model ...
Epoch: 3 cost time: 2.932147979736328
Epoch: 3, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.038 Vali Acc: 0.300 Test Loss: 2.038 Test Acc: 0.300
Validation loss decreased (-0.197276 --> -0.299980).  Saving model ...
Epoch: 4 cost time: 2.909296751022339
Epoch: 4, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.908 Vali Acc: 0.414 Test Loss: 1.908 Test Acc: 0.414
Validation loss decreased (-0.299980 --> -0.413494).  Saving model ...
Epoch: 5 cost time: 3.1172561645507812
Epoch: 5, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.753 Vali Acc: 0.605 Test Loss: 1.753 Test Acc: 0.605
Validation loss decreased (-0.413494 --> -0.605388).  Saving model ...
Epoch: 6 cost time: 2.815326690673828
Epoch: 6, Steps: 17 | Train Loss: 1.789 Vali Loss: 1.579 Vali Acc: 0.670 Test Loss: 1.579 Test Acc: 0.670
Validation loss decreased (-0.605388 --> -0.670254).  Saving model ...
Epoch: 7 cost time: 2.8048179149627686
Epoch: 7, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.389 Vali Acc: 0.711 Test Loss: 1.389 Test Acc: 0.711
Validation loss decreased (-0.670254 --> -0.710797).  Saving model ...
Epoch: 8 cost time: 2.713576316833496
Epoch: 8, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.196 Vali Acc: 0.719 Test Loss: 1.196 Test Acc: 0.719
Validation loss decreased (-0.710797 --> -0.718907).  Saving model ...
Epoch: 9 cost time: 2.9214978218078613
Epoch: 9, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.026 Vali Acc: 0.754 Test Loss: 1.026 Test Acc: 0.754
Validation loss decreased (-0.718907 --> -0.754044).  Saving model ...
Epoch: 10 cost time: 2.8650529384613037
Epoch: 10, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.884 Vali Acc: 0.743 Test Loss: 0.884 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.723259925842285
Epoch: 11, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.739 Vali Acc: 0.811 Test Loss: 0.739 Test Acc: 0.811
Validation loss decreased (-0.754044 --> -0.810803).  Saving model ...
Epoch: 12 cost time: 2.5970306396484375
Epoch: 12, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.618 Vali Acc: 0.832 Test Loss: 0.618 Test Acc: 0.832
Validation loss decreased (-0.810803 --> -0.832426).  Saving model ...
Epoch: 13 cost time: 2.9802405834198
Epoch: 13, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.537 Vali Acc: 0.846 Test Loss: 0.537 Test Acc: 0.846
Validation loss decreased (-0.832426 --> -0.845941).  Saving model ...
Epoch: 14 cost time: 2.9564478397369385
Epoch: 14, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.462 Vali Acc: 0.868 Test Loss: 0.462 Test Acc: 0.868
Validation loss decreased (-0.845941 --> -0.867563).  Saving model ...
Epoch: 15 cost time: 2.899794816970825
Epoch: 15, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.428 Vali Acc: 0.873 Test Loss: 0.428 Test Acc: 0.873
Validation loss decreased (-0.867563 --> -0.872969).  Saving model ...
Epoch: 16 cost time: 2.806610345840454
Epoch: 16, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.872969 --> -0.889185).  Saving model ...
Epoch: 17 cost time: 2.911431312561035
Epoch: 17, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.889185 --> -0.902699).  Saving model ...
Epoch: 18 cost time: 2.8002712726593018
Epoch: 18, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.322 Vali Acc: 0.908 Test Loss: 0.322 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 19 cost time: 2.800741672515869
Epoch: 19, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.269 Vali Acc: 0.927 Test Loss: 0.269 Test Acc: 0.927
Validation loss decreased (-0.908105 --> -0.927024).  Saving model ...
Epoch: 20 cost time: 2.7653753757476807
Epoch: 20, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 21 cost time: 2.696263074874878
Epoch: 21, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 2.787461280822754
Epoch: 22, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.241 Vali Acc: 0.938 Test Loss: 0.241 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8755483627319336
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8903844356536865
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 2.9594240188598633
Epoch: 25, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 2.8114101886749268
Epoch: 26, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8075754642486572
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 2.992948532104492
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 29 cost time: 3.2158634662628174
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2034547328948975
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 2.9561679363250732
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.7177178859710693
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.992720365524292
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 2.921550750732422
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 35 cost time: 2.853243589401245
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.9432618618011475
Epoch: 36, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0296809673309326
Epoch: 37, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.9850802421569824
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.775595188140869
Epoch: 39, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 40 cost time: 3.0940935611724854
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 41 cost time: 2.8854124546051025
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.8772225379943848
Epoch: 42, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.651341676712036
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.7213757038116455
Epoch: 44, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.813713312149048
Epoch: 45, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.900692939758301
Epoch: 46, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.7401273250579834
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.9088025093078613
Epoch: 48, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.7062103748321533
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.9928297996520996
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.351996660232544
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (inf --> -0.094573).  Saving model ...
Epoch: 2 cost time: 2.9645497798919678
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 3 cost time: 2.6653568744659424
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 4 cost time: 2.606065273284912
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 5 cost time: 2.5737037658691406
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 6 cost time: 3.056539535522461
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1498053073883057
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1290204524993896
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.033745527267456
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.132383346557617
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0023679733276367
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9895315170288086
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0657787322998047
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.040839672088623
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 15 cost time: 2.970669984817505
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0707507133483887
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.120018243789673
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2214531898498535
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.045464277267456
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2640511989593506
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3969690799713135
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.196763753890991
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 23 cost time: 3.3797895908355713
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1640899181365967
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.930110454559326
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9038283824920654
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.892186164855957
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.9844536781311035
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.045241594314575
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.835369110107422
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.303541660308838
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 32 cost time: 3.0600244998931885
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 33 cost time: 2.9608285427093506
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9991872310638428
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0547335147857666
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 36 cost time: 2.6408722400665283
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.74908709526062
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.590564250946045
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.7402913570404053
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.7639989852905273
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.7221453189849854
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.0770862102508545
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.0191168785095215
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 44 cost time: 3.000654458999634
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.96732759475708
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.0275888442993164
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.079486846923828
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.8246822357177734
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.7276971340179443
Epoch: 49, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.7114500999450684
Epoch: 50, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.094573 --> -0.118897).  Saving model ...
Epoch: 51 cost time: 2.772855758666992
Epoch: 51, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 52 cost time: 3.0390963554382324
Epoch: 52, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.9026381969451904
Epoch: 53, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.0537149906158447
Epoch: 54, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.1153249740600586
Epoch: 55, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 56 cost time: 2.979856252670288
Epoch: 56, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.27811861038208
Epoch: 57, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 58 cost time: 3.1226730346679688
Epoch: 58, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.0525193214416504
Epoch: 59, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 60 cost time: 2.856194496154785
Epoch: 60, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.7549221515655518
Epoch: 61, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.9779036045074463
Epoch: 62, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 63 cost time: 3.084700584411621
Epoch: 63, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.0009827613830566
Epoch: 64, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.908658981323242
Epoch: 65, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.194885730743408
Epoch: 66, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 67 cost time: 3.0773608684539795
Epoch: 67, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.8941688537597656
Epoch: 68, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.955117702484131
Epoch: 69, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.0252532958984375
Epoch: 70, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.7270123958587646
Epoch: 71, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.0615315437316895
Epoch: 72, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.9752492904663086
Epoch: 73, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.0248847007751465
Epoch: 74, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 75 cost time: 2.807563066482544
Epoch: 75, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 3.0517842769622803
Epoch: 76, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 3.25718092918396
Epoch: 77, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 3.1573727130889893
Epoch: 78, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 3.1167914867401123
Epoch: 79, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 3.0557289123535156
Epoch: 80, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 81 cost time: 3.0938363075256348
Epoch: 81, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.9330081939697266
Epoch: 82, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 2.923182487487793
Epoch: 83, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 3.012030601501465
Epoch: 84, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 85 cost time: 3.0293917655944824
Epoch: 85, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 3.1616530418395996
Epoch: 86, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.9051520824432373
Epoch: 87, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 88 cost time: 3.109569549560547
Epoch: 88, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 2.960517406463623
Epoch: 89, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 3.1183853149414062
Epoch: 90, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 3.0520317554473877
Epoch: 91, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 3.0660321712493896
Epoch: 92, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 2.9940788745880127
Epoch: 93, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 2.8288092613220215
Epoch: 94, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 2.888198137283325
Epoch: 95, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 2.813781499862671
Epoch: 96, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 2.6876730918884277
Epoch: 97, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.11891891891891893
model parameter : 165513
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.32581353187561
Epoch: 1, Steps: 17 | Train Loss: 2.251 Vali Loss: 2.187 Vali Acc: 0.124 Test Loss: 2.187 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 3.0854554176330566
Epoch: 2, Steps: 17 | Train Loss: 2.142 Vali Loss: 2.018 Vali Acc: 0.322 Test Loss: 2.018 Test Acc: 0.322
Validation loss decreased (-0.124302 --> -0.321601).  Saving model ...
Epoch: 3 cost time: 2.9812750816345215
Epoch: 3, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.840 Vali Acc: 0.500 Test Loss: 1.840 Test Acc: 0.500
Validation loss decreased (-0.321601 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 3.2143101692199707
Epoch: 4, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.691 Vali Acc: 0.562 Test Loss: 1.691 Test Acc: 0.562
Validation loss decreased (-0.499982 --> -0.562145).  Saving model ...
Epoch: 5 cost time: 3.1548540592193604
Epoch: 5, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.553 Vali Acc: 0.622 Test Loss: 1.553 Test Acc: 0.622
Validation loss decreased (-0.562145 --> -0.621606).  Saving model ...
Epoch: 6 cost time: 3.0771870613098145
Epoch: 6, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.411 Vali Acc: 0.641 Test Loss: 1.411 Test Acc: 0.641
Validation loss decreased (-0.621606 --> -0.640526).  Saving model ...
Epoch: 7 cost time: 3.0369253158569336
Epoch: 7, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.296 Vali Acc: 0.678 Test Loss: 1.296 Test Acc: 0.678
Validation loss decreased (-0.640526 --> -0.678365).  Saving model ...
Epoch: 8 cost time: 2.9715023040771484
Epoch: 8, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.181 Vali Acc: 0.724 Test Loss: 1.181 Test Acc: 0.724
Validation loss decreased (-0.678365 --> -0.724313).  Saving model ...
Epoch: 9 cost time: 2.963855504989624
Epoch: 9, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.087 Vali Acc: 0.722 Test Loss: 1.087 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8764162063598633
Epoch: 10, Steps: 17 | Train Loss: 1.001 Vali Loss: 0.985 Vali Acc: 0.765 Test Loss: 0.985 Test Acc: 0.765
Validation loss decreased (-0.724313 --> -0.764855).  Saving model ...
Epoch: 11 cost time: 3.17244029045105
Epoch: 11, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.893 Vali Acc: 0.778 Test Loss: 0.893 Test Acc: 0.778
Validation loss decreased (-0.764855 --> -0.778369).  Saving model ...
Epoch: 12 cost time: 3.0620272159576416
Epoch: 12, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
Validation loss decreased (-0.778369 --> -0.802695).  Saving model ...
Epoch: 13 cost time: 3.2269041538238525
Epoch: 13, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.756 Vali Acc: 0.811 Test Loss: 0.756 Test Acc: 0.811
Validation loss decreased (-0.802695 --> -0.810803).  Saving model ...
Epoch: 14 cost time: 3.352355480194092
Epoch: 14, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.677 Vali Acc: 0.832 Test Loss: 0.677 Test Acc: 0.832
Validation loss decreased (-0.810803 --> -0.832426).  Saving model ...
Epoch: 15 cost time: 3.121323823928833
Epoch: 15, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.595 Vali Acc: 0.851 Test Loss: 0.595 Test Acc: 0.851
Validation loss decreased (-0.832426 --> -0.851345).  Saving model ...
Epoch: 16 cost time: 3.207293748855591
Epoch: 16, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.563 Vali Acc: 0.865 Test Loss: 0.563 Test Acc: 0.865
Validation loss decreased (-0.851345 --> -0.864859).  Saving model ...
Epoch: 17 cost time: 3.1766138076782227
Epoch: 17, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
Validation loss decreased (-0.864859 --> -0.878373).  Saving model ...
Epoch: 18 cost time: 2.9469738006591797
Epoch: 18, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.482 Vali Acc: 0.881 Test Loss: 0.482 Test Acc: 0.881
Validation loss decreased (-0.878373 --> -0.881076).  Saving model ...
Epoch: 19 cost time: 2.8334476947784424
Epoch: 19, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.427 Vali Acc: 0.886 Test Loss: 0.427 Test Acc: 0.886
Validation loss decreased (-0.881076 --> -0.886482).  Saving model ...
Epoch: 20 cost time: 2.9384028911590576
Epoch: 20, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.386 Vali Acc: 0.914 Test Loss: 0.386 Test Acc: 0.914
Validation loss decreased (-0.886482 --> -0.913510).  Saving model ...
Epoch: 21 cost time: 2.7340168952941895
Epoch: 21, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.376 Vali Acc: 0.905 Test Loss: 0.376 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.683600664138794
Epoch: 22, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921618).  Saving model ...
Epoch: 23 cost time: 2.7618799209594727
Epoch: 23, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.666623592376709
Epoch: 24, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
Validation loss decreased (-0.921618 --> -0.932430).  Saving model ...
Epoch: 25 cost time: 3.301840305328369
Epoch: 25, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.183809757232666
Epoch: 26, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.269 Vali Acc: 0.943 Test Loss: 0.269 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 27 cost time: 3.0269153118133545
Epoch: 27, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.187056303024292
Epoch: 28, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2614951133728027
Epoch: 29, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.893779993057251
Epoch: 30, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 31 cost time: 2.9593191146850586
Epoch: 31, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9721641540527344
Epoch: 32, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 33 cost time: 3.043287754058838
Epoch: 33, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8709681034088135
Epoch: 34, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 35 cost time: 2.9245307445526123
Epoch: 35, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2848830223083496
Epoch: 36, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.408695936203003
Epoch: 37, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.1168501377105713
Epoch: 38, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.07346510887146
Epoch: 39, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.248283624649048
Epoch: 40, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.195242166519165
Epoch: 41, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.1076674461364746
Epoch: 42, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.2376763820648193
Epoch: 43, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.9580447673797607
Epoch: 44, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.349569320678711
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.178 Vali Acc: 0.132 Test Loss: 2.178 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 2.8641536235809326
Epoch: 2, Steps: 17 | Train Loss: 2.170 Vali Loss: 2.061 Vali Acc: 0.295 Test Loss: 2.061 Test Acc: 0.295
Validation loss decreased (-0.132411 --> -0.294574).  Saving model ...
Epoch: 3 cost time: 2.9971365928649902
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.925 Vali Acc: 0.432 Test Loss: 1.925 Test Acc: 0.432
Validation loss decreased (-0.294574 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 2.8726823329925537
Epoch: 4, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.802 Vali Acc: 0.557 Test Loss: 1.802 Test Acc: 0.557
Validation loss decreased (-0.432413 --> -0.556739).  Saving model ...
Epoch: 5 cost time: 2.915052890777588
Epoch: 5, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.683 Vali Acc: 0.608 Test Loss: 1.683 Test Acc: 0.608
Validation loss decreased (-0.556739 --> -0.608091).  Saving model ...
Epoch: 6 cost time: 2.861757516860962
Epoch: 6, Steps: 17 | Train Loss: 1.649 Vali Loss: 1.553 Vali Acc: 0.646 Test Loss: 1.553 Test Acc: 0.646
Validation loss decreased (-0.608091 --> -0.645930).  Saving model ...
Epoch: 7 cost time: 2.892486572265625
Epoch: 7, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.437 Vali Acc: 0.668 Test Loss: 1.437 Test Acc: 0.668
Validation loss decreased (-0.645930 --> -0.667553).  Saving model ...
Epoch: 8 cost time: 2.8960318565368652
Epoch: 8, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.318 Vali Acc: 0.692 Test Loss: 1.318 Test Acc: 0.692
Validation loss decreased (-0.667553 --> -0.691879).  Saving model ...
Epoch: 9 cost time: 2.7263503074645996
Epoch: 9, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.218 Vali Acc: 0.695 Test Loss: 1.218 Test Acc: 0.695
Validation loss decreased (-0.691879 --> -0.694582).  Saving model ...
Epoch: 10 cost time: 2.766705274581909
Epoch: 10, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.113 Vali Acc: 0.743 Test Loss: 1.113 Test Acc: 0.743
Validation loss decreased (-0.694582 --> -0.743232).  Saving model ...
Epoch: 11 cost time: 2.6707608699798584
Epoch: 11, Steps: 17 | Train Loss: 1.025 Vali Loss: 0.983 Vali Acc: 0.770 Test Loss: 0.983 Test Acc: 0.770
Validation loss decreased (-0.743232 --> -0.770260).  Saving model ...
Epoch: 12 cost time: 2.89251446723938
Epoch: 12, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.901 Vali Acc: 0.781 Test Loss: 0.901 Test Acc: 0.781
Validation loss decreased (-0.770260 --> -0.781072).  Saving model ...
Epoch: 13 cost time: 2.7901482582092285
Epoch: 13, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.793 Vali Acc: 0.805 Test Loss: 0.793 Test Acc: 0.805
Validation loss decreased (-0.781072 --> -0.805397).  Saving model ...
Epoch: 14 cost time: 2.7977705001831055
Epoch: 14, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.758977174758911
Epoch: 15, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
Validation loss decreased (-0.805397 --> -0.840534).  Saving model ...
Epoch: 16 cost time: 2.84183931350708
Epoch: 16, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.596 Vali Acc: 0.849 Test Loss: 0.596 Test Acc: 0.849
Validation loss decreased (-0.840534 --> -0.848643).  Saving model ...
Epoch: 17 cost time: 2.9113731384277344
Epoch: 17, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.517 Vali Acc: 0.881 Test Loss: 0.517 Test Acc: 0.881
Validation loss decreased (-0.848643 --> -0.881076).  Saving model ...
Epoch: 18 cost time: 2.8489787578582764
Epoch: 18, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.898552656173706
Epoch: 19, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.431 Vali Acc: 0.876 Test Loss: 0.431 Test Acc: 0.876
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0848870277404785
Epoch: 20, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.403 Vali Acc: 0.886 Test Loss: 0.403 Test Acc: 0.886
Validation loss decreased (-0.881076 --> -0.886482).  Saving model ...
Epoch: 21 cost time: 3.0998477935791016
Epoch: 21, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.387 Vali Acc: 0.876 Test Loss: 0.387 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0347819328308105
Epoch: 22, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
Validation loss decreased (-0.886482 --> -0.910808).  Saving model ...
Epoch: 23 cost time: 3.1227855682373047
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.331 Vali Acc: 0.897 Test Loss: 0.331 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9331414699554443
Epoch: 24, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.276 Vali Acc: 0.927 Test Loss: 0.276 Test Acc: 0.927
Validation loss decreased (-0.910808 --> -0.927024).  Saving model ...
Epoch: 25 cost time: 2.9059031009674072
Epoch: 25, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.280 Vali Acc: 0.914 Test Loss: 0.280 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.707490921020508
Epoch: 26, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.250 Vali Acc: 0.927 Test Loss: 0.250 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927025).  Saving model ...
Epoch: 27 cost time: 2.821291923522949
Epoch: 27, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
Validation loss decreased (-0.927025 --> -0.937835).  Saving model ...
Epoch: 28 cost time: 2.7485969066619873
Epoch: 28, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7454731464385986
Epoch: 29, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.652808427810669
Epoch: 30, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 2.9118080139160156
Epoch: 31, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9775748252868652
Epoch: 32, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.098236322402954
Epoch: 33, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 34 cost time: 3.043682813644409
Epoch: 34, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.259434461593628
Epoch: 35, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.9495224952697754
Epoch: 36, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.9064245223999023
Epoch: 37, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 38 cost time: 2.86952543258667
Epoch: 38, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 39 cost time: 2.833446979522705
Epoch: 39, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.833753824234009
Epoch: 40, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.7289462089538574
Epoch: 41, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.79408860206604
Epoch: 42, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.0962576866149902
Epoch: 43, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.12994647026062
Epoch: 44, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.206484794616699
Epoch: 45, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 46 cost time: 3.265935182571411
Epoch: 46, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 47 cost time: 3.075488567352295
Epoch: 47, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 48 cost time: 3.1418087482452393
Epoch: 48, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.918839931488037
Epoch: 49, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 50 cost time: 2.858705520629883
Epoch: 50, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 51 cost time: 2.7734568119049072
Epoch: 51, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.797390937805176
Epoch: 52, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.868100643157959
Epoch: 53, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.7913854122161865
Epoch: 54, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.95809006690979
Epoch: 55, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 56 cost time: 3.2083113193511963
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 57 cost time: 2.98046875
Epoch: 57, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.839306354522705
Epoch: 58, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.0683443546295166
Epoch: 59, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.144925832748413
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.7677125930786133
Epoch: 61, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.8290860652923584
Epoch: 62, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 63 cost time: 2.8314552307128906
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.7520346641540527
Epoch: 64, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.8336498737335205
Epoch: 65, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 66 cost time: 2.713054656982422
Epoch: 66, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.856257200241089
Epoch: 67, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.1423442363739014
Epoch: 68, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.0761215686798096
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 2.974400758743286
Epoch: 70, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.9546592235565186
Epoch: 71, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 3.082829713821411
Epoch: 72, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 2.8598709106445312
Epoch: 73, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 2.7364721298217773
Epoch: 74, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 2.7654149532318115
Epoch: 75, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.154285192489624
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.162 Vali Acc: 0.176 Test Loss: 2.162 Test Acc: 0.176
Validation loss decreased (inf --> -0.175654).  Saving model ...
Epoch: 2 cost time: 2.988832712173462
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.091 Vali Acc: 0.246 Test Loss: 2.091 Test Acc: 0.246
Validation loss decreased (-0.175654 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 2.9523212909698486
Epoch: 3, Steps: 17 | Train Loss: 2.057 Vali Loss: 2.007 Vali Acc: 0.368 Test Loss: 2.007 Test Acc: 0.368
Validation loss decreased (-0.245925 --> -0.367547).  Saving model ...
Epoch: 4 cost time: 3.0155997276306152
Epoch: 4, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.928 Vali Acc: 0.454 Test Loss: 1.928 Test Acc: 0.454
Validation loss decreased (-0.367547 --> -0.454035).  Saving model ...
Epoch: 5 cost time: 2.9201250076293945
Epoch: 5, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.837 Vali Acc: 0.514 Test Loss: 1.837 Test Acc: 0.514
Validation loss decreased (-0.454035 --> -0.513495).  Saving model ...
Epoch: 6 cost time: 3.0043513774871826
Epoch: 6, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.724 Vali Acc: 0.581 Test Loss: 1.724 Test Acc: 0.581
Validation loss decreased (-0.513495 --> -0.581064).  Saving model ...
Epoch: 7 cost time: 3.060276746749878
Epoch: 7, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.636 Vali Acc: 0.603 Test Loss: 1.636 Test Acc: 0.603
Validation loss decreased (-0.581064 --> -0.602686).  Saving model ...
Epoch: 8 cost time: 2.9073874950408936
Epoch: 8, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.528 Vali Acc: 0.632 Test Loss: 1.528 Test Acc: 0.632
Validation loss decreased (-0.602686 --> -0.632417).  Saving model ...
Epoch: 9 cost time: 3.2621333599090576
Epoch: 9, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.432 Vali Acc: 0.659 Test Loss: 1.432 Test Acc: 0.659
Validation loss decreased (-0.632417 --> -0.659445).  Saving model ...
Epoch: 10 cost time: 3.0560317039489746
Epoch: 10, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.302 Vali Acc: 0.689 Test Loss: 1.302 Test Acc: 0.689
Validation loss decreased (-0.659445 --> -0.689176).  Saving model ...
Epoch: 11 cost time: 2.9928503036499023
Epoch: 11, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.167 Vali Acc: 0.743 Test Loss: 1.167 Test Acc: 0.743
Validation loss decreased (-0.689176 --> -0.743232).  Saving model ...
Epoch: 12 cost time: 2.952239990234375
Epoch: 12, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.078 Vali Acc: 0.732 Test Loss: 1.078 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.075685501098633
Epoch: 13, Steps: 17 | Train Loss: 0.923 Vali Loss: 0.951 Vali Acc: 0.762 Test Loss: 0.951 Test Acc: 0.762
Validation loss decreased (-0.743232 --> -0.762153).  Saving model ...
Epoch: 14 cost time: 3.1036922931671143
Epoch: 14, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.868 Vali Acc: 0.759 Test Loss: 0.868 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1088473796844482
Epoch: 15, Steps: 17 | Train Loss: 0.690 Vali Loss: 0.747 Vali Acc: 0.827 Test Loss: 0.747 Test Acc: 0.827
Validation loss decreased (-0.762153 --> -0.827020).  Saving model ...
Epoch: 16 cost time: 3.0375988483428955
Epoch: 16, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.721 Vali Acc: 0.830 Test Loss: 0.721 Test Acc: 0.830
Validation loss decreased (-0.827020 --> -0.829723).  Saving model ...
Epoch: 17 cost time: 3.0281219482421875
Epoch: 17, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.624 Vali Acc: 0.851 Test Loss: 0.624 Test Acc: 0.851
Validation loss decreased (-0.829723 --> -0.851345).  Saving model ...
Epoch: 18 cost time: 3.1411027908325195
Epoch: 18, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.587 Vali Acc: 0.854 Test Loss: 0.587 Test Acc: 0.854
Validation loss decreased (-0.851345 --> -0.854048).  Saving model ...
Epoch: 19 cost time: 3.0478928089141846
Epoch: 19, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.530 Vali Acc: 0.865 Test Loss: 0.530 Test Acc: 0.865
Validation loss decreased (-0.854048 --> -0.864860).  Saving model ...
Epoch: 20 cost time: 2.945920944213867
Epoch: 20, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.942978620529175
Epoch: 21, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.468 Vali Acc: 0.868 Test Loss: 0.468 Test Acc: 0.868
Validation loss decreased (-0.864860 --> -0.867563).  Saving model ...
Epoch: 22 cost time: 3.0419323444366455
Epoch: 22, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.408 Vali Acc: 0.895 Test Loss: 0.408 Test Acc: 0.895
Validation loss decreased (-0.867563 --> -0.894591).  Saving model ...
Epoch: 23 cost time: 2.8660359382629395
Epoch: 23, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.407 Vali Acc: 0.886 Test Loss: 0.407 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6957876682281494
Epoch: 24, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.894591 --> -0.902699).  Saving model ...
Epoch: 25 cost time: 2.8746039867401123
Epoch: 25, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.931070327758789
Epoch: 26, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.056257963180542
Epoch: 27, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.305 Vali Acc: 0.908 Test Loss: 0.305 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 28 cost time: 3.021207332611084
Epoch: 28, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.316 Vali Acc: 0.895 Test Loss: 0.316 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8448238372802734
Epoch: 29, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.290 Vali Acc: 0.916 Test Loss: 0.290 Test Acc: 0.916
Validation loss decreased (-0.908105 --> -0.916213).  Saving model ...
Epoch: 30 cost time: 2.8471062183380127
Epoch: 30, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.269 Vali Acc: 0.916 Test Loss: 0.269 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916214).  Saving model ...
Epoch: 31 cost time: 3.125941514968872
Epoch: 31, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.302 Vali Acc: 0.897 Test Loss: 0.302 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.0664820671081543
Epoch: 32, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
Validation loss decreased (-0.916214 --> -0.918916).  Saving model ...
Epoch: 33 cost time: 2.902421236038208
Epoch: 33, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 34 cost time: 2.9569268226623535
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 35 cost time: 3.1169540882110596
Epoch: 35, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1565380096435547
Epoch: 36, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 37 cost time: 3.057682752609253
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.250 Vali Acc: 0.914 Test Loss: 0.250 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.047825336456299
Epoch: 38, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 39 cost time: 3.273257255554199
Epoch: 39, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
Validation loss decreased (-0.927025 --> -0.927025).  Saving model ...
Epoch: 40 cost time: 3.3570239543914795
Epoch: 40, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.226 Vali Acc: 0.924 Test Loss: 0.226 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.5181920528411865
Epoch: 41, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929728).  Saving model ...
Epoch: 42 cost time: 3.2979073524475098
Epoch: 42, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.927 Test Loss: 0.211 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.158822536468506
Epoch: 43, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.057091236114502
Epoch: 44, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.9571621417999268
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932430).  Saving model ...
Epoch: 46 cost time: 2.888164758682251
Epoch: 46, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.036400079727173
Epoch: 47, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932431).  Saving model ...
Epoch: 48 cost time: 2.8652477264404297
Epoch: 48, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
Validation loss decreased (-0.932431 --> -0.937836).  Saving model ...
Epoch: 49 cost time: 3.1568329334259033
Epoch: 49, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.093233823776245
Epoch: 50, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 51 cost time: 3.0678811073303223
Epoch: 51, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.1807053089141846
Epoch: 52, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 53 cost time: 3.239871025085449
Epoch: 53, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 54 cost time: 3.0132222175598145
Epoch: 54, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 55 cost time: 2.868211269378662
Epoch: 55, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.0253939628601074
Epoch: 56, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.938 Test Loss: 0.203 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.895369291305542
Epoch: 57, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.9948525428771973
Epoch: 58, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954052).  Saving model ...
Epoch: 59 cost time: 3.0926811695098877
Epoch: 59, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.3269264698028564
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.39235258102417
Epoch: 61, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.116072177886963
Epoch: 62, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.2557621002197266
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.2517802715301514
Epoch: 64, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.301593780517578
Epoch: 65, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.0828027725219727
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 2.9909682273864746
Epoch: 67, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.0011329650878906
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.562666654586792
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 2.202 Vali Acc: 0.159 Test Loss: 2.202 Test Acc: 0.159
Validation loss decreased (inf --> -0.159437).  Saving model ...
Epoch: 2 cost time: 3.309574842453003
Epoch: 2, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.130 Vali Acc: 0.214 Test Loss: 2.130 Test Acc: 0.214
Validation loss decreased (-0.159437 --> -0.213492).  Saving model ...
Epoch: 3 cost time: 2.916181802749634
Epoch: 3, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.046 Vali Acc: 0.314 Test Loss: 2.046 Test Acc: 0.314
Validation loss decreased (-0.213492 --> -0.313493).  Saving model ...
Epoch: 4 cost time: 3.0006260871887207
Epoch: 4, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.974 Vali Acc: 0.384 Test Loss: 1.974 Test Acc: 0.384
Validation loss decreased (-0.313493 --> -0.383764).  Saving model ...
Epoch: 5 cost time: 3.0675501823425293
Epoch: 5, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.891 Vali Acc: 0.465 Test Loss: 1.891 Test Acc: 0.465
Validation loss decreased (-0.383764 --> -0.464846).  Saving model ...
Epoch: 6 cost time: 3.0001184940338135
Epoch: 6, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.794 Vali Acc: 0.532 Test Loss: 1.794 Test Acc: 0.532
Validation loss decreased (-0.464846 --> -0.532414).  Saving model ...
Epoch: 7 cost time: 3.0126819610595703
Epoch: 7, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.703 Vali Acc: 0.573 Test Loss: 1.703 Test Acc: 0.573
Validation loss decreased (-0.532414 --> -0.572956).  Saving model ...
Epoch: 8 cost time: 3.096442937850952
Epoch: 8, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.618 Vali Acc: 0.608 Test Loss: 1.618 Test Acc: 0.608
Validation loss decreased (-0.572956 --> -0.608092).  Saving model ...
Epoch: 9 cost time: 3.0751285552978516
Epoch: 9, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.524 Vali Acc: 0.624 Test Loss: 1.524 Test Acc: 0.624
Validation loss decreased (-0.608092 --> -0.624309).  Saving model ...
Epoch: 10 cost time: 2.8030829429626465
Epoch: 10, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.400 Vali Acc: 0.678 Test Loss: 1.400 Test Acc: 0.678
Validation loss decreased (-0.624309 --> -0.678364).  Saving model ...
Epoch: 11 cost time: 2.9033448696136475
Epoch: 11, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.281 Vali Acc: 0.714 Test Loss: 1.281 Test Acc: 0.714
Validation loss decreased (-0.678364 --> -0.713501).  Saving model ...
Epoch: 12 cost time: 2.776657819747925
Epoch: 12, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.182 Vali Acc: 0.719 Test Loss: 1.182 Test Acc: 0.719
Validation loss decreased (-0.713501 --> -0.718907).  Saving model ...
Epoch: 13 cost time: 2.921464681625366
Epoch: 13, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.036 Vali Acc: 0.762 Test Loss: 1.036 Test Acc: 0.762
Validation loss decreased (-0.718907 --> -0.762152).  Saving model ...
Epoch: 14 cost time: 2.9188051223754883
Epoch: 14, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.941 Vali Acc: 0.789 Test Loss: 0.941 Test Acc: 0.789
Validation loss decreased (-0.762152 --> -0.789180).  Saving model ...
Epoch: 15 cost time: 3.0164825916290283
Epoch: 15, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.821 Vali Acc: 0.822 Test Loss: 0.821 Test Acc: 0.822
Validation loss decreased (-0.789180 --> -0.821613).  Saving model ...
Epoch: 16 cost time: 2.772620916366577
Epoch: 16, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.750 Vali Acc: 0.827 Test Loss: 0.750 Test Acc: 0.827
Validation loss decreased (-0.821613 --> -0.827020).  Saving model ...
Epoch: 17 cost time: 3.0917840003967285
Epoch: 17, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.639 Vali Acc: 0.865 Test Loss: 0.639 Test Acc: 0.865
Validation loss decreased (-0.827020 --> -0.864858).  Saving model ...
Epoch: 18 cost time: 2.9027063846588135
Epoch: 18, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.599 Vali Acc: 0.862 Test Loss: 0.599 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.656923770904541
Epoch: 19, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.512 Vali Acc: 0.886 Test Loss: 0.512 Test Acc: 0.886
Validation loss decreased (-0.864858 --> -0.886481).  Saving model ...
Epoch: 20 cost time: 2.676586627960205
Epoch: 20, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.476 Vali Acc: 0.892 Test Loss: 0.476 Test Acc: 0.892
Validation loss decreased (-0.886481 --> -0.891887).  Saving model ...
Epoch: 21 cost time: 2.649416208267212
Epoch: 21, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.445 Vali Acc: 0.892 Test Loss: 0.445 Test Acc: 0.892
Validation loss decreased (-0.891887 --> -0.891887).  Saving model ...
Epoch: 22 cost time: 2.550673007965088
Epoch: 22, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.382 Vali Acc: 0.914 Test Loss: 0.382 Test Acc: 0.914
Validation loss decreased (-0.891887 --> -0.913510).  Saving model ...
Epoch: 23 cost time: 2.8055479526519775
Epoch: 23, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7391066551208496
Epoch: 24, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918916).  Saving model ...
Epoch: 25 cost time: 2.8665146827697754
Epoch: 25, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.295 Vali Acc: 0.927 Test Loss: 0.295 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927024).  Saving model ...
Epoch: 26 cost time: 3.0217783451080322
Epoch: 26, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.305 Vali Acc: 0.916 Test Loss: 0.305 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.874122381210327
Epoch: 27, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.162630319595337
Epoch: 28, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1096603870391846
Epoch: 29, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9457616806030273
Epoch: 30, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 31 cost time: 3.0708489418029785
Epoch: 31, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.220 Vali Acc: 0.927 Test Loss: 0.220 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.0523107051849365
Epoch: 32, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.921741247177124
Epoch: 33, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 34 cost time: 2.8001930713653564
Epoch: 34, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.222 Vali Acc: 0.924 Test Loss: 0.222 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.010923147201538
Epoch: 35, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.927 Test Loss: 0.208 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.8847830295562744
Epoch: 36, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.216 Vali Acc: 0.927 Test Loss: 0.216 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.2336065769195557
Epoch: 37, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.222 Vali Acc: 0.916 Test Loss: 0.222 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.0789029598236084
Epoch: 38, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929728).  Saving model ...
Epoch: 39 cost time: 2.9605164527893066
Epoch: 39, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932431).  Saving model ...
Epoch: 40 cost time: 3.3800599575042725
Epoch: 40, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.314345598220825
Epoch: 41, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.3265345096588135
Epoch: 42, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.750145196914673
Epoch: 43, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
Validation loss decreased (-0.932431 --> -0.937836).  Saving model ...
Epoch: 44 cost time: 2.843419313430786
Epoch: 44, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.737168550491333
Epoch: 45, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.935 Test Loss: 0.166 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.7454397678375244
Epoch: 46, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943242).  Saving model ...
Epoch: 47 cost time: 2.5583090782165527
Epoch: 47, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.7764205932617188
Epoch: 48, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.935 Test Loss: 0.169 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.002861261367798
Epoch: 49, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.0464420318603516
Epoch: 50, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.932 Test Loss: 0.162 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.917670965194702
Epoch: 51, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.190 Vali Acc: 0.932 Test Loss: 0.190 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.9812705516815186
Epoch: 52, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 53 cost time: 2.9337146282196045
Epoch: 53, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.0267090797424316
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.925334930419922
Epoch: 55, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 56 cost time: 3.037411689758301
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 57 cost time: 3.063634157180786
Epoch: 57, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 58 cost time: 3.132833242416382
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.9543535709381104
Epoch: 59, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.9673092365264893
Epoch: 60, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.935 Test Loss: 0.167 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.108330249786377
Epoch: 61, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.219482898712158
Epoch: 62, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.0546107292175293
Epoch: 63, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 3.053032159805298
Epoch: 64, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 3.0036978721618652
Epoch: 65, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 3.154756784439087
Epoch: 66, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 2.8962557315826416
Epoch: 67, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 68 cost time: 2.7291324138641357
Epoch: 68, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.8613409996032715
Epoch: 69, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.678619623184204
Epoch: 70, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.941 Test Loss: 0.148 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 2.834446668624878
Epoch: 71, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.830050468444824
Epoch: 72, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 2.8959710597991943
Epoch: 73, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 2.7759218215942383
Epoch: 74, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 2.6478888988494873
Epoch: 75, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.946 Test Loss: 0.144 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 2.8914852142333984
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 2.8097431659698486
Epoch: 77, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.056959867477417
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.192 Vali Acc: 0.132 Test Loss: 2.192 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 2.749807357788086
Epoch: 2, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.135 Vali Acc: 0.178 Test Loss: 2.135 Test Acc: 0.178
Validation loss decreased (-0.132411 --> -0.178357).  Saving model ...
Epoch: 3 cost time: 2.8983614444732666
Epoch: 3, Steps: 17 | Train Loss: 2.167 Vali Loss: 2.061 Vali Acc: 0.246 Test Loss: 2.061 Test Acc: 0.246
Validation loss decreased (-0.178357 --> -0.245925).  Saving model ...
Epoch: 4 cost time: 2.8564367294311523
Epoch: 4, Steps: 17 | Train Loss: 2.096 Vali Loss: 1.998 Vali Acc: 0.341 Test Loss: 1.998 Test Acc: 0.341
Validation loss decreased (-0.245925 --> -0.340521).  Saving model ...
Epoch: 5 cost time: 2.7965822219848633
Epoch: 5, Steps: 17 | Train Loss: 2.047 Vali Loss: 1.931 Vali Acc: 0.386 Test Loss: 1.931 Test Acc: 0.386
Validation loss decreased (-0.340521 --> -0.386467).  Saving model ...
Epoch: 6 cost time: 3.3002357482910156
Epoch: 6, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.844 Vali Acc: 0.454 Test Loss: 1.844 Test Acc: 0.454
Validation loss decreased (-0.386467 --> -0.454036).  Saving model ...
Epoch: 7 cost time: 3.1331210136413574
Epoch: 7, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.756 Vali Acc: 0.543 Test Loss: 1.756 Test Acc: 0.543
Validation loss decreased (-0.454036 --> -0.543226).  Saving model ...
Epoch: 8 cost time: 3.0719573497772217
Epoch: 8, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.679 Vali Acc: 0.581 Test Loss: 1.679 Test Acc: 0.581
Validation loss decreased (-0.543226 --> -0.581064).  Saving model ...
Epoch: 9 cost time: 2.8284811973571777
Epoch: 9, Steps: 17 | Train Loss: 1.743 Vali Loss: 1.585 Vali Acc: 0.589 Test Loss: 1.585 Test Acc: 0.589
Validation loss decreased (-0.581064 --> -0.589173).  Saving model ...
Epoch: 10 cost time: 3.008012533187866
Epoch: 10, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.487 Vali Acc: 0.600 Test Loss: 1.487 Test Acc: 0.600
Validation loss decreased (-0.589173 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 3.0111746788024902
Epoch: 11, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.359 Vali Acc: 0.646 Test Loss: 1.359 Test Acc: 0.646
Validation loss decreased (-0.599985 --> -0.645932).  Saving model ...
Epoch: 12 cost time: 3.0511703491210938
Epoch: 12, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.273 Vali Acc: 0.649 Test Loss: 1.273 Test Acc: 0.649
Validation loss decreased (-0.645932 --> -0.648636).  Saving model ...
Epoch: 13 cost time: 2.966254711151123
Epoch: 13, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.116 Vali Acc: 0.749 Test Loss: 1.116 Test Acc: 0.749
Validation loss decreased (-0.648636 --> -0.748637).  Saving model ...
Epoch: 14 cost time: 3.190561532974243
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.009 Vali Acc: 0.738 Test Loss: 1.009 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.96598219871521
Epoch: 15, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.871 Vali Acc: 0.808 Test Loss: 0.871 Test Acc: 0.808
Validation loss decreased (-0.748637 --> -0.808099).  Saving model ...
Epoch: 16 cost time: 2.892421245574951
Epoch: 16, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.754 Vali Acc: 0.838 Test Loss: 0.754 Test Acc: 0.838
Validation loss decreased (-0.808099 --> -0.837830).  Saving model ...
Epoch: 17 cost time: 2.970219612121582
Epoch: 17, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.689 Vali Acc: 0.827 Test Loss: 0.689 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8907949924468994
Epoch: 18, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.619 Vali Acc: 0.854 Test Loss: 0.619 Test Acc: 0.854
Validation loss decreased (-0.837830 --> -0.854048).  Saving model ...
Epoch: 19 cost time: 3.1780383586883545
Epoch: 19, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
Validation loss decreased (-0.854048 --> -0.862157).  Saving model ...
Epoch: 20 cost time: 2.7866294384002686
Epoch: 20, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
Validation loss decreased (-0.862157 --> -0.878374).  Saving model ...
Epoch: 21 cost time: 2.7492125034332275
Epoch: 21, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8413984775543213
Epoch: 22, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.389 Vali Acc: 0.886 Test Loss: 0.389 Test Acc: 0.886
Validation loss decreased (-0.878374 --> -0.886483).  Saving model ...
Epoch: 23 cost time: 2.731297254562378
Epoch: 23, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9016451835632324
Epoch: 24, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.335 Vali Acc: 0.905 Test Loss: 0.335 Test Acc: 0.905
Validation loss decreased (-0.886483 --> -0.905402).  Saving model ...
Epoch: 25 cost time: 3.0785107612609863
Epoch: 25, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.053358316421509
Epoch: 26, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.320 Vali Acc: 0.908 Test Loss: 0.320 Test Acc: 0.908
Validation loss decreased (-0.905402 --> -0.908105).  Saving model ...
Epoch: 27 cost time: 2.9563918113708496
Epoch: 27, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.271 Vali Acc: 0.927 Test Loss: 0.271 Test Acc: 0.927
Validation loss decreased (-0.908105 --> -0.927024).  Saving model ...
Epoch: 28 cost time: 3.1404948234558105
Epoch: 28, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2595484256744385
Epoch: 29, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.282 Vali Acc: 0.908 Test Loss: 0.282 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9964773654937744
Epoch: 30, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0036215782165527
Epoch: 31, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 32 cost time: 2.9762213230133057
Epoch: 32, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.166466474533081
Epoch: 33, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.244 Vali Acc: 0.924 Test Loss: 0.244 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.848572015762329
Epoch: 34, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.096468687057495
Epoch: 35, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.0249555110931396
Epoch: 36, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 37 cost time: 3.175996780395508
Epoch: 37, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.914 Test Loss: 0.228 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.1680045127868652
Epoch: 38, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.1968231201171875
Epoch: 39, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.192995309829712
Epoch: 40, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.218 Vali Acc: 0.924 Test Loss: 0.218 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.875960350036621
Epoch: 41, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.0831780433654785
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.202 Vali Acc: 0.927 Test Loss: 0.202 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.184525489807129
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.038684368133545
Epoch: 44, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.9819459915161133
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.0776870250701904
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.279155254364014
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.199 Vali Acc: 0.100 Test Loss: 2.199 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 2.961728572845459
Epoch: 2, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.134 Vali Acc: 0.186 Test Loss: 2.134 Test Acc: 0.186
Validation loss decreased (-0.099978 --> -0.186465).  Saving model ...
Epoch: 3 cost time: 2.9484150409698486
Epoch: 3, Steps: 17 | Train Loss: 2.126 Vali Loss: 2.047 Vali Acc: 0.268 Test Loss: 2.047 Test Acc: 0.268
Validation loss decreased (-0.186465 --> -0.267547).  Saving model ...
Epoch: 4 cost time: 2.5995519161224365
Epoch: 4, Steps: 17 | Train Loss: 2.038 Vali Loss: 1.964 Vali Acc: 0.349 Test Loss: 1.964 Test Acc: 0.349
Validation loss decreased (-0.267547 --> -0.348629).  Saving model ...
Epoch: 5 cost time: 2.844944477081299
Epoch: 5, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.871 Vali Acc: 0.454 Test Loss: 1.871 Test Acc: 0.454
Validation loss decreased (-0.348629 --> -0.454035).  Saving model ...
Epoch: 6 cost time: 3.1130025386810303
Epoch: 6, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.772 Vali Acc: 0.505 Test Loss: 1.772 Test Acc: 0.505
Validation loss decreased (-0.454035 --> -0.505388).  Saving model ...
Epoch: 7 cost time: 2.6586105823516846
Epoch: 7, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.663 Vali Acc: 0.543 Test Loss: 1.663 Test Acc: 0.543
Validation loss decreased (-0.505388 --> -0.543227).  Saving model ...
Epoch: 8 cost time: 2.910651445388794
Epoch: 8, Steps: 17 | Train Loss: 1.687 Vali Loss: 1.563 Vali Acc: 0.616 Test Loss: 1.563 Test Acc: 0.616
Validation loss decreased (-0.543227 --> -0.616201).  Saving model ...
Epoch: 9 cost time: 2.8524372577667236
Epoch: 9, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.467 Vali Acc: 0.595 Test Loss: 1.467 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.736983299255371
Epoch: 10, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.350 Vali Acc: 0.681 Test Loss: 1.350 Test Acc: 0.681
Validation loss decreased (-0.616201 --> -0.681068).  Saving model ...
Epoch: 11 cost time: 2.893653631210327
Epoch: 11, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.202 Vali Acc: 0.741 Test Loss: 1.202 Test Acc: 0.741
Validation loss decreased (-0.681068 --> -0.740529).  Saving model ...
Epoch: 12 cost time: 2.9536070823669434
Epoch: 12, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.126 Vali Acc: 0.749 Test Loss: 1.126 Test Acc: 0.749
Validation loss decreased (-0.740529 --> -0.748637).  Saving model ...
Epoch: 13 cost time: 3.2259936332702637
Epoch: 13, Steps: 17 | Train Loss: 1.079 Vali Loss: 0.961 Vali Acc: 0.814 Test Loss: 0.961 Test Acc: 0.814
Validation loss decreased (-0.748637 --> -0.813504).  Saving model ...
Epoch: 14 cost time: 3.0229663848876953
Epoch: 14, Steps: 17 | Train Loss: 0.948 Vali Loss: 0.867 Vali Acc: 0.822 Test Loss: 0.867 Test Acc: 0.822
Validation loss decreased (-0.813504 --> -0.821613).  Saving model ...
Epoch: 15 cost time: 3.092334032058716
Epoch: 15, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.754 Vali Acc: 0.830 Test Loss: 0.754 Test Acc: 0.830
Validation loss decreased (-0.821613 --> -0.829722).  Saving model ...
Epoch: 16 cost time: 2.704641819000244
Epoch: 16, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.657 Vali Acc: 0.849 Test Loss: 0.657 Test Acc: 0.849
Validation loss decreased (-0.829722 --> -0.848642).  Saving model ...
Epoch: 17 cost time: 3.0037951469421387
Epoch: 17, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.609 Vali Acc: 0.857 Test Loss: 0.609 Test Acc: 0.857
Validation loss decreased (-0.848642 --> -0.856751).  Saving model ...
Epoch: 18 cost time: 2.8629560470581055
Epoch: 18, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.530 Vali Acc: 0.868 Test Loss: 0.530 Test Acc: 0.868
Validation loss decreased (-0.856751 --> -0.867562).  Saving model ...
Epoch: 19 cost time: 2.967987060546875
Epoch: 19, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.465 Vali Acc: 0.892 Test Loss: 0.465 Test Acc: 0.892
Validation loss decreased (-0.867562 --> -0.891887).  Saving model ...
Epoch: 20 cost time: 2.8106484413146973
Epoch: 20, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.426 Vali Acc: 0.884 Test Loss: 0.426 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1929521560668945
Epoch: 21, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.394 Vali Acc: 0.892 Test Loss: 0.394 Test Acc: 0.892
Validation loss decreased (-0.891887 --> -0.891888).  Saving model ...
Epoch: 22 cost time: 3.2600059509277344
Epoch: 22, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.891888 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 3.1599347591400146
Epoch: 23, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.342 Vali Acc: 0.895 Test Loss: 0.342 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.074533224105835
Epoch: 24, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.307 Vali Acc: 0.908 Test Loss: 0.307 Test Acc: 0.908
Validation loss decreased (-0.899996 --> -0.908105).  Saving model ...
Epoch: 25 cost time: 3.0967745780944824
Epoch: 25, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
Validation loss decreased (-0.908105 --> -0.910808).  Saving model ...
Epoch: 26 cost time: 3.18479323387146
Epoch: 26, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
Validation loss decreased (-0.910808 --> -0.921619).  Saving model ...
Epoch: 27 cost time: 2.957791566848755
Epoch: 27, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.247 Vali Acc: 0.927 Test Loss: 0.247 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 28 cost time: 2.992838144302368
Epoch: 28, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1444687843322754
Epoch: 29, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.7643163204193115
Epoch: 30, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929727).  Saving model ...
Epoch: 31 cost time: 2.818509817123413
Epoch: 31, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 32 cost time: 2.6843807697296143
Epoch: 32, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.205 Vali Acc: 0.932 Test Loss: 0.205 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 33 cost time: 3.1104280948638916
Epoch: 33, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0205814838409424
Epoch: 34, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 35 cost time: 2.9710137844085693
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.216 Vali Acc: 0.924 Test Loss: 0.216 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.967405319213867
Epoch: 36, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943242).  Saving model ...
Epoch: 37 cost time: 3.121572494506836
Epoch: 37, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.8950517177581787
Epoch: 38, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.9282000064849854
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.089961051940918
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.873673439025879
Epoch: 41, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 42 cost time: 3.0943355560302734
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.011827230453491
Epoch: 43, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.943242 --> -0.956755).  Saving model ...
Epoch: 44 cost time: 3.1349499225616455
Epoch: 44, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.9774861335754395
Epoch: 45, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.9044392108917236
Epoch: 46, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.244521379470825
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.0343570709228516
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.963604688644409
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.7398784160614014
Epoch: 50, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.8987550735473633
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.8163845539093018
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.853938102722168
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 54 cost time: 2.8116493225097656
Epoch: 54, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 55 cost time: 2.9561917781829834
Epoch: 55, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.0131990909576416
Epoch: 56, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.9772541522979736
Epoch: 57, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 58 cost time: 2.945531129837036
Epoch: 58, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.8313522338867188
Epoch: 59, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.9137868881225586
Epoch: 60, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.677177906036377
Epoch: 61, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.946 Test Loss: 0.146 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.6957449913024902
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.633479356765747
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.7353973388671875
Epoch: 64, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.683032512664795
Epoch: 65, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 2.8701348304748535
Epoch: 66, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 3.041388511657715
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 68 cost time: 3.0319972038269043
Epoch: 68, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.1699352264404297
Epoch: 69, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 70 cost time: 2.8718831539154053
Epoch: 70, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 3.003307342529297
Epoch: 71, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 3.0073719024658203
Epoch: 72, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.934248685836792
Epoch: 73, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 74 cost time: 3.008537769317627
Epoch: 74, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.993262767791748
Epoch: 75, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 3.0349678993225098
Epoch: 76, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 3.0178213119506836
Epoch: 77, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 3.031148910522461
Epoch: 78, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 3.21185040473938
Epoch: 79, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 3.03240704536438
Epoch: 80, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 3.103933095932007
Epoch: 81, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 3.1305365562438965
Epoch: 82, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 3.0067501068115234
Epoch: 83, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.070996284484863
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
Validation loss decreased (inf --> -0.078356).  Saving model ...
Epoch: 2 cost time: 2.7878801822662354
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.689364194869995
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 4 cost time: 2.9847450256347656
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2528810501098633
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0909576416015625
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 7 cost time: 2.984477996826172
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 8 cost time: 3.3225090503692627
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 9 cost time: 3.189086675643921
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9885780811309814
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1116223335266113
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 12 cost time: 2.7732930183410645
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.842637062072754
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 14 cost time: 2.747326135635376
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.955270767211914
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.154385566711426
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.078 Test Loss: 2.200 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.42329478263855
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 18 cost time: 3.2481021881103516
Epoch: 18, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 19 cost time: 3.0423336029052734
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 20 cost time: 3.2853474617004395
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 21 cost time: 2.909316301345825
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 22 cost time: 2.8928112983703613
Epoch: 22, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6423983573913574
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.091477394104004
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 25 cost time: 2.8355395793914795
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 26 cost time: 2.765803575515747
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1815428733825684
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0808346271514893
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 29 cost time: 3.1856861114501953
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1969146728515625
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.029559373855591
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.020951509475708
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 33 cost time: 3.0781588554382324
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 34 cost time: 3.0010952949523926
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 35 cost time: 2.7473323345184326
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.9815239906311035
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 37 cost time: 2.889042377471924
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.022976875305176
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.30298113822937
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 40 cost time: 3.1885857582092285
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.1464741230010986
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 42 cost time: 3.2446236610412598
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.291957139968872
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.340608835220337
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 45 cost time: 3.1194519996643066
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2005224227905273
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.405870199203491
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.072664737701416
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 49 cost time: 3.1813900470733643
Epoch: 49, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3725364208221436
Epoch: 50, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 51 cost time: 3.3019330501556396
Epoch: 51, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.191054105758667
Epoch: 52, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.389932870864868
Epoch: 53, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 54 cost time: 3.1880943775177
Epoch: 54, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 55 cost time: 2.9255244731903076
Epoch: 55, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.0678658485412598
Epoch: 56, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.078 Test Loss: 2.199 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.203362464904785
Epoch: 57, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.0601072311401367
Epoch: 58, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.041618585586548
Epoch: 59, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.1322438716888428
Epoch: 60, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.4180848598480225
Epoch: 61, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 62 cost time: 3.1451995372772217
Epoch: 62, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 63 cost time: 3.3014183044433594
Epoch: 63, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.134716033935547
Epoch: 64, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 65 cost time: 2.814246416091919
Epoch: 65, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 66 cost time: 2.9023208618164062
Epoch: 66, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
Validation loss decreased (-0.078356 --> -0.078356).  Saving model ...
Epoch: 67 cost time: 2.6717987060546875
Epoch: 67, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
Validation loss decreased (-0.078356 --> -0.118897).  Saving model ...
Epoch: 68 cost time: 2.852116346359253
Epoch: 68, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.8973073959350586
Epoch: 69, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.9223473072052
Epoch: 70, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.4523630142211914
Epoch: 71, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.3399503231048584
Epoch: 72, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.119 Test Loss: 2.198 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.2847235202789307
Epoch: 73, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.0343053340911865
Epoch: 74, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 3.163325786590576
Epoch: 75, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 3.0495259761810303
Epoch: 76, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 2.9063072204589844
Epoch: 77, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.078 Test Loss: 2.198 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.11891891891891893
model parameter : 427849
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1274871826171875
Epoch: 1, Steps: 17 | Train Loss: 2.268 Vali Loss: 2.236 Vali Acc: 0.059 Test Loss: 2.236 Test Acc: 0.059
Validation loss decreased (inf --> -0.059437).  Saving model ...
Epoch: 2 cost time: 3.1104776859283447
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.124 Vali Acc: 0.141 Test Loss: 2.124 Test Acc: 0.141
Validation loss decreased (-0.059437 --> -0.140519).  Saving model ...
Epoch: 3 cost time: 3.0101261138916016
Epoch: 3, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.988 Vali Acc: 0.368 Test Loss: 1.988 Test Acc: 0.368
Validation loss decreased (-0.140519 --> -0.367548).  Saving model ...
Epoch: 4 cost time: 3.0635669231414795
Epoch: 4, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.838 Vali Acc: 0.497 Test Loss: 1.838 Test Acc: 0.497
Validation loss decreased (-0.367548 --> -0.497279).  Saving model ...
Epoch: 5 cost time: 3.2951252460479736
Epoch: 5, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.704 Vali Acc: 0.570 Test Loss: 1.704 Test Acc: 0.570
Validation loss decreased (-0.497279 --> -0.570253).  Saving model ...
Epoch: 6 cost time: 2.9403624534606934
Epoch: 6, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.563 Vali Acc: 0.616 Test Loss: 1.563 Test Acc: 0.616
Validation loss decreased (-0.570253 --> -0.616201).  Saving model ...
Epoch: 7 cost time: 2.9752109050750732
Epoch: 7, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.432 Vali Acc: 0.654 Test Loss: 1.432 Test Acc: 0.654
Validation loss decreased (-0.616201 --> -0.654040).  Saving model ...
Epoch: 8 cost time: 2.966996192932129
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.321 Vali Acc: 0.657 Test Loss: 1.321 Test Acc: 0.657
Validation loss decreased (-0.654040 --> -0.656744).  Saving model ...
Epoch: 9 cost time: 2.920210361480713
Epoch: 9, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.207 Vali Acc: 0.695 Test Loss: 1.207 Test Acc: 0.695
Validation loss decreased (-0.656744 --> -0.694583).  Saving model ...
Epoch: 10 cost time: 2.7290420532226562
Epoch: 10, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.109 Vali Acc: 0.727 Test Loss: 1.109 Test Acc: 0.727
Validation loss decreased (-0.694583 --> -0.727016).  Saving model ...
Epoch: 11 cost time: 3.0448124408721924
Epoch: 11, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.008 Vali Acc: 0.749 Test Loss: 1.008 Test Acc: 0.749
Validation loss decreased (-0.727016 --> -0.748639).  Saving model ...
Epoch: 12 cost time: 2.9303083419799805
Epoch: 12, Steps: 17 | Train Loss: 0.870 Vali Loss: 0.906 Vali Acc: 0.781 Test Loss: 0.906 Test Acc: 0.781
Validation loss decreased (-0.748639 --> -0.781072).  Saving model ...
Epoch: 13 cost time: 2.9439756870269775
Epoch: 13, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
Validation loss decreased (-0.781072 --> -0.802694).  Saving model ...
Epoch: 14 cost time: 3.065061569213867
Epoch: 14, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.736 Vali Acc: 0.819 Test Loss: 0.736 Test Acc: 0.819
Validation loss decreased (-0.802694 --> -0.818912).  Saving model ...
Epoch: 15 cost time: 3.052635908126831
Epoch: 15, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.654 Vali Acc: 0.832 Test Loss: 0.654 Test Acc: 0.832
Validation loss decreased (-0.818912 --> -0.832426).  Saving model ...
Epoch: 16 cost time: 3.0024473667144775
Epoch: 16, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.606 Vali Acc: 0.854 Test Loss: 0.606 Test Acc: 0.854
Validation loss decreased (-0.832426 --> -0.854048).  Saving model ...
Epoch: 17 cost time: 2.8785369396209717
Epoch: 17, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
Validation loss decreased (-0.854048 --> -0.870265).  Saving model ...
Epoch: 18 cost time: 3.3399698734283447
Epoch: 18, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.512 Vali Acc: 0.865 Test Loss: 0.512 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8862645626068115
Epoch: 19, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
Validation loss decreased (-0.870265 --> -0.883779).  Saving model ...
Epoch: 20 cost time: 2.9818100929260254
Epoch: 20, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.883779 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 2.8601624965667725
Epoch: 21, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.902699).  Saving model ...
Epoch: 22 cost time: 3.0359461307525635
Epoch: 22, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7866320610046387
Epoch: 23, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0096535682678223
Epoch: 24, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.902699 --> -0.918916).  Saving model ...
Epoch: 25 cost time: 3.0022542476654053
Epoch: 25, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.288 Vali Acc: 0.916 Test Loss: 0.288 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2768495082855225
Epoch: 26, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 27 cost time: 3.203198194503784
Epoch: 27, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 28 cost time: 3.3899025917053223
Epoch: 28, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0776278972625732
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.231 Vali Acc: 0.924 Test Loss: 0.231 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1944432258605957
Epoch: 30, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929728).  Saving model ...
Epoch: 31 cost time: 2.9915220737457275
Epoch: 31, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
Validation loss decreased (-0.929728 --> -0.932430).  Saving model ...
Epoch: 32 cost time: 2.9142720699310303
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 33 cost time: 3.01570725440979
Epoch: 33, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 34 cost time: 3.289236068725586
Epoch: 34, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.197 Vali Acc: 0.932 Test Loss: 0.197 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.7358715534210205
Epoch: 35, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 36 cost time: 2.918389320373535
Epoch: 36, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 37 cost time: 2.9624180793762207
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.8432114124298096
Epoch: 38, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 39 cost time: 2.6844160556793213
Epoch: 39, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 40 cost time: 2.9303717613220215
Epoch: 40, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 41 cost time: 2.7447028160095215
Epoch: 41, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.6846859455108643
Epoch: 42, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.938 Test Loss: 0.170 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.8317205905914307
Epoch: 43, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.169 Vali Acc: 0.938 Test Loss: 0.169 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.7428317070007324
Epoch: 44, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 45 cost time: 2.776587724685669
Epoch: 45, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 46 cost time: 2.841613292694092
Epoch: 46, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.5395431518554688
Epoch: 47, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.938 Test Loss: 0.164 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.90798020362854
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.7852048873901367
Epoch: 49, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 50 cost time: 2.9538092613220215
Epoch: 50, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.096029758453369
Epoch: 51, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.2681736946105957
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.938 Test Loss: 0.157 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.2809996604919434
Epoch: 53, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 54 cost time: 2.8498568534851074
Epoch: 54, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 55 cost time: 3.070160150527954
Epoch: 55, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.9480762481689453
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.980114698410034
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.905231475830078
Epoch: 58, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.943 Test Loss: 0.154 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.838503360748291
Epoch: 59, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.0001065731048584
Epoch: 60, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.0264806747436523
Epoch: 61, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.316821813583374
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.117084264755249
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.943 Test Loss: 0.145 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.2754452228546143
Epoch: 64, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.3331592082977295
Epoch: 1, Steps: 17 | Train Loss: 2.263 Vali Loss: 2.248 Vali Acc: 0.095 Test Loss: 2.248 Test Acc: 0.095
Validation loss decreased (inf --> -0.094572).  Saving model ...
Epoch: 2 cost time: 2.665149211883545
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.159 Vali Acc: 0.200 Test Loss: 2.159 Test Acc: 0.200
Validation loss decreased (-0.094572 --> -0.199978).  Saving model ...
Epoch: 3 cost time: 2.467182159423828
Epoch: 3, Steps: 17 | Train Loss: 2.090 Vali Loss: 2.048 Vali Acc: 0.338 Test Loss: 2.048 Test Acc: 0.338
Validation loss decreased (-0.199978 --> -0.337817).  Saving model ...
Epoch: 4 cost time: 2.660841464996338
Epoch: 4, Steps: 17 | Train Loss: 1.999 Vali Loss: 1.920 Vali Acc: 0.435 Test Loss: 1.920 Test Acc: 0.435
Validation loss decreased (-0.337817 --> -0.435116).  Saving model ...
Epoch: 5 cost time: 2.571056842803955
Epoch: 5, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.809 Vali Acc: 0.489 Test Loss: 1.809 Test Acc: 0.489
Validation loss decreased (-0.435116 --> -0.489171).  Saving model ...
Epoch: 6 cost time: 2.97206449508667
Epoch: 6, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.686 Vali Acc: 0.557 Test Loss: 1.686 Test Acc: 0.557
Validation loss decreased (-0.489171 --> -0.556740).  Saving model ...
Epoch: 7 cost time: 2.9634313583374023
Epoch: 7, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.564 Vali Acc: 0.614 Test Loss: 1.564 Test Acc: 0.614
Validation loss decreased (-0.556740 --> -0.613498).  Saving model ...
Epoch: 8 cost time: 2.7189087867736816
Epoch: 8, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.463 Vali Acc: 0.627 Test Loss: 1.463 Test Acc: 0.627
Validation loss decreased (-0.613498 --> -0.627012).  Saving model ...
Epoch: 9 cost time: 2.990791082382202
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.354 Vali Acc: 0.646 Test Loss: 1.354 Test Acc: 0.646
Validation loss decreased (-0.627012 --> -0.645932).  Saving model ...
Epoch: 10 cost time: 2.6431186199188232
Epoch: 10, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.257 Vali Acc: 0.681 Test Loss: 1.257 Test Acc: 0.681
Validation loss decreased (-0.645932 --> -0.681069).  Saving model ...
Epoch: 11 cost time: 2.6774179935455322
Epoch: 11, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.151 Vali Acc: 0.705 Test Loss: 1.151 Test Acc: 0.705
Validation loss decreased (-0.681069 --> -0.705394).  Saving model ...
Epoch: 12 cost time: 2.6921744346618652
Epoch: 12, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.043 Vali Acc: 0.732 Test Loss: 1.043 Test Acc: 0.732
Validation loss decreased (-0.705394 --> -0.732422).  Saving model ...
Epoch: 13 cost time: 2.9218382835388184
Epoch: 13, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.946 Vali Acc: 0.773 Test Loss: 0.946 Test Acc: 0.773
Validation loss decreased (-0.732422 --> -0.772964).  Saving model ...
Epoch: 14 cost time: 3.0703446865081787
Epoch: 14, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.853 Vali Acc: 0.803 Test Loss: 0.853 Test Acc: 0.803
Validation loss decreased (-0.772964 --> -0.802694).  Saving model ...
Epoch: 15 cost time: 3.114043712615967
Epoch: 15, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.752 Vali Acc: 0.827 Test Loss: 0.752 Test Acc: 0.827
Validation loss decreased (-0.802694 --> -0.827020).  Saving model ...
Epoch: 16 cost time: 3.157026529312134
Epoch: 16, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.698 Vali Acc: 0.838 Test Loss: 0.698 Test Acc: 0.838
Validation loss decreased (-0.827020 --> -0.837831).  Saving model ...
Epoch: 17 cost time: 2.9903736114501953
Epoch: 17, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
Validation loss decreased (-0.837831 --> -0.870264).  Saving model ...
Epoch: 18 cost time: 3.189465045928955
Epoch: 18, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.592 Vali Acc: 0.862 Test Loss: 0.592 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9592576026916504
Epoch: 19, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.520 Vali Acc: 0.892 Test Loss: 0.520 Test Acc: 0.892
Validation loss decreased (-0.870264 --> -0.891887).  Saving model ...
Epoch: 20 cost time: 2.585141897201538
Epoch: 20, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.463 Vali Acc: 0.892 Test Loss: 0.463 Test Acc: 0.892
Validation loss decreased (-0.891887 --> -0.891887).  Saving model ...
Epoch: 21 cost time: 2.846268653869629
Epoch: 21, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.424 Vali Acc: 0.897 Test Loss: 0.424 Test Acc: 0.897
Validation loss decreased (-0.891887 --> -0.897293).  Saving model ...
Epoch: 22 cost time: 2.679260015487671
Epoch: 22, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.391 Vali Acc: 0.908 Test Loss: 0.391 Test Acc: 0.908
Validation loss decreased (-0.897293 --> -0.908104).  Saving model ...
Epoch: 23 cost time: 2.814563035964966
Epoch: 23, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.368 Vali Acc: 0.914 Test Loss: 0.368 Test Acc: 0.914
Validation loss decreased (-0.908104 --> -0.913510).  Saving model ...
Epoch: 24 cost time: 3.0091147422790527
Epoch: 24, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918916).  Saving model ...
Epoch: 25 cost time: 2.971942663192749
Epoch: 25, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
Epoch: 26 cost time: 3.0917303562164307
Epoch: 26, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 27 cost time: 3.1659157276153564
Epoch: 27, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 28 cost time: 3.18274188041687
Epoch: 28, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.139036178588867
Epoch: 29, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 30 cost time: 3.1767125129699707
Epoch: 30, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 31 cost time: 2.7970380783081055
Epoch: 31, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 32 cost time: 3.0263099670410156
Epoch: 32, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 33 cost time: 2.851813316345215
Epoch: 33, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8623275756835938
Epoch: 34, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 35 cost time: 3.213904619216919
Epoch: 35, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.816071033477783
Epoch: 36, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 37 cost time: 3.01302170753479
Epoch: 37, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.042187213897705
Epoch: 38, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 39 cost time: 3.034156084060669
Epoch: 39, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 40 cost time: 3.1448018550872803
Epoch: 40, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.954160213470459
Epoch: 41, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.794365882873535
Epoch: 42, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.774864673614502
Epoch: 43, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.6983652114868164
Epoch: 44, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.0583767890930176
Epoch: 45, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.8092470169067383
Epoch: 46, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.839970588684082
Epoch: 47, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 48 cost time: 3.381164073944092
Epoch: 48, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 49 cost time: 3.20513653755188
Epoch: 49, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 50 cost time: 3.083653211593628
Epoch: 50, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.1550960540771484
Epoch: 51, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.3657007217407227
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 53 cost time: 3.1130588054656982
Epoch: 53, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 54 cost time: 3.0594096183776855
Epoch: 54, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 55 cost time: 3.0449936389923096
Epoch: 55, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 56 cost time: 2.915280818939209
Epoch: 56, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.1003341674804688
Epoch: 57, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 58 cost time: 3.0962233543395996
Epoch: 58, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.2776615619659424
Epoch: 59, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.0530073642730713
Epoch: 60, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.0963118076324463
Epoch: 61, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.1178064346313477
Epoch: 62, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 63 cost time: 3.287076234817505
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 64 cost time: 3.274592876434326
Epoch: 64, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.8505144119262695
Epoch: 65, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.9928781986236572
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.9218690395355225
Epoch: 67, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.30533766746521
Epoch: 68, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 69 cost time: 2.9133799076080322
Epoch: 69, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 70 cost time: 3.0972344875335693
Epoch: 70, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 3.0885305404663086
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 3.3956098556518555
Epoch: 72, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 3.1460466384887695
Epoch: 73, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 74 cost time: 2.9503562450408936
Epoch: 74, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 75 cost time: 2.9214189052581787
Epoch: 75, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.789655923843384
Epoch: 76, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.9389712810516357
Epoch: 77, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 3.0532641410827637
Epoch: 78, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 3.122422933578491
Epoch: 79, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 2.9748001098632812
Epoch: 80, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 2.932415723800659
Epoch: 81, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 3.3450727462768555
Epoch: 82, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 2.9862349033355713
Epoch: 83, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 3.3598792552948
Epoch: 84, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 85 cost time: 3.0664076805114746
Epoch: 85, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 3.316584825515747
Epoch: 86, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 3.0501701831817627
Epoch: 87, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 2.9639222621917725
Epoch: 88, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 3.001755714416504
Epoch: 89, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 2.7367637157440186
Epoch: 90, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 3.001572608947754
Epoch: 91, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 2.69797945022583
Epoch: 92, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 3.0995137691497803
Epoch: 93, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 3.0119566917419434
Epoch: 94, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.476278066635132
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.244 Vali Acc: 0.108 Test Loss: 2.244 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 2.739443063735962
Epoch: 2, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.185 Vali Acc: 0.157 Test Loss: 2.185 Test Acc: 0.157
Validation loss decreased (-0.108086 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 2.691770315170288
Epoch: 3, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.112 Vali Acc: 0.281 Test Loss: 2.112 Test Acc: 0.281
Validation loss decreased (-0.156735 --> -0.281060).  Saving model ...
Epoch: 4 cost time: 2.6819660663604736
Epoch: 4, Steps: 17 | Train Loss: 2.051 Vali Loss: 2.019 Vali Acc: 0.368 Test Loss: 2.019 Test Acc: 0.368
Validation loss decreased (-0.281060 --> -0.367547).  Saving model ...
Epoch: 5 cost time: 2.934140682220459
Epoch: 5, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.933 Vali Acc: 0.443 Test Loss: 1.933 Test Acc: 0.443
Validation loss decreased (-0.367547 --> -0.443224).  Saving model ...
Epoch: 6 cost time: 2.8723368644714355
Epoch: 6, Steps: 17 | Train Loss: 1.832 Vali Loss: 1.834 Vali Acc: 0.492 Test Loss: 1.834 Test Acc: 0.492
Validation loss decreased (-0.443224 --> -0.491874).  Saving model ...
Epoch: 7 cost time: 2.923182964324951
Epoch: 7, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.727 Vali Acc: 0.578 Test Loss: 1.727 Test Acc: 0.578
Validation loss decreased (-0.491874 --> -0.578361).  Saving model ...
Epoch: 8 cost time: 3.2283639907836914
Epoch: 8, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.635 Vali Acc: 0.614 Test Loss: 1.635 Test Acc: 0.614
Validation loss decreased (-0.578361 --> -0.613497).  Saving model ...
Epoch: 9 cost time: 3.1101291179656982
Epoch: 9, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.530 Vali Acc: 0.638 Test Loss: 1.530 Test Acc: 0.638
Validation loss decreased (-0.613497 --> -0.637823).  Saving model ...
Epoch: 10 cost time: 3.0667381286621094
Epoch: 10, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.433 Vali Acc: 0.670 Test Loss: 1.433 Test Acc: 0.670
Validation loss decreased (-0.637823 --> -0.670256).  Saving model ...
Epoch: 11 cost time: 3.089653253555298
Epoch: 11, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.330 Vali Acc: 0.692 Test Loss: 1.330 Test Acc: 0.692
Validation loss decreased (-0.670256 --> -0.691879).  Saving model ...
Epoch: 12 cost time: 3.2664997577667236
Epoch: 12, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.208 Vali Acc: 0.727 Test Loss: 1.208 Test Acc: 0.727
Validation loss decreased (-0.691879 --> -0.727015).  Saving model ...
Epoch: 13 cost time: 3.490920305252075
Epoch: 13, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.094 Vali Acc: 0.759 Test Loss: 1.094 Test Acc: 0.759
Validation loss decreased (-0.727015 --> -0.759449).  Saving model ...
Epoch: 14 cost time: 3.0811853408813477
Epoch: 14, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.995 Vali Acc: 0.776 Test Loss: 0.995 Test Acc: 0.776
Validation loss decreased (-0.759449 --> -0.775666).  Saving model ...
Epoch: 15 cost time: 2.9311835765838623
Epoch: 15, Steps: 17 | Train Loss: 0.833 Vali Loss: 0.877 Vali Acc: 0.816 Test Loss: 0.877 Test Acc: 0.816
Validation loss decreased (-0.775666 --> -0.816207).  Saving model ...
Epoch: 16 cost time: 2.78727650642395
Epoch: 16, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.791 Vali Acc: 0.832 Test Loss: 0.791 Test Acc: 0.832
Validation loss decreased (-0.816207 --> -0.832425).  Saving model ...
Epoch: 17 cost time: 2.888352870941162
Epoch: 17, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.700 Vali Acc: 0.854 Test Loss: 0.700 Test Acc: 0.854
Validation loss decreased (-0.832425 --> -0.854047).  Saving model ...
Epoch: 18 cost time: 2.978597640991211
Epoch: 18, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.647 Vali Acc: 0.854 Test Loss: 0.647 Test Acc: 0.854
Validation loss decreased (-0.854047 --> -0.854048).  Saving model ...
Epoch: 19 cost time: 3.0547025203704834
Epoch: 19, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.599 Vali Acc: 0.865 Test Loss: 0.599 Test Acc: 0.865
Validation loss decreased (-0.854048 --> -0.864859).  Saving model ...
Epoch: 20 cost time: 3.1942875385284424
Epoch: 20, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.522 Vali Acc: 0.876 Test Loss: 0.522 Test Acc: 0.876
Validation loss decreased (-0.864859 --> -0.875670).  Saving model ...
Epoch: 21 cost time: 3.070401191711426
Epoch: 21, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
Validation loss decreased (-0.875670 --> -0.889184).  Saving model ...
Epoch: 22 cost time: 3.4409220218658447
Epoch: 22, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.428 Vali Acc: 0.897 Test Loss: 0.428 Test Acc: 0.897
Validation loss decreased (-0.889184 --> -0.897293).  Saving model ...
Epoch: 23 cost time: 3.0082266330718994
Epoch: 23, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.897293 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 3.1369194984436035
Epoch: 24, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.910807).  Saving model ...
Epoch: 25 cost time: 3.14853572845459
Epoch: 25, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
Validation loss decreased (-0.910807 --> -0.918916).  Saving model ...
Epoch: 26 cost time: 2.681507110595703
Epoch: 26, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.311 Vali Acc: 0.924 Test Loss: 0.311 Test Acc: 0.924
Validation loss decreased (-0.918916 --> -0.924321).  Saving model ...
Epoch: 27 cost time: 2.986656665802002
Epoch: 27, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.266 Vali Acc: 0.927 Test Loss: 0.266 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 28 cost time: 2.839306116104126
Epoch: 28, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 29 cost time: 2.6899540424346924
Epoch: 29, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 30 cost time: 2.9474120140075684
Epoch: 30, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 3.1738085746765137
Epoch: 31, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 32 cost time: 3.206404685974121
Epoch: 32, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 3.031825542449951
Epoch: 33, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 34 cost time: 3.0940654277801514
Epoch: 34, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.161391496658325
Epoch: 35, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.96838116645813
Epoch: 36, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.8675246238708496
Epoch: 37, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 38 cost time: 2.6498091220855713
Epoch: 38, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 39 cost time: 2.885702133178711
Epoch: 39, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 40 cost time: 2.9407284259796143
Epoch: 40, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.099775552749634
Epoch: 41, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.252426862716675
Epoch: 42, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.0597083568573
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.2346227169036865
Epoch: 44, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.126713514328003
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.0171828269958496
Epoch: 46, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 47 cost time: 3.3888227939605713
Epoch: 47, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 48 cost time: 2.8177270889282227
Epoch: 48, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.955451726913452
Epoch: 49, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.030076026916504
Epoch: 50, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.88346529006958
Epoch: 51, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.0675151348114014
Epoch: 52, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.736485481262207
Epoch: 53, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.092683792114258
Epoch: 54, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.0761847496032715
Epoch: 55, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.1600825786590576
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.929609537124634
Epoch: 57, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 58 cost time: 2.773775577545166
Epoch: 58, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 59 cost time: 2.9336752891540527
Epoch: 59, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.856991767883301
Epoch: 60, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 61 cost time: 2.8953139781951904
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 62 cost time: 2.6275289058685303
Epoch: 62, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.951078414916992
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.536454439163208
Epoch: 64, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.1692121028900146
Epoch: 65, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.2011876106262207
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.399134397506714
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 3.436237335205078
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 3.297973871231079
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 3.255157709121704
Epoch: 70, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 71 cost time: 3.0399527549743652
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.831045389175415
Epoch: 72, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.039008140563965
Epoch: 73, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.956151247024536
Epoch: 74, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.252822160720825
Epoch: 75, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.2030999660491943
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.4381182193756104
Epoch: 77, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.064906120300293
Epoch: 78, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 3.091737985610962
Epoch: 79, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.962 Test Loss: 0.087 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 2.9615650177001953
Epoch: 80, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.866194248199463
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.240 Vali Acc: 0.084 Test Loss: 2.240 Test Acc: 0.084
Validation loss decreased (inf --> -0.083761).  Saving model ...
Epoch: 2 cost time: 2.731637716293335
Epoch: 2, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.192 Vali Acc: 0.114 Test Loss: 2.192 Test Acc: 0.114
Validation loss decreased (-0.083761 --> -0.113492).  Saving model ...
Epoch: 3 cost time: 2.935865879058838
Epoch: 3, Steps: 17 | Train Loss: 2.141 Vali Loss: 2.132 Vali Acc: 0.189 Test Loss: 2.132 Test Acc: 0.189
Validation loss decreased (-0.113492 --> -0.189168).  Saving model ...
Epoch: 4 cost time: 2.7261767387390137
Epoch: 4, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.053 Vali Acc: 0.249 Test Loss: 2.053 Test Acc: 0.249
Validation loss decreased (-0.189168 --> -0.248628).  Saving model ...
Epoch: 5 cost time: 2.9160547256469727
Epoch: 5, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.975 Vali Acc: 0.319 Test Loss: 1.975 Test Acc: 0.319
Validation loss decreased (-0.248628 --> -0.318899).  Saving model ...
Epoch: 6 cost time: 3.1338870525360107
Epoch: 6, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.884 Vali Acc: 0.378 Test Loss: 1.884 Test Acc: 0.378
Validation loss decreased (-0.318899 --> -0.378360).  Saving model ...
Epoch: 7 cost time: 3.1133909225463867
Epoch: 7, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.788 Vali Acc: 0.441 Test Loss: 1.788 Test Acc: 0.441
Validation loss decreased (-0.378360 --> -0.440523).  Saving model ...
Epoch: 8 cost time: 2.890194892883301
Epoch: 8, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.690 Vali Acc: 0.514 Test Loss: 1.690 Test Acc: 0.514
Validation loss decreased (-0.440523 --> -0.513497).  Saving model ...
Epoch: 9 cost time: 2.923757314682007
Epoch: 9, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.582 Vali Acc: 0.581 Test Loss: 1.582 Test Acc: 0.581
Validation loss decreased (-0.513497 --> -0.581065).  Saving model ...
Epoch: 10 cost time: 2.929610013961792
Epoch: 10, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.470 Vali Acc: 0.627 Test Loss: 1.470 Test Acc: 0.627
Validation loss decreased (-0.581065 --> -0.627012).  Saving model ...
Epoch: 11 cost time: 3.1553380489349365
Epoch: 11, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.353 Vali Acc: 0.657 Test Loss: 1.353 Test Acc: 0.657
Validation loss decreased (-0.627012 --> -0.656743).  Saving model ...
Epoch: 12 cost time: 3.085706949234009
Epoch: 12, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.229 Vali Acc: 0.681 Test Loss: 1.229 Test Acc: 0.681
Validation loss decreased (-0.656743 --> -0.681069).  Saving model ...
Epoch: 13 cost time: 3.1181418895721436
Epoch: 13, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.099 Vali Acc: 0.711 Test Loss: 1.099 Test Acc: 0.711
Validation loss decreased (-0.681069 --> -0.710800).  Saving model ...
Epoch: 14 cost time: 2.8034555912017822
Epoch: 14, Steps: 17 | Train Loss: 1.012 Vali Loss: 0.999 Vali Acc: 0.738 Test Loss: 0.999 Test Acc: 0.738
Validation loss decreased (-0.710800 --> -0.737828).  Saving model ...
Epoch: 15 cost time: 2.9496805667877197
Epoch: 15, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.880 Vali Acc: 0.784 Test Loss: 0.880 Test Acc: 0.784
Validation loss decreased (-0.737828 --> -0.783775).  Saving model ...
Epoch: 16 cost time: 3.0842368602752686
Epoch: 16, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.796 Vali Acc: 0.808 Test Loss: 0.796 Test Acc: 0.808
Validation loss decreased (-0.783775 --> -0.808100).  Saving model ...
Epoch: 17 cost time: 3.3854618072509766
Epoch: 17, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.702 Vali Acc: 0.832 Test Loss: 0.702 Test Acc: 0.832
Validation loss decreased (-0.808100 --> -0.832425).  Saving model ...
Epoch: 18 cost time: 3.1720707416534424
Epoch: 18, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
Validation loss decreased (-0.832425 --> -0.859453).  Saving model ...
Epoch: 19 cost time: 2.899231195449829
Epoch: 19, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.587 Vali Acc: 0.865 Test Loss: 0.587 Test Acc: 0.865
Validation loss decreased (-0.859453 --> -0.864859).  Saving model ...
Epoch: 20 cost time: 3.1148033142089844
Epoch: 20, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
Validation loss decreased (-0.864859 --> -0.889184).  Saving model ...
Epoch: 21 cost time: 3.127680540084839
Epoch: 21, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.889184 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 2.969644546508789
Epoch: 22, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.431 Vali Acc: 0.908 Test Loss: 0.431 Test Acc: 0.908
Validation loss decreased (-0.899995 --> -0.908104).  Saving model ...
Epoch: 23 cost time: 3.1118128299713135
Epoch: 23, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910807).  Saving model ...
Epoch: 24 cost time: 3.3122313022613525
Epoch: 24, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.349 Vali Acc: 0.924 Test Loss: 0.349 Test Acc: 0.924
Validation loss decreased (-0.910807 --> -0.924321).  Saving model ...
Epoch: 25 cost time: 3.1594133377075195
Epoch: 25, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2848541736602783
Epoch: 26, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.17008113861084
Epoch: 27, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2519121170043945
Epoch: 28, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.261 Vali Acc: 0.924 Test Loss: 0.261 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924322).  Saving model ...
Epoch: 29 cost time: 3.367424964904785
Epoch: 29, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.236 Vali Acc: 0.924 Test Loss: 0.236 Test Acc: 0.924
Validation loss decreased (-0.924322 --> -0.924322).  Saving model ...
Epoch: 30 cost time: 3.627321720123291
Epoch: 30, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.231 Vali Acc: 0.919 Test Loss: 0.231 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4942846298217773
Epoch: 31, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.218 Vali Acc: 0.938 Test Loss: 0.218 Test Acc: 0.938
Validation loss decreased (-0.924322 --> -0.937836).  Saving model ...
Epoch: 32 cost time: 3.5703673362731934
Epoch: 32, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.393628835678101
Epoch: 33, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.207 Vali Acc: 0.924 Test Loss: 0.207 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.348039150238037
Epoch: 34, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.992304801940918
Epoch: 35, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 36 cost time: 4.046495199203491
Epoch: 36, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.180 Vali Acc: 0.932 Test Loss: 0.180 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7824764251708984
Epoch: 37, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.9684221744537354
Epoch: 38, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.323347330093384
Epoch: 39, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.935 Test Loss: 0.160 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.23255729675293
Epoch: 40, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.932 Test Loss: 0.170 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.191494703292847
Epoch: 41, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.935 Test Loss: 0.158 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.313664197921753
Epoch: 42, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 43 cost time: 4.6015894412994385
Epoch: 43, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.932 Test Loss: 0.167 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.922856330871582
Epoch: 44, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.930 Test Loss: 0.164 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.930114984512329
Epoch: 45, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.927 Test Loss: 0.157 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.05899977684021
Epoch: 46, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 47 cost time: 3.770949125289917
Epoch: 47, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.9411981105804443
Epoch: 48, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.871432065963745
Epoch: 49, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 50 cost time: 4.955439329147339
Epoch: 50, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.946 Test Loss: 0.127 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 4.205060243606567
Epoch: 51, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.946 Test Loss: 0.125 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 4.309556722640991
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.946 Test Loss: 0.124 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.580512523651123
Epoch: 53, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.946 Test Loss: 0.127 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 4.725306987762451
Epoch: 54, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 55 cost time: 4.898662328720093
Epoch: 55, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 56 cost time: 4.599953651428223
Epoch: 56, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 57 cost time: 5.326978921890259
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 58 cost time: 5.020102262496948
Epoch: 58, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 4.62137508392334
Epoch: 59, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 4.84976601600647
Epoch: 60, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 61 cost time: 4.674242973327637
Epoch: 61, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 62 cost time: 4.262580633163452
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 4.4529335498809814
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 4.8682661056518555
Epoch: 64, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 4.217911243438721
Epoch: 65, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 4.868452787399292
Epoch: 66, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.943 Test Loss: 0.126 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 4.162201404571533
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 4.566990852355957
Epoch: 68, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 4.574404239654541
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 4.71925950050354
Epoch: 70, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 4.802788734436035
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.208195447921753
Epoch: 1, Steps: 17 | Train Loss: 2.237 Vali Loss: 2.216 Vali Acc: 0.135 Test Loss: 2.216 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 4.944449424743652
Epoch: 2, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.175 Vali Acc: 0.151 Test Loss: 2.175 Test Acc: 0.151
Validation loss decreased (-0.135113 --> -0.151330).  Saving model ...
Epoch: 3 cost time: 4.892498016357422
Epoch: 3, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.123 Vali Acc: 0.195 Test Loss: 2.123 Test Acc: 0.195
Validation loss decreased (-0.151330 --> -0.194573).  Saving model ...
Epoch: 4 cost time: 4.302015542984009
Epoch: 4, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.050 Vali Acc: 0.265 Test Loss: 2.050 Test Acc: 0.265
Validation loss decreased (-0.194573 --> -0.264844).  Saving model ...
Epoch: 5 cost time: 4.054156303405762
Epoch: 5, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.975 Vali Acc: 0.351 Test Loss: 1.975 Test Acc: 0.351
Validation loss decreased (-0.264844 --> -0.351332).  Saving model ...
Epoch: 6 cost time: 4.032350063323975
Epoch: 6, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.883 Vali Acc: 0.476 Test Loss: 1.883 Test Acc: 0.476
Validation loss decreased (-0.351332 --> -0.475657).  Saving model ...
Epoch: 7 cost time: 4.270176649093628
Epoch: 7, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.778 Vali Acc: 0.586 Test Loss: 1.778 Test Acc: 0.586
Validation loss decreased (-0.475657 --> -0.586469).  Saving model ...
Epoch: 8 cost time: 4.813648700714111
Epoch: 8, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.670 Vali Acc: 0.654 Test Loss: 1.670 Test Acc: 0.654
Validation loss decreased (-0.586469 --> -0.654037).  Saving model ...
Epoch: 9 cost time: 4.715386867523193
Epoch: 9, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.551 Vali Acc: 0.695 Test Loss: 1.551 Test Acc: 0.695
Validation loss decreased (-0.654037 --> -0.694579).  Saving model ...
Epoch: 10 cost time: 4.481806993484497
Epoch: 10, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.442 Vali Acc: 0.730 Test Loss: 1.442 Test Acc: 0.730
Validation loss decreased (-0.694579 --> -0.729715).  Saving model ...
Epoch: 11 cost time: 4.0458550453186035
Epoch: 11, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.340 Vali Acc: 0.727 Test Loss: 1.340 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.351843357086182
Epoch: 12, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.229 Vali Acc: 0.765 Test Loss: 1.229 Test Acc: 0.765
Validation loss decreased (-0.729715 --> -0.764853).  Saving model ...
Epoch: 13 cost time: 4.21036171913147
Epoch: 13, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.122 Vali Acc: 0.770 Test Loss: 1.122 Test Acc: 0.770
Validation loss decreased (-0.764853 --> -0.770259).  Saving model ...
Epoch: 14 cost time: 4.978081941604614
Epoch: 14, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.027 Vali Acc: 0.786 Test Loss: 1.027 Test Acc: 0.786
Validation loss decreased (-0.770259 --> -0.786476).  Saving model ...
Epoch: 15 cost time: 5.2909088134765625
Epoch: 15, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.892 Vali Acc: 0.830 Test Loss: 0.892 Test Acc: 0.830
Validation loss decreased (-0.786476 --> -0.829721).  Saving model ...
Epoch: 16 cost time: 5.165642976760864
Epoch: 16, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.815 Vali Acc: 0.819 Test Loss: 0.815 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.650874137878418
Epoch: 17, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.713 Vali Acc: 0.851 Test Loss: 0.713 Test Acc: 0.851
Validation loss decreased (-0.829721 --> -0.851344).  Saving model ...
Epoch: 18 cost time: 5.034905433654785
Epoch: 18, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.651 Vali Acc: 0.838 Test Loss: 0.651 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.074987411499023
Epoch: 19, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.601 Vali Acc: 0.843 Test Loss: 0.601 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.395797967910767
Epoch: 20, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.512 Vali Acc: 0.876 Test Loss: 0.512 Test Acc: 0.876
Validation loss decreased (-0.851344 --> -0.875671).  Saving model ...
Epoch: 21 cost time: 4.6081671714782715
Epoch: 21, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.478 Vali Acc: 0.873 Test Loss: 0.478 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.075577974319458
Epoch: 22, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.434 Vali Acc: 0.886 Test Loss: 0.434 Test Acc: 0.886
Validation loss decreased (-0.875671 --> -0.886482).  Saving model ...
Epoch: 23 cost time: 5.228206634521484
Epoch: 23, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.410 Vali Acc: 0.886 Test Loss: 0.410 Test Acc: 0.886
Validation loss decreased (-0.886482 --> -0.886482).  Saving model ...
Epoch: 24 cost time: 4.309154033660889
Epoch: 24, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.371 Vali Acc: 0.886 Test Loss: 0.371 Test Acc: 0.886
Validation loss decreased (-0.886482 --> -0.886483).  Saving model ...
Epoch: 25 cost time: 4.44518256187439
Epoch: 25, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.333 Vali Acc: 0.914 Test Loss: 0.333 Test Acc: 0.914
Validation loss decreased (-0.886483 --> -0.913510).  Saving model ...
Epoch: 26 cost time: 5.0437331199646
Epoch: 26, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.625341176986694
Epoch: 27, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918916).  Saving model ...
Epoch: 28 cost time: 4.453567028045654
Epoch: 28, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
Epoch: 29 cost time: 5.538121461868286
Epoch: 29, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 30 cost time: 4.936517238616943
Epoch: 30, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.250 Vali Acc: 0.927 Test Loss: 0.250 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 31 cost time: 5.302314758300781
Epoch: 31, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.927025 --> -0.932430).  Saving model ...
Epoch: 32 cost time: 4.715521812438965
Epoch: 32, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.233 Vali Acc: 0.924 Test Loss: 0.233 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.150985240936279
Epoch: 33, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.241 Vali Acc: 0.916 Test Loss: 0.241 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.654255151748657
Epoch: 34, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 35 cost time: 5.276659250259399
Epoch: 35, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.721571922302246
Epoch: 36, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 37 cost time: 5.145455598831177
Epoch: 37, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.189 Vali Acc: 0.932 Test Loss: 0.189 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.115149259567261
Epoch: 38, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 39 cost time: 4.751432657241821
Epoch: 39, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 4.886346340179443
Epoch: 40, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 41 cost time: 4.931248188018799
Epoch: 41, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 42 cost time: 4.559603691101074
Epoch: 42, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.575742483139038
Epoch: 43, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.00788426399231
Epoch: 44, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.921811580657959
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 46 cost time: 5.248870134353638
Epoch: 46, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 47 cost time: 5.2946131229400635
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 48 cost time: 4.771417856216431
Epoch: 48, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 4.868805885314941
Epoch: 49, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 4.453115701675415
Epoch: 50, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 51 cost time: 4.288450002670288
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 52 cost time: 4.273952484130859
Epoch: 52, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.558980941772461
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 54 cost time: 4.21910834312439
Epoch: 54, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 4.694410085678101
Epoch: 55, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 4.777281761169434
Epoch: 56, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.930 Test Loss: 0.161 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.258774995803833
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.946 Test Loss: 0.132 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 4.914219856262207
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.144 Vali Acc: 0.941 Test Loss: 0.144 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 4.868748903274536
Epoch: 59, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.946 Test Loss: 0.136 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 4.7901716232299805
Epoch: 60, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.946 Test Loss: 0.124 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 5.345494747161865
Epoch: 61, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 5.070874929428101
Epoch: 62, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 5.553761959075928
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.547384023666382
Epoch: 1, Steps: 17 | Train Loss: 2.252 Vali Loss: 2.204 Vali Acc: 0.173 Test Loss: 2.204 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 5.802690505981445
Epoch: 2, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.154 Vali Acc: 0.219 Test Loss: 2.154 Test Acc: 0.219
Validation loss decreased (-0.172951 --> -0.218897).  Saving model ...
Epoch: 3 cost time: 5.335527420043945
Epoch: 3, Steps: 17 | Train Loss: 2.150 Vali Loss: 2.090 Vali Acc: 0.257 Test Loss: 2.090 Test Acc: 0.257
Validation loss decreased (-0.218897 --> -0.256736).  Saving model ...
Epoch: 4 cost time: 5.306293725967407
Epoch: 4, Steps: 17 | Train Loss: 2.118 Vali Loss: 2.006 Vali Acc: 0.357 Test Loss: 2.006 Test Acc: 0.357
Validation loss decreased (-0.256736 --> -0.356737).  Saving model ...
Epoch: 5 cost time: 4.937609434127808
Epoch: 5, Steps: 17 | Train Loss: 2.055 Vali Loss: 1.920 Vali Acc: 0.441 Test Loss: 1.920 Test Acc: 0.441
Validation loss decreased (-0.356737 --> -0.440521).  Saving model ...
Epoch: 6 cost time: 5.594252586364746
Epoch: 6, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.820 Vali Acc: 0.535 Test Loss: 1.820 Test Acc: 0.535
Validation loss decreased (-0.440521 --> -0.535117).  Saving model ...
Epoch: 7 cost time: 4.983182668685913
Epoch: 7, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.714 Vali Acc: 0.624 Test Loss: 1.714 Test Acc: 0.624
Validation loss decreased (-0.535117 --> -0.624307).  Saving model ...
Epoch: 8 cost time: 5.1027185916900635
Epoch: 8, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.611 Vali Acc: 0.657 Test Loss: 1.611 Test Acc: 0.657
Validation loss decreased (-0.624307 --> -0.656741).  Saving model ...
Epoch: 9 cost time: 5.1200666427612305
Epoch: 9, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.494 Vali Acc: 0.686 Test Loss: 1.494 Test Acc: 0.686
Validation loss decreased (-0.656741 --> -0.686472).  Saving model ...
Epoch: 10 cost time: 4.935863733291626
Epoch: 10, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.393 Vali Acc: 0.695 Test Loss: 1.393 Test Acc: 0.695
Validation loss decreased (-0.686472 --> -0.694581).  Saving model ...
Epoch: 11 cost time: 5.373698472976685
Epoch: 11, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.287 Vali Acc: 0.705 Test Loss: 1.287 Test Acc: 0.705
Validation loss decreased (-0.694581 --> -0.705393).  Saving model ...
Epoch: 12 cost time: 5.899835824966431
Epoch: 12, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.155 Vali Acc: 0.749 Test Loss: 1.155 Test Acc: 0.749
Validation loss decreased (-0.705393 --> -0.748637).  Saving model ...
Epoch: 13 cost time: 4.882311582565308
Epoch: 13, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.040 Vali Acc: 0.797 Test Loss: 1.040 Test Acc: 0.797
Validation loss decreased (-0.748637 --> -0.797287).  Saving model ...
Epoch: 14 cost time: 5.278641223907471
Epoch: 14, Steps: 17 | Train Loss: 1.029 Vali Loss: 0.952 Vali Acc: 0.781 Test Loss: 0.952 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.396103620529175
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.825 Vali Acc: 0.835 Test Loss: 0.825 Test Acc: 0.835
Validation loss decreased (-0.797287 --> -0.835127).  Saving model ...
Epoch: 16 cost time: 4.881347894668579
Epoch: 16, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.762 Vali Acc: 0.849 Test Loss: 0.762 Test Acc: 0.849
Validation loss decreased (-0.835127 --> -0.848641).  Saving model ...
Epoch: 17 cost time: 4.858765363693237
Epoch: 17, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.667 Vali Acc: 0.857 Test Loss: 0.667 Test Acc: 0.857
Validation loss decreased (-0.848641 --> -0.856750).  Saving model ...
Epoch: 18 cost time: 4.9777915477752686
Epoch: 18, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.632 Vali Acc: 0.849 Test Loss: 0.632 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.196313142776489
Epoch: 19, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.563 Vali Acc: 0.857 Test Loss: 0.563 Test Acc: 0.857
Validation loss decreased (-0.856750 --> -0.856751).  Saving model ...
Epoch: 20 cost time: 6.274048805236816
Epoch: 20, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.480 Vali Acc: 0.886 Test Loss: 0.480 Test Acc: 0.886
Validation loss decreased (-0.856751 --> -0.886482).  Saving model ...
Epoch: 21 cost time: 6.0783469676971436
Epoch: 21, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.436 Vali Acc: 0.886 Test Loss: 0.436 Test Acc: 0.886
Validation loss decreased (-0.886482 --> -0.886482).  Saving model ...
Epoch: 22 cost time: 5.016409397125244
Epoch: 22, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.406 Vali Acc: 0.895 Test Loss: 0.406 Test Acc: 0.895
Validation loss decreased (-0.886482 --> -0.894591).  Saving model ...
Epoch: 23 cost time: 4.793261289596558
Epoch: 23, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.377 Vali Acc: 0.895 Test Loss: 0.377 Test Acc: 0.895
Validation loss decreased (-0.894591 --> -0.894591).  Saving model ...
Epoch: 24 cost time: 5.637935400009155
Epoch: 24, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.894591 --> -0.921618).  Saving model ...
Epoch: 25 cost time: 6.510667085647583
Epoch: 25, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.316 Vali Acc: 0.908 Test Loss: 0.316 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.183248519897461
Epoch: 26, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.303 Vali Acc: 0.914 Test Loss: 0.303 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.025620222091675
Epoch: 27, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921619).  Saving model ...
Epoch: 28 cost time: 5.050783395767212
Epoch: 28, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 29 cost time: 4.72311806678772
Epoch: 29, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.929727 --> -0.940538).  Saving model ...
Epoch: 30 cost time: 5.469958782196045
Epoch: 30, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.8073272705078125
Epoch: 31, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.016104698181152
Epoch: 32, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.017206192016602
Epoch: 33, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.223 Vali Acc: 0.924 Test Loss: 0.223 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.563149690628052
Epoch: 34, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.531596422195435
Epoch: 35, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.196 Vali Acc: 0.932 Test Loss: 0.196 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.14565896987915
Epoch: 36, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.469245433807373
Epoch: 37, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.313802003860474
Epoch: 38, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.985592842102051
Epoch: 39, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.809015512466431
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 5.354570150375366
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.904303550720215
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.3826165199279785
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.991318225860596
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.3197033405303955
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.820965766906738
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 8 cost time: 4.790377616882324
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 9 cost time: 4.943624019622803
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
Validation loss decreased (-0.108086 --> -0.135113).  Saving model ...
Epoch: 10 cost time: 5.12228536605835
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.592849016189575
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.48330020904541
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.869523048400879
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.448246479034424
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.845576047897339
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.018604278564453
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.2401158809661865
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.387008905410767
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.135 Test Loss: 2.196 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.686921119689941
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.196 Vali Acc: 0.108 Test Loss: 2.196 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.13513513513513514
model parameter : 231241
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.888298273086548
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.124 Vali Acc: 0.192 Test Loss: 2.124 Test Acc: 0.192
Validation loss decreased (inf --> -0.191871).  Saving model ...
Epoch: 2 cost time: 5.607426881790161
Epoch: 2, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.038 Vali Acc: 0.330 Test Loss: 2.038 Test Acc: 0.330
Validation loss decreased (-0.191871 --> -0.329709).  Saving model ...
Epoch: 3 cost time: 5.963392496109009
Epoch: 3, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.933 Vali Acc: 0.476 Test Loss: 1.933 Test Acc: 0.476
Validation loss decreased (-0.329709 --> -0.475656).  Saving model ...
Epoch: 4 cost time: 4.913693428039551
Epoch: 4, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.817 Vali Acc: 0.573 Test Loss: 1.817 Test Acc: 0.573
Validation loss decreased (-0.475656 --> -0.572955).  Saving model ...
Epoch: 5 cost time: 5.497889995574951
Epoch: 5, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.691 Vali Acc: 0.643 Test Loss: 1.691 Test Acc: 0.643
Validation loss decreased (-0.572955 --> -0.643226).  Saving model ...
Epoch: 6 cost time: 4.869657278060913
Epoch: 6, Steps: 17 | Train Loss: 1.662 Vali Loss: 1.575 Vali Acc: 0.649 Test Loss: 1.575 Test Acc: 0.649
Validation loss decreased (-0.643226 --> -0.648633).  Saving model ...
Epoch: 7 cost time: 4.653444051742554
Epoch: 7, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.456 Vali Acc: 0.681 Test Loss: 1.456 Test Acc: 0.681
Validation loss decreased (-0.648633 --> -0.681067).  Saving model ...
Epoch: 8 cost time: 6.11947774887085
Epoch: 8, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.339 Vali Acc: 0.705 Test Loss: 1.339 Test Acc: 0.705
Validation loss decreased (-0.681067 --> -0.705392).  Saving model ...
Epoch: 9 cost time: 6.55394434928894
Epoch: 9, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.223 Vali Acc: 0.730 Test Loss: 1.223 Test Acc: 0.730
Validation loss decreased (-0.705392 --> -0.729717).  Saving model ...
Epoch: 10 cost time: 5.7160468101501465
Epoch: 10, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.118 Vali Acc: 0.773 Test Loss: 1.118 Test Acc: 0.773
Validation loss decreased (-0.729717 --> -0.772962).  Saving model ...
Epoch: 11 cost time: 5.581048250198364
Epoch: 11, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.025 Vali Acc: 0.805 Test Loss: 1.025 Test Acc: 0.805
Validation loss decreased (-0.772962 --> -0.805395).  Saving model ...
Epoch: 12 cost time: 5.849977970123291
Epoch: 12, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.945 Vali Acc: 0.811 Test Loss: 0.945 Test Acc: 0.811
Validation loss decreased (-0.805395 --> -0.810801).  Saving model ...
Epoch: 13 cost time: 5.8717241287231445
Epoch: 13, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.858 Vali Acc: 0.816 Test Loss: 0.858 Test Acc: 0.816
Validation loss decreased (-0.810801 --> -0.816208).  Saving model ...
Epoch: 14 cost time: 5.684037923812866
Epoch: 14, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
Validation loss decreased (-0.816208 --> -0.818911).  Saving model ...
Epoch: 15 cost time: 6.278436660766602
Epoch: 15, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
Validation loss decreased (-0.818911 --> -0.840533).  Saving model ...
Epoch: 16 cost time: 6.614011526107788
Epoch: 16, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.668 Vali Acc: 0.849 Test Loss: 0.668 Test Acc: 0.849
Validation loss decreased (-0.840533 --> -0.848642).  Saving model ...
Epoch: 17 cost time: 6.267946720123291
Epoch: 17, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.604 Vali Acc: 0.865 Test Loss: 0.604 Test Acc: 0.865
Validation loss decreased (-0.848642 --> -0.864859).  Saving model ...
Epoch: 18 cost time: 6.0382630825042725
Epoch: 18, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.550 Vali Acc: 0.868 Test Loss: 0.550 Test Acc: 0.868
Validation loss decreased (-0.864859 --> -0.867562).  Saving model ...
Epoch: 19 cost time: 5.734912395477295
Epoch: 19, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.517 Vali Acc: 0.886 Test Loss: 0.517 Test Acc: 0.886
Validation loss decreased (-0.867562 --> -0.886481).  Saving model ...
Epoch: 20 cost time: 5.83345890045166
Epoch: 20, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
Validation loss decreased (-0.886481 --> -0.889184).  Saving model ...
Epoch: 21 cost time: 4.996907711029053
Epoch: 21, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
Validation loss decreased (-0.889184 --> -0.897293).  Saving model ...
Epoch: 22 cost time: 4.712019920349121
Epoch: 22, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.394 Vali Acc: 0.908 Test Loss: 0.394 Test Acc: 0.908
Validation loss decreased (-0.897293 --> -0.908104).  Saving model ...
Epoch: 23 cost time: 5.581259727478027
Epoch: 23, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.376 Vali Acc: 0.914 Test Loss: 0.376 Test Acc: 0.914
Validation loss decreased (-0.908104 --> -0.913510).  Saving model ...
Epoch: 24 cost time: 5.608390808105469
Epoch: 24, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.345 Vali Acc: 0.922 Test Loss: 0.345 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921618).  Saving model ...
Epoch: 25 cost time: 5.4698638916015625
Epoch: 25, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.326 Vali Acc: 0.916 Test Loss: 0.326 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.9490814208984375
Epoch: 26, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.093421936035156
Epoch: 27, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.274 Vali Acc: 0.927 Test Loss: 0.274 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 28 cost time: 5.0098841190338135
Epoch: 28, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 29 cost time: 5.784177780151367
Epoch: 29, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 30 cost time: 6.518084526062012
Epoch: 30, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 31 cost time: 6.412211179733276
Epoch: 31, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 32 cost time: 6.817486763000488
Epoch: 32, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 33 cost time: 6.364101886749268
Epoch: 33, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 34 cost time: 5.461862087249756
Epoch: 34, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 35 cost time: 5.482422828674316
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.199 Vali Acc: 0.932 Test Loss: 0.199 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.955806493759155
Epoch: 36, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 37 cost time: 4.684815883636475
Epoch: 37, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.091093063354492
Epoch: 38, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 39 cost time: 4.663619041442871
Epoch: 39, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 40 cost time: 6.200636863708496
Epoch: 40, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.035872220993042
Epoch: 41, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 42 cost time: 6.148573398590088
Epoch: 42, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.691626787185669
Epoch: 43, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 44 cost time: 6.135964393615723
Epoch: 44, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 45 cost time: 5.132500171661377
Epoch: 45, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.297340393066406
Epoch: 46, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 47 cost time: 5.63182258605957
Epoch: 47, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.6472694873809814
Epoch: 48, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.057098150253296
Epoch: 49, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.833012819290161
Epoch: 50, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.659842491149902
Epoch: 51, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 5.725393533706665
Epoch: 52, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 5.161304473876953
Epoch: 53, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 54 cost time: 5.884393692016602
Epoch: 54, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.257917404174805
Epoch: 55, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.2557737827301025
Epoch: 56, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.464554071426392
Epoch: 57, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.549099445343018
Epoch: 58, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 59 cost time: 5.523661375045776
Epoch: 59, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.514565944671631
Epoch: 60, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.667571783065796
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.102814197540283
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 4.853368043899536
Epoch: 63, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.144608497619629
Epoch: 64, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 65 cost time: 5.2383198738098145
Epoch: 65, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.267994165420532
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.531560659408569
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 68 cost time: 6.276991605758667
Epoch: 68, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.8625757694244385
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 70 cost time: 6.146203279495239
Epoch: 70, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.88789701461792
Epoch: 71, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 72 cost time: 5.803207874298096
Epoch: 72, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 73 cost time: 6.877292633056641
Epoch: 73, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.634255409240723
Epoch: 74, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 6.052297830581665
Epoch: 75, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 5.769704103469849
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 6.032667636871338
Epoch: 77, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 5.24710488319397
Epoch: 78, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 5.61704683303833
Epoch: 79, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 5.739189863204956
Epoch: 80, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 6.3596696853637695
Epoch: 81, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 4.985485553741455
Epoch: 82, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.548614501953125
Epoch: 1, Steps: 17 | Train Loss: 2.215 Vali Loss: 2.159 Vali Acc: 0.173 Test Loss: 2.159 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 5.112378120422363
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.096 Vali Acc: 0.222 Test Loss: 2.096 Test Acc: 0.222
Validation loss decreased (-0.172951 --> -0.221601).  Saving model ...
Epoch: 3 cost time: 5.538011312484741
Epoch: 3, Steps: 17 | Train Loss: 2.092 Vali Loss: 2.017 Vali Acc: 0.316 Test Loss: 2.017 Test Acc: 0.316
Validation loss decreased (-0.221601 --> -0.316196).  Saving model ...
Epoch: 4 cost time: 6.204457998275757
Epoch: 4, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.926 Vali Acc: 0.438 Test Loss: 1.926 Test Acc: 0.438
Validation loss decreased (-0.316196 --> -0.437819).  Saving model ...
Epoch: 5 cost time: 4.762424945831299
Epoch: 5, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.822 Vali Acc: 0.559 Test Loss: 1.822 Test Acc: 0.559
Validation loss decreased (-0.437819 --> -0.559441).  Saving model ...
Epoch: 6 cost time: 5.120726108551025
Epoch: 6, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.724 Vali Acc: 0.595 Test Loss: 1.724 Test Acc: 0.595
Validation loss decreased (-0.559441 --> -0.594577).  Saving model ...
Epoch: 7 cost time: 5.2669031620025635
Epoch: 7, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.614 Vali Acc: 0.641 Test Loss: 1.614 Test Acc: 0.641
Validation loss decreased (-0.594577 --> -0.640524).  Saving model ...
Epoch: 8 cost time: 5.104482412338257
Epoch: 8, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.500 Vali Acc: 0.670 Test Loss: 1.500 Test Acc: 0.670
Validation loss decreased (-0.640524 --> -0.670255).  Saving model ...
Epoch: 9 cost time: 4.957274913787842
Epoch: 9, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.381 Vali Acc: 0.695 Test Loss: 1.381 Test Acc: 0.695
Validation loss decreased (-0.670255 --> -0.694581).  Saving model ...
Epoch: 10 cost time: 4.350224494934082
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.269 Vali Acc: 0.730 Test Loss: 1.269 Test Acc: 0.730
Validation loss decreased (-0.694581 --> -0.729717).  Saving model ...
Epoch: 11 cost time: 5.049931287765503
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.162 Vali Acc: 0.746 Test Loss: 1.162 Test Acc: 0.746
Validation loss decreased (-0.729717 --> -0.745934).  Saving model ...
Epoch: 12 cost time: 4.805481433868408
Epoch: 12, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.067 Vali Acc: 0.749 Test Loss: 1.067 Test Acc: 0.749
Validation loss decreased (-0.745934 --> -0.748638).  Saving model ...
Epoch: 13 cost time: 6.173601150512695
Epoch: 13, Steps: 17 | Train Loss: 0.919 Vali Loss: 0.959 Vali Acc: 0.776 Test Loss: 0.959 Test Acc: 0.776
Validation loss decreased (-0.748638 --> -0.775666).  Saving model ...
Epoch: 14 cost time: 5.025492906570435
Epoch: 14, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
Validation loss decreased (-0.775666 --> -0.789181).  Saving model ...
Epoch: 15 cost time: 5.163614511489868
Epoch: 15, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
Validation loss decreased (-0.789181 --> -0.802695).  Saving model ...
Epoch: 16 cost time: 4.472152471542358
Epoch: 16, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.727 Vali Acc: 0.811 Test Loss: 0.727 Test Acc: 0.811
Validation loss decreased (-0.802695 --> -0.810804).  Saving model ...
Epoch: 17 cost time: 5.032738208770752
Epoch: 17, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.660 Vali Acc: 0.838 Test Loss: 0.660 Test Acc: 0.838
Validation loss decreased (-0.810804 --> -0.837831).  Saving model ...
Epoch: 18 cost time: 5.149374961853027
Epoch: 18, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.590 Vali Acc: 0.854 Test Loss: 0.590 Test Acc: 0.854
Validation loss decreased (-0.837831 --> -0.854048).  Saving model ...
Epoch: 19 cost time: 5.413155555725098
Epoch: 19, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.563 Vali Acc: 0.870 Test Loss: 0.563 Test Acc: 0.870
Validation loss decreased (-0.854048 --> -0.870265).  Saving model ...
Epoch: 20 cost time: 5.392254590988159
Epoch: 20, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.517 Vali Acc: 0.884 Test Loss: 0.517 Test Acc: 0.884
Validation loss decreased (-0.870265 --> -0.883779).  Saving model ...
Epoch: 21 cost time: 4.990816831588745
Epoch: 21, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.464 Vali Acc: 0.881 Test Loss: 0.464 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.154620885848999
Epoch: 22, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.431 Vali Acc: 0.886 Test Loss: 0.431 Test Acc: 0.886
Validation loss decreased (-0.883779 --> -0.886482).  Saving model ...
Epoch: 23 cost time: 5.887972116470337
Epoch: 23, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.886482 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 4.752138376235962
Epoch: 24, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.377 Vali Acc: 0.908 Test Loss: 0.377 Test Acc: 0.908
Validation loss decreased (-0.899996 --> -0.908104).  Saving model ...
Epoch: 25 cost time: 5.2034900188446045
Epoch: 25, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910807).  Saving model ...
Epoch: 26 cost time: 5.480727672576904
Epoch: 26, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
Validation loss decreased (-0.910807 --> -0.921618).  Saving model ...
Epoch: 27 cost time: 5.880503177642822
Epoch: 27, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929727).  Saving model ...
Epoch: 28 cost time: 6.097585916519165
Epoch: 28, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.929727 --> -0.940538).  Saving model ...
Epoch: 29 cost time: 4.8239967823028564
Epoch: 29, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.159423112869263
Epoch: 30, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.7495293617248535
Epoch: 31, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.252 Vali Acc: 0.932 Test Loss: 0.252 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.827974796295166
Epoch: 32, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.258 Vali Acc: 0.927 Test Loss: 0.258 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.349637985229492
Epoch: 33, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.190534353256226
Epoch: 34, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 35 cost time: 4.808852910995483
Epoch: 35, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.014108657836914
Epoch: 36, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.607135772705078
Epoch: 37, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.397762775421143
Epoch: 38, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 39 cost time: 4.9187939167022705
Epoch: 39, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 5.10667610168457
Epoch: 40, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.855011701583862
Epoch: 41, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 42 cost time: 5.612058877944946
Epoch: 42, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.100964546203613
Epoch: 43, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.879855155944824
Epoch: 44, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 45 cost time: 5.967223882675171
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.2948198318481445
Epoch: 46, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 47 cost time: 4.78533411026001
Epoch: 47, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.937743186950684
Epoch: 48, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 4.67230486869812
Epoch: 49, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.730978488922119
Epoch: 50, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.351945161819458
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 4.718925714492798
Epoch: 52, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 4.844231605529785
Epoch: 53, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 5.875062465667725
Epoch: 54, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 6.4734947681427
Epoch: 55, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 56 cost time: 5.4123053550720215
Epoch: 56, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.12492299079895
Epoch: 57, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 58 cost time: 5.886998176574707
Epoch: 58, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.998257637023926
Epoch: 59, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.135509967803955
Epoch: 60, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 5.573060750961304
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 5.530646324157715
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 5.38689661026001
Epoch: 63, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 5.07839560508728
Epoch: 64, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 4.182478427886963
Epoch: 65, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 5.065408945083618
Epoch: 66, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 67 cost time: 5.5232322216033936
Epoch: 67, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 4.6217193603515625
Epoch: 68, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 4.985021114349365
Epoch: 69, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 5.554292678833008
Epoch: 70, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 5.400661468505859
Epoch: 71, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 6.306829214096069
Epoch: 72, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 5.405778646469116
Epoch: 73, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 5.461252689361572
Epoch: 74, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 75 cost time: 5.457103729248047
Epoch: 75, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 76 cost time: 6.146390914916992
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.3440446853637695
Epoch: 77, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 78 cost time: 4.623061895370483
Epoch: 78, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.1876442432403564
Epoch: 79, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 6.084684371948242
Epoch: 80, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 5.644840717315674
Epoch: 81, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 5.646827459335327
Epoch: 82, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 83 cost time: 5.97095799446106
Epoch: 83, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 5.613202810287476
Epoch: 84, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 6.166810750961304
Epoch: 85, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 5.6128435134887695
Epoch: 86, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 5.4831624031066895
Epoch: 87, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 5.093957424163818
Epoch: 88, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 6.490579128265381
Epoch: 89, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 6.102366209030151
Epoch: 90, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 5.570865869522095
Epoch: 91, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 5.204406976699829
Epoch: 92, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.009854793548584
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.181 Vali Acc: 0.211 Test Loss: 2.181 Test Acc: 0.211
Validation loss decreased (inf --> -0.210789).  Saving model ...
Epoch: 2 cost time: 5.202430725097656
Epoch: 2, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.137 Vali Acc: 0.224 Test Loss: 2.137 Test Acc: 0.224
Validation loss decreased (-0.210789 --> -0.224303).  Saving model ...
Epoch: 3 cost time: 5.8557116985321045
Epoch: 3, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.084 Vali Acc: 0.284 Test Loss: 2.084 Test Acc: 0.284
Validation loss decreased (-0.224303 --> -0.283763).  Saving model ...
Epoch: 4 cost time: 6.031952142715454
Epoch: 4, Steps: 17 | Train Loss: 2.064 Vali Loss: 2.021 Vali Acc: 0.362 Test Loss: 2.021 Test Acc: 0.362
Validation loss decreased (-0.283763 --> -0.362142).  Saving model ...
Epoch: 5 cost time: 5.228463411331177
Epoch: 5, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.945 Vali Acc: 0.478 Test Loss: 1.945 Test Acc: 0.478
Validation loss decreased (-0.362142 --> -0.478359).  Saving model ...
Epoch: 6 cost time: 5.755415201187134
Epoch: 6, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.869 Vali Acc: 0.532 Test Loss: 1.869 Test Acc: 0.532
Validation loss decreased (-0.478359 --> -0.532414).  Saving model ...
Epoch: 7 cost time: 6.737752199172974
Epoch: 7, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.779 Vali Acc: 0.586 Test Loss: 1.779 Test Acc: 0.586
Validation loss decreased (-0.532414 --> -0.586469).  Saving model ...
Epoch: 8 cost time: 6.529804468154907
Epoch: 8, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.684 Vali Acc: 0.605 Test Loss: 1.684 Test Acc: 0.605
Validation loss decreased (-0.586469 --> -0.605389).  Saving model ...
Epoch: 9 cost time: 5.955646991729736
Epoch: 9, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.579 Vali Acc: 0.659 Test Loss: 1.579 Test Acc: 0.659
Validation loss decreased (-0.605389 --> -0.659444).  Saving model ...
Epoch: 10 cost time: 5.520234107971191
Epoch: 10, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.469 Vali Acc: 0.668 Test Loss: 1.469 Test Acc: 0.668
Validation loss decreased (-0.659444 --> -0.667553).  Saving model ...
Epoch: 11 cost time: 5.455731630325317
Epoch: 11, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.353 Vali Acc: 0.689 Test Loss: 1.353 Test Acc: 0.689
Validation loss decreased (-0.667553 --> -0.689176).  Saving model ...
Epoch: 12 cost time: 5.950835227966309
Epoch: 12, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.238 Vali Acc: 0.700 Test Loss: 1.238 Test Acc: 0.700
Validation loss decreased (-0.689176 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 5.28092098236084
Epoch: 13, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.107 Vali Acc: 0.741 Test Loss: 1.107 Test Acc: 0.741
Validation loss decreased (-0.699988 --> -0.740529).  Saving model ...
Epoch: 14 cost time: 5.7628419399261475
Epoch: 14, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.011 Vali Acc: 0.768 Test Loss: 1.011 Test Acc: 0.768
Validation loss decreased (-0.740529 --> -0.767557).  Saving model ...
Epoch: 15 cost time: 6.139020681381226
Epoch: 15, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.912 Vali Acc: 0.789 Test Loss: 0.912 Test Acc: 0.789
Validation loss decreased (-0.767557 --> -0.789180).  Saving model ...
Epoch: 16 cost time: 5.990992307662964
Epoch: 16, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.815 Vali Acc: 0.805 Test Loss: 0.815 Test Acc: 0.805
Validation loss decreased (-0.789180 --> -0.805397).  Saving model ...
Epoch: 17 cost time: 6.495445251464844
Epoch: 17, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.753 Vali Acc: 0.816 Test Loss: 0.753 Test Acc: 0.816
Validation loss decreased (-0.805397 --> -0.816209).  Saving model ...
Epoch: 18 cost time: 6.420117139816284
Epoch: 18, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.663 Vali Acc: 0.846 Test Loss: 0.663 Test Acc: 0.846
Validation loss decreased (-0.816209 --> -0.845939).  Saving model ...
Epoch: 19 cost time: 6.051090240478516
Epoch: 19, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.619 Vali Acc: 0.857 Test Loss: 0.619 Test Acc: 0.857
Validation loss decreased (-0.845939 --> -0.856751).  Saving model ...
Epoch: 20 cost time: 5.533734560012817
Epoch: 20, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
Validation loss decreased (-0.856751 --> -0.878373).  Saving model ...
Epoch: 21 cost time: 6.139874219894409
Epoch: 21, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.508 Vali Acc: 0.886 Test Loss: 0.508 Test Acc: 0.886
Validation loss decreased (-0.878373 --> -0.886481).  Saving model ...
Epoch: 22 cost time: 6.017053604125977
Epoch: 22, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.469 Vali Acc: 0.886 Test Loss: 0.469 Test Acc: 0.886
Validation loss decreased (-0.886481 --> -0.886482).  Saving model ...
Epoch: 23 cost time: 6.121633291244507
Epoch: 23, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.415 Vali Acc: 0.905 Test Loss: 0.415 Test Acc: 0.905
Validation loss decreased (-0.886482 --> -0.905401).  Saving model ...
Epoch: 24 cost time: 6.14285683631897
Epoch: 24, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.395 Vali Acc: 0.908 Test Loss: 0.395 Test Acc: 0.908
Validation loss decreased (-0.905401 --> -0.908104).  Saving model ...
Epoch: 25 cost time: 5.868398904800415
Epoch: 25, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
Validation loss decreased (-0.908104 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 5.2098777294158936
Epoch: 26, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918916).  Saving model ...
Epoch: 27 cost time: 4.701225519180298
Epoch: 27, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921618).  Saving model ...
Epoch: 28 cost time: 5.450527906417847
Epoch: 28, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.274 Vali Acc: 0.927 Test Loss: 0.274 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 29 cost time: 4.694039821624756
Epoch: 29, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 30 cost time: 4.9868433475494385
Epoch: 30, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.268 Vali Acc: 0.927 Test Loss: 0.268 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.7453062534332275
Epoch: 31, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 32 cost time: 6.340775966644287
Epoch: 32, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.17425537109375
Epoch: 33, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 34 cost time: 5.492229461669922
Epoch: 34, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.932430 --> -0.948647).  Saving model ...
Epoch: 35 cost time: 6.403127431869507
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.04854679107666
Epoch: 36, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.215909481048584
Epoch: 37, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.521450757980347
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.346297979354858
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 6.05350136756897
Epoch: 40, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 41 cost time: 4.958303689956665
Epoch: 41, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.609324932098389
Epoch: 42, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 4.552279472351074
Epoch: 43, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 44 cost time: 4.483779430389404
Epoch: 44, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 5.000547647476196
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.655663013458252
Epoch: 46, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.511441469192505
Epoch: 47, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 4.7264084815979
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 5.204711198806763
Epoch: 49, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 4.951765298843384
Epoch: 50, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 6.029561996459961
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 6.325464963912964
Epoch: 52, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 5.800325155258179
Epoch: 53, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 5.348734140396118
Epoch: 54, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.738327980041504
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.172 Vali Acc: 0.219 Test Loss: 2.172 Test Acc: 0.219
Validation loss decreased (inf --> -0.218897).  Saving model ...
Epoch: 2 cost time: 6.433545351028442
Epoch: 2, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.133 Vali Acc: 0.232 Test Loss: 2.133 Test Acc: 0.232
Validation loss decreased (-0.218897 --> -0.232411).  Saving model ...
Epoch: 3 cost time: 5.898916959762573
Epoch: 3, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.085 Vali Acc: 0.254 Test Loss: 2.085 Test Acc: 0.254
Validation loss decreased (-0.232411 --> -0.254033).  Saving model ...
Epoch: 4 cost time: 5.439972162246704
Epoch: 4, Steps: 17 | Train Loss: 2.074 Vali Loss: 2.028 Vali Acc: 0.341 Test Loss: 2.028 Test Acc: 0.341
Validation loss decreased (-0.254033 --> -0.340520).  Saving model ...
Epoch: 5 cost time: 4.980573654174805
Epoch: 5, Steps: 17 | Train Loss: 2.024 Vali Loss: 1.962 Vali Acc: 0.427 Test Loss: 1.962 Test Acc: 0.427
Validation loss decreased (-0.340520 --> -0.427007).  Saving model ...
Epoch: 6 cost time: 6.094339609146118
Epoch: 6, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.891 Vali Acc: 0.530 Test Loss: 1.891 Test Acc: 0.530
Validation loss decreased (-0.427007 --> -0.529711).  Saving model ...
Epoch: 7 cost time: 6.326363801956177
Epoch: 7, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.810 Vali Acc: 0.559 Test Loss: 1.810 Test Acc: 0.559
Validation loss decreased (-0.529711 --> -0.559441).  Saving model ...
Epoch: 8 cost time: 5.676815032958984
Epoch: 8, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.721 Vali Acc: 0.614 Test Loss: 1.721 Test Acc: 0.614
Validation loss decreased (-0.559441 --> -0.613496).  Saving model ...
Epoch: 9 cost time: 5.722074031829834
Epoch: 9, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.624 Vali Acc: 0.649 Test Loss: 1.624 Test Acc: 0.649
Validation loss decreased (-0.613496 --> -0.648632).  Saving model ...
Epoch: 10 cost time: 6.370034217834473
Epoch: 10, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.511 Vali Acc: 0.689 Test Loss: 1.511 Test Acc: 0.689
Validation loss decreased (-0.648632 --> -0.689174).  Saving model ...
Epoch: 11 cost time: 5.641000747680664
Epoch: 11, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.387 Vali Acc: 0.705 Test Loss: 1.387 Test Acc: 0.705
Validation loss decreased (-0.689174 --> -0.705392).  Saving model ...
Epoch: 12 cost time: 5.3500754833221436
Epoch: 12, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.271 Vali Acc: 0.724 Test Loss: 1.271 Test Acc: 0.724
Validation loss decreased (-0.705392 --> -0.724312).  Saving model ...
Epoch: 13 cost time: 5.476582050323486
Epoch: 13, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.135 Vali Acc: 0.749 Test Loss: 1.135 Test Acc: 0.749
Validation loss decreased (-0.724312 --> -0.748637).  Saving model ...
Epoch: 14 cost time: 5.436056852340698
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.005 Vali Acc: 0.808 Test Loss: 1.005 Test Acc: 0.808
Validation loss decreased (-0.748637 --> -0.808098).  Saving model ...
Epoch: 15 cost time: 5.763896465301514
Epoch: 15, Steps: 17 | Train Loss: 0.941 Vali Loss: 0.912 Vali Acc: 0.811 Test Loss: 0.912 Test Acc: 0.811
Validation loss decreased (-0.808098 --> -0.810802).  Saving model ...
Epoch: 16 cost time: 5.4968647956848145
Epoch: 16, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.822 Vali Acc: 0.819 Test Loss: 0.822 Test Acc: 0.819
Validation loss decreased (-0.810802 --> -0.818911).  Saving model ...
Epoch: 17 cost time: 5.8116912841796875
Epoch: 17, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.720 Vali Acc: 0.838 Test Loss: 0.720 Test Acc: 0.838
Validation loss decreased (-0.818911 --> -0.837831).  Saving model ...
Epoch: 18 cost time: 5.2803380489349365
Epoch: 18, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.638 Vali Acc: 0.849 Test Loss: 0.638 Test Acc: 0.849
Validation loss decreased (-0.837831 --> -0.848642).  Saving model ...
Epoch: 19 cost time: 5.838485479354858
Epoch: 19, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.590 Vali Acc: 0.857 Test Loss: 0.590 Test Acc: 0.857
Validation loss decreased (-0.848642 --> -0.856751).  Saving model ...
Epoch: 20 cost time: 5.595260858535767
Epoch: 20, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.538 Vali Acc: 0.854 Test Loss: 0.538 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.508880615234375
Epoch: 21, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.490 Vali Acc: 0.873 Test Loss: 0.490 Test Acc: 0.873
Validation loss decreased (-0.856751 --> -0.872968).  Saving model ...
Epoch: 22 cost time: 5.967868328094482
Epoch: 22, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
Validation loss decreased (-0.872968 --> -0.878374).  Saving model ...
Epoch: 23 cost time: 6.498738050460815
Epoch: 23, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
Validation loss decreased (-0.878374 --> -0.883780).  Saving model ...
Epoch: 24 cost time: 6.220391511917114
Epoch: 24, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
Validation loss decreased (-0.883780 --> -0.889185).  Saving model ...
Epoch: 25 cost time: 5.8188066482543945
Epoch: 25, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.348 Vali Acc: 0.908 Test Loss: 0.348 Test Acc: 0.908
Validation loss decreased (-0.889185 --> -0.908105).  Saving model ...
Epoch: 26 cost time: 5.308579206466675
Epoch: 26, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
Validation loss decreased (-0.908105 --> -0.918916).  Saving model ...
Epoch: 27 cost time: 5.287293195724487
Epoch: 27, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.311 Vali Acc: 0.908 Test Loss: 0.311 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.920386075973511
Epoch: 28, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.298 Vali Acc: 0.908 Test Loss: 0.298 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.1145384311676025
Epoch: 29, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.281 Vali Acc: 0.916 Test Loss: 0.281 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.765834331512451
Epoch: 30, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.272 Vali Acc: 0.905 Test Loss: 0.272 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.955979824066162
Epoch: 31, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
Validation loss decreased (-0.918916 --> -0.927025).  Saving model ...
Epoch: 32 cost time: 5.4424333572387695
Epoch: 32, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.3631672859191895
Epoch: 33, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.916627645492554
Epoch: 34, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.216 Vali Acc: 0.927 Test Loss: 0.216 Test Acc: 0.927
Validation loss decreased (-0.927025 --> -0.927025).  Saving model ...
Epoch: 35 cost time: 6.2439188957214355
Epoch: 35, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.216 Vali Acc: 0.927 Test Loss: 0.216 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.617913007736206
Epoch: 36, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.248828172683716
Epoch: 37, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.952933073043823
Epoch: 38, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.213 Vali Acc: 0.924 Test Loss: 0.213 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.341828346252441
Epoch: 39, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929728).  Saving model ...
Epoch: 40 cost time: 5.107415437698364
Epoch: 40, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.203 Vali Acc: 0.927 Test Loss: 0.203 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.322473526000977
Epoch: 41, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
Validation loss decreased (-0.929728 --> -0.929728).  Saving model ...
Epoch: 42 cost time: 6.1060333251953125
Epoch: 42, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
Validation loss decreased (-0.929728 --> -0.937836).  Saving model ...
Epoch: 43 cost time: 5.492462635040283
Epoch: 43, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 44 cost time: 6.684607028961182
Epoch: 44, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.924 Test Loss: 0.203 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.586679458618164
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.927 Test Loss: 0.203 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.9561378955841064
Epoch: 46, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 5.386875867843628
Epoch: 47, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.927 Test Loss: 0.191 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 5.703445911407471
Epoch: 48, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 4.608760118484497
Epoch: 49, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 5.446962118148804
Epoch: 50, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 4.635921001434326
Epoch: 51, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.189 Vali Acc: 0.927 Test Loss: 0.189 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 5.695893049240112
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 5.53324556350708
Epoch: 53, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.463974237442017
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.208 Vali Acc: 0.157 Test Loss: 2.208 Test Acc: 0.157
Validation loss decreased (inf --> -0.156735).  Saving model ...
Epoch: 2 cost time: 6.381941318511963
Epoch: 2, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.175 Vali Acc: 0.170 Test Loss: 2.175 Test Acc: 0.170
Validation loss decreased (-0.156735 --> -0.170249).  Saving model ...
Epoch: 3 cost time: 6.038968563079834
Epoch: 3, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.132 Vali Acc: 0.222 Test Loss: 2.132 Test Acc: 0.222
Validation loss decreased (-0.170249 --> -0.221600).  Saving model ...
Epoch: 4 cost time: 5.6273033618927
Epoch: 4, Steps: 17 | Train Loss: 2.129 Vali Loss: 2.080 Vali Acc: 0.265 Test Loss: 2.080 Test Acc: 0.265
Validation loss decreased (-0.221600 --> -0.264844).  Saving model ...
Epoch: 5 cost time: 5.856683015823364
Epoch: 5, Steps: 17 | Train Loss: 2.086 Vali Loss: 2.012 Vali Acc: 0.327 Test Loss: 2.012 Test Acc: 0.327
Validation loss decreased (-0.264844 --> -0.327007).  Saving model ...
Epoch: 6 cost time: 5.5192060470581055
Epoch: 6, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.947 Vali Acc: 0.386 Test Loss: 1.947 Test Acc: 0.386
Validation loss decreased (-0.327007 --> -0.386467).  Saving model ...
Epoch: 7 cost time: 5.229487895965576
Epoch: 7, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.866 Vali Acc: 0.465 Test Loss: 1.866 Test Acc: 0.465
Validation loss decreased (-0.386467 --> -0.464846).  Saving model ...
Epoch: 8 cost time: 5.956329584121704
Epoch: 8, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.776 Vali Acc: 0.541 Test Loss: 1.776 Test Acc: 0.541
Validation loss decreased (-0.464846 --> -0.540523).  Saving model ...
Epoch: 9 cost time: 4.3979105949401855
Epoch: 9, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.678 Vali Acc: 0.589 Test Loss: 1.678 Test Acc: 0.589
Validation loss decreased (-0.540523 --> -0.589172).  Saving model ...
Epoch: 10 cost time: 4.8265700340271
Epoch: 10, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.574 Vali Acc: 0.627 Test Loss: 1.574 Test Acc: 0.627
Validation loss decreased (-0.589172 --> -0.627011).  Saving model ...
Epoch: 11 cost time: 4.0318708419799805
Epoch: 11, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.459 Vali Acc: 0.632 Test Loss: 1.459 Test Acc: 0.632
Validation loss decreased (-0.627011 --> -0.632418).  Saving model ...
Epoch: 12 cost time: 5.066342353820801
Epoch: 12, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.327 Vali Acc: 0.657 Test Loss: 1.327 Test Acc: 0.657
Validation loss decreased (-0.632418 --> -0.656743).  Saving model ...
Epoch: 13 cost time: 4.843010902404785
Epoch: 13, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.176 Vali Acc: 0.708 Test Loss: 1.176 Test Acc: 0.708
Validation loss decreased (-0.656743 --> -0.708096).  Saving model ...
Epoch: 14 cost time: 5.761009931564331
Epoch: 14, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.061 Vali Acc: 0.711 Test Loss: 1.061 Test Acc: 0.711
Validation loss decreased (-0.708096 --> -0.710800).  Saving model ...
Epoch: 15 cost time: 5.301825761795044
Epoch: 15, Steps: 17 | Train Loss: 0.993 Vali Loss: 0.929 Vali Acc: 0.743 Test Loss: 0.929 Test Acc: 0.743
Validation loss decreased (-0.710800 --> -0.743234).  Saving model ...
Epoch: 16 cost time: 6.082904100418091
Epoch: 16, Steps: 17 | Train Loss: 0.829 Vali Loss: 0.831 Vali Acc: 0.765 Test Loss: 0.831 Test Acc: 0.765
Validation loss decreased (-0.743234 --> -0.764857).  Saving model ...
Epoch: 17 cost time: 4.7829430103302
Epoch: 17, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.749 Vali Acc: 0.795 Test Loss: 0.749 Test Acc: 0.795
Validation loss decreased (-0.764857 --> -0.794587).  Saving model ...
Epoch: 18 cost time: 5.31986403465271
Epoch: 18, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.647 Vali Acc: 0.824 Test Loss: 0.647 Test Acc: 0.824
Validation loss decreased (-0.794587 --> -0.824318).  Saving model ...
Epoch: 19 cost time: 4.564008951187134
Epoch: 19, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.582 Vali Acc: 0.846 Test Loss: 0.582 Test Acc: 0.846
Validation loss decreased (-0.824318 --> -0.845940).  Saving model ...
Epoch: 20 cost time: 6.889516592025757
Epoch: 20, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
Validation loss decreased (-0.845940 --> -0.870265).  Saving model ...
Epoch: 21 cost time: 6.3221001625061035
Epoch: 21, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
Validation loss decreased (-0.870265 --> -0.883779).  Saving model ...
Epoch: 22 cost time: 6.2930378913879395
Epoch: 22, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.423 Vali Acc: 0.897 Test Loss: 0.423 Test Acc: 0.897
Validation loss decreased (-0.883779 --> -0.897293).  Saving model ...
Epoch: 23 cost time: 5.00006890296936
Epoch: 23, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
Validation loss decreased (-0.897293 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 5.489500522613525
Epoch: 24, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.361 Vali Acc: 0.914 Test Loss: 0.361 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.6209447383880615
Epoch: 25, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.334 Vali Acc: 0.924 Test Loss: 0.334 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 26 cost time: 5.03818678855896
Epoch: 26, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.327 Vali Acc: 0.927 Test Loss: 0.327 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 27 cost time: 5.351933717727661
Epoch: 27, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.310 Vali Acc: 0.924 Test Loss: 0.310 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.643707990646362
Epoch: 28, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.279 Vali Acc: 0.938 Test Loss: 0.279 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 29 cost time: 5.795766830444336
Epoch: 29, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.263 Vali Acc: 0.943 Test Loss: 0.263 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 30 cost time: 5.573148012161255
Epoch: 30, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.873753070831299
Epoch: 31, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.197888135910034
Epoch: 32, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.247 Vali Acc: 0.938 Test Loss: 0.247 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.572756052017212
Epoch: 33, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.242 Vali Acc: 0.927 Test Loss: 0.242 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.359953165054321
Epoch: 34, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.470402240753174
Epoch: 35, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.475189208984375
Epoch: 36, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.377126455307007
Epoch: 37, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.0672643184661865
Epoch: 38, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 39 cost time: 5.1201136112213135
Epoch: 39, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.711839199066162
Epoch: 40, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.957581996917725
Epoch: 41, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.454922437667847
Epoch: 42, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.4086408615112305
Epoch: 43, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.190 Vali Acc: 0.932 Test Loss: 0.190 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 5.7406907081604
Epoch: 44, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.932 Test Loss: 0.181 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 5.452623605728149
Epoch: 45, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 4.994690895080566
Epoch: 46, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 47 cost time: 5.804980993270874
Epoch: 47, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.976680517196655
Epoch: 48, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 49 cost time: 4.951281785964966
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.37214732170105
Epoch: 50, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.833829402923584
Epoch: 51, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 5.341726064682007
Epoch: 52, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 5.555567264556885
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 4.828916788101196
Epoch: 54, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 5.445887088775635
Epoch: 55, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964864).  Saving model ...
Epoch: 56 cost time: 5.58156418800354
Epoch: 56, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.893752574920654
Epoch: 57, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.938 Test Loss: 0.156 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.4439380168914795
Epoch: 58, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 5.356942892074585
Epoch: 59, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 5.137137413024902
Epoch: 60, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 5.162497282028198
Epoch: 61, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 5.057142734527588
Epoch: 62, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 5.3577165603637695
Epoch: 63, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 6.086099863052368
Epoch: 64, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 5.641992568969727
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.484575748443604
Epoch: 1, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.155 Vali Acc: 0.178 Test Loss: 2.155 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 5.294154644012451
Epoch: 2, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.116 Vali Acc: 0.227 Test Loss: 2.116 Test Acc: 0.227
Validation loss decreased (-0.178357 --> -0.227006).  Saving model ...
Epoch: 3 cost time: 4.933582544326782
Epoch: 3, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.065 Vali Acc: 0.270 Test Loss: 2.065 Test Acc: 0.270
Validation loss decreased (-0.227006 --> -0.270250).  Saving model ...
Epoch: 4 cost time: 5.632871389389038
Epoch: 4, Steps: 17 | Train Loss: 2.096 Vali Loss: 2.003 Vali Acc: 0.322 Test Loss: 2.003 Test Acc: 0.322
Validation loss decreased (-0.270250 --> -0.321602).  Saving model ...
Epoch: 5 cost time: 5.519866466522217
Epoch: 5, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.926 Vali Acc: 0.414 Test Loss: 1.926 Test Acc: 0.414
Validation loss decreased (-0.321602 --> -0.413494).  Saving model ...
Epoch: 6 cost time: 5.491538047790527
Epoch: 6, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.850 Vali Acc: 0.481 Test Loss: 1.850 Test Acc: 0.481
Validation loss decreased (-0.413494 --> -0.481063).  Saving model ...
Epoch: 7 cost time: 4.94793701171875
Epoch: 7, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.763 Vali Acc: 0.554 Test Loss: 1.763 Test Acc: 0.554
Validation loss decreased (-0.481063 --> -0.554036).  Saving model ...
Epoch: 8 cost time: 5.343658924102783
Epoch: 8, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.665 Vali Acc: 0.619 Test Loss: 1.665 Test Acc: 0.619
Validation loss decreased (-0.554036 --> -0.618902).  Saving model ...
Epoch: 9 cost time: 4.533434867858887
Epoch: 9, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.557 Vali Acc: 0.684 Test Loss: 1.557 Test Acc: 0.684
Validation loss decreased (-0.618902 --> -0.683768).  Saving model ...
Epoch: 10 cost time: 5.4702653884887695
Epoch: 10, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.443 Vali Acc: 0.732 Test Loss: 1.443 Test Acc: 0.732
Validation loss decreased (-0.683768 --> -0.732418).  Saving model ...
Epoch: 11 cost time: 5.44968843460083
Epoch: 11, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.324 Vali Acc: 0.743 Test Loss: 1.324 Test Acc: 0.743
Validation loss decreased (-0.732418 --> -0.743230).  Saving model ...
Epoch: 12 cost time: 5.469336748123169
Epoch: 12, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.207 Vali Acc: 0.746 Test Loss: 1.207 Test Acc: 0.746
Validation loss decreased (-0.743230 --> -0.745934).  Saving model ...
Epoch: 13 cost time: 5.955185890197754
Epoch: 13, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.069 Vali Acc: 0.776 Test Loss: 1.069 Test Acc: 0.776
Validation loss decreased (-0.745934 --> -0.775665).  Saving model ...
Epoch: 14 cost time: 5.600910902023315
Epoch: 14, Steps: 17 | Train Loss: 1.041 Vali Loss: 0.935 Vali Acc: 0.803 Test Loss: 0.935 Test Acc: 0.803
Validation loss decreased (-0.775665 --> -0.802693).  Saving model ...
Epoch: 15 cost time: 5.089303255081177
Epoch: 15, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.795 Vali Acc: 0.846 Test Loss: 0.795 Test Acc: 0.846
Validation loss decreased (-0.802693 --> -0.845938).  Saving model ...
Epoch: 16 cost time: 5.104553937911987
Epoch: 16, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.711 Vali Acc: 0.865 Test Loss: 0.711 Test Acc: 0.865
Validation loss decreased (-0.845938 --> -0.864858).  Saving model ...
Epoch: 17 cost time: 6.661548614501953
Epoch: 17, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.628 Vali Acc: 0.884 Test Loss: 0.628 Test Acc: 0.884
Validation loss decreased (-0.864858 --> -0.883778).  Saving model ...
Epoch: 18 cost time: 5.641274452209473
Epoch: 18, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.883778 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 5.172834157943726
Epoch: 19, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 4.9568634033203125
Epoch: 20, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.921617).  Saving model ...
Epoch: 21 cost time: 4.570177793502808
Epoch: 21, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.2700889110565186
Epoch: 22, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921618).  Saving model ...
Epoch: 23 cost time: 4.592136859893799
Epoch: 23, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.310 Vali Acc: 0.924 Test Loss: 0.310 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 24 cost time: 4.8978776931762695
Epoch: 24, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935132).  Saving model ...
Epoch: 25 cost time: 5.136053562164307
Epoch: 25, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.410846710205078
Epoch: 26, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 27 cost time: 5.110336542129517
Epoch: 27, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.259 Vali Acc: 0.924 Test Loss: 0.259 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.238011837005615
Epoch: 28, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 29 cost time: 5.73247504234314
Epoch: 29, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.66368842124939
Epoch: 30, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.606153964996338
Epoch: 31, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.560284376144409
Epoch: 32, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.224 Vali Acc: 0.932 Test Loss: 0.224 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.584313631057739
Epoch: 33, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 34 cost time: 4.646393775939941
Epoch: 34, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.04346776008606
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.768387079238892
Epoch: 36, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.341955184936523
Epoch: 37, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 5.326887369155884
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 39 cost time: 5.500504732131958
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 40 cost time: 5.245730876922607
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.201168537139893
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.943403482437134
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.354789733886719
Epoch: 43, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.810400009155273
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.093263864517212
Epoch: 45, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.820094585418701
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 47 cost time: 5.2629969120025635
Epoch: 47, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 48 cost time: 4.649314641952515
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 4.347961664199829
Epoch: 49, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.1810760498046875
Epoch: 50, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.035823345184326
Epoch: 51, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 5.120182991027832
Epoch: 52, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 53 cost time: 5.3871705532073975
Epoch: 53, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.723668098449707
Epoch: 54, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.576201677322388
Epoch: 55, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 56 cost time: 5.333548069000244
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.120359659194946
Epoch: 57, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.522170782089233
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 4.913694620132446
Epoch: 59, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 5.292145013809204
Epoch: 60, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 4.909852743148804
Epoch: 61, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 5.117563486099243
Epoch: 62, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 5.579909801483154
Epoch: 63, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 5.34549355506897
Epoch: 64, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 5.623967409133911
Epoch: 65, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.181544303894043
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 6.0416038036346436
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
Validation loss decreased (-0.118897 --> -0.118897).  Saving model ...
Epoch: 3 cost time: 5.255130767822266
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.526124477386475
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.533709526062012
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.085171937942505
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.9074647426605225
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.185247898101807
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.189509153366089
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.794280767440796
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.515562295913696
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.193 Vali Acc: 0.119 Test Loss: 2.193 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.2789247035980225
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.194 Vali Acc: 0.119 Test Loss: 2.194 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.11891891891891893
model parameter : 132937
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.284768104553223
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.159 Vali Acc: 0.173 Test Loss: 2.159 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 5.512569427490234
Epoch: 2, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.084 Vali Acc: 0.262 Test Loss: 2.084 Test Acc: 0.262
Validation loss decreased (-0.172951 --> -0.262141).  Saving model ...
Epoch: 3 cost time: 4.349357604980469
Epoch: 3, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.988 Vali Acc: 0.376 Test Loss: 1.988 Test Acc: 0.376
Validation loss decreased (-0.262141 --> -0.375656).  Saving model ...
Epoch: 4 cost time: 4.651333808898926
Epoch: 4, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.883 Vali Acc: 0.492 Test Loss: 1.883 Test Acc: 0.492
Validation loss decreased (-0.375656 --> -0.491873).  Saving model ...
Epoch: 5 cost time: 4.772492408752441
Epoch: 5, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.769 Vali Acc: 0.578 Test Loss: 1.769 Test Acc: 0.578
Validation loss decreased (-0.491873 --> -0.578361).  Saving model ...
Epoch: 6 cost time: 5.717468500137329
Epoch: 6, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.649 Vali Acc: 0.649 Test Loss: 1.649 Test Acc: 0.649
Validation loss decreased (-0.578361 --> -0.648632).  Saving model ...
Epoch: 7 cost time: 5.876017808914185
Epoch: 7, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.527 Vali Acc: 0.681 Test Loss: 1.527 Test Acc: 0.681
Validation loss decreased (-0.648632 --> -0.681066).  Saving model ...
Epoch: 8 cost time: 5.113215923309326
Epoch: 8, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.417 Vali Acc: 0.689 Test Loss: 1.417 Test Acc: 0.689
Validation loss decreased (-0.681066 --> -0.689175).  Saving model ...
Epoch: 9 cost time: 5.223825216293335
Epoch: 9, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.299 Vali Acc: 0.724 Test Loss: 1.299 Test Acc: 0.724
Validation loss decreased (-0.689175 --> -0.724311).  Saving model ...
Epoch: 10 cost time: 5.5791356563568115
Epoch: 10, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.175 Vali Acc: 0.743 Test Loss: 1.175 Test Acc: 0.743
Validation loss decreased (-0.724311 --> -0.743231).  Saving model ...
Epoch: 11 cost time: 5.4742724895477295
Epoch: 11, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.076 Vali Acc: 0.773 Test Loss: 1.076 Test Acc: 0.773
Validation loss decreased (-0.743231 --> -0.772962).  Saving model ...
Epoch: 12 cost time: 5.462340354919434
Epoch: 12, Steps: 17 | Train Loss: 0.941 Vali Loss: 0.979 Vali Acc: 0.792 Test Loss: 0.979 Test Acc: 0.792
Validation loss decreased (-0.772962 --> -0.791882).  Saving model ...
Epoch: 13 cost time: 5.0030248165130615
Epoch: 13, Steps: 17 | Train Loss: 0.839 Vali Loss: 0.897 Vali Acc: 0.797 Test Loss: 0.897 Test Acc: 0.797
Validation loss decreased (-0.791882 --> -0.797288).  Saving model ...
Epoch: 14 cost time: 4.896914720535278
Epoch: 14, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.807 Vali Acc: 0.816 Test Loss: 0.807 Test Acc: 0.816
Validation loss decreased (-0.797288 --> -0.816208).  Saving model ...
Epoch: 15 cost time: 4.983983993530273
Epoch: 15, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.749 Vali Acc: 0.835 Test Loss: 0.749 Test Acc: 0.835
Validation loss decreased (-0.816208 --> -0.835128).  Saving model ...
Epoch: 16 cost time: 5.545361518859863
Epoch: 16, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.670 Vali Acc: 0.846 Test Loss: 0.670 Test Acc: 0.846
Validation loss decreased (-0.835128 --> -0.845939).  Saving model ...
Epoch: 17 cost time: 4.229950189590454
Epoch: 17, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.610 Vali Acc: 0.868 Test Loss: 0.610 Test Acc: 0.868
Validation loss decreased (-0.845939 --> -0.867561).  Saving model ...
Epoch: 18 cost time: 5.207523584365845
Epoch: 18, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.566 Vali Acc: 0.870 Test Loss: 0.566 Test Acc: 0.870
Validation loss decreased (-0.867561 --> -0.870265).  Saving model ...
Epoch: 19 cost time: 5.093468904495239
Epoch: 19, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.510 Vali Acc: 0.876 Test Loss: 0.510 Test Acc: 0.876
Validation loss decreased (-0.870265 --> -0.875671).  Saving model ...
Epoch: 20 cost time: 5.528075933456421
Epoch: 20, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.457 Vali Acc: 0.895 Test Loss: 0.457 Test Acc: 0.895
Validation loss decreased (-0.875671 --> -0.894590).  Saving model ...
Epoch: 21 cost time: 5.613642692565918
Epoch: 21, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.435 Vali Acc: 0.897 Test Loss: 0.435 Test Acc: 0.897
Validation loss decreased (-0.894590 --> -0.897293).  Saving model ...
Epoch: 22 cost time: 5.495789527893066
Epoch: 22, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.397 Vali Acc: 0.903 Test Loss: 0.397 Test Acc: 0.903
Validation loss decreased (-0.897293 --> -0.902699).  Saving model ...
Epoch: 23 cost time: 5.499203205108643
Epoch: 23, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.372 Vali Acc: 0.905 Test Loss: 0.372 Test Acc: 0.905
Validation loss decreased (-0.902699 --> -0.905402).  Saving model ...
Epoch: 24 cost time: 5.01319694519043
Epoch: 24, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.329 Vali Acc: 0.914 Test Loss: 0.329 Test Acc: 0.914
Validation loss decreased (-0.905402 --> -0.913510).  Saving model ...
Epoch: 25 cost time: 5.252663612365723
Epoch: 25, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.309 Vali Acc: 0.914 Test Loss: 0.309 Test Acc: 0.914
Validation loss decreased (-0.913510 --> -0.913510).  Saving model ...
Epoch: 26 cost time: 5.757807731628418
Epoch: 26, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 27 cost time: 4.887610197067261
Epoch: 27, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 28 cost time: 5.513640880584717
Epoch: 28, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929727).  Saving model ...
Epoch: 29 cost time: 4.8792884349823
Epoch: 29, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 30 cost time: 5.109309911727905
Epoch: 30, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.237 Vali Acc: 0.924 Test Loss: 0.237 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.096294641494751
Epoch: 31, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.224 Vali Acc: 0.924 Test Loss: 0.224 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.490934133529663
Epoch: 32, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 33 cost time: 5.89144229888916
Epoch: 33, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.837923526763916
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 35 cost time: 4.902069568634033
Epoch: 35, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.491011619567871
Epoch: 36, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 37 cost time: 5.681345462799072
Epoch: 37, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
Epoch: 38 cost time: 5.585278034210205
Epoch: 38, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 39 cost time: 5.406043767929077
Epoch: 39, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.943242 --> -0.951350).  Saving model ...
Epoch: 40 cost time: 5.277841806411743
Epoch: 40, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.515826225280762
Epoch: 41, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.207379579544067
Epoch: 42, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 43 cost time: 5.050318956375122
Epoch: 43, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 44 cost time: 5.323660135269165
Epoch: 44, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.175638437271118
Epoch: 45, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.832425832748413
Epoch: 46, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 47 cost time: 5.959793329238892
Epoch: 47, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.133824825286865
Epoch: 48, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.778822898864746
Epoch: 49, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 6.719789981842041
Epoch: 50, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.013449668884277
Epoch: 51, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 52 cost time: 6.017616033554077
Epoch: 52, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.445635080337524
Epoch: 53, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 54 cost time: 5.947895765304565
Epoch: 54, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 4.735224485397339
Epoch: 55, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 4.903435468673706
Epoch: 56, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.332353830337524
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.4673614501953125
Epoch: 58, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 59 cost time: 5.139685392379761
Epoch: 59, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 60 cost time: 5.76144552230835
Epoch: 60, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 61 cost time: 6.081393241882324
Epoch: 61, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.416793584823608
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.5040624141693115
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 4.724824905395508
Epoch: 64, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 65 cost time: 4.978758096694946
Epoch: 65, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 4.627248764038086
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.823477029800415
Epoch: 67, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 4.836951732635498
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 4.806305170059204
Epoch: 69, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 5.046467065811157
Epoch: 70, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 5.204832077026367
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 5.023340940475464
Epoch: 72, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 5.645001411437988
Epoch: 73, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 5.575400352478027
Epoch: 74, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.09879732131958
Epoch: 1, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.195 Vali Acc: 0.159 Test Loss: 2.195 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 4.770782232284546
Epoch: 2, Steps: 17 | Train Loss: 2.149 Vali Loss: 2.137 Vali Acc: 0.211 Test Loss: 2.137 Test Acc: 0.211
Validation loss decreased (-0.159438 --> -0.210789).  Saving model ...
Epoch: 3 cost time: 5.512653112411499
Epoch: 3, Steps: 17 | Train Loss: 2.073 Vali Loss: 2.062 Vali Acc: 0.265 Test Loss: 2.062 Test Acc: 0.265
Validation loss decreased (-0.210789 --> -0.264844).  Saving model ...
Epoch: 4 cost time: 4.999276876449585
Epoch: 4, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.978 Vali Acc: 0.357 Test Loss: 1.978 Test Acc: 0.357
Validation loss decreased (-0.264844 --> -0.356737).  Saving model ...
Epoch: 5 cost time: 5.541480779647827
Epoch: 5, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.884 Vali Acc: 0.457 Test Loss: 1.884 Test Acc: 0.457
Validation loss decreased (-0.356737 --> -0.456738).  Saving model ...
Epoch: 6 cost time: 4.968914031982422
Epoch: 6, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.780 Vali Acc: 0.578 Test Loss: 1.780 Test Acc: 0.578
Validation loss decreased (-0.456738 --> -0.578361).  Saving model ...
Epoch: 7 cost time: 4.99995231628418
Epoch: 7, Steps: 17 | Train Loss: 1.678 Vali Loss: 1.671 Vali Acc: 0.649 Test Loss: 1.671 Test Acc: 0.649
Validation loss decreased (-0.578361 --> -0.648632).  Saving model ...
Epoch: 8 cost time: 5.179386854171753
Epoch: 8, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.567 Vali Acc: 0.695 Test Loss: 1.567 Test Acc: 0.695
Validation loss decreased (-0.648632 --> -0.694579).  Saving model ...
Epoch: 9 cost time: 5.289013147354126
Epoch: 9, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.445 Vali Acc: 0.711 Test Loss: 1.445 Test Acc: 0.711
Validation loss decreased (-0.694579 --> -0.710796).  Saving model ...
Epoch: 10 cost time: 5.318640470504761
Epoch: 10, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.316 Vali Acc: 0.743 Test Loss: 1.316 Test Acc: 0.743
Validation loss decreased (-0.710796 --> -0.743230).  Saving model ...
Epoch: 11 cost time: 5.427533388137817
Epoch: 11, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.209 Vali Acc: 0.751 Test Loss: 1.209 Test Acc: 0.751
Validation loss decreased (-0.743230 --> -0.751339).  Saving model ...
Epoch: 12 cost time: 4.825775384902954
Epoch: 12, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.109 Vali Acc: 0.762 Test Loss: 1.109 Test Acc: 0.762
Validation loss decreased (-0.751339 --> -0.762151).  Saving model ...
Epoch: 13 cost time: 5.735280275344849
Epoch: 13, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.024 Vali Acc: 0.765 Test Loss: 1.024 Test Acc: 0.765
Validation loss decreased (-0.762151 --> -0.764855).  Saving model ...
Epoch: 14 cost time: 5.207124948501587
Epoch: 14, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
Validation loss decreased (-0.764855 --> -0.789180).  Saving model ...
Epoch: 15 cost time: 5.648726224899292
Epoch: 15, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.868 Vali Acc: 0.792 Test Loss: 0.868 Test Acc: 0.792
Validation loss decreased (-0.789180 --> -0.791883).  Saving model ...
Epoch: 16 cost time: 4.600577354431152
Epoch: 16, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.788 Vali Acc: 0.832 Test Loss: 0.788 Test Acc: 0.832
Validation loss decreased (-0.791883 --> -0.832425).  Saving model ...
Epoch: 17 cost time: 5.242086172103882
Epoch: 17, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.725 Vali Acc: 0.843 Test Loss: 0.725 Test Acc: 0.843
Validation loss decreased (-0.832425 --> -0.843236).  Saving model ...
Epoch: 18 cost time: 4.603535890579224
Epoch: 18, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.682 Vali Acc: 0.832 Test Loss: 0.682 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.688796281814575
Epoch: 19, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.623 Vali Acc: 0.854 Test Loss: 0.623 Test Acc: 0.854
Validation loss decreased (-0.843236 --> -0.854048).  Saving model ...
Epoch: 20 cost time: 4.884414911270142
Epoch: 20, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.565 Vali Acc: 0.865 Test Loss: 0.565 Test Acc: 0.865
Validation loss decreased (-0.854048 --> -0.864859).  Saving model ...
Epoch: 21 cost time: 5.636622190475464
Epoch: 21, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.531 Vali Acc: 0.870 Test Loss: 0.531 Test Acc: 0.870
Validation loss decreased (-0.864859 --> -0.870265).  Saving model ...
Epoch: 22 cost time: 5.38559103012085
Epoch: 22, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.475 Vali Acc: 0.881 Test Loss: 0.475 Test Acc: 0.881
Validation loss decreased (-0.870265 --> -0.881076).  Saving model ...
Epoch: 23 cost time: 4.615352630615234
Epoch: 23, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.450 Vali Acc: 0.886 Test Loss: 0.450 Test Acc: 0.886
Validation loss decreased (-0.881076 --> -0.886482).  Saving model ...
Epoch: 24 cost time: 5.151613473892212
Epoch: 24, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.886482 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 4.8169965744018555
Epoch: 25, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.389 Vali Acc: 0.895 Test Loss: 0.389 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.841348886489868
Epoch: 26, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 4.557699918746948
Epoch: 27, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.328 Vali Acc: 0.916 Test Loss: 0.328 Test Acc: 0.916
Validation loss decreased (-0.899996 --> -0.916213).  Saving model ...
Epoch: 28 cost time: 4.5670342445373535
Epoch: 28, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.310 Vali Acc: 0.916 Test Loss: 0.310 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 29 cost time: 4.132301568984985
Epoch: 29, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 30 cost time: 4.669456720352173
Epoch: 30, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.282 Vali Acc: 0.916 Test Loss: 0.282 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 31 cost time: 4.991605758666992
Epoch: 31, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 32 cost time: 4.6634697914123535
Epoch: 32, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.840634822845459
Epoch: 33, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 34 cost time: 4.339605093002319
Epoch: 34, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.570722579956055
Epoch: 35, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.225 Vali Acc: 0.924 Test Loss: 0.225 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.135266304016113
Epoch: 36, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.927025 --> -0.940539).  Saving model ...
Epoch: 37 cost time: 5.042800426483154
Epoch: 37, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.831684112548828
Epoch: 38, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 39 cost time: 4.565160036087036
Epoch: 39, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 40 cost time: 4.825369596481323
Epoch: 40, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.0658698081970215
Epoch: 41, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.792840242385864
Epoch: 42, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.136730432510376
Epoch: 43, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.4009599685668945
Epoch: 44, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.691503286361694
Epoch: 45, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 46 cost time: 4.631003141403198
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.090115785598755
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.444809436798096
Epoch: 48, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.480250835418701
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 5.870826959609985
Epoch: 50, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 5.345733880996704
Epoch: 51, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 5.259817361831665
Epoch: 52, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 5.327475070953369
Epoch: 53, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 54 cost time: 5.262302875518799
Epoch: 54, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.298471450805664
Epoch: 55, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 4.583293914794922
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.614910840988159
Epoch: 57, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.943 Test Loss: 0.140 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.409688234329224
Epoch: 58, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 4.465803146362305
Epoch: 59, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 5.071117401123047
Epoch: 60, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 5.765112638473511
Epoch: 61, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 4.507023811340332
Epoch: 62, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 5.3334691524505615
Epoch: 63, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 64 cost time: 5.553531885147095
Epoch: 64, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 5.320921421051025
Epoch: 65, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 5.033608436584473
Epoch: 66, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 5.183760404586792
Epoch: 67, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 5.550923585891724
Epoch: 68, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.949 Test Loss: 0.130 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 4.519908428192139
Epoch: 69, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 5.411717176437378
Epoch: 70, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 5.145639896392822
Epoch: 71, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.951 Test Loss: 0.121 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 4.798306465148926
Epoch: 72, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 4.605929374694824
Epoch: 73, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.923526287078857
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.210 Vali Acc: 0.151 Test Loss: 2.210 Test Acc: 0.151
Validation loss decreased (inf --> -0.151329).  Saving model ...
Epoch: 2 cost time: 4.994473695755005
Epoch: 2, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.170 Vali Acc: 0.178 Test Loss: 2.170 Test Acc: 0.178
Validation loss decreased (-0.151329 --> -0.178357).  Saving model ...
Epoch: 3 cost time: 4.8724658489227295
Epoch: 3, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.121 Vali Acc: 0.214 Test Loss: 2.121 Test Acc: 0.214
Validation loss decreased (-0.178357 --> -0.213492).  Saving model ...
Epoch: 4 cost time: 5.586714267730713
Epoch: 4, Steps: 17 | Train Loss: 2.087 Vali Loss: 2.063 Vali Acc: 0.262 Test Loss: 2.063 Test Acc: 0.262
Validation loss decreased (-0.213492 --> -0.262142).  Saving model ...
Epoch: 5 cost time: 5.946200609207153
Epoch: 5, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.996 Vali Acc: 0.319 Test Loss: 1.996 Test Acc: 0.319
Validation loss decreased (-0.262142 --> -0.318899).  Saving model ...
Epoch: 6 cost time: 5.372395277023315
Epoch: 6, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.918 Vali Acc: 0.449 Test Loss: 1.918 Test Acc: 0.449
Validation loss decreased (-0.318899 --> -0.448629).  Saving model ...
Epoch: 7 cost time: 5.159412145614624
Epoch: 7, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.832 Vali Acc: 0.524 Test Loss: 1.832 Test Acc: 0.524
Validation loss decreased (-0.448629 --> -0.524306).  Saving model ...
Epoch: 8 cost time: 4.882452011108398
Epoch: 8, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.745 Vali Acc: 0.578 Test Loss: 1.745 Test Acc: 0.578
Validation loss decreased (-0.524306 --> -0.578361).  Saving model ...
Epoch: 9 cost time: 4.619078874588013
Epoch: 9, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.638 Vali Acc: 0.616 Test Loss: 1.638 Test Acc: 0.616
Validation loss decreased (-0.578361 --> -0.616200).  Saving model ...
Epoch: 10 cost time: 4.245753049850464
Epoch: 10, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.516 Vali Acc: 0.651 Test Loss: 1.516 Test Acc: 0.651
Validation loss decreased (-0.616200 --> -0.651336).  Saving model ...
Epoch: 11 cost time: 4.4520814418792725
Epoch: 11, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.398 Vali Acc: 0.695 Test Loss: 1.398 Test Acc: 0.695
Validation loss decreased (-0.651336 --> -0.694581).  Saving model ...
Epoch: 12 cost time: 4.845837354660034
Epoch: 12, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.276 Vali Acc: 0.722 Test Loss: 1.276 Test Acc: 0.722
Validation loss decreased (-0.694581 --> -0.721609).  Saving model ...
Epoch: 13 cost time: 5.347240209579468
Epoch: 13, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.176 Vali Acc: 0.738 Test Loss: 1.176 Test Acc: 0.738
Validation loss decreased (-0.721609 --> -0.737826).  Saving model ...
Epoch: 14 cost time: 5.018160104751587
Epoch: 14, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.055 Vali Acc: 0.754 Test Loss: 1.055 Test Acc: 0.754
Validation loss decreased (-0.737826 --> -0.754044).  Saving model ...
Epoch: 15 cost time: 5.228710412979126
Epoch: 15, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.964 Vali Acc: 0.781 Test Loss: 0.964 Test Acc: 0.781
Validation loss decreased (-0.754044 --> -0.781071).  Saving model ...
Epoch: 16 cost time: 5.5645928382873535
Epoch: 16, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.862 Vali Acc: 0.819 Test Loss: 0.862 Test Acc: 0.819
Validation loss decreased (-0.781071 --> -0.818910).  Saving model ...
Epoch: 17 cost time: 6.150930404663086
Epoch: 17, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.777 Vali Acc: 0.832 Test Loss: 0.777 Test Acc: 0.832
Validation loss decreased (-0.818910 --> -0.832425).  Saving model ...
Epoch: 18 cost time: 5.978820323944092
Epoch: 18, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.722 Vali Acc: 0.830 Test Loss: 0.722 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.192935943603516
Epoch: 19, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.644 Vali Acc: 0.865 Test Loss: 0.644 Test Acc: 0.865
Validation loss decreased (-0.832425 --> -0.864858).  Saving model ...
Epoch: 20 cost time: 4.9901039600372314
Epoch: 20, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.594 Vali Acc: 0.851 Test Loss: 0.594 Test Acc: 0.851
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.643743276596069
Epoch: 21, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.547 Vali Acc: 0.865 Test Loss: 0.547 Test Acc: 0.865
Validation loss decreased (-0.864858 --> -0.864859).  Saving model ...
Epoch: 22 cost time: 4.928239345550537
Epoch: 22, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
Validation loss decreased (-0.864859 --> -0.889184).  Saving model ...
Epoch: 23 cost time: 5.443681478500366
Epoch: 23, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.450 Vali Acc: 0.892 Test Loss: 0.450 Test Acc: 0.892
Validation loss decreased (-0.889184 --> -0.891887).  Saving model ...
Epoch: 24 cost time: 5.703694105148315
Epoch: 24, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.420 Vali Acc: 0.908 Test Loss: 0.420 Test Acc: 0.908
Validation loss decreased (-0.891887 --> -0.908104).  Saving model ...
Epoch: 25 cost time: 5.867704153060913
Epoch: 25, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.406 Vali Acc: 0.905 Test Loss: 0.406 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.091273784637451
Epoch: 26, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
Validation loss decreased (-0.908104 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 5.471494674682617
Epoch: 27, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.324 Vali Acc: 0.924 Test Loss: 0.324 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 28 cost time: 5.567483901977539
Epoch: 28, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929727).  Saving model ...
Epoch: 29 cost time: 5.698582887649536
Epoch: 29, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.280 Vali Acc: 0.938 Test Loss: 0.280 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937835).  Saving model ...
Epoch: 30 cost time: 5.668654918670654
Epoch: 30, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.279 Vali Acc: 0.935 Test Loss: 0.279 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.252810716629028
Epoch: 31, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.254 Vali Acc: 0.938 Test Loss: 0.254 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 5.145395040512085
Epoch: 32, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 33 cost time: 5.128054857254028
Epoch: 33, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 34 cost time: 4.94404935836792
Epoch: 34, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 35 cost time: 5.067771911621094
Epoch: 35, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 36 cost time: 4.808136463165283
Epoch: 36, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 37 cost time: 5.144744873046875
Epoch: 37, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.88038969039917
Epoch: 38, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 39 cost time: 4.467642784118652
Epoch: 39, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 40 cost time: 4.606744289398193
Epoch: 40, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.065664768218994
Epoch: 41, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.218264818191528
Epoch: 42, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 43 cost time: 4.950144290924072
Epoch: 43, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 44 cost time: 5.032428741455078
Epoch: 44, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.350363731384277
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.569660902023315
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 5.052496671676636
Epoch: 47, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.5313332080841064
Epoch: 48, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 4.235048055648804
Epoch: 49, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 5.245251655578613
Epoch: 50, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 5.143979072570801
Epoch: 51, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 4.688774824142456
Epoch: 52, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 4.818012237548828
Epoch: 53, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 54 cost time: 5.050995111465454
Epoch: 54, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 55 cost time: 5.707866430282593
Epoch: 55, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.556780099868774
Epoch: 56, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 4.834716796875
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 4.687002182006836
Epoch: 58, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 4.810102939605713
Epoch: 59, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 5.3267982006073
Epoch: 60, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 4.840895175933838
Epoch: 61, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 62 cost time: 5.04537558555603
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 4.653498411178589
Epoch: 63, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.074584722518921
Epoch: 64, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 5.2264931201934814
Epoch: 65, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 4.587045907974243
Epoch: 66, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.740119695663452
Epoch: 67, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 6.508402347564697
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 6.212997674942017
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 4.61563777923584
Epoch: 70, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 4.831737518310547
Epoch: 71, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.037472724914551
Epoch: 1, Steps: 17 | Train Loss: 2.232 Vali Loss: 2.210 Vali Acc: 0.127 Test Loss: 2.210 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 4.946593999862671
Epoch: 2, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.175 Vali Acc: 0.159 Test Loss: 2.175 Test Acc: 0.159
Validation loss decreased (-0.127005 --> -0.159438).  Saving model ...
Epoch: 3 cost time: 4.710340976715088
Epoch: 3, Steps: 17 | Train Loss: 2.152 Vali Loss: 2.131 Vali Acc: 0.200 Test Loss: 2.131 Test Acc: 0.200
Validation loss decreased (-0.159438 --> -0.199979).  Saving model ...
Epoch: 4 cost time: 5.155725955963135
Epoch: 4, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.081 Vali Acc: 0.238 Test Loss: 2.081 Test Acc: 0.238
Validation loss decreased (-0.199979 --> -0.237817).  Saving model ...
Epoch: 5 cost time: 4.256659746170044
Epoch: 5, Steps: 17 | Train Loss: 2.046 Vali Loss: 2.021 Vali Acc: 0.284 Test Loss: 2.021 Test Acc: 0.284
Validation loss decreased (-0.237817 --> -0.283764).  Saving model ...
Epoch: 6 cost time: 5.292882442474365
Epoch: 6, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.952 Vali Acc: 0.365 Test Loss: 1.952 Test Acc: 0.365
Validation loss decreased (-0.283764 --> -0.364845).  Saving model ...
Epoch: 7 cost time: 4.717009544372559
Epoch: 7, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.875 Vali Acc: 0.470 Test Loss: 1.875 Test Acc: 0.470
Validation loss decreased (-0.364845 --> -0.470252).  Saving model ...
Epoch: 8 cost time: 4.472873210906982
Epoch: 8, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
Validation loss decreased (-0.470252 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 5.183442115783691
Epoch: 9, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.706 Vali Acc: 0.570 Test Loss: 1.706 Test Acc: 0.570
Validation loss decreased (-0.499982 --> -0.570253).  Saving model ...
Epoch: 10 cost time: 4.749943971633911
Epoch: 10, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.600 Vali Acc: 0.603 Test Loss: 1.600 Test Acc: 0.603
Validation loss decreased (-0.570253 --> -0.602687).  Saving model ...
Epoch: 11 cost time: 4.49073600769043
Epoch: 11, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.493 Vali Acc: 0.657 Test Loss: 1.493 Test Acc: 0.657
Validation loss decreased (-0.602687 --> -0.656742).  Saving model ...
Epoch: 12 cost time: 4.422173500061035
Epoch: 12, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.385 Vali Acc: 0.681 Test Loss: 1.385 Test Acc: 0.681
Validation loss decreased (-0.656742 --> -0.681067).  Saving model ...
Epoch: 13 cost time: 4.415277719497681
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.281 Vali Acc: 0.697 Test Loss: 1.281 Test Acc: 0.697
Validation loss decreased (-0.681067 --> -0.697284).  Saving model ...
Epoch: 14 cost time: 4.158756971359253
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.162 Vali Acc: 0.735 Test Loss: 1.162 Test Acc: 0.735
Validation loss decreased (-0.697284 --> -0.735124).  Saving model ...
Epoch: 15 cost time: 4.021613597869873
Epoch: 15, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.066 Vali Acc: 0.749 Test Loss: 1.066 Test Acc: 0.749
Validation loss decreased (-0.735124 --> -0.748638).  Saving model ...
Epoch: 16 cost time: 4.989954471588135
Epoch: 16, Steps: 17 | Train Loss: 0.878 Vali Loss: 0.959 Vali Acc: 0.784 Test Loss: 0.959 Test Acc: 0.784
Validation loss decreased (-0.748638 --> -0.783774).  Saving model ...
Epoch: 17 cost time: 4.63590145111084
Epoch: 17, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.862 Vali Acc: 0.814 Test Loss: 0.862 Test Acc: 0.814
Validation loss decreased (-0.783774 --> -0.813505).  Saving model ...
Epoch: 18 cost time: 4.505011081695557
Epoch: 18, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.785 Vali Acc: 0.832 Test Loss: 0.785 Test Acc: 0.832
Validation loss decreased (-0.813505 --> -0.832425).  Saving model ...
Epoch: 19 cost time: 4.4877729415893555
Epoch: 19, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.701 Vali Acc: 0.841 Test Loss: 0.701 Test Acc: 0.841
Validation loss decreased (-0.832425 --> -0.840534).  Saving model ...
Epoch: 20 cost time: 4.417545557022095
Epoch: 20, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.636 Vali Acc: 0.846 Test Loss: 0.636 Test Acc: 0.846
Validation loss decreased (-0.840534 --> -0.845940).  Saving model ...
Epoch: 21 cost time: 3.882786750793457
Epoch: 21, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
Validation loss decreased (-0.845940 --> -0.862156).  Saving model ...
Epoch: 22 cost time: 4.533148288726807
Epoch: 22, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.524 Vali Acc: 0.881 Test Loss: 0.524 Test Acc: 0.881
Validation loss decreased (-0.862156 --> -0.881076).  Saving model ...
Epoch: 23 cost time: 4.568617105484009
Epoch: 23, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.045179843902588
Epoch: 24, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.449 Vali Acc: 0.892 Test Loss: 0.449 Test Acc: 0.892
Validation loss decreased (-0.881076 --> -0.891887).  Saving model ...
Epoch: 25 cost time: 4.28483247756958
Epoch: 25, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.422 Vali Acc: 0.895 Test Loss: 0.422 Test Acc: 0.895
Validation loss decreased (-0.891887 --> -0.894590).  Saving model ...
Epoch: 26 cost time: 3.67834210395813
Epoch: 26, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.894590 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 4.610943555831909
Epoch: 27, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.902699).  Saving model ...
Epoch: 28 cost time: 4.321622133255005
Epoch: 28, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.344 Vali Acc: 0.908 Test Loss: 0.344 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 29 cost time: 4.87711763381958
Epoch: 29, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.313 Vali Acc: 0.916 Test Loss: 0.313 Test Acc: 0.916
Validation loss decreased (-0.908105 --> -0.916213).  Saving model ...
Epoch: 30 cost time: 5.766786575317383
Epoch: 30, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.813532114028931
Epoch: 31, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 32 cost time: 4.602951288223267
Epoch: 32, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 33 cost time: 4.7948157787323
Epoch: 33, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 34 cost time: 4.5664589405059814
Epoch: 34, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.234 Vali Acc: 0.927 Test Loss: 0.234 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 35 cost time: 4.961078643798828
Epoch: 35, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.233 Vali Acc: 0.924 Test Loss: 0.233 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.468149423599243
Epoch: 36, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929727).  Saving model ...
Epoch: 37 cost time: 5.137009859085083
Epoch: 37, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 38 cost time: 4.229598522186279
Epoch: 38, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.211 Vali Acc: 0.938 Test Loss: 0.211 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 39 cost time: 4.7484800815582275
Epoch: 39, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 40 cost time: 5.001244306564331
Epoch: 40, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.9949135780334473
Epoch: 41, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.908707857131958
Epoch: 42, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.68822717666626
Epoch: 43, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 44 cost time: 4.605778455734253
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 45 cost time: 5.7367799282073975
Epoch: 45, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.822678565979004
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.043268442153931
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 4.798389911651611
Epoch: 48, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.938 Test Loss: 0.169 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 4.597450256347656
Epoch: 49, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 4.552637100219727
Epoch: 50, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 51 cost time: 5.024156332015991
Epoch: 51, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.5729734897613525
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.990593433380127
Epoch: 53, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.113166570663452
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.932 Test Loss: 0.170 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 4.481919050216675
Epoch: 55, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 6.113936185836792
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 57 cost time: 5.716033458709717
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.441201448440552
Epoch: 58, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.604909181594849
Epoch: 59, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.149 Vali Acc: 0.943 Test Loss: 0.149 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 60 cost time: 5.878902196884155
Epoch: 60, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.393385171890259
Epoch: 61, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.792551517486572
Epoch: 62, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.294296979904175
Epoch: 63, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.938 Test Loss: 0.150 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.840149164199829
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 4.99717378616333
Epoch: 65, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 4.8544440269470215
Epoch: 66, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
Validation loss decreased (-0.943242 --> -0.948647).  Saving model ...
Epoch: 67 cost time: 5.209714889526367
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.202632665634155
Epoch: 68, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 5.72364354133606
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.946 Test Loss: 0.138 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 5.651965618133545
Epoch: 70, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 6.012551546096802
Epoch: 71, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 72 cost time: 5.77373194694519
Epoch: 72, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.047955513000488
Epoch: 73, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.004146099090576
Epoch: 74, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 5.950713872909546
Epoch: 75, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 76 cost time: 4.799340724945068
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 77 cost time: 4.978178262710571
Epoch: 77, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 78 cost time: 4.704998016357422
Epoch: 78, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 4.895858526229858
Epoch: 79, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 4.633659601211548
Epoch: 80, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 81 cost time: 5.20170521736145
Epoch: 81, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.48331880569458
Epoch: 82, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.260032653808594
Epoch: 83, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 5.528641223907471
Epoch: 84, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 5.823312520980835
Epoch: 85, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 4.934795618057251
Epoch: 86, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 5.62526535987854
Epoch: 87, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 5.42701530456543
Epoch: 88, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 89 cost time: 4.418283462524414
Epoch: 89, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 4.498561382293701
Epoch: 90, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.60748815536499
Epoch: 91, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 4.54932427406311
Epoch: 92, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 4.157392740249634
Epoch: 93, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 5.026742935180664
Epoch: 94, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 4.9925456047058105
Epoch: 95, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 5.416261911392212
Epoch: 96, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 4.906997442245483
Epoch: 97, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 6.10715389251709
Epoch: 98, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.108316421508789
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.204 Vali Acc: 0.122 Test Loss: 2.204 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 5.674680709838867
Epoch: 2, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.175 Vali Acc: 0.141 Test Loss: 2.175 Test Acc: 0.141
Validation loss decreased (-0.121600 --> -0.140519).  Saving model ...
Epoch: 3 cost time: 5.844529867172241
Epoch: 3, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.136 Vali Acc: 0.170 Test Loss: 2.136 Test Acc: 0.170
Validation loss decreased (-0.140519 --> -0.170249).  Saving model ...
Epoch: 4 cost time: 5.037801504135132
Epoch: 4, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.089 Vali Acc: 0.208 Test Loss: 2.089 Test Acc: 0.208
Validation loss decreased (-0.170249 --> -0.208087).  Saving model ...
Epoch: 5 cost time: 4.476187467575073
Epoch: 5, Steps: 17 | Train Loss: 2.091 Vali Loss: 2.031 Vali Acc: 0.270 Test Loss: 2.031 Test Acc: 0.270
Validation loss decreased (-0.208087 --> -0.270250).  Saving model ...
Epoch: 6 cost time: 5.06290602684021
Epoch: 6, Steps: 17 | Train Loss: 2.041 Vali Loss: 1.964 Vali Acc: 0.341 Test Loss: 1.964 Test Acc: 0.341
Validation loss decreased (-0.270250 --> -0.340521).  Saving model ...
Epoch: 7 cost time: 5.511988162994385
Epoch: 7, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.888 Vali Acc: 0.408 Test Loss: 1.888 Test Acc: 0.408
Validation loss decreased (-0.340521 --> -0.408089).  Saving model ...
Epoch: 8 cost time: 4.606344699859619
Epoch: 8, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.801 Vali Acc: 0.489 Test Loss: 1.801 Test Acc: 0.489
Validation loss decreased (-0.408089 --> -0.489171).  Saving model ...
Epoch: 9 cost time: 4.965261459350586
Epoch: 9, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.698 Vali Acc: 0.578 Test Loss: 1.698 Test Acc: 0.578
Validation loss decreased (-0.489171 --> -0.578361).  Saving model ...
Epoch: 10 cost time: 4.6709980964660645
Epoch: 10, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.583 Vali Acc: 0.595 Test Loss: 1.583 Test Acc: 0.595
Validation loss decreased (-0.578361 --> -0.594579).  Saving model ...
Epoch: 11 cost time: 5.039551019668579
Epoch: 11, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.479 Vali Acc: 0.573 Test Loss: 1.479 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.675714731216431
Epoch: 12, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.360 Vali Acc: 0.600 Test Loss: 1.360 Test Acc: 0.600
Validation loss decreased (-0.594579 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 5.727140426635742
Epoch: 13, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.246 Vali Acc: 0.624 Test Loss: 1.246 Test Acc: 0.624
Validation loss decreased (-0.599986 --> -0.624312).  Saving model ...
Epoch: 14 cost time: 5.835369110107422
Epoch: 14, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.112 Vali Acc: 0.695 Test Loss: 1.112 Test Acc: 0.695
Validation loss decreased (-0.624312 --> -0.694583).  Saving model ...
Epoch: 15 cost time: 5.391066074371338
Epoch: 15, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.013 Vali Acc: 0.719 Test Loss: 1.013 Test Acc: 0.719
Validation loss decreased (-0.694583 --> -0.718909).  Saving model ...
Epoch: 16 cost time: 5.500711441040039
Epoch: 16, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.898 Vali Acc: 0.792 Test Loss: 0.898 Test Acc: 0.792
Validation loss decreased (-0.718909 --> -0.791883).  Saving model ...
Epoch: 17 cost time: 5.049501419067383
Epoch: 17, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.810 Vali Acc: 0.808 Test Loss: 0.810 Test Acc: 0.808
Validation loss decreased (-0.791883 --> -0.808100).  Saving model ...
Epoch: 18 cost time: 5.2493720054626465
Epoch: 18, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.763 Vali Acc: 0.814 Test Loss: 0.763 Test Acc: 0.814
Validation loss decreased (-0.808100 --> -0.813506).  Saving model ...
Epoch: 19 cost time: 5.92091178894043
Epoch: 19, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.690 Vali Acc: 0.838 Test Loss: 0.690 Test Acc: 0.838
Validation loss decreased (-0.813506 --> -0.837831).  Saving model ...
Epoch: 20 cost time: 5.18267035484314
Epoch: 20, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.642 Vali Acc: 0.849 Test Loss: 0.642 Test Acc: 0.849
Validation loss decreased (-0.837831 --> -0.848642).  Saving model ...
Epoch: 21 cost time: 5.250006198883057
Epoch: 21, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.595 Vali Acc: 0.851 Test Loss: 0.595 Test Acc: 0.851
Validation loss decreased (-0.848642 --> -0.851345).  Saving model ...
Epoch: 22 cost time: 4.855171203613281
Epoch: 22, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.555 Vali Acc: 0.857 Test Loss: 0.555 Test Acc: 0.857
Validation loss decreased (-0.851345 --> -0.856751).  Saving model ...
Epoch: 23 cost time: 5.523793458938599
Epoch: 23, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.492 Vali Acc: 0.876 Test Loss: 0.492 Test Acc: 0.876
Validation loss decreased (-0.856751 --> -0.875671).  Saving model ...
Epoch: 24 cost time: 5.3355162143707275
Epoch: 24, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.462 Vali Acc: 0.878 Test Loss: 0.462 Test Acc: 0.878
Validation loss decreased (-0.875671 --> -0.878374).  Saving model ...
Epoch: 25 cost time: 4.105580806732178
Epoch: 25, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
Validation loss decreased (-0.878374 --> -0.883779).  Saving model ...
Epoch: 26 cost time: 4.868220806121826
Epoch: 26, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.415 Vali Acc: 0.892 Test Loss: 0.415 Test Acc: 0.892
Validation loss decreased (-0.883779 --> -0.891888).  Saving model ...
Epoch: 27 cost time: 4.711078405380249
Epoch: 27, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.891888 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 5.784095764160156
Epoch: 28, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.362 Vali Acc: 0.905 Test Loss: 0.362 Test Acc: 0.905
Validation loss decreased (-0.899996 --> -0.905402).  Saving model ...
Epoch: 29 cost time: 5.133768320083618
Epoch: 29, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.332 Vali Acc: 0.914 Test Loss: 0.332 Test Acc: 0.914
Validation loss decreased (-0.905402 --> -0.913510).  Saving model ...
Epoch: 30 cost time: 5.308953762054443
Epoch: 30, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.344 Vali Acc: 0.908 Test Loss: 0.344 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.725629568099976
Epoch: 31, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.100845098495483
Epoch: 32, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918916).  Saving model ...
Epoch: 33 cost time: 5.164668798446655
Epoch: 33, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 34 cost time: 5.404656410217285
Epoch: 34, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.516294956207275
Epoch: 35, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 36 cost time: 5.677052021026611
Epoch: 36, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.224 Vali Acc: 0.932 Test Loss: 0.224 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.489550590515137
Epoch: 37, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 38 cost time: 6.37783408164978
Epoch: 38, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 39 cost time: 4.443258047103882
Epoch: 39, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 40 cost time: 5.0661115646362305
Epoch: 40, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.177 Vali Acc: 0.938 Test Loss: 0.177 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.893420457839966
Epoch: 41, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 42 cost time: 5.028706312179565
Epoch: 42, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.958441734313965
Epoch: 43, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 44 cost time: 5.100135564804077
Epoch: 44, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.164439678192139
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 46 cost time: 5.476199150085449
Epoch: 46, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 47 cost time: 5.682132244110107
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.246825933456421
Epoch: 48, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 4.652306795120239
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.318902492523193
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.946 Test Loss: 0.132 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.424435615539551
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 52 cost time: 5.215242624282837
Epoch: 52, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.946 Test Loss: 0.132 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.5870795249938965
Epoch: 53, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.151015520095825
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 4.737529039382935
Epoch: 55, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 4.491383790969849
Epoch: 56, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 4.330722808837891
Epoch: 57, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.935 Test Loss: 0.140 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 5.027521133422852
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 59 cost time: 4.829663515090942
Epoch: 59, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 60 cost time: 4.686387062072754
Epoch: 60, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 61 cost time: 4.901334047317505
Epoch: 61, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.583796739578247
Epoch: 62, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 4.838667154312134
Epoch: 63, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.276098728179932
Epoch: 64, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.949 Test Loss: 0.124 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 4.718562364578247
Epoch: 65, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 5.475905656814575
Epoch: 66, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 4.9078450202941895
Epoch: 67, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 4.598294496536255
Epoch: 68, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 4.989691257476807
Epoch: 69, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 5.152961730957031
Epoch: 70, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.685905456542969
Epoch: 1, Steps: 17 | Train Loss: 2.224 Vali Loss: 2.203 Vali Acc: 0.154 Test Loss: 2.203 Test Acc: 0.154
Validation loss decreased (inf --> -0.154032).  Saving model ...
Epoch: 2 cost time: 4.362138986587524
Epoch: 2, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.167 Vali Acc: 0.189 Test Loss: 2.167 Test Acc: 0.189
Validation loss decreased (-0.154032 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 4.164459228515625
Epoch: 3, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.121 Vali Acc: 0.238 Test Loss: 2.121 Test Acc: 0.238
Validation loss decreased (-0.189168 --> -0.237817).  Saving model ...
Epoch: 4 cost time: 4.156090974807739
Epoch: 4, Steps: 17 | Train Loss: 2.135 Vali Loss: 2.067 Vali Acc: 0.297 Test Loss: 2.067 Test Acc: 0.297
Validation loss decreased (-0.237817 --> -0.297277).  Saving model ...
Epoch: 5 cost time: 4.443138122558594
Epoch: 5, Steps: 17 | Train Loss: 2.058 Vali Loss: 1.999 Vali Acc: 0.384 Test Loss: 1.999 Test Acc: 0.384
Validation loss decreased (-0.297277 --> -0.383764).  Saving model ...
Epoch: 6 cost time: 3.7921223640441895
Epoch: 6, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.921 Vali Acc: 0.470 Test Loss: 1.921 Test Acc: 0.470
Validation loss decreased (-0.383764 --> -0.470251).  Saving model ...
Epoch: 7 cost time: 4.484878063201904
Epoch: 7, Steps: 17 | Train Loss: 1.930 Vali Loss: 1.832 Vali Acc: 0.514 Test Loss: 1.832 Test Acc: 0.514
Validation loss decreased (-0.470251 --> -0.513495).  Saving model ...
Epoch: 8 cost time: 4.074160099029541
Epoch: 8, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.741 Vali Acc: 0.546 Test Loss: 1.741 Test Acc: 0.546
Validation loss decreased (-0.513495 --> -0.545929).  Saving model ...
Epoch: 9 cost time: 4.0612242221832275
Epoch: 9, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.637 Vali Acc: 0.595 Test Loss: 1.637 Test Acc: 0.595
Validation loss decreased (-0.545929 --> -0.594578).  Saving model ...
Epoch: 10 cost time: 4.431037902832031
Epoch: 10, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.518 Vali Acc: 0.603 Test Loss: 1.518 Test Acc: 0.603
Validation loss decreased (-0.594578 --> -0.602688).  Saving model ...
Epoch: 11 cost time: 4.053012371063232
Epoch: 11, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.406 Vali Acc: 0.619 Test Loss: 1.406 Test Acc: 0.619
Validation loss decreased (-0.602688 --> -0.618905).  Saving model ...
Epoch: 12 cost time: 4.12900972366333
Epoch: 12, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.291 Vali Acc: 0.657 Test Loss: 1.291 Test Acc: 0.657
Validation loss decreased (-0.618905 --> -0.656744).  Saving model ...
Epoch: 13 cost time: 3.9230470657348633
Epoch: 13, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.186 Vali Acc: 0.676 Test Loss: 1.186 Test Acc: 0.676
Validation loss decreased (-0.656744 --> -0.675664).  Saving model ...
Epoch: 14 cost time: 4.000609397888184
Epoch: 14, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.069 Vali Acc: 0.705 Test Loss: 1.069 Test Acc: 0.705
Validation loss decreased (-0.675664 --> -0.705395).  Saving model ...
Epoch: 15 cost time: 3.8283348083496094
Epoch: 15, Steps: 17 | Train Loss: 0.958 Vali Loss: 0.973 Vali Acc: 0.735 Test Loss: 0.973 Test Acc: 0.735
Validation loss decreased (-0.705395 --> -0.735125).  Saving model ...
Epoch: 16 cost time: 3.9136738777160645
Epoch: 16, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.859 Vali Acc: 0.770 Test Loss: 0.859 Test Acc: 0.770
Validation loss decreased (-0.735125 --> -0.770262).  Saving model ...
Epoch: 17 cost time: 3.933799982070923
Epoch: 17, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.767 Vali Acc: 0.808 Test Loss: 0.767 Test Acc: 0.808
Validation loss decreased (-0.770262 --> -0.808100).  Saving model ...
Epoch: 18 cost time: 3.807633876800537
Epoch: 18, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.698 Vali Acc: 0.824 Test Loss: 0.698 Test Acc: 0.824
Validation loss decreased (-0.808100 --> -0.824317).  Saving model ...
Epoch: 19 cost time: 4.157705783843994
Epoch: 19, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.632 Vali Acc: 0.849 Test Loss: 0.632 Test Acc: 0.849
Validation loss decreased (-0.824317 --> -0.848642).  Saving model ...
Epoch: 20 cost time: 4.455432415008545
Epoch: 20, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.566 Vali Acc: 0.865 Test Loss: 0.566 Test Acc: 0.865
Validation loss decreased (-0.848642 --> -0.864859).  Saving model ...
Epoch: 21 cost time: 4.645661354064941
Epoch: 21, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.523 Vali Acc: 0.868 Test Loss: 0.523 Test Acc: 0.868
Validation loss decreased (-0.864859 --> -0.867562).  Saving model ...
Epoch: 22 cost time: 4.721044540405273
Epoch: 22, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.467 Vali Acc: 0.886 Test Loss: 0.467 Test Acc: 0.886
Validation loss decreased (-0.867562 --> -0.886482).  Saving model ...
Epoch: 23 cost time: 3.770141124725342
Epoch: 23, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.427 Vali Acc: 0.892 Test Loss: 0.427 Test Acc: 0.892
Validation loss decreased (-0.886482 --> -0.891888).  Saving model ...
Epoch: 24 cost time: 3.9690730571746826
Epoch: 24, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.392 Vali Acc: 0.886 Test Loss: 0.392 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.269097805023193
Epoch: 25, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.376 Vali Acc: 0.892 Test Loss: 0.376 Test Acc: 0.892
Validation loss decreased (-0.891888 --> -0.891888).  Saving model ...
Epoch: 26 cost time: 4.227094888687134
Epoch: 26, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.347 Vali Acc: 0.895 Test Loss: 0.347 Test Acc: 0.895
Validation loss decreased (-0.891888 --> -0.894591).  Saving model ...
Epoch: 27 cost time: 4.004400014877319
Epoch: 27, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
Validation loss decreased (-0.894591 --> -0.910808).  Saving model ...
Epoch: 28 cost time: 4.7508323192596436
Epoch: 28, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
Validation loss decreased (-0.910808 --> -0.910808).  Saving model ...
Epoch: 29 cost time: 4.427711009979248
Epoch: 29, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
Validation loss decreased (-0.910808 --> -0.921619).  Saving model ...
Epoch: 30 cost time: 4.2067224979400635
Epoch: 30, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.0127787590026855
Epoch: 31, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.17409873008728
Epoch: 32, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929728).  Saving model ...
Epoch: 33 cost time: 4.933382034301758
Epoch: 33, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.062230110168457
Epoch: 34, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.314586639404297
Epoch: 35, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
Validation loss decreased (-0.929728 --> -0.935133).  Saving model ...
Epoch: 36 cost time: 4.438862085342407
Epoch: 36, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 37 cost time: 4.02049446105957
Epoch: 37, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 38 cost time: 4.198141574859619
Epoch: 38, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.358968019485474
Epoch: 39, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.178 Vali Acc: 0.938 Test Loss: 0.178 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 40 cost time: 4.546835422515869
Epoch: 40, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 41 cost time: 4.05057430267334
Epoch: 41, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 42 cost time: 3.9341819286346436
Epoch: 42, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 43 cost time: 4.173186540603638
Epoch: 43, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 44 cost time: 4.403847694396973
Epoch: 44, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 4.118505477905273
Epoch: 45, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 46 cost time: 4.6986517906188965
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.019307374954224
Epoch: 47, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 4.525011301040649
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 4.225329875946045
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 4.915666341781616
Epoch: 50, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 4.781935214996338
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 52 cost time: 4.057577133178711
Epoch: 52, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.264177322387695
Epoch: 53, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.951 Test Loss: 0.120 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.4812703132629395
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.778709650039673
Epoch: 55, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.9922282695770264
Epoch: 56, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.772714853286743
Epoch: 57, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 4.201525926589966
Epoch: 58, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 59 cost time: 4.0733606815338135
Epoch: 59, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 60 cost time: 4.453245162963867
Epoch: 60, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 4.742293357849121
Epoch: 61, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 4.725514650344849
Epoch: 62, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 4.456117868423462
Epoch: 63, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 64 cost time: 4.816536903381348
Epoch: 64, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 5.121654987335205
Epoch: 65, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 4.493160009384155
Epoch: 66, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 5.055364608764648
Epoch: 67, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 4.361963987350464
Epoch: 68, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 4.06874418258667
Epoch: 69, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 4.598467588424683
Epoch: 70, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 3.957653522491455
Epoch: 71, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 3.690770149230957
Epoch: 72, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 4.601267099380493
Epoch: 73, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.50939679145813
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (inf --> -0.094573).  Saving model ...
Epoch: 2 cost time: 4.05426287651062
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 3 cost time: 4.5537190437316895
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 4 cost time: 4.089564323425293
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.663514614105225
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.150461912155151
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 7 cost time: 4.630429983139038
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 8 cost time: 4.379809617996216
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.648777484893799
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.263007164001465
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 11 cost time: 5.107613563537598
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 12 cost time: 4.899083375930786
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 13 cost time: 4.557680130004883
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.0549070835113525
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 15 cost time: 4.541375637054443
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.009027481079102
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 17 cost time: 5.228419542312622
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 18 cost time: 4.978941917419434
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.336060523986816
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.308988809585571
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.560133695602417
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.201 Vali Acc: 0.095 Test Loss: 2.201 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.520298719406128
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 23 cost time: 4.246949195861816
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 24 cost time: 5.459062099456787
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 25 cost time: 5.466521501541138
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.882744073867798
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.421881914138794
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 28 cost time: 4.6769444942474365
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 29 cost time: 4.625009059906006
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 30 cost time: 4.58057165145874
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.106757640838623
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.480726003646851
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.1235833168029785
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.365975856781006
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 35 cost time: 4.555180072784424
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.900842666625977
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.063066482543945
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 38 cost time: 4.8182008266448975
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 39 cost time: 4.504676103591919
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.033939838409424
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 41 cost time: 4.128476619720459
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.043377161026001
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 4.86393404006958
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 4.410327434539795
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 4.7555437088012695
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.333690881729126
Epoch: 46, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 47 cost time: 4.146121501922607
Epoch: 47, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 48 cost time: 4.564469575881958
Epoch: 48, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 4.340799331665039
Epoch: 49, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 50 cost time: 4.299743175506592
Epoch: 50, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 51 cost time: 4.725780248641968
Epoch: 51, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.58296799659729
Epoch: 52, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 4.994164943695068
Epoch: 53, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 54 cost time: 5.478515863418579
Epoch: 54, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 55 cost time: 4.399336814880371
Epoch: 55, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 56 cost time: 4.5072081089019775
Epoch: 56, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 4.772863149642944
Epoch: 57, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.214403390884399
Epoch: 58, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 4.241185426712036
Epoch: 59, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 4.053403854370117
Epoch: 60, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 4.104650020599365
Epoch: 61, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 4.415501117706299
Epoch: 62, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 4.339231729507446
Epoch: 63, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 4.59724760055542
Epoch: 64, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 65 cost time: 4.369359731674194
Epoch: 65, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 4.93070125579834
Epoch: 66, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.051900148391724
Epoch: 67, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 68 cost time: 4.8677873611450195
Epoch: 68, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 69 cost time: 4.914941310882568
Epoch: 69, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 4.960924863815308
Epoch: 70, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 71 cost time: 5.161526918411255
Epoch: 71, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 72 cost time: 4.131534576416016
Epoch: 72, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 4.651735067367554
Epoch: 73, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 4.363461494445801
Epoch: 74, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 4.233310699462891
Epoch: 75, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 4.734878063201904
Epoch: 76, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 4.628367900848389
Epoch: 77, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 4.369386911392212
Epoch: 78, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 5.219919443130493
Epoch: 79, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
Validation loss decreased (-0.094573 --> -0.094573).  Saving model ...
Epoch: 80 cost time: 5.052423000335693
Epoch: 80, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.019861459732056
Epoch: 81, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.119 Test Loss: 2.199 Test Acc: 0.119
Validation loss decreased (-0.094573 --> -0.118897).  Saving model ...
Epoch: 82 cost time: 6.469334840774536
Epoch: 82, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.369298458099365
Epoch: 83, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 6.055727481842041
Epoch: 84, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.38848352432251
Epoch: 85, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.199 Vali Acc: 0.095 Test Loss: 2.199 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 5.674113750457764
Epoch: 86, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 4.602978706359863
Epoch: 87, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 4.907640695571899
Epoch: 88, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 4.897437334060669
Epoch: 89, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 4.526647329330444
Epoch: 90, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 6.469861268997192
Epoch: 91, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.095 Test Loss: 2.198 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.11891891891891893
model parameter : 83785
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.137612581253052
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.114 Vali Acc: 0.173 Test Loss: 2.114 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 5.080151796340942
Epoch: 2, Steps: 17 | Train Loss: 2.102 Vali Loss: 2.050 Vali Acc: 0.265 Test Loss: 2.050 Test Acc: 0.265
Validation loss decreased (-0.172952 --> -0.264844).  Saving model ...
Epoch: 3 cost time: 5.383694171905518
Epoch: 3, Steps: 17 | Train Loss: 2.030 Vali Loss: 1.960 Vali Acc: 0.408 Test Loss: 1.960 Test Acc: 0.408
Validation loss decreased (-0.264844 --> -0.408089).  Saving model ...
Epoch: 4 cost time: 6.288401126861572
Epoch: 4, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.862 Vali Acc: 0.541 Test Loss: 1.862 Test Acc: 0.541
Validation loss decreased (-0.408089 --> -0.540522).  Saving model ...
Epoch: 5 cost time: 5.429777145385742
Epoch: 5, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.763 Vali Acc: 0.576 Test Loss: 1.763 Test Acc: 0.576
Validation loss decreased (-0.540522 --> -0.575658).  Saving model ...
Epoch: 6 cost time: 4.9172444343566895
Epoch: 6, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.656 Vali Acc: 0.616 Test Loss: 1.656 Test Acc: 0.616
Validation loss decreased (-0.575658 --> -0.616200).  Saving model ...
Epoch: 7 cost time: 4.9030139446258545
Epoch: 7, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.541 Vali Acc: 0.657 Test Loss: 1.541 Test Acc: 0.657
Validation loss decreased (-0.616200 --> -0.656741).  Saving model ...
Epoch: 8 cost time: 4.413824796676636
Epoch: 8, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.443 Vali Acc: 0.673 Test Loss: 1.443 Test Acc: 0.673
Validation loss decreased (-0.656741 --> -0.672959).  Saving model ...
Epoch: 9 cost time: 5.1387457847595215
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.335 Vali Acc: 0.695 Test Loss: 1.335 Test Acc: 0.695
Validation loss decreased (-0.672959 --> -0.694581).  Saving model ...
Epoch: 10 cost time: 4.595046281814575
Epoch: 10, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.237 Vali Acc: 0.705 Test Loss: 1.237 Test Acc: 0.705
Validation loss decreased (-0.694581 --> -0.705393).  Saving model ...
Epoch: 11 cost time: 4.6387059688568115
Epoch: 11, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.131 Vali Acc: 0.732 Test Loss: 1.131 Test Acc: 0.732
Validation loss decreased (-0.705393 --> -0.732421).  Saving model ...
Epoch: 12 cost time: 5.116994380950928
Epoch: 12, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.037 Vali Acc: 0.754 Test Loss: 1.037 Test Acc: 0.754
Validation loss decreased (-0.732421 --> -0.754044).  Saving model ...
Epoch: 13 cost time: 5.444880723953247
Epoch: 13, Steps: 17 | Train Loss: 0.909 Vali Loss: 0.940 Vali Acc: 0.776 Test Loss: 0.940 Test Acc: 0.776
Validation loss decreased (-0.754044 --> -0.775666).  Saving model ...
Epoch: 14 cost time: 4.96301007270813
Epoch: 14, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.857 Vali Acc: 0.792 Test Loss: 0.857 Test Acc: 0.792
Validation loss decreased (-0.775666 --> -0.791883).  Saving model ...
Epoch: 15 cost time: 5.691543102264404
Epoch: 15, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.787 Vali Acc: 0.803 Test Loss: 0.787 Test Acc: 0.803
Validation loss decreased (-0.791883 --> -0.802695).  Saving model ...
Epoch: 16 cost time: 6.040061950683594
Epoch: 16, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.716 Vali Acc: 0.814 Test Loss: 0.716 Test Acc: 0.814
Validation loss decreased (-0.802695 --> -0.813506).  Saving model ...
Epoch: 17 cost time: 5.390930891036987
Epoch: 17, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.658 Vali Acc: 0.824 Test Loss: 0.658 Test Acc: 0.824
Validation loss decreased (-0.813506 --> -0.824318).  Saving model ...
Epoch: 18 cost time: 5.461534738540649
Epoch: 18, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.590 Vali Acc: 0.851 Test Loss: 0.590 Test Acc: 0.851
Validation loss decreased (-0.824318 --> -0.851345).  Saving model ...
Epoch: 19 cost time: 5.742076635360718
Epoch: 19, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.540 Vali Acc: 0.857 Test Loss: 0.540 Test Acc: 0.857
Validation loss decreased (-0.851345 --> -0.856751).  Saving model ...
Epoch: 20 cost time: 5.871399879455566
Epoch: 20, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
Validation loss decreased (-0.856751 --> -0.862157).  Saving model ...
Epoch: 21 cost time: 5.441134214401245
Epoch: 21, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
Validation loss decreased (-0.862157 --> -0.878374).  Saving model ...
Epoch: 22 cost time: 5.200108051300049
Epoch: 22, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.418 Vali Acc: 0.878 Test Loss: 0.418 Test Acc: 0.878
Validation loss decreased (-0.878374 --> -0.878374).  Saving model ...
Epoch: 23 cost time: 5.174158096313477
Epoch: 23, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.385 Vali Acc: 0.897 Test Loss: 0.385 Test Acc: 0.897
Validation loss decreased (-0.878374 --> -0.897293).  Saving model ...
Epoch: 24 cost time: 4.703466415405273
Epoch: 24, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.362 Vali Acc: 0.905 Test Loss: 0.362 Test Acc: 0.905
Validation loss decreased (-0.897293 --> -0.905402).  Saving model ...
Epoch: 25 cost time: 5.29736328125
Epoch: 25, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.333 Vali Acc: 0.908 Test Loss: 0.333 Test Acc: 0.908
Validation loss decreased (-0.905402 --> -0.908105).  Saving model ...
Epoch: 26 cost time: 5.1142942905426025
Epoch: 26, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.312 Vali Acc: 0.916 Test Loss: 0.312 Test Acc: 0.916
Validation loss decreased (-0.908105 --> -0.916213).  Saving model ...
Epoch: 27 cost time: 6.5638954639434814
Epoch: 27, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918916).  Saving model ...
Epoch: 28 cost time: 5.984798192977905
Epoch: 28, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929727).  Saving model ...
Epoch: 29 cost time: 5.342602968215942
Epoch: 29, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.264 Vali Acc: 0.927 Test Loss: 0.264 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.250863313674927
Epoch: 30, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 31 cost time: 5.485922336578369
Epoch: 31, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 32 cost time: 5.183207273483276
Epoch: 32, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 33 cost time: 5.598953485488892
Epoch: 33, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.1328723430633545
Epoch: 34, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.311123371124268
Epoch: 35, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 36 cost time: 4.7744059562683105
Epoch: 36, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.891374588012695
Epoch: 37, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.275392532348633
Epoch: 38, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 39 cost time: 4.773736953735352
Epoch: 39, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.636653184890747
Epoch: 40, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.564202547073364
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.172 Vali Acc: 0.935 Test Loss: 0.172 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 4.681789875030518
Epoch: 42, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 43 cost time: 5.152279615402222
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.938 Test Loss: 0.163 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.096437215805054
Epoch: 44, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.985034227371216
Epoch: 45, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 5.3314313888549805
Epoch: 46, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 47 cost time: 6.223122835159302
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.943 Test Loss: 0.139 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.738689661026001
Epoch: 48, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 49 cost time: 5.222851991653442
Epoch: 49, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 4.650948762893677
Epoch: 50, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 5.4007415771484375
Epoch: 51, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 5.971065044403076
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 5.8314049243927
Epoch: 53, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 4.191002368927002
Epoch: 54, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 5.348016023635864
Epoch: 55, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.949 Test Loss: 0.131 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 6.349015712738037
Epoch: 56, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 5.5801708698272705
Epoch: 57, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.949 Test Loss: 0.128 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 5.504557371139526
Epoch: 58, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.949 Test Loss: 0.124 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 59209
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.282696723937988
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.134 Vali Acc: 0.119 Test Loss: 2.134 Test Acc: 0.119
Validation loss decreased (inf --> -0.118898).  Saving model ...
Epoch: 2 cost time: 5.571577310562134
Epoch: 2, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.086 Vali Acc: 0.200 Test Loss: 2.086 Test Acc: 0.200
Validation loss decreased (-0.118898 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 5.177066087722778
Epoch: 3, Steps: 17 | Train Loss: 2.077 Vali Loss: 2.018 Vali Acc: 0.300 Test Loss: 2.018 Test Acc: 0.300
Validation loss decreased (-0.199979 --> -0.299980).  Saving model ...
Epoch: 4 cost time: 4.705136060714722
Epoch: 4, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.940 Vali Acc: 0.422 Test Loss: 1.940 Test Acc: 0.422
Validation loss decreased (-0.299980 --> -0.421602).  Saving model ...
Epoch: 5 cost time: 4.409572601318359
Epoch: 5, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.860 Vali Acc: 0.495 Test Loss: 1.860 Test Acc: 0.495
Validation loss decreased (-0.421602 --> -0.494576).  Saving model ...
Epoch: 6 cost time: 4.820793867111206
Epoch: 6, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.769 Vali Acc: 0.562 Test Loss: 1.769 Test Acc: 0.562
Validation loss decreased (-0.494576 --> -0.562144).  Saving model ...
Epoch: 7 cost time: 4.156257152557373
Epoch: 7, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.666 Vali Acc: 0.616 Test Loss: 1.666 Test Acc: 0.616
Validation loss decreased (-0.562144 --> -0.616200).  Saving model ...
Epoch: 8 cost time: 4.765531539916992
Epoch: 8, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.572 Vali Acc: 0.665 Test Loss: 1.572 Test Acc: 0.665
Validation loss decreased (-0.616200 --> -0.664849).  Saving model ...
Epoch: 9 cost time: 4.276362180709839
Epoch: 9, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.467 Vali Acc: 0.697 Test Loss: 1.467 Test Acc: 0.697
Validation loss decreased (-0.664849 --> -0.697283).  Saving model ...
Epoch: 10 cost time: 5.65703010559082
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.367 Vali Acc: 0.705 Test Loss: 1.367 Test Acc: 0.705
Validation loss decreased (-0.697283 --> -0.705392).  Saving model ...
Epoch: 11 cost time: 4.850722312927246
Epoch: 11, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.257 Vali Acc: 0.730 Test Loss: 1.257 Test Acc: 0.730
Validation loss decreased (-0.705392 --> -0.729717).  Saving model ...
Epoch: 12 cost time: 5.5230042934417725
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.148 Vali Acc: 0.741 Test Loss: 1.148 Test Acc: 0.741
Validation loss decreased (-0.729717 --> -0.740529).  Saving model ...
Epoch: 13 cost time: 5.344206094741821
Epoch: 13, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.042 Vali Acc: 0.751 Test Loss: 1.042 Test Acc: 0.751
Validation loss decreased (-0.740529 --> -0.751341).  Saving model ...
Epoch: 14 cost time: 5.25276517868042
Epoch: 14, Steps: 17 | Train Loss: 0.912 Vali Loss: 0.948 Vali Acc: 0.765 Test Loss: 0.948 Test Acc: 0.765
Validation loss decreased (-0.751341 --> -0.764855).  Saving model ...
Epoch: 15 cost time: 5.112681150436401
Epoch: 15, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.863 Vali Acc: 0.789 Test Loss: 0.863 Test Acc: 0.789
Validation loss decreased (-0.764855 --> -0.789181).  Saving model ...
Epoch: 16 cost time: 5.291290760040283
Epoch: 16, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.774 Vali Acc: 0.816 Test Loss: 0.774 Test Acc: 0.816
Validation loss decreased (-0.789181 --> -0.816208).  Saving model ...
Epoch: 17 cost time: 4.875953674316406
Epoch: 17, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.816208 --> -0.829723).  Saving model ...
Epoch: 18 cost time: 4.889428615570068
Epoch: 18, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.616 Vali Acc: 0.857 Test Loss: 0.616 Test Acc: 0.857
Validation loss decreased (-0.829723 --> -0.856751).  Saving model ...
Epoch: 19 cost time: 4.337069749832153
Epoch: 19, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.557 Vali Acc: 0.862 Test Loss: 0.557 Test Acc: 0.862
Validation loss decreased (-0.856751 --> -0.862157).  Saving model ...
Epoch: 20 cost time: 4.547478914260864
Epoch: 20, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
Validation loss decreased (-0.862157 --> -0.870265).  Saving model ...
Epoch: 21 cost time: 4.663982152938843
Epoch: 21, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
Validation loss decreased (-0.870265 --> -0.889185).  Saving model ...
Epoch: 22 cost time: 4.804991245269775
Epoch: 22, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.415 Vali Acc: 0.905 Test Loss: 0.415 Test Acc: 0.905
Validation loss decreased (-0.889185 --> -0.905401).  Saving model ...
Epoch: 23 cost time: 5.439517974853516
Epoch: 23, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.378 Vali Acc: 0.914 Test Loss: 0.378 Test Acc: 0.914
Validation loss decreased (-0.905401 --> -0.913510).  Saving model ...
Epoch: 24 cost time: 5.075420379638672
Epoch: 24, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.357 Vali Acc: 0.914 Test Loss: 0.357 Test Acc: 0.914
Validation loss decreased (-0.913510 --> -0.913510).  Saving model ...
Epoch: 25 cost time: 5.173059463500977
Epoch: 25, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921618).  Saving model ...
Epoch: 26 cost time: 5.696641206741333
Epoch: 26, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921619).  Saving model ...
Epoch: 27 cost time: 4.866793155670166
Epoch: 27, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.292 Vali Acc: 0.924 Test Loss: 0.292 Test Acc: 0.924
Validation loss decreased (-0.921619 --> -0.924321).  Saving model ...
Epoch: 28 cost time: 5.25886869430542
Epoch: 28, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
Validation loss decreased (-0.924321 --> -0.935132).  Saving model ...
Epoch: 29 cost time: 6.243686676025391
Epoch: 29, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.387772798538208
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 31 cost time: 5.19696044921875
Epoch: 31, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 32 cost time: 4.520753383636475
Epoch: 32, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 33 cost time: 4.898042440414429
Epoch: 33, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 34 cost time: 4.137671947479248
Epoch: 34, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 35 cost time: 4.568730115890503
Epoch: 35, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 36 cost time: 5.644668340682983
Epoch: 36, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.5943849086761475
Epoch: 37, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 38 cost time: 4.686997175216675
Epoch: 38, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 39 cost time: 6.081955194473267
Epoch: 39, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 40 cost time: 5.298788070678711
Epoch: 40, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.142730951309204
Epoch: 41, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.997671127319336
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.961783409118652
Epoch: 43, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.329744577407837
Epoch: 44, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 45 cost time: 5.302463054656982
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 46 cost time: 5.041821479797363
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 47 cost time: 5.173567295074463
Epoch: 47, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.5657148361206055
Epoch: 48, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 4.070043325424194
Epoch: 49, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.063272714614868
Epoch: 50, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 51 cost time: 5.023360013961792
Epoch: 51, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.101149082183838
Epoch: 52, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.951 Test Loss: 0.130 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 53 cost time: 5.055532932281494
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 54 cost time: 5.234923601150513
Epoch: 54, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 55 cost time: 5.555545806884766
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.949 Test Loss: 0.127 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.226071119308472
Epoch: 56, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 57 cost time: 5.210697174072266
Epoch: 57, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 58 cost time: 4.651130199432373
Epoch: 58, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 59 cost time: 5.1123058795928955
Epoch: 59, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.6531994342803955
Epoch: 60, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.951 Test Loss: 0.112 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.219365119934082
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 62 cost time: 4.798617601394653
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 63 cost time: 4.879540205001831
Epoch: 63, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 64 cost time: 5.694027662277222
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 5.0554423332214355
Epoch: 65, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 5.644876003265381
Epoch: 66, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 5.526067733764648
Epoch: 67, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 5.359410524368286
Epoch: 68, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 69 cost time: 5.018625020980835
Epoch: 69, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 70 cost time: 5.71958065032959
Epoch: 70, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 71 cost time: 5.417843341827393
Epoch: 71, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 72 cost time: 5.737800598144531
Epoch: 72, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.202507019042969
Epoch: 73, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.86875581741333
Epoch: 74, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 5.084789037704468
Epoch: 75, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 76 cost time: 5.313422679901123
Epoch: 76, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 4.654225826263428
Epoch: 77, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.034505844116211
Epoch: 78, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.954 Test Loss: 0.105 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 4.526433944702148
Epoch: 79, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 5.268268585205078
Epoch: 80, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 4.283482551574707
Epoch: 81, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 82 cost time: 5.605799674987793
Epoch: 82, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 83 cost time: 5.818434715270996
Epoch: 83, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 5.370732545852661
Epoch: 84, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.957 Test Loss: 0.105 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 5.413361310958862
Epoch: 85, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 5.075868129730225
Epoch: 86, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 5.846358060836792
Epoch: 87, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 5.318948030471802
Epoch: 88, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 5.540042400360107
Epoch: 89, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 5.210735321044922
Epoch: 90, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 91 cost time: 4.499140977859497
Epoch: 91, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 92 cost time: 4.924782752990723
Epoch: 92, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 4.918816328048706
Epoch: 93, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 5.457104682922363
Epoch: 94, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 5.568109750747681
Epoch: 95, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 4.886473178863525
Epoch: 96, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 5.33704137802124
Epoch: 97, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 98 cost time: 4.873034238815308
Epoch: 98, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 99 cost time: 5.962508201599121
Epoch: 99, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 100 cost time: 5.291793346405029
Epoch: 100, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 59209
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.222822904586792
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.146 Vali Acc: 0.168 Test Loss: 2.146 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 4.431185245513916
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.115 Vali Acc: 0.205 Test Loss: 2.115 Test Acc: 0.205
Validation loss decreased (-0.167546 --> -0.205384).  Saving model ...
Epoch: 3 cost time: 4.324198246002197
Epoch: 3, Steps: 17 | Train Loss: 2.136 Vali Loss: 2.072 Vali Acc: 0.284 Test Loss: 2.072 Test Acc: 0.284
Validation loss decreased (-0.205384 --> -0.283763).  Saving model ...
Epoch: 4 cost time: 4.735033273696899
Epoch: 4, Steps: 17 | Train Loss: 2.061 Vali Loss: 2.019 Vali Acc: 0.359 Test Loss: 2.019 Test Acc: 0.359
Validation loss decreased (-0.283763 --> -0.359439).  Saving model ...
Epoch: 5 cost time: 4.251560211181641
Epoch: 5, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.967 Vali Acc: 0.427 Test Loss: 1.967 Test Acc: 0.427
Validation loss decreased (-0.359439 --> -0.427007).  Saving model ...
Epoch: 6 cost time: 4.454149961471558
Epoch: 6, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.900 Vali Acc: 0.511 Test Loss: 1.900 Test Acc: 0.511
Validation loss decreased (-0.427007 --> -0.510792).  Saving model ...
Epoch: 7 cost time: 5.023047685623169
Epoch: 7, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.821 Vali Acc: 0.586 Test Loss: 1.821 Test Acc: 0.586
Validation loss decreased (-0.510792 --> -0.586468).  Saving model ...
Epoch: 8 cost time: 4.322109222412109
Epoch: 8, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.743 Vali Acc: 0.597 Test Loss: 1.743 Test Acc: 0.597
Validation loss decreased (-0.586468 --> -0.597280).  Saving model ...
Epoch: 9 cost time: 4.605262041091919
Epoch: 9, Steps: 17 | Train Loss: 1.649 Vali Loss: 1.647 Vali Acc: 0.635 Test Loss: 1.647 Test Acc: 0.635
Validation loss decreased (-0.597280 --> -0.635119).  Saving model ...
Epoch: 10 cost time: 4.776430368423462
Epoch: 10, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.554 Vali Acc: 0.638 Test Loss: 1.554 Test Acc: 0.638
Validation loss decreased (-0.635119 --> -0.637822).  Saving model ...
Epoch: 11 cost time: 4.825144290924072
Epoch: 11, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.440 Vali Acc: 0.684 Test Loss: 1.440 Test Acc: 0.684
Validation loss decreased (-0.637822 --> -0.683769).  Saving model ...
Epoch: 12 cost time: 4.4089601039886475
Epoch: 12, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.327 Vali Acc: 0.716 Test Loss: 1.327 Test Acc: 0.716
Validation loss decreased (-0.683769 --> -0.716203).  Saving model ...
Epoch: 13 cost time: 4.630154371261597
Epoch: 13, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.219 Vali Acc: 0.722 Test Loss: 1.219 Test Acc: 0.722
Validation loss decreased (-0.716203 --> -0.721609).  Saving model ...
Epoch: 14 cost time: 4.754601716995239
Epoch: 14, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.119 Vali Acc: 0.738 Test Loss: 1.119 Test Acc: 0.738
Validation loss decreased (-0.721609 --> -0.737827).  Saving model ...
Epoch: 15 cost time: 4.332046031951904
Epoch: 15, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.026 Vali Acc: 0.738 Test Loss: 1.026 Test Acc: 0.738
Validation loss decreased (-0.737827 --> -0.737828).  Saving model ...
Epoch: 16 cost time: 4.837454319000244
Epoch: 16, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.920 Vali Acc: 0.773 Test Loss: 0.920 Test Acc: 0.773
Validation loss decreased (-0.737828 --> -0.772964).  Saving model ...
Epoch: 17 cost time: 4.692278861999512
Epoch: 17, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.829 Vali Acc: 0.786 Test Loss: 0.829 Test Acc: 0.786
Validation loss decreased (-0.772964 --> -0.786478).  Saving model ...
Epoch: 18 cost time: 5.184391260147095
Epoch: 18, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.741 Vali Acc: 0.814 Test Loss: 0.741 Test Acc: 0.814
Validation loss decreased (-0.786478 --> -0.813506).  Saving model ...
Epoch: 19 cost time: 4.685413837432861
Epoch: 19, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
Validation loss decreased (-0.813506 --> -0.818912).  Saving model ...
Epoch: 20 cost time: 4.508368015289307
Epoch: 20, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.634 Vali Acc: 0.824 Test Loss: 0.634 Test Acc: 0.824
Validation loss decreased (-0.818912 --> -0.824318).  Saving model ...
Epoch: 21 cost time: 4.777054071426392
Epoch: 21, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.582 Vali Acc: 0.846 Test Loss: 0.582 Test Acc: 0.846
Validation loss decreased (-0.824318 --> -0.845940).  Saving model ...
Epoch: 22 cost time: 4.924755573272705
Epoch: 22, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.533 Vali Acc: 0.849 Test Loss: 0.533 Test Acc: 0.849
Validation loss decreased (-0.845940 --> -0.848643).  Saving model ...
Epoch: 23 cost time: 4.319716215133667
Epoch: 23, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.496 Vali Acc: 0.865 Test Loss: 0.496 Test Acc: 0.865
Validation loss decreased (-0.848643 --> -0.864860).  Saving model ...
Epoch: 24 cost time: 4.445279359817505
Epoch: 24, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.464 Vali Acc: 0.873 Test Loss: 0.464 Test Acc: 0.873
Validation loss decreased (-0.864860 --> -0.872968).  Saving model ...
Epoch: 25 cost time: 4.330621242523193
Epoch: 25, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.443 Vali Acc: 0.878 Test Loss: 0.443 Test Acc: 0.878
Validation loss decreased (-0.872968 --> -0.878374).  Saving model ...
Epoch: 26 cost time: 4.341877698898315
Epoch: 26, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
Validation loss decreased (-0.878374 --> -0.883780).  Saving model ...
Epoch: 27 cost time: 4.4662346839904785
Epoch: 27, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.402 Vali Acc: 0.881 Test Loss: 0.402 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.945878267288208
Epoch: 28, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.365 Vali Acc: 0.892 Test Loss: 0.365 Test Acc: 0.892
Validation loss decreased (-0.883780 --> -0.891888).  Saving model ...
Epoch: 29 cost time: 5.038978099822998
Epoch: 29, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.351 Vali Acc: 0.897 Test Loss: 0.351 Test Acc: 0.897
Validation loss decreased (-0.891888 --> -0.897294).  Saving model ...
Epoch: 30 cost time: 4.3267662525177
Epoch: 30, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.342 Vali Acc: 0.895 Test Loss: 0.342 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.3395562171936035
Epoch: 31, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.897294 --> -0.902700).  Saving model ...
Epoch: 32 cost time: 4.680882453918457
Epoch: 32, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
Validation loss decreased (-0.902700 --> -0.918916).  Saving model ...
Epoch: 33 cost time: 4.693122386932373
Epoch: 33, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.329948663711548
Epoch: 34, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.044606924057007
Epoch: 35, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
Epoch: 36 cost time: 4.3827784061431885
Epoch: 36, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
Epoch: 37 cost time: 4.921936511993408
Epoch: 37, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.918916 --> -0.940538).  Saving model ...
Epoch: 38 cost time: 4.395357370376587
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.7209038734436035
Epoch: 39, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 5.4367194175720215
Epoch: 40, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.323017597198486
Epoch: 41, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 42 cost time: 4.8577353954315186
Epoch: 42, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 43 cost time: 4.426142454147339
Epoch: 43, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.261969089508057
Epoch: 44, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 45 cost time: 4.255892515182495
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.460916042327881
Epoch: 46, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 47 cost time: 3.986116647720337
Epoch: 47, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 48 cost time: 4.0400567054748535
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 49 cost time: 3.8254570960998535
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 50 cost time: 4.002384901046753
Epoch: 50, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 4.031306505203247
Epoch: 51, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 4.589626312255859
Epoch: 52, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 4.838047981262207
Epoch: 53, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 4.025528192520142
Epoch: 54, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 55 cost time: 4.1905364990234375
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 4.7692015171051025
Epoch: 56, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 4.205167770385742
Epoch: 57, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 4.479210376739502
Epoch: 58, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 59 cost time: 4.445772171020508
Epoch: 59, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 60 cost time: 4.725404739379883
Epoch: 60, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 61 cost time: 5.097132205963135
Epoch: 61, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 62 cost time: 4.595910549163818
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 63 cost time: 4.09545111656189
Epoch: 63, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 4.867180585861206
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.579577684402466
Epoch: 65, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 5.399190187454224
Epoch: 66, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 67 cost time: 4.3826820850372314
Epoch: 67, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.227599620819092
Epoch: 68, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 5.064846038818359
Epoch: 69, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 4.597320556640625
Epoch: 70, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 4.57726788520813
Epoch: 71, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 5.132037401199341
Epoch: 72, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 4.779155731201172
Epoch: 73, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 5.032182931900024
Epoch: 74, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 5.550049304962158
Epoch: 75, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 76 cost time: 5.301150798797607
Epoch: 76, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.5836286544799805
Epoch: 77, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 5.245070934295654
Epoch: 78, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 5.562969207763672
Epoch: 79, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 4.59721040725708
Epoch: 80, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 4.242766380310059
Epoch: 81, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 5.039853572845459
Epoch: 82, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 4.887930631637573
Epoch: 83, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 4.353024482727051
Epoch: 84, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 4.8360795974731445
Epoch: 85, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 59209
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.239344120025635
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 2.167 Vali Acc: 0.181 Test Loss: 2.167 Test Acc: 0.181
Validation loss decreased (inf --> -0.181059).  Saving model ...
Epoch: 2 cost time: 4.555859327316284
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.140 Vali Acc: 0.216 Test Loss: 2.140 Test Acc: 0.216
Validation loss decreased (-0.181059 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 4.453392267227173
Epoch: 3, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.102 Vali Acc: 0.265 Test Loss: 2.102 Test Acc: 0.265
Validation loss decreased (-0.216195 --> -0.264844).  Saving model ...
Epoch: 4 cost time: 4.331441164016724
Epoch: 4, Steps: 17 | Train Loss: 2.103 Vali Loss: 2.053 Vali Acc: 0.359 Test Loss: 2.053 Test Acc: 0.359
Validation loss decreased (-0.264844 --> -0.359439).  Saving model ...
Epoch: 5 cost time: 4.343611478805542
Epoch: 5, Steps: 17 | Train Loss: 2.029 Vali Loss: 2.004 Vali Acc: 0.403 Test Loss: 2.004 Test Acc: 0.403
Validation loss decreased (-0.359439 --> -0.402683).  Saving model ...
Epoch: 6 cost time: 4.311202049255371
Epoch: 6, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.941 Vali Acc: 0.451 Test Loss: 1.941 Test Acc: 0.451
Validation loss decreased (-0.402683 --> -0.451332).  Saving model ...
Epoch: 7 cost time: 4.168125629425049
Epoch: 7, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.867 Vali Acc: 0.489 Test Loss: 1.867 Test Acc: 0.489
Validation loss decreased (-0.451332 --> -0.489171).  Saving model ...
Epoch: 8 cost time: 4.41603946685791
Epoch: 8, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.793 Vali Acc: 0.530 Test Loss: 1.793 Test Acc: 0.530
Validation loss decreased (-0.489171 --> -0.529712).  Saving model ...
Epoch: 9 cost time: 4.021492004394531
Epoch: 9, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.694 Vali Acc: 0.589 Test Loss: 1.694 Test Acc: 0.589
Validation loss decreased (-0.529712 --> -0.589172).  Saving model ...
Epoch: 10 cost time: 4.66284966468811
Epoch: 10, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.593 Vali Acc: 0.614 Test Loss: 1.593 Test Acc: 0.614
Validation loss decreased (-0.589172 --> -0.613498).  Saving model ...
Epoch: 11 cost time: 4.3915088176727295
Epoch: 11, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.466 Vali Acc: 0.643 Test Loss: 1.466 Test Acc: 0.643
Validation loss decreased (-0.613498 --> -0.643229).  Saving model ...
Epoch: 12 cost time: 4.69960355758667
Epoch: 12, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.335 Vali Acc: 0.708 Test Loss: 1.335 Test Acc: 0.708
Validation loss decreased (-0.643229 --> -0.708095).  Saving model ...
Epoch: 13 cost time: 4.551420211791992
Epoch: 13, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.202 Vali Acc: 0.743 Test Loss: 1.202 Test Acc: 0.743
Validation loss decreased (-0.708095 --> -0.743231).  Saving model ...
Epoch: 14 cost time: 3.9864258766174316
Epoch: 14, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.079 Vali Acc: 0.757 Test Loss: 1.079 Test Acc: 0.757
Validation loss decreased (-0.743231 --> -0.756746).  Saving model ...
Epoch: 15 cost time: 4.278608322143555
Epoch: 15, Steps: 17 | Train Loss: 1.004 Vali Loss: 0.979 Vali Acc: 0.795 Test Loss: 0.979 Test Acc: 0.795
Validation loss decreased (-0.756746 --> -0.794585).  Saving model ...
Epoch: 16 cost time: 4.602877616882324
Epoch: 16, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.879 Vali Acc: 0.822 Test Loss: 0.879 Test Acc: 0.822
Validation loss decreased (-0.794585 --> -0.821613).  Saving model ...
Epoch: 17 cost time: 3.804408311843872
Epoch: 17, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.790 Vali Acc: 0.824 Test Loss: 0.790 Test Acc: 0.824
Validation loss decreased (-0.821613 --> -0.824316).  Saving model ...
Epoch: 18 cost time: 3.9368958473205566
Epoch: 18, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.705 Vali Acc: 0.846 Test Loss: 0.705 Test Acc: 0.846
Validation loss decreased (-0.824316 --> -0.845939).  Saving model ...
Epoch: 19 cost time: 4.0853729248046875
Epoch: 19, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.634 Vali Acc: 0.862 Test Loss: 0.634 Test Acc: 0.862
Validation loss decreased (-0.845939 --> -0.862156).  Saving model ...
Epoch: 20 cost time: 4.615894556045532
Epoch: 20, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
Validation loss decreased (-0.862156 --> -0.862156).  Saving model ...
Epoch: 21 cost time: 4.726919174194336
Epoch: 21, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
Validation loss decreased (-0.862156 --> -0.862157).  Saving model ...
Epoch: 22 cost time: 3.8006718158721924
Epoch: 22, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
Validation loss decreased (-0.862157 --> -0.878373).  Saving model ...
Epoch: 23 cost time: 4.121860980987549
Epoch: 23, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.450 Vali Acc: 0.892 Test Loss: 0.450 Test Acc: 0.892
Validation loss decreased (-0.878373 --> -0.891887).  Saving model ...
Epoch: 24 cost time: 5.194025278091431
Epoch: 24, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.55144739151001
Epoch: 25, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.385 Vali Acc: 0.895 Test Loss: 0.385 Test Acc: 0.895
Validation loss decreased (-0.891887 --> -0.894591).  Saving model ...
Epoch: 26 cost time: 4.567615747451782
Epoch: 26, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.362 Vali Acc: 0.905 Test Loss: 0.362 Test Acc: 0.905
Validation loss decreased (-0.894591 --> -0.905402).  Saving model ...
Epoch: 27 cost time: 4.688941717147827
Epoch: 27, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.788563966751099
Epoch: 28, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
Validation loss decreased (-0.905402 --> -0.910808).  Saving model ...
Epoch: 29 cost time: 4.56055212020874
Epoch: 29, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.176404714584351
Epoch: 30, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.306 Vali Acc: 0.895 Test Loss: 0.306 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.353137016296387
Epoch: 31, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.277 Vali Acc: 0.905 Test Loss: 0.277 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.658152341842651
Epoch: 32, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.260 Vali Acc: 0.914 Test Loss: 0.260 Test Acc: 0.914
Validation loss decreased (-0.910808 --> -0.913511).  Saving model ...
Epoch: 33 cost time: 4.859389781951904
Epoch: 33, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.273 Vali Acc: 0.905 Test Loss: 0.273 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.759875535964966
Epoch: 34, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.259 Vali Acc: 0.914 Test Loss: 0.259 Test Acc: 0.914
Validation loss decreased (-0.913511 --> -0.913511).  Saving model ...
Epoch: 35 cost time: 4.500282287597656
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.913511 --> -0.921619).  Saving model ...
Epoch: 36 cost time: 4.427067279815674
Epoch: 36, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.228 Vali Acc: 0.916 Test Loss: 0.228 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.439703941345215
Epoch: 37, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.228 Vali Acc: 0.916 Test Loss: 0.228 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.0363850593566895
Epoch: 38, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.212 Vali Acc: 0.916 Test Loss: 0.212 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.390801191329956
Epoch: 39, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
Validation loss decreased (-0.921619 --> -0.932430).  Saving model ...
Epoch: 40 cost time: 3.955928325653076
Epoch: 40, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.039479732513428
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.197 Vali Acc: 0.924 Test Loss: 0.197 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.147809982299805
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 43 cost time: 4.900908708572388
Epoch: 43, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.3773112297058105
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.938 Test Loss: 0.172 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 45 cost time: 4.163907289505005
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943242).  Saving model ...
Epoch: 46 cost time: 4.531620025634766
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.938 Test Loss: 0.161 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 4.631074666976929
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 4.24631929397583
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.897507667541504
Epoch: 49, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 4.188073396682739
Epoch: 50, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.935 Test Loss: 0.165 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 4.561784982681274
Epoch: 51, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 4.605910062789917
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.935 Test Loss: 0.154 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 4.333766937255859
Epoch: 53, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.938 Test Loss: 0.160 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 4.0991599559783936
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.938 Test Loss: 0.162 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 4.274981498718262
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 59209
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.804710865020752
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.219 Vali Acc: 0.119 Test Loss: 2.219 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 5.131115913391113
Epoch: 2, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.195 Vali Acc: 0.135 Test Loss: 2.195 Test Acc: 0.135
Validation loss decreased (-0.118897 --> -0.135113).  Saving model ...
Epoch: 3 cost time: 4.719453811645508
Epoch: 3, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.159 Vali Acc: 0.176 Test Loss: 2.159 Test Acc: 0.176
Validation loss decreased (-0.135113 --> -0.175654).  Saving model ...
Epoch: 4 cost time: 5.484323501586914
Epoch: 4, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.113 Vali Acc: 0.265 Test Loss: 2.113 Test Acc: 0.265
Validation loss decreased (-0.175654 --> -0.264844).  Saving model ...
Epoch: 5 cost time: 4.792988538742065
Epoch: 5, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.064 Vali Acc: 0.338 Test Loss: 2.064 Test Acc: 0.338
Validation loss decreased (-0.264844 --> -0.337817).  Saving model ...
Epoch: 6 cost time: 5.260786771774292
Epoch: 6, Steps: 17 | Train Loss: 2.055 Vali Loss: 2.001 Vali Acc: 0.395 Test Loss: 2.001 Test Acc: 0.395
Validation loss decreased (-0.337817 --> -0.394575).  Saving model ...
Epoch: 7 cost time: 4.987056493759155
Epoch: 7, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.922 Vali Acc: 0.459 Test Loss: 1.922 Test Acc: 0.459
Validation loss decreased (-0.394575 --> -0.459440).  Saving model ...
Epoch: 8 cost time: 5.732900381088257
Epoch: 8, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.837 Vali Acc: 0.522 Test Loss: 1.837 Test Acc: 0.522
Validation loss decreased (-0.459440 --> -0.521603).  Saving model ...
Epoch: 9 cost time: 5.6880669593811035
Epoch: 9, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.727 Vali Acc: 0.576 Test Loss: 1.727 Test Acc: 0.576
Validation loss decreased (-0.521603 --> -0.575658).  Saving model ...
Epoch: 10 cost time: 5.435391902923584
Epoch: 10, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.617 Vali Acc: 0.630 Test Loss: 1.617 Test Acc: 0.630
Validation loss decreased (-0.575658 --> -0.629714).  Saving model ...
Epoch: 11 cost time: 4.944656848907471
Epoch: 11, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.490 Vali Acc: 0.684 Test Loss: 1.490 Test Acc: 0.684
Validation loss decreased (-0.629714 --> -0.683769).  Saving model ...
Epoch: 12 cost time: 5.536355495452881
Epoch: 12, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.362 Vali Acc: 0.727 Test Loss: 1.362 Test Acc: 0.727
Validation loss decreased (-0.683769 --> -0.727013).  Saving model ...
Epoch: 13 cost time: 5.264053821563721
Epoch: 13, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.241 Vali Acc: 0.754 Test Loss: 1.241 Test Acc: 0.754
Validation loss decreased (-0.727013 --> -0.754042).  Saving model ...
Epoch: 14 cost time: 4.350735902786255
Epoch: 14, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.116 Vali Acc: 0.778 Test Loss: 1.116 Test Acc: 0.778
Validation loss decreased (-0.754042 --> -0.778367).  Saving model ...
Epoch: 15 cost time: 4.875284671783447
Epoch: 15, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.012 Vali Acc: 0.770 Test Loss: 1.012 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.257566928863525
Epoch: 16, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.899 Vali Acc: 0.784 Test Loss: 0.899 Test Acc: 0.784
Validation loss decreased (-0.778367 --> -0.783775).  Saving model ...
Epoch: 17 cost time: 4.783899784088135
Epoch: 17, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.811 Vali Acc: 0.795 Test Loss: 0.811 Test Acc: 0.795
Validation loss decreased (-0.783775 --> -0.794586).  Saving model ...
Epoch: 18 cost time: 4.907914161682129
Epoch: 18, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.691 Vali Acc: 0.849 Test Loss: 0.691 Test Acc: 0.849
Validation loss decreased (-0.794586 --> -0.848642).  Saving model ...
Epoch: 19 cost time: 4.296452283859253
Epoch: 19, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.611 Vali Acc: 0.854 Test Loss: 0.611 Test Acc: 0.854
Validation loss decreased (-0.848642 --> -0.854048).  Saving model ...
Epoch: 20 cost time: 5.433534622192383
Epoch: 20, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.555 Vali Acc: 0.862 Test Loss: 0.555 Test Acc: 0.862
Validation loss decreased (-0.854048 --> -0.862157).  Saving model ...
Epoch: 21 cost time: 5.935267210006714
Epoch: 21, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.488 Vali Acc: 0.873 Test Loss: 0.488 Test Acc: 0.873
Validation loss decreased (-0.862157 --> -0.872968).  Saving model ...
Epoch: 22 cost time: 5.53169584274292
Epoch: 22, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.433 Vali Acc: 0.881 Test Loss: 0.433 Test Acc: 0.881
Validation loss decreased (-0.872968 --> -0.881077).  Saving model ...
Epoch: 23 cost time: 5.422662973403931
Epoch: 23, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.399 Vali Acc: 0.897 Test Loss: 0.399 Test Acc: 0.897
Validation loss decreased (-0.881077 --> -0.897293).  Saving model ...
Epoch: 24 cost time: 5.643052816390991
Epoch: 24, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.364 Vali Acc: 0.908 Test Loss: 0.364 Test Acc: 0.908
Validation loss decreased (-0.897293 --> -0.908104).  Saving model ...
Epoch: 25 cost time: 5.687014579772949
Epoch: 25, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.327 Vali Acc: 0.905 Test Loss: 0.327 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.48856258392334
Epoch: 26, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.315 Vali Acc: 0.905 Test Loss: 0.315 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.309834241867065
Epoch: 27, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910808).  Saving model ...
Epoch: 28 cost time: 5.044650316238403
Epoch: 28, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
Validation loss decreased (-0.910808 --> -0.932430).  Saving model ...
Epoch: 29 cost time: 4.362382888793945
Epoch: 29, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.757456064224243
Epoch: 30, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.247 Vali Acc: 0.924 Test Loss: 0.247 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.479027509689331
Epoch: 31, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 32 cost time: 5.587948560714722
Epoch: 32, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 33 cost time: 5.133612155914307
Epoch: 33, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 34 cost time: 5.209339618682861
Epoch: 34, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.423917293548584
Epoch: 35, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.526074647903442
Epoch: 36, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.905406951904297
Epoch: 37, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.844559192657471
Epoch: 38, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 39 cost time: 4.9078404903411865
Epoch: 39, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 40 cost time: 5.365381956100464
Epoch: 40, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.685127258300781
Epoch: 41, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.793128728866577
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.21199107170105
Epoch: 43, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.394242286682129
Epoch: 44, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 45 cost time: 5.551447153091431
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.356745719909668
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.332495927810669
Epoch: 47, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.243799924850464
Epoch: 48, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 5.753863334655762
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 50 cost time: 6.677884817123413
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 4.938320636749268
Epoch: 51, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 4.877455949783325
Epoch: 52, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.776748180389404
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 5.030003309249878
Epoch: 54, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 5.664508581161499
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 5.123196363449097
Epoch: 56, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 5.989551067352295
Epoch: 57, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 5.36397910118103
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 5.124574184417725
Epoch: 59, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 59209
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.641037464141846
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.253 Vali Acc: 0.108 Test Loss: 2.253 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 4.449947834014893
Epoch: 2, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.224 Vali Acc: 0.132 Test Loss: 2.224 Test Acc: 0.132
Validation loss decreased (-0.108086 --> -0.132410).  Saving model ...
Epoch: 3 cost time: 3.8448359966278076
Epoch: 3, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.182 Vali Acc: 0.165 Test Loss: 2.182 Test Acc: 0.165
Validation loss decreased (-0.132410 --> -0.164843).  Saving model ...
Epoch: 4 cost time: 4.47855281829834
Epoch: 4, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.129 Vali Acc: 0.224 Test Loss: 2.129 Test Acc: 0.224
Validation loss decreased (-0.164843 --> -0.224303).  Saving model ...
Epoch: 5 cost time: 4.088946104049683
Epoch: 5, Steps: 17 | Train Loss: 2.064 Vali Loss: 2.070 Vali Acc: 0.284 Test Loss: 2.070 Test Acc: 0.284
Validation loss decreased (-0.224303 --> -0.283763).  Saving model ...
Epoch: 6 cost time: 4.486900568008423
Epoch: 6, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.999 Vali Acc: 0.349 Test Loss: 1.999 Test Acc: 0.349
Validation loss decreased (-0.283763 --> -0.348629).  Saving model ...
Epoch: 7 cost time: 4.499867916107178
Epoch: 7, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.914 Vali Acc: 0.438 Test Loss: 1.914 Test Acc: 0.438
Validation loss decreased (-0.348629 --> -0.437819).  Saving model ...
Epoch: 8 cost time: 4.47977614402771
Epoch: 8, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.826 Vali Acc: 0.484 Test Loss: 1.826 Test Acc: 0.484
Validation loss decreased (-0.437819 --> -0.483766).  Saving model ...
Epoch: 9 cost time: 4.604253053665161
Epoch: 9, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.721 Vali Acc: 0.538 Test Loss: 1.721 Test Acc: 0.538
Validation loss decreased (-0.483766 --> -0.537821).  Saving model ...
Epoch: 10 cost time: 4.832056522369385
Epoch: 10, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.612 Vali Acc: 0.578 Test Loss: 1.612 Test Acc: 0.578
Validation loss decreased (-0.537821 --> -0.578362).  Saving model ...
Epoch: 11 cost time: 4.314397811889648
Epoch: 11, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.491 Vali Acc: 0.638 Test Loss: 1.491 Test Acc: 0.638
Validation loss decreased (-0.578362 --> -0.637823).  Saving model ...
Epoch: 12 cost time: 4.336824417114258
Epoch: 12, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.369 Vali Acc: 0.673 Test Loss: 1.369 Test Acc: 0.673
Validation loss decreased (-0.637823 --> -0.672959).  Saving model ...
Epoch: 13 cost time: 4.672311305999756
Epoch: 13, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.252 Vali Acc: 0.719 Test Loss: 1.252 Test Acc: 0.719
Validation loss decreased (-0.672959 --> -0.718906).  Saving model ...
Epoch: 14 cost time: 4.207092523574829
Epoch: 14, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.139 Vali Acc: 0.759 Test Loss: 1.139 Test Acc: 0.759
Validation loss decreased (-0.718906 --> -0.759448).  Saving model ...
Epoch: 15 cost time: 4.1084160804748535
Epoch: 15, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.045 Vali Acc: 0.754 Test Loss: 1.045 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.1445631980896
Epoch: 16, Steps: 17 | Train Loss: 0.964 Vali Loss: 0.939 Vali Acc: 0.776 Test Loss: 0.939 Test Acc: 0.776
Validation loss decreased (-0.759448 --> -0.775666).  Saving model ...
Epoch: 17 cost time: 4.383781433105469
Epoch: 17, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.847 Vali Acc: 0.795 Test Loss: 0.847 Test Acc: 0.795
Validation loss decreased (-0.775666 --> -0.794586).  Saving model ...
Epoch: 18 cost time: 4.290833234786987
Epoch: 18, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.746 Vali Acc: 0.814 Test Loss: 0.746 Test Acc: 0.814
Validation loss decreased (-0.794586 --> -0.813506).  Saving model ...
Epoch: 19 cost time: 4.739403009414673
Epoch: 19, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.661 Vali Acc: 0.838 Test Loss: 0.661 Test Acc: 0.838
Validation loss decreased (-0.813506 --> -0.837831).  Saving model ...
Epoch: 20 cost time: 4.608306407928467
Epoch: 20, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.604 Vali Acc: 0.835 Test Loss: 0.604 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.400602579116821
Epoch: 21, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.544 Vali Acc: 0.857 Test Loss: 0.544 Test Acc: 0.857
Validation loss decreased (-0.837831 --> -0.856751).  Saving model ...
Epoch: 22 cost time: 4.820388555526733
Epoch: 22, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.469 Vali Acc: 0.873 Test Loss: 0.469 Test Acc: 0.873
Validation loss decreased (-0.856751 --> -0.872968).  Saving model ...
Epoch: 23 cost time: 4.46440863609314
Epoch: 23, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.427 Vali Acc: 0.884 Test Loss: 0.427 Test Acc: 0.884
Validation loss decreased (-0.872968 --> -0.883780).  Saving model ...
Epoch: 24 cost time: 5.076339244842529
Epoch: 24, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.398 Vali Acc: 0.884 Test Loss: 0.398 Test Acc: 0.884
Validation loss decreased (-0.883780 --> -0.883780).  Saving model ...
Epoch: 25 cost time: 4.904569149017334
Epoch: 25, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.883780 --> -0.902699).  Saving model ...
Epoch: 26 cost time: 5.436359405517578
Epoch: 26, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
Validation loss decreased (-0.902699 --> -0.910807).  Saving model ...
Epoch: 27 cost time: 4.559049129486084
Epoch: 27, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.318 Vali Acc: 0.914 Test Loss: 0.318 Test Acc: 0.914
Validation loss decreased (-0.910807 --> -0.913510).  Saving model ...
Epoch: 28 cost time: 3.9542553424835205
Epoch: 28, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 29 cost time: 4.681976795196533
Epoch: 29, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 30 cost time: 4.678344964981079
Epoch: 30, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.270 Vali Acc: 0.924 Test Loss: 0.270 Test Acc: 0.924
Validation loss decreased (-0.921619 --> -0.924322).  Saving model ...
Epoch: 31 cost time: 4.836081504821777
Epoch: 31, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.401403188705444
Epoch: 32, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.924322 --> -0.929727).  Saving model ...
Epoch: 33 cost time: 3.958111524581909
Epoch: 33, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 34 cost time: 4.346968173980713
Epoch: 34, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.2522876262664795
Epoch: 35, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 36 cost time: 4.818395137786865
Epoch: 36, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.3613622188568115
Epoch: 37, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.693123817443848
Epoch: 38, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 39 cost time: 4.6636810302734375
Epoch: 39, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 40 cost time: 4.24802041053772
Epoch: 40, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.258176803588867
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 42 cost time: 5.1762354373931885
Epoch: 42, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 43 cost time: 4.460545539855957
Epoch: 43, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.826087236404419
Epoch: 44, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 45 cost time: 4.072814702987671
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.628695249557495
Epoch: 46, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 47 cost time: 4.547508239746094
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 48 cost time: 4.4590163230896
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 49 cost time: 4.4847047328948975
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 50 cost time: 4.3998942375183105
Epoch: 50, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 51 cost time: 4.079334020614624
Epoch: 51, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.1008172035217285
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 53 cost time: 4.180492162704468
Epoch: 53, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.158742666244507
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 55 cost time: 4.442777872085571
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 4.5910797119140625
Epoch: 56, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 4.241420030593872
Epoch: 57, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 4.108692407608032
Epoch: 58, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 59 cost time: 4.201767683029175
Epoch: 59, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 4.234381437301636
Epoch: 60, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 4.155726909637451
Epoch: 61, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 4.348424196243286
Epoch: 62, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 4.534600496292114
Epoch: 63, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 4.397211313247681
Epoch: 64, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 4.781375885009766
Epoch: 65, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 4.991674184799194
Epoch: 66, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 4.508805513381958
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 5.187285661697388
Epoch: 68, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 59209
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
 fourier enhanced cross attention used!
modes_q=7, index_q=[0, 1, 2, 3, 4, 5, 6]
modes_kv=14, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>>>>>>start training : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.10413670539856
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 5.9199888706207275
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.11202335357666
Epoch: 3, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.786609172821045
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 5 cost time: 5.012574195861816
Epoch: 5, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.380766868591309
Epoch: 6, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.777015924453735
Epoch: 7, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 8 cost time: 4.765544414520264
Epoch: 8, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.040086984634399
Epoch: 9, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 10 cost time: 4.464717388153076
Epoch: 10, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.908279895782471
Epoch: 11, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.690270662307739
Epoch: 12, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.749669075012207
Epoch: 13, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 14 cost time: 6.703137636184692
Epoch: 14, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 15 cost time: 5.008783340454102
Epoch: 15, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.7563066482543945
Epoch: 16, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.374671459197998
Epoch: 17, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.952369451522827
Epoch: 18, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.488128662109375
Epoch: 19, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.15302300453186
Epoch: 20, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.38709831237793
Epoch: 21, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.461452960968018
Epoch: 22, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.474830865859985
Epoch: 23, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 24 cost time: 4.175330638885498
Epoch: 24, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.541879653930664
Epoch: 25, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 26 cost time: 5.139777421951294
Epoch: 26, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 27 cost time: 6.004274129867554
Epoch: 27, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.626809597015381
Epoch: 28, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.094188451766968
Epoch: 29, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.756267786026001
Epoch: 30, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.359037160873413
Epoch: 31, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.563308477401733
Epoch: 32, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 33 cost time: 6.067461729049683
Epoch: 33, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.29108738899231
Epoch: 34, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.753488540649414
Epoch: 35, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
Validation loss decreased (-0.108086 --> -0.108086).  Saving model ...
Epoch: 36 cost time: 4.964758634567261
Epoch: 36, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.311388254165649
Epoch: 37, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.622822523117065
Epoch: 38, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.646742343902588
Epoch: 39, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.72939395904541
Epoch: 40, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.134824752807617
Epoch: 41, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 5.958365440368652
Epoch: 42, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.676315546035767
Epoch: 43, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.107621908187866
Epoch: 44, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 5.373858690261841
Epoch: 45, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.198 Vali Acc: 0.108 Test Loss: 2.198 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_FEDformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.10810810810810811
model parameter : 59209
model size : 1.47MB
