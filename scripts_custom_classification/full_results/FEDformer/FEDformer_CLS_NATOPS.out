Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.025768280029297
Epoch: 1, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.395 Vali Acc: 0.489 Test Loss: 1.395 Test Acc: 0.489
Validation loss decreased (inf --> -0.488875).  Saving model ...
Epoch: 2 cost time: 4.129771709442139
Epoch: 2, Steps: 12 | Train Loss: 1.168 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.488875 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 4.105930328369141
Epoch: 3, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
Validation loss decreased (-0.599990 --> -0.677771).  Saving model ...
Epoch: 4 cost time: 4.039919137954712
Epoch: 4, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.654 Vali Acc: 0.739 Test Loss: 0.654 Test Acc: 0.739
Validation loss decreased (-0.677771 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 4.298312425613403
Epoch: 5, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.440 Vali Acc: 0.828 Test Loss: 0.440 Test Acc: 0.828
Validation loss decreased (-0.738882 --> -0.827773).  Saving model ...
Epoch: 6 cost time: 4.320335626602173
Epoch: 6, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.432 Vali Acc: 0.789 Test Loss: 0.432 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.221348524093628
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.461689233779907
Epoch: 8, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 9 cost time: 4.135020732879639
Epoch: 9, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 4.249688386917114
Epoch: 10, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.072251319885254
Epoch: 11, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8050179481506348
Epoch: 12, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.386 Vali Acc: 0.872 Test Loss: 0.386 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872218).  Saving model ...
Epoch: 13 cost time: 3.976008892059326
Epoch: 13, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.376 Vali Acc: 0.872 Test Loss: 0.376 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 14 cost time: 3.970883846282959
Epoch: 14, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.919063091278076
Epoch: 15, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.328281402587891
Epoch: 16, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.425 Vali Acc: 0.878 Test Loss: 0.425 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 3.7157042026519775
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.15412974357605
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.267731189727783
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.12321662902832
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.400 Vali Acc: 0.883 Test Loss: 0.400 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 21 cost time: 3.9588613510131836
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.711 Vali Acc: 0.861 Test Loss: 0.711 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.789641857147217
Epoch: 22, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.619 Vali Acc: 0.872 Test Loss: 0.619 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.675544023513794
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.731 Vali Acc: 0.872 Test Loss: 0.731 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.833750009536743
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
Validation loss decreased (-0.883329 --> -0.916662).  Saving model ...
Epoch: 25 cost time: 4.377943992614746
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.2672035694122314
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.514 Vali Acc: 0.894 Test Loss: 0.514 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.341106176376343
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.576039552688599
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.964 Vali Acc: 0.822 Test Loss: 1.964 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.038424730300903
Epoch: 29, Steps: 12 | Train Loss: 0.232 Vali Loss: 1.394 Vali Acc: 0.783 Test Loss: 1.394 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.239617109298706
Epoch: 30, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.7071430683135986
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.170 Vali Acc: 0.839 Test Loss: 1.170 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.03428840637207
Epoch: 32, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.580 Vali Acc: 0.889 Test Loss: 0.580 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.5602846145629883
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.887600898742676
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.0926783084869385
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.473 Vali Acc: 0.428 Test Loss: 1.473 Test Acc: 0.428
Validation loss decreased (inf --> -0.427763).  Saving model ...
Epoch: 2 cost time: 4.106664180755615
Epoch: 2, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.078 Vali Acc: 0.544 Test Loss: 1.078 Test Acc: 0.544
Validation loss decreased (-0.427763 --> -0.544434).  Saving model ...
Epoch: 3 cost time: 4.259481906890869
Epoch: 3, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.807 Vali Acc: 0.622 Test Loss: 0.807 Test Acc: 0.622
Validation loss decreased (-0.544434 --> -0.622214).  Saving model ...
Epoch: 4 cost time: 4.011227607727051
Epoch: 4, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.668 Vali Acc: 0.728 Test Loss: 0.668 Test Acc: 0.728
Validation loss decreased (-0.622214 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 3.7990267276763916
Epoch: 5, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.509 Vali Acc: 0.800 Test Loss: 0.509 Test Acc: 0.800
Validation loss decreased (-0.727771 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 3.87186598777771
Epoch: 6, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.448 Vali Acc: 0.794 Test Loss: 0.448 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8172407150268555
Epoch: 7, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.474 Vali Acc: 0.789 Test Loss: 0.474 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7512500286102295
Epoch: 8, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.564 Vali Acc: 0.811 Test Loss: 0.564 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 3.822112560272217
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.336 Vali Acc: 0.878 Test Loss: 0.336 Test Acc: 0.878
Validation loss decreased (-0.811105 --> -0.877774).  Saving model ...
Epoch: 10 cost time: 4.053997278213501
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.085681438446045
Epoch: 11, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.045467376708984
Epoch: 12, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.081396579742432
Epoch: 13, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.412 Vali Acc: 0.856 Test Loss: 0.412 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.280293226242065
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.000018358230591
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.246371507644653
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 3.9661574363708496
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7322745323181152
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9320433139801025
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9724252223968506
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.722 Vali Acc: 0.878 Test Loss: 0.722 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.524988174438477
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.763 Vali Acc: 0.839 Test Loss: 0.763 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.389911413192749
Epoch: 22, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.776 Vali Acc: 0.867 Test Loss: 0.776 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.121328353881836
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.225 Vali Acc: 0.850 Test Loss: 1.225 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.3172008991241455
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.866 Vali Acc: 0.878 Test Loss: 0.866 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.028584003448486
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.843 Vali Acc: 0.861 Test Loss: 0.843 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.9830615520477295
Epoch: 26, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.442 Vali Acc: 0.917 Test Loss: 0.442 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916662).  Saving model ...
Epoch: 27 cost time: 4.08913516998291
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.351 Vali Acc: 0.844 Test Loss: 1.351 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.095806837081909
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.872 Vali Acc: 0.844 Test Loss: 0.872 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.946136236190796
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.676 Vali Acc: 0.911 Test Loss: 0.676 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.843658685684204
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6496033668518066
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.130198955535889
Epoch: 32, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9262213706970215
Epoch: 33, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.735 Vali Acc: 0.878 Test Loss: 0.735 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.963031530380249
Epoch: 34, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.966 Vali Acc: 0.861 Test Loss: 0.966 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.859189987182617
Epoch: 35, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.277 Vali Acc: 0.850 Test Loss: 1.277 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.6602847576141357
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.350 Vali Acc: 0.861 Test Loss: 1.350 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.682334661483765
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.516 Vali Acc: 0.367 Test Loss: 1.516 Test Acc: 0.367
Validation loss decreased (inf --> -0.366652).  Saving model ...
Epoch: 2 cost time: 3.870157241821289
Epoch: 2, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.178 Vali Acc: 0.461 Test Loss: 1.178 Test Acc: 0.461
Validation loss decreased (-0.366652 --> -0.461099).  Saving model ...
Epoch: 3 cost time: 3.6605730056762695
Epoch: 3, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.975 Vali Acc: 0.578 Test Loss: 0.975 Test Acc: 0.578
Validation loss decreased (-0.461099 --> -0.577768).  Saving model ...
Epoch: 4 cost time: 3.684373378753662
Epoch: 4, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
Validation loss decreased (-0.577768 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 3.6526598930358887
Epoch: 5, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.711 Vali Acc: 0.683 Test Loss: 0.711 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6157147884368896
Epoch: 6, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.435 Vali Acc: 0.767 Test Loss: 0.435 Test Acc: 0.767
Validation loss decreased (-0.711104 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 4.09956693649292
Epoch: 7, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.602 Vali Acc: 0.772 Test Loss: 0.602 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 3.8393516540527344
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.615 Vali Acc: 0.806 Test Loss: 0.615 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 3.867377996444702
Epoch: 9, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 3.8779726028442383
Epoch: 10, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.542 Vali Acc: 0.811 Test Loss: 0.542 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9366471767425537
Epoch: 11, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.01164436340332
Epoch: 12, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.857992649078369
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5297443866729736
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.896 Vali Acc: 0.844 Test Loss: 0.896 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844435).  Saving model ...
Epoch: 15 cost time: 3.494802713394165
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.892 Vali Acc: 0.822 Test Loss: 0.892 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.570678472518921
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.649592399597168
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
Validation loss decreased (-0.844435 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 3.5901572704315186
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.831 Vali Acc: 0.828 Test Loss: 0.831 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9964029788970947
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 4.046146392822266
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.113 Vali Acc: 0.828 Test Loss: 1.113 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.232130527496338
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.056 Vali Acc: 0.856 Test Loss: 1.056 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8068816661834717
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.627 Vali Acc: 0.889 Test Loss: 0.627 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 4.17061185836792
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.673 Vali Acc: 0.889 Test Loss: 0.673 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.194053649902344
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.864 Vali Acc: 0.856 Test Loss: 0.864 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.071769714355469
Epoch: 25, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.8448028564453125
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.733 Vali Acc: 0.900 Test Loss: 0.733 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 3.9230616092681885
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.235 Vali Acc: 0.856 Test Loss: 1.235 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.027673721313477
Epoch: 28, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.796 Vali Acc: 0.889 Test Loss: 0.796 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9437057971954346
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.894 Test Loss: 0.664 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.3532164096832275
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.908 Vali Acc: 0.850 Test Loss: 0.908 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.9628095626831055
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.482 Vali Acc: 0.850 Test Loss: 1.482 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.951310157775879
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.938 Vali Acc: 0.867 Test Loss: 0.938 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.091344118118286
Epoch: 33, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.700 Vali Acc: 0.733 Test Loss: 1.700 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.021508455276489
Epoch: 34, Steps: 12 | Train Loss: 0.262 Vali Loss: 1.350 Vali Acc: 0.828 Test Loss: 1.350 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.126922369003296
Epoch: 35, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.271 Vali Acc: 0.783 Test Loss: 1.271 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.8934998512268066
Epoch: 36, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.412 Vali Acc: 0.828 Test Loss: 1.412 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.765840291976929
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.578 Vali Acc: 0.311 Test Loss: 1.578 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 3.9746956825256348
Epoch: 2, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.255 Vali Acc: 0.517 Test Loss: 1.255 Test Acc: 0.517
Validation loss decreased (-0.311095 --> -0.516654).  Saving model ...
Epoch: 3 cost time: 4.246058702468872
Epoch: 3, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.974 Vali Acc: 0.556 Test Loss: 0.974 Test Acc: 0.556
Validation loss decreased (-0.516654 --> -0.555546).  Saving model ...
Epoch: 4 cost time: 4.108016729354858
Epoch: 4, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.555546 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 4.188889026641846
Epoch: 5, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.848 Vali Acc: 0.633 Test Loss: 0.848 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.289583921432495
Epoch: 6, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.492 Vali Acc: 0.772 Test Loss: 0.492 Test Acc: 0.772
Validation loss decreased (-0.677770 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 4.050248384475708
Epoch: 7, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.292276382446289
Epoch: 8, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.548 Vali Acc: 0.794 Test Loss: 0.548 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 4.169150352478027
Epoch: 9, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.477 Vali Acc: 0.817 Test Loss: 0.477 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 3.7687020301818848
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7802178859710693
Epoch: 11, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.754385471343994
Epoch: 12, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8281524181365967
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.000841856002808
Epoch: 14, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.040 Vali Acc: 0.817 Test Loss: 1.040 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.033191919326782
Epoch: 15, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 3.888591766357422
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 3.956364393234253
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
Validation loss decreased (-0.833328 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 4.130475282669067
Epoch: 18, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.416 Vali Acc: 0.806 Test Loss: 1.416 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8837575912475586
Epoch: 19, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 3.925121784210205
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9286978244781494
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.908 Vali Acc: 0.856 Test Loss: 0.908 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9122073650360107
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.933 Vali Acc: 0.861 Test Loss: 0.933 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.760178804397583
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.810 Vali Acc: 0.817 Test Loss: 1.810 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.712930202484131
Epoch: 24, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.259 Vali Acc: 0.856 Test Loss: 1.259 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.331470489501953
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.840 Vali Acc: 0.878 Test Loss: 0.840 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877769).  Saving model ...
Epoch: 26 cost time: 4.221250772476196
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.972 Vali Acc: 0.850 Test Loss: 0.972 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.040383577346802
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.835 Vali Acc: 0.883 Test Loss: 0.835 Test Acc: 0.883
Validation loss decreased (-0.877769 --> -0.883325).  Saving model ...
Epoch: 28 cost time: 3.9127767086029053
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.861 Vali Acc: 0.878 Test Loss: 0.861 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.134413719177246
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.615 Vali Acc: 0.861 Test Loss: 1.615 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.20854115486145
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.310 Vali Acc: 0.833 Test Loss: 1.310 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.8940017223358154
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.037 Vali Acc: 0.839 Test Loss: 1.037 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.5048930644989014
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.321 Vali Acc: 0.850 Test Loss: 1.321 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.7627649307250977
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.521 Vali Acc: 0.861 Test Loss: 1.521 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.8756349086761475
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.243 Vali Acc: 0.839 Test Loss: 1.243 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.5086159706115723
Epoch: 35, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.312 Vali Acc: 0.833 Test Loss: 1.312 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.0313615798950195
Epoch: 36, Steps: 12 | Train Loss: 0.347 Vali Loss: 1.082 Vali Acc: 0.833 Test Loss: 1.082 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.117170333862305
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.345 Vali Acc: 0.856 Test Loss: 1.345 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.307201147079468
Epoch: 1, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.663 Vali Acc: 0.328 Test Loss: 1.663 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 4.03956413269043
Epoch: 2, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.109 Vali Acc: 0.633 Test Loss: 1.109 Test Acc: 0.633
Validation loss decreased (-0.327761 --> -0.633322).  Saving model ...
Epoch: 3 cost time: 4.072193622589111
Epoch: 3, Steps: 12 | Train Loss: 1.068 Vali Loss: 0.740 Vali Acc: 0.639 Test Loss: 0.740 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638881).  Saving model ...
Epoch: 4 cost time: 3.9611668586730957
Epoch: 4, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.701 Vali Acc: 0.706 Test Loss: 0.701 Test Acc: 0.706
Validation loss decreased (-0.638881 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 4.021009683609009
Epoch: 5, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.878 Vali Acc: 0.683 Test Loss: 0.878 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.156222105026245
Epoch: 6, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
Validation loss decreased (-0.705549 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 4.19824743270874
Epoch: 7, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.949298620223999
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.464 Vali Acc: 0.800 Test Loss: 0.464 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.39719295501709
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.587 Vali Acc: 0.794 Test Loss: 0.587 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.583396911621094
Epoch: 10, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.1356658935546875
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.543 Vali Acc: 0.806 Test Loss: 0.543 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.157817125320435
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.802 Vali Acc: 0.828 Test Loss: 0.802 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827770).  Saving model ...
Epoch: 13 cost time: 3.917076826095581
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6685259342193604
Epoch: 14, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.805 Vali Acc: 0.856 Test Loss: 0.805 Test Acc: 0.856
Validation loss decreased (-0.827770 --> -0.855548).  Saving model ...
Epoch: 15 cost time: 3.8681766986846924
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.899628162384033
Epoch: 16, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.897 Vali Acc: 0.822 Test Loss: 1.897 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.126453161239624
Epoch: 17, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.704 Vali Acc: 0.878 Test Loss: 0.704 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877771).  Saving model ...
Epoch: 18 cost time: 3.870619297027588
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.070 Vali Acc: 0.833 Test Loss: 1.070 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.184594631195068
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.069 Vali Acc: 0.844 Test Loss: 1.069 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.936156749725342
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.308 Vali Acc: 0.883 Test Loss: 1.308 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883320).  Saving model ...
Epoch: 21 cost time: 3.8843281269073486
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.895 Vali Acc: 0.861 Test Loss: 0.895 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9439923763275146
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.278 Vali Acc: 0.894 Test Loss: 1.278 Test Acc: 0.894
Validation loss decreased (-0.883320 --> -0.894432).  Saving model ...
Epoch: 23 cost time: 3.9932188987731934
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.138 Vali Acc: 0.856 Test Loss: 1.138 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.740535020828247
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.783 Vali Acc: 0.889 Test Loss: 0.783 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.895580768585205
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.647 Vali Acc: 0.906 Test Loss: 0.647 Test Acc: 0.906
Validation loss decreased (-0.894432 --> -0.905549).  Saving model ...
Epoch: 26 cost time: 3.8870925903320312
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.487 Vali Acc: 0.922 Test Loss: 0.487 Test Acc: 0.922
Validation loss decreased (-0.905549 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 3.854182243347168
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.925 Vali Acc: 0.883 Test Loss: 0.925 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.088050603866577
Epoch: 28, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.251 Vali Acc: 0.850 Test Loss: 1.251 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8781912326812744
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.476 Vali Acc: 0.839 Test Loss: 1.476 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.008689880371094
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.963 Vali Acc: 0.872 Test Loss: 0.963 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.015913248062134
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.953 Vali Acc: 0.850 Test Loss: 1.953 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.788573741912842
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.822 Vali Acc: 0.861 Test Loss: 0.822 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9246134757995605
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.8494510650634766
Epoch: 34, Steps: 12 | Train Loss: 0.455 Vali Loss: 1.786 Vali Acc: 0.861 Test Loss: 1.786 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.657555103302002
Epoch: 35, Steps: 12 | Train Loss: 0.384 Vali Loss: 2.059 Vali Acc: 0.822 Test Loss: 2.059 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.8494510650634766
Epoch: 36, Steps: 12 | Train Loss: 0.486 Vali Loss: 1.329 Vali Acc: 0.833 Test Loss: 1.329 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.46858024597168
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.625 Vali Acc: 0.344 Test Loss: 1.625 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 3.7283637523651123
Epoch: 2, Steps: 12 | Train Loss: 1.598 Vali Loss: 0.991 Vali Acc: 0.611 Test Loss: 0.991 Test Acc: 0.611
Validation loss decreased (-0.344428 --> -0.611101).  Saving model ...
Epoch: 3 cost time: 3.666938304901123
Epoch: 3, Steps: 12 | Train Loss: 1.096 Vali Loss: 0.730 Vali Acc: 0.683 Test Loss: 0.730 Test Acc: 0.683
Validation loss decreased (-0.611101 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 3.8796117305755615
Epoch: 4, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
Validation loss decreased (-0.683326 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 3.8161158561706543
Epoch: 5, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.692 Vali Acc: 0.700 Test Loss: 0.692 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.715925931930542
Epoch: 6, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.481 Vali Acc: 0.789 Test Loss: 0.481 Test Acc: 0.789
Validation loss decreased (-0.722216 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 3.930629253387451
Epoch: 7, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.670 Vali Acc: 0.794 Test Loss: 0.670 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794438).  Saving model ...
Epoch: 8 cost time: 4.163120746612549
Epoch: 8, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9094419479370117
Epoch: 9, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.897274971008301
Epoch: 10, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.031 Vali Acc: 0.822 Test Loss: 1.031 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822212).  Saving model ...
Epoch: 11 cost time: 3.9516236782073975
Epoch: 11, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
Validation loss decreased (-0.822212 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 4.0196003913879395
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.855 Vali Acc: 0.844 Test Loss: 0.855 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.095475196838379
Epoch: 13, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.790980339050293
Epoch: 14, Steps: 12 | Train Loss: 0.224 Vali Loss: 1.170 Vali Acc: 0.856 Test Loss: 1.170 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855544).  Saving model ...
Epoch: 15 cost time: 3.7988123893737793
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.655 Vali Acc: 0.889 Test Loss: 0.655 Test Acc: 0.889
Validation loss decreased (-0.855544 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 3.6905906200408936
Epoch: 16, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.939 Vali Acc: 0.883 Test Loss: 0.939 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.849794864654541
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.001 Vali Acc: 0.878 Test Loss: 1.001 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7401769161224365
Epoch: 18, Steps: 12 | Train Loss: 0.199 Vali Loss: 2.217 Vali Acc: 0.856 Test Loss: 2.217 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9766271114349365
Epoch: 19, Steps: 12 | Train Loss: 0.349 Vali Loss: 1.153 Vali Acc: 0.844 Test Loss: 1.153 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.202029466629028
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 4.231709718704224
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.819 Vali Acc: 0.906 Test Loss: 0.819 Test Acc: 0.906
Validation loss decreased (-0.899994 --> -0.905547).  Saving model ...
Epoch: 22 cost time: 4.3213160037994385
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.935 Vali Acc: 0.911 Test Loss: 0.935 Test Acc: 0.911
Validation loss decreased (-0.905547 --> -0.911102).  Saving model ...
Epoch: 23 cost time: 4.387268781661987
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.972 Vali Acc: 0.906 Test Loss: 0.972 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.338847398757935
Epoch: 24, Steps: 12 | Train Loss: 0.335 Vali Loss: 1.272 Vali Acc: 0.844 Test Loss: 1.272 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.128480672836304
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.238 Vali Acc: 0.867 Test Loss: 1.238 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.067798852920532
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.928 Vali Acc: 0.856 Test Loss: 0.928 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.162206649780273
Epoch: 27, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.521 Vali Acc: 0.928 Test Loss: 0.521 Test Acc: 0.928
Validation loss decreased (-0.911102 --> -0.927773).  Saving model ...
Epoch: 28 cost time: 4.015660285949707
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.409 Vali Acc: 0.844 Test Loss: 1.409 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.0038769245147705
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.545 Vali Acc: 0.861 Test Loss: 1.545 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9591143131256104
Epoch: 30, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.964 Vali Acc: 0.822 Test Loss: 0.964 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.150988817214966
Epoch: 31, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.995 Vali Acc: 0.800 Test Loss: 0.995 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.159387826919556
Epoch: 32, Steps: 12 | Train Loss: 0.423 Vali Loss: 2.008 Vali Acc: 0.789 Test Loss: 2.008 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.727987766265869
Epoch: 33, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.822 Vali Acc: 0.889 Test Loss: 0.822 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.8361470699310303
Epoch: 34, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.342 Vali Acc: 0.856 Test Loss: 1.342 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.8258039951324463
Epoch: 35, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.103 Vali Acc: 0.850 Test Loss: 1.103 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.8147635459899902
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.745 Vali Acc: 0.883 Test Loss: 0.745 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.914470672607422
Epoch: 37, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.942 Vali Acc: 0.850 Test Loss: 0.942 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.43772292137146
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.607 Vali Acc: 0.333 Test Loss: 1.607 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 4.292273283004761
Epoch: 2, Steps: 12 | Train Loss: 1.631 Vali Loss: 0.969 Vali Acc: 0.606 Test Loss: 0.969 Test Acc: 0.606
Validation loss decreased (-0.333317 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 4.266448736190796
Epoch: 3, Steps: 12 | Train Loss: 1.139 Vali Loss: 0.751 Vali Acc: 0.656 Test Loss: 0.751 Test Acc: 0.656
Validation loss decreased (-0.605546 --> -0.655548).  Saving model ...
Epoch: 4 cost time: 4.197430610656738
Epoch: 4, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.702 Vali Acc: 0.722 Test Loss: 0.702 Test Acc: 0.722
Validation loss decreased (-0.655548 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 3.859560966491699
Epoch: 5, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.825 Vali Acc: 0.700 Test Loss: 0.825 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0256876945495605
Epoch: 6, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.577 Vali Acc: 0.778 Test Loss: 0.577 Test Acc: 0.778
Validation loss decreased (-0.722215 --> -0.777772).  Saving model ...
Epoch: 7 cost time: 3.9777674674987793
Epoch: 7, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.677 Vali Acc: 0.778 Test Loss: 0.677 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8550236225128174
Epoch: 8, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 4.226142168045044
Epoch: 9, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.629 Vali Acc: 0.817 Test Loss: 0.629 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816660).  Saving model ...
Epoch: 10 cost time: 3.907287120819092
Epoch: 10, Steps: 12 | Train Loss: 0.245 Vali Loss: 1.129 Vali Acc: 0.811 Test Loss: 1.129 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.042895078659058
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.529 Vali Acc: 0.811 Test Loss: 0.529 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.551632881164551
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 4.143084526062012
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 1.169 Vali Acc: 0.811 Test Loss: 1.169 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.3244712352752686
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
Validation loss decreased (-0.822215 --> -0.855548).  Saving model ...
Epoch: 15 cost time: 4.513847589492798
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.603 Vali Acc: 0.878 Test Loss: 0.603 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 4.029183626174927
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.125 Vali Acc: 0.844 Test Loss: 1.125 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.139750003814697
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.542 Vali Acc: 0.911 Test Loss: 0.542 Test Acc: 0.911
Validation loss decreased (-0.877772 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 4.216352224349976
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.383 Vali Acc: 0.883 Test Loss: 1.383 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.130162477493286
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.008 Vali Acc: 0.883 Test Loss: 1.008 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.273622751235962
Epoch: 20, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.999 Vali Acc: 0.867 Test Loss: 0.999 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.091968536376953
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.860 Vali Acc: 0.872 Test Loss: 0.860 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.230186939239502
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.164 Vali Acc: 0.872 Test Loss: 1.164 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.175428628921509
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.706 Vali Acc: 0.911 Test Loss: 0.706 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.186889410018921
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.717 Vali Acc: 0.761 Test Loss: 1.717 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9800567626953125
Epoch: 25, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.120 Vali Acc: 0.867 Test Loss: 1.120 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.981247663497925
Epoch: 26, Steps: 12 | Train Loss: 0.359 Vali Loss: 2.380 Vali Acc: 0.806 Test Loss: 2.380 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.8797569274902344
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.410 Vali Acc: 0.833 Test Loss: 1.410 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.673684597015381
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 4.199482679367065
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.024960994720459
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.2026026248931885
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9360854625701904
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.021846771240234
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.782985210418701
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.022206783294678
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 4.26963996887207
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9492766857147217
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.160914897918701
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9268157482147217
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.67138671875
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9578490257263184
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8704659938812256
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6597397327423096
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.8063480854034424
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8118484020233154
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 13915654
model size : 72.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.7834813594818115
Epoch: 1, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.460 Vali Acc: 0.433 Test Loss: 1.460 Test Acc: 0.433
Validation loss decreased (inf --> -0.433319).  Saving model ...
Epoch: 2 cost time: 3.9343321323394775
Epoch: 2, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.113 Vali Acc: 0.578 Test Loss: 1.113 Test Acc: 0.578
Validation loss decreased (-0.433319 --> -0.577767).  Saving model ...
Epoch: 3 cost time: 4.06611442565918
Epoch: 3, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.755 Vali Acc: 0.678 Test Loss: 0.755 Test Acc: 0.678
Validation loss decreased (-0.577767 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 4.2836878299713135
Epoch: 4, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.618 Vali Acc: 0.711 Test Loss: 0.618 Test Acc: 0.711
Validation loss decreased (-0.677770 --> -0.711105).  Saving model ...
Epoch: 5 cost time: 3.987548828125
Epoch: 5, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.478 Vali Acc: 0.761 Test Loss: 0.478 Test Acc: 0.761
Validation loss decreased (-0.711105 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 4.227287769317627
Epoch: 6, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
Validation loss decreased (-0.761106 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 4.057852506637573
Epoch: 7, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.221135377883911
Epoch: 8, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.387 Vali Acc: 0.806 Test Loss: 0.387 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7395732402801514
Epoch: 9, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.433 Vali Acc: 0.856 Test Loss: 0.433 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 4.149987459182739
Epoch: 10, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.244845867156982
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.2581048011779785
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.144663333892822
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.015192985534668
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 4.6593358516693115
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.10878849029541
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911107).  Saving model ...
Epoch: 17 cost time: 4.424386739730835
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.948552131652832
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 3.845903158187866
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.167308330535889
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9336397647857666
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.587200164794922
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.906 Vali Acc: 0.883 Test Loss: 0.906 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.055842399597168
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 4.586618185043335
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.036253929138184
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.911 Test Loss: 0.508 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.131693124771118
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.145936012268066
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.616374969482422
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.906 Test Loss: 0.476 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.183438777923584
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.917 Test Loss: 0.444 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 30 cost time: 3.9070589542388916
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.917 Test Loss: 0.437 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 31 cost time: 4.218235492706299
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.911 Test Loss: 0.443 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.120030879974365
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.911 Test Loss: 0.439 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.187859296798706
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.917 Test Loss: 0.432 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 34 cost time: 4.030153512954712
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.067987442016602
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.911 Test Loss: 0.457 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.9032480716705322
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.101818799972534
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.0428712368011475
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.03718900680542
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.911 Test Loss: 0.466 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.039048433303833
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.065711259841919
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.097374200820923
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.911 Test Loss: 0.456 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.994638442993164
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.911 Test Loss: 0.462 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.8598878383636475
Epoch: 1, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.572 Vali Acc: 0.394 Test Loss: 1.572 Test Acc: 0.394
Validation loss decreased (inf --> -0.394429).  Saving model ...
Epoch: 2 cost time: 4.016526937484741
Epoch: 2, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.203 Vali Acc: 0.522 Test Loss: 1.203 Test Acc: 0.522
Validation loss decreased (-0.394429 --> -0.522210).  Saving model ...
Epoch: 3 cost time: 4.148175954818726
Epoch: 3, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.848 Vali Acc: 0.656 Test Loss: 0.848 Test Acc: 0.656
Validation loss decreased (-0.522210 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 3.8233096599578857
Epoch: 4, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.693 Vali Acc: 0.700 Test Loss: 0.693 Test Acc: 0.700
Validation loss decreased (-0.655547 --> -0.699993).  Saving model ...
Epoch: 5 cost time: 4.230749130249023
Epoch: 5, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.531 Vali Acc: 0.744 Test Loss: 0.531 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 4.308642148971558
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
Validation loss decreased (-0.744439 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 4.574098587036133
Epoch: 7, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.462 Vali Acc: 0.789 Test Loss: 0.462 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.095841407775879
Epoch: 8, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.215611219406128
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.3486411571502686
Epoch: 10, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.415 Vali Acc: 0.828 Test Loss: 0.415 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 4.207879066467285
Epoch: 11, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.124245643615723
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 4.157005786895752
Epoch: 13, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.189170837402344
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 4.403044939041138
Epoch: 15, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877773).  Saving model ...
Epoch: 16 cost time: 4.07545280456543
Epoch: 16, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.340885162353516
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8299779891967773
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9626269340515137
Epoch: 19, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.018475770950317
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 3.874965190887451
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 22 cost time: 3.6620826721191406
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.871 Vali Acc: 0.872 Test Loss: 0.871 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7367026805877686
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894440).  Saving model ...
Epoch: 24 cost time: 3.9330103397369385
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.865 Vali Acc: 0.861 Test Loss: 0.865 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8129994869232178
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.595 Vali Acc: 0.883 Test Loss: 0.595 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.680635929107666
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.676 Vali Acc: 0.889 Test Loss: 0.676 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.6049485206604004
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.758 Vali Acc: 0.861 Test Loss: 0.758 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.806166887283325
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.768 Vali Acc: 0.856 Test Loss: 0.768 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.5194735527038574
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.577334403991699
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 3.6151304244995117
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.657 Vali Acc: 0.894 Test Loss: 0.657 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3974008560180664
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.996 Vali Acc: 0.733 Test Loss: 1.996 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.855861186981201
Epoch: 33, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.092 Vali Acc: 0.844 Test Loss: 1.092 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.866732358932495
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.794 Vali Acc: 0.889 Test Loss: 0.794 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.8712003231048584
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.678 Vali Acc: 0.883 Test Loss: 0.678 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.8604753017425537
Epoch: 36, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.712 Vali Acc: 0.839 Test Loss: 0.712 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.7987215518951416
Epoch: 37, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.202 Vali Acc: 0.839 Test Loss: 1.202 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.9704079627990723
Epoch: 38, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.347 Vali Acc: 0.822 Test Loss: 1.347 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.8648009300231934
Epoch: 39, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.710 Vali Acc: 0.872 Test Loss: 0.710 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.7691874504089355
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.848 Vali Acc: 0.856 Test Loss: 0.848 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.152436971664429
Epoch: 1, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.642 Vali Acc: 0.350 Test Loss: 1.642 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 3.971705198287964
Epoch: 2, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.294 Vali Acc: 0.428 Test Loss: 1.294 Test Acc: 0.428
Validation loss decreased (-0.349984 --> -0.427765).  Saving model ...
Epoch: 3 cost time: 3.740272283554077
Epoch: 3, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.007 Vali Acc: 0.517 Test Loss: 1.007 Test Acc: 0.517
Validation loss decreased (-0.427765 --> -0.516657).  Saving model ...
Epoch: 4 cost time: 3.7666375637054443
Epoch: 4, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.839 Vali Acc: 0.672 Test Loss: 0.839 Test Acc: 0.672
Validation loss decreased (-0.516657 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 3.6790378093719482
Epoch: 5, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.685 Vali Acc: 0.694 Test Loss: 0.685 Test Acc: 0.694
Validation loss decreased (-0.672214 --> -0.694438).  Saving model ...
Epoch: 6 cost time: 3.749006509780884
Epoch: 6, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.553 Vali Acc: 0.744 Test Loss: 0.553 Test Acc: 0.744
Validation loss decreased (-0.694438 --> -0.744439).  Saving model ...
Epoch: 7 cost time: 3.7882936000823975
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.554 Vali Acc: 0.767 Test Loss: 0.554 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 3.684877395629883
Epoch: 8, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 3.9050869941711426
Epoch: 9, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.974 Vali Acc: 0.783 Test Loss: 0.974 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8351614475250244
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 11 cost time: 4.0488598346710205
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.016501188278198
Epoch: 12, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.637 Vali Acc: 0.778 Test Loss: 0.637 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8496651649475098
Epoch: 13, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.590 Vali Acc: 0.817 Test Loss: 0.590 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 14 cost time: 3.771238327026367
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8814244270324707
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.828 Vali Acc: 0.817 Test Loss: 0.828 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.131098985671997
Epoch: 16, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 3.82216215133667
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.582 Vali Acc: 0.839 Test Loss: 0.582 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 3.8936798572540283
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 3.8279783725738525
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883328).  Saving model ...
Epoch: 20 cost time: 4.134983062744141
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.947 Vali Acc: 0.822 Test Loss: 0.947 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9207632541656494
Epoch: 21, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8828580379486084
Epoch: 22, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.670705795288086
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.020 Vali Acc: 0.867 Test Loss: 1.020 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.083461046218872
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.362 Vali Acc: 0.817 Test Loss: 1.362 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7840750217437744
Epoch: 25, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.8059544563293457
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.140 Vali Acc: 0.850 Test Loss: 1.140 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.9798038005828857
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.114 Vali Acc: 0.856 Test Loss: 1.114 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.703326940536499
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.021 Vali Acc: 0.844 Test Loss: 1.021 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.8665883541107178
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.942 Vali Acc: 0.844 Test Loss: 0.942 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.507061958312988
Epoch: 1, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.672 Vali Acc: 0.278 Test Loss: 1.672 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 4.002231121063232
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.338 Vali Acc: 0.433 Test Loss: 1.338 Test Acc: 0.433
Validation loss decreased (-0.277761 --> -0.433320).  Saving model ...
Epoch: 3 cost time: 4.14223837852478
Epoch: 3, Steps: 12 | Train Loss: 1.008 Vali Loss: 0.955 Vali Acc: 0.528 Test Loss: 0.955 Test Acc: 0.528
Validation loss decreased (-0.433320 --> -0.527768).  Saving model ...
Epoch: 4 cost time: 3.874901533126831
Epoch: 4, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.899 Vali Acc: 0.617 Test Loss: 0.899 Test Acc: 0.617
Validation loss decreased (-0.527768 --> -0.616658).  Saving model ...
Epoch: 5 cost time: 3.894221782684326
Epoch: 5, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.733 Vali Acc: 0.656 Test Loss: 0.733 Test Acc: 0.656
Validation loss decreased (-0.616658 --> -0.655548).  Saving model ...
Epoch: 6 cost time: 4.07841944694519
Epoch: 6, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (-0.655548 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 4.27022385597229
Epoch: 7, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.571 Vali Acc: 0.767 Test Loss: 0.571 Test Acc: 0.767
Validation loss decreased (-0.722216 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 4.2442851066589355
Epoch: 8, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.561 Vali Acc: 0.772 Test Loss: 0.561 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 3.998398542404175
Epoch: 9, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.449 Vali Acc: 0.811 Test Loss: 0.449 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 3.8563997745513916
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.729 Vali Acc: 0.767 Test Loss: 0.729 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.315059423446655
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.811 Vali Acc: 0.794 Test Loss: 0.811 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.216593265533447
Epoch: 12, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 3.8652451038360596
Epoch: 13, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.869 Vali Acc: 0.811 Test Loss: 0.869 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.626448392868042
Epoch: 14, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.710 Vali Acc: 0.822 Test Loss: 0.710 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9346585273742676
Epoch: 15, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.021 Vali Acc: 0.800 Test Loss: 1.021 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9238929748535156
Epoch: 16, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861106).  Saving model ...
Epoch: 17 cost time: 3.8275439739227295
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.94047212600708
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.724 Vali Acc: 0.872 Test Loss: 0.724 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872215).  Saving model ...
Epoch: 19 cost time: 3.7790191173553467
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.751 Vali Acc: 0.861 Test Loss: 0.751 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9704535007476807
Epoch: 20, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.053 Vali Acc: 0.856 Test Loss: 1.053 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9567220211029053
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.134 Vali Acc: 0.844 Test Loss: 1.134 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.097736835479736
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.989 Vali Acc: 0.861 Test Loss: 0.989 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.268099784851074
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.564 Vali Acc: 0.806 Test Loss: 1.564 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9038150310516357
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.721 Vali Acc: 0.883 Test Loss: 0.721 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883326).  Saving model ...
Epoch: 25 cost time: 3.9605817794799805
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.710 Vali Acc: 0.878 Test Loss: 0.710 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.2159528732299805
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8691182136535645
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.611 Vali Acc: 0.911 Test Loss: 0.611 Test Acc: 0.911
Validation loss decreased (-0.883326 --> -0.911105).  Saving model ...
Epoch: 28 cost time: 4.109968900680542
Epoch: 28, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.732 Vali Acc: 0.872 Test Loss: 0.732 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.9082605838775635
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.148 Vali Acc: 0.839 Test Loss: 1.148 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.22555136680603
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.140 Vali Acc: 0.889 Test Loss: 1.140 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.9878432750701904
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.850 Vali Acc: 0.900 Test Loss: 0.850 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.216485023498535
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.080 Vali Acc: 0.894 Test Loss: 1.080 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.8487260341644287
Epoch: 33, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.212 Vali Acc: 0.872 Test Loss: 1.212 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.6099979877471924
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.218 Vali Acc: 0.861 Test Loss: 1.218 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.9384796619415283
Epoch: 35, Steps: 12 | Train Loss: 0.060 Vali Loss: 2.728 Vali Acc: 0.844 Test Loss: 2.728 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.7747700214385986
Epoch: 36, Steps: 12 | Train Loss: 0.364 Vali Loss: 1.425 Vali Acc: 0.850 Test Loss: 1.425 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.801600933074951
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.981 Vali Acc: 0.800 Test Loss: 1.981 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.647741079330444
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.696 Vali Acc: 0.272 Test Loss: 1.696 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 3.880890369415283
Epoch: 2, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.151 Vali Acc: 0.567 Test Loss: 1.151 Test Acc: 0.567
Validation loss decreased (-0.272205 --> -0.566655).  Saving model ...
Epoch: 3 cost time: 4.022867202758789
Epoch: 3, Steps: 12 | Train Loss: 1.028 Vali Loss: 0.747 Vali Acc: 0.633 Test Loss: 0.747 Test Acc: 0.633
Validation loss decreased (-0.566655 --> -0.633326).  Saving model ...
Epoch: 4 cost time: 3.9406661987304688
Epoch: 4, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.924 Vali Acc: 0.633 Test Loss: 0.924 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9544456005096436
Epoch: 5, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.748 Vali Acc: 0.694 Test Loss: 0.748 Test Acc: 0.694
Validation loss decreased (-0.633326 --> -0.694437).  Saving model ...
Epoch: 6 cost time: 3.861213207244873
Epoch: 6, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.694437 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 3.9290339946746826
Epoch: 7, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5835132598876953
Epoch: 8, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 3.761500835418701
Epoch: 9, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.633 Vali Acc: 0.772 Test Loss: 0.633 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.198642015457153
Epoch: 10, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.587 Vali Acc: 0.794 Test Loss: 0.587 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 4.137948751449585
Epoch: 11, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.872 Vali Acc: 0.822 Test Loss: 0.872 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 3.8494527339935303
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
Validation loss decreased (-0.822213 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 4.000118732452393
Epoch: 13, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.074467897415161
Epoch: 14, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.110 Vali Acc: 0.822 Test Loss: 1.110 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8740923404693604
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.316 Vali Acc: 0.811 Test Loss: 1.316 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8474843502044678
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.941 Vali Acc: 0.828 Test Loss: 0.941 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8689775466918945
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.422 Vali Acc: 0.806 Test Loss: 1.422 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7819533348083496
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.797 Vali Acc: 0.833 Test Loss: 0.797 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 3.7018227577209473
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.251 Vali Acc: 0.833 Test Loss: 1.251 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.625918388366699
Epoch: 20, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.147 Vali Acc: 0.861 Test Loss: 1.147 Test Acc: 0.861
Validation loss decreased (-0.833325 --> -0.861100).  Saving model ...
Epoch: 21 cost time: 3.6607346534729004
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.655 Vali Acc: 0.867 Test Loss: 1.655 Test Acc: 0.867
Validation loss decreased (-0.861100 --> -0.866650).  Saving model ...
Epoch: 22 cost time: 3.634209156036377
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.074 Vali Acc: 0.878 Test Loss: 1.074 Test Acc: 0.878
Validation loss decreased (-0.866650 --> -0.877767).  Saving model ...
Epoch: 23 cost time: 3.7006289958953857
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.049 Vali Acc: 0.878 Test Loss: 1.049 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877767).  Saving model ...
Epoch: 24 cost time: 3.9173977375030518
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.751 Vali Acc: 0.833 Test Loss: 1.751 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.326132774353027
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.346 Vali Acc: 0.844 Test Loss: 1.346 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8677592277526855
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.213 Vali Acc: 0.850 Test Loss: 1.213 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.756833076477051
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.811 Vali Acc: 0.878 Test Loss: 0.811 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877770).  Saving model ...
Epoch: 28 cost time: 4.114488363265991
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.336 Vali Acc: 0.844 Test Loss: 1.336 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.830047130584717
Epoch: 29, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.918 Vali Acc: 0.883 Test Loss: 0.918 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883324).  Saving model ...
Epoch: 30 cost time: 3.7745401859283447
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.168 Vali Acc: 0.894 Test Loss: 1.168 Test Acc: 0.894
Validation loss decreased (-0.883324 --> -0.894433).  Saving model ...
Epoch: 31 cost time: 3.584881544113159
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.542 Vali Acc: 0.933 Test Loss: 0.542 Test Acc: 0.933
Validation loss decreased (-0.894433 --> -0.933328).  Saving model ...
Epoch: 32 cost time: 3.847917318344116
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.917 Test Loss: 0.583 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.7370409965515137
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.971 Vali Acc: 0.894 Test Loss: 0.971 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.287908315658569
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.046 Vali Acc: 0.911 Test Loss: 1.046 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.950930118560791
Epoch: 35, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.993 Vali Acc: 0.906 Test Loss: 0.993 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.7079710960388184
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 2.082 Vali Acc: 0.861 Test Loss: 2.082 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.8350489139556885
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.936 Vali Acc: 0.861 Test Loss: 1.936 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.0769898891448975
Epoch: 38, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.999 Vali Acc: 0.856 Test Loss: 1.999 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.8992562294006348
Epoch: 39, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.671 Vali Acc: 0.850 Test Loss: 1.671 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.901149272918701
Epoch: 40, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.065 Vali Acc: 0.850 Test Loss: 1.065 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.70343017578125
Epoch: 41, Steps: 12 | Train Loss: 0.154 Vali Loss: 2.001 Vali Acc: 0.817 Test Loss: 2.001 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.205688714981079
Epoch: 1, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.594 Vali Acc: 0.361 Test Loss: 1.594 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 3.92014479637146
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 0.919 Vali Acc: 0.633 Test Loss: 0.919 Test Acc: 0.633
Validation loss decreased (-0.361095 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 3.87402081489563
Epoch: 3, Steps: 12 | Train Loss: 1.074 Vali Loss: 0.778 Vali Acc: 0.656 Test Loss: 0.778 Test Acc: 0.656
Validation loss decreased (-0.633324 --> -0.655548).  Saving model ...
Epoch: 4 cost time: 3.92801833152771
Epoch: 4, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.030 Vali Acc: 0.639 Test Loss: 1.030 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9773311614990234
Epoch: 5, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.739 Vali Acc: 0.733 Test Loss: 0.739 Test Acc: 0.733
Validation loss decreased (-0.655548 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 3.872072219848633
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.617 Vali Acc: 0.767 Test Loss: 0.617 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 3.850228786468506
Epoch: 7, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.540 Vali Acc: 0.772 Test Loss: 0.540 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 3.948355197906494
Epoch: 8, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 3.5950803756713867
Epoch: 9, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.847 Vali Acc: 0.778 Test Loss: 0.847 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8691937923431396
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.565 Vali Acc: 0.794 Test Loss: 0.565 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.855745553970337
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 1.135 Vali Acc: 0.828 Test Loss: 1.135 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827766).  Saving model ...
Epoch: 12 cost time: 3.889758825302124
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
Validation loss decreased (-0.827766 --> -0.844439).  Saving model ...
Epoch: 13 cost time: 3.663213014602661
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.728 Vali Acc: 0.828 Test Loss: 0.728 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8549602031707764
Epoch: 14, Steps: 12 | Train Loss: 0.229 Vali Loss: 1.019 Vali Acc: 0.828 Test Loss: 1.019 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.029929161071777
Epoch: 15, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.89443039894104
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.010 Vali Acc: 0.822 Test Loss: 1.010 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.1893322467803955
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.947 Vali Acc: 0.856 Test Loss: 0.947 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855546).  Saving model ...
Epoch: 18 cost time: 4.1148834228515625
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.825 Vali Acc: 0.844 Test Loss: 0.825 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.0880372524261475
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.662 Vali Acc: 0.889 Test Loss: 0.662 Test Acc: 0.889
Validation loss decreased (-0.855546 --> -0.888882).  Saving model ...
Epoch: 20 cost time: 4.43933892250061
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.813 Vali Acc: 0.922 Test Loss: 0.813 Test Acc: 0.922
Validation loss decreased (-0.888882 --> -0.922214).  Saving model ...
Epoch: 21 cost time: 4.501699686050415
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.138 Vali Acc: 0.889 Test Loss: 1.138 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.226605653762817
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.188 Vali Acc: 0.906 Test Loss: 1.188 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.342601299285889
Epoch: 23, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.728 Vali Acc: 0.917 Test Loss: 0.728 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.56408953666687
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.524 Vali Acc: 0.856 Test Loss: 1.524 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.158895492553711
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.977 Vali Acc: 0.894 Test Loss: 0.977 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.205299139022827
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.444 Vali Acc: 0.833 Test Loss: 1.444 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.9655349254608154
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.042 Vali Acc: 0.889 Test Loss: 1.042 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.0423619747161865
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.347 Vali Acc: 0.872 Test Loss: 1.347 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.113433599472046
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 2.005 Vali Acc: 0.844 Test Loss: 2.005 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.931936502456665
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.861 Vali Acc: 0.894 Test Loss: 0.861 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.167283535003662
Epoch: 1, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.597 Vali Acc: 0.389 Test Loss: 1.597 Test Acc: 0.389
Validation loss decreased (inf --> -0.388873).  Saving model ...
Epoch: 2 cost time: 3.718001365661621
Epoch: 2, Steps: 12 | Train Loss: 1.650 Vali Loss: 0.935 Vali Acc: 0.589 Test Loss: 0.935 Test Acc: 0.589
Validation loss decreased (-0.388873 --> -0.588880).  Saving model ...
Epoch: 3 cost time: 3.656587600708008
Epoch: 3, Steps: 12 | Train Loss: 1.068 Vali Loss: 0.791 Vali Acc: 0.606 Test Loss: 0.791 Test Acc: 0.606
Validation loss decreased (-0.588880 --> -0.605548).  Saving model ...
Epoch: 4 cost time: 3.580167055130005
Epoch: 4, Steps: 12 | Train Loss: 0.588 Vali Loss: 1.070 Vali Acc: 0.633 Test Loss: 1.070 Test Acc: 0.633
Validation loss decreased (-0.605548 --> -0.633323).  Saving model ...
Epoch: 5 cost time: 3.7054858207702637
Epoch: 5, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.791 Vali Acc: 0.711 Test Loss: 0.791 Test Acc: 0.711
Validation loss decreased (-0.633323 --> -0.711103).  Saving model ...
Epoch: 6 cost time: 3.5154569149017334
Epoch: 6, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 3.7034757137298584
Epoch: 7, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 3.8123629093170166
Epoch: 8, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.772217 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 3.827779531478882
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.730 Vali Acc: 0.794 Test Loss: 0.730 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.74251651763916
Epoch: 10, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.596 Vali Acc: 0.794 Test Loss: 0.596 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.547192096710205
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.957 Vali Acc: 0.822 Test Loss: 0.957 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.7050130367279053
Epoch: 12, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 3.7745871543884277
Epoch: 13, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6090939044952393
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.881 Vali Acc: 0.828 Test Loss: 0.881 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5940470695495605
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.783 Vali Acc: 0.822 Test Loss: 0.783 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7735140323638916
Epoch: 16, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.455 Vali Acc: 0.817 Test Loss: 1.455 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7700369358062744
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855548).  Saving model ...
Epoch: 18 cost time: 3.7324955463409424
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.343 Vali Acc: 0.806 Test Loss: 1.343 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.766408681869507
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.730 Vali Acc: 0.856 Test Loss: 0.730 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 3.720397472381592
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 3.5340254306793213
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.333 Vali Acc: 0.828 Test Loss: 1.333 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.034695386886597
Epoch: 22, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.877 Vali Acc: 0.889 Test Loss: 0.877 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888880).  Saving model ...
Epoch: 23 cost time: 3.623687744140625
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.776 Vali Acc: 0.850 Test Loss: 1.776 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8328857421875
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.095 Vali Acc: 0.878 Test Loss: 1.095 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.993051767349243
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.672 Vali Acc: 0.889 Test Loss: 0.672 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888882).  Saving model ...
Epoch: 26 cost time: 3.9380922317504883
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.845 Vali Acc: 0.872 Test Loss: 0.845 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.230122089385986
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.492 Vali Acc: 0.861 Test Loss: 1.492 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.890197992324829
Epoch: 28, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.784 Vali Acc: 0.900 Test Loss: 0.784 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899992).  Saving model ...
Epoch: 29 cost time: 4.4937005043029785
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.187 Vali Acc: 0.856 Test Loss: 1.187 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.123619079589844
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.346 Vali Acc: 0.933 Test Loss: 0.346 Test Acc: 0.933
Validation loss decreased (-0.899992 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 3.859877586364746
Epoch: 31, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.374 Vali Acc: 0.861 Test Loss: 1.374 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.074377536773682
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.885 Vali Acc: 0.839 Test Loss: 0.885 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.978879690170288
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 2.212 Vali Acc: 0.833 Test Loss: 2.212 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.9113340377807617
Epoch: 34, Steps: 12 | Train Loss: 0.239 Vali Loss: 1.084 Vali Acc: 0.839 Test Loss: 1.084 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.7740530967712402
Epoch: 35, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.179 Vali Acc: 0.844 Test Loss: 1.179 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.6884262561798096
Epoch: 36, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.541 Vali Acc: 0.911 Test Loss: 0.541 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.660008430480957
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.586 Vali Acc: 0.850 Test Loss: 1.586 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.544942617416382
Epoch: 38, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.080 Vali Acc: 0.872 Test Loss: 1.080 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.7905588150024414
Epoch: 39, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.133 Vali Acc: 0.878 Test Loss: 1.133 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.667862892150879
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.672 Vali Acc: 0.861 Test Loss: 1.672 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.730349779129028
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.594960927963257
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.77394700050354
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6842877864837646
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.79610276222229
Epoch: 5, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.6062402725219727
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.60602068901062
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6678972244262695
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7278635501861572
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5587563514709473
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.656334400177002
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.6800084114074707
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.4403717517852783
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7825403213500977
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.729285478591919
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 10769926
model size : 60.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.930100202560425
Epoch: 1, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.501 Vali Acc: 0.456 Test Loss: 1.501 Test Acc: 0.456
Validation loss decreased (inf --> -0.455541).  Saving model ...
Epoch: 2 cost time: 3.789315938949585
Epoch: 2, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.094 Vali Acc: 0.583 Test Loss: 1.094 Test Acc: 0.583
Validation loss decreased (-0.455541 --> -0.583322).  Saving model ...
Epoch: 3 cost time: 4.074709415435791
Epoch: 3, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.842 Vali Acc: 0.667 Test Loss: 0.842 Test Acc: 0.667
Validation loss decreased (-0.583322 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 3.874499559402466
Epoch: 4, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.603 Vali Acc: 0.728 Test Loss: 0.603 Test Acc: 0.728
Validation loss decreased (-0.666658 --> -0.727772).  Saving model ...
Epoch: 5 cost time: 3.7277395725250244
Epoch: 5, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.435 Vali Acc: 0.806 Test Loss: 0.435 Test Acc: 0.806
Validation loss decreased (-0.727772 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 4.0521159172058105
Epoch: 6, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.429 Vali Acc: 0.794 Test Loss: 0.429 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.075408220291138
Epoch: 7, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 4.152034044265747
Epoch: 8, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.363 Vali Acc: 0.806 Test Loss: 0.363 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.214787006378174
Epoch: 9, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844440).  Saving model ...
Epoch: 10 cost time: 4.240673542022705
Epoch: 10, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.327728033065796
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.186888933181763
Epoch: 12, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 4.294578313827515
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 3.98413348197937
Epoch: 14, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.833 Vali Acc: 0.822 Test Loss: 0.833 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.110431432723999
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.219914197921753
Epoch: 16, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 4.207662343978882
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.365 Vali Acc: 0.894 Test Loss: 0.365 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 4.018329381942749
Epoch: 18, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.894441 --> -0.922219).  Saving model ...
Epoch: 19 cost time: 3.7136943340301514
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9569835662841797
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.716 Vali Acc: 0.861 Test Loss: 0.716 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.167961835861206
Epoch: 21, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.813 Vali Acc: 0.867 Test Loss: 0.813 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.023241758346558
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.422 Vali Acc: 0.906 Test Loss: 0.422 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.158006191253662
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 4.235612154006958
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.2581467628479
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.307 Vali Acc: 0.928 Test Loss: 0.307 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 4.201204776763916
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.190680980682373
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.172051906585693
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.953325033187866
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.2438647747039795
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.0615198612213135
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.420 Vali Acc: 0.894 Test Loss: 0.420 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.0770485401153564
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.907 Vali Acc: 0.856 Test Loss: 0.907 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.39058256149292
Epoch: 33, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.801 Vali Acc: 0.850 Test Loss: 1.801 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.307847738265991
Epoch: 34, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.457521200180054
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.781987905502319
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.609 Vali Acc: 0.378 Test Loss: 1.609 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 4.0242226123809814
Epoch: 2, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.231 Vali Acc: 0.517 Test Loss: 1.231 Test Acc: 0.517
Validation loss decreased (-0.377762 --> -0.516654).  Saving model ...
Epoch: 3 cost time: 4.381723880767822
Epoch: 3, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.942 Vali Acc: 0.639 Test Loss: 0.942 Test Acc: 0.639
Validation loss decreased (-0.516654 --> -0.638879).  Saving model ...
Epoch: 4 cost time: 4.023805379867554
Epoch: 4, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.698 Vali Acc: 0.683 Test Loss: 0.698 Test Acc: 0.683
Validation loss decreased (-0.638879 --> -0.683326).  Saving model ...
Epoch: 5 cost time: 4.13751220703125
Epoch: 5, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.683326 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 4.134005308151245
Epoch: 6, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 3.9439680576324463
Epoch: 7, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 4.379243850708008
Epoch: 8, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.522 Vali Acc: 0.811 Test Loss: 0.522 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.866605281829834
Epoch: 9, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 3.847254514694214
Epoch: 10, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.518 Vali Acc: 0.811 Test Loss: 0.518 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9259824752807617
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.384 Vali Acc: 0.844 Test Loss: 0.384 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 4.014248609542847
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.464 Vali Acc: 0.839 Test Loss: 0.464 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.073612213134766
Epoch: 13, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 3.80770206451416
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.793 Vali Acc: 0.811 Test Loss: 0.793 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.058276653289795
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.938098192214966
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 3.828669309616089
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 3.865964651107788
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.940356969833374
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.065374135971069
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 3.7945046424865723
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.706 Vali Acc: 0.856 Test Loss: 0.706 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.289849281311035
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.4115071296691895
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.719 Vali Acc: 0.878 Test Loss: 0.719 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.31358790397644
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.763 Vali Acc: 0.839 Test Loss: 0.763 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.25183629989624
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.777 Vali Acc: 0.867 Test Loss: 0.777 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.1834495067596436
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.462 Vali Acc: 0.911 Test Loss: 0.462 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 4.281784534454346
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.046 Vali Acc: 0.839 Test Loss: 1.046 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.443893909454346
Epoch: 28, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.528 Vali Acc: 0.906 Test Loss: 0.528 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.19731593132019
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.702 Vali Acc: 0.872 Test Loss: 0.702 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.315594434738159
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.451 Vali Acc: 0.911 Test Loss: 0.451 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 4.46074914932251
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.227034568786621
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.872 Test Loss: 0.712 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.374547719955444
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.644 Vali Acc: 0.883 Test Loss: 0.644 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.285505771636963
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.607 Vali Acc: 0.894 Test Loss: 0.607 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.072385787963867
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.386 Vali Acc: 0.917 Test Loss: 0.386 Test Acc: 0.917
Validation loss decreased (-0.911107 --> -0.916663).  Saving model ...
Epoch: 36 cost time: 4.063384294509888
Epoch: 36, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.670 Vali Acc: 0.872 Test Loss: 0.670 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7755274772644043
Epoch: 37, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.802 Vali Acc: 0.883 Test Loss: 0.802 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.787064552307129
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.510 Vali Acc: 0.906 Test Loss: 0.510 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.9489831924438477
Epoch: 39, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.541 Vali Acc: 0.822 Test Loss: 1.541 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.93072509765625
Epoch: 40, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.835 Vali Acc: 0.856 Test Loss: 0.835 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.8030948638916016
Epoch: 41, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.712 Vali Acc: 0.922 Test Loss: 0.712 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922215).  Saving model ...
Epoch: 42 cost time: 3.9355170726776123
Epoch: 42, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.636 Vali Acc: 0.783 Test Loss: 1.636 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.398400783538818
Epoch: 43, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.771 Vali Acc: 0.872 Test Loss: 0.771 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.179412841796875
Epoch: 44, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.976 Vali Acc: 0.856 Test Loss: 0.976 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.119001865386963
Epoch: 45, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 4.458563566207886
Epoch: 46, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.559 Vali Acc: 0.817 Test Loss: 1.559 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.122388124465942
Epoch: 47, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.865 Vali Acc: 0.894 Test Loss: 0.865 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.383706092834473
Epoch: 48, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.394 Vali Acc: 0.844 Test Loss: 1.394 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.17083477973938
Epoch: 49, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.386 Vali Acc: 0.861 Test Loss: 1.386 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.9958345890045166
Epoch: 50, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.219 Vali Acc: 0.878 Test Loss: 1.219 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.9249298572540283
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.047 Vali Acc: 0.894 Test Loss: 1.047 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.716583251953125
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.632 Vali Acc: 0.306 Test Loss: 1.632 Test Acc: 0.306
Validation loss decreased (inf --> -0.305539).  Saving model ...
Epoch: 2 cost time: 3.790062427520752
Epoch: 2, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.307 Vali Acc: 0.456 Test Loss: 1.307 Test Acc: 0.456
Validation loss decreased (-0.305539 --> -0.455542).  Saving model ...
Epoch: 3 cost time: 3.7477047443389893
Epoch: 3, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.033 Vali Acc: 0.517 Test Loss: 1.033 Test Acc: 0.517
Validation loss decreased (-0.455542 --> -0.516656).  Saving model ...
Epoch: 4 cost time: 3.786850690841675
Epoch: 4, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.828 Vali Acc: 0.633 Test Loss: 0.828 Test Acc: 0.633
Validation loss decreased (-0.516656 --> -0.633325).  Saving model ...
Epoch: 5 cost time: 3.6921684741973877
Epoch: 5, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.642 Vali Acc: 0.706 Test Loss: 0.642 Test Acc: 0.706
Validation loss decreased (-0.633325 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 3.6013693809509277
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.589 Vali Acc: 0.756 Test Loss: 0.589 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 3.641611337661743
Epoch: 7, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 3.8832590579986572
Epoch: 8, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.853034019470215
Epoch: 9, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 4.122159719467163
Epoch: 10, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.848 Vali Acc: 0.789 Test Loss: 0.848 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.260135650634766
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 4.315348386764526
Epoch: 12, Steps: 12 | Train Loss: 0.536 Vali Loss: 1.143 Vali Acc: 0.772 Test Loss: 1.143 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0283002853393555
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 3.785179853439331
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 4.094005823135376
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 4.144580841064453
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 3.648850679397583
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.040292024612427
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 4.229633092880249
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.843 Vali Acc: 0.828 Test Loss: 0.843 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.982870101928711
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.668 Vali Acc: 0.872 Test Loss: 0.668 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 3.5900075435638428
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.853 Vali Acc: 0.856 Test Loss: 0.853 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.74761962890625
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.138 Vali Acc: 0.856 Test Loss: 1.138 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.9109880924224854
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.781212091445923
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.602 Vali Acc: 0.883 Test Loss: 0.602 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 25 cost time: 3.770960569381714
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7974114418029785
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8869376182556152
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.776 Vali Acc: 0.861 Test Loss: 0.776 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.9310178756713867
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.967 Vali Acc: 0.839 Test Loss: 0.967 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.858208179473877
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9389119148254395
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.895 Vali Acc: 0.861 Test Loss: 0.895 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.038297891616821
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.485 Vali Acc: 0.850 Test Loss: 1.485 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.8476879596710205
Epoch: 32, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.966 Vali Acc: 0.828 Test Loss: 0.966 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.9367668628692627
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.173 Vali Acc: 0.844 Test Loss: 1.173 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.8899967670440674
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.677 Vali Acc: 0.883 Test Loss: 0.677 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.941379547119141
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.646 Vali Acc: 0.333 Test Loss: 1.646 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 3.975398302078247
Epoch: 2, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.309 Vali Acc: 0.483 Test Loss: 1.309 Test Acc: 0.483
Validation loss decreased (-0.333317 --> -0.483320).  Saving model ...
Epoch: 3 cost time: 3.6587581634521484
Epoch: 3, Steps: 12 | Train Loss: 1.006 Vali Loss: 0.933 Vali Acc: 0.561 Test Loss: 0.933 Test Acc: 0.561
Validation loss decreased (-0.483320 --> -0.561102).  Saving model ...
Epoch: 4 cost time: 3.746356964111328
Epoch: 4, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.849 Vali Acc: 0.628 Test Loss: 0.849 Test Acc: 0.628
Validation loss decreased (-0.561102 --> -0.627769).  Saving model ...
Epoch: 5 cost time: 3.9692442417144775
Epoch: 5, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.681 Vali Acc: 0.706 Test Loss: 0.681 Test Acc: 0.706
Validation loss decreased (-0.627769 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 3.8840067386627197
Epoch: 6, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.580 Vali Acc: 0.733 Test Loss: 0.580 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733328).  Saving model ...
Epoch: 7 cost time: 3.7628183364868164
Epoch: 7, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.491 Vali Acc: 0.767 Test Loss: 0.491 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 3.716278076171875
Epoch: 8, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7384116649627686
Epoch: 9, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 3.7258574962615967
Epoch: 10, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8746373653411865
Epoch: 11, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.531 Vali Acc: 0.800 Test Loss: 0.531 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 3.6885290145874023
Epoch: 12, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 3.8122518062591553
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.484 Vali Acc: 0.817 Test Loss: 0.484 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.528602123260498
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7584500312805176
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.689 Vali Acc: 0.833 Test Loss: 0.689 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 3.834718704223633
Epoch: 16, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 3.931522846221924
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8398396968841553
Epoch: 18, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.950 Vali Acc: 0.811 Test Loss: 0.950 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.803243398666382
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8670942783355713
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 2.201 Vali Acc: 0.783 Test Loss: 2.201 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.672283887863159
Epoch: 21, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.4242970943450928
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.698 Vali Acc: 0.839 Test Loss: 0.698 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6323611736297607
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855548).  Saving model ...
Epoch: 24 cost time: 3.9965083599090576
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861104).  Saving model ...
Epoch: 25 cost time: 3.825779914855957
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.867 Test Loss: 0.652 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 3.713177442550659
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.872 Test Loss: 0.656 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 27 cost time: 3.803661346435547
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888883).  Saving model ...
Epoch: 28 cost time: 3.9405040740966797
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.915001153945923
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.867 Test Loss: 0.881 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.7256600856781006
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.252 Vali Acc: 0.867 Test Loss: 1.252 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.7624263763427734
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.677 Vali Acc: 0.883 Test Loss: 0.677 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.087435722351074
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.838 Vali Acc: 0.883 Test Loss: 0.838 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.9970407485961914
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.665 Vali Acc: 0.894 Test Loss: 0.665 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894438).  Saving model ...
Epoch: 34 cost time: 3.823209762573242
Epoch: 34, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.795 Vali Acc: 0.861 Test Loss: 0.795 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6003146171569824
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.303 Vali Acc: 0.883 Test Loss: 1.303 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.7787024974823
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.009 Vali Acc: 0.861 Test Loss: 1.009 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.9907119274139404
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.696 Vali Acc: 0.856 Test Loss: 1.696 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.9470505714416504
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.246 Vali Acc: 0.861 Test Loss: 1.246 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.7149078845977783
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.283 Vali Acc: 0.861 Test Loss: 1.283 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.439270257949829
Epoch: 40, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.123 Vali Acc: 0.861 Test Loss: 1.123 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.6163241863250732
Epoch: 41, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.125 Vali Acc: 0.833 Test Loss: 1.125 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.741032600402832
Epoch: 42, Steps: 12 | Train Loss: 0.186 Vali Loss: 1.386 Vali Acc: 0.772 Test Loss: 1.386 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.878549098968506
Epoch: 43, Steps: 12 | Train Loss: 0.479 Vali Loss: 2.172 Vali Acc: 0.794 Test Loss: 2.172 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.552565574645996
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.673 Vali Acc: 0.339 Test Loss: 1.673 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 3.4773333072662354
Epoch: 2, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.149 Vali Acc: 0.617 Test Loss: 1.149 Test Acc: 0.617
Validation loss decreased (-0.338872 --> -0.616655).  Saving model ...
Epoch: 3 cost time: 3.693272113800049
Epoch: 3, Steps: 12 | Train Loss: 1.064 Vali Loss: 0.756 Vali Acc: 0.650 Test Loss: 0.756 Test Acc: 0.650
Validation loss decreased (-0.616655 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 3.778622627258301
Epoch: 4, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.795 Vali Acc: 0.661 Test Loss: 0.795 Test Acc: 0.661
Validation loss decreased (-0.649992 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 3.7497990131378174
Epoch: 5, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.687 Vali Acc: 0.728 Test Loss: 0.687 Test Acc: 0.728
Validation loss decreased (-0.661103 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 3.8067574501037598
Epoch: 6, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.529 Vali Acc: 0.767 Test Loss: 0.529 Test Acc: 0.767
Validation loss decreased (-0.727771 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 3.676645517349243
Epoch: 7, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 3.8639323711395264
Epoch: 8, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.643 Vali Acc: 0.767 Test Loss: 0.643 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6105239391326904
Epoch: 9, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.537 Vali Acc: 0.794 Test Loss: 0.537 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 3.715985059738159
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.700 Vali Acc: 0.794 Test Loss: 0.700 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.761848211288452
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 3.8983662128448486
Epoch: 12, Steps: 12 | Train Loss: 0.449 Vali Loss: 1.007 Vali Acc: 0.794 Test Loss: 1.007 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8697099685668945
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.874 Vali Acc: 0.817 Test Loss: 0.874 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816658).  Saving model ...
Epoch: 14 cost time: 3.8221545219421387
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.816658 --> -0.844439).  Saving model ...
Epoch: 15 cost time: 3.5312376022338867
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.674618721008301
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 1.028 Vali Acc: 0.839 Test Loss: 1.028 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.861997365951538
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 3.635951042175293
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 3.605813980102539
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.872 Vali Acc: 0.878 Test Loss: 0.872 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877769).  Saving model ...
Epoch: 20 cost time: 3.5117406845092773
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 4.086633920669556
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.812 Vali Acc: 0.822 Test Loss: 1.812 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8450846672058105
Epoch: 22, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.884 Vali Acc: 0.867 Test Loss: 0.884 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.778014898300171
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.486 Vali Acc: 0.917 Test Loss: 0.486 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 4.004228115081787
Epoch: 24, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.784 Vali Acc: 0.878 Test Loss: 0.784 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7334301471710205
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.910 Vali Acc: 0.828 Test Loss: 1.910 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9828872680664062
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.346 Vali Acc: 0.867 Test Loss: 1.346 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.099167346954346
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.153 Vali Acc: 0.883 Test Loss: 1.153 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9687516689300537
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.992 Vali Acc: 0.867 Test Loss: 0.992 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.8410098552703857
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.692 Vali Acc: 0.844 Test Loss: 1.692 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.3071653842926025
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.316 Vali Acc: 0.883 Test Loss: 1.316 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.049210071563721
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.181 Vali Acc: 0.900 Test Loss: 1.181 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.213868856430054
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.286 Vali Acc: 0.894 Test Loss: 1.286 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.23378324508667
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.823 Vali Acc: 0.883 Test Loss: 1.823 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4882447719573975
Epoch: 1, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.537 Vali Acc: 0.417 Test Loss: 1.537 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 3.8180320262908936
Epoch: 2, Steps: 12 | Train Loss: 1.622 Vali Loss: 0.882 Vali Acc: 0.644 Test Loss: 0.882 Test Acc: 0.644
Validation loss decreased (-0.416651 --> -0.644436).  Saving model ...
Epoch: 3 cost time: 3.8971400260925293
Epoch: 3, Steps: 12 | Train Loss: 1.076 Vali Loss: 0.773 Vali Acc: 0.639 Test Loss: 0.773 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.253554582595825
Epoch: 4, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.728 Vali Acc: 0.694 Test Loss: 0.728 Test Acc: 0.694
Validation loss decreased (-0.644436 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 3.9406018257141113
Epoch: 5, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.637 Vali Acc: 0.733 Test Loss: 0.637 Test Acc: 0.733
Validation loss decreased (-0.694437 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 4.035681962966919
Epoch: 6, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.504 Vali Acc: 0.811 Test Loss: 0.504 Test Acc: 0.811
Validation loss decreased (-0.733327 --> -0.811106).  Saving model ...
Epoch: 7 cost time: 4.122657299041748
Epoch: 7, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.482 Vali Acc: 0.811 Test Loss: 0.482 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 3.8976621627807617
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.583 Vali Acc: 0.772 Test Loss: 0.583 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.183805704116821
Epoch: 9, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827772).  Saving model ...
Epoch: 10 cost time: 3.860093593597412
Epoch: 10, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.181463003158569
Epoch: 11, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.622 Vali Acc: 0.817 Test Loss: 0.622 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.114523410797119
Epoch: 12, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.345 Vali Acc: 0.806 Test Loss: 1.345 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7223117351531982
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.647 Vali Acc: 0.817 Test Loss: 0.647 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.159087181091309
Epoch: 14, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.86173677444458
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.950 Vali Acc: 0.850 Test Loss: 0.950 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 3.954665184020996
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
Validation loss decreased (-0.849991 --> -0.872218).  Saving model ...
Epoch: 17 cost time: 3.9982199668884277
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.016 Vali Acc: 0.839 Test Loss: 1.016 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.107773780822754
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.719 Vali Acc: 0.844 Test Loss: 0.719 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.898205518722534
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.511 Vali Acc: 0.911 Test Loss: 0.511 Test Acc: 0.911
Validation loss decreased (-0.872218 --> -0.911106).  Saving model ...
Epoch: 20 cost time: 3.9411725997924805
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.530 Vali Acc: 0.906 Test Loss: 0.530 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.943962574005127
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.463 Vali Acc: 0.856 Test Loss: 1.463 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.1350860595703125
Epoch: 22, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.685 Vali Acc: 0.894 Test Loss: 0.685 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8520421981811523
Epoch: 23, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.931 Vali Acc: 0.883 Test Loss: 0.931 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.203494071960449
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.838 Vali Acc: 0.894 Test Loss: 0.838 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7237191200256348
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.006 Vali Acc: 0.889 Test Loss: 1.006 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.191628456115723
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.193 Vali Acc: 0.867 Test Loss: 1.193 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.7741856575012207
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.232 Vali Acc: 0.894 Test Loss: 1.232 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.7893576622009277
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.703 Vali Acc: 0.822 Test Loss: 1.703 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.008152484893799
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.771 Vali Acc: 0.878 Test Loss: 1.771 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.9297776222229
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.559 Vali Acc: 0.417 Test Loss: 1.559 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 3.683293581008911
Epoch: 2, Steps: 12 | Train Loss: 1.591 Vali Loss: 0.903 Vali Acc: 0.644 Test Loss: 0.903 Test Acc: 0.644
Validation loss decreased (-0.416651 --> -0.644435).  Saving model ...
Epoch: 3 cost time: 3.9597067832946777
Epoch: 3, Steps: 12 | Train Loss: 1.142 Vali Loss: 0.764 Vali Acc: 0.628 Test Loss: 0.764 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7474663257598877
Epoch: 4, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.791 Vali Acc: 0.656 Test Loss: 0.791 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 3.9443485736846924
Epoch: 5, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.631 Vali Acc: 0.728 Test Loss: 0.631 Test Acc: 0.728
Validation loss decreased (-0.655548 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 3.6148018836975098
Epoch: 6, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.494 Vali Acc: 0.794 Test Loss: 0.494 Test Acc: 0.794
Validation loss decreased (-0.727771 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 3.875903844833374
Epoch: 7, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.457 Vali Acc: 0.778 Test Loss: 0.457 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.970425605773926
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.632 Vali Acc: 0.756 Test Loss: 0.632 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8754312992095947
Epoch: 9, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8071212768554688
Epoch: 10, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 3.9866321086883545
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 4.241847038269043
Epoch: 12, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.130 Vali Acc: 0.794 Test Loss: 1.130 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.011411428451538
Epoch: 13, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.931795835494995
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.582 Vali Acc: 0.800 Test Loss: 0.582 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.15032434463501
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.880 Vali Acc: 0.856 Test Loss: 0.880 Test Acc: 0.856
Validation loss decreased (-0.811105 --> -0.855547).  Saving model ...
Epoch: 16 cost time: 3.9530227184295654
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.796016216278076
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.192 Vali Acc: 0.822 Test Loss: 1.192 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9516706466674805
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
Validation loss decreased (-0.855547 --> -0.877773).  Saving model ...
Epoch: 19 cost time: 3.9323999881744385
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.118 Vali Acc: 0.828 Test Loss: 1.118 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.77972149848938
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.764 Vali Acc: 0.900 Test Loss: 0.764 Test Acc: 0.900
Validation loss decreased (-0.877773 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 3.6126320362091064
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.575 Vali Acc: 0.872 Test Loss: 1.575 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.055394411087036
Epoch: 22, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.169 Vali Acc: 0.844 Test Loss: 1.169 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5131447315216064
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.620 Vali Acc: 0.889 Test Loss: 0.620 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.075673341751099
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.373 Vali Acc: 0.800 Test Loss: 1.373 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.1594462394714355
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.852 Vali Acc: 0.867 Test Loss: 0.852 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.263738393783569
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.905 Vali Acc: 0.883 Test Loss: 0.905 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.072072744369507
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.586 Vali Acc: 0.922 Test Loss: 0.586 Test Acc: 0.922
Validation loss decreased (-0.899992 --> -0.922216).  Saving model ...
Epoch: 28 cost time: 4.450430631637573
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.847 Vali Acc: 0.850 Test Loss: 1.847 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.53848934173584
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.487 Vali Acc: 0.872 Test Loss: 1.487 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9195666313171387
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.040 Vali Acc: 0.889 Test Loss: 1.040 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.047540664672852
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.534 Vali Acc: 0.906 Test Loss: 0.534 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.3447020053863525
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.858 Vali Acc: 0.883 Test Loss: 0.858 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.879995584487915
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.575 Vali Acc: 0.911 Test Loss: 0.575 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.072482109069824
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.907 Vali Acc: 0.911 Test Loss: 0.907 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.100548028945923
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.520 Vali Acc: 0.933 Test Loss: 0.520 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 36 cost time: 4.003619909286499
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.625 Vali Acc: 0.928 Test Loss: 0.625 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.901832342147827
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.835 Vali Acc: 0.917 Test Loss: 0.835 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.769423484802246
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.849 Vali Acc: 0.922 Test Loss: 0.849 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.7936089038848877
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 2.469 Vali Acc: 0.861 Test Loss: 2.469 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.703650712966919
Epoch: 40, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.788 Vali Acc: 0.933 Test Loss: 0.788 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.7314348220825195
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.118 Vali Acc: 0.889 Test Loss: 1.118 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.9537193775177
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.016 Vali Acc: 0.894 Test Loss: 1.016 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.909996509552002
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 2.519 Vali Acc: 0.811 Test Loss: 2.519 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.0076165199279785
Epoch: 44, Steps: 12 | Train Loss: 0.502 Vali Loss: 2.116 Vali Acc: 0.794 Test Loss: 2.116 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.8403215408325195
Epoch: 45, Steps: 12 | Train Loss: 0.510 Vali Loss: 1.355 Vali Acc: 0.844 Test Loss: 1.355 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.129303932189941
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.7443559169769287
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4383955001831055
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8552653789520264
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.006607532501221
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.381809234619141
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.163136005401611
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8911006450653076
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.7977023124694824
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.868837833404541
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.9064371585845947
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 9197062
model size : 54.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.6879472732543945
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.434 Vali Acc: 0.561 Test Loss: 1.434 Test Acc: 0.561
Validation loss decreased (inf --> -0.561097).  Saving model ...
Epoch: 2 cost time: 3.6268937587738037
Epoch: 2, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.057 Vali Acc: 0.572 Test Loss: 1.057 Test Acc: 0.572
Validation loss decreased (-0.561097 --> -0.572212).  Saving model ...
Epoch: 3 cost time: 3.5612564086914062
Epoch: 3, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.802 Vali Acc: 0.661 Test Loss: 0.802 Test Acc: 0.661
Validation loss decreased (-0.572212 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 3.6758902072906494
Epoch: 4, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.661103 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 3.9457192420959473
Epoch: 5, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 3.831613540649414
Epoch: 6, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788883).  Saving model ...
Epoch: 7 cost time: 3.7361364364624023
Epoch: 7, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
Validation loss decreased (-0.788883 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 4.0498199462890625
Epoch: 8, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6867570877075195
Epoch: 9, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.611424207687378
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 3.5719845294952393
Epoch: 11, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.389 Vali Acc: 0.844 Test Loss: 0.389 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.728520154953003
Epoch: 12, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6548149585723877
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 3.596938133239746
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.761 Vali Acc: 0.844 Test Loss: 0.761 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5074071884155273
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.350 Vali Acc: 0.872 Test Loss: 0.350 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7777185440063477
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6109869480133057
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5134518146514893
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.722458600997925
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.779024839401245
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6696407794952393
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.814638376235962
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.450 Vali Acc: 0.894 Test Loss: 0.450 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894440).  Saving model ...
Epoch: 23 cost time: 3.5027546882629395
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.785 Vali Acc: 0.878 Test Loss: 0.785 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.923259735107422
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
Validation loss decreased (-0.894440 --> -0.911107).  Saving model ...
Epoch: 25 cost time: 3.686825752258301
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6407063007354736
Epoch: 26, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.672 Vali Acc: 0.889 Test Loss: 0.672 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7523040771484375
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.560 Vali Acc: 0.894 Test Loss: 0.560 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.857471227645874
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.392 Vali Acc: 0.894 Test Loss: 0.392 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.7111592292785645
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.855 Vali Acc: 0.872 Test Loss: 0.855 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.605635404586792
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.348 Vali Acc: 0.939 Test Loss: 0.348 Test Acc: 0.939
Validation loss decreased (-0.911107 --> -0.938885).  Saving model ...
Epoch: 31 cost time: 3.7780516147613525
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.878 Test Loss: 0.991 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.676243305206299
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.550548791885376
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.755 Vali Acc: 0.883 Test Loss: 0.755 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.839179754257202
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.971 Vali Acc: 0.883 Test Loss: 0.971 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.471116304397583
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.775 Vali Acc: 0.867 Test Loss: 0.775 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5159621238708496
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.588148593902588
Epoch: 37, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.534 Vali Acc: 0.883 Test Loss: 0.534 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.581726312637329
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.6050784587860107
Epoch: 39, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.901 Vali Acc: 0.878 Test Loss: 0.901 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.4297280311584473
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.058 Vali Acc: 0.839 Test Loss: 1.058 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.999573707580566
Epoch: 1, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.534 Vali Acc: 0.472 Test Loss: 1.534 Test Acc: 0.472
Validation loss decreased (inf --> -0.472207).  Saving model ...
Epoch: 2 cost time: 4.612232208251953
Epoch: 2, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.182 Vali Acc: 0.511 Test Loss: 1.182 Test Acc: 0.511
Validation loss decreased (-0.472207 --> -0.511099).  Saving model ...
Epoch: 3 cost time: 4.079887628555298
Epoch: 3, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.884 Vali Acc: 0.656 Test Loss: 0.884 Test Acc: 0.656
Validation loss decreased (-0.511099 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 4.177747488021851
Epoch: 4, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
Validation loss decreased (-0.655547 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 3.943485736846924
Epoch: 5, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 4.219312429428101
Epoch: 6, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.021296977996826
Epoch: 7, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 4.282691478729248
Epoch: 8, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.121508836746216
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 4.2452921867370605
Epoch: 10, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.434 Vali Acc: 0.817 Test Loss: 0.434 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.820990562438965
Epoch: 11, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.439 Vali Acc: 0.817 Test Loss: 0.439 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9486680030822754
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 3.584332227706909
Epoch: 13, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 3.7911527156829834
Epoch: 14, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.549 Vali Acc: 0.839 Test Loss: 0.549 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8104569911956787
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5451250076293945
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6308913230895996
Epoch: 17, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8780226707458496
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 3.3542473316192627
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.740 Vali Acc: 0.817 Test Loss: 0.740 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.712747812271118
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 3.57206654548645
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7187178134918213
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8052940368652344
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.993 Vali Acc: 0.839 Test Loss: 0.993 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.8956258296966553
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.832408905029297
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.656 Vali Acc: 0.894 Test Loss: 0.656 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894438).  Saving model ...
Epoch: 26 cost time: 4.195082664489746
Epoch: 26, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.800 Vali Acc: 0.867 Test Loss: 0.800 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.979372501373291
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.987 Vali Acc: 0.833 Test Loss: 0.987 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.286359786987305
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.775803327560425
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.453 Vali Acc: 0.922 Test Loss: 0.453 Test Acc: 0.922
Validation loss decreased (-0.894438 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 3.903926372528076
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.956346035003662
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.004 Vali Acc: 0.867 Test Loss: 1.004 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.865915060043335
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.577 Vali Acc: 0.906 Test Loss: 0.577 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3536901473999023
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.705660820007324
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.74308705329895
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.422 Vali Acc: 0.894 Test Loss: 0.422 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.5104196071624756
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.509974956512451
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.546 Vali Acc: 0.906 Test Loss: 0.546 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.6021835803985596
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.757 Vali Acc: 0.894 Test Loss: 0.757 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.5516579151153564
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.476392507553101
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.578 Vali Acc: 0.339 Test Loss: 1.578 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 4.134102821350098
Epoch: 2, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.269 Vali Acc: 0.467 Test Loss: 1.269 Test Acc: 0.467
Validation loss decreased (-0.338873 --> -0.466654).  Saving model ...
Epoch: 3 cost time: 3.581777811050415
Epoch: 3, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.002 Vali Acc: 0.550 Test Loss: 1.002 Test Acc: 0.550
Validation loss decreased (-0.466654 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 3.80794095993042
Epoch: 4, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.762 Vali Acc: 0.633 Test Loss: 0.762 Test Acc: 0.633
Validation loss decreased (-0.549990 --> -0.633326).  Saving model ...
Epoch: 5 cost time: 3.8205459117889404
Epoch: 5, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.669 Vali Acc: 0.722 Test Loss: 0.669 Test Acc: 0.722
Validation loss decreased (-0.633326 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 4.141024351119995
Epoch: 6, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.806 Vali Acc: 0.739 Test Loss: 0.806 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 3.824603319168091
Epoch: 7, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.448 Vali Acc: 0.783 Test Loss: 0.448 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 4.090610504150391
Epoch: 8, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.019244909286499
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.0176169872283936
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788883).  Saving model ...
Epoch: 11 cost time: 4.311051607131958
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 12 cost time: 3.906175374984741
Epoch: 12, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 4.272961378097534
Epoch: 13, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.827772).  Saving model ...
Epoch: 14 cost time: 3.9874091148376465
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.689 Vali Acc: 0.828 Test Loss: 0.689 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.597306966781616
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.530 Vali Acc: 0.806 Test Loss: 0.530 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.071359157562256
Epoch: 16, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.079 Vali Acc: 0.806 Test Loss: 1.079 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.117809057235718
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.424 Vali Acc: 0.856 Test Loss: 0.424 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855551).  Saving model ...
Epoch: 18 cost time: 3.9405055046081543
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.675 Vali Acc: 0.844 Test Loss: 0.675 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.21703028678894
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.845 Vali Acc: 0.839 Test Loss: 0.845 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.78855037689209
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 4.407901287078857
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 4.142044305801392
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.273071050643921
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.976567268371582
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.806 Vali Acc: 0.867 Test Loss: 0.806 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.107903003692627
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 3.9817404747009277
Epoch: 26, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.605 Vali Acc: 0.883 Test Loss: 0.605 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 27 cost time: 3.735114097595215
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.736996650695801
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.794 Vali Acc: 0.828 Test Loss: 0.794 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.799607038497925
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.922 Vali Acc: 0.856 Test Loss: 0.922 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.289671897888184
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.880 Vali Acc: 0.856 Test Loss: 0.880 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.79917311668396
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.841 Vali Acc: 0.844 Test Loss: 0.841 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.8401803970336914
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.797 Vali Acc: 0.872 Test Loss: 0.797 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.015400171279907
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.757 Vali Acc: 0.878 Test Loss: 0.757 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.7516510486602783
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 2.213 Vali Acc: 0.828 Test Loss: 2.213 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.971510171890259
Epoch: 35, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.426 Vali Acc: 0.867 Test Loss: 1.426 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.6643197536468506
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.858 Vali Acc: 0.872 Test Loss: 0.858 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.464368104934692
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.656 Vali Acc: 0.289 Test Loss: 1.656 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 3.924031972885132
Epoch: 2, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.316 Vali Acc: 0.467 Test Loss: 1.316 Test Acc: 0.467
Validation loss decreased (-0.288872 --> -0.466654).  Saving model ...
Epoch: 3 cost time: 3.8740270137786865
Epoch: 3, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.978 Vali Acc: 0.556 Test Loss: 0.978 Test Acc: 0.556
Validation loss decreased (-0.466654 --> -0.555546).  Saving model ...
Epoch: 4 cost time: 3.732908010482788
Epoch: 4, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.846 Vali Acc: 0.611 Test Loss: 0.846 Test Acc: 0.611
Validation loss decreased (-0.555546 --> -0.611103).  Saving model ...
Epoch: 5 cost time: 3.6524970531463623
Epoch: 5, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.688 Vali Acc: 0.728 Test Loss: 0.688 Test Acc: 0.728
Validation loss decreased (-0.611103 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 3.7421953678131104
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.930 Vali Acc: 0.717 Test Loss: 0.930 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.598116397857666
Epoch: 7, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.500 Vali Acc: 0.794 Test Loss: 0.500 Test Acc: 0.794
Validation loss decreased (-0.727771 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 3.6219000816345215
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.666 Vali Acc: 0.767 Test Loss: 0.666 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.635946273803711
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.519 Vali Acc: 0.767 Test Loss: 0.519 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.473778247833252
Epoch: 10, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.622074604034424
Epoch: 11, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.461 Vali Acc: 0.811 Test Loss: 0.461 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 3.854947090148926
Epoch: 12, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7223575115203857
Epoch: 13, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827773).  Saving model ...
Epoch: 14 cost time: 3.597407341003418
Epoch: 14, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.502 Vali Acc: 0.811 Test Loss: 0.502 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7564077377319336
Epoch: 15, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.731278419494629
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.931 Vali Acc: 0.839 Test Loss: 0.931 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838880).  Saving model ...
Epoch: 17 cost time: 4.018830299377441
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
Validation loss decreased (-0.838880 --> -0.894439).  Saving model ...
Epoch: 18 cost time: 3.9657883644104004
Epoch: 18, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.835 Vali Acc: 0.839 Test Loss: 0.835 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.384683609008789
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.947 Vali Acc: 0.833 Test Loss: 0.947 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.942166328430176
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.789 Vali Acc: 0.872 Test Loss: 0.789 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.139428615570068
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.894 Test Loss: 0.424 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 22 cost time: 3.859187126159668
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 3.977661609649658
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.005 Vali Acc: 0.867 Test Loss: 1.005 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5875749588012695
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.852 Vali Acc: 0.878 Test Loss: 0.852 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.574585437774658
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.919 Vali Acc: 0.844 Test Loss: 0.919 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6473772525787354
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.835 Vali Acc: 0.856 Test Loss: 0.835 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.519627094268799
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.005 Vali Acc: 0.867 Test Loss: 1.005 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.378840923309326
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.367 Vali Acc: 0.850 Test Loss: 1.367 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.486762523651123
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.599 Vali Acc: 0.894 Test Loss: 0.599 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.574364185333252
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.834 Vali Acc: 0.844 Test Loss: 0.834 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.582749605178833
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.224 Vali Acc: 0.861 Test Loss: 1.224 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.474529266357422
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.913 Vali Acc: 0.861 Test Loss: 0.913 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.275671005249023
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.672 Vali Acc: 0.283 Test Loss: 1.672 Test Acc: 0.283
Validation loss decreased (inf --> -0.283317).  Saving model ...
Epoch: 2 cost time: 3.9580137729644775
Epoch: 2, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.097 Vali Acc: 0.594 Test Loss: 1.097 Test Acc: 0.594
Validation loss decreased (-0.283317 --> -0.594433).  Saving model ...
Epoch: 3 cost time: 3.782366991043091
Epoch: 3, Steps: 12 | Train Loss: 1.085 Vali Loss: 0.839 Vali Acc: 0.583 Test Loss: 0.839 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5793137550354004
Epoch: 4, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.763 Vali Acc: 0.639 Test Loss: 0.763 Test Acc: 0.639
Validation loss decreased (-0.594433 --> -0.638881).  Saving model ...
Epoch: 5 cost time: 3.9194986820220947
Epoch: 5, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.672 Vali Acc: 0.728 Test Loss: 0.672 Test Acc: 0.728
Validation loss decreased (-0.638881 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 4.132063388824463
Epoch: 6, Steps: 12 | Train Loss: 0.451 Vali Loss: 1.223 Vali Acc: 0.728 Test Loss: 1.223 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.824702501296997
Epoch: 7, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.847 Vali Acc: 0.767 Test Loss: 0.847 Test Acc: 0.767
Validation loss decreased (-0.727771 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 3.934208869934082
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.479 Vali Acc: 0.794 Test Loss: 0.479 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 3.615830898284912
Epoch: 9, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7103540897369385
Epoch: 10, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.680 Vali Acc: 0.794 Test Loss: 0.680 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.012462854385376
Epoch: 11, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8221895694732666
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.789 Vali Acc: 0.811 Test Loss: 0.789 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 3.6882424354553223
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.861 Vali Acc: 0.817 Test Loss: 0.861 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816658).  Saving model ...
Epoch: 14 cost time: 3.415828227996826
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
Validation loss decreased (-0.816658 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 3.5897345542907715
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 3.555708408355713
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.551 Vali Acc: 0.828 Test Loss: 1.551 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.662368059158325
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.672 Vali Acc: 0.872 Test Loss: 0.672 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 3.5455944538116455
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.349 Vali Acc: 0.844 Test Loss: 1.349 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7562103271484375
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.745 Vali Acc: 0.883 Test Loss: 0.745 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883326).  Saving model ...
Epoch: 20 cost time: 3.918377637863159
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.857 Vali Acc: 0.883 Test Loss: 0.857 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8168816566467285
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.779 Vali Acc: 0.883 Test Loss: 0.779 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.739142656326294
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.221 Vali Acc: 0.839 Test Loss: 1.221 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7875349521636963
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.458 Vali Acc: 0.917 Test Loss: 0.458 Test Acc: 0.917
Validation loss decreased (-0.883326 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 3.8993661403656006
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.101 Vali Acc: 0.867 Test Loss: 1.101 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7945337295532227
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.744 Vali Acc: 0.894 Test Loss: 0.744 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8891239166259766
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 2.709 Vali Acc: 0.839 Test Loss: 2.709 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.735457181930542
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.819 Vali Acc: 0.872 Test Loss: 0.819 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9926257133483887
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.609 Vali Acc: 0.939 Test Loss: 0.609 Test Acc: 0.939
Validation loss decreased (-0.916662 --> -0.938883).  Saving model ...
Epoch: 29 cost time: 4.029162645339966
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.486 Vali Acc: 0.844 Test Loss: 1.486 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8228516578674316
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.424 Vali Acc: 0.861 Test Loss: 1.424 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.9187302589416504
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.850 Vali Acc: 0.911 Test Loss: 0.850 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.838158369064331
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.103 Vali Acc: 0.894 Test Loss: 1.103 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.6725716590881348
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.293 Vali Acc: 0.894 Test Loss: 1.293 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.608302354812622
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.872 Vali Acc: 0.883 Test Loss: 1.872 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.7214365005493164
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.933 Vali Acc: 0.883 Test Loss: 1.933 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.691983699798584
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.727 Vali Acc: 0.839 Test Loss: 1.727 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.57285737991333
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.287 Vali Acc: 0.889 Test Loss: 1.287 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.6939735412597656
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.501 Vali Acc: 0.900 Test Loss: 1.501 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.7398810386657715
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.586 Vali Acc: 0.356 Test Loss: 1.586 Test Acc: 0.356
Validation loss decreased (inf --> -0.355540).  Saving model ...
Epoch: 2 cost time: 3.8528289794921875
Epoch: 2, Steps: 12 | Train Loss: 1.573 Vali Loss: 0.883 Vali Acc: 0.611 Test Loss: 0.883 Test Acc: 0.611
Validation loss decreased (-0.355540 --> -0.611102).  Saving model ...
Epoch: 3 cost time: 4.126592636108398
Epoch: 3, Steps: 12 | Train Loss: 1.013 Vali Loss: 0.876 Vali Acc: 0.606 Test Loss: 0.876 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9781250953674316
Epoch: 4, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.703 Vali Acc: 0.683 Test Loss: 0.703 Test Acc: 0.683
Validation loss decreased (-0.611102 --> -0.683326).  Saving model ...
Epoch: 5 cost time: 3.931826591491699
Epoch: 5, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.579 Vali Acc: 0.772 Test Loss: 0.579 Test Acc: 0.772
Validation loss decreased (-0.683326 --> -0.772216).  Saving model ...
Epoch: 6 cost time: 3.9484667778015137
Epoch: 6, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.321 Vali Acc: 0.761 Test Loss: 1.321 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.714766263961792
Epoch: 7, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.907 Vali Acc: 0.772 Test Loss: 0.907 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6062614917755127
Epoch: 8, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.365 Vali Acc: 0.794 Test Loss: 0.365 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794441).  Saving model ...
Epoch: 9 cost time: 3.8304789066314697
Epoch: 9, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7545037269592285
Epoch: 10, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.794441 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 4.020273447036743
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 4.130046844482422
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.861 Vali Acc: 0.783 Test Loss: 0.861 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.530134916305542
Epoch: 13, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8146684169769287
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6580069065093994
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.611 Vali Acc: 0.883 Test Loss: 0.611 Test Acc: 0.883
Validation loss decreased (-0.827773 --> -0.883327).  Saving model ...
Epoch: 16 cost time: 3.5504024028778076
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.782 Vali Acc: 0.817 Test Loss: 1.782 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.05998682975769
Epoch: 17, Steps: 12 | Train Loss: 0.347 Vali Loss: 1.115 Vali Acc: 0.822 Test Loss: 1.115 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7923924922943115
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.788283586502075
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.431 Vali Acc: 0.817 Test Loss: 1.431 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.147075176239014
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.825 Vali Acc: 0.839 Test Loss: 0.825 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.996731758117676
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.769 Vali Acc: 0.839 Test Loss: 0.769 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.74188232421875
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.732 Vali Acc: 0.861 Test Loss: 0.732 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.839475154876709
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.259 Vali Acc: 0.839 Test Loss: 1.259 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.066141605377197
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 2.080 Vali Acc: 0.850 Test Loss: 2.080 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.052304029464722
Epoch: 25, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888884).  Saving model ...
Epoch: 26 cost time: 3.7195188999176025
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.150 Vali Acc: 0.850 Test Loss: 1.150 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.9732439517974854
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.416 Vali Acc: 0.822 Test Loss: 1.416 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.110607147216797
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.002 Vali Acc: 0.861 Test Loss: 1.002 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6624231338500977
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.004 Vali Acc: 0.906 Test Loss: 1.004 Test Acc: 0.906
Validation loss decreased (-0.888884 --> -0.905546).  Saving model ...
Epoch: 30 cost time: 3.434394121170044
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.666 Vali Acc: 0.894 Test Loss: 0.666 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.557720184326172
Epoch: 31, Steps: 12 | Train Loss: 0.352 Vali Loss: 1.642 Vali Acc: 0.850 Test Loss: 1.642 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.9329867362976074
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.835 Vali Acc: 0.922 Test Loss: 0.835 Test Acc: 0.922
Validation loss decreased (-0.905546 --> -0.922214).  Saving model ...
Epoch: 33 cost time: 3.161365509033203
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.556 Vali Acc: 0.856 Test Loss: 1.556 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.263457775115967
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.367 Vali Acc: 0.894 Test Loss: 1.367 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.9181995391845703
Epoch: 35, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.859 Vali Acc: 0.906 Test Loss: 0.859 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.821916103363037
Epoch: 36, Steps: 12 | Train Loss: 0.327 Vali Loss: 1.824 Vali Acc: 0.811 Test Loss: 1.824 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.738516092300415
Epoch: 37, Steps: 12 | Train Loss: 0.546 Vali Loss: 1.327 Vali Acc: 0.828 Test Loss: 1.327 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5098159313201904
Epoch: 38, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.024 Vali Acc: 0.850 Test Loss: 1.024 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.780791997909546
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.992 Vali Acc: 0.878 Test Loss: 0.992 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.752366304397583
Epoch: 40, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.054 Vali Acc: 0.878 Test Loss: 1.054 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.6551876068115234
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.969 Vali Acc: 0.900 Test Loss: 0.969 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.068265199661255
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.147 Vali Acc: 0.867 Test Loss: 1.147 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.611681938171387
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 3.3666224479675293
Epoch: 2, Steps: 12 | Train Loss: 1.600 Vali Loss: 0.871 Vali Acc: 0.606 Test Loss: 0.871 Test Acc: 0.606
Validation loss decreased (-0.399985 --> -0.605547).  Saving model ...
Epoch: 3 cost time: 3.7070813179016113
Epoch: 3, Steps: 12 | Train Loss: 1.053 Vali Loss: 0.791 Vali Acc: 0.622 Test Loss: 0.791 Test Acc: 0.622
Validation loss decreased (-0.605547 --> -0.622214).  Saving model ...
Epoch: 4 cost time: 3.5966384410858154
Epoch: 4, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.712 Vali Acc: 0.683 Test Loss: 0.712 Test Acc: 0.683
Validation loss decreased (-0.622214 --> -0.683326).  Saving model ...
Epoch: 5 cost time: 3.671217918395996
Epoch: 5, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
Validation loss decreased (-0.683326 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 3.3789286613464355
Epoch: 6, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.253 Vali Acc: 0.756 Test Loss: 1.253 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7140631675720215
Epoch: 7, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.837 Vali Acc: 0.767 Test Loss: 0.837 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 3.5916635990142822
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 3.599754571914673
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.672 Vali Acc: 0.794 Test Loss: 0.672 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8697104454040527
Epoch: 10, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.634 Vali Acc: 0.772 Test Loss: 0.634 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.680032253265381
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.494 Vali Acc: 0.817 Test Loss: 0.494 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 3.6329641342163086
Epoch: 12, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8043107986450195
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.1761884689331055
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.395 Vali Acc: 0.839 Test Loss: 0.395 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 3.787505865097046
Epoch: 15, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.827 Vali Acc: 0.844 Test Loss: 0.827 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844436).  Saving model ...
Epoch: 16 cost time: 3.8751683235168457
Epoch: 16, Steps: 12 | Train Loss: 0.244 Vali Loss: 2.473 Vali Acc: 0.811 Test Loss: 2.473 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.028905868530273
Epoch: 17, Steps: 12 | Train Loss: 0.451 Vali Loss: 1.082 Vali Acc: 0.817 Test Loss: 1.082 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9974963665008545
Epoch: 18, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
Validation loss decreased (-0.844436 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 3.7929024696350098
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.018 Vali Acc: 0.850 Test Loss: 1.018 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.121397256851196
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.049 Vali Acc: 0.850 Test Loss: 1.049 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.345500230789185
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.154 Vali Acc: 0.844 Test Loss: 1.154 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.9236562252044678
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.282 Vali Acc: 0.822 Test Loss: 1.282 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.8083767890930176
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.239 Vali Acc: 0.861 Test Loss: 1.239 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.657663583755493
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.356 Vali Acc: 0.833 Test Loss: 1.356 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.53828501701355
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.207 Vali Acc: 0.850 Test Loss: 1.207 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8891053199768066
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.018 Vali Acc: 0.850 Test Loss: 1.018 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7837088108062744
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.960 Vali Acc: 0.883 Test Loss: 0.960 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883324).  Saving model ...
Epoch: 28 cost time: 3.816295862197876
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.734 Vali Acc: 0.900 Test Loss: 0.734 Test Acc: 0.900
Validation loss decreased (-0.883324 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 3.7605230808258057
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.864 Vali Acc: 0.883 Test Loss: 0.864 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.540731191635132
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.076 Vali Acc: 0.867 Test Loss: 1.076 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.5945987701416016
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.557 Vali Acc: 0.928 Test Loss: 0.557 Test Acc: 0.928
Validation loss decreased (-0.899993 --> -0.927772).  Saving model ...
Epoch: 32 cost time: 3.6827335357666016
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.121 Vali Acc: 0.900 Test Loss: 1.121 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.716485023498535
Epoch: 33, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.494 Vali Acc: 0.867 Test Loss: 1.494 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.642780065536499
Epoch: 34, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.424 Vali Acc: 0.861 Test Loss: 1.424 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6974449157714844
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.886 Vali Acc: 0.867 Test Loss: 0.886 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.5184614658355713
Epoch: 36, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.771 Vali Acc: 0.867 Test Loss: 1.771 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.608184576034546
Epoch: 37, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.316 Vali Acc: 0.856 Test Loss: 1.316 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.9121859073638916
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.370 Vali Acc: 0.856 Test Loss: 1.370 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.8151323795318604
Epoch: 39, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.884 Vali Acc: 0.844 Test Loss: 0.884 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.742051601409912
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.6602635383605957
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.748 Vali Acc: 0.839 Test Loss: 0.748 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.904895305633545
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.541790008544922
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.565396308898926
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.379070997238159
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.3181824684143066
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7046892642974854
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2533295154571533
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3207743167877197
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8846635818481445
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.764887809753418
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7649295330047607
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.688781499862671
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 3.494123935699463
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 4.1088550090789795
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4946486949920654
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5794146060943604
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6988730430603027
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 3.7591586112976074
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 3.403700590133667
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 3.424762487411499
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4980812072753906
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3926475048065186
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 3.333247661590576
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 3.4456701278686523
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3770086765289307
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.465270757675171
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.328913450241089
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.501962661743164
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.29994797706604
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.606842517852783
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.6226937770843506
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.6198198795318604
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.4122817516326904
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 8410630
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.851109743118286
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.526 Vali Acc: 0.506 Test Loss: 1.526 Test Acc: 0.506
Validation loss decreased (inf --> -0.505540).  Saving model ...
Epoch: 2 cost time: 4.109596252441406
Epoch: 2, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.111 Vali Acc: 0.517 Test Loss: 1.111 Test Acc: 0.517
Validation loss decreased (-0.505540 --> -0.516656).  Saving model ...
Epoch: 3 cost time: 3.905505418777466
Epoch: 3, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.840 Vali Acc: 0.661 Test Loss: 0.840 Test Acc: 0.661
Validation loss decreased (-0.516656 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 3.852386236190796
Epoch: 4, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.586 Vali Acc: 0.778 Test Loss: 0.586 Test Acc: 0.778
Validation loss decreased (-0.661103 --> -0.777772).  Saving model ...
Epoch: 5 cost time: 3.741178274154663
Epoch: 5, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.406 Vali Acc: 0.817 Test Loss: 0.406 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 3.6599044799804688
Epoch: 6, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 3.3758857250213623
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.461 Vali Acc: 0.778 Test Loss: 0.461 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6806693077087402
Epoch: 8, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.671 Vali Acc: 0.806 Test Loss: 0.671 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4719908237457275
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6975669860839844
Epoch: 10, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.391 Vali Acc: 0.844 Test Loss: 0.391 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 3.667689561843872
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5526866912841797
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 3.606578826904297
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.716 Vali Acc: 0.817 Test Loss: 0.716 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.837256908416748
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.09648060798645
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
Validation loss decreased (-0.849994 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 3.9267561435699463
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.872427463531494
Epoch: 17, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.588169574737549
Epoch: 18, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.976321220397949
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 3.7996950149536133
Epoch: 20, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.003718852996826
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.071272134780884
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8836913108825684
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5853283405303955
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.87719464302063
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.471 Vali Acc: 0.894 Test Loss: 0.471 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.808267593383789
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.526 Vali Acc: 0.878 Test Loss: 0.526 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.369441270828247
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.6783580780029297
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.4263041019439697
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 30 cost time: 3.531430721282959
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.657 Vali Acc: 0.894 Test Loss: 0.657 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.5288443565368652
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5729589462280273
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.7661499977111816
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.7332730293273926
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.822418451309204
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.842 Vali Acc: 0.872 Test Loss: 0.842 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.739287853240967
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.906 Test Loss: 0.532 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.676633358001709
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.8632071018218994
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.900 Test Loss: 0.667 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.053595066070557
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.906 Test Loss: 0.667 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.618615388870239
Epoch: 1, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.613 Vali Acc: 0.356 Test Loss: 1.613 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 3.5571444034576416
Epoch: 2, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.220 Vali Acc: 0.494 Test Loss: 1.220 Test Acc: 0.494
Validation loss decreased (-0.355539 --> -0.494432).  Saving model ...
Epoch: 3 cost time: 3.676102638244629
Epoch: 3, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.907 Vali Acc: 0.628 Test Loss: 0.907 Test Acc: 0.628
Validation loss decreased (-0.494432 --> -0.627769).  Saving model ...
Epoch: 4 cost time: 3.6166887283325195
Epoch: 4, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
Validation loss decreased (-0.627769 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 3.7181549072265625
Epoch: 5, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.483 Vali Acc: 0.772 Test Loss: 0.483 Test Acc: 0.772
Validation loss decreased (-0.722216 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 3.8806447982788086
Epoch: 6, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
Validation loss decreased (-0.772217 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 3.744739532470703
Epoch: 7, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.569 Vali Acc: 0.772 Test Loss: 0.569 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7945401668548584
Epoch: 8, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.692 Vali Acc: 0.817 Test Loss: 0.692 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7798404693603516
Epoch: 9, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 4.010536432266235
Epoch: 10, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.420 Vali Acc: 0.800 Test Loss: 0.420 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9022057056427
Epoch: 11, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.848114490509033
Epoch: 12, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 3.830756187438965
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 1.001 Vali Acc: 0.800 Test Loss: 1.001 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7256288528442383
Epoch: 14, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8513619899749756
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.745131731033325
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.841308832168579
Epoch: 17, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.440 Vali Acc: 0.839 Test Loss: 0.440 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.037101984024048
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 3.712043285369873
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 3.759347915649414
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.835538387298584
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.075441837310791
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8717336654663086
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 3.66389536857605
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.992706537246704
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9924116134643555
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7419450283050537
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.958 Vali Acc: 0.844 Test Loss: 0.958 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.879406452178955
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.841186046600342
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.845444440841675
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.551 Vali Acc: 0.911 Test Loss: 0.551 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911106).  Saving model ...
Epoch: 31 cost time: 3.787684917449951
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.306 Vali Acc: 0.856 Test Loss: 1.306 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.8541080951690674
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.501 Vali Acc: 0.906 Test Loss: 0.501 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.848814010620117
Epoch: 33, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.447 Vali Acc: 0.906 Test Loss: 0.447 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.5005903244018555
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.734 Vali Acc: 0.861 Test Loss: 0.734 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.8463170528411865
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.855 Vali Acc: 0.856 Test Loss: 0.855 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.8632657527923584
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.587196111679077
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.692 Vali Acc: 0.889 Test Loss: 0.692 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.0608134269714355
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 4.079557180404663
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.917 Test Loss: 0.608 Test Acc: 0.917
Validation loss decreased (-0.911106 --> -0.916661).  Saving model ...
Epoch: 40 cost time: 4.0269012451171875
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.922 Test Loss: 0.584 Test Acc: 0.922
Validation loss decreased (-0.916661 --> -0.922216).  Saving model ...
Epoch: 41 cost time: 3.5629003047943115
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.922 Test Loss: 0.578 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 42 cost time: 3.8426380157470703
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.917 Test Loss: 0.586 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.8236494064331055
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.922 Test Loss: 0.588 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.103834629058838
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.922 Test Loss: 0.588 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.942666530609131
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.922 Test Loss: 0.592 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 4.322945833206177
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.922 Test Loss: 0.593 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.865602731704712
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.922 Test Loss: 0.597 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.030081033706665
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.922 Test Loss: 0.599 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.2188897132873535
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.922 Test Loss: 0.597 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.9072227478027344
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.922 Test Loss: 0.590 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 4.122245788574219
Epoch: 51, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.922 Test Loss: 0.583 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.1805291175842285
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.673 Vali Acc: 0.261 Test Loss: 1.673 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 3.930058240890503
Epoch: 2, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.310 Vali Acc: 0.439 Test Loss: 1.310 Test Acc: 0.439
Validation loss decreased (-0.261094 --> -0.438876).  Saving model ...
Epoch: 3 cost time: 3.877613067626953
Epoch: 3, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.985 Vali Acc: 0.578 Test Loss: 0.985 Test Acc: 0.578
Validation loss decreased (-0.438876 --> -0.577768).  Saving model ...
Epoch: 4 cost time: 3.810983419418335
Epoch: 4, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.758 Vali Acc: 0.656 Test Loss: 0.758 Test Acc: 0.656
Validation loss decreased (-0.577768 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 3.7617905139923096
Epoch: 5, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.617 Vali Acc: 0.728 Test Loss: 0.617 Test Acc: 0.728
Validation loss decreased (-0.655548 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 3.845499038696289
Epoch: 6, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.486 Vali Acc: 0.778 Test Loss: 0.486 Test Acc: 0.778
Validation loss decreased (-0.727772 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 3.7659852504730225
Epoch: 7, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.702 Vali Acc: 0.750 Test Loss: 0.702 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.844189405441284
Epoch: 8, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783326).  Saving model ...
Epoch: 9 cost time: 4.32510232925415
Epoch: 9, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 3.8174524307250977
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 3.8068184852600098
Epoch: 11, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.624 Vali Acc: 0.794 Test Loss: 0.624 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794438).  Saving model ...
Epoch: 12 cost time: 3.8535044193267822
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 4.1956400871276855
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.010 Vali Acc: 0.817 Test Loss: 1.010 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816657).  Saving model ...
Epoch: 14 cost time: 3.7747421264648438
Epoch: 14, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
Validation loss decreased (-0.816657 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 4.247279405593872
Epoch: 15, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 3.6548125743865967
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 3.8513195514678955
Epoch: 17, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6907498836517334
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888884).  Saving model ...
Epoch: 19 cost time: 4.031997442245483
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7034337520599365
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.111144065856934
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.321141958236694
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.759 Vali Acc: 0.844 Test Loss: 0.759 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9696390628814697
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.318328142166138
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.9406394958496094
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.840 Vali Acc: 0.872 Test Loss: 0.840 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.03778076171875
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.832 Vali Acc: 0.878 Test Loss: 0.832 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.870418071746826
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.45024561882019
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 3.8786873817443848
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.894 Test Loss: 0.676 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.942614793777466
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.900 Test Loss: 0.677 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7674777507781982
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.911 Test Loss: 0.686 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911104).  Saving model ...
Epoch: 32 cost time: 3.975548028945923
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5303194522857666
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.894 Test Loss: 0.681 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.920058012008667
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.894 Test Loss: 0.677 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.8748133182525635
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.911 Test Loss: 0.667 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 36 cost time: 3.701249122619629
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.911 Test Loss: 0.668 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.678300142288208
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.906 Test Loss: 0.670 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.631777048110962
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.900 Test Loss: 0.681 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.8924665451049805
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.112732172012329
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.911 Test Loss: 0.686 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.124234676361084
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.911 Test Loss: 0.679 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.6300952434539795
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.894 Test Loss: 0.683 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.8423116207122803
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.906 Test Loss: 0.688 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.84578275680542
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.911 Test Loss: 0.697 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.782349109649658
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.900 Test Loss: 0.682 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.469351291656494
Epoch: 1, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.719 Vali Acc: 0.261 Test Loss: 1.719 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 3.8959579467773438
Epoch: 2, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.384 Vali Acc: 0.428 Test Loss: 1.384 Test Acc: 0.428
Validation loss decreased (-0.261094 --> -0.427764).  Saving model ...
Epoch: 3 cost time: 4.320900917053223
Epoch: 3, Steps: 12 | Train Loss: 0.993 Vali Loss: 0.925 Vali Acc: 0.594 Test Loss: 0.925 Test Acc: 0.594
Validation loss decreased (-0.427764 --> -0.594435).  Saving model ...
Epoch: 4 cost time: 3.844019889831543
Epoch: 4, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.852 Vali Acc: 0.628 Test Loss: 0.852 Test Acc: 0.628
Validation loss decreased (-0.594435 --> -0.627769).  Saving model ...
Epoch: 5 cost time: 3.9646413326263428
Epoch: 5, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.634 Vali Acc: 0.683 Test Loss: 0.634 Test Acc: 0.683
Validation loss decreased (-0.627769 --> -0.683327).  Saving model ...
Epoch: 6 cost time: 3.4327173233032227
Epoch: 6, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.479 Vali Acc: 0.778 Test Loss: 0.479 Test Acc: 0.778
Validation loss decreased (-0.683327 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 3.685631513595581
Epoch: 7, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.364964485168457
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 3.638890027999878
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.494 Vali Acc: 0.778 Test Loss: 0.494 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.472409963607788
Epoch: 10, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.456 Vali Acc: 0.789 Test Loss: 0.456 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 3.674372434616089
Epoch: 11, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.548 Vali Acc: 0.794 Test Loss: 0.548 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794439).  Saving model ...
Epoch: 12 cost time: 3.3835556507110596
Epoch: 12, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9444682598114014
Epoch: 13, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 4.077922105789185
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 3.8159890174865723
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 3.845900535583496
Epoch: 16, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 3.7402138710021973
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.103958368301392
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.473 Vali Acc: 0.894 Test Loss: 0.473 Test Acc: 0.894
Validation loss decreased (-0.866661 --> -0.894440).  Saving model ...
Epoch: 19 cost time: 3.864093780517578
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.716 Vali Acc: 0.878 Test Loss: 0.716 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.139593124389648
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.769758462905884
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.323843002319336
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.894 Test Loss: 0.499 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.095705986022949
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.705 Vali Acc: 0.883 Test Loss: 0.705 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.909996509552002
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.810 Vali Acc: 0.894 Test Loss: 0.810 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.5635080337524414
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.894 Test Loss: 0.743 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6791443824768066
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.889 Test Loss: 0.794 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.672809600830078
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.894 Test Loss: 0.789 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.956054210662842
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.894 Test Loss: 0.779 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.756387710571289
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.732 Vali Acc: 0.317 Test Loss: 1.732 Test Acc: 0.317
Validation loss decreased (inf --> -0.316649).  Saving model ...
Epoch: 2 cost time: 3.706101179122925
Epoch: 2, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.174 Vali Acc: 0.606 Test Loss: 1.174 Test Acc: 0.606
Validation loss decreased (-0.316649 --> -0.605544).  Saving model ...
Epoch: 3 cost time: 3.7836086750030518
Epoch: 3, Steps: 12 | Train Loss: 1.034 Vali Loss: 0.757 Vali Acc: 0.644 Test Loss: 0.757 Test Acc: 0.644
Validation loss decreased (-0.605544 --> -0.644437).  Saving model ...
Epoch: 4 cost time: 4.101685047149658
Epoch: 4, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.821 Vali Acc: 0.611 Test Loss: 0.821 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.80751633644104
Epoch: 5, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.530 Vali Acc: 0.739 Test Loss: 0.530 Test Acc: 0.739
Validation loss decreased (-0.644437 --> -0.738884).  Saving model ...
Epoch: 6 cost time: 4.026902198791504
Epoch: 6, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.400 Vali Acc: 0.778 Test Loss: 0.400 Test Acc: 0.778
Validation loss decreased (-0.738884 --> -0.777774).  Saving model ...
Epoch: 7 cost time: 3.9345736503601074
Epoch: 7, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.814823865890503
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.885 Vali Acc: 0.783 Test Loss: 0.885 Test Acc: 0.783
Validation loss decreased (-0.777774 --> -0.783324).  Saving model ...
Epoch: 9 cost time: 3.9213175773620605
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
Validation loss decreased (-0.783324 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 3.7861430644989014
Epoch: 10, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822217).  Saving model ...
Epoch: 11 cost time: 4.131632566452026
Epoch: 11, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.791 Vali Acc: 0.817 Test Loss: 0.791 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.903597116470337
Epoch: 12, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7508373260498047
Epoch: 13, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.124 Vali Acc: 0.844 Test Loss: 1.124 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844433).  Saving model ...
Epoch: 14 cost time: 3.8082873821258545
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.936 Vali Acc: 0.817 Test Loss: 0.936 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.95097279548645
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
Validation loss decreased (-0.844433 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 3.807351589202881
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5909571647644043
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.636 Vali Acc: 0.872 Test Loss: 0.636 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 3.8604812622070312
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.643 Vali Acc: 0.878 Test Loss: 0.643 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 19 cost time: 3.797419786453247
Epoch: 19, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.832 Vali Acc: 0.867 Test Loss: 0.832 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.0786097049713135
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.986927032470703
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.982 Vali Acc: 0.844 Test Loss: 0.982 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.011559724807739
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.956 Vali Acc: 0.861 Test Loss: 0.956 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.864177942276001
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.713 Vali Acc: 0.867 Test Loss: 0.713 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.143218278884888
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.132 Vali Acc: 0.861 Test Loss: 1.132 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.809767723083496
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.066 Vali Acc: 0.844 Test Loss: 1.066 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8885819911956787
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.652 Vali Acc: 0.917 Test Loss: 0.652 Test Acc: 0.917
Validation loss decreased (-0.877771 --> -0.916660).  Saving model ...
Epoch: 27 cost time: 3.836280584335327
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.740 Vali Acc: 0.794 Test Loss: 1.740 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5045547485351562
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.587 Vali Acc: 0.822 Test Loss: 1.587 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8098785877227783
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.548 Vali Acc: 0.906 Test Loss: 0.548 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8052520751953125
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.981 Vali Acc: 0.861 Test Loss: 0.981 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.8170623779296875
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.360 Vali Acc: 0.811 Test Loss: 1.360 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.780534267425537
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.322 Vali Acc: 0.850 Test Loss: 1.322 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.007305145263672
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.079 Vali Acc: 0.867 Test Loss: 1.079 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.7321434020996094
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.819 Vali Acc: 0.894 Test Loss: 0.819 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.7850136756896973
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.140 Vali Acc: 0.889 Test Loss: 1.140 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.091728687286377
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.369 Vali Acc: 0.894 Test Loss: 1.369 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.394330263137817
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.564 Vali Acc: 0.394 Test Loss: 1.564 Test Acc: 0.394
Validation loss decreased (inf --> -0.394429).  Saving model ...
Epoch: 2 cost time: 3.6199581623077393
Epoch: 2, Steps: 12 | Train Loss: 1.640 Vali Loss: 0.908 Vali Acc: 0.628 Test Loss: 0.908 Test Acc: 0.628
Validation loss decreased (-0.394429 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 3.731663703918457
Epoch: 3, Steps: 12 | Train Loss: 1.047 Vali Loss: 0.699 Vali Acc: 0.683 Test Loss: 0.699 Test Acc: 0.683
Validation loss decreased (-0.627769 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 3.969003438949585
Epoch: 4, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.771 Vali Acc: 0.656 Test Loss: 0.771 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.089248418807983
Epoch: 5, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.538 Vali Acc: 0.750 Test Loss: 0.538 Test Acc: 0.750
Validation loss decreased (-0.683326 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 3.832756280899048
Epoch: 6, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.326 Vali Acc: 0.822 Test Loss: 0.326 Test Acc: 0.822
Validation loss decreased (-0.749995 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 4.412456274032593
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.664 Vali Acc: 0.772 Test Loss: 0.664 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7888057231903076
Epoch: 8, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.803 Vali Acc: 0.778 Test Loss: 0.803 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.805497646331787
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.435 Vali Acc: 0.822 Test Loss: 0.435 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9472501277923584
Epoch: 10, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 3.516146183013916
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.862 Vali Acc: 0.811 Test Loss: 0.862 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.792212963104248
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6657297611236572
Epoch: 13, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.954 Vali Acc: 0.856 Test Loss: 0.954 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855546).  Saving model ...
Epoch: 14 cost time: 3.3060672283172607
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.847 Vali Acc: 0.833 Test Loss: 0.847 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8427023887634277
Epoch: 15, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.414 Vali Acc: 0.906 Test Loss: 0.414 Test Acc: 0.906
Validation loss decreased (-0.855546 --> -0.905551).  Saving model ...
Epoch: 16 cost time: 3.7939412593841553
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.044 Vali Acc: 0.844 Test Loss: 1.044 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.641547679901123
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.885 Vali Acc: 0.844 Test Loss: 0.885 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9599449634552
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.069 Vali Acc: 0.856 Test Loss: 1.069 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9474940299987793
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.693 Vali Acc: 0.889 Test Loss: 0.693 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.10378098487854
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.474 Vali Acc: 0.928 Test Loss: 0.474 Test Acc: 0.928
Validation loss decreased (-0.905551 --> -0.927773).  Saving model ...
Epoch: 21 cost time: 4.001474142074585
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.028 Vali Acc: 0.872 Test Loss: 1.028 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.007362127304077
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.179 Vali Acc: 0.856 Test Loss: 1.179 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.117978096008301
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.974 Vali Acc: 0.850 Test Loss: 0.974 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.9897873401641846
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.571 Vali Acc: 0.911 Test Loss: 0.571 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.7823219299316406
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.770 Vali Acc: 0.878 Test Loss: 0.770 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.9849886894226074
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.712 Vali Acc: 0.872 Test Loss: 0.712 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.9787113666534424
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.092 Vali Acc: 0.861 Test Loss: 1.092 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.852694511413574
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.599 Vali Acc: 0.911 Test Loss: 0.599 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.040555477142334
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.609 Vali Acc: 0.922 Test Loss: 0.609 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.775693655014038
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.173 Vali Acc: 0.900 Test Loss: 1.173 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.122199535369873
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.584 Vali Acc: 0.411 Test Loss: 1.584 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 3.906895160675049
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 0.894 Vali Acc: 0.622 Test Loss: 0.894 Test Acc: 0.622
Validation loss decreased (-0.411095 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 3.6827902793884277
Epoch: 3, Steps: 12 | Train Loss: 1.109 Vali Loss: 0.670 Vali Acc: 0.672 Test Loss: 0.670 Test Acc: 0.672
Validation loss decreased (-0.622213 --> -0.672216).  Saving model ...
Epoch: 4 cost time: 3.8947854042053223
Epoch: 4, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.770 Vali Acc: 0.639 Test Loss: 0.770 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1209893226623535
Epoch: 5, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
Validation loss decreased (-0.672216 --> -0.716661).  Saving model ...
Epoch: 6 cost time: 3.762056589126587
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
Validation loss decreased (-0.716661 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 3.615892171859741
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.689 Vali Acc: 0.772 Test Loss: 0.689 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9139201641082764
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7615714073181152
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 3.817551851272583
Epoch: 10, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.061049461364746
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.833858013153076
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.749 Vali Acc: 0.828 Test Loss: 0.749 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7694878578186035
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.760 Vali Acc: 0.861 Test Loss: 0.760 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861104).  Saving model ...
Epoch: 14 cost time: 3.961758852005005
Epoch: 14, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.451181173324585
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 3.861722946166992
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.962 Vali Acc: 0.828 Test Loss: 0.962 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.707516670227051
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.918 Vali Acc: 0.856 Test Loss: 0.918 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6731152534484863
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.021 Vali Acc: 0.861 Test Loss: 1.021 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7888362407684326
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.823 Vali Acc: 0.872 Test Loss: 0.823 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6996817588806152
Epoch: 20, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.765 Vali Acc: 0.872 Test Loss: 0.765 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.885009765625
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.854 Vali Acc: 0.878 Test Loss: 0.854 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877769).  Saving model ...
Epoch: 22 cost time: 3.798229217529297
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.907 Vali Acc: 0.867 Test Loss: 0.907 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.772304058074951
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.877769 --> -0.922218).  Saving model ...
Epoch: 24 cost time: 4.036454916000366
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.643 Vali Acc: 0.894 Test Loss: 0.643 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7919867038726807
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.894 Vali Acc: 0.883 Test Loss: 0.894 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.913083076477051
Epoch: 26, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.005 Vali Acc: 0.883 Test Loss: 1.005 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7205796241760254
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.351 Vali Acc: 0.867 Test Loss: 1.351 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.129347324371338
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.960 Vali Acc: 0.883 Test Loss: 0.960 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.40690803527832
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.986 Vali Acc: 0.889 Test Loss: 0.986 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.74493408203125
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.065 Vali Acc: 0.883 Test Loss: 1.065 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.7707786560058594
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 2.393 Vali Acc: 0.844 Test Loss: 2.393 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.8128459453582764
Epoch: 32, Steps: 12 | Train Loss: 0.309 Vali Loss: 1.747 Vali Acc: 0.867 Test Loss: 1.747 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.2994349002838135
Epoch: 33, Steps: 12 | Train Loss: 0.071 Vali Loss: 2.509 Vali Acc: 0.817 Test Loss: 2.509 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.179165840148926
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.542468786239624
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4188129901885986
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.498293876647949
Epoch: 4, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.6349027156829834
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.7026922702789307
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.4947993755340576
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6652982234954834
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.651731252670288
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4610002040863037
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6551454067230225
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5594372749328613
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3280959129333496
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.538665533065796
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.743435859680176
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.4896371364593506
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 8017414
model size : 50.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.249646902084351
Epoch: 1, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.556 Vali Acc: 0.367 Test Loss: 1.556 Test Acc: 0.367
Validation loss decreased (inf --> -0.366651).  Saving model ...
Epoch: 2 cost time: 3.6424944400787354
Epoch: 2, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.181 Vali Acc: 0.511 Test Loss: 1.181 Test Acc: 0.511
Validation loss decreased (-0.366651 --> -0.511099).  Saving model ...
Epoch: 3 cost time: 3.821094036102295
Epoch: 3, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.944 Vali Acc: 0.628 Test Loss: 0.944 Test Acc: 0.628
Validation loss decreased (-0.511099 --> -0.627768).  Saving model ...
Epoch: 4 cost time: 3.944523811340332
Epoch: 4, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.782 Vali Acc: 0.667 Test Loss: 0.782 Test Acc: 0.667
Validation loss decreased (-0.627768 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 3.5536131858825684
Epoch: 5, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
Validation loss decreased (-0.666659 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 3.6558279991149902
Epoch: 6, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.501 Vali Acc: 0.800 Test Loss: 0.501 Test Acc: 0.800
Validation loss decreased (-0.733327 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 3.7030837535858154
Epoch: 7, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 3.4232823848724365
Epoch: 8, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.404 Vali Acc: 0.822 Test Loss: 0.404 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 3.6494100093841553
Epoch: 9, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 3.4962618350982666
Epoch: 10, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 3.9440765380859375
Epoch: 11, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8286845684051514
Epoch: 12, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 3.963810682296753
Epoch: 13, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 3.684985399246216
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 4.001866817474365
Epoch: 15, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 3.7684900760650635
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.397 Vali Acc: 0.867 Test Loss: 0.397 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 3.8745930194854736
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 18 cost time: 3.6573352813720703
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8965742588043213
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 3.6779086589813232
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 3.4765639305114746
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.646707057952881
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.533633232116699
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 3.5788192749023438
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5462288856506348
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.661623239517212
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.9963791370391846
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.404 Vali Acc: 0.894 Test Loss: 0.404 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.316707372665405
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 29 cost time: 4.073404788970947
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.2549967765808105
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.11910605430603
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.479 Vali Acc: 0.894 Test Loss: 0.479 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.187289714813232
Epoch: 32, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.335 Vali Acc: 0.894 Test Loss: 0.335 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.9508771896362305
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.77127742767334
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.425 Vali Acc: 0.878 Test Loss: 0.425 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.9085750579833984
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.074554681777954
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.8216278553009033
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.386 Vali Acc: 0.906 Test Loss: 0.386 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.018316745758057
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.5544703006744385
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.602 Vali Acc: 0.394 Test Loss: 1.602 Test Acc: 0.394
Validation loss decreased (inf --> -0.394428).  Saving model ...
Epoch: 2 cost time: 3.388827323913574
Epoch: 2, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.305 Vali Acc: 0.450 Test Loss: 1.305 Test Acc: 0.450
Validation loss decreased (-0.394428 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 3.44456148147583
Epoch: 3, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.081 Vali Acc: 0.550 Test Loss: 1.081 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 3.5825424194335938
Epoch: 4, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.895 Vali Acc: 0.639 Test Loss: 0.895 Test Acc: 0.639
Validation loss decreased (-0.549989 --> -0.638880).  Saving model ...
Epoch: 5 cost time: 3.444664716720581
Epoch: 5, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.638880 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 3.471108913421631
Epoch: 6, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.587 Vali Acc: 0.739 Test Loss: 0.587 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.529927968978882
Epoch: 7, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.469 Vali Acc: 0.761 Test Loss: 0.469 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 3.5325701236724854
Epoch: 8, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.460 Vali Acc: 0.783 Test Loss: 0.460 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 3.875241994857788
Epoch: 9, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.423 Vali Acc: 0.783 Test Loss: 0.423 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 3.788883924484253
Epoch: 10, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.403 Vali Acc: 0.794 Test Loss: 0.403 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 3.77488374710083
Epoch: 11, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 3.740708589553833
Epoch: 12, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.519 Vali Acc: 0.817 Test Loss: 0.519 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8837687969207764
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 3.577634334564209
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.539 Vali Acc: 0.811 Test Loss: 0.539 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.685300350189209
Epoch: 15, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.506 Vali Acc: 0.817 Test Loss: 0.506 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6713359355926514
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.818927526473999
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6394271850585938
Epoch: 18, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6187169551849365
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.861107 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 3.327225685119629
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.557347297668457
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.349 Vali Acc: 0.894 Test Loss: 0.349 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.693106174468994
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.65212345123291
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5014071464538574
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.759248733520508
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.63313889503479
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.7989604473114014
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.6238491535186768
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5906989574432373
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.686 Vali Acc: 0.883 Test Loss: 0.686 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.2912492752075195
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.659 Vali Acc: 0.311 Test Loss: 1.659 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 3.6612377166748047
Epoch: 2, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
Validation loss decreased (-0.311095 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 3.6735434532165527
Epoch: 3, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.236 Vali Acc: 0.461 Test Loss: 1.236 Test Acc: 0.461
Validation loss decreased (-0.399986 --> -0.461099).  Saving model ...
Epoch: 4 cost time: 3.717410087585449
Epoch: 4, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.064 Vali Acc: 0.522 Test Loss: 1.064 Test Acc: 0.522
Validation loss decreased (-0.461099 --> -0.522212).  Saving model ...
Epoch: 5 cost time: 3.8001468181610107
Epoch: 5, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.897 Vali Acc: 0.600 Test Loss: 0.897 Test Acc: 0.600
Validation loss decreased (-0.522212 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 3.9026684761047363
Epoch: 6, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.745 Vali Acc: 0.650 Test Loss: 0.745 Test Acc: 0.650
Validation loss decreased (-0.599991 --> -0.649993).  Saving model ...
Epoch: 7 cost time: 3.789566993713379
Epoch: 7, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (-0.649993 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 3.761586904525757
Epoch: 8, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.576 Vali Acc: 0.733 Test Loss: 0.576 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 9 cost time: 3.4973020553588867
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.506 Vali Acc: 0.767 Test Loss: 0.506 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 3.6727352142333984
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.524 Vali Acc: 0.767 Test Loss: 0.524 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5465121269226074
Epoch: 11, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.537 Vali Acc: 0.794 Test Loss: 0.537 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794439).  Saving model ...
Epoch: 12 cost time: 3.4932780265808105
Epoch: 12, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.586 Vali Acc: 0.794 Test Loss: 0.586 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5705604553222656
Epoch: 13, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.714425802230835
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.561 Vali Acc: 0.811 Test Loss: 0.561 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 15 cost time: 3.562070846557617
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6255695819854736
Epoch: 16, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.707892656326294
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.574409246444702
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.907841682434082
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 3.8397557735443115
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.162235736846924
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9358811378479004
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.776 Vali Acc: 0.822 Test Loss: 0.776 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8606138229370117
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.761 Vali Acc: 0.856 Test Loss: 0.761 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855548).  Saving model ...
Epoch: 24 cost time: 3.445896625518799
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.706774950027466
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.686 Vali Acc: 0.839 Test Loss: 0.686 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5015604496002197
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.737 Vali Acc: 0.856 Test Loss: 0.737 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 27 cost time: 3.671424627304077
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.718 Vali Acc: 0.861 Test Loss: 0.718 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861104).  Saving model ...
Epoch: 28 cost time: 3.3424031734466553
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 3.7127954959869385
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.100 Vali Acc: 0.883 Test Loss: 1.100 Test Acc: 0.883
Validation loss decreased (-0.861105 --> -0.883322).  Saving model ...
Epoch: 30 cost time: 3.494497060775757
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.608 Vali Acc: 0.872 Test Loss: 0.608 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.457280158996582
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.672598361968994
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.057 Vali Acc: 0.883 Test Loss: 1.057 Test Acc: 0.883
Validation loss decreased (-0.883322 --> -0.883323).  Saving model ...
Epoch: 33 cost time: 3.5856335163116455
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.910 Vali Acc: 0.878 Test Loss: 0.910 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.7533485889434814
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.596 Vali Acc: 0.889 Test Loss: 0.596 Test Acc: 0.889
Validation loss decreased (-0.883323 --> -0.888883).  Saving model ...
Epoch: 35 cost time: 3.6040358543395996
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.621177911758423
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.900 Test Loss: 0.607 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 3.4699313640594482
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.6697728633880615
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.6473491191864014
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.7180352210998535
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.607664108276367
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.936497449874878
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.613898754119873
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.883 Test Loss: 0.532 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.8744304180145264
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.7812421321868896
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.912574291229248
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.395900249481201
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.770 Vali Acc: 0.217 Test Loss: 1.770 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 3.686289072036743
Epoch: 2, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.545 Vali Acc: 0.400 Test Loss: 1.545 Test Acc: 0.400
Validation loss decreased (-0.216649 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 3.722630739212036
Epoch: 3, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.355 Vali Acc: 0.444 Test Loss: 1.355 Test Acc: 0.444
Validation loss decreased (-0.399985 --> -0.444431).  Saving model ...
Epoch: 4 cost time: 3.3180832862854004
Epoch: 4, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.073 Vali Acc: 0.539 Test Loss: 1.073 Test Acc: 0.539
Validation loss decreased (-0.444431 --> -0.538878).  Saving model ...
Epoch: 5 cost time: 3.2158098220825195
Epoch: 5, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.917 Vali Acc: 0.583 Test Loss: 0.917 Test Acc: 0.583
Validation loss decreased (-0.538878 --> -0.583324).  Saving model ...
Epoch: 6 cost time: 3.256107807159424
Epoch: 6, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.807 Vali Acc: 0.639 Test Loss: 0.807 Test Acc: 0.639
Validation loss decreased (-0.583324 --> -0.638881).  Saving model ...
Epoch: 7 cost time: 3.4239158630371094
Epoch: 7, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.672 Vali Acc: 0.672 Test Loss: 0.672 Test Acc: 0.672
Validation loss decreased (-0.638881 --> -0.672215).  Saving model ...
Epoch: 8 cost time: 3.4540247917175293
Epoch: 8, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.687 Vali Acc: 0.706 Test Loss: 0.687 Test Acc: 0.706
Validation loss decreased (-0.672215 --> -0.705549).  Saving model ...
Epoch: 9 cost time: 3.633866548538208
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.604 Vali Acc: 0.744 Test Loss: 0.604 Test Acc: 0.744
Validation loss decreased (-0.705549 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 3.471055746078491
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.547 Vali Acc: 0.750 Test Loss: 0.547 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749995).  Saving model ...
Epoch: 11 cost time: 3.5306754112243652
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.482 Vali Acc: 0.767 Test Loss: 0.482 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 3.651374101638794
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.790 Vali Acc: 0.794 Test Loss: 0.790 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 3.6826465129852295
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.525 Vali Acc: 0.794 Test Loss: 0.525 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794439).  Saving model ...
Epoch: 14 cost time: 3.753675699234009
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 3.6340456008911133
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4598846435546875
Epoch: 16, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8161380290985107
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 3.716853618621826
Epoch: 18, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.647162437438965
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 3.416696786880493
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 3.410693407058716
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.882 Vali Acc: 0.822 Test Loss: 0.882 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2138216495513916
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.965 Vali Acc: 0.828 Test Loss: 0.965 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3063783645629883
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.883 Vali Acc: 0.822 Test Loss: 0.883 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0530529022216797
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.858 Vali Acc: 0.828 Test Loss: 0.858 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8014819622039795
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7049286365509033
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.7619247436523438
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4598546028137207
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.890 Vali Acc: 0.889 Test Loss: 0.890 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888880).  Saving model ...
Epoch: 29 cost time: 3.619528293609619
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.036 Vali Acc: 0.878 Test Loss: 1.036 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.609678030014038
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.456206798553467
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.01674222946167
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.562558174133301
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.808 Vali Acc: 0.894 Test Loss: 0.808 Test Acc: 0.894
Validation loss decreased (-0.888880 --> -0.894436).  Saving model ...
Epoch: 34 cost time: 3.892362117767334
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.600 Vali Acc: 0.878 Test Loss: 0.600 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3929495811462402
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.005 Vali Acc: 0.861 Test Loss: 1.005 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.037262678146362
Epoch: 36, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.420 Vali Acc: 0.811 Test Loss: 1.420 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.039671421051025
Epoch: 37, Steps: 12 | Train Loss: 0.243 Vali Loss: 1.002 Vali Acc: 0.856 Test Loss: 1.002 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.85288667678833
Epoch: 38, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.551 Vali Acc: 0.883 Test Loss: 0.551 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.8285508155822754
Epoch: 39, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.884601593017578
Epoch: 40, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.368 Vali Acc: 0.833 Test Loss: 1.368 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.9548842906951904
Epoch: 41, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.812 Vali Acc: 0.861 Test Loss: 0.812 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.7580111026763916
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.108 Vali Acc: 0.867 Test Loss: 1.108 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.7384278774261475
Epoch: 43, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.029 Vali Acc: 0.811 Test Loss: 1.029 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.418973922729492
Epoch: 1, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.837 Vali Acc: 0.139 Test Loss: 1.837 Test Acc: 0.139
Validation loss decreased (inf --> -0.138871).  Saving model ...
Epoch: 2 cost time: 3.727790594100952
Epoch: 2, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.593 Vali Acc: 0.350 Test Loss: 1.593 Test Acc: 0.350
Validation loss decreased (-0.138871 --> -0.349984).  Saving model ...
Epoch: 3 cost time: 3.934281826019287
Epoch: 3, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.220 Vali Acc: 0.539 Test Loss: 1.220 Test Acc: 0.539
Validation loss decreased (-0.349984 --> -0.538877).  Saving model ...
Epoch: 4 cost time: 3.9318699836730957
Epoch: 4, Steps: 12 | Train Loss: 1.170 Vali Loss: 0.800 Vali Acc: 0.617 Test Loss: 0.800 Test Acc: 0.617
Validation loss decreased (-0.538877 --> -0.616659).  Saving model ...
Epoch: 5 cost time: 3.9981420040130615
Epoch: 5, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.757 Vali Acc: 0.672 Test Loss: 0.757 Test Acc: 0.672
Validation loss decreased (-0.616659 --> -0.672215).  Saving model ...
Epoch: 6 cost time: 3.979896306991577
Epoch: 6, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.641 Vali Acc: 0.694 Test Loss: 0.641 Test Acc: 0.694
Validation loss decreased (-0.672215 --> -0.694438).  Saving model ...
Epoch: 7 cost time: 3.8821051120758057
Epoch: 7, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.510 Vali Acc: 0.733 Test Loss: 0.510 Test Acc: 0.733
Validation loss decreased (-0.694438 --> -0.733328).  Saving model ...
Epoch: 8 cost time: 3.839205503463745
Epoch: 8, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.733328 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 3.619584560394287
Epoch: 9, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.518 Vali Acc: 0.733 Test Loss: 0.518 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8259336948394775
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.491 Vali Acc: 0.778 Test Loss: 0.491 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 11 cost time: 3.785837411880493
Epoch: 11, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.395 Vali Acc: 0.800 Test Loss: 0.395 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 4.047703266143799
Epoch: 12, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.599 Vali Acc: 0.817 Test Loss: 0.599 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816661).  Saving model ...
Epoch: 13 cost time: 4.053900957107544
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.550 Vali Acc: 0.772 Test Loss: 0.550 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.939230442047119
Epoch: 14, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.567 Vali Acc: 0.811 Test Loss: 0.567 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9893271923065186
Epoch: 15, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.795 Vali Acc: 0.789 Test Loss: 0.795 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6548962593078613
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 3.9186906814575195
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 3.7795634269714355
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.37945556640625
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.515 Vali Acc: 0.839 Test Loss: 0.515 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838884).  Saving model ...
Epoch: 20 cost time: 3.7353084087371826
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 3.3530168533325195
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.149 Vali Acc: 0.833 Test Loss: 1.149 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7437615394592285
Epoch: 22, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.960 Vali Acc: 0.833 Test Loss: 0.960 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.81650710105896
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.046 Vali Acc: 0.856 Test Loss: 1.046 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.7733542919158936
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.717 Vali Acc: 0.889 Test Loss: 0.717 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888882).  Saving model ...
Epoch: 25 cost time: 3.761183500289917
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.853201150894165
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.560 Vali Acc: 0.883 Test Loss: 0.560 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.292515754699707
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.617 Vali Acc: 0.911 Test Loss: 0.617 Test Acc: 0.911
Validation loss decreased (-0.888882 --> -0.911105).  Saving model ...
Epoch: 28 cost time: 3.8196916580200195
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.497 Vali Acc: 0.917 Test Loss: 0.497 Test Acc: 0.917
Validation loss decreased (-0.911105 --> -0.916662).  Saving model ...
Epoch: 29 cost time: 4.210228443145752
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.666 Vali Acc: 0.889 Test Loss: 0.666 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.120032548904419
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.533 Vali Acc: 0.894 Test Loss: 0.533 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7705798149108887
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.594 Vali Acc: 0.889 Test Loss: 0.594 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.438823699951172
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.498 Vali Acc: 0.911 Test Loss: 0.498 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.563915491104126
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.3367161750793457
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.885 Vali Acc: 0.878 Test Loss: 0.885 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.6967599391937256
Epoch: 35, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.764 Vali Acc: 0.828 Test Loss: 1.764 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.9020204544067383
Epoch: 36, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.8708837032318115
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.664590835571289
Epoch: 38, Steps: 12 | Train Loss: 0.248 Vali Loss: 1.202 Vali Acc: 0.828 Test Loss: 1.202 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.39788556098938
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.770 Vali Acc: 0.206 Test Loss: 1.770 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 3.6169745922088623
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.422 Vali Acc: 0.428 Test Loss: 1.422 Test Acc: 0.428
Validation loss decreased (-0.205538 --> -0.427764).  Saving model ...
Epoch: 3 cost time: 3.6240272521972656
Epoch: 3, Steps: 12 | Train Loss: 1.528 Vali Loss: 0.954 Vali Acc: 0.589 Test Loss: 0.954 Test Acc: 0.589
Validation loss decreased (-0.427764 --> -0.588879).  Saving model ...
Epoch: 4 cost time: 3.4940617084503174
Epoch: 4, Steps: 12 | Train Loss: 1.101 Vali Loss: 0.774 Vali Acc: 0.611 Test Loss: 0.774 Test Acc: 0.611
Validation loss decreased (-0.588879 --> -0.611103).  Saving model ...
Epoch: 5 cost time: 3.5227770805358887
Epoch: 5, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.743 Vali Acc: 0.656 Test Loss: 0.743 Test Acc: 0.656
Validation loss decreased (-0.611103 --> -0.655548).  Saving model ...
Epoch: 6 cost time: 3.68338942527771
Epoch: 6, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.609 Vali Acc: 0.711 Test Loss: 0.609 Test Acc: 0.711
Validation loss decreased (-0.655548 --> -0.711105).  Saving model ...
Epoch: 7 cost time: 3.794283866882324
Epoch: 7, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.461 Vali Acc: 0.767 Test Loss: 0.461 Test Acc: 0.767
Validation loss decreased (-0.711105 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 3.88930344581604
Epoch: 8, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.527 Vali Acc: 0.778 Test Loss: 0.527 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 4.0198259353637695
Epoch: 9, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.533 Vali Acc: 0.778 Test Loss: 0.533 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8469228744506836
Epoch: 10, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.430 Vali Acc: 0.783 Test Loss: 0.430 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 3.9380171298980713
Epoch: 11, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.403 Vali Acc: 0.789 Test Loss: 0.403 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 4.036835432052612
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 3.6160998344421387
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822219).  Saving model ...
Epoch: 14 cost time: 3.4821994304656982
Epoch: 14, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.631 Vali Acc: 0.817 Test Loss: 0.631 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2770450115203857
Epoch: 15, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.552 Vali Acc: 0.806 Test Loss: 0.552 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.302933931350708
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3272416591644287
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.571 Vali Acc: 0.800 Test Loss: 0.571 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.659255266189575
Epoch: 18, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.726097583770752
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 3.79636812210083
Epoch: 20, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 3.7729480266571045
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.750 Vali Acc: 0.839 Test Loss: 0.750 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.704573392868042
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 3.751553773880005
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.433 Vali Acc: 0.906 Test Loss: 0.433 Test Acc: 0.906
Validation loss decreased (-0.861106 --> -0.905551).  Saving model ...
Epoch: 24 cost time: 3.301530122756958
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.377124547958374
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.414 Vali Acc: 0.894 Test Loss: 0.414 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3319385051727295
Epoch: 26, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.852 Vali Acc: 0.883 Test Loss: 0.852 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4664530754089355
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.624957799911499
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.015 Vali Acc: 0.856 Test Loss: 1.015 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.7869298458099365
Epoch: 29, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
Validation loss decreased (-0.905551 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 3.592892646789551
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.89766788482666
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.588350772857666
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4757039546966553
Epoch: 33, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.578 Vali Acc: 0.906 Test Loss: 0.578 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.731873035430908
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.803 Vali Acc: 0.861 Test Loss: 0.803 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.5209217071533203
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.536 Vali Acc: 0.906 Test Loss: 0.536 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.4415743350982666
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.4380977153778076
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922218).  Saving model ...
Epoch: 38 cost time: 3.4420089721679688
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.387 Vali Acc: 0.933 Test Loss: 0.387 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 3.3990089893341064
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.477 Vali Acc: 0.922 Test Loss: 0.477 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.613896608352661
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.463 Vali Acc: 0.906 Test Loss: 0.463 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.959038257598877
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.933329 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 4.144862651824951
Epoch: 42, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.537 Vali Acc: 0.922 Test Loss: 0.537 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.946106433868408
Epoch: 43, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.629 Vali Acc: 0.889 Test Loss: 0.629 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.7522339820861816
Epoch: 44, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.745 Vali Acc: 0.900 Test Loss: 0.745 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.038981199264526
Epoch: 45, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.5787336826324463
Epoch: 46, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 3.301828384399414
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.3758065700531006
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.095 Vali Acc: 0.861 Test Loss: 1.095 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.6860575675964355
Epoch: 49, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.390 Vali Acc: 0.911 Test Loss: 0.390 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.3626511096954346
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.3291497230529785
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.506713390350342
Epoch: 52, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.933 Test Loss: 0.317 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.4440367221832275
Epoch: 53, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.917 Test Loss: 0.449 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.6555731296539307
Epoch: 54, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.387 Vali Acc: 0.933 Test Loss: 0.387 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.863736391067505
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.876 Vali Acc: 0.894 Test Loss: 0.876 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.645236015319824
Epoch: 56, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.837 Vali Acc: 0.900 Test Loss: 0.837 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.434333324432373
Epoch: 1, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.758 Vali Acc: 0.228 Test Loss: 1.758 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 3.859131336212158
Epoch: 2, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.426 Vali Acc: 0.494 Test Loss: 1.426 Test Acc: 0.494
Validation loss decreased (-0.227760 --> -0.494430).  Saving model ...
Epoch: 3 cost time: 3.472038984298706
Epoch: 3, Steps: 12 | Train Loss: 1.516 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.494430 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 3.5974690914154053
Epoch: 4, Steps: 12 | Train Loss: 1.171 Vali Loss: 0.765 Vali Acc: 0.628 Test Loss: 0.765 Test Acc: 0.628
Validation loss decreased (-0.599990 --> -0.627770).  Saving model ...
Epoch: 5 cost time: 3.406848430633545
Epoch: 5, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.755 Vali Acc: 0.644 Test Loss: 0.755 Test Acc: 0.644
Validation loss decreased (-0.627770 --> -0.644437).  Saving model ...
Epoch: 6 cost time: 3.366276264190674
Epoch: 6, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (-0.644437 --> -0.716661).  Saving model ...
Epoch: 7 cost time: 3.5510847568511963
Epoch: 7, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.458 Vali Acc: 0.767 Test Loss: 0.458 Test Acc: 0.767
Validation loss decreased (-0.716661 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 3.9992644786834717
Epoch: 8, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.478 Vali Acc: 0.761 Test Loss: 0.478 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8182971477508545
Epoch: 9, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.495 Vali Acc: 0.767 Test Loss: 0.495 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.922645092010498
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.415 Vali Acc: 0.800 Test Loss: 0.415 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 3.7678871154785156
Epoch: 11, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.340 Vali Acc: 0.817 Test Loss: 0.340 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 3.5959725379943848
Epoch: 12, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 3.9096622467041016
Epoch: 13, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.440 Vali Acc: 0.817 Test Loss: 0.440 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4706571102142334
Epoch: 14, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 3.58872127532959
Epoch: 15, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4606733322143555
Epoch: 16, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.520 Vali Acc: 0.839 Test Loss: 0.520 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838884).  Saving model ...
Epoch: 17 cost time: 3.4060866832733154
Epoch: 17, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 3.6430153846740723
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 19 cost time: 3.232440233230591
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.28808331489563
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.866662 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 3.33178973197937
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.800 Vali Acc: 0.839 Test Loss: 0.800 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3158392906188965
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.722 Vali Acc: 0.878 Test Loss: 0.722 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1834299564361572
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.879 Vali Acc: 0.861 Test Loss: 0.879 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6030213832855225
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.572 Vali Acc: 0.883 Test Loss: 0.572 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.597228765487671
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.953 Vali Acc: 0.856 Test Loss: 0.953 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7214577198028564
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.535 Vali Acc: 0.889 Test Loss: 0.535 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.993112564086914
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
Validation loss decreased (-0.899997 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 3.569032669067383
Epoch: 28, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.73484468460083
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5574944019317627
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.811 Vali Acc: 0.883 Test Loss: 0.811 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.1410086154937744
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.690 Vali Acc: 0.894 Test Loss: 0.690 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2287707328796387
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.540 Vali Acc: 0.894 Test Loss: 0.540 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.4263808727264404
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.374 Vali Acc: 0.933 Test Loss: 0.374 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.2155280113220215
Epoch: 34, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.758 Vali Acc: 0.889 Test Loss: 0.758 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.560662269592285
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.461 Vali Acc: 0.911 Test Loss: 0.461 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.520796298980713
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 3.4440243244171143
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.418 Vali Acc: 0.894 Test Loss: 0.418 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.7260477542877197
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.504878282546997
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.412 Vali Acc: 0.917 Test Loss: 0.412 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.566544532775879
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.906 Test Loss: 0.526 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.692227602005005
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.033 Vali Acc: 0.900 Test Loss: 1.033 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.6408939361572266
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.376 Vali Acc: 0.928 Test Loss: 0.376 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.60579514503479
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.650 Vali Acc: 0.911 Test Loss: 0.650 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.810293436050415
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.555849075317383
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.123 Vali Acc: 0.867 Test Loss: 1.123 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.897639751434326
Epoch: 46, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.417 Vali Acc: 0.928 Test Loss: 0.417 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.576955795288086
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.536863088607788
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.6034789085388184
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8936595916748047
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.49379563331604
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6587412357330322
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5250580310821533
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.313401222229004
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 3.393360137939453
Epoch: 9, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.747746467590332
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.800307273864746
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.7495150566101074
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.021170139312744
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.010437488555908
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.92260479927063
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.9211089611053467
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5973472595214844
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.6915342807769775
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 5106438
model size : 29.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4872517585754395
Epoch: 1, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.573 Vali Acc: 0.461 Test Loss: 1.573 Test Acc: 0.461
Validation loss decreased (inf --> -0.461095).  Saving model ...
Epoch: 2 cost time: 3.863887310028076
Epoch: 2, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.240 Vali Acc: 0.494 Test Loss: 1.240 Test Acc: 0.494
Validation loss decreased (-0.461095 --> -0.494432).  Saving model ...
Epoch: 3 cost time: 3.8335494995117188
Epoch: 3, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.008 Vali Acc: 0.606 Test Loss: 1.008 Test Acc: 0.606
Validation loss decreased (-0.494432 --> -0.605545).  Saving model ...
Epoch: 4 cost time: 3.8844051361083984
Epoch: 4, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.775 Vali Acc: 0.689 Test Loss: 0.775 Test Acc: 0.689
Validation loss decreased (-0.605545 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 4.06504487991333
Epoch: 5, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.602 Vali Acc: 0.744 Test Loss: 0.602 Test Acc: 0.744
Validation loss decreased (-0.688881 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 3.686671495437622
Epoch: 6, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.565 Vali Acc: 0.761 Test Loss: 0.565 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 3.79756760597229
Epoch: 7, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.446 Vali Acc: 0.794 Test Loss: 0.446 Test Acc: 0.794
Validation loss decreased (-0.761105 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 3.6574230194091797
Epoch: 8, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.471 Vali Acc: 0.778 Test Loss: 0.471 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8182694911956787
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.794440 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 3.7837257385253906
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.420 Vali Acc: 0.817 Test Loss: 0.420 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8388009071350098
Epoch: 11, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.394 Vali Acc: 0.822 Test Loss: 0.394 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9408297538757324
Epoch: 12, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.365 Vali Acc: 0.844 Test Loss: 0.365 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 4.424323558807373
Epoch: 13, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.394 Vali Acc: 0.867 Test Loss: 0.394 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 3.975949287414551
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.373 Vali Acc: 0.856 Test Loss: 0.373 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.188565492630005
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 3.972360849380493
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.740239381790161
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.388 Vali Acc: 0.872 Test Loss: 0.388 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872218).  Saving model ...
Epoch: 18 cost time: 3.8729753494262695
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.743931293487549
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 3.4710144996643066
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.778244733810425
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8890321254730225
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 3.8628969192504883
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911107).  Saving model ...
Epoch: 24 cost time: 3.841005563735962
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.817046642303467
Epoch: 25, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.858454942703247
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.760 Vali Acc: 0.861 Test Loss: 0.760 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.438875913619995
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.856506109237671
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.888204574584961
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.482 Vali Acc: 0.878 Test Loss: 0.482 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.771782636642456
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.6754748821258545
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.9066646099090576
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.009664297103882
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 3.899794340133667
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 35 cost time: 3.930569887161255
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.0361011028289795
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.01247763633728
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.8000261783599854
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.7780280113220215
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.561647653579712
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.617487907409668
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.888010263442993
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.8642828464508057
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.038685083389282
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.768444061279297
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.661 Vali Acc: 0.361 Test Loss: 1.661 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 3.600151538848877
Epoch: 2, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.368 Vali Acc: 0.444 Test Loss: 1.368 Test Acc: 0.444
Validation loss decreased (-0.361095 --> -0.444431).  Saving model ...
Epoch: 3 cost time: 3.571748971939087
Epoch: 3, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.127 Vali Acc: 0.550 Test Loss: 1.127 Test Acc: 0.550
Validation loss decreased (-0.444431 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 3.6948695182800293
Epoch: 4, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.890 Vali Acc: 0.628 Test Loss: 0.890 Test Acc: 0.628
Validation loss decreased (-0.549989 --> -0.627769).  Saving model ...
Epoch: 5 cost time: 3.5837440490722656
Epoch: 5, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.692 Vali Acc: 0.722 Test Loss: 0.692 Test Acc: 0.722
Validation loss decreased (-0.627769 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 3.803793430328369
Epoch: 6, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 3.7174441814422607
Epoch: 7, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 3.8217461109161377
Epoch: 8, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6604268550872803
Epoch: 9, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
Validation loss decreased (-0.761106 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 3.757908821105957
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.458 Vali Acc: 0.794 Test Loss: 0.458 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.642698287963867
Epoch: 11, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.488 Vali Acc: 0.806 Test Loss: 0.488 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2384121417999268
Epoch: 12, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1872928142547607
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 3.1467158794403076
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.451 Vali Acc: 0.822 Test Loss: 0.451 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.847790002822876
Epoch: 15, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7946250438690186
Epoch: 16, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 3.770474433898926
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 3.720398187637329
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.360 Vali Acc: 0.856 Test Loss: 0.360 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.549091339111328
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.345 Vali Acc: 0.878 Test Loss: 0.345 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 3.935241937637329
Epoch: 20, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 3.463472366333008
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7638871669769287
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.451077699661255
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.453 Vali Acc: 0.883 Test Loss: 0.453 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6851985454559326
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.408 Vali Acc: 0.894 Test Loss: 0.408 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 25 cost time: 3.875786781311035
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7769484519958496
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.542 Vali Acc: 0.883 Test Loss: 0.542 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8095314502716064
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.629718780517578
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.208 Vali Acc: 0.850 Test Loss: 1.208 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.179043531417847
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.524 Vali Acc: 0.906 Test Loss: 0.524 Test Acc: 0.906
Validation loss decreased (-0.894440 --> -0.905550).  Saving model ...
Epoch: 30 cost time: 3.7313344478607178
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.6862409114837646
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4363656044006348
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.517 Vali Acc: 0.906 Test Loss: 0.517 Test Acc: 0.906
Validation loss decreased (-0.905550 --> -0.905550).  Saving model ...
Epoch: 33 cost time: 3.669171094894409
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.799 Vali Acc: 0.872 Test Loss: 0.799 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5248637199401855
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
Validation loss decreased (-0.905550 --> -0.911107).  Saving model ...
Epoch: 35 cost time: 3.56274151802063
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
Validation loss decreased (-0.911107 --> -0.916662).  Saving model ...
Epoch: 36 cost time: 3.5009210109710693
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.578425407409668
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.906 Test Loss: 0.458 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.87528920173645
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.785942316055298
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.730527639389038
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.911 Test Loss: 0.435 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.6379599571228027
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.7950263023376465
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.163449287414551
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.906 Test Loss: 0.426 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.4157679080963135
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.5284671783447266
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.906 Test Loss: 0.402 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.663955450057983
Epoch: 1, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.692 Vali Acc: 0.306 Test Loss: 1.692 Test Acc: 0.306
Validation loss decreased (inf --> -0.305539).  Saving model ...
Epoch: 2 cost time: 3.930081844329834
Epoch: 2, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.457 Vali Acc: 0.422 Test Loss: 1.457 Test Acc: 0.422
Validation loss decreased (-0.305539 --> -0.422208).  Saving model ...
Epoch: 3 cost time: 4.042322635650635
Epoch: 3, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.239 Vali Acc: 0.483 Test Loss: 1.239 Test Acc: 0.483
Validation loss decreased (-0.422208 --> -0.483321).  Saving model ...
Epoch: 4 cost time: 3.549664258956909
Epoch: 4, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.023 Vali Acc: 0.561 Test Loss: 1.023 Test Acc: 0.561
Validation loss decreased (-0.483321 --> -0.561101).  Saving model ...
Epoch: 5 cost time: 3.664318323135376
Epoch: 5, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.840 Vali Acc: 0.606 Test Loss: 0.840 Test Acc: 0.606
Validation loss decreased (-0.561101 --> -0.605547).  Saving model ...
Epoch: 6 cost time: 3.501234769821167
Epoch: 6, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.690 Vali Acc: 0.689 Test Loss: 0.690 Test Acc: 0.689
Validation loss decreased (-0.605547 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 3.1669130325317383
Epoch: 7, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.630 Vali Acc: 0.683 Test Loss: 0.630 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4013233184814453
Epoch: 8, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (-0.688882 --> -0.716661).  Saving model ...
Epoch: 9 cost time: 3.6648576259613037
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.493 Vali Acc: 0.800 Test Loss: 0.493 Test Acc: 0.800
Validation loss decreased (-0.716661 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 3.9050965309143066
Epoch: 10, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.523 Vali Acc: 0.767 Test Loss: 0.523 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8378942012786865
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.515 Vali Acc: 0.794 Test Loss: 0.515 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.697971820831299
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.921161413192749
Epoch: 13, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.496 Vali Acc: 0.811 Test Loss: 0.496 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 14 cost time: 3.8620963096618652
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4357192516326904
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 3.655229330062866
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.619091749191284
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.567 Vali Acc: 0.817 Test Loss: 0.567 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.06715202331543
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9393186569213867
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8100485801696777
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 3.9249966144561768
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 3.9073991775512695
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.733351707458496
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8327479362487793
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5566234588623047
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 26 cost time: 3.8758349418640137
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.805 Vali Acc: 0.878 Test Loss: 0.805 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877770).  Saving model ...
Epoch: 27 cost time: 4.315789461135864
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.811 Vali Acc: 0.872 Test Loss: 0.811 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.879122257232666
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.710 Vali Acc: 0.900 Test Loss: 0.710 Test Acc: 0.900
Validation loss decreased (-0.877770 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 4.2568488121032715
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7235357761383057
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.861 Test Loss: 0.736 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6768314838409424
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.762 Vali Acc: 0.867 Test Loss: 0.762 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.9968440532684326
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.634988307952881
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.004842281341553
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.883 Test Loss: 0.615 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.003458499908447
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.889 Test Loss: 0.628 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.157938480377197
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.878 Test Loss: 0.631 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.8944921493530273
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.854623317718506
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.724104881286621
Epoch: 1, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.723 Vali Acc: 0.283 Test Loss: 1.723 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 4.136333703994751
Epoch: 2, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.541 Vali Acc: 0.389 Test Loss: 1.541 Test Acc: 0.389
Validation loss decreased (-0.283316 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 3.920713424682617
Epoch: 3, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.305 Vali Acc: 0.483 Test Loss: 1.305 Test Acc: 0.483
Validation loss decreased (-0.388873 --> -0.483320).  Saving model ...
Epoch: 4 cost time: 3.77726149559021
Epoch: 4, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.033 Vali Acc: 0.572 Test Loss: 1.033 Test Acc: 0.572
Validation loss decreased (-0.483320 --> -0.572212).  Saving model ...
Epoch: 5 cost time: 4.197037696838379
Epoch: 5, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.853 Vali Acc: 0.556 Test Loss: 0.853 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.025072813034058
Epoch: 6, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.768 Vali Acc: 0.633 Test Loss: 0.768 Test Acc: 0.633
Validation loss decreased (-0.572212 --> -0.633326).  Saving model ...
Epoch: 7 cost time: 3.754721164703369
Epoch: 7, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.695 Vali Acc: 0.661 Test Loss: 0.695 Test Acc: 0.661
Validation loss decreased (-0.633326 --> -0.661104).  Saving model ...
Epoch: 8 cost time: 3.981261730194092
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.686 Vali Acc: 0.678 Test Loss: 0.686 Test Acc: 0.678
Validation loss decreased (-0.661104 --> -0.677771).  Saving model ...
Epoch: 9 cost time: 3.9717283248901367
Epoch: 9, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.517 Vali Acc: 0.744 Test Loss: 0.517 Test Acc: 0.744
Validation loss decreased (-0.677771 --> -0.744439).  Saving model ...
Epoch: 10 cost time: 4.5354905128479
Epoch: 10, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.530 Vali Acc: 0.739 Test Loss: 0.530 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.333847999572754
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.519 Vali Acc: 0.772 Test Loss: 0.519 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 3.882185697555542
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.477 Vali Acc: 0.789 Test Loss: 0.477 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 13 cost time: 3.8569273948669434
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.490 Vali Acc: 0.811 Test Loss: 0.490 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 14 cost time: 3.7228662967681885
Epoch: 14, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.778087854385376
Epoch: 15, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.499 Vali Acc: 0.817 Test Loss: 0.499 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 16 cost time: 4.09465217590332
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 4.027753114700317
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 3.830477237701416
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 3.934053897857666
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 3.9436490535736084
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 3.7854795455932617
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.918 Vali Acc: 0.828 Test Loss: 0.918 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.067997932434082
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.718548536300659
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.9811604022979736
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.3988237380981445
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.839 Vali Acc: 0.861 Test Loss: 0.839 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.831190586090088
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.877 Vali Acc: 0.850 Test Loss: 0.877 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.674652576446533
Epoch: 27, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.641 Vali Acc: 0.878 Test Loss: 0.641 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 28 cost time: 3.9690768718719482
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.06165075302124
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.423513412475586
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.925 Vali Acc: 0.878 Test Loss: 0.925 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.7496747970581055
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.741 Vali Acc: 0.883 Test Loss: 0.741 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 32 cost time: 3.893501043319702
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.644 Vali Acc: 0.883 Test Loss: 0.644 Test Acc: 0.883
Validation loss decreased (-0.883326 --> -0.883327).  Saving model ...
Epoch: 33 cost time: 3.7765886783599854
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883328).  Saving model ...
Epoch: 34 cost time: 4.232523679733276
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.827 Vali Acc: 0.906 Test Loss: 0.827 Test Acc: 0.906
Validation loss decreased (-0.883328 --> -0.905547).  Saving model ...
Epoch: 35 cost time: 3.948132038116455
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.894 Test Loss: 0.643 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.968414783477783
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.894 Test Loss: 0.639 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.443913698196411
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.894 Test Loss: 0.638 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.5680816173553467
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.718 Vali Acc: 0.894 Test Loss: 0.718 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.8291523456573486
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.172 Vali Acc: 0.889 Test Loss: 1.172 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.293269395828247
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.815 Vali Acc: 0.889 Test Loss: 0.815 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.315915584564209
Epoch: 41, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.888 Vali Acc: 0.900 Test Loss: 0.888 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.0352463722229
Epoch: 42, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.479 Vali Acc: 0.922 Test Loss: 0.479 Test Acc: 0.922
Validation loss decreased (-0.905547 --> -0.922217).  Saving model ...
Epoch: 43 cost time: 4.365088939666748
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.019 Vali Acc: 0.872 Test Loss: 1.019 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.981043577194214
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.150 Vali Acc: 0.856 Test Loss: 1.150 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.9382266998291016
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.396 Vali Acc: 0.844 Test Loss: 1.396 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.8173983097076416
Epoch: 46, Steps: 12 | Train Loss: 0.241 Vali Loss: 1.060 Vali Acc: 0.822 Test Loss: 1.060 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.7737350463867188
Epoch: 47, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.114 Vali Acc: 0.856 Test Loss: 1.114 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.9863061904907227
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.8790223598480225
Epoch: 49, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.660 Vali Acc: 0.883 Test Loss: 0.660 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 4.012519836425781
Epoch: 50, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.231 Vali Acc: 0.878 Test Loss: 1.231 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.9634084701538086
Epoch: 51, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.961 Vali Acc: 0.861 Test Loss: 0.961 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.5800058841705322
Epoch: 52, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.093677759170532
Epoch: 1, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.763 Vali Acc: 0.233 Test Loss: 1.763 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 3.6037871837615967
Epoch: 2, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.531 Vali Acc: 0.367 Test Loss: 1.531 Test Acc: 0.367
Validation loss decreased (-0.233316 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 4.048459529876709
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.123 Vali Acc: 0.628 Test Loss: 1.123 Test Acc: 0.628
Validation loss decreased (-0.366651 --> -0.627767).  Saving model ...
Epoch: 4 cost time: 3.9242167472839355
Epoch: 4, Steps: 12 | Train Loss: 1.117 Vali Loss: 0.796 Vali Acc: 0.694 Test Loss: 0.796 Test Acc: 0.694
Validation loss decreased (-0.627767 --> -0.694436).  Saving model ...
Epoch: 5 cost time: 3.8829164505004883
Epoch: 5, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.775 Vali Acc: 0.600 Test Loss: 0.775 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.001205205917358
Epoch: 6, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.704 Vali Acc: 0.661 Test Loss: 0.704 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.75307297706604
Epoch: 7, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.604 Vali Acc: 0.706 Test Loss: 0.604 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705550).  Saving model ...
Epoch: 8 cost time: 3.929953098297119
Epoch: 8, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
Validation loss decreased (-0.705550 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 3.6830801963806152
Epoch: 9, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.393 Vali Acc: 0.767 Test Loss: 0.393 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766663).  Saving model ...
Epoch: 10 cost time: 3.698896884918213
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.468 Vali Acc: 0.772 Test Loss: 0.468 Test Acc: 0.772
Validation loss decreased (-0.766663 --> -0.772218).  Saving model ...
Epoch: 11 cost time: 3.8261115550994873
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.547 Vali Acc: 0.800 Test Loss: 0.547 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 3.5990517139434814
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 3.335711717605591
Epoch: 13, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 3.7433125972747803
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.444 Vali Acc: 0.828 Test Loss: 0.444 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827773).  Saving model ...
Epoch: 15 cost time: 4.065682411193848
Epoch: 15, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 3.701718330383301
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.404 Vali Acc: 0.844 Test Loss: 0.404 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 17 cost time: 4.148104429244995
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.473 Vali Acc: 0.817 Test Loss: 0.473 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9650681018829346
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8612828254699707
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.862 Vali Acc: 0.828 Test Loss: 0.862 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.701420307159424
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7445802688598633
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.1838836669921875
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 4.139005184173584
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.570 Vali Acc: 0.894 Test Loss: 0.570 Test Acc: 0.894
Validation loss decreased (-0.861105 --> -0.894439).  Saving model ...
Epoch: 24 cost time: 4.4937615394592285
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.694 Vali Acc: 0.883 Test Loss: 0.694 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9992544651031494
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
Validation loss decreased (-0.894439 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 4.185050010681152
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.201671123504639
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 3.882918119430542
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.791 Vali Acc: 0.872 Test Loss: 0.791 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.052425861358643
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.994 Vali Acc: 0.867 Test Loss: 0.994 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.112982511520386
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.323 Vali Acc: 0.856 Test Loss: 1.323 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.037400960922241
Epoch: 31, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.9556081295013428
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.513 Vali Acc: 0.922 Test Loss: 0.513 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.826687812805176
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.928 Test Loss: 0.323 Test Acc: 0.928
Validation loss decreased (-0.922218 --> -0.927775).  Saving model ...
Epoch: 34 cost time: 4.016627073287964
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.959 Vali Acc: 0.889 Test Loss: 0.959 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6778903007507324
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.691 Vali Acc: 0.883 Test Loss: 0.691 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.921245574951172
Epoch: 36, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.540 Vali Acc: 0.939 Test Loss: 0.540 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938883).  Saving model ...
Epoch: 37 cost time: 3.633985757827759
Epoch: 37, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.200 Vali Acc: 0.883 Test Loss: 1.200 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.05828857421875
Epoch: 38, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.3620285987854
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.024956226348877
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
Validation loss decreased (-0.938883 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 4.025529384613037
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.247095584869385
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.402 Vali Acc: 0.933 Test Loss: 0.402 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.869097948074341
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.451 Vali Acc: 0.911 Test Loss: 0.451 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.7424540519714355
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.933 Test Loss: 0.636 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 4.519156455993652
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.560 Vali Acc: 0.933 Test Loss: 0.560 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.145565748214722
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.555 Vali Acc: 0.917 Test Loss: 0.555 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 4.465583801269531
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.917 Test Loss: 0.745 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 4.696946859359741
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.922 Test Loss: 0.623 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 4.2927374839782715
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.520 Vali Acc: 0.917 Test Loss: 0.520 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 4.138093948364258
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.911 Test Loss: 0.858 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.403526306152344
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.735 Vali Acc: 0.244 Test Loss: 1.735 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 3.715280055999756
Epoch: 2, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.357 Vali Acc: 0.572 Test Loss: 1.357 Test Acc: 0.572
Validation loss decreased (-0.244427 --> -0.572209).  Saving model ...
Epoch: 3 cost time: 3.723078489303589
Epoch: 3, Steps: 12 | Train Loss: 1.537 Vali Loss: 0.909 Vali Acc: 0.667 Test Loss: 0.909 Test Acc: 0.667
Validation loss decreased (-0.572209 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 3.6870169639587402
Epoch: 4, Steps: 12 | Train Loss: 1.079 Vali Loss: 0.763 Vali Acc: 0.583 Test Loss: 0.763 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7076377868652344
Epoch: 5, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.733 Vali Acc: 0.661 Test Loss: 0.733 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8285043239593506
Epoch: 6, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.639 Vali Acc: 0.678 Test Loss: 0.639 Test Acc: 0.678
Validation loss decreased (-0.666658 --> -0.677771).  Saving model ...
Epoch: 7 cost time: 3.4012715816497803
Epoch: 7, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (-0.677771 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 3.520775079727173
Epoch: 8, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.481 Vali Acc: 0.772 Test Loss: 0.481 Test Acc: 0.772
Validation loss decreased (-0.722216 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 3.6710288524627686
Epoch: 9, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.400 Vali Acc: 0.800 Test Loss: 0.400 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 10 cost time: 3.954754114151001
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.466 Vali Acc: 0.794 Test Loss: 0.466 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.087483882904053
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 4.041837453842163
Epoch: 12, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.088284015655518
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.104276657104492
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827773).  Saving model ...
Epoch: 15 cost time: 3.5668857097625732
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.685485601425171
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.433 Vali Acc: 0.839 Test Loss: 0.433 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 3.3295035362243652
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.1306774616241455
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.086270570755005
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.955 Vali Acc: 0.817 Test Loss: 0.955 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.033139705657959
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.809 Vali Acc: 0.817 Test Loss: 0.809 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.962000846862793
Epoch: 21, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.809 Vali Acc: 0.806 Test Loss: 0.809 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7126541137695312
Epoch: 22, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844437).  Saving model ...
Epoch: 23 cost time: 3.631204605102539
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.865 Vali Acc: 0.850 Test Loss: 0.865 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849991).  Saving model ...
Epoch: 24 cost time: 3.710174798965454
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.653 Vali Acc: 0.878 Test Loss: 0.653 Test Acc: 0.878
Validation loss decreased (-0.849991 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 4.187858819961548
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.5454113483428955
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8774616718292236
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.808 Vali Acc: 0.867 Test Loss: 0.808 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.9900741577148438
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.662 Vali Acc: 0.878 Test Loss: 0.662 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.7574496269226074
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.705 Vali Acc: 0.911 Test Loss: 0.705 Test Acc: 0.911
Validation loss decreased (-0.877771 --> -0.911104).  Saving model ...
Epoch: 30 cost time: 4.004025220870972
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.566 Vali Acc: 0.906 Test Loss: 0.566 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.884896755218506
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.908 Vali Acc: 0.883 Test Loss: 0.908 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.161141633987427
Epoch: 32, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.290812730789185
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.172 Vali Acc: 0.878 Test Loss: 1.172 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.0345213413238525
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.557 Vali Acc: 0.906 Test Loss: 0.557 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.9249141216278076
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.894 Test Loss: 0.754 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.580324172973633
Epoch: 36, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.904 Vali Acc: 0.889 Test Loss: 0.904 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.6864500045776367
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.457929849624634
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.917 Test Loss: 0.541 Test Acc: 0.917
Validation loss decreased (-0.911104 --> -0.916661).  Saving model ...
Epoch: 39 cost time: 3.4690070152282715
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.804 Vali Acc: 0.889 Test Loss: 0.804 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.9577345848083496
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.911 Test Loss: 0.729 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.982585906982422
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.928 Test Loss: 0.664 Test Acc: 0.928
Validation loss decreased (-0.916661 --> -0.927771).  Saving model ...
Epoch: 42 cost time: 4.240386009216309
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.694 Vali Acc: 0.922 Test Loss: 0.694 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.971874713897705
Epoch: 43, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.032 Vali Acc: 0.861 Test Loss: 1.032 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.004523515701294
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.906 Test Loss: 0.624 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.095267057418823
Epoch: 45, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.761 Vali Acc: 0.917 Test Loss: 0.761 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.9229283332824707
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.889 Test Loss: 0.685 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.359041929244995
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.911 Test Loss: 0.897 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.213679313659668
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.900 Test Loss: 0.910 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.6342668533325195
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.894 Test Loss: 0.885 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 4.02375602722168
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.127 Vali Acc: 0.917 Test Loss: 1.127 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 4.346575975418091
Epoch: 51, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.14455771446228
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.739 Vali Acc: 0.250 Test Loss: 1.739 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 3.411186456680298
Epoch: 2, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.381 Vali Acc: 0.494 Test Loss: 1.381 Test Acc: 0.494
Validation loss decreased (-0.249983 --> -0.494431).  Saving model ...
Epoch: 3 cost time: 3.6157379150390625
Epoch: 3, Steps: 12 | Train Loss: 1.536 Vali Loss: 0.920 Vali Acc: 0.628 Test Loss: 0.920 Test Acc: 0.628
Validation loss decreased (-0.494431 --> -0.627769).  Saving model ...
Epoch: 4 cost time: 3.503262996673584
Epoch: 4, Steps: 12 | Train Loss: 1.148 Vali Loss: 0.743 Vali Acc: 0.656 Test Loss: 0.743 Test Acc: 0.656
Validation loss decreased (-0.627769 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 3.901721477508545
Epoch: 5, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.739 Vali Acc: 0.617 Test Loss: 0.739 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5453433990478516
Epoch: 6, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.661 Vali Acc: 0.683 Test Loss: 0.661 Test Acc: 0.683
Validation loss decreased (-0.655548 --> -0.683327).  Saving model ...
Epoch: 7 cost time: 3.9647443294525146
Epoch: 7, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.599 Vali Acc: 0.728 Test Loss: 0.599 Test Acc: 0.728
Validation loss decreased (-0.683327 --> -0.727772).  Saving model ...
Epoch: 8 cost time: 3.3908841609954834
Epoch: 8, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.467 Vali Acc: 0.772 Test Loss: 0.467 Test Acc: 0.772
Validation loss decreased (-0.727772 --> -0.772218).  Saving model ...
Epoch: 9 cost time: 3.7218570709228516
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.361 Vali Acc: 0.811 Test Loss: 0.361 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811108).  Saving model ...
Epoch: 10 cost time: 4.097842693328857
Epoch: 10, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.441 Vali Acc: 0.767 Test Loss: 0.441 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.687626838684082
Epoch: 11, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.562 Vali Acc: 0.806 Test Loss: 0.562 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.038356065750122
Epoch: 12, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.425 Vali Acc: 0.783 Test Loss: 0.425 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.481231451034546
Epoch: 13, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.404 Vali Acc: 0.817 Test Loss: 0.404 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 3.6824963092803955
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.574 Vali Acc: 0.817 Test Loss: 0.574 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.49630069732666
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.500 Vali Acc: 0.794 Test Loss: 0.500 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6840479373931885
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.394 Vali Acc: 0.844 Test Loss: 0.394 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 3.5967047214508057
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.795498847961426
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.530 Vali Acc: 0.839 Test Loss: 0.530 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.459279775619507
Epoch: 19, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.806 Vali Acc: 0.817 Test Loss: 0.806 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2382936477661133
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.3552732467651367
Epoch: 21, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.820 Vali Acc: 0.811 Test Loss: 0.820 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.384335517883301
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 3.280846118927002
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 3.3692774772644043
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.570803165435791
Epoch: 25, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.396522045135498
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.839 Vali Acc: 0.883 Test Loss: 0.839 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883325).  Saving model ...
Epoch: 27 cost time: 3.675215244293213
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.607 Vali Acc: 0.911 Test Loss: 0.607 Test Acc: 0.911
Validation loss decreased (-0.883325 --> -0.911105).  Saving model ...
Epoch: 28 cost time: 3.5600955486297607
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.226 Vali Acc: 0.883 Test Loss: 1.226 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4757800102233887
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.850 Vali Acc: 0.889 Test Loss: 0.850 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.534266471862793
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.318 Vali Acc: 0.867 Test Loss: 1.318 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.555027723312378
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.732 Vali Acc: 0.889 Test Loss: 0.732 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.78933048248291
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
Validation loss decreased (-0.911105 --> -0.916663).  Saving model ...
Epoch: 33 cost time: 3.7330803871154785
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.7075600624084473
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.393397808074951
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.573 Vali Acc: 0.928 Test Loss: 0.573 Test Acc: 0.928
Validation loss decreased (-0.916663 --> -0.927772).  Saving model ...
Epoch: 36 cost time: 3.670619487762451
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.537 Vali Acc: 0.906 Test Loss: 0.537 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.526865243911743
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.660 Vali Acc: 0.872 Test Loss: 1.660 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4679951667785645
Epoch: 38, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
Validation loss decreased (-0.927772 --> -0.927775).  Saving model ...
Epoch: 39 cost time: 3.504720687866211
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.404 Vali Acc: 0.883 Test Loss: 1.404 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.4171998500823975
Epoch: 40, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.529 Vali Acc: 0.928 Test Loss: 0.529 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.44244122505188
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.520 Vali Acc: 0.883 Test Loss: 1.520 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.2498652935028076
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.267 Vali Acc: 0.878 Test Loss: 1.267 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.42814564704895
Epoch: 43, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.3589673042297363
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.826 Vali Acc: 0.900 Test Loss: 0.826 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.4522125720977783
Epoch: 45, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.902 Vali Acc: 0.883 Test Loss: 0.902 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.294630527496338
Epoch: 46, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.422 Vali Acc: 0.922 Test Loss: 0.422 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.248784065246582
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.123 Vali Acc: 0.872 Test Loss: 1.123 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.273113489151001
Epoch: 48, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.764 Vali Acc: 0.906 Test Loss: 0.764 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.371150016784668
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.969398021697998
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.687507152557373
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8272879123687744
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4891140460968018
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.6657469272613525
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.474733591079712
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 3.8464694023132324
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 3.5659632682800293
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 3.7511963844299316
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 3.6192851066589355
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.508647918701172
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 3.277637481689453
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 3.8230865001678467
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 3.536221981048584
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2827515602111816
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6592698097229004
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5514650344848633
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.875232458114624
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.424255847930908
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4659457206726074
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.6733386516571045
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.565354108810425
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.460156202316284
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 3533574
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.446279764175415
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.595 Vali Acc: 0.428 Test Loss: 1.595 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 3.4137396812438965
Epoch: 2, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.238 Vali Acc: 0.539 Test Loss: 1.238 Test Acc: 0.539
Validation loss decreased (-0.427762 --> -0.538877).  Saving model ...
Epoch: 3 cost time: 3.7281713485717773
Epoch: 3, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.033 Vali Acc: 0.578 Test Loss: 1.033 Test Acc: 0.578
Validation loss decreased (-0.538877 --> -0.577767).  Saving model ...
Epoch: 4 cost time: 4.179592132568359
Epoch: 4, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.849 Vali Acc: 0.661 Test Loss: 0.849 Test Acc: 0.661
Validation loss decreased (-0.577767 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 3.5137014389038086
Epoch: 5, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.635 Vali Acc: 0.744 Test Loss: 0.635 Test Acc: 0.744
Validation loss decreased (-0.661103 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 3.8455653190612793
Epoch: 6, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.526 Vali Acc: 0.750 Test Loss: 0.526 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 3.922435998916626
Epoch: 7, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 3.9378976821899414
Epoch: 8, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 4.025370836257935
Epoch: 9, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 3.80426287651062
Epoch: 10, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.086366415023804
Epoch: 11, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.384 Vali Acc: 0.828 Test Loss: 0.384 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.727112054824829
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 3.767667531967163
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.591 Vali Acc: 0.817 Test Loss: 0.591 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7856128215789795
Epoch: 14, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 4.012870788574219
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.794717311859131
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 4.0607099533081055
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 4.226436376571655
Epoch: 18, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 3.6309752464294434
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 3.691908836364746
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7679443359375
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.500725746154785
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.405 Vali Acc: 0.894 Test Loss: 0.405 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.752427101135254
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.668834924697876
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.0893919467926025
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.579 Vali Acc: 0.894 Test Loss: 0.579 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.496051073074341
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.415 Vali Acc: 0.894 Test Loss: 0.415 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.689326286315918
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 3.6933631896972656
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 29 cost time: 4.127905607223511
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 3.9305031299591064
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.628 Vali Acc: 0.883 Test Loss: 0.628 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.9395482540130615
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.020350217819214
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.9768896102905273
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.465 Vali Acc: 0.906 Test Loss: 0.465 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.7174746990203857
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.6909472942352295
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.7329654693603516
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.817 Vali Acc: 0.856 Test Loss: 0.817 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.7804431915283203
Epoch: 37, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.802 Vali Acc: 0.861 Test Loss: 0.802 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3152456283569336
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (-0.916663 --> -0.927775).  Saving model ...
Epoch: 39 cost time: 3.8208348751068115
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.392051935195923
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.439014196395874
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.7132339477539062
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.2835662364959717
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.5459487438201904
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.5671310424804688
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.767552614212036
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.485140562057495
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.854412078857422
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.422110557556152
Epoch: 1, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.659 Vali Acc: 0.317 Test Loss: 1.659 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 3.876704454421997
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.360 Vali Acc: 0.506 Test Loss: 1.360 Test Acc: 0.506
Validation loss decreased (-0.316650 --> -0.505542).  Saving model ...
Epoch: 3 cost time: 3.859220266342163
Epoch: 3, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.160 Vali Acc: 0.517 Test Loss: 1.160 Test Acc: 0.517
Validation loss decreased (-0.505542 --> -0.516655).  Saving model ...
Epoch: 4 cost time: 3.504950523376465
Epoch: 4, Steps: 12 | Train Loss: 0.921 Vali Loss: 0.971 Vali Acc: 0.606 Test Loss: 0.971 Test Acc: 0.606
Validation loss decreased (-0.516655 --> -0.605546).  Saving model ...
Epoch: 5 cost time: 3.4506354331970215
Epoch: 5, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.734 Vali Acc: 0.722 Test Loss: 0.734 Test Acc: 0.722
Validation loss decreased (-0.605546 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 4.011474609375
Epoch: 6, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 3.712210178375244
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.568 Vali Acc: 0.728 Test Loss: 0.568 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3926217555999756
Epoch: 8, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.495 Vali Acc: 0.778 Test Loss: 0.495 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 3.590327739715576
Epoch: 9, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 3.371197462081909
Epoch: 10, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.528186798095703
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.430 Vali Acc: 0.806 Test Loss: 0.430 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4211714267730713
Epoch: 12, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 3.572840690612793
Epoch: 13, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4243643283843994
Epoch: 14, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 3.4606378078460693
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6754539012908936
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.828859806060791
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 3.921903133392334
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8411946296691895
Epoch: 19, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 3.929037570953369
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 4.223009824752808
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.835207223892212
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 23 cost time: 3.734873056411743
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.158961057662964
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8019731044769287
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.624 Vali Acc: 0.894 Test Loss: 0.624 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894438).  Saving model ...
Epoch: 26 cost time: 4.150691032409668
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.313149690628052
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8720130920410156
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.8542656898498535
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.452 Vali Acc: 0.917 Test Loss: 0.452 Test Acc: 0.917
Validation loss decreased (-0.894438 --> -0.916662).  Saving model ...
Epoch: 30 cost time: 3.8489580154418945
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.630607843399048
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6318373680114746
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.906 Test Loss: 0.451 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5843873023986816
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.906 Test Loss: 0.576 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.7009661197662354
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.906 Test Loss: 0.509 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.8183465003967285
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.894 Test Loss: 0.569 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.6568171977996826
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.4655773639678955
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.532102584838867
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.417 Vali Acc: 0.922 Test Loss: 0.417 Test Acc: 0.922
Validation loss decreased (-0.916662 --> -0.922218).  Saving model ...
Epoch: 39 cost time: 3.543788194656372
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.883 Test Loss: 0.796 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.690361738204956
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.819 Vali Acc: 0.894 Test Loss: 0.819 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.618178606033325
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.4841091632843018
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.465 Vali Acc: 0.906 Test Loss: 0.465 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.483139753341675
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.712 Vali Acc: 0.889 Test Loss: 0.712 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.8135452270507812
Epoch: 44, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.086 Vali Acc: 0.833 Test Loss: 1.086 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.8144655227661133
Epoch: 45, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.665 Vali Acc: 0.878 Test Loss: 0.665 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.716566801071167
Epoch: 46, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.512 Vali Acc: 0.911 Test Loss: 0.512 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.3287241458892822
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.5063562393188477
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.876 Vali Acc: 0.883 Test Loss: 0.876 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.54448127746582
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.746 Vali Acc: 0.256 Test Loss: 1.746 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 3.755798816680908
Epoch: 2, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.478 Vali Acc: 0.372 Test Loss: 1.478 Test Acc: 0.372
Validation loss decreased (-0.255538 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 3.5406954288482666
Epoch: 3, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.252 Vali Acc: 0.439 Test Loss: 1.252 Test Acc: 0.439
Validation loss decreased (-0.372207 --> -0.438876).  Saving model ...
Epoch: 4 cost time: 3.515669107437134
Epoch: 4, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.045 Vali Acc: 0.517 Test Loss: 1.045 Test Acc: 0.517
Validation loss decreased (-0.438876 --> -0.516656).  Saving model ...
Epoch: 5 cost time: 3.3897039890289307
Epoch: 5, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.820 Vali Acc: 0.622 Test Loss: 0.820 Test Acc: 0.622
Validation loss decreased (-0.516656 --> -0.622214).  Saving model ...
Epoch: 6 cost time: 3.4046401977539062
Epoch: 6, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.715 Vali Acc: 0.661 Test Loss: 0.715 Test Acc: 0.661
Validation loss decreased (-0.622214 --> -0.661104).  Saving model ...
Epoch: 7 cost time: 3.5614283084869385
Epoch: 7, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.671 Vali Acc: 0.678 Test Loss: 0.671 Test Acc: 0.678
Validation loss decreased (-0.661104 --> -0.677771).  Saving model ...
Epoch: 8 cost time: 3.6617090702056885
Epoch: 8, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.544 Vali Acc: 0.733 Test Loss: 0.544 Test Acc: 0.733
Validation loss decreased (-0.677771 --> -0.733328).  Saving model ...
Epoch: 9 cost time: 3.579047203063965
Epoch: 9, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
Validation loss decreased (-0.733328 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 3.357248544692993
Epoch: 10, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.523 Vali Acc: 0.778 Test Loss: 0.523 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6459100246429443
Epoch: 11, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.457 Vali Acc: 0.794 Test Loss: 0.457 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 3.6032555103302
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2531776428222656
Epoch: 13, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.555 Vali Acc: 0.794 Test Loss: 0.555 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5856175422668457
Epoch: 14, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.508 Vali Acc: 0.811 Test Loss: 0.508 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811106).  Saving model ...
Epoch: 15 cost time: 3.510958194732666
Epoch: 15, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.491 Vali Acc: 0.811 Test Loss: 0.491 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 16 cost time: 3.725311040878296
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827773).  Saving model ...
Epoch: 17 cost time: 3.472663402557373
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 3.4139695167541504
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.38261342048645
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 3.66442608833313
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5258476734161377
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.844439 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 3.377779960632324
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.611 Vali Acc: 0.889 Test Loss: 0.611 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6074347496032715
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.902 Vali Acc: 0.878 Test Loss: 0.902 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.757098436355591
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.671 Vali Acc: 0.889 Test Loss: 0.671 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.9393839836120605
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.623 Vali Acc: 0.883 Test Loss: 0.623 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.613391160964966
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.8723011016845703
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.883 Test Loss: 0.657 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.78605055809021
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.894 Test Loss: 0.604 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6404342651367188
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.429030656814575
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.716 Vali Acc: 0.894 Test Loss: 0.716 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.578882932662964
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.437 Vali Acc: 0.894 Test Loss: 0.437 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.935640811920166
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.750 Vali Acc: 0.217 Test Loss: 1.750 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 3.1445319652557373
Epoch: 2, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.561 Vali Acc: 0.350 Test Loss: 1.561 Test Acc: 0.350
Validation loss decreased (-0.216649 --> -0.349984).  Saving model ...
Epoch: 3 cost time: 3.1247150897979736
Epoch: 3, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.321 Vali Acc: 0.422 Test Loss: 1.321 Test Acc: 0.422
Validation loss decreased (-0.349984 --> -0.422209).  Saving model ...
Epoch: 4 cost time: 3.390892744064331
Epoch: 4, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.017 Vali Acc: 0.572 Test Loss: 1.017 Test Acc: 0.572
Validation loss decreased (-0.422209 --> -0.572212).  Saving model ...
Epoch: 5 cost time: 3.1320717334747314
Epoch: 5, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.797 Vali Acc: 0.633 Test Loss: 0.797 Test Acc: 0.633
Validation loss decreased (-0.572212 --> -0.633325).  Saving model ...
Epoch: 6 cost time: 3.317831039428711
Epoch: 6, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.754 Vali Acc: 0.644 Test Loss: 0.754 Test Acc: 0.644
Validation loss decreased (-0.633325 --> -0.644437).  Saving model ...
Epoch: 7 cost time: 3.1767404079437256
Epoch: 7, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.723 Vali Acc: 0.678 Test Loss: 0.723 Test Acc: 0.678
Validation loss decreased (-0.644437 --> -0.677771).  Saving model ...
Epoch: 8 cost time: 3.2278401851654053
Epoch: 8, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.530 Vali Acc: 0.733 Test Loss: 0.530 Test Acc: 0.733
Validation loss decreased (-0.677771 --> -0.733328).  Saving model ...
Epoch: 9 cost time: 3.352642059326172
Epoch: 9, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.532 Vali Acc: 0.750 Test Loss: 0.532 Test Acc: 0.750
Validation loss decreased (-0.733328 --> -0.749995).  Saving model ...
Epoch: 10 cost time: 3.4936115741729736
Epoch: 10, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.514 Vali Acc: 0.772 Test Loss: 0.514 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 3.3360588550567627
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 3.6093761920928955
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.471 Vali Acc: 0.767 Test Loss: 0.471 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.353231906890869
Epoch: 13, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.926 Vali Acc: 0.789 Test Loss: 0.926 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.354438066482544
Epoch: 14, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7676286697387695
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.673851490020752
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.459 Vali Acc: 0.817 Test Loss: 0.459 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 17 cost time: 3.6655561923980713
Epoch: 17, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.492 Vali Acc: 0.806 Test Loss: 0.492 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.623446464538574
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822217).  Saving model ...
Epoch: 19 cost time: 3.657953977584839
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.566 Vali Acc: 0.806 Test Loss: 0.566 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7283499240875244
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 3.702125072479248
Epoch: 21, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855551).  Saving model ...
Epoch: 22 cost time: 3.3068628311157227
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2948343753814697
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 3.4215571880340576
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4927947521209717
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.819 Vali Acc: 0.861 Test Loss: 0.819 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3677127361297607
Epoch: 26, Steps: 12 | Train Loss: 0.271 Vali Loss: 1.014 Vali Acc: 0.828 Test Loss: 1.014 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3136730194091797
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.910 Vali Acc: 0.850 Test Loss: 0.910 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4794747829437256
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1905813217163086
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.640 Vali Acc: 0.894 Test Loss: 0.640 Test Acc: 0.894
Validation loss decreased (-0.872217 --> -0.894438).  Saving model ...
Epoch: 30 cost time: 3.3549845218658447
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4612200260162354
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.906 Test Loss: 0.475 Test Acc: 0.906
Validation loss decreased (-0.894438 --> -0.905551).  Saving model ...
Epoch: 32 cost time: 3.3788933753967285
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.883 Test Loss: 0.592 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4692468643188477
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.664 Vali Acc: 0.894 Test Loss: 0.664 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.4537744522094727
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.549 Vali Acc: 0.911 Test Loss: 0.549 Test Acc: 0.911
Validation loss decreased (-0.905551 --> -0.911106).  Saving model ...
Epoch: 35 cost time: 3.470033884048462
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.6553401947021484
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.911106 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 3.5033628940582275
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.911 Test Loss: 0.447 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.44450306892395
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.917 Test Loss: 0.456 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.633796215057373
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.571 Vali Acc: 0.878 Test Loss: 0.571 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.5155484676361084
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.4926352500915527
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.3935999870300293
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.894 Test Loss: 0.612 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.449901819229126
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.872 Test Loss: 0.700 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.6308751106262207
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.889 Test Loss: 0.603 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.5204408168792725
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.369377851486206
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.883 Test Loss: 0.643 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.0589964389801025
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.713 Vali Acc: 0.272 Test Loss: 1.713 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 3.3205788135528564
Epoch: 2, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.523 Vali Acc: 0.378 Test Loss: 1.523 Test Acc: 0.378
Validation loss decreased (-0.272205 --> -0.377763).  Saving model ...
Epoch: 3 cost time: 3.545718193054199
Epoch: 3, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.161 Vali Acc: 0.506 Test Loss: 1.161 Test Acc: 0.506
Validation loss decreased (-0.377763 --> -0.505544).  Saving model ...
Epoch: 4 cost time: 3.6410586833953857
Epoch: 4, Steps: 12 | Train Loss: 1.165 Vali Loss: 0.831 Vali Acc: 0.628 Test Loss: 0.831 Test Acc: 0.628
Validation loss decreased (-0.505544 --> -0.627769).  Saving model ...
Epoch: 5 cost time: 3.7223353385925293
Epoch: 5, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.766 Vali Acc: 0.594 Test Loss: 0.766 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.396878957748413
Epoch: 6, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.704 Vali Acc: 0.656 Test Loss: 0.704 Test Acc: 0.656
Validation loss decreased (-0.627769 --> -0.655549).  Saving model ...
Epoch: 7 cost time: 3.400362491607666
Epoch: 7, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.662 Vali Acc: 0.706 Test Loss: 0.662 Test Acc: 0.706
Validation loss decreased (-0.655549 --> -0.705549).  Saving model ...
Epoch: 8 cost time: 3.5995986461639404
Epoch: 8, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.434 Vali Acc: 0.778 Test Loss: 0.434 Test Acc: 0.778
Validation loss decreased (-0.705549 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 3.350069046020508
Epoch: 9, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.431 Vali Acc: 0.767 Test Loss: 0.431 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4976401329040527
Epoch: 10, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.474 Vali Acc: 0.794 Test Loss: 0.474 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 3.6133649349212646
Epoch: 11, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 3.516489028930664
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 3.4305007457733154
Epoch: 13, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.479 Vali Acc: 0.817 Test Loss: 0.479 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2566301822662354
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827772).  Saving model ...
Epoch: 15 cost time: 3.5577003955841064
Epoch: 15, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 3.489853858947754
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.392 Vali Acc: 0.828 Test Loss: 0.392 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4936110973358154
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 3.59718656539917
Epoch: 18, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.409287929534912
Epoch: 19, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.519 Vali Acc: 0.839 Test Loss: 0.519 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6126463413238525
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 3.9241943359375
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.866661 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 4.06147837638855
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5953691005706787
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.416 Vali Acc: 0.872 Test Loss: 0.416 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7482149600982666
Epoch: 24, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.744 Vali Acc: 0.894 Test Loss: 0.744 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.666964530944824
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.690 Vali Acc: 0.894 Test Loss: 0.690 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.468055009841919
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.662 Vali Acc: 0.894 Test Loss: 0.662 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.720207691192627
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.500 Vali Acc: 0.911 Test Loss: 0.500 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911106).  Saving model ...
Epoch: 28 cost time: 3.6402664184570312
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.586 Vali Acc: 0.894 Test Loss: 0.586 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.727386951446533
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
Validation loss decreased (-0.911106 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 3.5435023307800293
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.667 Vali Acc: 0.911 Test Loss: 0.667 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.690335750579834
Epoch: 31, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.852 Vali Acc: 0.894 Test Loss: 0.852 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5069363117218018
Epoch: 32, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.003 Vali Acc: 0.872 Test Loss: 1.003 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4004905223846436
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.5674867630004883
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.460 Vali Acc: 0.922 Test Loss: 0.460 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922218).  Saving model ...
Epoch: 35 cost time: 3.691311836242676
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.8518564701080322
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
Validation loss decreased (-0.922218 --> -0.927775).  Saving model ...
Epoch: 37 cost time: 3.2455084323883057
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.447 Vali Acc: 0.928 Test Loss: 0.447 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.699028253555298
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.866713047027588
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.927775 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 4.032997131347656
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.468 Vali Acc: 0.911 Test Loss: 0.468 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.7218620777130127
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.104210376739502
Epoch: 42, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.635 Vali Acc: 0.911 Test Loss: 0.635 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.3613057136535645
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.878 Vali Acc: 0.889 Test Loss: 0.878 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.105214357376099
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.933 Test Loss: 0.662 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.066605567932129
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.906 Test Loss: 0.750 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.148011922836304
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.427 Vali Acc: 0.933 Test Loss: 0.427 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 4.388057231903076
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.933 Test Loss: 0.629 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.8601553440093994
Epoch: 48, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.930 Vali Acc: 0.894 Test Loss: 0.930 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.8221073150634766
Epoch: 49, Steps: 12 | Train Loss: 0.034 Vali Loss: 2.084 Vali Acc: 0.844 Test Loss: 2.084 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.458146333694458
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.763 Vali Acc: 0.294 Test Loss: 1.763 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 3.430610179901123
Epoch: 2, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.378 Vali Acc: 0.511 Test Loss: 1.378 Test Acc: 0.511
Validation loss decreased (-0.294427 --> -0.511097).  Saving model ...
Epoch: 3 cost time: 3.4002251625061035
Epoch: 3, Steps: 12 | Train Loss: 1.484 Vali Loss: 0.944 Vali Acc: 0.572 Test Loss: 0.944 Test Acc: 0.572
Validation loss decreased (-0.511097 --> -0.572213).  Saving model ...
Epoch: 4 cost time: 3.5857276916503906
Epoch: 4, Steps: 12 | Train Loss: 1.160 Vali Loss: 0.791 Vali Acc: 0.606 Test Loss: 0.791 Test Acc: 0.606
Validation loss decreased (-0.572213 --> -0.605548).  Saving model ...
Epoch: 5 cost time: 3.502108097076416
Epoch: 5, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.768 Vali Acc: 0.622 Test Loss: 0.768 Test Acc: 0.622
Validation loss decreased (-0.605548 --> -0.622215).  Saving model ...
Epoch: 6 cost time: 3.6412646770477295
Epoch: 6, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.625 Vali Acc: 0.689 Test Loss: 0.625 Test Acc: 0.689
Validation loss decreased (-0.622215 --> -0.688883).  Saving model ...
Epoch: 7 cost time: 3.6939244270324707
Epoch: 7, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.593 Vali Acc: 0.706 Test Loss: 0.593 Test Acc: 0.706
Validation loss decreased (-0.688883 --> -0.705550).  Saving model ...
Epoch: 8 cost time: 3.459092617034912
Epoch: 8, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.425 Vali Acc: 0.783 Test Loss: 0.425 Test Acc: 0.783
Validation loss decreased (-0.705550 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 3.766467332839966
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.451 Vali Acc: 0.789 Test Loss: 0.451 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 3.8857321739196777
Epoch: 10, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.442 Vali Acc: 0.778 Test Loss: 0.442 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7221267223358154
Epoch: 11, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.372 Vali Acc: 0.772 Test Loss: 0.372 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7043542861938477
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.357 Vali Acc: 0.811 Test Loss: 0.357 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811108).  Saving model ...
Epoch: 13 cost time: 3.7997753620147705
Epoch: 13, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.951 Vali Acc: 0.789 Test Loss: 0.951 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9484400749206543
Epoch: 14, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.896 Vali Acc: 0.817 Test Loss: 0.896 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816658).  Saving model ...
Epoch: 15 cost time: 3.601362943649292
Epoch: 15, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.670 Vali Acc: 0.806 Test Loss: 0.670 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.535438299179077
Epoch: 16, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 4.018509149551392
Epoch: 17, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.306 Vali Acc: 0.828 Test Loss: 0.306 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827775).  Saving model ...
Epoch: 18 cost time: 3.6249420642852783
Epoch: 18, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.510 Vali Acc: 0.806 Test Loss: 0.510 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.709115743637085
Epoch: 19, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.539 Vali Acc: 0.817 Test Loss: 0.539 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6359689235687256
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
Validation loss decreased (-0.827775 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 3.5771989822387695
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 3.588482141494751
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.061283826828003
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 3.5113213062286377
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6166164875030518
Epoch: 25, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.801 Vali Acc: 0.894 Test Loss: 0.801 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894436).  Saving model ...
Epoch: 26 cost time: 3.7155940532684326
Epoch: 26, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.757 Vali Acc: 0.889 Test Loss: 0.757 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.375330924987793
Epoch: 27, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.894436 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 3.817251443862915
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.686 Vali Acc: 0.867 Test Loss: 0.686 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4893975257873535
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.620 Vali Acc: 0.883 Test Loss: 0.620 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4537124633789062
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.348 Vali Acc: 0.933 Test Loss: 0.348 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 3.6636087894439697
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.571 Vali Acc: 0.906 Test Loss: 0.571 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5987019538879395
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.488 Vali Acc: 0.911 Test Loss: 0.488 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.7105367183685303
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.944 Test Loss: 0.335 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944441).  Saving model ...
Epoch: 34 cost time: 3.378563642501831
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.903 Vali Acc: 0.900 Test Loss: 0.903 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5722975730895996
Epoch: 35, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.662 Vali Acc: 0.922 Test Loss: 0.662 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.416715621948242
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.939 Test Loss: 0.509 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.702899694442749
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.922 Test Loss: 0.834 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.9120216369628906
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.925041437149048
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.183 Vali Acc: 0.867 Test Loss: 1.183 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.555662155151367
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.508 Vali Acc: 0.928 Test Loss: 0.508 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.889007806777954
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.849 Vali Acc: 0.894 Test Loss: 0.849 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.378174066543579
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.778 Vali Acc: 0.906 Test Loss: 0.778 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.56131911277771
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.375 Vali Acc: 0.922 Test Loss: 0.375 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.868441104888916
Epoch: 1, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.793 Vali Acc: 0.239 Test Loss: 1.793 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 3.5046017169952393
Epoch: 2, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.426 Vali Acc: 0.467 Test Loss: 1.426 Test Acc: 0.467
Validation loss decreased (-0.238871 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 3.1344752311706543
Epoch: 3, Steps: 12 | Train Loss: 1.527 Vali Loss: 0.973 Vali Acc: 0.550 Test Loss: 0.973 Test Acc: 0.550
Validation loss decreased (-0.466652 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 2.989906072616577
Epoch: 4, Steps: 12 | Train Loss: 1.205 Vali Loss: 0.788 Vali Acc: 0.606 Test Loss: 0.788 Test Acc: 0.606
Validation loss decreased (-0.549990 --> -0.605548).  Saving model ...
Epoch: 5 cost time: 3.474808931350708
Epoch: 5, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.743 Vali Acc: 0.622 Test Loss: 0.743 Test Acc: 0.622
Validation loss decreased (-0.605548 --> -0.622215).  Saving model ...
Epoch: 6 cost time: 2.8385915756225586
Epoch: 6, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.655 Vali Acc: 0.694 Test Loss: 0.655 Test Acc: 0.694
Validation loss decreased (-0.622215 --> -0.694438).  Saving model ...
Epoch: 7 cost time: 3.1403696537017822
Epoch: 7, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.652 Vali Acc: 0.694 Test Loss: 0.652 Test Acc: 0.694
Validation loss decreased (-0.694438 --> -0.694438).  Saving model ...
Epoch: 8 cost time: 2.973271131515503
Epoch: 8, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.444 Vali Acc: 0.772 Test Loss: 0.444 Test Acc: 0.772
Validation loss decreased (-0.694438 --> -0.772218).  Saving model ...
Epoch: 9 cost time: 3.3172190189361572
Epoch: 9, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.440 Vali Acc: 0.789 Test Loss: 0.440 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 3.3096373081207275
Epoch: 10, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.264453649520874
Epoch: 11, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.380 Vali Acc: 0.772 Test Loss: 0.380 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.344526529312134
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.365 Vali Acc: 0.806 Test Loss: 0.365 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 3.5016872882843018
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.949 Vali Acc: 0.789 Test Loss: 0.949 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2483105659484863
Epoch: 14, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.880 Vali Acc: 0.817 Test Loss: 0.880 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816658).  Saving model ...
Epoch: 15 cost time: 3.368124008178711
Epoch: 15, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6364333629608154
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.619 Vali Acc: 0.817 Test Loss: 0.619 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 3.5724446773529053
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 3.278449535369873
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.598 Vali Acc: 0.800 Test Loss: 0.598 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7946226596832275
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4764633178710938
Epoch: 20, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 3.3213016986846924
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3796727657318115
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.295919179916382
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.861107 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 3.0800397396087646
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1534855365753174
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4745278358459473
Epoch: 26, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 3.1325795650482178
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.330 Vali Acc: 0.861 Test Loss: 1.330 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.326749086380005
Epoch: 28, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 3.1363372802734375
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.129511594772339
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.443 Vali Acc: 0.906 Test Loss: 0.443 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.256488800048828
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4910895824432373
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.823 Vali Acc: 0.906 Test Loss: 0.823 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.356057643890381
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.427 Vali Acc: 0.917 Test Loss: 0.427 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.586676597595215
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.873 Vali Acc: 0.911 Test Loss: 0.873 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.753289222717285
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.922 Test Loss: 0.529 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.458354949951172
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.699 Vali Acc: 0.906 Test Loss: 0.699 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.4626941680908203
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.678 Vali Acc: 0.928 Test Loss: 0.678 Test Acc: 0.928
Validation loss decreased (-0.922218 --> -0.927771).  Saving model ...
Epoch: 38 cost time: 3.6367502212524414
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.577000617980957
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.5307822227478027
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
Validation loss decreased (-0.927771 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 3.503899335861206
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.928 Test Loss: 0.382 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4590580463409424
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.944 Test Loss: 0.396 Test Acc: 0.944
Validation loss decreased (-0.933329 --> -0.944440).  Saving model ...
Epoch: 43 cost time: 3.269010066986084
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.950 Test Loss: 0.467 Test Acc: 0.950
Validation loss decreased (-0.944440 --> -0.949995).  Saving model ...
Epoch: 44 cost time: 3.3562238216400146
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 45 cost time: 3.4115848541259766
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 3.495457410812378
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.939 Test Loss: 0.368 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4727981090545654
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 3.6049342155456543
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.933 Test Loss: 0.619 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.420957088470459
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.715 Vali Acc: 0.922 Test Loss: 0.715 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.27362322807312
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.928 Test Loss: 0.616 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.2846200466156006
Epoch: 51, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.484 Vali Acc: 0.928 Test Loss: 0.484 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.6269547939300537
Epoch: 52, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.590 Vali Acc: 0.928 Test Loss: 0.590 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.4956202507019043
Epoch: 53, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.543 Vali Acc: 0.939 Test Loss: 0.543 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.7549197673797607
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.600 Vali Acc: 0.911 Test Loss: 0.600 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.4195332527160645
Epoch: 55, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.404 Vali Acc: 0.939 Test Loss: 0.404 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.7984797954559326
Epoch: 56, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.453878402709961
Epoch: 57, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.884790897369385
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.518664836883545
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.263272285461426
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.4650843143463135
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 2.866518259048462
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.365384101867676
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.3379364013671875
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.374894380569458
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 2.9441092014312744
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 3.279557943344116
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 3.2605035305023193
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.499844789505005
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8160367012023926
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 3.5620901584625244
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7191097736358643
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4469690322875977
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 3.536849021911621
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 3.500826835632324
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 3.602339744567871
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6397218704223633
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 3.2444984912872314
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.660759210586548
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2583720684051514
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3984246253967285
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.113018751144409
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.5519192218780518
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.978363513946533
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4082400798797607
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.3592514991760254
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.2043912410736084
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 2747142
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.822466135025024
Epoch: 1, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.588 Vali Acc: 0.311 Test Loss: 1.588 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 3.7123801708221436
Epoch: 2, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
Validation loss decreased (-0.311095 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 3.9476208686828613
Epoch: 3, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.036 Vali Acc: 0.567 Test Loss: 1.036 Test Acc: 0.567
Validation loss decreased (-0.499987 --> -0.566656).  Saving model ...
Epoch: 4 cost time: 3.703237771987915
Epoch: 4, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.856 Vali Acc: 0.650 Test Loss: 0.856 Test Acc: 0.650
Validation loss decreased (-0.566656 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 3.5801260471343994
Epoch: 5, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.696 Vali Acc: 0.694 Test Loss: 0.696 Test Acc: 0.694
Validation loss decreased (-0.649991 --> -0.694437).  Saving model ...
Epoch: 6 cost time: 3.707768201828003
Epoch: 6, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.694437 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 3.9036002159118652
Epoch: 7, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 3.703824996948242
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.444 Vali Acc: 0.811 Test Loss: 0.444 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 3.350513458251953
Epoch: 9, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 3.5431129932403564
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.456 Vali Acc: 0.828 Test Loss: 0.456 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3632924556732178
Epoch: 11, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 3.3603768348693848
Epoch: 12, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3947551250457764
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4968342781066895
Epoch: 14, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.399 Vali Acc: 0.839 Test Loss: 0.399 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.229367733001709
Epoch: 15, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6372852325439453
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 3.217958927154541
Epoch: 17, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.383 Vali Acc: 0.856 Test Loss: 0.383 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.45259428024292
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 3.3691489696502686
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7950968742370605
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 3.399874210357666
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.370 Vali Acc: 0.878 Test Loss: 0.370 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5721499919891357
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 23 cost time: 3.728159189224243
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.456 Vali Acc: 0.894 Test Loss: 0.456 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 24 cost time: 3.575573205947876
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.40238618850708
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8094370365142822
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.545440196990967
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5019397735595703
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.4936373233795166
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.4574570655822754
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.894440 --> -0.911108).  Saving model ...
Epoch: 31 cost time: 3.256108522415161
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.4039652347564697
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 3.2043819427490234
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.186992645263672
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.4502477645874023
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2118849754333496
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2577779293060303
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5890891551971436
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.579146146774292
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.599785327911377
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.5961501598358154
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.3642382621765137
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.199347972869873
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.655 Vali Acc: 0.294 Test Loss: 1.655 Test Acc: 0.294
Validation loss decreased (inf --> -0.294428).  Saving model ...
Epoch: 2 cost time: 3.3946478366851807
Epoch: 2, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.399 Vali Acc: 0.417 Test Loss: 1.399 Test Acc: 0.417
Validation loss decreased (-0.294428 --> -0.416653).  Saving model ...
Epoch: 3 cost time: 3.384063959121704
Epoch: 3, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.416653 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 3.5065319538116455
Epoch: 4, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.960 Vali Acc: 0.583 Test Loss: 0.960 Test Acc: 0.583
Validation loss decreased (-0.499988 --> -0.583324).  Saving model ...
Epoch: 5 cost time: 3.499244213104248
Epoch: 5, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.764 Vali Acc: 0.689 Test Loss: 0.764 Test Acc: 0.689
Validation loss decreased (-0.583324 --> -0.688881).  Saving model ...
Epoch: 6 cost time: 3.4070184230804443
Epoch: 6, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.654 Vali Acc: 0.711 Test Loss: 0.654 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711105).  Saving model ...
Epoch: 7 cost time: 3.300281286239624
Epoch: 7, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.711105 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 3.6489672660827637
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.514 Vali Acc: 0.778 Test Loss: 0.514 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 3.2150168418884277
Epoch: 9, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 10 cost time: 3.7274036407470703
Epoch: 10, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.584982395172119
Epoch: 11, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 3.7399871349334717
Epoch: 12, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.498 Vali Acc: 0.800 Test Loss: 0.498 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.432011365890503
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.381 Vali Acc: 0.794 Test Loss: 0.381 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5633232593536377
Epoch: 14, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.440131902694702
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.783 Vali Acc: 0.794 Test Loss: 0.783 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5341222286224365
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.502 Vali Acc: 0.839 Test Loss: 0.502 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838884).  Saving model ...
Epoch: 17 cost time: 3.673819065093994
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.433 Vali Acc: 0.817 Test Loss: 0.433 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.473658323287964
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 3.6384050846099854
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 3.554929494857788
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 3.4006152153015137
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.383 Vali Acc: 0.844 Test Loss: 0.383 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.59163236618042
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.47788143157959
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.415 Vali Acc: 0.856 Test Loss: 0.415 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.469651222229004
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.573939800262451
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 3.473388433456421
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888885).  Saving model ...
Epoch: 27 cost time: 3.5120432376861572
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 28 cost time: 3.5917062759399414
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.402 Vali Acc: 0.894 Test Loss: 0.402 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 3.4475619792938232
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.411 Vali Acc: 0.894 Test Loss: 0.411 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.410454750061035
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.878 Test Loss: 0.400 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.390214681625366
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 32 cost time: 3.484358310699463
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.659498453140259
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 34 cost time: 3.5076749324798584
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.512153148651123
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.6302454471588135
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.5816800594329834
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.894 Test Loss: 0.407 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.366854190826416
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.894 Test Loss: 0.430 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.5503382682800293
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.894 Test Loss: 0.394 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.587459087371826
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.652700662612915
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911107).  Saving model ...
Epoch: 42 cost time: 3.2741987705230713
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.258105516433716
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.4881539344787598
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.906 Test Loss: 0.405 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.3193397521972656
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.906 Test Loss: 0.437 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.4836995601654053
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.483617067337036
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.2494544982910156
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.106130838394165
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.911107 --> -0.916663).  Saving model ...
Epoch: 50 cost time: 3.888305425643921
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.911 Test Loss: 0.465 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.33743953704834
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.410479784011841
Epoch: 52, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.911 Test Loss: 0.401 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.4382410049438477
Epoch: 53, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.906 Test Loss: 0.441 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.4534332752227783
Epoch: 54, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.906 Test Loss: 0.445 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.584597587585449
Epoch: 55, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.423219919204712
Epoch: 56, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.4160125255584717
Epoch: 57, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.5139243602752686
Epoch: 58, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.906 Test Loss: 0.478 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.4722063541412354
Epoch: 59, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.906 Test Loss: 0.448 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.32478404045105
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.711 Vali Acc: 0.256 Test Loss: 1.711 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 3.583134412765503
Epoch: 2, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.492 Vali Acc: 0.394 Test Loss: 1.492 Test Acc: 0.394
Validation loss decreased (-0.255538 --> -0.394430).  Saving model ...
Epoch: 3 cost time: 3.8814265727996826
Epoch: 3, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.267 Vali Acc: 0.456 Test Loss: 1.267 Test Acc: 0.456
Validation loss decreased (-0.394430 --> -0.455543).  Saving model ...
Epoch: 4 cost time: 3.5400428771972656
Epoch: 4, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.061 Vali Acc: 0.528 Test Loss: 1.061 Test Acc: 0.528
Validation loss decreased (-0.455543 --> -0.527767).  Saving model ...
Epoch: 5 cost time: 3.6203691959381104
Epoch: 5, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.855 Vali Acc: 0.644 Test Loss: 0.855 Test Acc: 0.644
Validation loss decreased (-0.527767 --> -0.644436).  Saving model ...
Epoch: 6 cost time: 3.310133934020996
Epoch: 6, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.771 Vali Acc: 0.661 Test Loss: 0.771 Test Acc: 0.661
Validation loss decreased (-0.644436 --> -0.661103).  Saving model ...
Epoch: 7 cost time: 3.1902880668640137
Epoch: 7, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.614 Vali Acc: 0.728 Test Loss: 0.614 Test Acc: 0.728
Validation loss decreased (-0.661103 --> -0.727772).  Saving model ...
Epoch: 8 cost time: 3.6387906074523926
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 3.5147364139556885
Epoch: 9, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.473 Vali Acc: 0.756 Test Loss: 0.473 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755551).  Saving model ...
Epoch: 10 cost time: 3.5198702812194824
Epoch: 10, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.477 Vali Acc: 0.772 Test Loss: 0.477 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 3.690016984939575
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.437 Vali Acc: 0.794 Test Loss: 0.437 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 3.60621976852417
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.518 Vali Acc: 0.794 Test Loss: 0.518 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6363091468811035
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.473 Vali Acc: 0.806 Test Loss: 0.473 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 3.316824436187744
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.629 Vali Acc: 0.794 Test Loss: 0.629 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2956955432891846
Epoch: 15, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.075 Vali Acc: 0.794 Test Loss: 1.075 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.455406904220581
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 3.407888650894165
Epoch: 17, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6428797245025635
Epoch: 18, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3999626636505127
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6504104137420654
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 21 cost time: 3.5550177097320557
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.507 Vali Acc: 0.839 Test Loss: 0.507 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6726510524749756
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.291480779647827
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 3.4807026386260986
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.791 Vali Acc: 0.828 Test Loss: 0.791 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6139073371887207
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 3.468128204345703
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.628894329071045
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.668 Vali Acc: 0.861 Test Loss: 0.668 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.752626419067383
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.687 Vali Acc: 0.867 Test Loss: 0.687 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866660).  Saving model ...
Epoch: 29 cost time: 3.4021079540252686
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.637 Vali Acc: 0.878 Test Loss: 0.637 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 30 cost time: 3.592590570449829
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3826136589050293
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.652320146560669
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899993).  Saving model ...
Epoch: 33 cost time: 3.390702486038208
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.401860237121582
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.491316556930542
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.945 Vali Acc: 0.850 Test Loss: 0.945 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3393056392669678
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.894 Test Loss: 0.458 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.5682764053344727
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.894 Test Loss: 0.556 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5135977268218994
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.894 Test Loss: 0.545 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.6181554794311523
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.883 Test Loss: 0.547 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.387134552001953
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.894 Test Loss: 0.583 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.671132802963257
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.894 Test Loss: 0.594 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.2560582160949707
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.973023891448975
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.777 Vali Acc: 0.211 Test Loss: 1.777 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 3.174421787261963
Epoch: 2, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.568 Vali Acc: 0.261 Test Loss: 1.568 Test Acc: 0.261
Validation loss decreased (-0.211093 --> -0.261095).  Saving model ...
Epoch: 3 cost time: 3.3659307956695557
Epoch: 3, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.326 Vali Acc: 0.383 Test Loss: 1.326 Test Acc: 0.383
Validation loss decreased (-0.261095 --> -0.383320).  Saving model ...
Epoch: 4 cost time: 3.1986265182495117
Epoch: 4, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.042 Vali Acc: 0.506 Test Loss: 1.042 Test Acc: 0.506
Validation loss decreased (-0.383320 --> -0.505545).  Saving model ...
Epoch: 5 cost time: 3.52370285987854
Epoch: 5, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.801 Vali Acc: 0.611 Test Loss: 0.801 Test Acc: 0.611
Validation loss decreased (-0.505545 --> -0.611103).  Saving model ...
Epoch: 6 cost time: 3.1601741313934326
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.824 Vali Acc: 0.594 Test Loss: 0.824 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5472753047943115
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.658 Vali Acc: 0.683 Test Loss: 0.658 Test Acc: 0.683
Validation loss decreased (-0.611103 --> -0.683327).  Saving model ...
Epoch: 8 cost time: 3.4686079025268555
Epoch: 8, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.591 Vali Acc: 0.711 Test Loss: 0.591 Test Acc: 0.711
Validation loss decreased (-0.683327 --> -0.711105).  Saving model ...
Epoch: 9 cost time: 3.560107469558716
Epoch: 9, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.477 Vali Acc: 0.733 Test Loss: 0.477 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733329).  Saving model ...
Epoch: 10 cost time: 3.904207706451416
Epoch: 10, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.473 Vali Acc: 0.756 Test Loss: 0.473 Test Acc: 0.756
Validation loss decreased (-0.733329 --> -0.755551).  Saving model ...
Epoch: 11 cost time: 3.622408866882324
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.420 Vali Acc: 0.778 Test Loss: 0.420 Test Acc: 0.778
Validation loss decreased (-0.755551 --> -0.777774).  Saving model ...
Epoch: 12 cost time: 3.66860032081604
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.468 Vali Acc: 0.772 Test Loss: 0.468 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4502744674682617
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.488 Vali Acc: 0.794 Test Loss: 0.488 Test Acc: 0.794
Validation loss decreased (-0.777774 --> -0.794440).  Saving model ...
Epoch: 14 cost time: 3.6666178703308105
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.697974920272827
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.079 Vali Acc: 0.778 Test Loss: 1.079 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5471184253692627
Epoch: 16, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.553 Vali Acc: 0.806 Test Loss: 0.553 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805550).  Saving model ...
Epoch: 17 cost time: 3.615997314453125
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 3.637921094894409
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.583603858947754
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5065274238586426
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 3.3608741760253906
Epoch: 21, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.514 Vali Acc: 0.839 Test Loss: 0.514 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 22 cost time: 3.468012571334839
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 3.227729320526123
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.749 Vali Acc: 0.844 Test Loss: 0.749 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2949204444885254
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.766 Vali Acc: 0.811 Test Loss: 0.766 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2614920139312744
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6697075366973877
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 3.3756515979766846
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.654 Vali Acc: 0.867 Test Loss: 0.654 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6229796409606934
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7246618270874023
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6106598377227783
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.38458251953125
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.656 Vali Acc: 0.872 Test Loss: 0.656 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.271665096282959
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.776 Vali Acc: 0.872 Test Loss: 0.776 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.4330902099609375
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.872 Test Loss: 0.687 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.4249207973480225
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.878 Test Loss: 0.698 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.6770057678222656
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.694 Vali Acc: 0.883 Test Loss: 0.694 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.0047507286071777
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.927 Vali Acc: 0.883 Test Loss: 0.927 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.401103258132935
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.785 Vali Acc: 0.228 Test Loss: 1.785 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 3.1969473361968994
Epoch: 2, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.538 Vali Acc: 0.389 Test Loss: 1.538 Test Acc: 0.389
Validation loss decreased (-0.227760 --> -0.388874).  Saving model ...
Epoch: 3 cost time: 3.1657707691192627
Epoch: 3, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.116 Vali Acc: 0.550 Test Loss: 1.116 Test Acc: 0.550
Validation loss decreased (-0.388874 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 3.3817291259765625
Epoch: 4, Steps: 12 | Train Loss: 1.148 Vali Loss: 0.795 Vali Acc: 0.606 Test Loss: 0.795 Test Acc: 0.606
Validation loss decreased (-0.549989 --> -0.605548).  Saving model ...
Epoch: 5 cost time: 3.3153676986694336
Epoch: 5, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.755 Vali Acc: 0.628 Test Loss: 0.755 Test Acc: 0.628
Validation loss decreased (-0.605548 --> -0.627770).  Saving model ...
Epoch: 6 cost time: 3.2947418689727783
Epoch: 6, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.769 Vali Acc: 0.639 Test Loss: 0.769 Test Acc: 0.639
Validation loss decreased (-0.627770 --> -0.638881).  Saving model ...
Epoch: 7 cost time: 3.2472615242004395
Epoch: 7, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.624 Vali Acc: 0.706 Test Loss: 0.624 Test Acc: 0.706
Validation loss decreased (-0.638881 --> -0.705549).  Saving model ...
Epoch: 8 cost time: 3.595677137374878
Epoch: 8, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.521 Vali Acc: 0.744 Test Loss: 0.521 Test Acc: 0.744
Validation loss decreased (-0.705549 --> -0.744439).  Saving model ...
Epoch: 9 cost time: 3.520380973815918
Epoch: 9, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.406 Vali Acc: 0.767 Test Loss: 0.406 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766663).  Saving model ...
Epoch: 10 cost time: 3.691943407058716
Epoch: 10, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6401150226593018
Epoch: 11, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.766663 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 3.8444318771362305
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.410 Vali Acc: 0.783 Test Loss: 0.410 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7153234481811523
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.495 Vali Acc: 0.806 Test Loss: 0.495 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.837310314178467
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.470 Vali Acc: 0.828 Test Loss: 0.470 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.819904327392578
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 1.096 Vali Acc: 0.806 Test Loss: 1.096 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.691878080368042
Epoch: 16, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.384009599685669
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.488 Vali Acc: 0.828 Test Loss: 0.488 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6191329956054688
Epoch: 18, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 3.2180299758911133
Epoch: 19, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.524 Vali Acc: 0.811 Test Loss: 0.524 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6732780933380127
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.532860517501831
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3344173431396484
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.111 Vali Acc: 0.828 Test Loss: 1.111 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4410440921783447
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877773).  Saving model ...
Epoch: 24 cost time: 3.4405572414398193
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6569652557373047
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.877773 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 3.4713728427886963
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.462958812713623
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6623103618621826
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.899996 --> -0.922219).  Saving model ...
Epoch: 29 cost time: 3.6704931259155273
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.639543294906616
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6898255348205566
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.872 Vali Acc: 0.867 Test Loss: 0.872 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4745078086853027
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.591 Vali Acc: 0.906 Test Loss: 0.591 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.117272615432739
Epoch: 33, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927775).  Saving model ...
Epoch: 34 cost time: 3.8687641620635986
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.930 Vali Acc: 0.883 Test Loss: 0.930 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5136709213256836
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.577 Vali Acc: 0.906 Test Loss: 0.577 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.32362961769104
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.658043146133423
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.410 Vali Acc: 0.933 Test Loss: 0.410 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 3.5768258571624756
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.476 Vali Acc: 0.906 Test Loss: 0.476 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.443519115447998
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.496 Vali Acc: 0.928 Test Loss: 0.496 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.263306140899658
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.404989004135132
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4761295318603516
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.899 Vali Acc: 0.883 Test Loss: 0.899 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.1088786125183105
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.616 Vali Acc: 0.917 Test Loss: 0.616 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.2532715797424316
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.911 Vali Acc: 0.883 Test Loss: 0.911 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.3722033500671387
Epoch: 45, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.762 Vali Acc: 0.906 Test Loss: 0.762 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.337284803390503
Epoch: 46, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.375474452972412
Epoch: 47, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.783 Vali Acc: 0.872 Test Loss: 0.783 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.555304050445557
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.740 Vali Acc: 0.272 Test Loss: 1.740 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 3.344067335128784
Epoch: 2, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.374 Vali Acc: 0.544 Test Loss: 1.374 Test Acc: 0.544
Validation loss decreased (-0.272205 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 3.8177316188812256
Epoch: 3, Steps: 12 | Train Loss: 1.503 Vali Loss: 0.940 Vali Acc: 0.583 Test Loss: 0.940 Test Acc: 0.583
Validation loss decreased (-0.544431 --> -0.583324).  Saving model ...
Epoch: 4 cost time: 3.7006921768188477
Epoch: 4, Steps: 12 | Train Loss: 1.130 Vali Loss: 0.774 Vali Acc: 0.628 Test Loss: 0.774 Test Acc: 0.628
Validation loss decreased (-0.583324 --> -0.627770).  Saving model ...
Epoch: 5 cost time: 3.7549896240234375
Epoch: 5, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.776 Vali Acc: 0.633 Test Loss: 0.776 Test Acc: 0.633
Validation loss decreased (-0.627770 --> -0.633326).  Saving model ...
Epoch: 6 cost time: 3.197488784790039
Epoch: 6, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.823 Vali Acc: 0.617 Test Loss: 0.823 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.481074810028076
Epoch: 7, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.534 Vali Acc: 0.744 Test Loss: 0.534 Test Acc: 0.744
Validation loss decreased (-0.633326 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 3.5809011459350586
Epoch: 8, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.535 Vali Acc: 0.767 Test Loss: 0.535 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 3.6572513580322266
Epoch: 9, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.402 Vali Acc: 0.783 Test Loss: 0.402 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 3.3983705043792725
Epoch: 10, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4992735385894775
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 3.442197561264038
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.480 Vali Acc: 0.783 Test Loss: 0.480 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.937314987182617
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.576 Vali Acc: 0.806 Test Loss: 0.576 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.423729658126831
Epoch: 14, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.497 Vali Acc: 0.817 Test Loss: 0.497 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.357218027114868
Epoch: 15, Steps: 12 | Train Loss: 0.305 Vali Loss: 1.039 Vali Acc: 0.806 Test Loss: 1.039 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.739455223083496
Epoch: 16, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827773).  Saving model ...
Epoch: 17 cost time: 3.804490089416504
Epoch: 17, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.582 Vali Acc: 0.817 Test Loss: 0.582 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.03333592414856
Epoch: 18, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 3.761667490005493
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6193125247955322
Epoch: 20, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8762941360473633
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 3.6169381141662598
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.221 Vali Acc: 0.822 Test Loss: 1.221 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5400331020355225
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7241554260253906
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888883).  Saving model ...
Epoch: 25 cost time: 3.6556930541992188
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.655 Vali Acc: 0.856 Test Loss: 0.655 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3902366161346436
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.715 Vali Acc: 0.894 Test Loss: 0.715 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894437).  Saving model ...
Epoch: 27 cost time: 3.467106342315674
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.747 Vali Acc: 0.872 Test Loss: 0.747 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6767101287841797
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.553 Vali Acc: 0.906 Test Loss: 0.553 Test Acc: 0.906
Validation loss decreased (-0.894437 --> -0.905550).  Saving model ...
Epoch: 29 cost time: 3.4425628185272217
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.957 Vali Acc: 0.889 Test Loss: 0.957 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0948996543884277
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.5071752071380615
Epoch: 31, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.620 Vali Acc: 0.928 Test Loss: 0.620 Test Acc: 0.928
Validation loss decreased (-0.905550 --> -0.927772).  Saving model ...
Epoch: 32 cost time: 3.521725654602051
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.650 Vali Acc: 0.917 Test Loss: 0.650 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5858850479125977
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.59883189201355
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.032 Vali Acc: 0.900 Test Loss: 1.032 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6600403785705566
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.811 Vali Acc: 0.889 Test Loss: 0.811 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.383920192718506
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.933 Test Loss: 0.479 Test Acc: 0.933
Validation loss decreased (-0.927772 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 3.5400002002716064
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.906 Test Loss: 0.601 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.719526529312134
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.922 Test Loss: 0.531 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.35103440284729
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.906 Test Loss: 0.582 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.7171826362609863
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.928 Test Loss: 0.525 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.159712314605713
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.928 Test Loss: 0.569 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.413224697113037
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.928 Test Loss: 0.667 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.622462511062622
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.911 Test Loss: 0.807 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.3322393894195557
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.922 Test Loss: 0.569 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.5540223121643066
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.460 Vali Acc: 0.939 Test Loss: 0.460 Test Acc: 0.939
Validation loss decreased (-0.933329 --> -0.938884).  Saving model ...
Epoch: 46 cost time: 3.62958025932312
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.799 Vali Acc: 0.900 Test Loss: 0.799 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.6977226734161377
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.928 Test Loss: 0.611 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.99406099319458
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.529 Vali Acc: 0.933 Test Loss: 0.529 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.7147908210754395
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.413 Vali Acc: 0.944 Test Loss: 0.413 Test Acc: 0.944
Validation loss decreased (-0.938884 --> -0.944440).  Saving model ...
Epoch: 50 cost time: 3.698517084121704
Epoch: 50, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.832 Vali Acc: 0.900 Test Loss: 0.832 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.764261245727539
Epoch: 51, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.944440 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 3.8703956604003906
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.928 Test Loss: 0.635 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.618433713912964
Epoch: 53, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.070 Vali Acc: 0.894 Test Loss: 1.070 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.486994981765747
Epoch: 54, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.519 Vali Acc: 0.878 Test Loss: 1.519 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.7816243171691895
Epoch: 55, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.5422253608703613
Epoch: 56, Steps: 12 | Train Loss: 0.300 Vali Loss: 1.102 Vali Acc: 0.883 Test Loss: 1.102 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.3912739753723145
Epoch: 57, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.103 Vali Acc: 0.850 Test Loss: 1.103 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.595778703689575
Epoch: 58, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.162 Vali Acc: 0.856 Test Loss: 1.162 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.4551174640655518
Epoch: 59, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.621 Vali Acc: 0.928 Test Loss: 0.621 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.172928810119629
Epoch: 60, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.59043550491333
Epoch: 61, Steps: 12 | Train Loss: 0.319 Vali Loss: 1.110 Vali Acc: 0.856 Test Loss: 1.110 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.69291877746582
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.726 Vali Acc: 0.261 Test Loss: 1.726 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 3.7511892318725586
Epoch: 2, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.371 Vali Acc: 0.533 Test Loss: 1.371 Test Acc: 0.533
Validation loss decreased (-0.261094 --> -0.533320).  Saving model ...
Epoch: 3 cost time: 3.9478745460510254
Epoch: 3, Steps: 12 | Train Loss: 1.544 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
Validation loss decreased (-0.533320 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 3.7678864002227783
Epoch: 4, Steps: 12 | Train Loss: 1.161 Vali Loss: 0.799 Vali Acc: 0.611 Test Loss: 0.799 Test Acc: 0.611
Validation loss decreased (-0.599990 --> -0.611103).  Saving model ...
Epoch: 5 cost time: 3.9848053455352783
Epoch: 5, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.822 Vali Acc: 0.600 Test Loss: 0.822 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.914202928543091
Epoch: 6, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.783 Vali Acc: 0.622 Test Loss: 0.783 Test Acc: 0.622
Validation loss decreased (-0.611103 --> -0.622214).  Saving model ...
Epoch: 7 cost time: 3.7367115020751953
Epoch: 7, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (-0.622214 --> -0.716661).  Saving model ...
Epoch: 8 cost time: 3.713275909423828
Epoch: 8, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.716661 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 3.677867889404297
Epoch: 9, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.402 Vali Acc: 0.783 Test Loss: 0.402 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 3.701057195663452
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.497 Vali Acc: 0.767 Test Loss: 0.497 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4323196411132812
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.376 Vali Acc: 0.817 Test Loss: 0.376 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 3.5354368686676025
Epoch: 12, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.433 Vali Acc: 0.794 Test Loss: 0.433 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.972632646560669
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.475 Vali Acc: 0.828 Test Loss: 0.475 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827773).  Saving model ...
Epoch: 14 cost time: 3.910037040710449
Epoch: 14, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.470 Vali Acc: 0.817 Test Loss: 0.470 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.813049793243408
Epoch: 15, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.989 Vali Acc: 0.806 Test Loss: 0.989 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.062434911727905
Epoch: 16, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 3.4962997436523438
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.557281017303467
Epoch: 18, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 3.746168375015259
Epoch: 19, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7746527194976807
Epoch: 20, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 3.4049220085144043
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5127789974212646
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.249 Vali Acc: 0.811 Test Loss: 1.249 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7751753330230713
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 24 cost time: 3.3472023010253906
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6583850383758545
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4956881999969482
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 3.4774603843688965
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.695 Vali Acc: 0.894 Test Loss: 0.695 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894437).  Saving model ...
Epoch: 28 cost time: 4.155038833618164
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.368 Vali Acc: 0.939 Test Loss: 0.368 Test Acc: 0.939
Validation loss decreased (-0.894437 --> -0.938885).  Saving model ...
Epoch: 29 cost time: 4.092014312744141
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.917 Test Loss: 0.514 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5628678798675537
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6082751750946045
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.636 Vali Acc: 0.906 Test Loss: 0.636 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7474422454833984
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.911 Test Loss: 0.559 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.751012086868286
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4132001399993896
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.952 Vali Acc: 0.894 Test Loss: 0.952 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.4542911052703857
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.433 Vali Acc: 0.911 Test Loss: 0.433 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.7730917930603027
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.765 Vali Acc: 0.911 Test Loss: 0.765 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.270148754119873
Epoch: 37, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.651 Vali Acc: 0.917 Test Loss: 0.651 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.182110071182251
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.273 Vali Acc: 0.889 Test Loss: 1.273 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.881096839904785
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.782763957977295
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.5375454425811768
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.7521252632141113
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.7026207447052
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.698254108428955
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6632473468780518
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6144044399261475
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3596909046173096
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4112954139709473
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.354602336883545
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1836884021759033
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2529852390289307
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.41096830368042
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.615835666656494
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 2353926
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.52324104309082
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.666 Vali Acc: 0.311 Test Loss: 1.666 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 3.807417392730713
Epoch: 2, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.325 Vali Acc: 0.494 Test Loss: 1.325 Test Acc: 0.494
Validation loss decreased (-0.311094 --> -0.494431).  Saving model ...
Epoch: 3 cost time: 3.531881332397461
Epoch: 3, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.098 Vali Acc: 0.583 Test Loss: 1.098 Test Acc: 0.583
Validation loss decreased (-0.494431 --> -0.583322).  Saving model ...
Epoch: 4 cost time: 3.5486903190612793
Epoch: 4, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.905 Vali Acc: 0.628 Test Loss: 0.905 Test Acc: 0.628
Validation loss decreased (-0.583322 --> -0.627769).  Saving model ...
Epoch: 5 cost time: 3.7638773918151855
Epoch: 5, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.690 Vali Acc: 0.689 Test Loss: 0.690 Test Acc: 0.689
Validation loss decreased (-0.627769 --> -0.688882).  Saving model ...
Epoch: 6 cost time: 3.550790786743164
Epoch: 6, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.568 Vali Acc: 0.728 Test Loss: 0.568 Test Acc: 0.728
Validation loss decreased (-0.688882 --> -0.727772).  Saving model ...
Epoch: 7 cost time: 3.4510278701782227
Epoch: 7, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.496 Vali Acc: 0.767 Test Loss: 0.496 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 3.578721761703491
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.468 Vali Acc: 0.806 Test Loss: 0.468 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 3.52066707611084
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.442 Vali Acc: 0.806 Test Loss: 0.442 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 3.369722843170166
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.368 Vali Acc: 0.811 Test Loss: 0.368 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 3.85671067237854
Epoch: 11, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.431 Vali Acc: 0.811 Test Loss: 0.431 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1132166385650635
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 3.671543836593628
Epoch: 13, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.406 Vali Acc: 0.839 Test Loss: 0.406 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.816194534301758
Epoch: 14, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 3.46662974357605
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 3.5239906311035156
Epoch: 16, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.392 Vali Acc: 0.839 Test Loss: 0.392 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4366817474365234
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 3.1561179161071777
Epoch: 18, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 3.4192698001861572
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5316712856292725
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2440969944000244
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.741145610809326
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 23 cost time: 3.2060446739196777
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2132954597473145
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 3.504262685775757
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.344 Vali Acc: 0.894 Test Loss: 0.344 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 3.2598090171813965
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 3.5990047454833984
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4755380153656006
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.605319023132324
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.922340154647827
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.391 Vali Acc: 0.906 Test Loss: 0.391 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 31 cost time: 3.6009273529052734
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.209352970123291
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4643688201904297
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.201723575592041
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.878 Test Loss: 0.554 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2544071674346924
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.226579189300537
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.632 Vali Acc: 0.894 Test Loss: 0.632 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.0594284534454346
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.350080966949463
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.351 Vali Acc: 0.906 Test Loss: 0.351 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 39 cost time: 3.402303457260132
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.1530890464782715
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 41 cost time: 3.2760472297668457
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 42 cost time: 2.9296317100524902
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.296373128890991
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.3003835678100586
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.5539472103118896
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.870987892150879
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.7082839012145996
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.633923053741455
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.7219457626342773
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.5790622234344482
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.48464298248291
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.950366735458374
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.713 Vali Acc: 0.261 Test Loss: 1.713 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 3.477560043334961
Epoch: 2, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.449 Vali Acc: 0.439 Test Loss: 1.449 Test Acc: 0.439
Validation loss decreased (-0.261094 --> -0.438874).  Saving model ...
Epoch: 3 cost time: 3.5072455406188965
Epoch: 3, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
Validation loss decreased (-0.438874 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 3.6698837280273438
Epoch: 4, Steps: 12 | Train Loss: 0.921 Vali Loss: 0.993 Vali Acc: 0.578 Test Loss: 0.993 Test Acc: 0.578
Validation loss decreased (-0.466655 --> -0.577768).  Saving model ...
Epoch: 5 cost time: 3.56289005279541
Epoch: 5, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.762 Vali Acc: 0.689 Test Loss: 0.762 Test Acc: 0.689
Validation loss decreased (-0.577768 --> -0.688881).  Saving model ...
Epoch: 6 cost time: 3.61751389503479
Epoch: 6, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.627 Vali Acc: 0.700 Test Loss: 0.627 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699994).  Saving model ...
Epoch: 7 cost time: 3.7328531742095947
Epoch: 7, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
Validation loss decreased (-0.699994 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 3.950526475906372
Epoch: 8, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
Validation loss decreased (-0.749994 --> -0.822217).  Saving model ...
Epoch: 9 cost time: 3.753960371017456
Epoch: 9, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.799738645553589
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.415 Vali Acc: 0.789 Test Loss: 0.415 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4757509231567383
Epoch: 11, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.487 Vali Acc: 0.778 Test Loss: 0.487 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9727325439453125
Epoch: 12, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.407 Vali Acc: 0.800 Test Loss: 0.407 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.587822437286377
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.439 Vali Acc: 0.839 Test Loss: 0.439 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 3.6463730335235596
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7964978218078613
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.0621724128723145
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4181158542633057
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.792600631713867
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.449 Vali Acc: 0.839 Test Loss: 0.449 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4760336875915527
Epoch: 19, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 3.909313917160034
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9136719703674316
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5671463012695312
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 3.445495128631592
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.60766339302063
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7701852321624756
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.866663 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 3.853874444961548
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.649606227874756
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5445902347564697
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.362 Vali Acc: 0.883 Test Loss: 0.362 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.574561595916748
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.7116870880126953
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.484 Vali Acc: 0.894 Test Loss: 0.484 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.5783841609954834
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 3.6362955570220947
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.883 Test Loss: 0.632 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6698179244995117
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.983623743057251
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6389267444610596
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.867 Vali Acc: 0.867 Test Loss: 0.867 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.68396258354187
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.6745474338531494
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.771848440170288
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.8083438873291016
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.4583816528320312
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.894 Test Loss: 0.640 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.646629571914673
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.980123996734619
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.732 Vali Acc: 0.233 Test Loss: 1.732 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 3.738372564315796
Epoch: 2, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.530 Vali Acc: 0.372 Test Loss: 1.530 Test Acc: 0.372
Validation loss decreased (-0.233316 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 3.5856781005859375
Epoch: 3, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.316 Vali Acc: 0.361 Test Loss: 1.316 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.496825695037842
Epoch: 4, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.093 Vali Acc: 0.483 Test Loss: 1.093 Test Acc: 0.483
Validation loss decreased (-0.372207 --> -0.483322).  Saving model ...
Epoch: 5 cost time: 3.7031006813049316
Epoch: 5, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.866 Vali Acc: 0.589 Test Loss: 0.866 Test Acc: 0.589
Validation loss decreased (-0.483322 --> -0.588880).  Saving model ...
Epoch: 6 cost time: 3.452437162399292
Epoch: 6, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.749 Vali Acc: 0.644 Test Loss: 0.749 Test Acc: 0.644
Validation loss decreased (-0.588880 --> -0.644437).  Saving model ...
Epoch: 7 cost time: 3.6347358226776123
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.657 Vali Acc: 0.706 Test Loss: 0.657 Test Acc: 0.706
Validation loss decreased (-0.644437 --> -0.705549).  Saving model ...
Epoch: 8 cost time: 3.5083229541778564
Epoch: 8, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.554 Vali Acc: 0.744 Test Loss: 0.554 Test Acc: 0.744
Validation loss decreased (-0.705549 --> -0.744439).  Saving model ...
Epoch: 9 cost time: 3.9553353786468506
Epoch: 9, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.641057252883911
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.481 Vali Acc: 0.772 Test Loss: 0.481 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 4.091264486312866
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.524 Vali Acc: 0.772 Test Loss: 0.524 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.45542311668396
Epoch: 12, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.506 Vali Acc: 0.794 Test Loss: 0.506 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794439).  Saving model ...
Epoch: 13 cost time: 3.7164359092712402
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.514 Vali Acc: 0.811 Test Loss: 0.514 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 14 cost time: 3.41184401512146
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.466 Vali Acc: 0.794 Test Loss: 0.466 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.497731924057007
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.526 Vali Acc: 0.817 Test Loss: 0.526 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816661).  Saving model ...
Epoch: 16 cost time: 3.732398748397827
Epoch: 16, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.514 Vali Acc: 0.817 Test Loss: 0.514 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816662).  Saving model ...
Epoch: 17 cost time: 3.2174718379974365
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.455 Vali Acc: 0.806 Test Loss: 0.455 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5629513263702393
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.545 Vali Acc: 0.806 Test Loss: 0.545 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6527538299560547
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.517 Vali Acc: 0.800 Test Loss: 0.517 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8329992294311523
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
Validation loss decreased (-0.816662 --> -0.844440).  Saving model ...
Epoch: 21 cost time: 4.073177814483643
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.711045026779175
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 23 cost time: 4.132101535797119
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 3.398090124130249
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8395965099334717
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 3.994410514831543
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5597283840179443
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8070898056030273
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.647213935852051
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.4304451942443848
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 3.636007308959961
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.906 Test Loss: 0.568 Test Acc: 0.906
Validation loss decreased (-0.877773 --> -0.905550).  Saving model ...
Epoch: 32 cost time: 3.3365068435668945
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.889 Test Loss: 0.636 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.621255874633789
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.480154514312744
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.530458927154541
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.764 Vali Acc: 0.878 Test Loss: 0.764 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.7985548973083496
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.5906450748443604
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
Validation loss decreased (-0.905550 --> -0.911107).  Saving model ...
Epoch: 38 cost time: 3.835707187652588
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.582 Vali Acc: 0.906 Test Loss: 0.582 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.292433977127075
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.7955119609832764
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.906 Test Loss: 0.687 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.5600619316101074
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.610 Vali Acc: 0.883 Test Loss: 0.610 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.9941368103027344
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.4633896350860596
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.906 Test Loss: 0.641 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.9816741943359375
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.906 Test Loss: 0.545 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.8337550163269043
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.883 Test Loss: 0.544 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.7906343936920166
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.6284842491149902
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.906 Test Loss: 0.549 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.519058465957642
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.734 Vali Acc: 0.256 Test Loss: 1.734 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 3.529646873474121
Epoch: 2, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.562 Vali Acc: 0.361 Test Loss: 1.562 Test Acc: 0.361
Validation loss decreased (-0.255538 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 3.5971574783325195
Epoch: 3, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.302 Vali Acc: 0.483 Test Loss: 1.302 Test Acc: 0.483
Validation loss decreased (-0.361095 --> -0.483320).  Saving model ...
Epoch: 4 cost time: 3.766435384750366
Epoch: 4, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.046 Vali Acc: 0.556 Test Loss: 1.046 Test Acc: 0.556
Validation loss decreased (-0.483320 --> -0.555545).  Saving model ...
Epoch: 5 cost time: 4.185250520706177
Epoch: 5, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.824 Vali Acc: 0.583 Test Loss: 0.824 Test Acc: 0.583
Validation loss decreased (-0.555545 --> -0.583325).  Saving model ...
Epoch: 6 cost time: 3.7531700134277344
Epoch: 6, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.773 Vali Acc: 0.589 Test Loss: 0.773 Test Acc: 0.589
Validation loss decreased (-0.583325 --> -0.588881).  Saving model ...
Epoch: 7 cost time: 4.061785459518433
Epoch: 7, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
Validation loss decreased (-0.588881 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 3.919142007827759
Epoch: 8, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.565 Vali Acc: 0.728 Test Loss: 0.565 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 9 cost time: 4.361873626708984
Epoch: 9, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7799224853515625
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.539 Vali Acc: 0.761 Test Loss: 0.539 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 3.8072402477264404
Epoch: 11, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.578 Vali Acc: 0.733 Test Loss: 0.578 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.223267078399658
Epoch: 12, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.571 Vali Acc: 0.778 Test Loss: 0.571 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777772).  Saving model ...
Epoch: 13 cost time: 3.5583553314208984
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788883).  Saving model ...
Epoch: 14 cost time: 4.168112754821777
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.471 Vali Acc: 0.806 Test Loss: 0.471 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805551).  Saving model ...
Epoch: 15 cost time: 4.449644565582275
Epoch: 15, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8839235305786133
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.543 Vali Acc: 0.817 Test Loss: 0.543 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 3.9583187103271484
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.597 Vali Acc: 0.778 Test Loss: 0.597 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.05875563621521
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.225980281829834
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.475 Vali Acc: 0.794 Test Loss: 0.475 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6468074321746826
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.681 Vali Acc: 0.806 Test Loss: 0.681 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6561992168426514
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.740 Vali Acc: 0.806 Test Loss: 0.740 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.4857823848724365
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.816661 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 3.557861804962158
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 3.5363142490386963
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 25 cost time: 3.404353618621826
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5403988361358643
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.640 Vali Acc: 0.867 Test Loss: 0.640 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 27 cost time: 3.995119333267212
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.760 Vali Acc: 0.844 Test Loss: 0.760 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.715954303741455
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.751 Vali Acc: 0.839 Test Loss: 0.751 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4473648071289062
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.733 Vali Acc: 0.839 Test Loss: 0.733 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.63316011428833
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 3.6118054389953613
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 32 cost time: 3.481600522994995
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.528 Vali Acc: 0.883 Test Loss: 0.528 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 33 cost time: 3.490417003631592
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 34 cost time: 3.7866721153259277
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.587667226791382
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.878 Test Loss: 0.548 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.9555864334106445
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 37 cost time: 3.8064510822296143
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.488 Vali Acc: 0.894 Test Loss: 0.488 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 38 cost time: 3.556389331817627
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.593 Vali Acc: 0.889 Test Loss: 0.593 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.101964950561523
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.5748846530914307
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.409 Vali Acc: 0.894 Test Loss: 0.409 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 3.726492166519165
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.894 Test Loss: 0.392 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 42 cost time: 3.60537052154541
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.894 Test Loss: 0.782 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.4108238220214844
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.536 Vali Acc: 0.917 Test Loss: 0.536 Test Acc: 0.917
Validation loss decreased (-0.894441 --> -0.916661).  Saving model ...
Epoch: 44 cost time: 3.5568394660949707
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.4702415466308594
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.684 Vali Acc: 0.883 Test Loss: 0.684 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.7789156436920166
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.950 Vali Acc: 0.900 Test Loss: 0.950 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.756026029586792
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.547 Vali Acc: 0.906 Test Loss: 0.547 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.746016502380371
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.914558172225952
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.963 Vali Acc: 0.894 Test Loss: 0.963 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.842561960220337
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 4.323617696762085
Epoch: 51, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.163 Vali Acc: 0.844 Test Loss: 1.163 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 4.0808424949646
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.761 Vali Acc: 0.900 Test Loss: 0.761 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.4838836193084717
Epoch: 53, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.894 Test Loss: 0.649 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.923927545547485
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.772 Vali Acc: 0.161 Test Loss: 1.772 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 3.122319221496582
Epoch: 2, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.538 Vali Acc: 0.400 Test Loss: 1.538 Test Acc: 0.400
Validation loss decreased (-0.161093 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 3.4483225345611572
Epoch: 3, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.103 Vali Acc: 0.622 Test Loss: 1.103 Test Acc: 0.622
Validation loss decreased (-0.399985 --> -0.622211).  Saving model ...
Epoch: 4 cost time: 3.5629982948303223
Epoch: 4, Steps: 12 | Train Loss: 1.144 Vali Loss: 0.782 Vali Acc: 0.622 Test Loss: 0.782 Test Acc: 0.622
Validation loss decreased (-0.622211 --> -0.622214).  Saving model ...
Epoch: 5 cost time: 3.570117473602295
Epoch: 5, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.749 Vali Acc: 0.661 Test Loss: 0.749 Test Acc: 0.661
Validation loss decreased (-0.622214 --> -0.661104).  Saving model ...
Epoch: 6 cost time: 3.5267133712768555
Epoch: 6, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.705 Vali Acc: 0.661 Test Loss: 0.705 Test Acc: 0.661
Validation loss decreased (-0.661104 --> -0.661104).  Saving model ...
Epoch: 7 cost time: 3.2187728881835938
Epoch: 7, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (-0.661104 --> -0.716661).  Saving model ...
Epoch: 8 cost time: 3.587329149246216
Epoch: 8, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.465 Vali Acc: 0.772 Test Loss: 0.465 Test Acc: 0.772
Validation loss decreased (-0.716661 --> -0.772218).  Saving model ...
Epoch: 9 cost time: 3.34295916557312
Epoch: 9, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.551 Vali Acc: 0.750 Test Loss: 0.551 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3929476737976074
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.434 Vali Acc: 0.783 Test Loss: 0.434 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 3.4368202686309814
Epoch: 11, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.473 Vali Acc: 0.778 Test Loss: 0.473 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4979002475738525
Epoch: 12, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.480 Vali Acc: 0.806 Test Loss: 0.480 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 3.0914101600646973
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2221217155456543
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.488 Vali Acc: 0.811 Test Loss: 0.488 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 15 cost time: 3.4514732360839844
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.486 Vali Acc: 0.800 Test Loss: 0.486 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.684922695159912
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 17 cost time: 3.467785358428955
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.475 Vali Acc: 0.811 Test Loss: 0.475 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6101856231689453
Epoch: 18, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.852 Vali Acc: 0.817 Test Loss: 0.852 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6864051818847656
Epoch: 19, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.649 Vali Acc: 0.828 Test Loss: 0.649 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827771).  Saving model ...
Epoch: 20 cost time: 3.549733877182007
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855551).  Saving model ...
Epoch: 21 cost time: 3.1246304512023926
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3108561038970947
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0143492221832275
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.324216604232788
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.2475366592407227
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.130871057510376
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
Validation loss decreased (-0.855551 --> -0.894441).  Saving model ...
Epoch: 27 cost time: 3.3680198192596436
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.983 Vali Acc: 0.839 Test Loss: 0.983 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3867931365966797
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.831 Vali Acc: 0.872 Test Loss: 0.831 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.528083562850952
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.833 Vali Acc: 0.861 Test Loss: 0.833 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6813178062438965
Epoch: 30, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.007 Vali Acc: 0.861 Test Loss: 1.007 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.4797825813293457
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.603 Vali Acc: 0.894 Test Loss: 0.603 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.6105666160583496
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.381701946258545
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.3005921840667725
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.922 Test Loss: 0.508 Test Acc: 0.922
Validation loss decreased (-0.894441 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 3.4592623710632324
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.894 Test Loss: 0.654 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2692949771881104
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.493 Vali Acc: 0.911 Test Loss: 0.493 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.390638589859009
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.366 Vali Acc: 0.956 Test Loss: 0.366 Test Acc: 0.956
Validation loss decreased (-0.922217 --> -0.955552).  Saving model ...
Epoch: 38 cost time: 3.6966235637664795
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.587 Vali Acc: 0.928 Test Loss: 0.587 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.520979881286621
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.944 Test Loss: 0.363 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.358581304550171
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.767 Vali Acc: 0.906 Test Loss: 0.767 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.7800352573394775
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.663 Vali Acc: 0.922 Test Loss: 0.663 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4384241104125977
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.503 Vali Acc: 0.922 Test Loss: 0.503 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.4858968257904053
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.911 Test Loss: 0.593 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.3834619522094727
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.434 Vali Acc: 0.933 Test Loss: 0.434 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.3852813243865967
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.520 Vali Acc: 0.917 Test Loss: 0.520 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.372415065765381
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.512 Vali Acc: 0.917 Test Loss: 0.512 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.362962007522583
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.743 Vali Acc: 0.900 Test Loss: 0.743 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.7897679805755615
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.782 Vali Acc: 0.206 Test Loss: 1.782 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 3.6192398071289062
Epoch: 2, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.413 Vali Acc: 0.483 Test Loss: 1.413 Test Acc: 0.483
Validation loss decreased (-0.205538 --> -0.483319).  Saving model ...
Epoch: 3 cost time: 3.875133752822876
Epoch: 3, Steps: 12 | Train Loss: 1.557 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
Validation loss decreased (-0.483319 --> -0.622213).  Saving model ...
Epoch: 4 cost time: 3.715291976928711
Epoch: 4, Steps: 12 | Train Loss: 1.113 Vali Loss: 0.807 Vali Acc: 0.606 Test Loss: 0.807 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8486127853393555
Epoch: 5, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.804 Vali Acc: 0.600 Test Loss: 0.804 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.48520565032959
Epoch: 6, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.716 Vali Acc: 0.656 Test Loss: 0.716 Test Acc: 0.656
Validation loss decreased (-0.622213 --> -0.655548).  Saving model ...
Epoch: 7 cost time: 3.2531323432922363
Epoch: 7, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
Validation loss decreased (-0.655548 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 3.6022276878356934
Epoch: 8, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.458 Vali Acc: 0.772 Test Loss: 0.458 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772218).  Saving model ...
Epoch: 9 cost time: 3.502168893814087
Epoch: 9, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3617281913757324
Epoch: 10, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 3.6591944694519043
Epoch: 11, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.492 Vali Acc: 0.772 Test Loss: 0.492 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.674590826034546
Epoch: 12, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5695011615753174
Epoch: 13, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.496 Vali Acc: 0.806 Test Loss: 0.496 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 3.4875845909118652
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4886693954467773
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.603476047515869
Epoch: 16, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.630 Vali Acc: 0.811 Test Loss: 0.630 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 3.3948709964752197
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 3.208872079849243
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.731 Vali Acc: 0.822 Test Loss: 0.731 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3663556575775146
Epoch: 19, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.452 Vali Acc: 0.839 Test Loss: 0.452 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838884).  Saving model ...
Epoch: 20 cost time: 3.3335659503936768
Epoch: 20, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.321481943130493
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 3.411639928817749
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 3.7166054248809814
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.394 Vali Acc: 0.856 Test Loss: 0.394 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 3.6293015480041504
Epoch: 24, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866659).  Saving model ...
Epoch: 25 cost time: 3.584160804748535
Epoch: 25, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.037 Vali Acc: 0.833 Test Loss: 1.037 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5678133964538574
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.866659 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 3.6920297145843506
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.081 Vali Acc: 0.844 Test Loss: 1.081 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7181038856506348
Epoch: 28, Steps: 12 | Train Loss: 0.305 Vali Loss: 1.047 Vali Acc: 0.872 Test Loss: 1.047 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.17315411567688
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.309706449508667
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.876 Vali Acc: 0.844 Test Loss: 0.876 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.147169351577759
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 3.22994327545166
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.557 Vali Acc: 0.894 Test Loss: 0.557 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.552581787109375
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.3300139904022217
Epoch: 34, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.411 Vali Acc: 0.917 Test Loss: 0.411 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.282630205154419
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.504 Vali Acc: 0.911 Test Loss: 0.504 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.636188507080078
Epoch: 36, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.6823859214782715
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.567 Vali Acc: 0.911 Test Loss: 0.567 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.4671730995178223
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.946 Vali Acc: 0.867 Test Loss: 0.946 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.407987594604492
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.550 Vali Acc: 0.894 Test Loss: 0.550 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.1908774375915527
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.594 Vali Acc: 0.917 Test Loss: 0.594 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.3551135063171387
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.791 Vali Acc: 0.883 Test Loss: 0.791 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.899805545806885
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.809 Vali Acc: 0.256 Test Loss: 1.809 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 3.389939308166504
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.452 Vali Acc: 0.439 Test Loss: 1.452 Test Acc: 0.439
Validation loss decreased (-0.255537 --> -0.438874).  Saving model ...
Epoch: 3 cost time: 3.561600923538208
Epoch: 3, Steps: 12 | Train Loss: 1.572 Vali Loss: 0.990 Vali Acc: 0.572 Test Loss: 0.990 Test Acc: 0.572
Validation loss decreased (-0.438874 --> -0.572212).  Saving model ...
Epoch: 4 cost time: 3.683157444000244
Epoch: 4, Steps: 12 | Train Loss: 1.173 Vali Loss: 0.782 Vali Acc: 0.600 Test Loss: 0.782 Test Acc: 0.600
Validation loss decreased (-0.572212 --> -0.599992).  Saving model ...
Epoch: 5 cost time: 3.45243763923645
Epoch: 5, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.784 Vali Acc: 0.617 Test Loss: 0.784 Test Acc: 0.617
Validation loss decreased (-0.599992 --> -0.616659).  Saving model ...
Epoch: 6 cost time: 3.744666814804077
Epoch: 6, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.714 Vali Acc: 0.661 Test Loss: 0.714 Test Acc: 0.661
Validation loss decreased (-0.616659 --> -0.661104).  Saving model ...
Epoch: 7 cost time: 3.526156425476074
Epoch: 7, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.590 Vali Acc: 0.744 Test Loss: 0.590 Test Acc: 0.744
Validation loss decreased (-0.661104 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 3.542243480682373
Epoch: 8, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.439 Vali Acc: 0.772 Test Loss: 0.439 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772218).  Saving model ...
Epoch: 9 cost time: 3.626142978668213
Epoch: 9, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.536 Vali Acc: 0.756 Test Loss: 0.536 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.60300612449646
Epoch: 10, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.415 Vali Acc: 0.811 Test Loss: 0.415 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 3.6202032566070557
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.464 Vali Acc: 0.761 Test Loss: 0.464 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.517089605331421
Epoch: 12, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.495 Vali Acc: 0.794 Test Loss: 0.495 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9054338932037354
Epoch: 13, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.504 Vali Acc: 0.794 Test Loss: 0.504 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.142240524291992
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 3.8245773315429688
Epoch: 15, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.519 Vali Acc: 0.806 Test Loss: 0.519 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9284002780914307
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.625 Vali Acc: 0.811 Test Loss: 0.625 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8054606914520264
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.430 Vali Acc: 0.839 Test Loss: 0.430 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 3.5212507247924805
Epoch: 18, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.830 Vali Acc: 0.822 Test Loss: 0.830 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3659489154815674
Epoch: 19, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6093149185180664
Epoch: 20, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 21 cost time: 3.6628239154815674
Epoch: 21, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.461 Vali Acc: 0.839 Test Loss: 0.461 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.587984323501587
Epoch: 22, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 23 cost time: 3.639554500579834
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.833968162536621
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.195711612701416
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7827656269073486
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.855551 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 3.968508005142212
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.759 Vali Acc: 0.878 Test Loss: 0.759 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.457216739654541
Epoch: 28, Steps: 12 | Train Loss: 0.224 Vali Loss: 1.080 Vali Acc: 0.867 Test Loss: 1.080 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2599546909332275
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.651 Vali Acc: 0.894 Test Loss: 0.651 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.340131998062134
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.733 Vali Acc: 0.900 Test Loss: 0.733 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1734302043914795
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 3.3629229068756104
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.621 Vali Acc: 0.906 Test Loss: 0.621 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1747875213623047
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.666 Vali Acc: 0.883 Test Loss: 0.666 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.296760320663452
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.774 Vali Acc: 0.878 Test Loss: 0.774 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.441805839538574
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.634 Vali Acc: 0.906 Test Loss: 0.634 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.339543342590332
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.570894479751587
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.370 Vali Acc: 0.928 Test Loss: 0.370 Test Acc: 0.928
Validation loss decreased (-0.911107 --> -0.927774).  Saving model ...
Epoch: 38 cost time: 3.4773290157318115
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.971 Vali Acc: 0.878 Test Loss: 0.971 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.3996596336364746
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.484 Vali Acc: 0.922 Test Loss: 0.484 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.511659860610962
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.433 Vali Acc: 0.928 Test Loss: 0.433 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.2083868980407715
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.684 Vali Acc: 0.906 Test Loss: 0.684 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.70621657371521
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
Validation loss decreased (-0.927774 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 3.544029474258423
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.5936570167541504
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.906 Test Loss: 0.602 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.6420986652374268
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.881 Vali Acc: 0.911 Test Loss: 0.881 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.384009838104248
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.911 Test Loss: 0.734 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.3950934410095215
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.928 Test Loss: 0.483 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.492670774459839
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.948 Vali Acc: 0.900 Test Loss: 0.948 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.6606850624084473
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.944 Test Loss: 0.485 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.452440023422241
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.922 Test Loss: 0.464 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.546269655227661
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.928 Test Loss: 0.533 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.5184123516082764
Epoch: 52, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.933 Test Loss: 0.487 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.48077392578125
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.4454152584075928
Epoch: 2, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.199187994003296
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4150328636169434
Epoch: 4, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6295993328094482
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.058866500854492
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.120088577270508
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.84799861907959
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.73828125
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.7616074085235596
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.776989459991455
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 2157318
model size : 18.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.976872682571411
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.694 Vali Acc: 0.322 Test Loss: 1.694 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 3.529334783554077
Epoch: 2, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.395 Vali Acc: 0.494 Test Loss: 1.395 Test Acc: 0.494
Validation loss decreased (-0.322205 --> -0.494430).  Saving model ...
Epoch: 3 cost time: 3.6025545597076416
Epoch: 3, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.174 Vali Acc: 0.533 Test Loss: 1.174 Test Acc: 0.533
Validation loss decreased (-0.494430 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 3.8361754417419434
Epoch: 4, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.017 Vali Acc: 0.611 Test Loss: 1.017 Test Acc: 0.611
Validation loss decreased (-0.533322 --> -0.611101).  Saving model ...
Epoch: 5 cost time: 3.6908044815063477
Epoch: 5, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.839 Vali Acc: 0.633 Test Loss: 0.839 Test Acc: 0.633
Validation loss decreased (-0.611101 --> -0.633325).  Saving model ...
Epoch: 6 cost time: 3.522691011428833
Epoch: 6, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.722 Vali Acc: 0.700 Test Loss: 0.722 Test Acc: 0.700
Validation loss decreased (-0.633325 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 3.8018691539764404
Epoch: 7, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.576 Vali Acc: 0.772 Test Loss: 0.576 Test Acc: 0.772
Validation loss decreased (-0.699993 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 3.2669918537139893
Epoch: 8, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.572 Vali Acc: 0.794 Test Loss: 0.572 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 3.3718831539154053
Epoch: 9, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.451 Vali Acc: 0.789 Test Loss: 0.451 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.296882152557373
Epoch: 10, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.448 Vali Acc: 0.783 Test Loss: 0.448 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4304490089416504
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.436 Vali Acc: 0.800 Test Loss: 0.436 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 3.4715561866760254
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 3.651538610458374
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 3.6754677295684814
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.475 Vali Acc: 0.811 Test Loss: 0.475 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.943297863006592
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 3.5896377563476562
Epoch: 16, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9930214881896973
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1287641525268555
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 19 cost time: 3.5957963466644287
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5261919498443604
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.445 Vali Acc: 0.828 Test Loss: 0.445 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.403078079223633
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.254 Vali Acc: 0.867 Test Loss: 0.254 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 22 cost time: 3.5971477031707764
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7020370960235596
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 24 cost time: 3.812089681625366
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 3.6444778442382812
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.878 Test Loss: 0.248 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.444089889526367
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 3.9908249378204346
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 3.2172675132751465
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5942001342773438
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.663045883178711
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.8123137950897217
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6076347827911377
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.518560886383057
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.700859785079956
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.594762086868286
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.9525094032287598
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 3.526702404022217
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 3.3718905448913574
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.52670955657959
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.761948823928833
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.6515591144561768
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.7484328746795654
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.6172986030578613
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.5120232105255127
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.773226261138916
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 46 cost time: 3.407783031463623
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.7710633277893066
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.5112249851226807
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 49 cost time: 3.6652746200561523
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.4206953048706055
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.328822135925293
Epoch: 51, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.5095601081848145
Epoch: 52, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.668877601623535
Epoch: 53, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.027 Vali Acc: 0.828 Test Loss: 1.027 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.8301758766174316
Epoch: 54, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.365 Vali Acc: 0.894 Test Loss: 0.365 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.777294635772705
Epoch: 55, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 56 cost time: 3.9822981357574463
Epoch: 56, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.674898147583008
Epoch: 57, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.441851854324341
Epoch: 58, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.8394815921783447
Epoch: 59, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.401 Vali Acc: 0.878 Test Loss: 0.401 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.1435039043426514
Epoch: 60, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.9680440425872803
Epoch: 61, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.6454317569732666
Epoch: 62, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.493295907974243
Epoch: 63, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.7322726249694824
Epoch: 64, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.7339155673980713
Epoch: 65, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.050059795379639
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.739 Vali Acc: 0.283 Test Loss: 1.739 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 3.520813226699829
Epoch: 2, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.523 Vali Acc: 0.406 Test Loss: 1.523 Test Acc: 0.406
Validation loss decreased (-0.283316 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 3.8701155185699463
Epoch: 3, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.331 Vali Acc: 0.456 Test Loss: 1.331 Test Acc: 0.456
Validation loss decreased (-0.405540 --> -0.455542).  Saving model ...
Epoch: 4 cost time: 3.482229709625244
Epoch: 4, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.170 Vali Acc: 0.522 Test Loss: 1.170 Test Acc: 0.522
Validation loss decreased (-0.455542 --> -0.522211).  Saving model ...
Epoch: 5 cost time: 4.316955089569092
Epoch: 5, Steps: 12 | Train Loss: 0.918 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.522211 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 4.390192747116089
Epoch: 6, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.873 Vali Acc: 0.628 Test Loss: 0.873 Test Acc: 0.628
Validation loss decreased (-0.599990 --> -0.627769).  Saving model ...
Epoch: 7 cost time: 3.8772122859954834
Epoch: 7, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.706 Vali Acc: 0.706 Test Loss: 0.706 Test Acc: 0.706
Validation loss decreased (-0.627769 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 4.0579750537872314
Epoch: 8, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 3.850855827331543
Epoch: 9, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 3.710148572921753
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.505 Vali Acc: 0.778 Test Loss: 0.505 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 11 cost time: 3.9080090522766113
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.505 Vali Acc: 0.772 Test Loss: 0.505 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8774185180664062
Epoch: 12, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 3.4960811138153076
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.401 Vali Acc: 0.794 Test Loss: 0.401 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.453040838241577
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.480 Vali Acc: 0.800 Test Loss: 0.480 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.004858732223511
Epoch: 15, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.387 Vali Acc: 0.811 Test Loss: 0.387 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.619035005569458
Epoch: 16, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.55656361579895
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 3.8608713150024414
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 3.833672046661377
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.363 Vali Acc: 0.839 Test Loss: 0.363 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.932662010192871
Epoch: 20, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.442 Vali Acc: 0.817 Test Loss: 0.442 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.730560541152954
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 3.616697072982788
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6198947429656982
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.640582799911499
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8403007984161377
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6894500255584717
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.6904847621917725
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 4.169286251068115
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.9210383892059326
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.7215070724487305
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.435391426086426
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.5231456756591797
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.427332878112793
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.308 Vali Acc: 0.878 Test Loss: 0.308 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.6901817321777344
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.727900505065918
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.540611743927002
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.837251663208008
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.894 Test Loss: 0.357 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.54818320274353
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.785 Vali Acc: 0.239 Test Loss: 1.785 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 3.6729700565338135
Epoch: 2, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.631 Vali Acc: 0.289 Test Loss: 1.631 Test Acc: 0.289
Validation loss decreased (-0.238871 --> -0.288873).  Saving model ...
Epoch: 3 cost time: 3.412539005279541
Epoch: 3, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.474 Vali Acc: 0.383 Test Loss: 1.474 Test Acc: 0.383
Validation loss decreased (-0.288873 --> -0.383319).  Saving model ...
Epoch: 4 cost time: 3.37255597114563
Epoch: 4, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.325 Vali Acc: 0.428 Test Loss: 1.325 Test Acc: 0.428
Validation loss decreased (-0.383319 --> -0.427765).  Saving model ...
Epoch: 5 cost time: 3.4081366062164307
Epoch: 5, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.166 Vali Acc: 0.461 Test Loss: 1.166 Test Acc: 0.461
Validation loss decreased (-0.427765 --> -0.461099).  Saving model ...
Epoch: 6 cost time: 3.656149387359619
Epoch: 6, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.022 Vali Acc: 0.539 Test Loss: 1.022 Test Acc: 0.539
Validation loss decreased (-0.461099 --> -0.538879).  Saving model ...
Epoch: 7 cost time: 3.4781882762908936
Epoch: 7, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.846 Vali Acc: 0.617 Test Loss: 0.846 Test Acc: 0.617
Validation loss decreased (-0.538879 --> -0.616658).  Saving model ...
Epoch: 8 cost time: 3.997962474822998
Epoch: 8, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.783 Vali Acc: 0.656 Test Loss: 0.783 Test Acc: 0.656
Validation loss decreased (-0.616658 --> -0.655548).  Saving model ...
Epoch: 9 cost time: 3.652937412261963
Epoch: 9, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.639 Vali Acc: 0.683 Test Loss: 0.639 Test Acc: 0.683
Validation loss decreased (-0.655548 --> -0.683327).  Saving model ...
Epoch: 10 cost time: 3.866867780685425
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (-0.683327 --> -0.716661).  Saving model ...
Epoch: 11 cost time: 4.009222745895386
Epoch: 11, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.583 Vali Acc: 0.728 Test Loss: 0.583 Test Acc: 0.728
Validation loss decreased (-0.716661 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 3.487088918685913
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.506 Vali Acc: 0.750 Test Loss: 0.506 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749995).  Saving model ...
Epoch: 13 cost time: 3.4575130939483643
Epoch: 13, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.464 Vali Acc: 0.772 Test Loss: 0.464 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 14 cost time: 3.8824942111968994
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.559 Vali Acc: 0.767 Test Loss: 0.559 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.67861270904541
Epoch: 15, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 16 cost time: 3.5942234992980957
Epoch: 16, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6125829219818115
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 18 cost time: 3.588327169418335
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 3.7124576568603516
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.487 Vali Acc: 0.839 Test Loss: 0.487 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838884).  Saving model ...
Epoch: 20 cost time: 3.825319528579712
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.428 Vali Acc: 0.817 Test Loss: 0.428 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.068793058395386
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.908668041229248
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 23 cost time: 4.44640326499939
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 24 cost time: 3.948011875152588
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8292298316955566
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9310219287872314
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 27 cost time: 3.878183126449585
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 28 cost time: 3.5487515926361084
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.688838481903076
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6307480335235596
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.418 Vali Acc: 0.872 Test Loss: 0.418 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.418485403060913
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6623313426971436
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
Validation loss decreased (-0.877774 --> -0.905552).  Saving model ...
Epoch: 33 cost time: 3.0694994926452637
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.387 Vali Acc: 0.906 Test Loss: 0.387 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 34 cost time: 3.4731712341308594
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.168499231338501
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3579626083374023
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.509514331817627
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911107).  Saving model ...
Epoch: 38 cost time: 3.817182779312134
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.922 Test Loss: 0.368 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 3.8426411151885986
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.5307133197784424
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.555 Vali Acc: 0.894 Test Loss: 0.555 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.751591205596924
Epoch: 41, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.471198320388794
Epoch: 42, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.5089879035949707
Epoch: 43, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.574852466583252
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.6494410037994385
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.8624916076660156
Epoch: 46, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.8224663734436035
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 4.089150667190552
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.226691722869873
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.789 Vali Acc: 0.178 Test Loss: 1.789 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 3.3765149116516113
Epoch: 2, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.684 Vali Acc: 0.294 Test Loss: 1.684 Test Acc: 0.294
Validation loss decreased (-0.177760 --> -0.294428).  Saving model ...
Epoch: 3 cost time: 3.1904730796813965
Epoch: 3, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.562 Vali Acc: 0.306 Test Loss: 1.562 Test Acc: 0.306
Validation loss decreased (-0.294428 --> -0.305540).  Saving model ...
Epoch: 4 cost time: 3.327191114425659
Epoch: 4, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.431 Vali Acc: 0.361 Test Loss: 1.431 Test Acc: 0.361
Validation loss decreased (-0.305540 --> -0.361097).  Saving model ...
Epoch: 5 cost time: 3.462881565093994
Epoch: 5, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.249 Vali Acc: 0.433 Test Loss: 1.249 Test Acc: 0.433
Validation loss decreased (-0.361097 --> -0.433321).  Saving model ...
Epoch: 6 cost time: 3.50803542137146
Epoch: 6, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.047 Vali Acc: 0.522 Test Loss: 1.047 Test Acc: 0.522
Validation loss decreased (-0.433321 --> -0.522212).  Saving model ...
Epoch: 7 cost time: 3.541386365890503
Epoch: 7, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.847 Vali Acc: 0.578 Test Loss: 0.847 Test Acc: 0.578
Validation loss decreased (-0.522212 --> -0.577769).  Saving model ...
Epoch: 8 cost time: 3.6326591968536377
Epoch: 8, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.825 Vali Acc: 0.611 Test Loss: 0.825 Test Acc: 0.611
Validation loss decreased (-0.577769 --> -0.611103).  Saving model ...
Epoch: 9 cost time: 3.9555933475494385
Epoch: 9, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.697 Vali Acc: 0.661 Test Loss: 0.697 Test Acc: 0.661
Validation loss decreased (-0.611103 --> -0.661104).  Saving model ...
Epoch: 10 cost time: 3.560230016708374
Epoch: 10, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.578 Vali Acc: 0.750 Test Loss: 0.578 Test Acc: 0.750
Validation loss decreased (-0.661104 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 3.362619161605835
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.594 Vali Acc: 0.728 Test Loss: 0.594 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.390225648880005
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.592 Vali Acc: 0.744 Test Loss: 0.592 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6620662212371826
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.464 Vali Acc: 0.756 Test Loss: 0.464 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755551).  Saving model ...
Epoch: 14 cost time: 3.6233248710632324
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.608 Vali Acc: 0.767 Test Loss: 0.608 Test Acc: 0.767
Validation loss decreased (-0.755551 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 3.888150930404663
Epoch: 15, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.526 Vali Acc: 0.778 Test Loss: 0.526 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 4.073138236999512
Epoch: 16, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.411 Vali Acc: 0.806 Test Loss: 0.411 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 3.729248523712158
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.417 Vali Acc: 0.800 Test Loss: 0.417 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7793309688568115
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822217).  Saving model ...
Epoch: 19 cost time: 3.5104188919067383
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.532 Vali Acc: 0.811 Test Loss: 0.532 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1485495567321777
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.496 Vali Acc: 0.806 Test Loss: 0.496 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.376481533050537
Epoch: 21, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 3.566544771194458
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6373164653778076
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855551).  Saving model ...
Epoch: 24 cost time: 3.6817474365234375
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.756786584854126
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 3.389488935470581
Epoch: 26, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 3.791541337966919
Epoch: 27, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.494 Vali Acc: 0.839 Test Loss: 0.494 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.600135326385498
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 29 cost time: 3.1933438777923584
Epoch: 29, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.555981397628784
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.4237098693847656
Epoch: 31, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 3.5340940952301025
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6967663764953613
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.390 Vali Acc: 0.872 Test Loss: 0.390 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.4278831481933594
Epoch: 34, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.900350332260132
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.6867408752441406
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.690 Vali Acc: 0.872 Test Loss: 0.690 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.528608798980713
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.4756503105163574
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.400 Vali Acc: 0.878 Test Loss: 0.400 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.36946964263916
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922219).  Saving model ...
Epoch: 40 cost time: 3.331566333770752
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.457 Vali Acc: 0.894 Test Loss: 0.457 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.136489152908325
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.6563549041748047
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.6285440921783447
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.8582613468170166
Epoch: 44, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.864 Vali Acc: 0.872 Test Loss: 0.864 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.5991365909576416
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.652 Vali Acc: 0.878 Test Loss: 0.652 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.880333662033081
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.8022544384002686
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.7054219245910645
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.894 Test Loss: 0.402 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.4433038234710693
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.650056838989258
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.824 Vali Acc: 0.256 Test Loss: 1.824 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 3.7657835483551025
Epoch: 2, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.728 Vali Acc: 0.294 Test Loss: 1.728 Test Acc: 0.294
Validation loss decreased (-0.255537 --> -0.294427).  Saving model ...
Epoch: 3 cost time: 3.7067902088165283
Epoch: 3, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.594 Vali Acc: 0.394 Test Loss: 1.594 Test Acc: 0.394
Validation loss decreased (-0.294427 --> -0.394429).  Saving model ...
Epoch: 4 cost time: 3.547581434249878
Epoch: 4, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.403 Vali Acc: 0.450 Test Loss: 1.403 Test Acc: 0.450
Validation loss decreased (-0.394429 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 3.8424038887023926
Epoch: 5, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.086 Vali Acc: 0.567 Test Loss: 1.086 Test Acc: 0.567
Validation loss decreased (-0.449986 --> -0.566656).  Saving model ...
Epoch: 6 cost time: 3.2701053619384766
Epoch: 6, Steps: 12 | Train Loss: 1.078 Vali Loss: 0.810 Vali Acc: 0.594 Test Loss: 0.810 Test Acc: 0.594
Validation loss decreased (-0.566656 --> -0.594436).  Saving model ...
Epoch: 7 cost time: 3.332946300506592
Epoch: 7, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.700 Vali Acc: 0.611 Test Loss: 0.700 Test Acc: 0.611
Validation loss decreased (-0.594436 --> -0.611104).  Saving model ...
Epoch: 8 cost time: 3.2585196495056152
Epoch: 8, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.623 Vali Acc: 0.683 Test Loss: 0.623 Test Acc: 0.683
Validation loss decreased (-0.611104 --> -0.683327).  Saving model ...
Epoch: 9 cost time: 3.421285629272461
Epoch: 9, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.561 Vali Acc: 0.672 Test Loss: 0.561 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6552069187164307
Epoch: 10, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.449 Vali Acc: 0.761 Test Loss: 0.449 Test Acc: 0.761
Validation loss decreased (-0.683327 --> -0.761107).  Saving model ...
Epoch: 11 cost time: 3.816225528717041
Epoch: 11, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.553 Vali Acc: 0.739 Test Loss: 0.553 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7061657905578613
Epoch: 12, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.472 Vali Acc: 0.761 Test Loss: 0.472 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7196755409240723
Epoch: 13, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.414 Vali Acc: 0.789 Test Loss: 0.414 Test Acc: 0.789
Validation loss decreased (-0.761107 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 3.645669460296631
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 3.4262146949768066
Epoch: 15, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.483 Vali Acc: 0.794 Test Loss: 0.483 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3032970428466797
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.394 Vali Acc: 0.794 Test Loss: 0.394 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3318352699279785
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.377 Vali Acc: 0.794 Test Loss: 0.377 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4161994457244873
Epoch: 18, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 3.444342613220215
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 3.9533133506774902
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.522 Vali Acc: 0.817 Test Loss: 0.522 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6221230030059814
Epoch: 21, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 3.773125648498535
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.47483229637146
Epoch: 23, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.499 Vali Acc: 0.811 Test Loss: 0.499 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.9847183227539062
Epoch: 24, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 3.229952573776245
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 3.3287034034729004
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 3.107311248779297
Epoch: 27, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.398 Vali Acc: 0.839 Test Loss: 0.398 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3974368572235107
Epoch: 28, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 3.4435322284698486
Epoch: 29, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 30 cost time: 3.309328079223633
Epoch: 30, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3607351779937744
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.877774 --> -0.911109).  Saving model ...
Epoch: 32 cost time: 3.2126307487487793
Epoch: 32, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.698 Vali Acc: 0.867 Test Loss: 0.698 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3739171028137207
Epoch: 33, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.9818530082702637
Epoch: 34, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.4507787227630615
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.224220037460327
Epoch: 36, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.43780779838562
Epoch: 37, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.8493504524230957
Epoch: 38, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.7845146656036377
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.599745512008667
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.5057575702667236
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.410 Vali Acc: 0.878 Test Loss: 0.410 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3711113929748535
Epoch: 1, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.810 Vali Acc: 0.167 Test Loss: 1.810 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.3669192790985107
Epoch: 2, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.704 Vali Acc: 0.283 Test Loss: 1.704 Test Acc: 0.283
Validation loss decreased (-0.166649 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 3.4969751834869385
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.516 Vali Acc: 0.389 Test Loss: 1.516 Test Acc: 0.389
Validation loss decreased (-0.283316 --> -0.388874).  Saving model ...
Epoch: 4 cost time: 3.317911148071289
Epoch: 4, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.229 Vali Acc: 0.528 Test Loss: 1.229 Test Acc: 0.528
Validation loss decreased (-0.388874 --> -0.527765).  Saving model ...
Epoch: 5 cost time: 3.4909608364105225
Epoch: 5, Steps: 12 | Train Loss: 1.362 Vali Loss: 0.917 Vali Acc: 0.633 Test Loss: 0.917 Test Acc: 0.633
Validation loss decreased (-0.527765 --> -0.633324).  Saving model ...
Epoch: 6 cost time: 3.515080213546753
Epoch: 6, Steps: 12 | Train Loss: 1.104 Vali Loss: 0.746 Vali Acc: 0.650 Test Loss: 0.746 Test Acc: 0.650
Validation loss decreased (-0.633324 --> -0.649993).  Saving model ...
Epoch: 7 cost time: 3.6461167335510254
Epoch: 7, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.689 Vali Acc: 0.667 Test Loss: 0.689 Test Acc: 0.667
Validation loss decreased (-0.649993 --> -0.666660).  Saving model ...
Epoch: 8 cost time: 3.7724759578704834
Epoch: 8, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.613 Vali Acc: 0.689 Test Loss: 0.613 Test Acc: 0.689
Validation loss decreased (-0.666660 --> -0.688883).  Saving model ...
Epoch: 9 cost time: 3.508711576461792
Epoch: 9, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.549 Vali Acc: 0.700 Test Loss: 0.549 Test Acc: 0.700
Validation loss decreased (-0.688883 --> -0.699995).  Saving model ...
Epoch: 10 cost time: 3.7322351932525635
Epoch: 10, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.464 Vali Acc: 0.783 Test Loss: 0.464 Test Acc: 0.783
Validation loss decreased (-0.699995 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 3.5219953060150146
Epoch: 11, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.500 Vali Acc: 0.728 Test Loss: 0.500 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.610945224761963
Epoch: 12, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.478 Vali Acc: 0.783 Test Loss: 0.478 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.593722105026245
Epoch: 13, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.396 Vali Acc: 0.789 Test Loss: 0.396 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 3.5093600749969482
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.479 Vali Acc: 0.811 Test Loss: 0.479 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811106).  Saving model ...
Epoch: 15 cost time: 3.6544268131256104
Epoch: 15, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.773083448410034
Epoch: 16, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.378 Vali Acc: 0.789 Test Loss: 0.378 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.026623010635376
Epoch: 17, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.675001859664917
Epoch: 18, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.368 Vali Acc: 0.806 Test Loss: 0.368 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7195332050323486
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.446 Vali Acc: 0.789 Test Loss: 0.446 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4188120365142822
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.570 Vali Acc: 0.806 Test Loss: 0.570 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5225558280944824
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 3.7768616676330566
Epoch: 22, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5894131660461426
Epoch: 23, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8438901901245117
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 3.8413376808166504
Epoch: 25, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.452 Vali Acc: 0.828 Test Loss: 0.452 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.817877769470215
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 27 cost time: 3.6841137409210205
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.552 Vali Acc: 0.817 Test Loss: 0.552 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.337224245071411
Epoch: 28, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.5332179069519043
Epoch: 29, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7189853191375732
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.5782415866851807
Epoch: 31, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.866663 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 4.00597882270813
Epoch: 32, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.081974506378174
Epoch: 33, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.68424916267395
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6984896659851074
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.702399492263794
Epoch: 36, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.4510445594787598
Epoch: 37, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.076336622238159
Epoch: 38, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.6085851192474365
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 3.723442554473877
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.958137035369873
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.3700766563415527
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.2999978065490723
Epoch: 43, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.394678831100464
Epoch: 44, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.261 Vali Acc: 0.939 Test Loss: 0.261 Test Acc: 0.939
Validation loss decreased (-0.916665 --> -0.938886).  Saving model ...
Epoch: 45 cost time: 3.399695634841919
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.5698556900024414
Epoch: 46, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.8791282176971436
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.819518566131592
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.5835862159729004
Epoch: 49, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.3680710792541504
Epoch: 50, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.2337708473205566
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.9370059967041016
Epoch: 52, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.911 Test Loss: 0.330 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.733577251434326
Epoch: 53, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.6538634300231934
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.012438058853149
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.824 Vali Acc: 0.189 Test Loss: 1.824 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.60441517829895
Epoch: 2, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.721 Vali Acc: 0.278 Test Loss: 1.721 Test Acc: 0.278
Validation loss decreased (-0.188871 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 3.410122871398926
Epoch: 3, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.533 Vali Acc: 0.444 Test Loss: 1.533 Test Acc: 0.444
Validation loss decreased (-0.277761 --> -0.444429).  Saving model ...
Epoch: 4 cost time: 3.6446149349212646
Epoch: 4, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.241 Vali Acc: 0.556 Test Loss: 1.241 Test Acc: 0.556
Validation loss decreased (-0.444429 --> -0.555543).  Saving model ...
Epoch: 5 cost time: 3.643059015274048
Epoch: 5, Steps: 12 | Train Loss: 1.402 Vali Loss: 0.936 Vali Acc: 0.628 Test Loss: 0.936 Test Acc: 0.628
Validation loss decreased (-0.555543 --> -0.627768).  Saving model ...
Epoch: 6 cost time: 3.5137953758239746
Epoch: 6, Steps: 12 | Train Loss: 1.126 Vali Loss: 0.752 Vali Acc: 0.633 Test Loss: 0.752 Test Acc: 0.633
Validation loss decreased (-0.627768 --> -0.633326).  Saving model ...
Epoch: 7 cost time: 3.543910026550293
Epoch: 7, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.669 Vali Acc: 0.656 Test Loss: 0.669 Test Acc: 0.656
Validation loss decreased (-0.633326 --> -0.655549).  Saving model ...
Epoch: 8 cost time: 3.5736095905303955
Epoch: 8, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.594 Vali Acc: 0.678 Test Loss: 0.594 Test Acc: 0.678
Validation loss decreased (-0.655549 --> -0.677772).  Saving model ...
Epoch: 9 cost time: 3.3138813972473145
Epoch: 9, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.562 Vali Acc: 0.700 Test Loss: 0.562 Test Acc: 0.700
Validation loss decreased (-0.677772 --> -0.699994).  Saving model ...
Epoch: 10 cost time: 3.1243133544921875
Epoch: 10, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.467 Vali Acc: 0.761 Test Loss: 0.467 Test Acc: 0.761
Validation loss decreased (-0.699994 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 3.4445953369140625
Epoch: 11, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.514 Vali Acc: 0.739 Test Loss: 0.514 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5578715801239014
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.461 Vali Acc: 0.767 Test Loss: 0.461 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 13 cost time: 3.5220603942871094
Epoch: 13, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.389 Vali Acc: 0.761 Test Loss: 0.389 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6777842044830322
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.424 Vali Acc: 0.794 Test Loss: 0.424 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 3.72572922706604
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6675968170166016
Epoch: 16, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.361 Vali Acc: 0.778 Test Loss: 0.361 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.44875168800354
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.359 Vali Acc: 0.794 Test Loss: 0.359 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794441).  Saving model ...
Epoch: 18 cost time: 3.5475645065307617
Epoch: 18, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.363 Vali Acc: 0.800 Test Loss: 0.363 Test Acc: 0.800
Validation loss decreased (-0.794441 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 3.960068464279175
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 20 cost time: 3.8715085983276367
Epoch: 20, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.502 Vali Acc: 0.811 Test Loss: 0.502 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811106).  Saving model ...
Epoch: 21 cost time: 3.6180613040924072
Epoch: 21, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822219).  Saving model ...
Epoch: 22 cost time: 3.5499913692474365
Epoch: 22, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.586 Vali Acc: 0.817 Test Loss: 0.586 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9542648792266846
Epoch: 23, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 3.5046701431274414
Epoch: 24, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5482828617095947
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 3.7703940868377686
Epoch: 26, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 3.681234121322632
Epoch: 27, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6818928718566895
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.615813732147217
Epoch: 29, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.762044906616211
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.363527536392212
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4731228351593018
Epoch: 32, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.2157962322235107
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 34 cost time: 3.697221517562866
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.353 Vali Acc: 0.883 Test Loss: 0.353 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5846431255340576
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.5620689392089844
Epoch: 36, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.5342307090759277
Epoch: 37, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 38 cost time: 3.3137292861938477
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.417245388031006
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 40 cost time: 3.2666101455688477
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4072132110595703
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.746899127960205
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.6448616981506348
Epoch: 43, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.422961473464966
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.489 Vali Acc: 0.883 Test Loss: 0.489 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.6095659732818604
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.911109 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 3.5436594486236572
Epoch: 46, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.23006534576416
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.241779088973999
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.5262527465820312
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.441159248352051
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.8290305137634277
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.1826961040496826
Epoch: 52, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.1538279056549072
Epoch: 53, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.3310604095458984
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.5729925632476807
Epoch: 55, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.33306360244751
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.490277051925659
Epoch: 2, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.380903482437134
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.211578845977783
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.485804319381714
Epoch: 5, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5791990756988525
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3846404552459717
Epoch: 7, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.4545466899871826
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5215964317321777
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.62408185005188
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.64894700050354
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.1529746055603027
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3911073207855225
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 3.391822099685669
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 3.2740724086761475
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 3.4254064559936523
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.438681125640869
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.57804536819458
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4033632278442383
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.469447612762451
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.41941237449646
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 3.4794187545776367
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2717509269714355
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2933597564697266
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1513922214508057
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.7993905544281006
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.500953197479248
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.8491287231445312
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 3.6441988945007324
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 3.5654706954956055
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 3.2552731037139893
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 3.375378370285034
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 3.364020824432373
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4102396965026855
Epoch: 34, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 3.5807807445526123
Epoch: 35, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.5017588138580322
Epoch: 36, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.3687047958374023
Epoch: 37, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.223201274871826
Epoch: 38, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.4266915321350098
Epoch: 39, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.506978988647461
Epoch: 40, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.960247039794922
Epoch: 41, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.6745500564575195
Epoch: 42, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.6801977157592773
Epoch: 43, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.6138434410095215
Epoch: 44, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 2090374
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4135003089904785
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.614 Vali Acc: 0.417 Test Loss: 1.614 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 3.5341389179229736
Epoch: 2, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.369 Vali Acc: 0.517 Test Loss: 1.369 Test Acc: 0.517
Validation loss decreased (-0.416651 --> -0.516653).  Saving model ...
Epoch: 3 cost time: 3.605593681335449
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.175 Vali Acc: 0.539 Test Loss: 1.175 Test Acc: 0.539
Validation loss decreased (-0.516653 --> -0.538877).  Saving model ...
Epoch: 4 cost time: 3.513173818588257
Epoch: 4, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.014 Vali Acc: 0.617 Test Loss: 1.014 Test Acc: 0.617
Validation loss decreased (-0.538877 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 3.1479909420013428
Epoch: 5, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.892 Vali Acc: 0.628 Test Loss: 0.892 Test Acc: 0.628
Validation loss decreased (-0.616657 --> -0.627769).  Saving model ...
Epoch: 6 cost time: 3.4224510192871094
Epoch: 6, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.714 Vali Acc: 0.706 Test Loss: 0.714 Test Acc: 0.706
Validation loss decreased (-0.627769 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 3.7899699211120605
Epoch: 7, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.600 Vali Acc: 0.739 Test Loss: 0.600 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 3.9615886211395264
Epoch: 8, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 3.680629253387451
Epoch: 9, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.493 Vali Acc: 0.767 Test Loss: 0.493 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 4.27173638343811
Epoch: 10, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.440 Vali Acc: 0.789 Test Loss: 0.440 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 3.6733956336975098
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.470 Vali Acc: 0.811 Test Loss: 0.470 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 3.544429063796997
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.484 Vali Acc: 0.806 Test Loss: 0.484 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.925321340560913
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 4.034885406494141
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.473 Vali Acc: 0.794 Test Loss: 0.473 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.896275281906128
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 3.9255924224853516
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 3.9077680110931396
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5684995651245117
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 3.5309417247772217
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.348 Vali Acc: 0.872 Test Loss: 0.348 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6843008995056152
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6800992488861084
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.484279155731201
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.781245708465576
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5594325065612793
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 3.3860256671905518
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3844099044799805
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.741550922393799
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.768946647644043
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.61244535446167
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 30 cost time: 3.7740864753723145
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 3.375525712966919
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.749002695083618
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.596895456314087
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.9661333560943604
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.6966183185577393
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.8956522941589355
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 37 cost time: 3.776151657104492
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.6095430850982666
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.551579475402832
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.9049177169799805
Epoch: 40, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.914337396621704
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.872 Test Loss: 0.323 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.9606173038482666
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.062487363815308
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.05471134185791
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.867 Test Loss: 0.358 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.637695550918579
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.8944289684295654
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.5942299365997314
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.714 Vali Acc: 0.283 Test Loss: 1.714 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 3.472386121749878
Epoch: 2, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.514 Vali Acc: 0.456 Test Loss: 1.514 Test Acc: 0.456
Validation loss decreased (-0.283316 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 3.518709182739258
Epoch: 3, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.344 Vali Acc: 0.494 Test Loss: 1.344 Test Acc: 0.494
Validation loss decreased (-0.455540 --> -0.494431).  Saving model ...
Epoch: 4 cost time: 3.252545118331909
Epoch: 4, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.185 Vali Acc: 0.539 Test Loss: 1.185 Test Acc: 0.539
Validation loss decreased (-0.494431 --> -0.538877).  Saving model ...
Epoch: 5 cost time: 3.424086332321167
Epoch: 5, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.055 Vali Acc: 0.594 Test Loss: 1.055 Test Acc: 0.594
Validation loss decreased (-0.538877 --> -0.594434).  Saving model ...
Epoch: 6 cost time: 3.8291678428649902
Epoch: 6, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.870 Vali Acc: 0.622 Test Loss: 0.870 Test Acc: 0.622
Validation loss decreased (-0.594434 --> -0.622214).  Saving model ...
Epoch: 7 cost time: 3.6683876514434814
Epoch: 7, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.733 Vali Acc: 0.689 Test Loss: 0.733 Test Acc: 0.689
Validation loss decreased (-0.622214 --> -0.688882).  Saving model ...
Epoch: 8 cost time: 3.817484140396118
Epoch: 8, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
Validation loss decreased (-0.688882 --> -0.716660).  Saving model ...
Epoch: 9 cost time: 3.6008753776550293
Epoch: 9, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.582 Vali Acc: 0.711 Test Loss: 0.582 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5632715225219727
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 3.337735414505005
Epoch: 11, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.514 Vali Acc: 0.767 Test Loss: 0.514 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 3.435441255569458
Epoch: 12, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783328).  Saving model ...
Epoch: 13 cost time: 3.1641695499420166
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.389 Vali Acc: 0.789 Test Loss: 0.389 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 3.6168131828308105
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.500 Vali Acc: 0.772 Test Loss: 0.500 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.330730438232422
Epoch: 15, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.381 Vali Acc: 0.817 Test Loss: 0.381 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 16 cost time: 3.5921096801757812
Epoch: 16, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 3.529702663421631
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.406 Vali Acc: 0.806 Test Loss: 0.406 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0842883586883545
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.323880434036255
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.473 Vali Acc: 0.839 Test Loss: 0.473 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838884).  Saving model ...
Epoch: 20 cost time: 3.4432477951049805
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.526 Vali Acc: 0.817 Test Loss: 0.526 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7832181453704834
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 3.4768242835998535
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8106415271759033
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6517298221588135
Epoch: 24, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.629310131072998
Epoch: 25, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 26 cost time: 3.328582525253296
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.785597324371338
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 3.7887561321258545
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.7460007667541504
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.737149477005005
Epoch: 30, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.8125288486480713
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 3.818723440170288
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6786015033721924
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.549098253250122
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6042284965515137
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.6540491580963135
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.423037052154541
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.9837491512298584
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.426 Vali Acc: 0.878 Test Loss: 0.426 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.386389970779419
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 40 cost time: 3.392787456512451
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.417 Vali Acc: 0.883 Test Loss: 0.417 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2295453548431396
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.7242069244384766
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.805919885635376
Epoch: 43, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.263142108917236
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.360 Vali Acc: 0.894 Test Loss: 0.360 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.79929780960083
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.438672780990601
Epoch: 46, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.8549792766571045
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.9286444187164307
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.413 Vali Acc: 0.906 Test Loss: 0.413 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.772627115249634
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1213555335998535
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.6626503467559814
Epoch: 2, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.604 Vali Acc: 0.367 Test Loss: 1.604 Test Acc: 0.367
Validation loss decreased (-0.188871 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 3.4608068466186523
Epoch: 3, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.454 Vali Acc: 0.461 Test Loss: 1.454 Test Acc: 0.461
Validation loss decreased (-0.366651 --> -0.461097).  Saving model ...
Epoch: 4 cost time: 3.521200656890869
Epoch: 4, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.308 Vali Acc: 0.439 Test Loss: 1.308 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5729801654815674
Epoch: 5, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.461097 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 3.659841775894165
Epoch: 6, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 3.743494749069214
Epoch: 7, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.853 Vali Acc: 0.622 Test Loss: 0.853 Test Acc: 0.622
Validation loss decreased (-0.599990 --> -0.622214).  Saving model ...
Epoch: 8 cost time: 3.5290446281433105
Epoch: 8, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.783 Vali Acc: 0.650 Test Loss: 0.783 Test Acc: 0.650
Validation loss decreased (-0.622214 --> -0.649992).  Saving model ...
Epoch: 9 cost time: 3.6307175159454346
Epoch: 9, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.672 Vali Acc: 0.678 Test Loss: 0.672 Test Acc: 0.678
Validation loss decreased (-0.649992 --> -0.677771).  Saving model ...
Epoch: 10 cost time: 3.5959701538085938
Epoch: 10, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.604 Vali Acc: 0.728 Test Loss: 0.604 Test Acc: 0.728
Validation loss decreased (-0.677771 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 3.4407360553741455
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.564 Vali Acc: 0.728 Test Loss: 0.564 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 3.6644515991210938
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.578 Vali Acc: 0.767 Test Loss: 0.578 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766661).  Saving model ...
Epoch: 13 cost time: 3.6128382682800293
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 3.6479578018188477
Epoch: 14, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5385236740112305
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.413 Vali Acc: 0.822 Test Loss: 0.413 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 3.676903486251831
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.439 Vali Acc: 0.789 Test Loss: 0.439 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7617058753967285
Epoch: 17, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.460 Vali Acc: 0.806 Test Loss: 0.460 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4069745540618896
Epoch: 18, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.380 Vali Acc: 0.811 Test Loss: 0.380 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6493067741394043
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 3.4021987915039062
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.507 Vali Acc: 0.811 Test Loss: 0.507 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1819350719451904
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1856651306152344
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855551).  Saving model ...
Epoch: 23 cost time: 3.552401304244995
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.384 Vali Acc: 0.856 Test Loss: 0.384 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 3.39314341545105
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.428 Vali Acc: 0.839 Test Loss: 0.428 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.392777919769287
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.51477313041687
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.469 Vali Acc: 0.839 Test Loss: 0.469 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3274128437042236
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.453631639480591
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6246705055236816
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.513 Vali Acc: 0.839 Test Loss: 0.513 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.13153338432312
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.495 Vali Acc: 0.872 Test Loss: 0.495 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 3.540515899658203
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.4700920581817627
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.81551456451416
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.6630611419677734
Epoch: 34, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.446 Vali Acc: 0.867 Test Loss: 0.446 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.071333408355713
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.6312472820281982
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 37 cost time: 3.535292148590088
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.601001262664795
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 3.737591505050659
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 40 cost time: 3.7019424438476562
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.742 Vali Acc: 0.867 Test Loss: 0.742 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.92976975440979
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.597 Vali Acc: 0.883 Test Loss: 0.597 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883327).  Saving model ...
Epoch: 42 cost time: 3.8513376712799072
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.7544116973876953
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883328).  Saving model ...
Epoch: 44 cost time: 3.5228490829467773
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.12554931640625
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.526473045349121
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.5301990509033203
Epoch: 47, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.338042736053467
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.792 Vali Acc: 0.872 Test Loss: 0.792 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.7849955558776855
Epoch: 49, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.575716257095337
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.881753444671631
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.7054944038391113
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.8999979496002197
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.883328 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 3.513709545135498
Epoch: 54, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 55 cost time: 3.5040013790130615
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.894 Test Loss: 0.517 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.5586438179016113
Epoch: 56, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.954430341720581
Epoch: 57, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.562239170074463
Epoch: 58, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.5941927433013916
Epoch: 59, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.6301753520965576
Epoch: 60, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.8499574661254883
Epoch: 61, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.883 Test Loss: 0.526 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.361438274383545
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.0927963256835938
Epoch: 63, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.393038272857666
Epoch: 64, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.147893905639648
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.785 Vali Acc: 0.183 Test Loss: 1.785 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 3.5067832469940186
Epoch: 2, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.668 Vali Acc: 0.261 Test Loss: 1.668 Test Acc: 0.261
Validation loss decreased (-0.183315 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 3.5132968425750732
Epoch: 3, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.542 Vali Acc: 0.378 Test Loss: 1.542 Test Acc: 0.378
Validation loss decreased (-0.261094 --> -0.377762).  Saving model ...
Epoch: 4 cost time: 3.4954707622528076
Epoch: 4, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.390 Vali Acc: 0.428 Test Loss: 1.390 Test Acc: 0.428
Validation loss decreased (-0.377762 --> -0.427764).  Saving model ...
Epoch: 5 cost time: 4.019810199737549
Epoch: 5, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
Validation loss decreased (-0.427764 --> -0.466654).  Saving model ...
Epoch: 6 cost time: 3.808851718902588
Epoch: 6, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.963 Vali Acc: 0.594 Test Loss: 0.963 Test Acc: 0.594
Validation loss decreased (-0.466654 --> -0.594435).  Saving model ...
Epoch: 7 cost time: 3.755887985229492
Epoch: 7, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.818 Vali Acc: 0.594 Test Loss: 0.818 Test Acc: 0.594
Validation loss decreased (-0.594435 --> -0.594436).  Saving model ...
Epoch: 8 cost time: 4.240936994552612
Epoch: 8, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.784 Vali Acc: 0.611 Test Loss: 0.784 Test Acc: 0.611
Validation loss decreased (-0.594436 --> -0.611103).  Saving model ...
Epoch: 9 cost time: 3.9125685691833496
Epoch: 9, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.698 Vali Acc: 0.678 Test Loss: 0.698 Test Acc: 0.678
Validation loss decreased (-0.611103 --> -0.677771).  Saving model ...
Epoch: 10 cost time: 3.7447257041931152
Epoch: 10, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.614 Vali Acc: 0.711 Test Loss: 0.614 Test Acc: 0.711
Validation loss decreased (-0.677771 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 3.970064163208008
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.612 Vali Acc: 0.739 Test Loss: 0.612 Test Acc: 0.739
Validation loss decreased (-0.711105 --> -0.738883).  Saving model ...
Epoch: 12 cost time: 3.7539680004119873
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.576 Vali Acc: 0.744 Test Loss: 0.576 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744439).  Saving model ...
Epoch: 13 cost time: 3.8777871131896973
Epoch: 13, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.482 Vali Acc: 0.750 Test Loss: 0.482 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 14 cost time: 3.8344032764434814
Epoch: 14, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.552 Vali Acc: 0.761 Test Loss: 0.552 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761106).  Saving model ...
Epoch: 15 cost time: 3.7203497886657715
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.457 Vali Acc: 0.778 Test Loss: 0.457 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 3.5064752101898193
Epoch: 16, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.470 Vali Acc: 0.744 Test Loss: 0.470 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.503188371658325
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.474 Vali Acc: 0.767 Test Loss: 0.474 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5894522666931152
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 19 cost time: 3.5736441612243652
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.485 Vali Acc: 0.778 Test Loss: 0.485 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.681379795074463
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.633 Vali Acc: 0.794 Test Loss: 0.633 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5584096908569336
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.453 Vali Acc: 0.789 Test Loss: 0.453 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.9317476749420166
Epoch: 22, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.493 Vali Acc: 0.772 Test Loss: 0.493 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.961345672607422
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.410 Vali Acc: 0.806 Test Loss: 0.410 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 24 cost time: 3.688232660293579
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.462 Vali Acc: 0.817 Test Loss: 0.462 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 25 cost time: 4.132129907608032
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.466 Vali Acc: 0.828 Test Loss: 0.466 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827773).  Saving model ...
Epoch: 26 cost time: 3.9474406242370605
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 3.7140109539031982
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8783395290374756
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.455 Vali Acc: 0.839 Test Loss: 0.455 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838884).  Saving model ...
Epoch: 29 cost time: 4.2700886726379395
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
Validation loss decreased (-0.838884 --> -0.861104).  Saving model ...
Epoch: 30 cost time: 3.9678235054016113
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.864 Vali Acc: 0.817 Test Loss: 0.864 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.198092460632324
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.8831324577331543
Epoch: 32, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.678 Vali Acc: 0.861 Test Loss: 0.678 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5762569904327393
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866662).  Saving model ...
Epoch: 34 cost time: 3.5750653743743896
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.878 Test Loss: 0.482 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 35 cost time: 3.7767839431762695
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.484595775604248
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.537538766860962
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.671 Vali Acc: 0.861 Test Loss: 0.671 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.957803249359131
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.4432427883148193
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.660007953643799
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.646390914916992
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.448 Vali Acc: 0.894 Test Loss: 0.448 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894440).  Saving model ...
Epoch: 42 cost time: 3.7002692222595215
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.849 Vali Acc: 0.867 Test Loss: 0.849 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.439486503601074
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.5988144874572754
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.417 Vali Acc: 0.878 Test Loss: 0.417 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.7104332447052
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.7127630710601807
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.894 Test Loss: 0.470 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.6876354217529297
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.89571213722229
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.725 Vali Acc: 0.883 Test Loss: 0.725 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.6092135906219482
Epoch: 49, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.595386028289795
Epoch: 50, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.550816774368286
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.079695463180542
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.820 Vali Acc: 0.194 Test Loss: 1.820 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 3.573512077331543
Epoch: 2, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.726 Vali Acc: 0.261 Test Loss: 1.726 Test Acc: 0.261
Validation loss decreased (-0.194426 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 3.44783353805542
Epoch: 3, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.584 Vali Acc: 0.400 Test Loss: 1.584 Test Acc: 0.400
Validation loss decreased (-0.261094 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 3.2728374004364014
Epoch: 4, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.339 Vali Acc: 0.550 Test Loss: 1.339 Test Acc: 0.550
Validation loss decreased (-0.399984 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 3.161963939666748
Epoch: 5, Steps: 12 | Train Loss: 1.352 Vali Loss: 1.045 Vali Acc: 0.644 Test Loss: 1.045 Test Acc: 0.644
Validation loss decreased (-0.549987 --> -0.644434).  Saving model ...
Epoch: 6 cost time: 3.2662887573242188
Epoch: 6, Steps: 12 | Train Loss: 1.107 Vali Loss: 0.825 Vali Acc: 0.622 Test Loss: 0.825 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6272480487823486
Epoch: 7, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.702 Vali Acc: 0.683 Test Loss: 0.702 Test Acc: 0.683
Validation loss decreased (-0.644434 --> -0.683326).  Saving model ...
Epoch: 8 cost time: 3.640855550765991
Epoch: 8, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.707 Vali Acc: 0.617 Test Loss: 0.707 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.500701427459717
Epoch: 9, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.627 Vali Acc: 0.689 Test Loss: 0.627 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688883).  Saving model ...
Epoch: 10 cost time: 3.480151414871216
Epoch: 10, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.503 Vali Acc: 0.733 Test Loss: 0.503 Test Acc: 0.733
Validation loss decreased (-0.688883 --> -0.733328).  Saving model ...
Epoch: 11 cost time: 3.5497076511383057
Epoch: 11, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.458 Vali Acc: 0.778 Test Loss: 0.458 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 3.4223999977111816
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.480 Vali Acc: 0.778 Test Loss: 0.480 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.756438732147217
Epoch: 13, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 3.643324375152588
Epoch: 14, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.493 Vali Acc: 0.772 Test Loss: 0.493 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.62501859664917
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.768709897994995
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.440 Vali Acc: 0.783 Test Loss: 0.440 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6464767456054688
Epoch: 17, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.430 Vali Acc: 0.806 Test Loss: 0.430 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5809500217437744
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.345 Vali Acc: 0.806 Test Loss: 0.345 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4411449432373047
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 20 cost time: 3.6183271408081055
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.469691038131714
Epoch: 21, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 3.209078550338745
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5674898624420166
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.340719699859619
Epoch: 24, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.662571907043457
Epoch: 25, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
Validation loss decreased (-0.838885 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 3.6443097591400146
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5906307697296143
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.811352014541626
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.537 Vali Acc: 0.811 Test Loss: 0.537 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.683070421218872
Epoch: 29, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.877775 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 3.406285047531128
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.722688913345337
Epoch: 31, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.511115074157715
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.572234869003296
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.489927291870117
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.488084316253662
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.368628740310669
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.3505070209503174
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.348212957382202
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.4191644191741943
Epoch: 39, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.586065292358398
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.792 Vali Acc: 0.217 Test Loss: 1.792 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 3.441279172897339
Epoch: 2, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.663 Vali Acc: 0.322 Test Loss: 1.663 Test Acc: 0.322
Validation loss decreased (-0.216649 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 3.511526107788086
Epoch: 3, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.446 Vali Acc: 0.439 Test Loss: 1.446 Test Acc: 0.439
Validation loss decreased (-0.322206 --> -0.438874).  Saving model ...
Epoch: 4 cost time: 3.2597951889038086
Epoch: 4, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.159 Vali Acc: 0.578 Test Loss: 1.159 Test Acc: 0.578
Validation loss decreased (-0.438874 --> -0.577766).  Saving model ...
Epoch: 5 cost time: 3.229580879211426
Epoch: 5, Steps: 12 | Train Loss: 1.413 Vali Loss: 0.910 Vali Acc: 0.583 Test Loss: 0.910 Test Acc: 0.583
Validation loss decreased (-0.577766 --> -0.583324).  Saving model ...
Epoch: 6 cost time: 3.249168872833252
Epoch: 6, Steps: 12 | Train Loss: 1.092 Vali Loss: 0.783 Vali Acc: 0.594 Test Loss: 0.783 Test Acc: 0.594
Validation loss decreased (-0.583324 --> -0.594437).  Saving model ...
Epoch: 7 cost time: 3.6331417560577393
Epoch: 7, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.694 Vali Acc: 0.656 Test Loss: 0.694 Test Acc: 0.656
Validation loss decreased (-0.594437 --> -0.655549).  Saving model ...
Epoch: 8 cost time: 3.5887961387634277
Epoch: 8, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.646 Vali Acc: 0.644 Test Loss: 0.646 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2930057048797607
Epoch: 9, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.620 Vali Acc: 0.689 Test Loss: 0.620 Test Acc: 0.689
Validation loss decreased (-0.655549 --> -0.688883).  Saving model ...
Epoch: 10 cost time: 3.685399293899536
Epoch: 10, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.463 Vali Acc: 0.789 Test Loss: 0.463 Test Acc: 0.789
Validation loss decreased (-0.688883 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 3.1172502040863037
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.472 Vali Acc: 0.794 Test Loss: 0.472 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 3.4831411838531494
Epoch: 12, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.489 Vali Acc: 0.800 Test Loss: 0.489 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 3.478137493133545
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.422 Vali Acc: 0.783 Test Loss: 0.422 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3132200241088867
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5921871662139893
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 3.3456690311431885
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.438 Vali Acc: 0.828 Test Loss: 0.438 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.434469223022461
Epoch: 17, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.585926055908203
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 3.190423011779785
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.683478832244873
Epoch: 20, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.755 Vali Acc: 0.794 Test Loss: 0.755 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5503246784210205
Epoch: 21, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.582 Vali Acc: 0.806 Test Loss: 0.582 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5767385959625244
Epoch: 22, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6709706783294678
Epoch: 23, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 3.373502254486084
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.460 Vali Acc: 0.844 Test Loss: 0.460 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844440).  Saving model ...
Epoch: 25 cost time: 3.9477579593658447
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
Validation loss decreased (-0.844440 --> -0.883330).  Saving model ...
Epoch: 26 cost time: 3.986504554748535
Epoch: 26, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 27 cost time: 3.538377046585083
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.424 Vali Acc: 0.883 Test Loss: 0.424 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.871345043182373
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 3.451617479324341
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922219).  Saving model ...
Epoch: 30 cost time: 3.458402633666992
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.7918403148651123
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.567540168762207
Epoch: 32, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.487 Vali Acc: 0.894 Test Loss: 0.487 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.667081594467163
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.45434832572937
Epoch: 34, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3806309700012207
Epoch: 35, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.460 Vali Acc: 0.911 Test Loss: 0.460 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.3944172859191895
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 3.1138601303100586
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.1705453395843506
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.0667545795440674
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.387047290802002
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.453 Vali Acc: 0.917 Test Loss: 0.453 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.860934257507324
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.347 Vali Acc: 0.928 Test Loss: 0.347 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 42 cost time: 3.4005260467529297
Epoch: 42, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.284829616546631
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.300 Vali Acc: 0.939 Test Loss: 0.300 Test Acc: 0.939
Validation loss decreased (-0.927774 --> -0.938886).  Saving model ...
Epoch: 44 cost time: 3.5887880325317383
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.570 Vali Acc: 0.894 Test Loss: 0.570 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3374574184417725
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.352764844894409
Epoch: 46, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.446 Vali Acc: 0.894 Test Loss: 0.446 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.6525144577026367
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.906 Test Loss: 0.474 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.760176181793213
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.384 Vali Acc: 0.922 Test Loss: 0.384 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.6050310134887695
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.7330193519592285
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.3094704151153564
Epoch: 51, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.3502438068389893
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 4.048305988311768
Epoch: 53, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.658 Vali Acc: 0.889 Test Loss: 0.658 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.943897247314453
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.789 Vali Acc: 0.178 Test Loss: 1.789 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 3.586247682571411
Epoch: 2, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.668 Vali Acc: 0.317 Test Loss: 1.668 Test Acc: 0.317
Validation loss decreased (-0.177760 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 3.3656513690948486
Epoch: 3, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.458 Vali Acc: 0.450 Test Loss: 1.458 Test Acc: 0.450
Validation loss decreased (-0.316650 --> -0.449985).  Saving model ...
Epoch: 4 cost time: 3.1124160289764404
Epoch: 4, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.180 Vali Acc: 0.544 Test Loss: 1.180 Test Acc: 0.544
Validation loss decreased (-0.449985 --> -0.544433).  Saving model ...
Epoch: 5 cost time: 3.4362218379974365
Epoch: 5, Steps: 12 | Train Loss: 1.497 Vali Loss: 0.929 Vali Acc: 0.594 Test Loss: 0.929 Test Acc: 0.594
Validation loss decreased (-0.544433 --> -0.594435).  Saving model ...
Epoch: 6 cost time: 3.3515279293060303
Epoch: 6, Steps: 12 | Train Loss: 1.146 Vali Loss: 0.812 Vali Acc: 0.550 Test Loss: 0.812 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.430082082748413
Epoch: 7, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.720 Vali Acc: 0.650 Test Loss: 0.720 Test Acc: 0.650
Validation loss decreased (-0.594435 --> -0.649993).  Saving model ...
Epoch: 8 cost time: 3.386660575866699
Epoch: 8, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.674 Vali Acc: 0.672 Test Loss: 0.674 Test Acc: 0.672
Validation loss decreased (-0.649993 --> -0.672215).  Saving model ...
Epoch: 9 cost time: 3.6670868396759033
Epoch: 9, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.656 Vali Acc: 0.650 Test Loss: 0.656 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4139022827148438
Epoch: 10, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.460 Vali Acc: 0.756 Test Loss: 0.460 Test Acc: 0.756
Validation loss decreased (-0.672215 --> -0.755551).  Saving model ...
Epoch: 11 cost time: 3.7211074829101562
Epoch: 11, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.488 Vali Acc: 0.778 Test Loss: 0.488 Test Acc: 0.778
Validation loss decreased (-0.755551 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 3.738280773162842
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 13 cost time: 3.4578003883361816
Epoch: 13, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.421 Vali Acc: 0.783 Test Loss: 0.421 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 14 cost time: 3.621016502380371
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 3.7803845405578613
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.431 Vali Acc: 0.806 Test Loss: 0.431 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 3.3863837718963623
Epoch: 16, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.419 Vali Acc: 0.806 Test Loss: 0.419 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 3.7620208263397217
Epoch: 17, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.467 Vali Acc: 0.811 Test Loss: 0.467 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 18 cost time: 3.661827564239502
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.380 Vali Acc: 0.794 Test Loss: 0.380 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3191494941711426
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.353 Vali Acc: 0.789 Test Loss: 0.353 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.49590802192688
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5423758029937744
Epoch: 21, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.424 Vali Acc: 0.800 Test Loss: 0.424 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.7225329875946045
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822219).  Saving model ...
Epoch: 23 cost time: 3.7746450901031494
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 3.5166499614715576
Epoch: 24, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.403 Vali Acc: 0.844 Test Loss: 0.403 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844440).  Saving model ...
Epoch: 25 cost time: 3.5694751739501953
Epoch: 25, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.844440 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 3.4443767070770264
Epoch: 26, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4389069080352783
Epoch: 27, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.437333345413208
Epoch: 28, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6239476203918457
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 3.5682294368743896
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.828965663909912
Epoch: 31, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 3.5851361751556396
Epoch: 32, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927775).  Saving model ...
Epoch: 33 cost time: 3.6482348442077637
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4627606868743896
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.5345325469970703
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3991336822509766
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.2975575923919678
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.396 Vali Acc: 0.883 Test Loss: 0.396 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.1612048149108887
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.4435226917266846
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.2786293029785156
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.461805582046509
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.5154707431793213
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.594345569610596
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.7648603916168213
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.9516642093658447
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.654298782348633
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.6296558380126953
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4963035583496094
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5286829471588135
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6982581615448
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.841012954711914
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.461627960205078
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.476494073867798
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.285054922103882
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.5169217586517334
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.586658239364624
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 1303942
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.999058723449707
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.624 Vali Acc: 0.394 Test Loss: 1.624 Test Acc: 0.394
Validation loss decreased (inf --> -0.394428).  Saving model ...
Epoch: 2 cost time: 3.330057144165039
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.383 Vali Acc: 0.456 Test Loss: 1.383 Test Acc: 0.456
Validation loss decreased (-0.394428 --> -0.455542).  Saving model ...
Epoch: 3 cost time: 3.3528008460998535
Epoch: 3, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
Validation loss decreased (-0.455542 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 3.4525375366210938
Epoch: 4, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.030 Vali Acc: 0.606 Test Loss: 1.030 Test Acc: 0.606
Validation loss decreased (-0.549988 --> -0.605545).  Saving model ...
Epoch: 5 cost time: 3.246687889099121
Epoch: 5, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.904 Vali Acc: 0.672 Test Loss: 0.904 Test Acc: 0.672
Validation loss decreased (-0.605545 --> -0.672213).  Saving model ...
Epoch: 6 cost time: 3.3455348014831543
Epoch: 6, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.756 Vali Acc: 0.678 Test Loss: 0.756 Test Acc: 0.678
Validation loss decreased (-0.672213 --> -0.677770).  Saving model ...
Epoch: 7 cost time: 3.2235476970672607
Epoch: 7, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.639 Vali Acc: 0.728 Test Loss: 0.639 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 3.6170918941497803
Epoch: 8, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.727771 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 3.3680713176727295
Epoch: 9, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.463 Vali Acc: 0.789 Test Loss: 0.463 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 3.630047559738159
Epoch: 10, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.432 Vali Acc: 0.794 Test Loss: 0.432 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 3.309567928314209
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 3.4765818119049072
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.466 Vali Acc: 0.789 Test Loss: 0.466 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.360424757003784
Epoch: 13, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.827774 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 3.450105667114258
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2644903659820557
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7736318111419678
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4255175590515137
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 3.169049024581909
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4398574829101562
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 3.1722071170806885
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 3.344047784805298
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4136250019073486
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.514293670654297
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.510559558868408
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3612241744995117
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.555849552154541
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.535968780517578
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 3.5953893661499023
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5889735221862793
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.339660167694092
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5457863807678223
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2981739044189453
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.428 Vali Acc: 0.856 Test Loss: 0.428 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.400092840194702
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.427304744720459
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.320523738861084
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.165076971054077
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.3871374130249023
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.541884899139404
Epoch: 1, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.685 Vali Acc: 0.333 Test Loss: 1.685 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 3.6693129539489746
Epoch: 2, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.492 Vali Acc: 0.456 Test Loss: 1.492 Test Acc: 0.456
Validation loss decreased (-0.333316 --> -0.455541).  Saving model ...
Epoch: 3 cost time: 3.558436632156372
Epoch: 3, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.321 Vali Acc: 0.489 Test Loss: 1.321 Test Acc: 0.489
Validation loss decreased (-0.455541 --> -0.488876).  Saving model ...
Epoch: 4 cost time: 3.956319570541382
Epoch: 4, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.157 Vali Acc: 0.544 Test Loss: 1.157 Test Acc: 0.544
Validation loss decreased (-0.488876 --> -0.544433).  Saving model ...
Epoch: 5 cost time: 3.9097867012023926
Epoch: 5, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.544433 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 3.822360038757324
Epoch: 6, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.880 Vali Acc: 0.633 Test Loss: 0.880 Test Acc: 0.633
Validation loss decreased (-0.599990 --> -0.633325).  Saving model ...
Epoch: 7 cost time: 3.8559861183166504
Epoch: 7, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.735 Vali Acc: 0.733 Test Loss: 0.735 Test Acc: 0.733
Validation loss decreased (-0.633325 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 3.961005210876465
Epoch: 8, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 3.561997413635254
Epoch: 9, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.548 Vali Acc: 0.750 Test Loss: 0.548 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 10 cost time: 3.6868021488189697
Epoch: 10, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.502 Vali Acc: 0.767 Test Loss: 0.502 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 3.3446567058563232
Epoch: 11, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.454 Vali Acc: 0.783 Test Loss: 0.454 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 12 cost time: 3.2275524139404297
Epoch: 12, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.541 Vali Acc: 0.778 Test Loss: 0.541 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5058979988098145
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 3.8341641426086426
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.993828535079956
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 16 cost time: 3.8279285430908203
Epoch: 16, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.384 Vali Acc: 0.833 Test Loss: 0.384 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 3.4408392906188965
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 3.559964895248413
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.629227638244629
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.832293748855591
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4428813457489014
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.370 Vali Acc: 0.839 Test Loss: 0.370 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 3.6959104537963867
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 4.124419212341309
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 24 cost time: 3.4753940105438232
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 25 cost time: 3.439332962036133
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 26 cost time: 3.4240846633911133
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 3.2921619415283203
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.393 Vali Acc: 0.867 Test Loss: 0.393 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2463884353637695
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3354697227478027
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4842445850372314
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 31 cost time: 3.3004369735717773
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3209476470947266
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.6756181716918945
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.361131191253662
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.351346731185913
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.3956029415130615
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.503448963165283
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.5153279304504395
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 39 cost time: 3.680175304412842
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 40 cost time: 3.6370456218719482
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.609339475631714
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.595611572265625
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.688067674636841
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.3288373947143555
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.4747166633605957
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.4555609226226807
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.5755691528320312
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.398894786834717
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.537977933883667
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.270668268203735
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.762 Vali Acc: 0.256 Test Loss: 1.762 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 3.601064443588257
Epoch: 2, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.613 Vali Acc: 0.378 Test Loss: 1.613 Test Acc: 0.378
Validation loss decreased (-0.255538 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 3.3945889472961426
Epoch: 3, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.461 Vali Acc: 0.389 Test Loss: 1.461 Test Acc: 0.389
Validation loss decreased (-0.377762 --> -0.388874).  Saving model ...
Epoch: 4 cost time: 3.495516777038574
Epoch: 4, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.318 Vali Acc: 0.433 Test Loss: 1.318 Test Acc: 0.433
Validation loss decreased (-0.388874 --> -0.433320).  Saving model ...
Epoch: 5 cost time: 3.5966811180114746
Epoch: 5, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.188 Vali Acc: 0.456 Test Loss: 1.188 Test Acc: 0.456
Validation loss decreased (-0.433320 --> -0.455544).  Saving model ...
Epoch: 6 cost time: 3.534015655517578
Epoch: 6, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.057 Vali Acc: 0.500 Test Loss: 1.057 Test Acc: 0.500
Validation loss decreased (-0.455544 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 3.6447055339813232
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.882 Vali Acc: 0.633 Test Loss: 0.882 Test Acc: 0.633
Validation loss decreased (-0.499989 --> -0.633325).  Saving model ...
Epoch: 8 cost time: 3.5422422885894775
Epoch: 8, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.772 Vali Acc: 0.678 Test Loss: 0.772 Test Acc: 0.678
Validation loss decreased (-0.633325 --> -0.677770).  Saving model ...
Epoch: 9 cost time: 3.284493923187256
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.702 Vali Acc: 0.656 Test Loss: 0.702 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4642810821533203
Epoch: 10, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.625 Vali Acc: 0.711 Test Loss: 0.625 Test Acc: 0.711
Validation loss decreased (-0.677770 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 3.443509578704834
Epoch: 11, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (-0.711105 --> -0.716661).  Saving model ...
Epoch: 12 cost time: 3.2906954288482666
Epoch: 12, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.716661 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 3.2806825637817383
Epoch: 13, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.488 Vali Acc: 0.778 Test Loss: 0.488 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 3.3000283241271973
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.452 Vali Acc: 0.778 Test Loss: 0.452 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 15 cost time: 3.1557676792144775
Epoch: 15, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.452 Vali Acc: 0.800 Test Loss: 0.452 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 3.503312587738037
Epoch: 16, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.443 Vali Acc: 0.806 Test Loss: 0.443 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 3.2319869995117188
Epoch: 17, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.400 Vali Acc: 0.794 Test Loss: 0.400 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.280768871307373
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.445 Vali Acc: 0.794 Test Loss: 0.445 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.441354751586914
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.441 Vali Acc: 0.817 Test Loss: 0.441 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 3.65033221244812
Epoch: 20, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.442 Vali Acc: 0.817 Test Loss: 0.442 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2724385261535645
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.439 Vali Acc: 0.817 Test Loss: 0.439 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 22 cost time: 3.4467949867248535
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.454 Vali Acc: 0.817 Test Loss: 0.454 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6439740657806396
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 3.571024179458618
Epoch: 24, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 25 cost time: 3.389582633972168
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.441338062286377
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.425 Vali Acc: 0.839 Test Loss: 0.425 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2568674087524414
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 28 cost time: 3.183359146118164
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.758 Vali Acc: 0.817 Test Loss: 0.758 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2702300548553467
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 3.1022377014160156
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3141732215881348
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.487 Vali Acc: 0.839 Test Loss: 0.487 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4511117935180664
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 33 cost time: 3.052371025085449
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.408 Vali Acc: 0.883 Test Loss: 0.408 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883329).  Saving model ...
Epoch: 34 cost time: 3.229525566101074
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.467 Vali Acc: 0.872 Test Loss: 0.467 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3430044651031494
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 36 cost time: 3.166973114013672
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.404503583908081
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.5999417304992676
Epoch: 38, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.5164878368377686
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.894 Test Loss: 0.473 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 40 cost time: 3.36409068107605
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.5511200428009033
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.693718433380127
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.3758299350738525
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.4108989238739014
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.3970768451690674
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.399 Vali Acc: 0.894 Test Loss: 0.399 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 46 cost time: 3.1963906288146973
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.422 Vali Acc: 0.894 Test Loss: 0.422 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4749908447265625
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.2832016944885254
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.772 Vali Acc: 0.867 Test Loss: 0.772 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.266026020050049
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.894 Test Loss: 0.474 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.0450351238250732
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.146057367324829
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.1184985637664795
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.3739678859710693
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.7421534061431885
Epoch: 54, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.587369918823242
Epoch: 55, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.2080113887786865
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.799 Vali Acc: 0.200 Test Loss: 1.799 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 3.7107656002044678
Epoch: 2, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.690 Vali Acc: 0.317 Test Loss: 1.690 Test Acc: 0.317
Validation loss decreased (-0.199982 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 3.74192476272583
Epoch: 3, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.571 Vali Acc: 0.361 Test Loss: 1.571 Test Acc: 0.361
Validation loss decreased (-0.316650 --> -0.361095).  Saving model ...
Epoch: 4 cost time: 3.419996976852417
Epoch: 4, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.429 Vali Acc: 0.461 Test Loss: 1.429 Test Acc: 0.461
Validation loss decreased (-0.361095 --> -0.461097).  Saving model ...
Epoch: 5 cost time: 3.4680309295654297
Epoch: 5, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.257 Vali Acc: 0.489 Test Loss: 1.257 Test Acc: 0.489
Validation loss decreased (-0.461097 --> -0.488876).  Saving model ...
Epoch: 6 cost time: 3.4968369007110596
Epoch: 6, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.049 Vali Acc: 0.572 Test Loss: 1.049 Test Acc: 0.572
Validation loss decreased (-0.488876 --> -0.572212).  Saving model ...
Epoch: 7 cost time: 3.3896396160125732
Epoch: 7, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.854 Vali Acc: 0.617 Test Loss: 0.854 Test Acc: 0.617
Validation loss decreased (-0.572212 --> -0.616658).  Saving model ...
Epoch: 8 cost time: 3.349944591522217
Epoch: 8, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.767 Vali Acc: 0.611 Test Loss: 0.767 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2327828407287598
Epoch: 9, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.698 Vali Acc: 0.656 Test Loss: 0.698 Test Acc: 0.656
Validation loss decreased (-0.616658 --> -0.655549).  Saving model ...
Epoch: 10 cost time: 3.259949207305908
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.669 Vali Acc: 0.683 Test Loss: 0.669 Test Acc: 0.683
Validation loss decreased (-0.655549 --> -0.683327).  Saving model ...
Epoch: 11 cost time: 3.3155789375305176
Epoch: 11, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.683327 --> -0.716661).  Saving model ...
Epoch: 12 cost time: 3.332247257232666
Epoch: 12, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.616 Vali Acc: 0.733 Test Loss: 0.616 Test Acc: 0.733
Validation loss decreased (-0.716661 --> -0.733327).  Saving model ...
Epoch: 13 cost time: 3.5665273666381836
Epoch: 13, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.516 Vali Acc: 0.744 Test Loss: 0.516 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 14 cost time: 3.681278705596924
Epoch: 14, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.493 Vali Acc: 0.767 Test Loss: 0.493 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 3.2784149646759033
Epoch: 15, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.495 Vali Acc: 0.794 Test Loss: 0.495 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794439).  Saving model ...
Epoch: 16 cost time: 3.7417964935302734
Epoch: 16, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.71079683303833
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.460 Vali Acc: 0.800 Test Loss: 0.460 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 3.496962785720825
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2876651287078857
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3892390727996826
Epoch: 20, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.434 Vali Acc: 0.806 Test Loss: 0.434 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 21 cost time: 3.3398549556732178
Epoch: 21, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.469 Vali Acc: 0.811 Test Loss: 0.469 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 22 cost time: 3.3811147212982178
Epoch: 22, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.424 Vali Acc: 0.806 Test Loss: 0.424 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6992292404174805
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.436 Vali Acc: 0.800 Test Loss: 0.436 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.587606191635132
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.486 Vali Acc: 0.806 Test Loss: 0.486 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.729095458984375
Epoch: 25, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 3.483175039291382
Epoch: 26, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4918644428253174
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.533 Vali Acc: 0.817 Test Loss: 0.533 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.249911308288574
Epoch: 28, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.932 Vali Acc: 0.817 Test Loss: 0.932 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.22456693649292
Epoch: 29, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3545796871185303
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.4960005283355713
Epoch: 31, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855551).  Saving model ...
Epoch: 32 cost time: 3.337671995162964
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4878289699554443
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877774).  Saving model ...
Epoch: 34 cost time: 3.6752126216888428
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2616617679595947
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2738873958587646
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.426 Vali Acc: 0.867 Test Loss: 0.426 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.399799108505249
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.391 Vali Acc: 0.883 Test Loss: 0.391 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 38 cost time: 3.3981266021728516
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.594381093978882
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.430 Vali Acc: 0.883 Test Loss: 0.430 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.832334041595459
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.7696080207824707
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.417825222015381
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.410 Vali Acc: 0.878 Test Loss: 0.410 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.3701725006103516
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.431 Vali Acc: 0.883 Test Loss: 0.431 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.56001615524292
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
Validation loss decreased (-0.883329 --> -0.905552).  Saving model ...
Epoch: 45 cost time: 3.4723801612854004
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.5116918087005615
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.2957701683044434
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.543 Vali Acc: 0.883 Test Loss: 0.543 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.554619312286377
Epoch: 48, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.897 Vali Acc: 0.867 Test Loss: 0.897 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.4765784740448
Epoch: 49, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.5240437984466553
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.656092643737793
Epoch: 51, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.3037900924682617
Epoch: 52, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.409 Vali Acc: 0.883 Test Loss: 0.409 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.5973472595214844
Epoch: 53, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.4310474395751953
Epoch: 54, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.169633150100708
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.802 Vali Acc: 0.172 Test Loss: 1.802 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 3.264976739883423
Epoch: 2, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.710 Vali Acc: 0.261 Test Loss: 1.710 Test Acc: 0.261
Validation loss decreased (-0.172204 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 3.2398681640625
Epoch: 3, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.571 Vali Acc: 0.389 Test Loss: 1.571 Test Acc: 0.389
Validation loss decreased (-0.261094 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 3.3949496746063232
Epoch: 4, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.346 Vali Acc: 0.478 Test Loss: 1.346 Test Acc: 0.478
Validation loss decreased (-0.388873 --> -0.477764).  Saving model ...
Epoch: 5 cost time: 3.4811830520629883
Epoch: 5, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.055 Vali Acc: 0.572 Test Loss: 1.055 Test Acc: 0.572
Validation loss decreased (-0.477764 --> -0.572212).  Saving model ...
Epoch: 6 cost time: 3.2352020740509033
Epoch: 6, Steps: 12 | Train Loss: 1.101 Vali Loss: 0.830 Vali Acc: 0.594 Test Loss: 0.830 Test Acc: 0.594
Validation loss decreased (-0.572212 --> -0.594436).  Saving model ...
Epoch: 7 cost time: 3.4816505908966064
Epoch: 7, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.757 Vali Acc: 0.617 Test Loss: 0.757 Test Acc: 0.617
Validation loss decreased (-0.594436 --> -0.616659).  Saving model ...
Epoch: 8 cost time: 3.3440639972686768
Epoch: 8, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.696 Vali Acc: 0.656 Test Loss: 0.696 Test Acc: 0.656
Validation loss decreased (-0.616659 --> -0.655549).  Saving model ...
Epoch: 9 cost time: 3.3123116493225098
Epoch: 9, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.614 Vali Acc: 0.689 Test Loss: 0.614 Test Acc: 0.689
Validation loss decreased (-0.655549 --> -0.688883).  Saving model ...
Epoch: 10 cost time: 3.675077199935913
Epoch: 10, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.547 Vali Acc: 0.728 Test Loss: 0.547 Test Acc: 0.728
Validation loss decreased (-0.688883 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 3.6017751693725586
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.448 Vali Acc: 0.772 Test Loss: 0.448 Test Acc: 0.772
Validation loss decreased (-0.727772 --> -0.772218).  Saving model ...
Epoch: 12 cost time: 3.431421995162964
Epoch: 12, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.487 Vali Acc: 0.767 Test Loss: 0.487 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8873891830444336
Epoch: 13, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 3.6496574878692627
Epoch: 14, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.432 Vali Acc: 0.778 Test Loss: 0.432 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5527842044830322
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.392 Vali Acc: 0.811 Test Loss: 0.392 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 3.481926679611206
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.392 Vali Acc: 0.761 Test Loss: 0.392 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6386866569519043
Epoch: 17, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6004700660705566
Epoch: 18, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 3.4748101234436035
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.349 Vali Acc: 0.806 Test Loss: 0.349 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.525252342224121
Epoch: 20, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827773).  Saving model ...
Epoch: 21 cost time: 3.6494243144989014
Epoch: 21, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.404 Vali Acc: 0.794 Test Loss: 0.404 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6756012439727783
Epoch: 22, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.411 Vali Acc: 0.839 Test Loss: 0.411 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 3.5986900329589844
Epoch: 23, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.436 Vali Acc: 0.839 Test Loss: 0.436 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.311128854751587
Epoch: 24, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4759395122528076
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4628281593322754
Epoch: 26, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 3.463071346282959
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2597522735595703
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2734105587005615
Epoch: 29, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.379927158355713
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1332733631134033
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.373 Vali Acc: 0.878 Test Loss: 0.373 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 32 cost time: 3.7431488037109375
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
Validation loss decreased (-0.877774 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 3.6286909580230713
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.628754138946533
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.587 Vali Acc: 0.883 Test Loss: 0.587 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.6920111179351807
Epoch: 35, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.672527551651001
Epoch: 36, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.625046730041504
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.075742721557617
Epoch: 38, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.612549066543579
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.5579288005828857
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.577484607696533
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.2324154376983643
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 3.724912643432617
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2444591522216797
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.320080041885376
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.405975818634033
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.158064126968384
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.184527635574341
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.2839667797088623
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.240377426147461
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.495 Vali Acc: 0.906 Test Loss: 0.495 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.0878872871398926
Epoch: 51, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.824 Vali Acc: 0.856 Test Loss: 0.824 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.3046875
Epoch: 52, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.453369379043579
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.825 Vali Acc: 0.206 Test Loss: 1.825 Test Acc: 0.206
Validation loss decreased (inf --> -0.205537).  Saving model ...
Epoch: 2 cost time: 3.6358449459075928
Epoch: 2, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.697 Vali Acc: 0.311 Test Loss: 1.697 Test Acc: 0.311
Validation loss decreased (-0.205537 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 3.764545202255249
Epoch: 3, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.482 Vali Acc: 0.483 Test Loss: 1.482 Test Acc: 0.483
Validation loss decreased (-0.311094 --> -0.483319).  Saving model ...
Epoch: 4 cost time: 3.4241890907287598
Epoch: 4, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.194 Vali Acc: 0.572 Test Loss: 1.194 Test Acc: 0.572
Validation loss decreased (-0.483319 --> -0.572210).  Saving model ...
Epoch: 5 cost time: 3.473827362060547
Epoch: 5, Steps: 12 | Train Loss: 1.382 Vali Loss: 0.927 Vali Acc: 0.633 Test Loss: 0.927 Test Acc: 0.633
Validation loss decreased (-0.572210 --> -0.633324).  Saving model ...
Epoch: 6 cost time: 3.725186586380005
Epoch: 6, Steps: 12 | Train Loss: 1.074 Vali Loss: 0.793 Vali Acc: 0.633 Test Loss: 0.793 Test Acc: 0.633
Validation loss decreased (-0.633324 --> -0.633325).  Saving model ...
Epoch: 7 cost time: 3.3998329639434814
Epoch: 7, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.783 Vali Acc: 0.667 Test Loss: 0.783 Test Acc: 0.667
Validation loss decreased (-0.633325 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 3.4850575923919678
Epoch: 8, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.686 Vali Acc: 0.678 Test Loss: 0.686 Test Acc: 0.678
Validation loss decreased (-0.666659 --> -0.677771).  Saving model ...
Epoch: 9 cost time: 3.5884668827056885
Epoch: 9, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.568 Vali Acc: 0.728 Test Loss: 0.568 Test Acc: 0.728
Validation loss decreased (-0.677771 --> -0.727772).  Saving model ...
Epoch: 10 cost time: 3.5218234062194824
Epoch: 10, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.509 Vali Acc: 0.733 Test Loss: 0.509 Test Acc: 0.733
Validation loss decreased (-0.727772 --> -0.733328).  Saving model ...
Epoch: 11 cost time: 3.7252566814422607
Epoch: 11, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.460 Vali Acc: 0.767 Test Loss: 0.460 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 3.5660524368286133
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.464 Vali Acc: 0.767 Test Loss: 0.464 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6358468532562256
Epoch: 13, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 4.00215220451355
Epoch: 14, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.382 Vali Acc: 0.800 Test Loss: 0.382 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 15 cost time: 3.6374428272247314
Epoch: 15, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.392 Vali Acc: 0.783 Test Loss: 0.392 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7951040267944336
Epoch: 16, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.409 Vali Acc: 0.778 Test Loss: 0.409 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.508049726486206
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.352 Vali Acc: 0.789 Test Loss: 0.352 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.696277379989624
Epoch: 18, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.346 Vali Acc: 0.811 Test Loss: 0.346 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811108).  Saving model ...
Epoch: 19 cost time: 3.6119863986968994
Epoch: 19, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.332 Vali Acc: 0.817 Test Loss: 0.332 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 3.8154516220092773
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.537 Vali Acc: 0.817 Test Loss: 0.537 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8060591220855713
Epoch: 21, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 3.4965720176696777
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 3.189648151397705
Epoch: 23, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 3.7345006465911865
Epoch: 24, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2020792961120605
Epoch: 25, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 26 cost time: 3.3117153644561768
Epoch: 26, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 3.495718479156494
Epoch: 27, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877774).  Saving model ...
Epoch: 28 cost time: 3.533881664276123
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.921 Vali Acc: 0.806 Test Loss: 0.921 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5470354557037354
Epoch: 29, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6653857231140137
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.809812068939209
Epoch: 31, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.0850324630737305
Epoch: 32, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 4.149059772491455
Epoch: 33, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 3.6293373107910156
Epoch: 34, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.9059526920318604
Epoch: 35, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.416 Vali Acc: 0.883 Test Loss: 0.416 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.7185847759246826
Epoch: 36, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.955415964126587
Epoch: 37, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.347292423248291
Epoch: 38, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.374 Vali Acc: 0.894 Test Loss: 0.374 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.668105363845825
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 40 cost time: 3.519782066345215
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.390 Vali Acc: 0.894 Test Loss: 0.390 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.8741133213043213
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.396 Vali Acc: 0.917 Test Loss: 0.396 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916663).  Saving model ...
Epoch: 42 cost time: 3.276015043258667
Epoch: 42, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 43 cost time: 3.5100488662719727
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.8131847381591797
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 3.554741144180298
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.234306573867798
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.6447739601135254
Epoch: 47, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.695 Vali Acc: 0.894 Test Loss: 0.695 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.8658506870269775
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.7283873558044434
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 50 cost time: 3.850651502609253
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.713948965072632
Epoch: 51, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.5742876529693604
Epoch: 52, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.923854351043701
Epoch: 53, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.678877592086792
Epoch: 54, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.73166823387146
Epoch: 55, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.478778839111328
Epoch: 56, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.774399757385254
Epoch: 57, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.8019189834594727
Epoch: 58, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.628 Vali Acc: 0.917 Test Loss: 0.628 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.3444275856018066
Epoch: 59, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.799 Vali Acc: 0.872 Test Loss: 0.799 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.999812602996826
Epoch: 1, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.800 Vali Acc: 0.200 Test Loss: 1.800 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 3.719505548477173
Epoch: 2, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.685 Vali Acc: 0.300 Test Loss: 1.685 Test Acc: 0.300
Validation loss decreased (-0.199982 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 3.090700387954712
Epoch: 3, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.478 Vali Acc: 0.483 Test Loss: 1.478 Test Acc: 0.483
Validation loss decreased (-0.299983 --> -0.483319).  Saving model ...
Epoch: 4 cost time: 3.5870656967163086
Epoch: 4, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.189 Vali Acc: 0.622 Test Loss: 1.189 Test Acc: 0.622
Validation loss decreased (-0.483319 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 3.596846342086792
Epoch: 5, Steps: 12 | Train Loss: 1.389 Vali Loss: 0.908 Vali Acc: 0.656 Test Loss: 0.908 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 3.4161078929901123
Epoch: 6, Steps: 12 | Train Loss: 1.126 Vali Loss: 0.778 Vali Acc: 0.622 Test Loss: 0.778 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.879344940185547
Epoch: 7, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.768 Vali Acc: 0.611 Test Loss: 0.768 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3646247386932373
Epoch: 8, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.698 Vali Acc: 0.650 Test Loss: 0.698 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7389838695526123
Epoch: 9, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.590 Vali Acc: 0.706 Test Loss: 0.590 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705550).  Saving model ...
Epoch: 10 cost time: 3.1844563484191895
Epoch: 10, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.508 Vali Acc: 0.739 Test Loss: 0.508 Test Acc: 0.739
Validation loss decreased (-0.705550 --> -0.738884).  Saving model ...
Epoch: 11 cost time: 3.3545377254486084
Epoch: 11, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.473 Vali Acc: 0.772 Test Loss: 0.473 Test Acc: 0.772
Validation loss decreased (-0.738884 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 3.1541850566864014
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.485 Vali Acc: 0.778 Test Loss: 0.485 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 13 cost time: 3.410788059234619
Epoch: 13, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 3.5473294258117676
Epoch: 14, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.415 Vali Acc: 0.778 Test Loss: 0.415 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.535005569458008
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 16 cost time: 3.348280191421509
Epoch: 16, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 3.7984793186187744
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.387 Vali Acc: 0.806 Test Loss: 0.387 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 18 cost time: 3.8370718955993652
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.361 Vali Acc: 0.806 Test Loss: 0.361 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 19 cost time: 3.4946320056915283
Epoch: 19, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 3.8345515727996826
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.484 Vali Acc: 0.817 Test Loss: 0.484 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5192782878875732
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.406 Vali Acc: 0.811 Test Loss: 0.406 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.003523826599121
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822217).  Saving model ...
Epoch: 23 cost time: 3.736194610595703
Epoch: 23, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.415 Vali Acc: 0.844 Test Loss: 0.415 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844440).  Saving model ...
Epoch: 24 cost time: 3.4539735317230225
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.666891098022461
Epoch: 25, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.386103868484497
Epoch: 26, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.2317566871643066
Epoch: 27, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.844440 --> -0.877774).  Saving model ...
Epoch: 28 cost time: 3.43734073638916
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.775 Vali Acc: 0.811 Test Loss: 0.775 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5599021911621094
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 3.7779970169067383
Epoch: 30, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.682175636291504
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.861410617828369
Epoch: 32, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.544074535369873
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 3.7312426567077637
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.770 Vali Acc: 0.839 Test Loss: 0.770 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.620697021484375
Epoch: 35, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.6827144622802734
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.485232353210449
Epoch: 37, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.384 Vali Acc: 0.883 Test Loss: 0.384 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.2517154216766357
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.4041337966918945
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.630380630493164
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.906 Test Loss: 0.363 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.224575996398926
Epoch: 41, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.3012681007385254
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.340841770172119
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.085243225097656
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.2763421535491943
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.284512996673584
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.2142319679260254
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.0123097896575928
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.069206714630127
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.033076763153076
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1487884521484375
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.076965808868408
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3226699829101562
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.240598201751709
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.3947980403900146
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 3.2803494930267334
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.193061351776123
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 3.382190227508545
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.184512138366699
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3041491508483887
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3850812911987305
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.280717372894287
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1919963359832764
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.337205171585083
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.2529726028442383
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.091459274291992
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.259939193725586
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 3.3664498329162598
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 3.441925048828125
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 3.76183819770813
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 3.4494595527648926
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.428317070007324
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6662302017211914
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.369286298751831
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.470482349395752
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 3.477562427520752
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3714964389801025
Epoch: 34, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 3.0279977321624756
Epoch: 35, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3431103229522705
Epoch: 36, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 3.2010068893432617
Epoch: 37, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 3.2292251586914062
Epoch: 38, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.238124132156372
Epoch: 39, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 2.9890918731689453
Epoch: 40, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 3.331493377685547
Epoch: 41, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.504802942276001
Epoch: 42, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.448958396911621
Epoch: 43, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 3.3428518772125244
Epoch: 44, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 3.6560239791870117
Epoch: 45, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.51993465423584
Epoch: 46, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.384223699569702
Epoch: 47, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.290281057357788
Epoch: 48, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.434725046157837
Epoch: 49, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 3.317216396331787
Epoch: 50, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.1793227195739746
Epoch: 51, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.2167410850524902
Epoch: 52, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.034606695175171
Epoch: 53, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.214115619659424
Epoch: 54, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.5366263389587402
Epoch: 55, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.357962131500244
Epoch: 56, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.412043809890747
Epoch: 57, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.411494493484497
Epoch: 58, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.324683427810669
Epoch: 59, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 910726
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.773313045501709
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.691 Vali Acc: 0.378 Test Loss: 1.691 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 3.3602428436279297
Epoch: 2, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
Validation loss decreased (-0.377761 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 3.237204074859619
Epoch: 3, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.255 Vali Acc: 0.528 Test Loss: 1.255 Test Acc: 0.528
Validation loss decreased (-0.499985 --> -0.527765).  Saving model ...
Epoch: 4 cost time: 3.8418326377868652
Epoch: 4, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.107 Vali Acc: 0.544 Test Loss: 1.107 Test Acc: 0.544
Validation loss decreased (-0.527765 --> -0.544433).  Saving model ...
Epoch: 5 cost time: 3.5866572856903076
Epoch: 5, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.977 Vali Acc: 0.589 Test Loss: 0.977 Test Acc: 0.589
Validation loss decreased (-0.544433 --> -0.588879).  Saving model ...
Epoch: 6 cost time: 3.368687152862549
Epoch: 6, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.842 Vali Acc: 0.639 Test Loss: 0.842 Test Acc: 0.639
Validation loss decreased (-0.588879 --> -0.638880).  Saving model ...
Epoch: 7 cost time: 3.6425864696502686
Epoch: 7, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.693 Vali Acc: 0.689 Test Loss: 0.693 Test Acc: 0.689
Validation loss decreased (-0.638880 --> -0.688882).  Saving model ...
Epoch: 8 cost time: 3.7305891513824463
Epoch: 8, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.588 Vali Acc: 0.744 Test Loss: 0.588 Test Acc: 0.744
Validation loss decreased (-0.688882 --> -0.744439).  Saving model ...
Epoch: 9 cost time: 3.5412063598632812
Epoch: 9, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.506 Vali Acc: 0.744 Test Loss: 0.506 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 10 cost time: 3.558232069015503
Epoch: 10, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
Validation loss decreased (-0.744439 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 3.7015392780303955
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.435 Vali Acc: 0.761 Test Loss: 0.435 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5097765922546387
Epoch: 12, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 3.6132702827453613
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 3.601930618286133
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 3.868595600128174
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3384344577789307
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7187907695770264
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 3.885345935821533
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 3.4629952907562256
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.64313006401062
Epoch: 20, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 3.7234132289886475
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.953401803970337
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 3.589243173599243
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 3.6526341438293457
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 25 cost time: 3.6997342109680176
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.83839750289917
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 3.4177262783050537
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.05794358253479
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.5318093299865723
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.122725009918213
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.2795417308807373
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 3.495388984680176
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3203511238098145
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 3.8476195335388184
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2894012928009033
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.9408793449401855
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3897595405578613
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.6647450923919678
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.035372018814087
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 3.7072904109954834
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.5159928798675537
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.491027593612671
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.3069701194763184
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.4576640129089355
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.668390989303589
Epoch: 45, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.294837713241577
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.706587791442871
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.439661979675293
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.600112199783325
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.670801162719727
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.751 Vali Acc: 0.250 Test Loss: 1.751 Test Acc: 0.250
Validation loss decreased (inf --> -0.249982).  Saving model ...
Epoch: 2 cost time: 3.319894790649414
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.580 Vali Acc: 0.450 Test Loss: 1.580 Test Acc: 0.450
Validation loss decreased (-0.249982 --> -0.449984).  Saving model ...
Epoch: 3 cost time: 3.2004811763763428
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.389 Vali Acc: 0.500 Test Loss: 1.389 Test Acc: 0.500
Validation loss decreased (-0.449984 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 3.1351099014282227
Epoch: 4, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 3.3218328952789307
Epoch: 5, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.091 Vali Acc: 0.556 Test Loss: 1.091 Test Acc: 0.556
Validation loss decreased (-0.499988 --> -0.555545).  Saving model ...
Epoch: 6 cost time: 3.149345874786377
Epoch: 6, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.935 Vali Acc: 0.594 Test Loss: 0.935 Test Acc: 0.594
Validation loss decreased (-0.555545 --> -0.594435).  Saving model ...
Epoch: 7 cost time: 3.3553824424743652
Epoch: 7, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.776 Vali Acc: 0.661 Test Loss: 0.776 Test Acc: 0.661
Validation loss decreased (-0.594435 --> -0.661103).  Saving model ...
Epoch: 8 cost time: 3.124166488647461
Epoch: 8, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.658 Vali Acc: 0.728 Test Loss: 0.658 Test Acc: 0.728
Validation loss decreased (-0.661103 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 3.0155820846557617
Epoch: 9, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.571 Vali Acc: 0.728 Test Loss: 0.571 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727772).  Saving model ...
Epoch: 10 cost time: 3.5294623374938965
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 3.2266576290130615
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.484 Vali Acc: 0.767 Test Loss: 0.484 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 3.532130479812622
Epoch: 12, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.430 Vali Acc: 0.778 Test Loss: 0.430 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 13 cost time: 3.25459623336792
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.394 Vali Acc: 0.800 Test Loss: 0.394 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 14 cost time: 3.1330206394195557
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 3.477386951446533
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 3.2764194011688232
Epoch: 16, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0415689945220947
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 3.342362880706787
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.365 Vali Acc: 0.806 Test Loss: 0.365 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.135833501815796
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 3.232682228088379
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.341 Vali Acc: 0.828 Test Loss: 0.341 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.075002908706665
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.385444164276123
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 3.4397878646850586
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 3.289599657058716
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 3.539153814315796
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 3.4297866821289062
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 27 cost time: 3.69828462600708
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4417572021484375
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.281489372253418
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5509817600250244
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.04986572265625
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 3.0693697929382324
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 33 cost time: 3.5352060794830322
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 3.2141318321228027
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3334381580352783
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.414018154144287
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.2537498474121094
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.387 Vali Acc: 0.883 Test Loss: 0.387 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.173658609390259
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.367 Vali Acc: 0.883 Test Loss: 0.367 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.3149993419647217
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.313016891479492
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.463 Vali Acc: 0.883 Test Loss: 0.463 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.1561951637268066
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.519320249557495
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.391216993331909
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.099530935287476
Epoch: 1, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.826 Vali Acc: 0.183 Test Loss: 1.826 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 3.5395379066467285
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.680 Vali Acc: 0.339 Test Loss: 1.680 Test Acc: 0.339
Validation loss decreased (-0.183315 --> -0.338872).  Saving model ...
Epoch: 3 cost time: 3.284191370010376
Epoch: 3, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.520 Vali Acc: 0.422 Test Loss: 1.520 Test Acc: 0.422
Validation loss decreased (-0.338872 --> -0.422207).  Saving model ...
Epoch: 4 cost time: 3.614039182662964
Epoch: 4, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.379 Vali Acc: 0.467 Test Loss: 1.379 Test Acc: 0.467
Validation loss decreased (-0.422207 --> -0.466653).  Saving model ...
Epoch: 5 cost time: 3.6724605560302734
Epoch: 5, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.226 Vali Acc: 0.483 Test Loss: 1.226 Test Acc: 0.483
Validation loss decreased (-0.466653 --> -0.483321).  Saving model ...
Epoch: 6 cost time: 3.362426996231079
Epoch: 6, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.059 Vali Acc: 0.567 Test Loss: 1.059 Test Acc: 0.567
Validation loss decreased (-0.483321 --> -0.566656).  Saving model ...
Epoch: 7 cost time: 3.325615406036377
Epoch: 7, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.886 Vali Acc: 0.606 Test Loss: 0.886 Test Acc: 0.606
Validation loss decreased (-0.566656 --> -0.605547).  Saving model ...
Epoch: 8 cost time: 3.461923837661743
Epoch: 8, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.760 Vali Acc: 0.656 Test Loss: 0.760 Test Acc: 0.656
Validation loss decreased (-0.605547 --> -0.655548).  Saving model ...
Epoch: 9 cost time: 3.3448405265808105
Epoch: 9, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.690 Vali Acc: 0.667 Test Loss: 0.690 Test Acc: 0.667
Validation loss decreased (-0.655548 --> -0.666660).  Saving model ...
Epoch: 10 cost time: 3.191847324371338
Epoch: 10, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.601 Vali Acc: 0.733 Test Loss: 0.601 Test Acc: 0.733
Validation loss decreased (-0.666660 --> -0.733327).  Saving model ...
Epoch: 11 cost time: 3.257863998413086
Epoch: 11, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4110512733459473
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.504 Vali Acc: 0.739 Test Loss: 0.504 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738884).  Saving model ...
Epoch: 13 cost time: 3.5462260246276855
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.459 Vali Acc: 0.756 Test Loss: 0.459 Test Acc: 0.756
Validation loss decreased (-0.738884 --> -0.755551).  Saving model ...
Epoch: 14 cost time: 3.1662421226501465
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.432 Vali Acc: 0.783 Test Loss: 0.432 Test Acc: 0.783
Validation loss decreased (-0.755551 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 3.315082550048828
Epoch: 15, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2267348766326904
Epoch: 16, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.417 Vali Acc: 0.789 Test Loss: 0.417 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 17 cost time: 3.5728585720062256
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.390 Vali Acc: 0.789 Test Loss: 0.390 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 3.2803795337677
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.438 Vali Acc: 0.806 Test Loss: 0.438 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805551).  Saving model ...
Epoch: 19 cost time: 3.479381799697876
Epoch: 19, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.463 Vali Acc: 0.811 Test Loss: 0.463 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 20 cost time: 3.2464048862457275
Epoch: 20, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.409 Vali Acc: 0.811 Test Loss: 0.409 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 3.494178056716919
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.440 Vali Acc: 0.817 Test Loss: 0.440 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 22 cost time: 3.4800124168395996
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.451 Vali Acc: 0.817 Test Loss: 0.451 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.468355417251587
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 24 cost time: 3.150554895401001
Epoch: 24, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.470 Vali Acc: 0.828 Test Loss: 0.470 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 25 cost time: 3.389313220977783
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.443 Vali Acc: 0.817 Test Loss: 0.443 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2618627548217773
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.427 Vali Acc: 0.828 Test Loss: 0.427 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 27 cost time: 3.261070728302002
Epoch: 27, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.456 Vali Acc: 0.828 Test Loss: 0.456 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0847394466400146
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 3.2900431156158447
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 30 cost time: 3.248319625854492
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 31 cost time: 3.2544875144958496
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 3.308997869491577
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866662).  Saving model ...
Epoch: 33 cost time: 3.425145149230957
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.18367600440979
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.3931314945220947
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3281612396240234
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.381 Vali Acc: 0.883 Test Loss: 0.381 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883330).  Saving model ...
Epoch: 37 cost time: 3.67513108253479
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.403 Vali Acc: 0.872 Test Loss: 0.403 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.537921190261841
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.378 Vali Acc: 0.872 Test Loss: 0.378 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.394406318664551
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 40 cost time: 3.45485782623291
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.54502272605896
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.354353427886963
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 3.4229722023010254
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.389 Vali Acc: 0.883 Test Loss: 0.389 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.380094051361084
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.7515456676483154
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.6554839611053467
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.6099491119384766
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.730 Vali Acc: 0.878 Test Loss: 0.730 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.467123031616211
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 3.5473220348358154
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3429410457611084
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.399047613143921
Epoch: 51, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.295757293701172
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.504 Vali Acc: 0.883 Test Loss: 0.504 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.6677284240722656
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.6718783378601074
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.79298734664917
Epoch: 55, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.894 Test Loss: 0.394 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.719637870788574
Epoch: 56, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.8595025539398193
Epoch: 57, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.851884126663208
Epoch: 58, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 59 cost time: 3.639256715774536
Epoch: 59, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5977072715759277
Epoch: 60, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.885725259780884
Epoch: 61, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.906 Test Loss: 0.431 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.4824981689453125
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905552).  Saving model ...
Epoch: 63 cost time: 3.685455322265625
Epoch: 63, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.954463481903076
Epoch: 64, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.427194833755493
Epoch: 65, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.894 Test Loss: 0.488 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.5774855613708496
Epoch: 66, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.4448840618133545
Epoch: 67, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 3.539078950881958
Epoch: 68, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 69 cost time: 3.2361295223236084
Epoch: 69, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.215402364730835
Epoch: 70, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.928 Test Loss: 0.316 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 71 cost time: 3.466899871826172
Epoch: 71, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933330).  Saving model ...
Epoch: 72 cost time: 3.4568350315093994
Epoch: 72, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 73 cost time: 3.4270706176757812
Epoch: 73, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 74 cost time: 3.615746259689331
Epoch: 74, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 75 cost time: 3.6699485778808594
Epoch: 75, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 3.5104689598083496
Epoch: 76, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 3.5789906978607178
Epoch: 77, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 3.6325180530548096
Epoch: 78, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 3.3498191833496094
Epoch: 79, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 3.2545359134674072
Epoch: 80, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 3.297276020050049
Epoch: 81, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 3.216731309890747
Epoch: 82, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 3.1757090091705322
Epoch: 83, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 3.0667078495025635
Epoch: 84, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.252703666687012
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.831 Vali Acc: 0.189 Test Loss: 1.831 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.641162872314453
Epoch: 2, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.732 Vali Acc: 0.250 Test Loss: 1.732 Test Acc: 0.250
Validation loss decreased (-0.188871 --> -0.249983).  Saving model ...
Epoch: 3 cost time: 3.4013330936431885
Epoch: 3, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.604 Vali Acc: 0.294 Test Loss: 1.604 Test Acc: 0.294
Validation loss decreased (-0.249983 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 3.4220941066741943
Epoch: 4, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.456 Vali Acc: 0.394 Test Loss: 1.456 Test Acc: 0.394
Validation loss decreased (-0.294428 --> -0.394430).  Saving model ...
Epoch: 5 cost time: 3.488166093826294
Epoch: 5, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.254 Vali Acc: 0.506 Test Loss: 1.254 Test Acc: 0.506
Validation loss decreased (-0.394430 --> -0.505543).  Saving model ...
Epoch: 6 cost time: 3.60276460647583
Epoch: 6, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.020 Vali Acc: 0.617 Test Loss: 1.020 Test Acc: 0.617
Validation loss decreased (-0.505543 --> -0.616656).  Saving model ...
Epoch: 7 cost time: 3.5385870933532715
Epoch: 7, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.825 Vali Acc: 0.606 Test Loss: 0.825 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6339681148529053
Epoch: 8, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.760 Vali Acc: 0.611 Test Loss: 0.760 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.728461742401123
Epoch: 9, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.703 Vali Acc: 0.633 Test Loss: 0.703 Test Acc: 0.633
Validation loss decreased (-0.616656 --> -0.633326).  Saving model ...
Epoch: 10 cost time: 3.9421820640563965
Epoch: 10, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.601 Vali Acc: 0.706 Test Loss: 0.601 Test Acc: 0.706
Validation loss decreased (-0.633326 --> -0.705550).  Saving model ...
Epoch: 11 cost time: 3.793210983276367
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.557 Vali Acc: 0.711 Test Loss: 0.557 Test Acc: 0.711
Validation loss decreased (-0.705550 --> -0.711106).  Saving model ...
Epoch: 12 cost time: 3.913588523864746
Epoch: 12, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.519 Vali Acc: 0.722 Test Loss: 0.519 Test Acc: 0.722
Validation loss decreased (-0.711106 --> -0.722217).  Saving model ...
Epoch: 13 cost time: 3.757542848587036
Epoch: 13, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.460 Vali Acc: 0.733 Test Loss: 0.460 Test Acc: 0.733
Validation loss decreased (-0.722217 --> -0.733329).  Saving model ...
Epoch: 14 cost time: 3.3742706775665283
Epoch: 14, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.450 Vali Acc: 0.739 Test Loss: 0.450 Test Acc: 0.739
Validation loss decreased (-0.733329 --> -0.738884).  Saving model ...
Epoch: 15 cost time: 3.0755677223205566
Epoch: 15, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.467 Vali Acc: 0.756 Test Loss: 0.467 Test Acc: 0.756
Validation loss decreased (-0.738884 --> -0.755551).  Saving model ...
Epoch: 16 cost time: 3.148608922958374
Epoch: 16, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.430 Vali Acc: 0.767 Test Loss: 0.430 Test Acc: 0.767
Validation loss decreased (-0.755551 --> -0.766662).  Saving model ...
Epoch: 17 cost time: 3.4065637588500977
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.394 Vali Acc: 0.789 Test Loss: 0.394 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 3.3946950435638428
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.416 Vali Acc: 0.772 Test Loss: 0.416 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9697158336639404
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.414 Vali Acc: 0.794 Test Loss: 0.414 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794440).  Saving model ...
Epoch: 20 cost time: 3.7082021236419678
Epoch: 20, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 3.3788862228393555
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 3.8706154823303223
Epoch: 22, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.439 Vali Acc: 0.817 Test Loss: 0.439 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.181367874145508
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 24 cost time: 3.7579264640808105
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.420 Vali Acc: 0.811 Test Loss: 0.420 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.450601816177368
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.545807123184204
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 27 cost time: 3.826622247695923
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5092153549194336
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 29 cost time: 3.9745893478393555
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.370 Vali Acc: 0.856 Test Loss: 0.370 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 3.663949489593506
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 3.5433616638183594
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 32 cost time: 3.869427442550659
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 33 cost time: 3.481156349182129
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.424 Vali Acc: 0.872 Test Loss: 0.424 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.6396970748901367
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.353 Vali Acc: 0.872 Test Loss: 0.353 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.3606674671173096
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2104291915893555
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.449 Vali Acc: 0.894 Test Loss: 0.449 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.5019068717956543
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.662 Vali Acc: 0.878 Test Loss: 0.662 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.313453435897827
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.3935697078704834
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.6164944171905518
Epoch: 40, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 3.590057849884033
Epoch: 41, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.3693180084228516
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.6054975986480713
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.495706081390381
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.5621166229248047
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 46 cost time: 3.289062023162842
Epoch: 46, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 47 cost time: 3.2128002643585205
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.190685510635376
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.413 Vali Acc: 0.906 Test Loss: 0.413 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.597564220428467
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.513 Vali Acc: 0.906 Test Loss: 0.513 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.452739953994751
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.7748312950134277
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.6438543796539307
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.8041234016418457
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.6487858295440674
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.484135150909424
Epoch: 55, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.184570074081421
Epoch: 56, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.759779691696167
Epoch: 1, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.815 Vali Acc: 0.189 Test Loss: 1.815 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.458944320678711
Epoch: 2, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.733 Vali Acc: 0.267 Test Loss: 1.733 Test Acc: 0.267
Validation loss decreased (-0.188871 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 3.386605739593506
Epoch: 3, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.602 Vali Acc: 0.389 Test Loss: 1.602 Test Acc: 0.389
Validation loss decreased (-0.266649 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 3.5483038425445557
Epoch: 4, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.390 Vali Acc: 0.472 Test Loss: 1.390 Test Acc: 0.472
Validation loss decreased (-0.388873 --> -0.472208).  Saving model ...
Epoch: 5 cost time: 3.500579595565796
Epoch: 5, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.082 Vali Acc: 0.528 Test Loss: 1.082 Test Acc: 0.528
Validation loss decreased (-0.472208 --> -0.527767).  Saving model ...
Epoch: 6 cost time: 3.497140407562256
Epoch: 6, Steps: 12 | Train Loss: 1.125 Vali Loss: 0.878 Vali Acc: 0.544 Test Loss: 0.878 Test Acc: 0.544
Validation loss decreased (-0.527767 --> -0.544436).  Saving model ...
Epoch: 7 cost time: 3.2607784271240234
Epoch: 7, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.763 Vali Acc: 0.600 Test Loss: 0.763 Test Acc: 0.600
Validation loss decreased (-0.544436 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 3.4395971298217773
Epoch: 8, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.723 Vali Acc: 0.667 Test Loss: 0.723 Test Acc: 0.667
Validation loss decreased (-0.599992 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 3.2724826335906982
Epoch: 9, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.656 Vali Acc: 0.639 Test Loss: 0.656 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.640674114227295
Epoch: 10, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.557 Vali Acc: 0.739 Test Loss: 0.557 Test Acc: 0.739
Validation loss decreased (-0.666659 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 3.476423501968384
Epoch: 11, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.488 Vali Acc: 0.739 Test Loss: 0.488 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738884).  Saving model ...
Epoch: 12 cost time: 3.526787042617798
Epoch: 12, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.474 Vali Acc: 0.750 Test Loss: 0.474 Test Acc: 0.750
Validation loss decreased (-0.738884 --> -0.749995).  Saving model ...
Epoch: 13 cost time: 3.6213955879211426
Epoch: 13, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.423 Vali Acc: 0.772 Test Loss: 0.423 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 14 cost time: 3.713066577911377
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.401 Vali Acc: 0.772 Test Loss: 0.401 Test Acc: 0.772
Validation loss decreased (-0.772218 --> -0.772218).  Saving model ...
Epoch: 15 cost time: 3.489511251449585
Epoch: 15, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.428 Vali Acc: 0.789 Test Loss: 0.428 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 16 cost time: 3.8183975219726562
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.409 Vali Acc: 0.800 Test Loss: 0.409 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 17 cost time: 3.7077836990356445
Epoch: 17, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.352 Vali Acc: 0.800 Test Loss: 0.352 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 18 cost time: 3.254899024963379
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.376 Vali Acc: 0.778 Test Loss: 0.376 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.525235891342163
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.353 Vali Acc: 0.800 Test Loss: 0.353 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1950721740722656
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.342 Vali Acc: 0.800 Test Loss: 0.342 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799997).  Saving model ...
Epoch: 21 cost time: 3.25711727142334
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.799997 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 3.235201835632324
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2166976928710938
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.249901533126831
Epoch: 24, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.258476972579956
Epoch: 25, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 26 cost time: 3.462193489074707
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866663).  Saving model ...
Epoch: 27 cost time: 3.4272444248199463
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5254762172698975
Epoch: 28, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 29 cost time: 3.346020460128784
Epoch: 29, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4958574771881104
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.172224760055542
Epoch: 31, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.322392463684082
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 3.3627612590789795
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.692 Vali Acc: 0.856 Test Loss: 0.692 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.5300452709198
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.775686740875244
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.548 Vali Acc: 0.906 Test Loss: 0.548 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.4909019470214844
Epoch: 36, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.682793617248535
Epoch: 37, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 3.6963884830474854
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.222386360168457
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.2408335208892822
Epoch: 40, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.2981371879577637
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.3219733238220215
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.396329879760742
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.488813877105713
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.5358846187591553
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.518887996673584
Epoch: 46, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.7247567176818848
Epoch: 47, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 3.815605878829956
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.4687914848327637
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.906 Test Loss: 0.363 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.5004544258117676
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.5506865978240967
Epoch: 51, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.1379411220550537
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 53 cost time: 3.4624998569488525
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.321852207183838
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.6923789978027344
Epoch: 55, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.543513536453247
Epoch: 56, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.4913065433502197
Epoch: 57, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.508780002593994
Epoch: 58, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 59 cost time: 3.6110172271728516
Epoch: 59, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.4380438327789307
Epoch: 60, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.605957508087158
Epoch: 61, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.5516791343688965
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.3855440616607666
Epoch: 63, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.6392390727996826
Epoch: 64, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.7693870067596436
Epoch: 65, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 4.307727336883545
Epoch: 66, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.7788357734680176
Epoch: 67, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.9232754707336426
Epoch: 68, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.486229419708252
Epoch: 1, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.823 Vali Acc: 0.194 Test Loss: 1.823 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 3.4551689624786377
Epoch: 2, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.696 Vali Acc: 0.317 Test Loss: 1.696 Test Acc: 0.317
Validation loss decreased (-0.194426 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 3.446671485900879
Epoch: 3, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.483 Vali Acc: 0.456 Test Loss: 1.483 Test Acc: 0.456
Validation loss decreased (-0.316650 --> -0.455541).  Saving model ...
Epoch: 4 cost time: 3.4214022159576416
Epoch: 4, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.185 Vali Acc: 0.556 Test Loss: 1.185 Test Acc: 0.556
Validation loss decreased (-0.455541 --> -0.555544).  Saving model ...
Epoch: 5 cost time: 3.3049111366271973
Epoch: 5, Steps: 12 | Train Loss: 1.365 Vali Loss: 0.912 Vali Acc: 0.617 Test Loss: 0.912 Test Acc: 0.617
Validation loss decreased (-0.555544 --> -0.616658).  Saving model ...
Epoch: 6 cost time: 3.2466037273406982
Epoch: 6, Steps: 12 | Train Loss: 1.076 Vali Loss: 0.815 Vali Acc: 0.567 Test Loss: 0.815 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.517468214035034
Epoch: 7, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.769 Vali Acc: 0.589 Test Loss: 0.769 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.278601884841919
Epoch: 8, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.728 Vali Acc: 0.633 Test Loss: 0.728 Test Acc: 0.633
Validation loss decreased (-0.616658 --> -0.633326).  Saving model ...
Epoch: 9 cost time: 3.359635591506958
Epoch: 9, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.572 Vali Acc: 0.700 Test Loss: 0.572 Test Acc: 0.700
Validation loss decreased (-0.633326 --> -0.699994).  Saving model ...
Epoch: 10 cost time: 3.187852144241333
Epoch: 10, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.474 Vali Acc: 0.761 Test Loss: 0.474 Test Acc: 0.761
Validation loss decreased (-0.699994 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 3.5077497959136963
Epoch: 11, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.445 Vali Acc: 0.772 Test Loss: 0.445 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 12 cost time: 3.257650375366211
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.440 Vali Acc: 0.772 Test Loss: 0.440 Test Acc: 0.772
Validation loss decreased (-0.772218 --> -0.772218).  Saving model ...
Epoch: 13 cost time: 3.5460095405578613
Epoch: 13, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794441).  Saving model ...
Epoch: 14 cost time: 3.525667905807495
Epoch: 14, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.381 Vali Acc: 0.789 Test Loss: 0.381 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1793110370635986
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.405 Vali Acc: 0.811 Test Loss: 0.405 Test Acc: 0.811
Validation loss decreased (-0.794441 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 3.341479778289795
Epoch: 16, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 17 cost time: 3.435654401779175
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 18 cost time: 3.5017356872558594
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.365 Vali Acc: 0.789 Test Loss: 0.365 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1788692474365234
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 3.7036402225494385
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.700132369995117
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 3.4851255416870117
Epoch: 22, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.435 Vali Acc: 0.822 Test Loss: 0.435 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.706120491027832
Epoch: 23, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6407220363616943
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.353907346725464
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 26 cost time: 3.1955955028533936
Epoch: 26, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2639427185058594
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1919760704040527
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.499032974243164
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 30 cost time: 3.5324513912200928
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.549144744873047
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6469476222991943
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 33 cost time: 3.632901191711426
Epoch: 33, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4654083251953125
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 3.401144504547119
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.5814874172210693
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 37 cost time: 3.2734038829803467
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.838 Vali Acc: 0.872 Test Loss: 0.838 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.7626264095306396
Epoch: 38, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.57620906829834
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.639 Vali Acc: 0.861 Test Loss: 0.639 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.7664003372192383
Epoch: 40, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.9440011978149414
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.4821665287017822
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.755 Vali Acc: 0.861 Test Loss: 0.755 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.5618295669555664
Epoch: 43, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.834 Vali Acc: 0.878 Test Loss: 0.834 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.208494186401367
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.454 Vali Acc: 0.906 Test Loss: 0.454 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.2566583156585693
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.3360424041748047
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.21470046043396
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.807 Vali Acc: 0.217 Test Loss: 1.807 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 3.3026938438415527
Epoch: 2, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.695 Vali Acc: 0.306 Test Loss: 1.695 Test Acc: 0.306
Validation loss decreased (-0.216649 --> -0.305539).  Saving model ...
Epoch: 3 cost time: 3.3272063732147217
Epoch: 3, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.494 Vali Acc: 0.478 Test Loss: 1.494 Test Acc: 0.478
Validation loss decreased (-0.305539 --> -0.477763).  Saving model ...
Epoch: 4 cost time: 3.1185929775238037
Epoch: 4, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.214 Vali Acc: 0.550 Test Loss: 1.214 Test Acc: 0.550
Validation loss decreased (-0.477763 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 3.204868793487549
Epoch: 5, Steps: 12 | Train Loss: 1.407 Vali Loss: 0.933 Vali Acc: 0.572 Test Loss: 0.933 Test Acc: 0.572
Validation loss decreased (-0.549988 --> -0.572213).  Saving model ...
Epoch: 6 cost time: 3.3559014797210693
Epoch: 6, Steps: 12 | Train Loss: 1.187 Vali Loss: 0.821 Vali Acc: 0.589 Test Loss: 0.821 Test Acc: 0.589
Validation loss decreased (-0.572213 --> -0.588881).  Saving model ...
Epoch: 7 cost time: 3.3206026554107666
Epoch: 7, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.773 Vali Acc: 0.606 Test Loss: 0.773 Test Acc: 0.606
Validation loss decreased (-0.588881 --> -0.605548).  Saving model ...
Epoch: 8 cost time: 3.4811699390411377
Epoch: 8, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.711 Vali Acc: 0.639 Test Loss: 0.711 Test Acc: 0.639
Validation loss decreased (-0.605548 --> -0.638882).  Saving model ...
Epoch: 9 cost time: 3.72476863861084
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.605 Vali Acc: 0.656 Test Loss: 0.605 Test Acc: 0.656
Validation loss decreased (-0.638882 --> -0.655550).  Saving model ...
Epoch: 10 cost time: 3.3443288803100586
Epoch: 10, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.486 Vali Acc: 0.761 Test Loss: 0.486 Test Acc: 0.761
Validation loss decreased (-0.655550 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 3.5923123359680176
Epoch: 11, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.451 Vali Acc: 0.772 Test Loss: 0.451 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 12 cost time: 3.484210252761841
Epoch: 12, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.422 Vali Acc: 0.772 Test Loss: 0.422 Test Acc: 0.772
Validation loss decreased (-0.772218 --> -0.772218).  Saving model ...
Epoch: 13 cost time: 3.3879647254943848
Epoch: 13, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.381 Vali Acc: 0.783 Test Loss: 0.381 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783330).  Saving model ...
Epoch: 14 cost time: 3.3407583236694336
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.379 Vali Acc: 0.789 Test Loss: 0.379 Test Acc: 0.789
Validation loss decreased (-0.783330 --> -0.788885).  Saving model ...
Epoch: 15 cost time: 3.0819830894470215
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.425 Vali Acc: 0.789 Test Loss: 0.425 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2366788387298584
Epoch: 16, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.387 Vali Acc: 0.789 Test Loss: 0.387 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3055665493011475
Epoch: 17, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 18 cost time: 3.713336706161499
Epoch: 18, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.349 Vali Acc: 0.806 Test Loss: 0.349 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2006735801696777
Epoch: 19, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 20 cost time: 3.645108699798584
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.333 Vali Acc: 0.817 Test Loss: 0.333 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.100426197052002
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 3.0181963443756104
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2985825538635254
Epoch: 23, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.402899980545044
Epoch: 24, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3543174266815186
Epoch: 25, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3912272453308105
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 3.767038345336914
Epoch: 27, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5147757530212402
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
Validation loss decreased (-0.866664 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 3.671682834625244
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 3.3450253009796143
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4533140659332275
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3191323280334473
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.12359881401062
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.366929769515991
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3815553188323975
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.493338108062744
Epoch: 36, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 3.4076576232910156
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.436175584793091
Epoch: 38, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927776).  Saving model ...
Epoch: 39 cost time: 3.630690813064575
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.878 Test Loss: 0.482 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.9680275917053223
Epoch: 40, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.3631441593170166
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.255080461502075
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.4451751708984375
Epoch: 43, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.565763473510742
Epoch: 44, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.5739200115203857
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.6574552059173584
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.5754752159118652
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.628312349319458
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1000800132751465
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.2592062950134277
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.442368507385254
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3544280529022217
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3647351264953613
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.431674003601074
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.250321626663208
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.1349377632141113
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.319319486618042
Epoch: 9, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.400681734085083
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.9723961353302
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 714118
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.074706077575684
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.681 Vali Acc: 0.272 Test Loss: 1.681 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 3.4933154582977295
Epoch: 2, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.459 Vali Acc: 0.433 Test Loss: 1.459 Test Acc: 0.433
Validation loss decreased (-0.272205 --> -0.433319).  Saving model ...
Epoch: 3 cost time: 3.412219524383545
Epoch: 3, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.433319 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 3.321558952331543
Epoch: 4, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.116 Vali Acc: 0.567 Test Loss: 1.116 Test Acc: 0.567
Validation loss decreased (-0.499987 --> -0.566656).  Saving model ...
Epoch: 5 cost time: 3.078310251235962
Epoch: 5, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.979 Vali Acc: 0.656 Test Loss: 0.979 Test Acc: 0.656
Validation loss decreased (-0.566656 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 3.189938545227051
Epoch: 6, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.822 Vali Acc: 0.667 Test Loss: 0.822 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 3.29080867767334
Epoch: 7, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.716 Vali Acc: 0.683 Test Loss: 0.716 Test Acc: 0.683
Validation loss decreased (-0.666658 --> -0.683326).  Saving model ...
Epoch: 8 cost time: 3.503916025161743
Epoch: 8, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.602 Vali Acc: 0.733 Test Loss: 0.602 Test Acc: 0.733
Validation loss decreased (-0.683326 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 3.794188976287842
Epoch: 9, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.527 Vali Acc: 0.767 Test Loss: 0.527 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 3.6387150287628174
Epoch: 10, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.474 Vali Acc: 0.794 Test Loss: 0.474 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 3.6169016361236572
Epoch: 11, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 3.275541067123413
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.400 Vali Acc: 0.828 Test Loss: 0.400 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 3.1079697608947754
Epoch: 13, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 3.276603937149048
Epoch: 14, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.348254919052124
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 3.2015395164489746
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.386 Vali Acc: 0.833 Test Loss: 0.386 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.596395254135132
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 3.5989229679107666
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 3.7196033000946045
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.458 Vali Acc: 0.839 Test Loss: 0.458 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.460944175720215
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.536644220352173
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.387322425842285
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 3.654646873474121
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.186523199081421
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.71252179145813
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 3.737581968307495
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 3.5820841789245605
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.421520471572876
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 3.2558391094207764
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 30 cost time: 3.205873966217041
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1485345363616943
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.1913464069366455
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 3.32428240776062
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 34 cost time: 3.2999536991119385
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.65850830078125
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 3.200212240219116
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.3279619216918945
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3586487770080566
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.1625449657440186
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.362 Vali Acc: 0.883 Test Loss: 0.362 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0492711067199707
Epoch: 40, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.1081316471099854
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.533261299133301
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.475886344909668
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.1911873817443848
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.5408291816711426
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.216066360473633
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.765 Vali Acc: 0.211 Test Loss: 1.765 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 3.566619634628296
Epoch: 2, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.597 Vali Acc: 0.378 Test Loss: 1.597 Test Acc: 0.378
Validation loss decreased (-0.211093 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 3.262002944946289
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.433 Vali Acc: 0.428 Test Loss: 1.433 Test Acc: 0.428
Validation loss decreased (-0.377762 --> -0.427763).  Saving model ...
Epoch: 4 cost time: 3.2713494300842285
Epoch: 4, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.282 Vali Acc: 0.450 Test Loss: 1.282 Test Acc: 0.450
Validation loss decreased (-0.427763 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 3.1650447845458984
Epoch: 5, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.126 Vali Acc: 0.583 Test Loss: 1.126 Test Acc: 0.583
Validation loss decreased (-0.449987 --> -0.583322).  Saving model ...
Epoch: 6 cost time: 3.246358633041382
Epoch: 6, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
Validation loss decreased (-0.583322 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 3.4810402393341064
Epoch: 7, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.824 Vali Acc: 0.644 Test Loss: 0.824 Test Acc: 0.644
Validation loss decreased (-0.599990 --> -0.644436).  Saving model ...
Epoch: 8 cost time: 3.5479085445404053
Epoch: 8, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
Validation loss decreased (-0.644436 --> -0.716660).  Saving model ...
Epoch: 9 cost time: 3.543146848678589
Epoch: 9, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.594 Vali Acc: 0.728 Test Loss: 0.594 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 10 cost time: 3.3392605781555176
Epoch: 10, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749995).  Saving model ...
Epoch: 11 cost time: 3.5215256214141846
Epoch: 11, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.480 Vali Acc: 0.767 Test Loss: 0.480 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 3.254331588745117
Epoch: 12, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.442 Vali Acc: 0.783 Test Loss: 0.442 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 13 cost time: 3.6383345127105713
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.475 Vali Acc: 0.806 Test Loss: 0.475 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 3.4182772636413574
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.403 Vali Acc: 0.811 Test Loss: 0.403 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 3.542834758758545
Epoch: 15, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.393 Vali Acc: 0.789 Test Loss: 0.393 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.272019863128662
Epoch: 16, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.412 Vali Acc: 0.806 Test Loss: 0.412 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2479121685028076
Epoch: 17, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 18 cost time: 3.3014321327209473
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.36958384513855
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 3.1506965160369873
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.650336503982544
Epoch: 21, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8088343143463135
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.33837890625
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 3.2841849327087402
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.383 Vali Acc: 0.839 Test Loss: 0.383 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 25 cost time: 3.4062912464141846
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 3.2338900566101074
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.467855453491211
Epoch: 27, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.730959892272949
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 3.7115163803100586
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7783443927764893
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7992358207702637
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3958215713500977
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.509002447128296
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 3.470618963241577
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4465670585632324
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.6273107528686523
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.486093282699585
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.866957426071167
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.5211501121520996
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 40 cost time: 3.1697278022766113
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4597179889678955
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 3.1452434062957764
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1276731491088867
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.415013313293457
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.285781145095825
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.7606709003448486
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.699711799621582
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 48 cost time: 3.518557071685791
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2958123683929443
Epoch: 49, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.398 Vali Acc: 0.894 Test Loss: 0.398 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2769436836242676
Epoch: 50, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.49204421043396
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.508 Vali Acc: 0.894 Test Loss: 0.508 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.454744577407837
Epoch: 52, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.63315749168396
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 54 cost time: 3.7926487922668457
Epoch: 54, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 3.5439910888671875
Epoch: 55, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.48996901512146
Epoch: 56, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.337 Vali Acc: 0.928 Test Loss: 0.337 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 57 cost time: 3.6819698810577393
Epoch: 57, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.1924591064453125
Epoch: 58, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.521339178085327
Epoch: 59, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.475693941116333
Epoch: 60, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.572962522506714
Epoch: 61, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
Validation loss decreased (-0.927774 --> -0.933330).  Saving model ...
Epoch: 62 cost time: 3.386868953704834
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.363396167755127
Epoch: 63, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.2353789806365967
Epoch: 64, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.504713535308838
Epoch: 65, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.78745698928833
Epoch: 66, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.402702569961548
Epoch: 67, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 3.5730016231536865
Epoch: 68, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 3.3363101482391357
Epoch: 69, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 3.4719271659851074
Epoch: 70, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 3.323213577270508
Epoch: 71, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.303866863250732
Epoch: 1, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.822 Vali Acc: 0.156 Test Loss: 1.822 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 3.815959930419922
Epoch: 2, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.689 Vali Acc: 0.322 Test Loss: 1.689 Test Acc: 0.322
Validation loss decreased (-0.155537 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 3.5887725353240967
Epoch: 3, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
Validation loss decreased (-0.322205 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 3.6718509197235107
Epoch: 4, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.420 Vali Acc: 0.433 Test Loss: 1.420 Test Acc: 0.433
Validation loss decreased (-0.399985 --> -0.433319).  Saving model ...
Epoch: 5 cost time: 3.644547462463379
Epoch: 5, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.255 Vali Acc: 0.478 Test Loss: 1.255 Test Acc: 0.478
Validation loss decreased (-0.433319 --> -0.477765).  Saving model ...
Epoch: 6 cost time: 3.345322370529175
Epoch: 6, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.477765 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 3.474403142929077
Epoch: 7, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.924 Vali Acc: 0.572 Test Loss: 0.924 Test Acc: 0.572
Validation loss decreased (-0.533323 --> -0.572213).  Saving model ...
Epoch: 8 cost time: 3.053724765777588
Epoch: 8, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.772 Vali Acc: 0.650 Test Loss: 0.772 Test Acc: 0.650
Validation loss decreased (-0.572213 --> -0.649992).  Saving model ...
Epoch: 9 cost time: 3.596862554550171
Epoch: 9, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.698 Vali Acc: 0.633 Test Loss: 0.698 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.503864288330078
Epoch: 10, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.636 Vali Acc: 0.683 Test Loss: 0.636 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683327).  Saving model ...
Epoch: 11 cost time: 3.8280255794525146
Epoch: 11, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.550 Vali Acc: 0.739 Test Loss: 0.550 Test Acc: 0.739
Validation loss decreased (-0.683327 --> -0.738883).  Saving model ...
Epoch: 12 cost time: 3.6139800548553467
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.505 Vali Acc: 0.744 Test Loss: 0.505 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744439).  Saving model ...
Epoch: 13 cost time: 3.3617849349975586
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755550).  Saving model ...
Epoch: 14 cost time: 3.359869956970215
Epoch: 14, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.475 Vali Acc: 0.767 Test Loss: 0.475 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 3.6707043647766113
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.445 Vali Acc: 0.778 Test Loss: 0.445 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 3.370103597640991
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 17 cost time: 4.0047767162323
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.440 Vali Acc: 0.789 Test Loss: 0.440 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.62996506690979
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.445 Vali Acc: 0.772 Test Loss: 0.445 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.013266086578369
Epoch: 19, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.449 Vali Acc: 0.817 Test Loss: 0.449 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 3.65743350982666
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.430 Vali Acc: 0.789 Test Loss: 0.430 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3504881858825684
Epoch: 21, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.491 Vali Acc: 0.817 Test Loss: 0.491 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4335715770721436
Epoch: 22, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.423 Vali Acc: 0.806 Test Loss: 0.423 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5113983154296875
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.330059051513672
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.464 Vali Acc: 0.811 Test Loss: 0.464 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.5423192977905273
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.479 Vali Acc: 0.839 Test Loss: 0.479 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838884).  Saving model ...
Epoch: 26 cost time: 3.3577232360839844
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.490 Vali Acc: 0.811 Test Loss: 0.490 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5940659046173096
Epoch: 27, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.453 Vali Acc: 0.828 Test Loss: 0.453 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.602385997772217
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 29 cost time: 3.733905076980591
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 3.3784289360046387
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.437673568725586
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 3.616194486618042
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.597933053970337
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.433 Vali Acc: 0.861 Test Loss: 0.433 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 34 cost time: 3.662513017654419
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.413 Vali Acc: 0.883 Test Loss: 0.413 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883329).  Saving model ...
Epoch: 35 cost time: 3.4839088916778564
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.4927897453308105
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.204498529434204
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 38 cost time: 3.4258291721343994
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.619 Vali Acc: 0.872 Test Loss: 0.619 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0836918354034424
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.420 Vali Acc: 0.878 Test Loss: 0.420 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.9415674209594727
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.6670749187469482
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.834437608718872
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.453 Vali Acc: 0.883 Test Loss: 0.453 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.41054368019104
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.801 Vali Acc: 0.872 Test Loss: 0.801 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.135526180267334
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.532 Vali Acc: 0.883 Test Loss: 0.532 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.3195648193359375
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 3.13466739654541
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.785327196121216
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.421 Vali Acc: 0.883 Test Loss: 0.421 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.8269715309143066
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.5875606536865234
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 4.182954549789429
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 51 cost time: 3.5799217224121094
Epoch: 51, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.906 Test Loss: 0.441 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905551).  Saving model ...
Epoch: 52 cost time: 3.845172882080078
Epoch: 52, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.906 Test Loss: 0.387 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905552).  Saving model ...
Epoch: 53 cost time: 3.2826414108276367
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.530219078063965
Epoch: 54, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.894 Test Loss: 0.407 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.5814006328582764
Epoch: 55, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.2867677211761475
Epoch: 56, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.906 Test Loss: 0.429 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.604552984237671
Epoch: 57, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.894 Test Loss: 0.407 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.6184184551239014
Epoch: 58, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 4.013657569885254
Epoch: 59, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.906 Test Loss: 0.390 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.7688064575195312
Epoch: 60, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.5200917720794678
Epoch: 61, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.906 Test Loss: 0.429 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.5900230407714844
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911107).  Saving model ...
Epoch: 63 cost time: 3.414531707763672
Epoch: 63, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.906 Test Loss: 0.464 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.704840898513794
Epoch: 64, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 65 cost time: 3.721924304962158
Epoch: 65, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.911 Test Loss: 0.462 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.727506637573242
Epoch: 66, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.876185655593872
Epoch: 67, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 68 cost time: 3.52899432182312
Epoch: 68, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.583803415298462
Epoch: 69, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.906 Test Loss: 0.451 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.561126470565796
Epoch: 70, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.7810170650482178
Epoch: 71, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 4.014677286148071
Epoch: 72, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.800098180770874
Epoch: 73, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.901249647140503
Epoch: 74, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.906 Test Loss: 0.425 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 3.293189287185669
Epoch: 75, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 76 cost time: 3.4058613777160645
Epoch: 76, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.906 Test Loss: 0.503 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.3458898067474365
Epoch: 77, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 78 cost time: 3.7054026126861572
Epoch: 78, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
Validation loss decreased (-0.911107 --> -0.916663).  Saving model ...
Epoch: 79 cost time: 3.9111499786376953
Epoch: 79, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 3.611025810241699
Epoch: 80, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.424 Vali Acc: 0.906 Test Loss: 0.424 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 3.4385018348693848
Epoch: 81, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.114 Vali Acc: 0.878 Test Loss: 1.114 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 3.211587905883789
Epoch: 82, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 3.2425055503845215
Epoch: 83, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 3.792173147201538
Epoch: 84, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 3.819164276123047
Epoch: 85, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.106 Vali Acc: 0.883 Test Loss: 1.106 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 3.860592842102051
Epoch: 86, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.944 Vali Acc: 0.878 Test Loss: 0.944 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 3.7939293384552
Epoch: 87, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.735 Vali Acc: 0.883 Test Loss: 0.735 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 3.5397913455963135
Epoch: 88, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.917 Test Loss: 0.558 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.250789165496826
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.800 Vali Acc: 0.183 Test Loss: 1.800 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 3.4741742610931396
Epoch: 2, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.697 Vali Acc: 0.233 Test Loss: 1.697 Test Acc: 0.233
Validation loss decreased (-0.183315 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 3.5581912994384766
Epoch: 3, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.589 Vali Acc: 0.267 Test Loss: 1.589 Test Acc: 0.267
Validation loss decreased (-0.233316 --> -0.266651).  Saving model ...
Epoch: 4 cost time: 3.051755666732788
Epoch: 4, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.458 Vali Acc: 0.328 Test Loss: 1.458 Test Acc: 0.328
Validation loss decreased (-0.266651 --> -0.327763).  Saving model ...
Epoch: 5 cost time: 3.3603532314300537
Epoch: 5, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.260 Vali Acc: 0.489 Test Loss: 1.260 Test Acc: 0.489
Validation loss decreased (-0.327763 --> -0.488876).  Saving model ...
Epoch: 6 cost time: 3.1566874980926514
Epoch: 6, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.023 Vali Acc: 0.583 Test Loss: 1.023 Test Acc: 0.583
Validation loss decreased (-0.488876 --> -0.583323).  Saving model ...
Epoch: 7 cost time: 3.1836321353912354
Epoch: 7, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.853 Vali Acc: 0.622 Test Loss: 0.853 Test Acc: 0.622
Validation loss decreased (-0.583323 --> -0.622214).  Saving model ...
Epoch: 8 cost time: 3.441096782684326
Epoch: 8, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.762 Vali Acc: 0.639 Test Loss: 0.762 Test Acc: 0.639
Validation loss decreased (-0.622214 --> -0.638881).  Saving model ...
Epoch: 9 cost time: 3.3637092113494873
Epoch: 9, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.710 Vali Acc: 0.650 Test Loss: 0.710 Test Acc: 0.650
Validation loss decreased (-0.638881 --> -0.649993).  Saving model ...
Epoch: 10 cost time: 3.7343995571136475
Epoch: 10, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.619 Vali Acc: 0.711 Test Loss: 0.619 Test Acc: 0.711
Validation loss decreased (-0.649993 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 3.3060050010681152
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.513 Vali Acc: 0.728 Test Loss: 0.513 Test Acc: 0.728
Validation loss decreased (-0.711105 --> -0.727773).  Saving model ...
Epoch: 12 cost time: 3.0429110527038574
Epoch: 12, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
Validation loss decreased (-0.727773 --> -0.783329).  Saving model ...
Epoch: 13 cost time: 3.454207181930542
Epoch: 13, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.476 Vali Acc: 0.750 Test Loss: 0.476 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3430957794189453
Epoch: 14, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.443 Vali Acc: 0.767 Test Loss: 0.443 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.566556930541992
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.408 Vali Acc: 0.806 Test Loss: 0.408 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 3.4106767177581787
Epoch: 16, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 3.7272441387176514
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.402 Vali Acc: 0.806 Test Loss: 0.402 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3264870643615723
Epoch: 18, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.436 Vali Acc: 0.778 Test Loss: 0.436 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.129385232925415
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.412 Vali Acc: 0.811 Test Loss: 0.412 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4605894088745117
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.392 Vali Acc: 0.811 Test Loss: 0.392 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 3.615927219390869
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 3.8053202629089355
Epoch: 22, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.413 Vali Acc: 0.822 Test Loss: 0.413 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3846561908721924
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 3.569395065307617
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5135960578918457
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 26 cost time: 2.9747700691223145
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 3.1210250854492188
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861107).  Saving model ...
Epoch: 28 cost time: 2.999448537826538
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1489546298980713
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4902024269104004
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 31 cost time: 3.3936495780944824
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.264758825302124
Epoch: 32, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.7242109775543213
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.420 Vali Acc: 0.872 Test Loss: 0.420 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 3.533034324645996
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.477 Vali Acc: 0.883 Test Loss: 0.477 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 35 cost time: 3.356013774871826
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.716620683670044
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.363 Vali Acc: 0.872 Test Loss: 0.363 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.9265763759613037
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 3.7573163509368896
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.404 Vali Acc: 0.894 Test Loss: 0.404 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.8460772037506104
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 40 cost time: 3.8477156162261963
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.467825412750244
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.2105391025543213
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.455 Vali Acc: 0.894 Test Loss: 0.455 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.426839590072632
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.7678372859954834
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.429 Vali Acc: 0.906 Test Loss: 0.429 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.5272879600524902
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.4348769187927246
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.6923069953918457
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.644 Vali Acc: 0.883 Test Loss: 0.644 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.4530766010284424
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.605 Vali Acc: 0.883 Test Loss: 0.605 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.7802226543426514
Epoch: 49, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.520 Vali Acc: 0.894 Test Loss: 0.520 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.316778182983398
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.833 Vali Acc: 0.167 Test Loss: 1.833 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 3.4435527324676514
Epoch: 2, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.745 Vali Acc: 0.228 Test Loss: 1.745 Test Acc: 0.228
Validation loss decreased (-0.166648 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 3.3308286666870117
Epoch: 3, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.617 Vali Acc: 0.356 Test Loss: 1.617 Test Acc: 0.356
Validation loss decreased (-0.227760 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 3.7950875759124756
Epoch: 4, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.394 Vali Acc: 0.489 Test Loss: 1.394 Test Acc: 0.489
Validation loss decreased (-0.355539 --> -0.488875).  Saving model ...
Epoch: 5 cost time: 3.653470993041992
Epoch: 5, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.079 Vali Acc: 0.617 Test Loss: 1.079 Test Acc: 0.617
Validation loss decreased (-0.488875 --> -0.616656).  Saving model ...
Epoch: 6 cost time: 3.533755302429199
Epoch: 6, Steps: 12 | Train Loss: 1.150 Vali Loss: 0.830 Vali Acc: 0.617 Test Loss: 0.830 Test Acc: 0.617
Validation loss decreased (-0.616656 --> -0.616658).  Saving model ...
Epoch: 7 cost time: 3.644181489944458
Epoch: 7, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.743 Vali Acc: 0.628 Test Loss: 0.743 Test Acc: 0.628
Validation loss decreased (-0.616658 --> -0.627770).  Saving model ...
Epoch: 8 cost time: 3.2724199295043945
Epoch: 8, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.677 Vali Acc: 0.644 Test Loss: 0.677 Test Acc: 0.644
Validation loss decreased (-0.627770 --> -0.644438).  Saving model ...
Epoch: 9 cost time: 3.4003591537475586
Epoch: 9, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.610 Vali Acc: 0.678 Test Loss: 0.610 Test Acc: 0.678
Validation loss decreased (-0.644438 --> -0.677772).  Saving model ...
Epoch: 10 cost time: 3.4819822311401367
Epoch: 10, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.514 Vali Acc: 0.744 Test Loss: 0.514 Test Acc: 0.744
Validation loss decreased (-0.677772 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 3.568247079849243
Epoch: 11, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.434 Vali Acc: 0.750 Test Loss: 0.434 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749996).  Saving model ...
Epoch: 12 cost time: 3.615408420562744
Epoch: 12, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.379 Vali Acc: 0.761 Test Loss: 0.379 Test Acc: 0.761
Validation loss decreased (-0.749996 --> -0.761107).  Saving model ...
Epoch: 13 cost time: 3.752790689468384
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
Validation loss decreased (-0.761107 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 3.15505313873291
Epoch: 14, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.359 Vali Acc: 0.794 Test Loss: 0.359 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.147902727127075
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.330 Vali Acc: 0.800 Test Loss: 0.330 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6200006008148193
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.341 Vali Acc: 0.794 Test Loss: 0.341 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.099155902862549
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 2.9581615924835205
Epoch: 18, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.385 Vali Acc: 0.794 Test Loss: 0.385 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4826178550720215
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.322 Vali Acc: 0.811 Test Loss: 0.322 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1008219718933105
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 21 cost time: 2.986694097518921
Epoch: 21, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.355 Vali Acc: 0.800 Test Loss: 0.355 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6865792274475098
Epoch: 22, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6232376098632812
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
Validation loss decreased (-0.827775 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 3.527289628982544
Epoch: 24, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.302 Vali Acc: 0.817 Test Loss: 0.302 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.168330430984497
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4325008392333984
Epoch: 26, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 27 cost time: 3.3116707801818848
Epoch: 27, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5746655464172363
Epoch: 28, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 29 cost time: 3.406745672225952
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 3.5624876022338867
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1504292488098145
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 32 cost time: 3.3022866249084473
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2224459648132324
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.905552 --> -0.927775).  Saving model ...
Epoch: 34 cost time: 3.5312929153442383
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6713271141052246
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.361867666244507
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.0742735862731934
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.357121229171753
Epoch: 38, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.787 Vali Acc: 0.883 Test Loss: 0.787 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.0742146968841553
Epoch: 39, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.409 Vali Acc: 0.917 Test Loss: 0.409 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.302419900894165
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.484713554382324
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.4074504375457764
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 3.1781105995178223
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.422 Vali Acc: 0.922 Test Loss: 0.422 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2441623210906982
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.358790636062622
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.928 Test Loss: 0.307 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.5782692432403564
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.5202081203460693
Epoch: 47, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.424 Vali Acc: 0.928 Test Loss: 0.424 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.5453085899353027
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.378082752227783
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.257882833480835
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.403 Vali Acc: 0.939 Test Loss: 0.403 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938885).  Saving model ...
Epoch: 51 cost time: 3.3590469360351562
Epoch: 51, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.928 Test Loss: 0.315 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.8650951385498047
Epoch: 52, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.694 Vali Acc: 0.906 Test Loss: 0.694 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.463815689086914
Epoch: 53, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.401601791381836
Epoch: 54, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.514394760131836
Epoch: 55, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.168616533279419
Epoch: 56, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.3340327739715576
Epoch: 57, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.7036802768707275
Epoch: 58, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.939 Test Loss: 0.263 Test Acc: 0.939
Validation loss decreased (-0.938885 --> -0.938886).  Saving model ...
Epoch: 59 cost time: 3.4757609367370605
Epoch: 59, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.928 Test Loss: 0.451 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.3713173866271973
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.944 Test Loss: 0.341 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944441).  Saving model ...
Epoch: 61 cost time: 3.2669713497161865
Epoch: 61, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.0335330963134766
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.928 Test Loss: 0.296 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.355585813522339
Epoch: 63, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.7169737815856934
Epoch: 64, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.939 Test Loss: 0.291 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.6190717220306396
Epoch: 65, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.534888982772827
Epoch: 66, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.928 Test Loss: 0.302 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.3310956954956055
Epoch: 67, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.168485403060913
Epoch: 68, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.3800573348999023
Epoch: 69, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 3.6151676177978516
Epoch: 70, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.928 Test Loss: 0.285 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.166388034820557
Epoch: 1, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.792 Vali Acc: 0.200 Test Loss: 1.792 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 3.248929738998413
Epoch: 2, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.662 Vali Acc: 0.306 Test Loss: 1.662 Test Acc: 0.306
Validation loss decreased (-0.199982 --> -0.305539).  Saving model ...
Epoch: 3 cost time: 3.0239686965942383
Epoch: 3, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.462 Vali Acc: 0.467 Test Loss: 1.462 Test Acc: 0.467
Validation loss decreased (-0.305539 --> -0.466652).  Saving model ...
Epoch: 4 cost time: 3.3804678916931152
Epoch: 4, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.191 Vali Acc: 0.533 Test Loss: 1.191 Test Acc: 0.533
Validation loss decreased (-0.466652 --> -0.533321).  Saving model ...
Epoch: 5 cost time: 3.257181406021118
Epoch: 5, Steps: 12 | Train Loss: 1.454 Vali Loss: 0.944 Vali Acc: 0.628 Test Loss: 0.944 Test Acc: 0.628
Validation loss decreased (-0.533321 --> -0.627768).  Saving model ...
Epoch: 6 cost time: 3.145073175430298
Epoch: 6, Steps: 12 | Train Loss: 1.103 Vali Loss: 0.811 Vali Acc: 0.617 Test Loss: 0.811 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.199354887008667
Epoch: 7, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.774 Vali Acc: 0.606 Test Loss: 0.774 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2159855365753174
Epoch: 8, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.703 Vali Acc: 0.628 Test Loss: 0.703 Test Acc: 0.628
Validation loss decreased (-0.627768 --> -0.627771).  Saving model ...
Epoch: 9 cost time: 3.365835666656494
Epoch: 9, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.607 Vali Acc: 0.683 Test Loss: 0.607 Test Acc: 0.683
Validation loss decreased (-0.627771 --> -0.683327).  Saving model ...
Epoch: 10 cost time: 3.416529893875122
Epoch: 10, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.531 Vali Acc: 0.722 Test Loss: 0.531 Test Acc: 0.722
Validation loss decreased (-0.683327 --> -0.722217).  Saving model ...
Epoch: 11 cost time: 3.7957377433776855
Epoch: 11, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.478 Vali Acc: 0.772 Test Loss: 0.478 Test Acc: 0.772
Validation loss decreased (-0.722217 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 3.5442352294921875
Epoch: 12, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.428 Vali Acc: 0.772 Test Loss: 0.428 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 13 cost time: 3.3361003398895264
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.449 Vali Acc: 0.783 Test Loss: 0.449 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 14 cost time: 3.323298215866089
Epoch: 14, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.402 Vali Acc: 0.783 Test Loss: 0.402 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 3.145202159881592
Epoch: 15, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.366 Vali Acc: 0.806 Test Loss: 0.366 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 16 cost time: 3.692364454269409
Epoch: 16, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 3.698728322982788
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.383 Vali Acc: 0.811 Test Loss: 0.383 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7766947746276855
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.434 Vali Acc: 0.822 Test Loss: 0.434 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.610511302947998
Epoch: 19, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.573730230331421
Epoch: 20, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.368 Vali Acc: 0.806 Test Loss: 0.368 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.368638277053833
Epoch: 21, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.403 Vali Acc: 0.828 Test Loss: 0.403 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 3.5135374069213867
Epoch: 22, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 23 cost time: 3.467144727706909
Epoch: 23, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 24 cost time: 3.5172910690307617
Epoch: 24, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.331042528152466
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.381 Vali Acc: 0.856 Test Loss: 0.381 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 3.2759337425231934
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8169198036193848
Epoch: 27, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4708352088928223
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 3.8437955379486084
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2285215854644775
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.460622549057007
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.877773 --> -0.905552).  Saving model ...
Epoch: 32 cost time: 3.3100154399871826
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.791193962097168
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 3.6759960651397705
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.53794527053833
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3897271156311035
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1500296592712402
Epoch: 37, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.4564402103424072
Epoch: 38, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.413 Vali Acc: 0.906 Test Loss: 0.413 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.143887758255005
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.538 Vali Acc: 0.894 Test Loss: 0.538 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.347360610961914
Epoch: 40, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.2911264896392822
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.2638444900512695
Epoch: 42, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.600 Vali Acc: 0.911 Test Loss: 0.600 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.269470691680908
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.859451770782471
Epoch: 1, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.759 Vali Acc: 0.206 Test Loss: 1.759 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 3.3598437309265137
Epoch: 2, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.640 Vali Acc: 0.322 Test Loss: 1.640 Test Acc: 0.322
Validation loss decreased (-0.205538 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 3.090019464492798
Epoch: 3, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.444 Vali Acc: 0.472 Test Loss: 1.444 Test Acc: 0.472
Validation loss decreased (-0.322206 --> -0.472208).  Saving model ...
Epoch: 4 cost time: 3.2693865299224854
Epoch: 4, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.174 Vali Acc: 0.617 Test Loss: 1.174 Test Acc: 0.617
Validation loss decreased (-0.472208 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 3.0694973468780518
Epoch: 5, Steps: 12 | Train Loss: 1.486 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4447972774505615
Epoch: 6, Steps: 12 | Train Loss: 1.165 Vali Loss: 0.800 Vali Acc: 0.628 Test Loss: 0.800 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627770).  Saving model ...
Epoch: 7 cost time: 3.1441686153411865
Epoch: 7, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.764 Vali Acc: 0.644 Test Loss: 0.764 Test Acc: 0.644
Validation loss decreased (-0.627770 --> -0.644437).  Saving model ...
Epoch: 8 cost time: 3.1540136337280273
Epoch: 8, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.735 Vali Acc: 0.667 Test Loss: 0.735 Test Acc: 0.667
Validation loss decreased (-0.644437 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 3.4261281490325928
Epoch: 9, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.626 Vali Acc: 0.678 Test Loss: 0.626 Test Acc: 0.678
Validation loss decreased (-0.666659 --> -0.677772).  Saving model ...
Epoch: 10 cost time: 3.208371639251709
Epoch: 10, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.527 Vali Acc: 0.739 Test Loss: 0.527 Test Acc: 0.739
Validation loss decreased (-0.677772 --> -0.738884).  Saving model ...
Epoch: 11 cost time: 3.351947784423828
Epoch: 11, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.440 Vali Acc: 0.767 Test Loss: 0.440 Test Acc: 0.767
Validation loss decreased (-0.738884 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 3.2348296642303467
Epoch: 12, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.413 Vali Acc: 0.783 Test Loss: 0.413 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 13 cost time: 3.2580857276916504
Epoch: 13, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.454 Vali Acc: 0.783 Test Loss: 0.454 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2074906826019287
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.388 Vali Acc: 0.789 Test Loss: 0.388 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 15 cost time: 2.896498680114746
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.358 Vali Acc: 0.789 Test Loss: 0.358 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788885).  Saving model ...
Epoch: 16 cost time: 2.911896228790283
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 3.082498788833618
Epoch: 17, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.359 Vali Acc: 0.806 Test Loss: 0.359 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.972325086593628
Epoch: 18, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.436 Vali Acc: 0.783 Test Loss: 0.436 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2069170475006104
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 20 cost time: 2.8789288997650146
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.148939847946167
Epoch: 21, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2983646392822266
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 3.2536110877990723
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 2.958530902862549
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.428032875061035
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3764147758483887
Epoch: 26, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.207512140274048
Epoch: 27, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.377897024154663
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.4410572052001953
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.3134634494781494
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 3.352473497390747
Epoch: 31, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.331191301345825
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.282487154006958
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.894442 --> -0.927775).  Saving model ...
Epoch: 34 cost time: 3.128699779510498
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.98394513130188
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.399406909942627
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.2416772842407227
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.145927906036377
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1363046169281006
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.3429155349731445
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.3127880096435547
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.4786593914031982
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.527620792388916
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.454 Vali Acc: 0.906 Test Loss: 0.454 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.258686065673828
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.174858331680298
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.407071113586426
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.1982855796813965
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.2338082790374756
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.269514799118042
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.206883192062378
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 3.312438726425171
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 3.2123074531555176
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.271982192993164
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1685521602630615
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.1639671325683594
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2698702812194824
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.226766586303711
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 3.2265818119049072
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3374204635620117
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3373963832855225
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4519906044006348
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.314732313156128
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 3.4087486267089844
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 3.3728044033050537
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.46103572845459
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5077579021453857
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 3.6351113319396973
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 3.291316509246826
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 3.524919271469116
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.355473518371582
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.110534906387329
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1678295135498047
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.26137375831604
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2854855060577393
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.539965867996216
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.5430641174316406
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.6445415019989014
Epoch: 34, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.1868793964385986
Epoch: 35, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 615814
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.367108345031738
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.799 Vali Acc: 0.144 Test Loss: 1.799 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 3.897207736968994
Epoch: 2, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.603 Vali Acc: 0.383 Test Loss: 1.603 Test Acc: 0.383
Validation loss decreased (-0.144426 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 3.548872947692871
Epoch: 3, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.412 Vali Acc: 0.506 Test Loss: 1.412 Test Acc: 0.506
Validation loss decreased (-0.383317 --> -0.505541).  Saving model ...
Epoch: 4 cost time: 3.774632453918457
Epoch: 4, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.505541 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 3.5302839279174805
Epoch: 5, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.139 Vali Acc: 0.572 Test Loss: 1.139 Test Acc: 0.572
Validation loss decreased (-0.549987 --> -0.572211).  Saving model ...
Epoch: 6 cost time: 3.5499346256256104
Epoch: 6, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.033 Vali Acc: 0.594 Test Loss: 1.033 Test Acc: 0.594
Validation loss decreased (-0.572211 --> -0.594434).  Saving model ...
Epoch: 7 cost time: 3.266831398010254
Epoch: 7, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.923 Vali Acc: 0.644 Test Loss: 0.923 Test Acc: 0.644
Validation loss decreased (-0.594434 --> -0.644435).  Saving model ...
Epoch: 8 cost time: 3.3060789108276367
Epoch: 8, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.823 Vali Acc: 0.639 Test Loss: 0.823 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4887218475341797
Epoch: 9, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.703 Vali Acc: 0.706 Test Loss: 0.703 Test Acc: 0.706
Validation loss decreased (-0.644435 --> -0.705549).  Saving model ...
Epoch: 10 cost time: 3.5123345851898193
Epoch: 10, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.656 Vali Acc: 0.706 Test Loss: 0.656 Test Acc: 0.706
Validation loss decreased (-0.705549 --> -0.705549).  Saving model ...
Epoch: 11 cost time: 2.9190094470977783
Epoch: 11, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.571 Vali Acc: 0.711 Test Loss: 0.571 Test Acc: 0.711
Validation loss decreased (-0.705549 --> -0.711105).  Saving model ...
Epoch: 12 cost time: 3.7927134037017822
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.527 Vali Acc: 0.739 Test Loss: 0.527 Test Acc: 0.739
Validation loss decreased (-0.711105 --> -0.738884).  Saving model ...
Epoch: 13 cost time: 3.5441112518310547
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.475 Vali Acc: 0.778 Test Loss: 0.475 Test Acc: 0.778
Validation loss decreased (-0.738884 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 3.3254542350769043
Epoch: 14, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.454 Vali Acc: 0.783 Test Loss: 0.454 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 3.6248433589935303
Epoch: 15, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.411 Vali Acc: 0.822 Test Loss: 0.411 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 3.0529305934906006
Epoch: 16, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.431 Vali Acc: 0.789 Test Loss: 0.431 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3255362510681152
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.384 Vali Acc: 0.817 Test Loss: 0.384 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8265857696533203
Epoch: 18, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 3.5912673473358154
Epoch: 19, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7983899116516113
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.356 Vali Acc: 0.811 Test Loss: 0.356 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.583940029144287
Epoch: 21, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.331 Vali Acc: 0.867 Test Loss: 0.331 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 3.2130167484283447
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5473406314849854
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.391981363296509
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4712445735931396
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 3.402139186859131
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.324 Vali Acc: 0.867 Test Loss: 0.324 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2063348293304443
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.381033182144165
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 3.1489663124084473
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4750266075134277
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.209418773651123
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.678633213043213
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.3618180751800537
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.3921518325805664
Epoch: 34, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3375794887542725
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.347 Vali Acc: 0.867 Test Loss: 0.347 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.3465986251831055
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3291943073272705
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.1694154739379883
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.068073034286499
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.829 Vali Acc: 0.144 Test Loss: 1.829 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 3.6293444633483887
Epoch: 2, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.691 Vali Acc: 0.322 Test Loss: 1.691 Test Acc: 0.322
Validation loss decreased (-0.144426 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 3.635389566421509
Epoch: 3, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.537 Vali Acc: 0.417 Test Loss: 1.537 Test Acc: 0.417
Validation loss decreased (-0.322205 --> -0.416651).  Saving model ...
Epoch: 4 cost time: 2.969404935836792
Epoch: 4, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.395 Vali Acc: 0.483 Test Loss: 1.395 Test Acc: 0.483
Validation loss decreased (-0.416651 --> -0.483319).  Saving model ...
Epoch: 5 cost time: 3.2481844425201416
Epoch: 5, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.265 Vali Acc: 0.483 Test Loss: 1.265 Test Acc: 0.483
Validation loss decreased (-0.483319 --> -0.483321).  Saving model ...
Epoch: 6 cost time: 3.3450591564178467
Epoch: 6, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.164 Vali Acc: 0.494 Test Loss: 1.164 Test Acc: 0.494
Validation loss decreased (-0.483321 --> -0.494433).  Saving model ...
Epoch: 7 cost time: 3.2671902179718018
Epoch: 7, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.054 Vali Acc: 0.589 Test Loss: 1.054 Test Acc: 0.589
Validation loss decreased (-0.494433 --> -0.588878).  Saving model ...
Epoch: 8 cost time: 3.708552122116089
Epoch: 8, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.941 Vali Acc: 0.606 Test Loss: 0.941 Test Acc: 0.606
Validation loss decreased (-0.588878 --> -0.605546).  Saving model ...
Epoch: 9 cost time: 3.430438280105591
Epoch: 9, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.814 Vali Acc: 0.650 Test Loss: 0.814 Test Acc: 0.650
Validation loss decreased (-0.605546 --> -0.649992).  Saving model ...
Epoch: 10 cost time: 3.5092129707336426
Epoch: 10, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.744 Vali Acc: 0.683 Test Loss: 0.744 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683326).  Saving model ...
Epoch: 11 cost time: 3.2234816551208496
Epoch: 11, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727771).  Saving model ...
Epoch: 12 cost time: 3.4010910987854004
Epoch: 12, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.591 Vali Acc: 0.728 Test Loss: 0.591 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727772).  Saving model ...
Epoch: 13 cost time: 3.2999086380004883
Epoch: 13, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.525 Vali Acc: 0.744 Test Loss: 0.525 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 14 cost time: 3.123804807662964
Epoch: 14, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.499 Vali Acc: 0.750 Test Loss: 0.499 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 15 cost time: 3.606959104537964
Epoch: 15, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.452 Vali Acc: 0.772 Test Loss: 0.452 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 16 cost time: 3.429147720336914
Epoch: 16, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.443 Vali Acc: 0.778 Test Loss: 0.443 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777773).  Saving model ...
Epoch: 17 cost time: 3.636594533920288
Epoch: 17, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 18 cost time: 3.5963802337646484
Epoch: 18, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.390 Vali Acc: 0.800 Test Loss: 0.390 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 3.592494249343872
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.385 Vali Acc: 0.828 Test Loss: 0.385 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 3.422553062438965
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.376 Vali Acc: 0.794 Test Loss: 0.376 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6499006748199463
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6823084354400635
Epoch: 22, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.404 Vali Acc: 0.817 Test Loss: 0.404 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1772372722625732
Epoch: 23, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2256641387939453
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4687857627868652
Epoch: 25, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 3.341825008392334
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.369846820831299
Epoch: 27, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.359525203704834
Epoch: 28, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 3.4647414684295654
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 3.3916516304016113
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 31 cost time: 3.301130771636963
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 32 cost time: 4.067278146743774
Epoch: 32, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.538261651992798
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5917367935180664
Epoch: 34, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.5102713108062744
Epoch: 35, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.422559976577759
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 3.447993040084839
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 3.7105767726898193
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.3704261779785156
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.445 Vali Acc: 0.883 Test Loss: 0.445 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.400045156478882
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 41 cost time: 3.51369047164917
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.359 Vali Acc: 0.894 Test Loss: 0.359 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.2930164337158203
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.455888509750366
Epoch: 43, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.536541223526001
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.379 Vali Acc: 0.883 Test Loss: 0.379 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.9310269355773926
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.4692797660827637
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.454 Vali Acc: 0.894 Test Loss: 0.454 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.7203588485717773
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.372199296951294
Epoch: 48, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 49 cost time: 3.4800615310668945
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.5331921577453613
Epoch: 50, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.484567165374756
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.4513373374938965
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.6586594581604004
Epoch: 53, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.433 Vali Acc: 0.894 Test Loss: 0.433 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.260010242462158
Epoch: 54, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.387 Vali Acc: 0.883 Test Loss: 0.387 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.3063461780548096
Epoch: 55, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.4052765369415283
Epoch: 56, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.738 Vali Acc: 0.856 Test Loss: 0.738 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.486048698425293
Epoch: 57, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.009676456451416
Epoch: 58, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.067941904067993
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.830 Vali Acc: 0.178 Test Loss: 1.830 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 3.319049835205078
Epoch: 2, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.726 Vali Acc: 0.217 Test Loss: 1.726 Test Acc: 0.217
Validation loss decreased (-0.177759 --> -0.216649).  Saving model ...
Epoch: 3 cost time: 3.211911916732788
Epoch: 3, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.610 Vali Acc: 0.339 Test Loss: 1.610 Test Acc: 0.339
Validation loss decreased (-0.216649 --> -0.338873).  Saving model ...
Epoch: 4 cost time: 3.1461215019226074
Epoch: 4, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.495 Vali Acc: 0.394 Test Loss: 1.495 Test Acc: 0.394
Validation loss decreased (-0.338873 --> -0.394429).  Saving model ...
Epoch: 5 cost time: 3.6548118591308594
Epoch: 5, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.390 Vali Acc: 0.428 Test Loss: 1.390 Test Acc: 0.428
Validation loss decreased (-0.394429 --> -0.427764).  Saving model ...
Epoch: 6 cost time: 3.3962512016296387
Epoch: 6, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.297 Vali Acc: 0.428 Test Loss: 1.297 Test Acc: 0.428
Validation loss decreased (-0.427764 --> -0.427765).  Saving model ...
Epoch: 7 cost time: 3.070591926574707
Epoch: 7, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.206 Vali Acc: 0.461 Test Loss: 1.206 Test Acc: 0.461
Validation loss decreased (-0.427765 --> -0.461099).  Saving model ...
Epoch: 8 cost time: 3.300966262817383
Epoch: 8, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.100 Vali Acc: 0.483 Test Loss: 1.100 Test Acc: 0.483
Validation loss decreased (-0.461099 --> -0.483322).  Saving model ...
Epoch: 9 cost time: 3.3736324310302734
Epoch: 9, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.965 Vali Acc: 0.533 Test Loss: 0.965 Test Acc: 0.533
Validation loss decreased (-0.483322 --> -0.533324).  Saving model ...
Epoch: 10 cost time: 3.477611541748047
Epoch: 10, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.874 Vali Acc: 0.589 Test Loss: 0.874 Test Acc: 0.589
Validation loss decreased (-0.533324 --> -0.588880).  Saving model ...
Epoch: 11 cost time: 3.5861568450927734
Epoch: 11, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.771 Vali Acc: 0.650 Test Loss: 0.771 Test Acc: 0.650
Validation loss decreased (-0.588880 --> -0.649992).  Saving model ...
Epoch: 12 cost time: 3.33774471282959
Epoch: 12, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.682 Vali Acc: 0.672 Test Loss: 0.682 Test Acc: 0.672
Validation loss decreased (-0.649992 --> -0.672215).  Saving model ...
Epoch: 13 cost time: 3.1139702796936035
Epoch: 13, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.631 Vali Acc: 0.711 Test Loss: 0.631 Test Acc: 0.711
Validation loss decreased (-0.672215 --> -0.711105).  Saving model ...
Epoch: 14 cost time: 3.5115461349487305
Epoch: 14, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.566 Vali Acc: 0.728 Test Loss: 0.566 Test Acc: 0.728
Validation loss decreased (-0.711105 --> -0.727772).  Saving model ...
Epoch: 15 cost time: 3.388801336288452
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.503 Vali Acc: 0.767 Test Loss: 0.503 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766662).  Saving model ...
Epoch: 16 cost time: 3.4137797355651855
Epoch: 16, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.479 Vali Acc: 0.794 Test Loss: 0.479 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 3.464404821395874
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.451 Vali Acc: 0.767 Test Loss: 0.451 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.525022506713867
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 3.586939573287964
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.410 Vali Acc: 0.783 Test Loss: 0.410 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.287766933441162
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 3.2451460361480713
Epoch: 21, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.375 Vali Acc: 0.800 Test Loss: 0.375 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.436706066131592
Epoch: 22, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 23 cost time: 3.5977258682250977
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 3.633383274078369
Epoch: 24, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2493667602539062
Epoch: 25, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3056068420410156
Epoch: 26, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.475383758544922
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 3.7618956565856934
Epoch: 28, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.7005796432495117
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 3.307469129562378
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.373 Vali Acc: 0.856 Test Loss: 0.373 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 31 cost time: 3.437391757965088
Epoch: 31, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 3.4518518447875977
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.424 Vali Acc: 0.872 Test Loss: 0.424 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 33 cost time: 3.283515214920044
Epoch: 33, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.664893865585327
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.4967269897460938
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.308983087539673
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 3.370209217071533
Epoch: 37, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.362 Vali Acc: 0.878 Test Loss: 0.362 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.266193151473999
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.408 Vali Acc: 0.872 Test Loss: 0.408 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.177584648132324
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.416 Vali Acc: 0.856 Test Loss: 0.416 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.063354015350342
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.2399137020111084
Epoch: 41, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.2750394344329834
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.262676239013672
Epoch: 43, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.693735122680664
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.402 Vali Acc: 0.906 Test Loss: 0.402 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 45 cost time: 3.1124470233917236
Epoch: 45, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.738111734390259
Epoch: 46, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.208510637283325
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.586 Vali Acc: 0.900 Test Loss: 0.586 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.257941961288452
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.387 Vali Acc: 0.883 Test Loss: 0.387 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.4814951419830322
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.221365451812744
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.2780327796936035
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.349149465560913
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.436166524887085
Epoch: 53, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.424445152282715
Epoch: 54, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.637 Vali Acc: 0.872 Test Loss: 0.637 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.902393341064453
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.828 Vali Acc: 0.178 Test Loss: 1.828 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 3.1920785903930664
Epoch: 2, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.734 Vali Acc: 0.189 Test Loss: 1.734 Test Acc: 0.189
Validation loss decreased (-0.177759 --> -0.188872).  Saving model ...
Epoch: 3 cost time: 3.6277358531951904
Epoch: 3, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.654 Vali Acc: 0.272 Test Loss: 1.654 Test Acc: 0.272
Validation loss decreased (-0.188872 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 3.6259067058563232
Epoch: 4, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.587 Vali Acc: 0.317 Test Loss: 1.587 Test Acc: 0.317
Validation loss decreased (-0.272206 --> -0.316651).  Saving model ...
Epoch: 5 cost time: 3.768275499343872
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.529 Vali Acc: 0.289 Test Loss: 1.529 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.291205406188965
Epoch: 6, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.391 Vali Acc: 0.428 Test Loss: 1.391 Test Acc: 0.428
Validation loss decreased (-0.316651 --> -0.427764).  Saving model ...
Epoch: 7 cost time: 3.5484611988067627
Epoch: 7, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.290 Vali Acc: 0.439 Test Loss: 1.290 Test Acc: 0.439
Validation loss decreased (-0.427764 --> -0.438876).  Saving model ...
Epoch: 8 cost time: 3.418945789337158
Epoch: 8, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.083 Vali Acc: 0.522 Test Loss: 1.083 Test Acc: 0.522
Validation loss decreased (-0.438876 --> -0.522211).  Saving model ...
Epoch: 9 cost time: 3.298118829727173
Epoch: 9, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.874 Vali Acc: 0.572 Test Loss: 0.874 Test Acc: 0.572
Validation loss decreased (-0.522211 --> -0.572213).  Saving model ...
Epoch: 10 cost time: 3.4483327865600586
Epoch: 10, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.775 Vali Acc: 0.583 Test Loss: 0.775 Test Acc: 0.583
Validation loss decreased (-0.572213 --> -0.583326).  Saving model ...
Epoch: 11 cost time: 3.6293468475341797
Epoch: 11, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.671 Vali Acc: 0.667 Test Loss: 0.671 Test Acc: 0.667
Validation loss decreased (-0.583326 --> -0.666660).  Saving model ...
Epoch: 12 cost time: 3.4285402297973633
Epoch: 12, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.586 Vali Acc: 0.733 Test Loss: 0.586 Test Acc: 0.733
Validation loss decreased (-0.666660 --> -0.733327).  Saving model ...
Epoch: 13 cost time: 3.4988064765930176
Epoch: 13, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.536 Vali Acc: 0.728 Test Loss: 0.536 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.398394823074341
Epoch: 14, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761106).  Saving model ...
Epoch: 15 cost time: 3.506009817123413
Epoch: 15, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.469 Vali Acc: 0.744 Test Loss: 0.469 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3166182041168213
Epoch: 16, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.450 Vali Acc: 0.761 Test Loss: 0.450 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761107).  Saving model ...
Epoch: 17 cost time: 3.1899261474609375
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.425 Vali Acc: 0.767 Test Loss: 0.425 Test Acc: 0.767
Validation loss decreased (-0.761107 --> -0.766662).  Saving model ...
Epoch: 18 cost time: 3.6884212493896484
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.413 Vali Acc: 0.761 Test Loss: 0.413 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.545858383178711
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 3.2639031410217285
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4312686920166016
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.396 Vali Acc: 0.789 Test Loss: 0.396 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3517649173736572
Epoch: 22, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.413 Vali Acc: 0.789 Test Loss: 0.413 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.378260612487793
Epoch: 23, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.351 Vali Acc: 0.806 Test Loss: 0.351 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 24 cost time: 3.2006049156188965
Epoch: 24, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4838786125183105
Epoch: 25, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.405 Vali Acc: 0.806 Test Loss: 0.405 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3131515979766846
Epoch: 26, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 27 cost time: 3.5223937034606934
Epoch: 27, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
Validation loss decreased (-0.811107 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 3.392050266265869
Epoch: 28, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.445673704147339
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.124720335006714
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.427 Vali Acc: 0.822 Test Loss: 0.427 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.3393263816833496
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2271385192871094
Epoch: 32, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 33 cost time: 3.486389636993408
Epoch: 33, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.454 Vali Acc: 0.811 Test Loss: 0.454 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.642132043838501
Epoch: 34, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.466 Vali Acc: 0.828 Test Loss: 0.466 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.2313637733459473
Epoch: 35, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.1789133548736572
Epoch: 36, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.4192516803741455
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.0974843502044678
Epoch: 38, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.2162742614746094
Epoch: 39, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.2827608585357666
Epoch: 40, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.460 Vali Acc: 0.839 Test Loss: 0.460 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.4693541526794434
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 42 cost time: 3.215276002883911
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.2446184158325195
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.2567312717437744
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 45 cost time: 3.3541646003723145
Epoch: 45, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.159968137741089
Epoch: 46, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.5116889476776123
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.340217113494873
Epoch: 48, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.463465929031372
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.4402801990509033
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.453 Vali Acc: 0.883 Test Loss: 0.453 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 51 cost time: 3.628589153289795
Epoch: 51, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.462 Vali Acc: 0.894 Test Loss: 0.462 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 52 cost time: 3.354097366333008
Epoch: 52, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.368931770324707
Epoch: 53, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.236180543899536
Epoch: 54, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.694 Vali Acc: 0.872 Test Loss: 0.694 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.506760835647583
Epoch: 55, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.3956735134124756
Epoch: 56, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.421 Vali Acc: 0.917 Test Loss: 0.421 Test Acc: 0.917
Validation loss decreased (-0.894440 --> -0.916662).  Saving model ...
Epoch: 57 cost time: 3.3942508697509766
Epoch: 57, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.6411359310150146
Epoch: 58, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.504 Vali Acc: 0.906 Test Loss: 0.504 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.438710927963257
Epoch: 59, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.216858148574829
Epoch: 60, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.501 Vali Acc: 0.861 Test Loss: 0.501 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.642066478729248
Epoch: 61, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.1703908443450928
Epoch: 62, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.2787609100341797
Epoch: 63, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.2345988750457764
Epoch: 64, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.167633056640625
Epoch: 65, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.3725404739379883
Epoch: 66, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.277200698852539
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.824 Vali Acc: 0.200 Test Loss: 1.824 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 3.486191511154175
Epoch: 2, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.776 Vali Acc: 0.189 Test Loss: 1.776 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.33127498626709
Epoch: 3, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.719 Vali Acc: 0.261 Test Loss: 1.719 Test Acc: 0.261
Validation loss decreased (-0.199982 --> -0.261094).  Saving model ...
Epoch: 4 cost time: 3.484731674194336
Epoch: 4, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.651 Vali Acc: 0.283 Test Loss: 1.651 Test Acc: 0.283
Validation loss decreased (-0.261094 --> -0.283317).  Saving model ...
Epoch: 5 cost time: 3.7503254413604736
Epoch: 5, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.574 Vali Acc: 0.278 Test Loss: 1.574 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.593406915664673
Epoch: 6, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.415 Vali Acc: 0.422 Test Loss: 1.415 Test Acc: 0.422
Validation loss decreased (-0.283317 --> -0.422208).  Saving model ...
Epoch: 7 cost time: 3.2976088523864746
Epoch: 7, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.204 Vali Acc: 0.567 Test Loss: 1.204 Test Acc: 0.567
Validation loss decreased (-0.422208 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 3.242460250854492
Epoch: 8, Steps: 12 | Train Loss: 1.193 Vali Loss: 0.968 Vali Acc: 0.600 Test Loss: 0.968 Test Acc: 0.600
Validation loss decreased (-0.566655 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 3.4641811847686768
Epoch: 9, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.805 Vali Acc: 0.606 Test Loss: 0.805 Test Acc: 0.606
Validation loss decreased (-0.599990 --> -0.605548).  Saving model ...
Epoch: 10 cost time: 3.321322202682495
Epoch: 10, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.778 Vali Acc: 0.628 Test Loss: 0.778 Test Acc: 0.628
Validation loss decreased (-0.605548 --> -0.627770).  Saving model ...
Epoch: 11 cost time: 3.271625518798828
Epoch: 11, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.686 Vali Acc: 0.706 Test Loss: 0.686 Test Acc: 0.706
Validation loss decreased (-0.627770 --> -0.705549).  Saving model ...
Epoch: 12 cost time: 3.3160276412963867
Epoch: 12, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.582 Vali Acc: 0.733 Test Loss: 0.582 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733328).  Saving model ...
Epoch: 13 cost time: 3.4436564445495605
Epoch: 13, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.519 Vali Acc: 0.744 Test Loss: 0.519 Test Acc: 0.744
Validation loss decreased (-0.733328 --> -0.744439).  Saving model ...
Epoch: 14 cost time: 3.088484525680542
Epoch: 14, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.441 Vali Acc: 0.761 Test Loss: 0.441 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761107).  Saving model ...
Epoch: 15 cost time: 3.3941497802734375
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.402 Vali Acc: 0.761 Test Loss: 0.402 Test Acc: 0.761
Validation loss decreased (-0.761107 --> -0.761107).  Saving model ...
Epoch: 16 cost time: 3.182253360748291
Epoch: 16, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.392 Vali Acc: 0.772 Test Loss: 0.392 Test Acc: 0.772
Validation loss decreased (-0.761107 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 3.428537130355835
Epoch: 17, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.372 Vali Acc: 0.794 Test Loss: 0.372 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794441).  Saving model ...
Epoch: 18 cost time: 3.1721086502075195
Epoch: 18, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.778 Test Loss: 0.349 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5523667335510254
Epoch: 19, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.343 Vali Acc: 0.811 Test Loss: 0.343 Test Acc: 0.811
Validation loss decreased (-0.794441 --> -0.811108).  Saving model ...
Epoch: 20 cost time: 3.245915174484253
Epoch: 20, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3298962116241455
Epoch: 21, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.319 Vali Acc: 0.811 Test Loss: 0.319 Test Acc: 0.811
Validation loss decreased (-0.811108 --> -0.811108).  Saving model ...
Epoch: 22 cost time: 3.4424872398376465
Epoch: 22, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.311 Vali Acc: 0.817 Test Loss: 0.311 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816664).  Saving model ...
Epoch: 23 cost time: 3.4335334300994873
Epoch: 23, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.302 Vali Acc: 0.817 Test Loss: 0.302 Test Acc: 0.817
Validation loss decreased (-0.816664 --> -0.816664).  Saving model ...
Epoch: 24 cost time: 3.101979970932007
Epoch: 24, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.310 Vali Acc: 0.811 Test Loss: 0.310 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.409539222717285
Epoch: 25, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.318 Vali Acc: 0.817 Test Loss: 0.318 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4275689125061035
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.816664 --> -0.838886).  Saving model ...
Epoch: 27 cost time: 3.2764172554016113
Epoch: 27, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.322 Vali Acc: 0.817 Test Loss: 0.322 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3710291385650635
Epoch: 28, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 29 cost time: 3.0590484142303467
Epoch: 29, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 3.2574832439422607
Epoch: 30, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1211581230163574
Epoch: 31, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 3.184126853942871
Epoch: 32, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.300 Vali Acc: 0.828 Test Loss: 0.300 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2511544227600098
Epoch: 33, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.441 Vali Acc: 0.839 Test Loss: 0.441 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.239830732345581
Epoch: 34, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.140960216522217
Epoch: 35, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.497049570083618
Epoch: 36, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 37 cost time: 3.187490463256836
Epoch: 37, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 38 cost time: 3.098893165588379
Epoch: 38, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.3126561641693115
Epoch: 39, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.1275711059570312
Epoch: 40, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 2.999229669570923
Epoch: 41, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.1913673877716064
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.853990077972412
Epoch: 43, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.1687772274017334
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.3812267780303955
Epoch: 45, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.296558141708374
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.377 Vali Acc: 0.878 Test Loss: 0.377 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.439321517944336
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.397376775741577
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.461923122406006
Epoch: 49, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.2364141941070557
Epoch: 50, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.241399526596069
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.838 Vali Acc: 0.144 Test Loss: 1.838 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 3.6031644344329834
Epoch: 2, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.789 Vali Acc: 0.189 Test Loss: 1.789 Test Acc: 0.189
Validation loss decreased (-0.144426 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 3.154994249343872
Epoch: 3, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.717 Vali Acc: 0.256 Test Loss: 1.717 Test Acc: 0.256
Validation loss decreased (-0.188871 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 3.0552024841308594
Epoch: 4, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.607 Vali Acc: 0.328 Test Loss: 1.607 Test Acc: 0.328
Validation loss decreased (-0.255538 --> -0.327762).  Saving model ...
Epoch: 5 cost time: 3.094386100769043
Epoch: 5, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.449 Vali Acc: 0.456 Test Loss: 1.449 Test Acc: 0.456
Validation loss decreased (-0.327762 --> -0.455541).  Saving model ...
Epoch: 6 cost time: 3.144829750061035
Epoch: 6, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.248 Vali Acc: 0.533 Test Loss: 1.248 Test Acc: 0.533
Validation loss decreased (-0.455541 --> -0.533321).  Saving model ...
Epoch: 7 cost time: 3.348355531692505
Epoch: 7, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.014 Vali Acc: 0.589 Test Loss: 1.014 Test Acc: 0.589
Validation loss decreased (-0.533321 --> -0.588879).  Saving model ...
Epoch: 8 cost time: 2.925842761993408
Epoch: 8, Steps: 12 | Train Loss: 1.210 Vali Loss: 0.834 Vali Acc: 0.617 Test Loss: 0.834 Test Acc: 0.617
Validation loss decreased (-0.588879 --> -0.616658).  Saving model ...
Epoch: 9 cost time: 3.1184234619140625
Epoch: 9, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.719 Vali Acc: 0.650 Test Loss: 0.719 Test Acc: 0.650
Validation loss decreased (-0.616658 --> -0.649993).  Saving model ...
Epoch: 10 cost time: 3.4616539478302
Epoch: 10, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.648 Vali Acc: 0.650 Test Loss: 0.648 Test Acc: 0.650
Validation loss decreased (-0.649993 --> -0.649994).  Saving model ...
Epoch: 11 cost time: 3.3731155395507812
Epoch: 11, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.546 Vali Acc: 0.711 Test Loss: 0.546 Test Acc: 0.711
Validation loss decreased (-0.649994 --> -0.711106).  Saving model ...
Epoch: 12 cost time: 3.3434557914733887
Epoch: 12, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.476 Vali Acc: 0.744 Test Loss: 0.476 Test Acc: 0.744
Validation loss decreased (-0.711106 --> -0.744440).  Saving model ...
Epoch: 13 cost time: 3.2502341270446777
Epoch: 13, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.424 Vali Acc: 0.778 Test Loss: 0.424 Test Acc: 0.778
Validation loss decreased (-0.744440 --> -0.777774).  Saving model ...
Epoch: 14 cost time: 3.1739754676818848
Epoch: 14, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.385 Vali Acc: 0.783 Test Loss: 0.385 Test Acc: 0.783
Validation loss decreased (-0.777774 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 3.342365264892578
Epoch: 15, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 3.342714309692383
Epoch: 16, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.371 Vali Acc: 0.806 Test Loss: 0.371 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2725677490234375
Epoch: 17, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.348 Vali Acc: 0.806 Test Loss: 0.348 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2382614612579346
Epoch: 18, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.349 Vali Acc: 0.794 Test Loss: 0.349 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.219298839569092
Epoch: 19, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.329 Vali Acc: 0.794 Test Loss: 0.329 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1219992637634277
Epoch: 20, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.314 Vali Acc: 0.806 Test Loss: 0.314 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1489577293395996
Epoch: 21, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.313 Vali Acc: 0.817 Test Loss: 0.313 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816664).  Saving model ...
Epoch: 22 cost time: 3.013812780380249
Epoch: 22, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.326 Vali Acc: 0.822 Test Loss: 0.326 Test Acc: 0.822
Validation loss decreased (-0.816664 --> -0.822219).  Saving model ...
Epoch: 23 cost time: 3.3558056354522705
Epoch: 23, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.313 Vali Acc: 0.822 Test Loss: 0.313 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 24 cost time: 3.0907211303710938
Epoch: 24, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.306 Vali Acc: 0.828 Test Loss: 0.306 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 25 cost time: 3.172804832458496
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0948331356048584
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.302 Vali Acc: 0.822 Test Loss: 0.302 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.303957939147949
Epoch: 27, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.322 Vali Acc: 0.811 Test Loss: 0.322 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.296358108520508
Epoch: 28, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.283 Vali Acc: 0.828 Test Loss: 0.283 Test Acc: 0.828
Validation loss decreased (-0.827775 --> -0.827775).  Saving model ...
Epoch: 29 cost time: 3.2190756797790527
Epoch: 29, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.827775 --> -0.877775).  Saving model ...
Epoch: 30 cost time: 3.127943515777588
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2676854133605957
Epoch: 31, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4116156101226807
Epoch: 32, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.512005567550659
Epoch: 33, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.140904188156128
Epoch: 34, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.1779935359954834
Epoch: 35, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.3006210327148438
Epoch: 36, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.172121286392212
Epoch: 37, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.327 Vali Acc: 0.878 Test Loss: 0.327 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.170386791229248
Epoch: 38, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.3740742206573486
Epoch: 39, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 40 cost time: 3.155853033065796
Epoch: 40, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.079054594039917
Epoch: 41, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.290847063064575
Epoch: 42, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.489 Vali Acc: 0.817 Test Loss: 0.489 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.218132257461548
Epoch: 43, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.150106191635132
Epoch: 44, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 3.5106284618377686
Epoch: 45, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.146289110183716
Epoch: 46, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1627938747406006
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.353 Vali Acc: 0.883 Test Loss: 0.353 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.4988996982574463
Epoch: 48, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.489546298980713
Epoch: 49, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.334590196609497
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.378 Vali Acc: 0.878 Test Loss: 0.378 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.2387382984161377
Epoch: 51, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.195679187774658
Epoch: 52, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.3231356143951416
Epoch: 53, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.494894027709961
Epoch: 54, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.907575607299805
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.842 Vali Acc: 0.139 Test Loss: 1.842 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 3.5619852542877197
Epoch: 2, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.791 Vali Acc: 0.189 Test Loss: 1.791 Test Acc: 0.189
Validation loss decreased (-0.138870 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 3.1769485473632812
Epoch: 3, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.719 Vali Acc: 0.278 Test Loss: 1.719 Test Acc: 0.278
Validation loss decreased (-0.188871 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 3.5659749507904053
Epoch: 4, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.611 Vali Acc: 0.383 Test Loss: 1.611 Test Acc: 0.383
Validation loss decreased (-0.277761 --> -0.383317).  Saving model ...
Epoch: 5 cost time: 3.4798080921173096
Epoch: 5, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
Validation loss decreased (-0.383317 --> -0.449985).  Saving model ...
Epoch: 6 cost time: 3.193995952606201
Epoch: 6, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.449985 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 3.270750045776367
Epoch: 7, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 3.442591428756714
Epoch: 8, Steps: 12 | Train Loss: 1.252 Vali Loss: 0.885 Vali Acc: 0.600 Test Loss: 0.885 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 3.359273910522461
Epoch: 9, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.786 Vali Acc: 0.589 Test Loss: 0.786 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1405463218688965
Epoch: 10, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.722 Vali Acc: 0.644 Test Loss: 0.722 Test Acc: 0.644
Validation loss decreased (-0.599991 --> -0.644437).  Saving model ...
Epoch: 11 cost time: 3.338265895843506
Epoch: 11, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.585 Vali Acc: 0.728 Test Loss: 0.585 Test Acc: 0.728
Validation loss decreased (-0.644437 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 3.190392255783081
Epoch: 12, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.495 Vali Acc: 0.761 Test Loss: 0.495 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 2.996464252471924
Epoch: 13, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.416 Vali Acc: 0.789 Test Loss: 0.416 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 3.203530788421631
Epoch: 14, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.357 Vali Acc: 0.806 Test Loss: 0.357 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 15 cost time: 3.3265421390533447
Epoch: 15, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 3.1837098598480225
Epoch: 16, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.345 Vali Acc: 0.806 Test Loss: 0.345 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.351271867752075
Epoch: 17, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.345 Vali Acc: 0.811 Test Loss: 0.345 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2352614402770996
Epoch: 18, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.342992067337036
Epoch: 19, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.320 Vali Acc: 0.817 Test Loss: 0.320 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.569679021835327
Epoch: 20, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.314 Vali Acc: 0.811 Test Loss: 0.314 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3322699069976807
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 3.1599087715148926
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.311 Vali Acc: 0.822 Test Loss: 0.311 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2334978580474854
Epoch: 23, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.309 Vali Acc: 0.822 Test Loss: 0.309 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1321563720703125
Epoch: 24, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.306 Vali Acc: 0.817 Test Loss: 0.306 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1037895679473877
Epoch: 25, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.5286991596221924
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1483211517333984
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1022074222564697
Epoch: 28, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.274 Vali Acc: 0.856 Test Loss: 0.274 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.089451789855957
Epoch: 29, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 30 cost time: 3.121882200241089
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1777052879333496
Epoch: 31, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.116701126098633
Epoch: 32, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3421287536621094
Epoch: 33, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.2495360374450684
Epoch: 34, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.412513017654419
Epoch: 35, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 36 cost time: 3.536764144897461
Epoch: 36, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.4330530166625977
Epoch: 37, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.8080387115478516
Epoch: 38, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.369208335876465
Epoch: 39, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 40 cost time: 3.382120370864868
Epoch: 40, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.508125066757202
Epoch: 41, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.2904860973358154
Epoch: 42, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.4383411407470703
Epoch: 43, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.1561410427093506
Epoch: 44, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.2474308013916016
Epoch: 45, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.1034064292907715
Epoch: 46, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.103961944580078
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.2630603313446045
Epoch: 48, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.407 Vali Acc: 0.867 Test Loss: 0.407 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.4516563415527344
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.212305545806885
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.392584800720215
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.6280643939971924
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.7083771228790283
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.520761728286743
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7366836071014404
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.466747760772705
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 3.6153016090393066
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 3.551774024963379
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 3.3462018966674805
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 3.051178455352783
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.345153331756592
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 3.1030113697052
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 3.441319465637207
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.041226625442505
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.454946279525757
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 3.775770902633667
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 3.5320396423339844
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.575228691101074
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7018778324127197
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4655869007110596
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6559195518493652
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.195638418197632
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2739429473876953
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.192362070083618
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.5373871326446533
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.2020390033721924
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 929478
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.890227794647217
Epoch: 1, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.734 Vali Acc: 0.294 Test Loss: 1.734 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 3.4637601375579834
Epoch: 2, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.548 Vali Acc: 0.461 Test Loss: 1.548 Test Acc: 0.461
Validation loss decreased (-0.294427 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 3.3075382709503174
Epoch: 3, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.375 Vali Acc: 0.494 Test Loss: 1.375 Test Acc: 0.494
Validation loss decreased (-0.461096 --> -0.494431).  Saving model ...
Epoch: 4 cost time: 3.1796340942382812
Epoch: 4, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.230 Vali Acc: 0.522 Test Loss: 1.230 Test Acc: 0.522
Validation loss decreased (-0.494431 --> -0.522210).  Saving model ...
Epoch: 5 cost time: 3.474257707595825
Epoch: 5, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.114 Vali Acc: 0.583 Test Loss: 1.114 Test Acc: 0.583
Validation loss decreased (-0.522210 --> -0.583322).  Saving model ...
Epoch: 6 cost time: 3.7181384563446045
Epoch: 6, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.022 Vali Acc: 0.594 Test Loss: 1.022 Test Acc: 0.594
Validation loss decreased (-0.583322 --> -0.594434).  Saving model ...
Epoch: 7 cost time: 3.394916296005249
Epoch: 7, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.919 Vali Acc: 0.633 Test Loss: 0.919 Test Acc: 0.633
Validation loss decreased (-0.594434 --> -0.633324).  Saving model ...
Epoch: 8 cost time: 3.552652359008789
Epoch: 8, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.802 Vali Acc: 0.689 Test Loss: 0.802 Test Acc: 0.689
Validation loss decreased (-0.633324 --> -0.688881).  Saving model ...
Epoch: 9 cost time: 3.5244903564453125
Epoch: 9, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.677 Vali Acc: 0.700 Test Loss: 0.677 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 3.39253568649292
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (-0.699993 --> -0.722216).  Saving model ...
Epoch: 11 cost time: 3.385498046875
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.722216 --> -0.755550).  Saving model ...
Epoch: 12 cost time: 3.4868528842926025
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 13 cost time: 3.4913337230682373
Epoch: 13, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.478 Vali Acc: 0.783 Test Loss: 0.478 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 14 cost time: 3.9365365505218506
Epoch: 14, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.415 Vali Acc: 0.794 Test Loss: 0.415 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 3.636526107788086
Epoch: 15, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 16 cost time: 3.4903042316436768
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 3.3408288955688477
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 18 cost time: 3.1408984661102295
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4002227783203125
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6461498737335205
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 3.3784828186035156
Epoch: 21, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 22 cost time: 3.6251156330108643
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4724323749542236
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 24 cost time: 3.4925003051757812
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8809854984283447
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.274 Vali Acc: 0.861 Test Loss: 0.274 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.299798011779785
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.630110502243042
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 3.2716727256774902
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6881210803985596
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.990349769592285
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 3.5661017894744873
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.235 Vali Acc: 0.878 Test Loss: 0.235 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.429729700088501
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.421581983566284
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 34 cost time: 2.8851239681243896
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3855881690979004
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0533971786499023
Epoch: 36, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1498303413391113
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 38 cost time: 3.097001552581787
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.455756902694702
Epoch: 39, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.3219733238220215
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.7881295680999756
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.459510326385498
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.309818744659424
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 3.458095073699951
Epoch: 44, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.466576337814331
Epoch: 45, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.5235562324523926
Epoch: 46, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.501894950866699
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.593757390975952
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.4094722270965576
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.499692440032959
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.0499377250671387
Epoch: 51, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.3147923946380615
Epoch: 52, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.3255534172058105
Epoch: 53, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 3.5403225421905518
Epoch: 54, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.4213507175445557
Epoch: 55, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 3.3991730213165283
Epoch: 56, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 57 cost time: 3.6349005699157715
Epoch: 57, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.3490076065063477
Epoch: 58, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 59 cost time: 3.297708034515381
Epoch: 59, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.2823588848114014
Epoch: 60, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.4450438022613525
Epoch: 61, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 62 cost time: 3.342926025390625
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.5620272159576416
Epoch: 63, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.883 Test Loss: 0.442 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.234178304672241
Epoch: 64, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.5295753479003906
Epoch: 65, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.6029891967773438
Epoch: 66, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 3.829017400741577
Epoch: 67, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.5476126670837402
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.32816219329834
Epoch: 69, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.6804699897766113
Epoch: 70, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.4363763332366943
Epoch: 71, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.293531894683838
Epoch: 72, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 3.273050546646118
Epoch: 73, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.4752609729766846
Epoch: 74, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.2975618839263916
Epoch: 75, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 76 cost time: 3.3438785076141357
Epoch: 76, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.085413932800293
Epoch: 77, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.526519775390625
Epoch: 78, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.596280097961426
Epoch: 79, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 3.564168930053711
Epoch: 80, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 3.5504941940307617
Epoch: 81, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 3.3479514122009277
Epoch: 82, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 3.5520870685577393
Epoch: 83, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 84 cost time: 3.656923770904541
Epoch: 84, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 3.7207658290863037
Epoch: 85, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 3.350078582763672
Epoch: 86, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 3.5722339153289795
Epoch: 87, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 88 cost time: 3.3528892993927
Epoch: 88, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 3.2261533737182617
Epoch: 89, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 3.2995760440826416
Epoch: 90, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 3.6347694396972656
Epoch: 91, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 3.4735264778137207
Epoch: 92, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 3.5673584938049316
Epoch: 93, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 3.541985034942627
Epoch: 94, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 3.267390489578247
Epoch: 95, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 3.3872933387756348
Epoch: 96, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 3.529411792755127
Epoch: 97, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.919080495834351
Epoch: 1, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.745 Vali Acc: 0.322 Test Loss: 1.745 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 3.4702723026275635
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.609 Vali Acc: 0.394 Test Loss: 1.609 Test Acc: 0.394
Validation loss decreased (-0.322205 --> -0.394428).  Saving model ...
Epoch: 3 cost time: 3.550157070159912
Epoch: 3, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.473 Vali Acc: 0.461 Test Loss: 1.473 Test Acc: 0.461
Validation loss decreased (-0.394428 --> -0.461096).  Saving model ...
Epoch: 4 cost time: 3.313059091567993
Epoch: 4, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.351 Vali Acc: 0.494 Test Loss: 1.351 Test Acc: 0.494
Validation loss decreased (-0.461096 --> -0.494431).  Saving model ...
Epoch: 5 cost time: 3.4078269004821777
Epoch: 5, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.237 Vali Acc: 0.550 Test Loss: 1.237 Test Acc: 0.550
Validation loss decreased (-0.494431 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 3.372398853302002
Epoch: 6, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.150 Vali Acc: 0.528 Test Loss: 1.150 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6650583744049072
Epoch: 7, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.052 Vali Acc: 0.567 Test Loss: 1.052 Test Acc: 0.567
Validation loss decreased (-0.549988 --> -0.566656).  Saving model ...
Epoch: 8 cost time: 3.6285548210144043
Epoch: 8, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.936 Vali Acc: 0.622 Test Loss: 0.936 Test Acc: 0.622
Validation loss decreased (-0.566656 --> -0.622213).  Saving model ...
Epoch: 9 cost time: 3.493525266647339
Epoch: 9, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.804 Vali Acc: 0.689 Test Loss: 0.804 Test Acc: 0.689
Validation loss decreased (-0.622213 --> -0.688881).  Saving model ...
Epoch: 10 cost time: 3.458645820617676
Epoch: 10, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.698 Vali Acc: 0.700 Test Loss: 0.698 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699993).  Saving model ...
Epoch: 11 cost time: 3.8977439403533936
Epoch: 11, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.612 Vali Acc: 0.739 Test Loss: 0.612 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738883).  Saving model ...
Epoch: 12 cost time: 3.6449942588806152
Epoch: 12, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.552 Vali Acc: 0.733 Test Loss: 0.552 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.68357515335083
Epoch: 13, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 14 cost time: 3.514925956726074
Epoch: 14, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.440 Vali Acc: 0.767 Test Loss: 0.440 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 3.714449882507324
Epoch: 15, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 16 cost time: 3.770095109939575
Epoch: 16, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.400 Vali Acc: 0.811 Test Loss: 0.400 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 4.088097333908081
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.358 Vali Acc: 0.811 Test Loss: 0.358 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 18 cost time: 3.525160789489746
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
Validation loss decreased (-0.811108 --> -0.822219).  Saving model ...
Epoch: 19 cost time: 3.6282544136047363
Epoch: 19, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.424 Vali Acc: 0.811 Test Loss: 0.424 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8633623123168945
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 21 cost time: 3.53985333442688
Epoch: 21, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.318 Vali Acc: 0.828 Test Loss: 0.318 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 22 cost time: 3.5391197204589844
Epoch: 22, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5536422729492188
Epoch: 23, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
Validation loss decreased (-0.827775 --> -0.838886).  Saving model ...
Epoch: 24 cost time: 3.6400585174560547
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.155290365219116
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 26 cost time: 3.163079023361206
Epoch: 26, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1692168712615967
Epoch: 27, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.134890556335449
Epoch: 28, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 3.272958517074585
Epoch: 29, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 3.4998512268066406
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4756662845611572
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 3.589462995529175
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
Validation loss decreased (-0.877775 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 3.8338706493377686
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.403557777404785
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.4956820011138916
Epoch: 35, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.652188301086426
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.3195934295654297
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.344677448272705
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.174527645111084
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.4016435146331787
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 3.312493324279785
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.3465850353240967
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.3441386222839355
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.3875985145568848
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.238663673400879
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 3.243257522583008
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.007798433303833
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 2.8207199573516846
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2323904037475586
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2063419818878174
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.573413133621216
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 3.6349151134490967
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.7541024684906006
Epoch: 53, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.3175995349884033
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.939 Test Loss: 0.280 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.6706039905548096
Epoch: 55, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.7054359912872314
Epoch: 56, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 4.123576402664185
Epoch: 57, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.3240063190460205
Epoch: 58, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.4337074756622314
Epoch: 59, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.104461193084717
Epoch: 60, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.035947561264038
Epoch: 61, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.720397472381592
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.733 Vali Acc: 0.311 Test Loss: 1.733 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 3.419712543487549
Epoch: 2, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.646 Vali Acc: 0.356 Test Loss: 1.646 Test Acc: 0.356
Validation loss decreased (-0.311094 --> -0.355539).  Saving model ...
Epoch: 3 cost time: 3.448042392730713
Epoch: 3, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.549 Vali Acc: 0.378 Test Loss: 1.549 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377762).  Saving model ...
Epoch: 4 cost time: 3.8520658016204834
Epoch: 4, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.458 Vali Acc: 0.428 Test Loss: 1.458 Test Acc: 0.428
Validation loss decreased (-0.377762 --> -0.427763).  Saving model ...
Epoch: 5 cost time: 3.3431684970855713
Epoch: 5, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.360 Vali Acc: 0.467 Test Loss: 1.360 Test Acc: 0.467
Validation loss decreased (-0.427763 --> -0.466653).  Saving model ...
Epoch: 6 cost time: 3.595557689666748
Epoch: 6, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5116119384765625
Epoch: 7, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.204 Vali Acc: 0.511 Test Loss: 1.204 Test Acc: 0.511
Validation loss decreased (-0.466653 --> -0.511099).  Saving model ...
Epoch: 8 cost time: 3.4317119121551514
Epoch: 8, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.084 Vali Acc: 0.517 Test Loss: 1.084 Test Acc: 0.517
Validation loss decreased (-0.511099 --> -0.516656).  Saving model ...
Epoch: 9 cost time: 3.582974672317505
Epoch: 9, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.937 Vali Acc: 0.594 Test Loss: 0.937 Test Acc: 0.594
Validation loss decreased (-0.516656 --> -0.594435).  Saving model ...
Epoch: 10 cost time: 3.2399160861968994
Epoch: 10, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.826 Vali Acc: 0.628 Test Loss: 0.826 Test Acc: 0.628
Validation loss decreased (-0.594435 --> -0.627770).  Saving model ...
Epoch: 11 cost time: 3.0017507076263428
Epoch: 11, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.724 Vali Acc: 0.650 Test Loss: 0.724 Test Acc: 0.650
Validation loss decreased (-0.627770 --> -0.649993).  Saving model ...
Epoch: 12 cost time: 3.1456310749053955
Epoch: 12, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.638 Vali Acc: 0.694 Test Loss: 0.638 Test Acc: 0.694
Validation loss decreased (-0.649993 --> -0.694438).  Saving model ...
Epoch: 13 cost time: 2.7534267902374268
Epoch: 13, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.571 Vali Acc: 0.700 Test Loss: 0.571 Test Acc: 0.700
Validation loss decreased (-0.694438 --> -0.699994).  Saving model ...
Epoch: 14 cost time: 3.558340549468994
Epoch: 14, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.502 Vali Acc: 0.733 Test Loss: 0.502 Test Acc: 0.733
Validation loss decreased (-0.699994 --> -0.733328).  Saving model ...
Epoch: 15 cost time: 3.4483561515808105
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.460 Vali Acc: 0.778 Test Loss: 0.460 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 3.1457107067108154
Epoch: 16, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.433 Vali Acc: 0.756 Test Loss: 0.433 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4376184940338135
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.401 Vali Acc: 0.789 Test Loss: 0.401 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 3.3045835494995117
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.390 Vali Acc: 0.794 Test Loss: 0.390 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794441).  Saving model ...
Epoch: 19 cost time: 2.889573097229004
Epoch: 19, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.409 Vali Acc: 0.783 Test Loss: 0.409 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7717690467834473
Epoch: 20, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
Validation loss decreased (-0.794441 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 3.051788568496704
Epoch: 21, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.353 Vali Acc: 0.811 Test Loss: 0.353 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811108).  Saving model ...
Epoch: 22 cost time: 2.9329607486724854
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.400 Vali Acc: 0.794 Test Loss: 0.400 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.137056589126587
Epoch: 23, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.393 Vali Acc: 0.800 Test Loss: 0.393 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3243987560272217
Epoch: 24, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
Validation loss decreased (-0.811108 --> -0.822219).  Saving model ...
Epoch: 25 cost time: 3.2472097873687744
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4259769916534424
Epoch: 26, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.431 Vali Acc: 0.828 Test Loss: 0.431 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827773).  Saving model ...
Epoch: 27 cost time: 3.799668788909912
Epoch: 27, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.396540403366089
Epoch: 28, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3757970333099365
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.375 Vali Acc: 0.811 Test Loss: 0.375 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2228472232818604
Epoch: 30, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 31 cost time: 2.9006118774414062
Epoch: 31, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 3.4517507553100586
Epoch: 32, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 33 cost time: 2.685678005218506
Epoch: 33, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.949608564376831
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.9817116260528564
Epoch: 35, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.795384407043457
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 37 cost time: 2.8318967819213867
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.1980326175689697
Epoch: 38, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.1404688358306885
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 40 cost time: 3.282439947128296
Epoch: 40, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4824318885803223
Epoch: 41, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.436 Vali Acc: 0.878 Test Loss: 0.436 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.3028876781463623
Epoch: 42, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.2832283973693848
Epoch: 43, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.362 Vali Acc: 0.872 Test Loss: 0.362 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.053105592727661
Epoch: 44, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.288450002670288
Epoch: 45, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.3742337226867676
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 47 cost time: 3.209043502807617
Epoch: 47, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.3480496406555176
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.201385021209717
Epoch: 49, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.365445375442505
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.3844547271728516
Epoch: 51, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.380 Vali Acc: 0.883 Test Loss: 0.380 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.2086405754089355
Epoch: 52, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 53 cost time: 3.2713265419006348
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.422 Vali Acc: 0.894 Test Loss: 0.422 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 54 cost time: 3.3790602684020996
Epoch: 54, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.4244935512542725
Epoch: 55, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.242509603500366
Epoch: 56, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.407 Vali Acc: 0.867 Test Loss: 0.407 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.4207324981689453
Epoch: 57, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.5813159942626953
Epoch: 58, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.403 Vali Acc: 0.872 Test Loss: 0.403 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.464846611022949
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.24116849899292
Epoch: 60, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 3.3258464336395264
Epoch: 61, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.271197557449341
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.229165554046631
Epoch: 63, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.418 Vali Acc: 0.894 Test Loss: 0.418 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.390850782394409
Epoch: 64, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.883 Test Loss: 0.385 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.149437427520752
Epoch: 65, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.401 Vali Acc: 0.878 Test Loss: 0.401 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 2.935002565383911
Epoch: 66, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.3716158866882324
Epoch: 67, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.2933497428894043
Epoch: 68, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.446 Vali Acc: 0.894 Test Loss: 0.446 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.298663377761841
Epoch: 69, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 70 cost time: 3.2026588916778564
Epoch: 70, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.906 Test Loss: 0.455 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905551).  Saving model ...
Epoch: 71 cost time: 3.1622328758239746
Epoch: 71, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.2454428672790527
Epoch: 72, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.2932915687561035
Epoch: 73, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.894 Test Loss: 0.430 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.9856650829315186
Epoch: 74, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.4119818210601807
Epoch: 75, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.4441425800323486
Epoch: 76, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.492964506149292
Epoch: 77, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.4777235984802246
Epoch: 78, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 3.4684267044067383
Epoch: 79, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905552).  Saving model ...
Epoch: 80 cost time: 3.391427516937256
Epoch: 80, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
Validation loss decreased (-0.905552 --> -0.922218).  Saving model ...
Epoch: 81 cost time: 3.1096527576446533
Epoch: 81, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 3.295064687728882
Epoch: 82, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.883 Test Loss: 0.407 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 3.3567841053009033
Epoch: 83, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.385 Vali Acc: 0.883 Test Loss: 0.385 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 3.334059715270996
Epoch: 84, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.883 Test Loss: 0.389 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 3.231499671936035
Epoch: 85, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 3.451230049133301
Epoch: 86, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 3.308483839035034
Epoch: 87, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 3.210843086242676
Epoch: 88, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 3.134709596633911
Epoch: 89, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 3.36934494972229
Epoch: 90, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.021951675415039
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.770 Vali Acc: 0.211 Test Loss: 1.770 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 3.6472079753875732
Epoch: 2, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.710 Vali Acc: 0.178 Test Loss: 1.710 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7272660732269287
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.646 Vali Acc: 0.200 Test Loss: 1.646 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.494683027267456
Epoch: 4, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.587 Vali Acc: 0.228 Test Loss: 1.587 Test Acc: 0.228
Validation loss decreased (-0.211093 --> -0.227762).  Saving model ...
Epoch: 5 cost time: 3.6986637115478516
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.497 Vali Acc: 0.361 Test Loss: 1.497 Test Acc: 0.361
Validation loss decreased (-0.227762 --> -0.361096).  Saving model ...
Epoch: 6 cost time: 3.468535900115967
Epoch: 6, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.407 Vali Acc: 0.428 Test Loss: 1.407 Test Acc: 0.428
Validation loss decreased (-0.361096 --> -0.427764).  Saving model ...
Epoch: 7 cost time: 3.389413833618164
Epoch: 7, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.309 Vali Acc: 0.433 Test Loss: 1.309 Test Acc: 0.433
Validation loss decreased (-0.427764 --> -0.433320).  Saving model ...
Epoch: 8 cost time: 3.48229718208313
Epoch: 8, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.433320 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 3.4049031734466553
Epoch: 9, Steps: 12 | Train Loss: 0.913 Vali Loss: 0.915 Vali Acc: 0.594 Test Loss: 0.915 Test Acc: 0.594
Validation loss decreased (-0.533322 --> -0.594435).  Saving model ...
Epoch: 10 cost time: 3.3142261505126953
Epoch: 10, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.827 Vali Acc: 0.600 Test Loss: 0.827 Test Acc: 0.600
Validation loss decreased (-0.594435 --> -0.599992).  Saving model ...
Epoch: 11 cost time: 3.3094875812530518
Epoch: 11, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.755 Vali Acc: 0.650 Test Loss: 0.755 Test Acc: 0.650
Validation loss decreased (-0.599992 --> -0.649992).  Saving model ...
Epoch: 12 cost time: 3.50722599029541
Epoch: 12, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.678 Vali Acc: 0.678 Test Loss: 0.678 Test Acc: 0.678
Validation loss decreased (-0.649992 --> -0.677771).  Saving model ...
Epoch: 13 cost time: 3.2389755249023438
Epoch: 13, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.603 Vali Acc: 0.706 Test Loss: 0.603 Test Acc: 0.706
Validation loss decreased (-0.677771 --> -0.705550).  Saving model ...
Epoch: 14 cost time: 3.5276172161102295
Epoch: 14, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.728 Test Loss: 0.546 Test Acc: 0.728
Validation loss decreased (-0.705550 --> -0.727772).  Saving model ...
Epoch: 15 cost time: 3.3251771926879883
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.497 Vali Acc: 0.750 Test Loss: 0.497 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749995).  Saving model ...
Epoch: 16 cost time: 3.4020605087280273
Epoch: 16, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.454 Vali Acc: 0.772 Test Loss: 0.454 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 3.048292875289917
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.434 Vali Acc: 0.789 Test Loss: 0.434 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 3.3915510177612305
Epoch: 18, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.430 Vali Acc: 0.772 Test Loss: 0.430 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.363424777984619
Epoch: 19, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.421 Vali Acc: 0.800 Test Loss: 0.421 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 3.2877633571624756
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.403 Vali Acc: 0.761 Test Loss: 0.403 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.519040107727051
Epoch: 21, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.396 Vali Acc: 0.806 Test Loss: 0.396 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 22 cost time: 3.480003833770752
Epoch: 22, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.403 Vali Acc: 0.800 Test Loss: 0.403 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.938377857208252
Epoch: 23, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.442 Vali Acc: 0.794 Test Loss: 0.442 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4332058429718018
Epoch: 24, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.407 Vali Acc: 0.811 Test Loss: 0.407 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 25 cost time: 3.3911397457122803
Epoch: 25, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4202077388763428
Epoch: 26, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3153915405273438
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.420 Vali Acc: 0.811 Test Loss: 0.420 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.424809217453003
Epoch: 28, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.429 Vali Acc: 0.806 Test Loss: 0.429 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.250762462615967
Epoch: 29, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.4494760036468506
Epoch: 30, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 31 cost time: 3.356105089187622
Epoch: 31, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.670603036880493
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.432 Vali Acc: 0.822 Test Loss: 0.432 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.386281967163086
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.517 Vali Acc: 0.817 Test Loss: 0.517 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.156195878982544
Epoch: 34, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.480 Vali Acc: 0.817 Test Loss: 0.480 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.9841935634613037
Epoch: 35, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.445 Vali Acc: 0.811 Test Loss: 0.445 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.1380012035369873
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.4960217475891113
Epoch: 37, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844439).  Saving model ...
Epoch: 38 cost time: 3.3277029991149902
Epoch: 38, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 39 cost time: 3.680246591567993
Epoch: 39, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.450911283493042
Epoch: 40, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 41 cost time: 3.3289437294006348
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.442 Vali Acc: 0.839 Test Loss: 0.442 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.5389907360076904
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861107).  Saving model ...
Epoch: 43 cost time: 3.4468095302581787
Epoch: 43, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.4428369998931885
Epoch: 44, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2792809009552
Epoch: 45, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.5041849613189697
Epoch: 46, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.0679264068603516
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.34369158744812
Epoch: 48, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.688098907470703
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.4314510822296143
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.398 Vali Acc: 0.878 Test Loss: 0.398 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 51 cost time: 3.632762908935547
Epoch: 51, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.2874746322631836
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.147892475128174
Epoch: 53, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 54 cost time: 3.510822057723999
Epoch: 54, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.514 Vali Acc: 0.883 Test Loss: 0.514 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.772836446762085
Epoch: 55, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.3150746822357178
Epoch: 56, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.1931850910186768
Epoch: 57, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.5954294204711914
Epoch: 58, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.700 Vali Acc: 0.867 Test Loss: 0.700 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.55206036567688
Epoch: 59, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.643021583557129
Epoch: 60, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 61 cost time: 3.5260751247406006
Epoch: 61, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 62 cost time: 3.330686092376709
Epoch: 62, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.872 Test Loss: 0.667 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.9983837604522705
Epoch: 63, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.078270196914673
Epoch: 64, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.9579479694366455
Epoch: 65, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.134981393814087
Epoch: 66, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.346771001815796
Epoch: 67, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 68 cost time: 3.620664119720459
Epoch: 68, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.906 Test Loss: 0.468 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905551).  Saving model ...
Epoch: 69 cost time: 3.4842116832733154
Epoch: 69, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.549 Vali Acc: 0.894 Test Loss: 0.549 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.85299015045166
Epoch: 70, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 3.5166707038879395
Epoch: 71, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.380884885787964
Epoch: 72, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 3.2166531085968018
Epoch: 73, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 3.111701250076294
Epoch: 74, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 3.3818180561065674
Epoch: 75, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
Validation loss decreased (-0.905551 --> -0.922218).  Saving model ...
Epoch: 76 cost time: 3.741763114929199
Epoch: 76, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.6122164726257324
Epoch: 77, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.911 Test Loss: 0.562 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.3108468055725098
Epoch: 78, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.906 Test Loss: 0.510 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.5983476638793945
Epoch: 79, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 3.47879695892334
Epoch: 80, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 3.410930633544922
Epoch: 81, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.911 Test Loss: 0.497 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 3.5103635787963867
Epoch: 82, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.911 Test Loss: 0.530 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 3.333596706390381
Epoch: 83, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.911 Test Loss: 0.540 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 3.3799691200256348
Epoch: 84, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.906 Test Loss: 0.581 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 3.3464345932006836
Epoch: 85, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.96581768989563
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.770 Vali Acc: 0.222 Test Loss: 1.770 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 3.63265061378479
Epoch: 2, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.727 Vali Acc: 0.256 Test Loss: 1.727 Test Acc: 0.256
Validation loss decreased (-0.222205 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 3.4966824054718018
Epoch: 3, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.674 Vali Acc: 0.244 Test Loss: 1.674 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2266063690185547
Epoch: 4, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.612 Vali Acc: 0.267 Test Loss: 1.612 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266651).  Saving model ...
Epoch: 5 cost time: 3.161644458770752
Epoch: 5, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.511 Vali Acc: 0.350 Test Loss: 1.511 Test Acc: 0.350
Validation loss decreased (-0.266651 --> -0.349985).  Saving model ...
Epoch: 6 cost time: 3.2272443771362305
Epoch: 6, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.382 Vali Acc: 0.478 Test Loss: 1.382 Test Acc: 0.478
Validation loss decreased (-0.349985 --> -0.477764).  Saving model ...
Epoch: 7 cost time: 3.3401715755462646
Epoch: 7, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.206 Vali Acc: 0.578 Test Loss: 1.206 Test Acc: 0.578
Validation loss decreased (-0.477764 --> -0.577766).  Saving model ...
Epoch: 8 cost time: 3.11104679107666
Epoch: 8, Steps: 12 | Train Loss: 1.214 Vali Loss: 0.937 Vali Acc: 0.650 Test Loss: 0.937 Test Acc: 0.650
Validation loss decreased (-0.577766 --> -0.649991).  Saving model ...
Epoch: 9 cost time: 3.4755876064300537
Epoch: 9, Steps: 12 | Train Loss: 1.008 Vali Loss: 0.753 Vali Acc: 0.656 Test Loss: 0.753 Test Acc: 0.656
Validation loss decreased (-0.649991 --> -0.655548).  Saving model ...
Epoch: 10 cost time: 3.5565989017486572
Epoch: 10, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.692 Vali Acc: 0.633 Test Loss: 0.692 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5071921348571777
Epoch: 11, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (-0.655548 --> -0.722216).  Saving model ...
Epoch: 12 cost time: 3.6818878650665283
Epoch: 12, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.541 Vali Acc: 0.733 Test Loss: 0.541 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 13 cost time: 3.1996891498565674
Epoch: 13, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.473 Vali Acc: 0.750 Test Loss: 0.473 Test Acc: 0.750
Validation loss decreased (-0.733328 --> -0.749995).  Saving model ...
Epoch: 14 cost time: 3.0320355892181396
Epoch: 14, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.453 Vali Acc: 0.761 Test Loss: 0.453 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761107).  Saving model ...
Epoch: 15 cost time: 2.989311456680298
Epoch: 15, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.417 Vali Acc: 0.811 Test Loss: 0.417 Test Acc: 0.811
Validation loss decreased (-0.761107 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 3.0968267917633057
Epoch: 16, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.390 Vali Acc: 0.800 Test Loss: 0.390 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.337239980697632
Epoch: 17, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.357 Vali Acc: 0.789 Test Loss: 0.357 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.480440378189087
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.333 Vali Acc: 0.811 Test Loss: 0.333 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 19 cost time: 3.556622266769409
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.321 Vali Acc: 0.800 Test Loss: 0.321 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.235715627670288
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
Validation loss decreased (-0.811108 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 3.3198843002319336
Epoch: 21, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.419098377227783
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.333 Vali Acc: 0.794 Test Loss: 0.333 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.476292133331299
Epoch: 23, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.311614751815796
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.340 Vali Acc: 0.811 Test Loss: 0.340 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.444082021713257
Epoch: 25, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 26 cost time: 3.2943050861358643
Epoch: 26, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.328 Vali Acc: 0.800 Test Loss: 0.328 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.22051739692688
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.303 Vali Acc: 0.811 Test Loss: 0.303 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.997396230697632
Epoch: 28, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2674057483673096
Epoch: 29, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.327 Vali Acc: 0.817 Test Loss: 0.327 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9761574268341064
Epoch: 30, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 31 cost time: 2.9901933670043945
Epoch: 31, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 32 cost time: 3.4658656120300293
Epoch: 32, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 33 cost time: 3.250971794128418
Epoch: 33, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.358 Vali Acc: 0.844 Test Loss: 0.358 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 34 cost time: 3.138035774230957
Epoch: 34, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.954421281814575
Epoch: 35, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 36 cost time: 2.8564565181732178
Epoch: 36, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 37 cost time: 3.0297434329986572
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0020620822906494
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.2774817943573
Epoch: 39, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.4642632007598877
Epoch: 40, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.413569211959839
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.2085561752319336
Epoch: 42, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.307429790496826
Epoch: 43, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.403 Vali Acc: 0.878 Test Loss: 0.403 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.421985387802124
Epoch: 44, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.2478134632110596
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 3.225975751876831
Epoch: 46, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.437 Vali Acc: 0.883 Test Loss: 0.437 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.2088191509246826
Epoch: 47, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.2113873958587646
Epoch: 48, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.87679123878479
Epoch: 49, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.7660698890686035
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 51 cost time: 2.8742146492004395
Epoch: 51, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.1259188652038574
Epoch: 52, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.1023788452148438
Epoch: 53, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.8153727054595947
Epoch: 54, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 55 cost time: 3.4658751487731934
Epoch: 55, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.4047536849975586
Epoch: 56, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.045867443084717
Epoch: 57, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.211028814315796
Epoch: 58, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916663).  Saving model ...
Epoch: 59 cost time: 3.308089256286621
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.3962838649749756
Epoch: 60, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.6247732639312744
Epoch: 61, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.5056121349334717
Epoch: 62, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.5806453227996826
Epoch: 63, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.2714548110961914
Epoch: 64, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.360 Vali Acc: 0.894 Test Loss: 0.360 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.379542112350464
Epoch: 65, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.416 Vali Acc: 0.917 Test Loss: 0.416 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 2.9876937866210938
Epoch: 66, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.1603291034698486
Epoch: 67, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922220).  Saving model ...
Epoch: 68 cost time: 3.435204267501831
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 69 cost time: 3.30908465385437
Epoch: 69, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.5538721084594727
Epoch: 70, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.9306986331939697
Epoch: 71, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.250502824783325
Epoch: 72, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.8477842807769775
Epoch: 73, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 3.129354238510132
Epoch: 74, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 3.2832460403442383
Epoch: 75, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 3.3907063007354736
Epoch: 76, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 3.282759666442871
Epoch: 77, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 3.0881052017211914
Epoch: 78, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.674160480499268
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.824 Vali Acc: 0.183 Test Loss: 1.824 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 3.6060397624969482
Epoch: 2, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.772 Vali Acc: 0.244 Test Loss: 1.772 Test Acc: 0.244
Validation loss decreased (-0.183315 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 3.8388960361480713
Epoch: 3, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.690 Vali Acc: 0.322 Test Loss: 1.690 Test Acc: 0.322
Validation loss decreased (-0.244427 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 3.3161582946777344
Epoch: 4, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.570 Vali Acc: 0.400 Test Loss: 1.570 Test Acc: 0.400
Validation loss decreased (-0.322205 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 3.419477701187134
Epoch: 5, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.401 Vali Acc: 0.506 Test Loss: 1.401 Test Acc: 0.506
Validation loss decreased (-0.399984 --> -0.505542).  Saving model ...
Epoch: 6 cost time: 3.068844795227051
Epoch: 6, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.189 Vali Acc: 0.594 Test Loss: 1.189 Test Acc: 0.594
Validation loss decreased (-0.505542 --> -0.594433).  Saving model ...
Epoch: 7 cost time: 3.0150258541107178
Epoch: 7, Steps: 12 | Train Loss: 1.408 Vali Loss: 0.995 Vali Acc: 0.572 Test Loss: 0.995 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3210127353668213
Epoch: 8, Steps: 12 | Train Loss: 1.141 Vali Loss: 0.834 Vali Acc: 0.606 Test Loss: 0.834 Test Acc: 0.606
Validation loss decreased (-0.594433 --> -0.605547).  Saving model ...
Epoch: 9 cost time: 3.7253148555755615
Epoch: 9, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.721 Vali Acc: 0.622 Test Loss: 0.721 Test Acc: 0.622
Validation loss decreased (-0.605547 --> -0.622215).  Saving model ...
Epoch: 10 cost time: 3.4522440433502197
Epoch: 10, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.657 Vali Acc: 0.667 Test Loss: 0.657 Test Acc: 0.667
Validation loss decreased (-0.622215 --> -0.666660).  Saving model ...
Epoch: 11 cost time: 3.378174066543579
Epoch: 11, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.578 Vali Acc: 0.694 Test Loss: 0.578 Test Acc: 0.694
Validation loss decreased (-0.666660 --> -0.694439).  Saving model ...
Epoch: 12 cost time: 2.956667423248291
Epoch: 12, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.511 Vali Acc: 0.739 Test Loss: 0.511 Test Acc: 0.739
Validation loss decreased (-0.694439 --> -0.738884).  Saving model ...
Epoch: 13 cost time: 2.933406352996826
Epoch: 13, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.452 Vali Acc: 0.761 Test Loss: 0.452 Test Acc: 0.761
Validation loss decreased (-0.738884 --> -0.761107).  Saving model ...
Epoch: 14 cost time: 3.0821619033813477
Epoch: 14, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
Validation loss decreased (-0.761107 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 3.042724132537842
Epoch: 15, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.370 Vali Acc: 0.806 Test Loss: 0.370 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 16 cost time: 3.0601906776428223
Epoch: 16, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.348 Vali Acc: 0.789 Test Loss: 0.348 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4684793949127197
Epoch: 17, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 18 cost time: 3.2944860458374023
Epoch: 18, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.337 Vali Acc: 0.811 Test Loss: 0.337 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4862585067749023
Epoch: 19, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 20 cost time: 3.16550350189209
Epoch: 20, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.324 Vali Acc: 0.806 Test Loss: 0.324 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.193829298019409
Epoch: 21, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 22 cost time: 3.289726495742798
Epoch: 22, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2166013717651367
Epoch: 23, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.309711456298828
Epoch: 24, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.304 Vali Acc: 0.833 Test Loss: 0.304 Test Acc: 0.833
Validation loss decreased (-0.827775 --> -0.833330).  Saving model ...
Epoch: 25 cost time: 3.436345338821411
Epoch: 25, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 26 cost time: 3.478038787841797
Epoch: 26, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 3.4806041717529297
Epoch: 27, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.287 Vali Acc: 0.844 Test Loss: 0.287 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1752769947052
Epoch: 28, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.316 Vali Acc: 0.822 Test Loss: 0.316 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0831148624420166
Epoch: 29, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 3.3422255516052246
Epoch: 30, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 31 cost time: 3.253272294998169
Epoch: 31, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 3.4771392345428467
Epoch: 32, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.475006341934204
Epoch: 33, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5835626125335693
Epoch: 34, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.273 Vali Acc: 0.856 Test Loss: 0.273 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.9128851890563965
Epoch: 35, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.1202638149261475
Epoch: 36, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.324 Vali Acc: 0.867 Test Loss: 0.324 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 37 cost time: 3.0891103744506836
Epoch: 37, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.393 Vali Acc: 0.839 Test Loss: 0.393 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.3161778450012207
Epoch: 38, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.586970567703247
Epoch: 39, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 40 cost time: 3.5025861263275146
Epoch: 40, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.445276975631714
Epoch: 41, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 3.1671700477600098
Epoch: 42, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 43 cost time: 3.335280656814575
Epoch: 43, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.173133611679077
Epoch: 44, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 3.1545064449310303
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.202227830886841
Epoch: 46, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.5419347286224365
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 3.308239221572876
Epoch: 48, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.022984504699707
Epoch: 49, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.078155279159546
Epoch: 50, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.329 Vali Acc: 0.894 Test Loss: 0.329 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.179698944091797
Epoch: 51, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 52 cost time: 3.095059633255005
Epoch: 52, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.0735650062561035
Epoch: 53, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.1931300163269043
Epoch: 54, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 3.2586417198181152
Epoch: 55, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 56 cost time: 3.626217842102051
Epoch: 56, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.115725040435791
Epoch: 57, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.31882643699646
Epoch: 58, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.3264122009277344
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.0380852222442627
Epoch: 60, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.1167943477630615
Epoch: 61, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.9568252563476562
Epoch: 62, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.206430673599243
Epoch: 63, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.426 Vali Acc: 0.911 Test Loss: 0.426 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.279562473297119
Epoch: 64, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.3980674743652344
Epoch: 65, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.437 Vali Acc: 0.883 Test Loss: 0.437 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.390407562255859
Epoch: 1, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.880 Vali Acc: 0.133 Test Loss: 1.880 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 3.3065311908721924
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.827 Vali Acc: 0.178 Test Loss: 1.827 Test Acc: 0.178
Validation loss decreased (-0.133315 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 3.401921272277832
Epoch: 3, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.747 Vali Acc: 0.250 Test Loss: 1.747 Test Acc: 0.250
Validation loss decreased (-0.177760 --> -0.249983).  Saving model ...
Epoch: 4 cost time: 3.439739465713501
Epoch: 4, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.629 Vali Acc: 0.339 Test Loss: 1.629 Test Acc: 0.339
Validation loss decreased (-0.249983 --> -0.338873).  Saving model ...
Epoch: 5 cost time: 3.398425817489624
Epoch: 5, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.460 Vali Acc: 0.511 Test Loss: 1.460 Test Acc: 0.511
Validation loss decreased (-0.338873 --> -0.511097).  Saving model ...
Epoch: 6 cost time: 3.22271990776062
Epoch: 6, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.250 Vali Acc: 0.561 Test Loss: 1.250 Test Acc: 0.561
Validation loss decreased (-0.511097 --> -0.561099).  Saving model ...
Epoch: 7 cost time: 3.299884557723999
Epoch: 7, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.051 Vali Acc: 0.556 Test Loss: 1.051 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2378311157226562
Epoch: 8, Steps: 12 | Train Loss: 1.263 Vali Loss: 0.889 Vali Acc: 0.578 Test Loss: 0.889 Test Acc: 0.578
Validation loss decreased (-0.561099 --> -0.577769).  Saving model ...
Epoch: 9 cost time: 3.3971598148345947
Epoch: 9, Steps: 12 | Train Loss: 0.998 Vali Loss: 0.759 Vali Acc: 0.611 Test Loss: 0.759 Test Acc: 0.611
Validation loss decreased (-0.577769 --> -0.611104).  Saving model ...
Epoch: 10 cost time: 3.3528666496276855
Epoch: 10, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.701 Vali Acc: 0.594 Test Loss: 0.701 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5215418338775635
Epoch: 11, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.611 Vali Acc: 0.706 Test Loss: 0.611 Test Acc: 0.706
Validation loss decreased (-0.611104 --> -0.705549).  Saving model ...
Epoch: 12 cost time: 3.2580482959747314
Epoch: 12, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.548 Vali Acc: 0.728 Test Loss: 0.548 Test Acc: 0.728
Validation loss decreased (-0.705549 --> -0.727772).  Saving model ...
Epoch: 13 cost time: 3.2112531661987305
Epoch: 13, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.482 Vali Acc: 0.767 Test Loss: 0.482 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766662).  Saving model ...
Epoch: 14 cost time: 3.1165645122528076
Epoch: 14, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.422 Vali Acc: 0.772 Test Loss: 0.422 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 15 cost time: 3.3284716606140137
Epoch: 15, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.380 Vali Acc: 0.811 Test Loss: 0.380 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 3.563748359680176
Epoch: 16, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5833053588867188
Epoch: 17, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.348 Vali Acc: 0.811 Test Loss: 0.348 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 18 cost time: 3.563882827758789
Epoch: 18, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.353 Vali Acc: 0.817 Test Loss: 0.353 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816663).  Saving model ...
Epoch: 19 cost time: 3.3342199325561523
Epoch: 19, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.317 Vali Acc: 0.822 Test Loss: 0.317 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 20 cost time: 3.2430903911590576
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2761828899383545
Epoch: 21, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.336 Vali Acc: 0.811 Test Loss: 0.336 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4742159843444824
Epoch: 22, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.363 Vali Acc: 0.811 Test Loss: 0.363 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.489729642868042
Epoch: 23, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 3.3039848804473877
Epoch: 24, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 25 cost time: 3.21840500831604
Epoch: 25, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.218642234802246
Epoch: 26, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2477612495422363
Epoch: 27, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 28 cost time: 3.3830676078796387
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.205854654312134
Epoch: 29, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.268 Vali Acc: 0.850 Test Loss: 0.268 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 3.3113584518432617
Epoch: 30, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 31 cost time: 3.340315818786621
Epoch: 31, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.292 Vali Acc: 0.844 Test Loss: 0.292 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.061171531677246
Epoch: 32, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.0976476669311523
Epoch: 33, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.2416350841522217
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2012295722961426
Epoch: 35, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.323 Vali Acc: 0.867 Test Loss: 0.323 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 36 cost time: 3.1908116340637207
Epoch: 36, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2458834648132324
Epoch: 37, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.18351674079895
Epoch: 38, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.0324254035949707
Epoch: 39, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 3.2181990146636963
Epoch: 40, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2894649505615234
Epoch: 41, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.300217390060425
Epoch: 42, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.435 Vali Acc: 0.883 Test Loss: 0.435 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.445237159729004
Epoch: 43, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.043107271194458
Epoch: 44, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.346 Vali Acc: 0.883 Test Loss: 0.346 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.2264809608459473
Epoch: 45, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.357 Vali Acc: 0.883 Test Loss: 0.357 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.5277748107910156
Epoch: 46, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.409 Vali Acc: 0.878 Test Loss: 0.409 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.2974302768707275
Epoch: 47, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.462174654006958
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.380 Vali Acc: 0.894 Test Loss: 0.380 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 49 cost time: 3.196135997772217
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.382 Vali Acc: 0.872 Test Loss: 0.382 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.2479910850524902
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 51 cost time: 3.0947935581207275
Epoch: 51, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.130977153778076
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.4445934295654297
Epoch: 53, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.366 Vali Acc: 0.906 Test Loss: 0.366 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.2788302898406982
Epoch: 54, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.424 Vali Acc: 0.894 Test Loss: 0.424 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.347403049468994
Epoch: 55, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.1615965366363525
Epoch: 56, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.101336717605591
Epoch: 57, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.167011022567749
Epoch: 58, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.08949875831604
Epoch: 59, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.4910643100738525
Epoch: 60, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.0219221115112305
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.2792203426361084
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.3644847869873047
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.5995702743530273
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.4184255599975586
Epoch: 5, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.7260966300964355
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.469438076019287
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2703187465667725
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 3.16487979888916
Epoch: 9, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 2.815272092819214
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4771265983581543
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.309366226196289
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4542465209960938
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0232577323913574
Epoch: 14, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8607935905456543
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.929837226867676
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 2.785780668258667
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 3.6520934104919434
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 3.2121992111206055
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4813592433929443
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5814411640167236
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.125788450241089
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 3.163898229598999
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5395596027374268
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.64540696144104
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6175572872161865
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.174454927444458
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.0885486602783203
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.349804162979126
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.6076948642730713
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.49979829788208
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.295379638671875
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 536262
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.303556203842163
Epoch: 1, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.797 Vali Acc: 0.144 Test Loss: 1.797 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 3.44531512260437
Epoch: 2, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.645 Vali Acc: 0.322 Test Loss: 1.645 Test Acc: 0.322
Validation loss decreased (-0.144426 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 3.498969793319702
Epoch: 3, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.484 Vali Acc: 0.450 Test Loss: 1.484 Test Acc: 0.450
Validation loss decreased (-0.322206 --> -0.449985).  Saving model ...
Epoch: 4 cost time: 3.4097464084625244
Epoch: 4, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.344 Vali Acc: 0.489 Test Loss: 1.344 Test Acc: 0.489
Validation loss decreased (-0.449985 --> -0.488875).  Saving model ...
Epoch: 5 cost time: 3.088810682296753
Epoch: 5, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.219 Vali Acc: 0.528 Test Loss: 1.219 Test Acc: 0.528
Validation loss decreased (-0.488875 --> -0.527766).  Saving model ...
Epoch: 6 cost time: 3.2235686779022217
Epoch: 6, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.111 Vali Acc: 0.567 Test Loss: 1.111 Test Acc: 0.567
Validation loss decreased (-0.527766 --> -0.566656).  Saving model ...
Epoch: 7 cost time: 3.007150173187256
Epoch: 7, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.008 Vali Acc: 0.578 Test Loss: 1.008 Test Acc: 0.578
Validation loss decreased (-0.566656 --> -0.577768).  Saving model ...
Epoch: 8 cost time: 3.281029462814331
Epoch: 8, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.908 Vali Acc: 0.644 Test Loss: 0.908 Test Acc: 0.644
Validation loss decreased (-0.577768 --> -0.644435).  Saving model ...
Epoch: 9 cost time: 3.1337571144104004
Epoch: 9, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.803 Vali Acc: 0.639 Test Loss: 0.803 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.995088577270508
Epoch: 10, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.711 Vali Acc: 0.689 Test Loss: 0.711 Test Acc: 0.689
Validation loss decreased (-0.644435 --> -0.688882).  Saving model ...
Epoch: 11 cost time: 3.3319244384765625
Epoch: 11, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.631 Vali Acc: 0.711 Test Loss: 0.631 Test Acc: 0.711
Validation loss decreased (-0.688882 --> -0.711105).  Saving model ...
Epoch: 12 cost time: 3.1036252975463867
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.556 Vali Acc: 0.711 Test Loss: 0.556 Test Acc: 0.711
Validation loss decreased (-0.711105 --> -0.711106).  Saving model ...
Epoch: 13 cost time: 3.3383188247680664
Epoch: 13, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
Validation loss decreased (-0.711106 --> -0.761106).  Saving model ...
Epoch: 14 cost time: 3.3784964084625244
Epoch: 14, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.469 Vali Acc: 0.778 Test Loss: 0.469 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 15 cost time: 2.9194436073303223
Epoch: 15, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.432 Vali Acc: 0.778 Test Loss: 0.432 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 3.072901964187622
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.409 Vali Acc: 0.806 Test Loss: 0.409 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 3.2412357330322266
Epoch: 17, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 3.326669692993164
Epoch: 18, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3158397674560547
Epoch: 19, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 20 cost time: 3.3200221061706543
Epoch: 20, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 3.2699952125549316
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 3.025604009628296
Epoch: 22, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.234617233276367
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.34035325050354
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4003121852874756
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 26 cost time: 3.2184481620788574
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.248276710510254
Epoch: 27, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.455 Vali Acc: 0.828 Test Loss: 0.455 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.22514271736145
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.251 Vali Acc: 0.850 Test Loss: 0.251 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.5048725605010986
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.516636371612549
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.008686065673828
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 32 cost time: 2.9452991485595703
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.0445923805236816
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 34 cost time: 3.6308982372283936
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 3.4992692470550537
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 36 cost time: 3.047075033187866
Epoch: 36, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 2.8694489002227783
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.9770071506500244
Epoch: 38, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3759865760803223
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 40 cost time: 3.591170072555542
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.1080474853515625
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.263646364212036
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.07009220123291
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 3.4108328819274902
Epoch: 44, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 3.451312303543091
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.1478564739227295
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.231102466583252
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.5516140460968018
Epoch: 48, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.427227735519409
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.297563076019287
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 51 cost time: 3.1195664405822754
Epoch: 51, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.1050260066986084
Epoch: 52, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.035766363143921
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.286836624145508
Epoch: 54, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 55 cost time: 3.318661689758301
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.911083221435547
Epoch: 56, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.9173552989959717
Epoch: 57, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.141115665435791
Epoch: 58, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.4862582683563232
Epoch: 59, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.404956817626953
Epoch: 60, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.3900232315063477
Epoch: 61, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.1304688453674316
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 63 cost time: 3.1905863285064697
Epoch: 63, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.287496566772461
Epoch: 64, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.4375858306884766
Epoch: 65, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.463177442550659
Epoch: 66, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 67 cost time: 3.1011416912078857
Epoch: 67, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.2576003074645996
Epoch: 68, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.0624096393585205
Epoch: 69, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.38955020904541
Epoch: 70, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.3770997524261475
Epoch: 71, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.1498818397521973
Epoch: 72, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 3.1436374187469482
Epoch: 73, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.1082239151000977
Epoch: 74, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.5337212085723877
Epoch: 75, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 3.453406810760498
Epoch: 76, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.827676296234131
Epoch: 1, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.824 Vali Acc: 0.200 Test Loss: 1.824 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.988832950592041
Epoch: 2, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.715 Vali Acc: 0.311 Test Loss: 1.715 Test Acc: 0.311
Validation loss decreased (-0.199982 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 3.2239699363708496
Epoch: 3, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.587 Vali Acc: 0.378 Test Loss: 1.587 Test Acc: 0.378
Validation loss decreased (-0.311094 --> -0.377762).  Saving model ...
Epoch: 4 cost time: 3.3509061336517334
Epoch: 4, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.466 Vali Acc: 0.428 Test Loss: 1.466 Test Acc: 0.428
Validation loss decreased (-0.377762 --> -0.427763).  Saving model ...
Epoch: 5 cost time: 3.204029083251953
Epoch: 5, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.343 Vali Acc: 0.456 Test Loss: 1.343 Test Acc: 0.456
Validation loss decreased (-0.427763 --> -0.455542).  Saving model ...
Epoch: 6 cost time: 3.4417285919189453
Epoch: 6, Steps: 12 | Train Loss: 1.203 Vali Loss: 1.234 Vali Acc: 0.483 Test Loss: 1.234 Test Acc: 0.483
Validation loss decreased (-0.455542 --> -0.483321).  Saving model ...
Epoch: 7 cost time: 3.293522596359253
Epoch: 7, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.126 Vali Acc: 0.511 Test Loss: 1.126 Test Acc: 0.511
Validation loss decreased (-0.483321 --> -0.511100).  Saving model ...
Epoch: 8 cost time: 3.108396530151367
Epoch: 8, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.030 Vali Acc: 0.583 Test Loss: 1.030 Test Acc: 0.583
Validation loss decreased (-0.511100 --> -0.583323).  Saving model ...
Epoch: 9 cost time: 3.203742265701294
Epoch: 9, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.923 Vali Acc: 0.611 Test Loss: 0.923 Test Acc: 0.611
Validation loss decreased (-0.583323 --> -0.611102).  Saving model ...
Epoch: 10 cost time: 3.0271592140197754
Epoch: 10, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.821 Vali Acc: 0.650 Test Loss: 0.821 Test Acc: 0.650
Validation loss decreased (-0.611102 --> -0.649992).  Saving model ...
Epoch: 11 cost time: 3.4449455738067627
Epoch: 11, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.721 Vali Acc: 0.694 Test Loss: 0.721 Test Acc: 0.694
Validation loss decreased (-0.649992 --> -0.694437).  Saving model ...
Epoch: 12 cost time: 3.3215126991271973
Epoch: 12, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.625 Vali Acc: 0.728 Test Loss: 0.625 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727772).  Saving model ...
Epoch: 13 cost time: 2.8836636543273926
Epoch: 13, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.571 Vali Acc: 0.744 Test Loss: 0.571 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 14 cost time: 3.108896255493164
Epoch: 14, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.522 Vali Acc: 0.767 Test Loss: 0.522 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 3.025743246078491
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.478 Vali Acc: 0.778 Test Loss: 0.478 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 3.354947328567505
Epoch: 16, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 3.441859722137451
Epoch: 17, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.406 Vali Acc: 0.794 Test Loss: 0.406 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0693609714508057
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 3.248401641845703
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.368 Vali Acc: 0.794 Test Loss: 0.368 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.172027349472046
Epoch: 20, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.364 Vali Acc: 0.794 Test Loss: 0.364 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.501328229904175
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 3.459073543548584
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 23 cost time: 3.3382065296173096
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.128683090209961
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1867222785949707
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 3.222236156463623
Epoch: 26, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.423785448074341
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.10310697555542
Epoch: 28, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 3.1948206424713135
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3322553634643555
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.560065269470215
Epoch: 31, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.1351685523986816
Epoch: 32, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.077300548553467
Epoch: 33, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.8715932369232178
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3855082988739014
Epoch: 35, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 3.473090887069702
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 3.1270387172698975
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 3.0570950508117676
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.3257296085357666
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.498953342437744
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.5490996837615967
Epoch: 41, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.212608814239502
Epoch: 42, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.113826274871826
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 3.1694412231445312
Epoch: 44, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.682389974594116
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.5582633018493652
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.2168197631835938
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 48 cost time: 2.892488956451416
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.251230478286743
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.306424617767334
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.3559868335723877
Epoch: 51, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.380 Vali Acc: 0.883 Test Loss: 0.380 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.1282248497009277
Epoch: 52, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.9511919021606445
Epoch: 53, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.392 Vali Acc: 0.883 Test Loss: 0.392 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.3049943447113037
Epoch: 54, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.212446689605713
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.679 Vali Acc: 0.878 Test Loss: 0.679 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.4697718620300293
Epoch: 56, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.126973867416382
Epoch: 57, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.145589590072632
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.827 Vali Acc: 0.200 Test Loss: 1.827 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 3.2001373767852783
Epoch: 2, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.754 Vali Acc: 0.261 Test Loss: 1.754 Test Acc: 0.261
Validation loss decreased (-0.199982 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 3.1079256534576416
Epoch: 3, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.655 Vali Acc: 0.344 Test Loss: 1.655 Test Acc: 0.344
Validation loss decreased (-0.261094 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 3.1354050636291504
Epoch: 4, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.558 Vali Acc: 0.378 Test Loss: 1.558 Test Acc: 0.378
Validation loss decreased (-0.344428 --> -0.377762).  Saving model ...
Epoch: 5 cost time: 3.6531999111175537
Epoch: 5, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.455 Vali Acc: 0.367 Test Loss: 1.455 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.33105731010437
Epoch: 6, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.354 Vali Acc: 0.389 Test Loss: 1.354 Test Acc: 0.389
Validation loss decreased (-0.377762 --> -0.388875).  Saving model ...
Epoch: 7 cost time: 3.038372278213501
Epoch: 7, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.249 Vali Acc: 0.444 Test Loss: 1.249 Test Acc: 0.444
Validation loss decreased (-0.388875 --> -0.444432).  Saving model ...
Epoch: 8 cost time: 2.9743733406066895
Epoch: 8, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.153 Vali Acc: 0.483 Test Loss: 1.153 Test Acc: 0.483
Validation loss decreased (-0.444432 --> -0.483322).  Saving model ...
Epoch: 9 cost time: 2.974881410598755
Epoch: 9, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.020 Vali Acc: 0.517 Test Loss: 1.020 Test Acc: 0.517
Validation loss decreased (-0.483322 --> -0.516656).  Saving model ...
Epoch: 10 cost time: 2.7872936725616455
Epoch: 10, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.908 Vali Acc: 0.583 Test Loss: 0.908 Test Acc: 0.583
Validation loss decreased (-0.516656 --> -0.583324).  Saving model ...
Epoch: 11 cost time: 2.756127119064331
Epoch: 11, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.815 Vali Acc: 0.622 Test Loss: 0.815 Test Acc: 0.622
Validation loss decreased (-0.583324 --> -0.622214).  Saving model ...
Epoch: 12 cost time: 3.0063588619232178
Epoch: 12, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.726 Vali Acc: 0.650 Test Loss: 0.726 Test Acc: 0.650
Validation loss decreased (-0.622214 --> -0.649993).  Saving model ...
Epoch: 13 cost time: 3.0481116771698
Epoch: 13, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.666 Vali Acc: 0.667 Test Loss: 0.666 Test Acc: 0.667
Validation loss decreased (-0.649993 --> -0.666660).  Saving model ...
Epoch: 14 cost time: 3.057162284851074
Epoch: 14, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.608 Vali Acc: 0.694 Test Loss: 0.608 Test Acc: 0.694
Validation loss decreased (-0.666660 --> -0.694438).  Saving model ...
Epoch: 15 cost time: 3.1966183185577393
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.561 Vali Acc: 0.756 Test Loss: 0.561 Test Acc: 0.756
Validation loss decreased (-0.694438 --> -0.755550).  Saving model ...
Epoch: 16 cost time: 3.0838637351989746
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.521 Vali Acc: 0.739 Test Loss: 0.521 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.338508367538452
Epoch: 17, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 18 cost time: 3.1609487533569336
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.467 Vali Acc: 0.767 Test Loss: 0.467 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 19 cost time: 3.184359550476074
Epoch: 19, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.427 Vali Acc: 0.789 Test Loss: 0.427 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 20 cost time: 3.5556201934814453
Epoch: 20, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.430 Vali Acc: 0.783 Test Loss: 0.430 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3550326824188232
Epoch: 21, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.415 Vali Acc: 0.789 Test Loss: 0.415 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788885).  Saving model ...
Epoch: 22 cost time: 3.53631329536438
Epoch: 22, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 23 cost time: 3.13734769821167
Epoch: 23, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.418 Vali Acc: 0.778 Test Loss: 0.418 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2275736331939697
Epoch: 24, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.456 Vali Acc: 0.789 Test Loss: 0.456 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.019747734069824
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 26 cost time: 2.975550651550293
Epoch: 26, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 27 cost time: 3.152531385421753
Epoch: 27, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.525 Vali Acc: 0.794 Test Loss: 0.525 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0214157104492188
Epoch: 28, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 29 cost time: 3.0304183959960938
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
Validation loss decreased (-0.822219 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 3.011030435562134
Epoch: 30, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.0255935192108154
Epoch: 31, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.060502290725708
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.487 Vali Acc: 0.817 Test Loss: 0.487 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.280998945236206
Epoch: 33, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.390 Vali Acc: 0.844 Test Loss: 0.390 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.3013827800750732
Epoch: 34, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3506128787994385
Epoch: 35, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.408 Vali Acc: 0.839 Test Loss: 0.408 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.3416588306427
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.4548940658569336
Epoch: 37, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.411 Vali Acc: 0.839 Test Loss: 0.411 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.4394350051879883
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.411 Vali Acc: 0.844 Test Loss: 0.411 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.500523090362549
Epoch: 39, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.357882261276245
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.851 Vali Acc: 0.178 Test Loss: 1.851 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 3.149709463119507
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.787 Vali Acc: 0.239 Test Loss: 1.787 Test Acc: 0.239
Validation loss decreased (-0.177759 --> -0.238871).  Saving model ...
Epoch: 3 cost time: 3.0713131427764893
Epoch: 3, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.708 Vali Acc: 0.267 Test Loss: 1.708 Test Acc: 0.267
Validation loss decreased (-0.238871 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 3.0735673904418945
Epoch: 4, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.632 Vali Acc: 0.294 Test Loss: 1.632 Test Acc: 0.294
Validation loss decreased (-0.266650 --> -0.294428).  Saving model ...
Epoch: 5 cost time: 2.965892791748047
Epoch: 5, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.542 Vali Acc: 0.361 Test Loss: 1.542 Test Acc: 0.361
Validation loss decreased (-0.294428 --> -0.361096).  Saving model ...
Epoch: 6 cost time: 3.061647653579712
Epoch: 6, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.422 Vali Acc: 0.383 Test Loss: 1.422 Test Acc: 0.383
Validation loss decreased (-0.361096 --> -0.383319).  Saving model ...
Epoch: 7 cost time: 3.0070149898529053
Epoch: 7, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.278 Vali Acc: 0.489 Test Loss: 1.278 Test Acc: 0.489
Validation loss decreased (-0.383319 --> -0.488876).  Saving model ...
Epoch: 8 cost time: 3.096381187438965
Epoch: 8, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.128 Vali Acc: 0.539 Test Loss: 1.128 Test Acc: 0.539
Validation loss decreased (-0.488876 --> -0.538878).  Saving model ...
Epoch: 9 cost time: 3.1439285278320312
Epoch: 9, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.912 Vali Acc: 0.561 Test Loss: 0.912 Test Acc: 0.561
Validation loss decreased (-0.538878 --> -0.561102).  Saving model ...
Epoch: 10 cost time: 3.495335102081299
Epoch: 10, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.798 Vali Acc: 0.589 Test Loss: 0.798 Test Acc: 0.589
Validation loss decreased (-0.561102 --> -0.588881).  Saving model ...
Epoch: 11 cost time: 3.260401487350464
Epoch: 11, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.754 Vali Acc: 0.594 Test Loss: 0.754 Test Acc: 0.594
Validation loss decreased (-0.588881 --> -0.594437).  Saving model ...
Epoch: 12 cost time: 3.124546766281128
Epoch: 12, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.649 Vali Acc: 0.661 Test Loss: 0.649 Test Acc: 0.661
Validation loss decreased (-0.594437 --> -0.661105).  Saving model ...
Epoch: 13 cost time: 3.2639858722686768
Epoch: 13, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.594 Vali Acc: 0.706 Test Loss: 0.594 Test Acc: 0.706
Validation loss decreased (-0.661105 --> -0.705550).  Saving model ...
Epoch: 14 cost time: 3.1973469257354736
Epoch: 14, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.536 Vali Acc: 0.700 Test Loss: 0.536 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.255293846130371
Epoch: 15, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.470 Vali Acc: 0.756 Test Loss: 0.470 Test Acc: 0.756
Validation loss decreased (-0.705550 --> -0.755551).  Saving model ...
Epoch: 16 cost time: 2.958282232284546
Epoch: 16, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.446 Vali Acc: 0.756 Test Loss: 0.446 Test Acc: 0.756
Validation loss decreased (-0.755551 --> -0.755551).  Saving model ...
Epoch: 17 cost time: 3.171360731124878
Epoch: 17, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.448 Vali Acc: 0.778 Test Loss: 0.448 Test Acc: 0.778
Validation loss decreased (-0.755551 --> -0.777773).  Saving model ...
Epoch: 18 cost time: 3.047339916229248
Epoch: 18, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.416 Vali Acc: 0.800 Test Loss: 0.416 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 2.963945150375366
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 3.026580572128296
Epoch: 20, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.412 Vali Acc: 0.817 Test Loss: 0.412 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 21 cost time: 2.9381797313690186
Epoch: 21, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.384 Vali Acc: 0.811 Test Loss: 0.384 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.782386064529419
Epoch: 22, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.865692138671875
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 24 cost time: 3.0787901878356934
Epoch: 24, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.447 Vali Acc: 0.794 Test Loss: 0.447 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.081293821334839
Epoch: 25, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 26 cost time: 3.166264057159424
Epoch: 26, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.359 Vali Acc: 0.839 Test Loss: 0.359 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 27 cost time: 3.164238452911377
Epoch: 27, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.478 Vali Acc: 0.811 Test Loss: 0.478 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1858327388763428
Epoch: 28, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 3.371074676513672
Epoch: 29, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 2.9411396980285645
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.9245641231536865
Epoch: 31, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8380539417266846
Epoch: 32, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.021615982055664
Epoch: 33, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.416 Vali Acc: 0.839 Test Loss: 0.416 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.060608148574829
Epoch: 34, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 35 cost time: 2.959320545196533
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2338366508483887
Epoch: 36, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.3331902027130127
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.052114486694336
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 39 cost time: 3.241267204284668
Epoch: 39, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 40 cost time: 3.1195871829986572
Epoch: 40, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.228743314743042
Epoch: 41, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894441).  Saving model ...
Epoch: 42 cost time: 3.1217005252838135
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.170647382736206
Epoch: 43, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.372568368911743
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.049110174179077
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.9314401149749756
Epoch: 46, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.428 Vali Acc: 0.883 Test Loss: 0.428 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.9987518787384033
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.401 Vali Acc: 0.894 Test Loss: 0.401 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.096996545791626
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.328887701034546
Epoch: 49, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.0452308654785156
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.987136125564575
Epoch: 51, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.597471714019775
Epoch: 1, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.923 Vali Acc: 0.117 Test Loss: 1.923 Test Acc: 0.117
Validation loss decreased (inf --> -0.116647).  Saving model ...
Epoch: 2 cost time: 3.0982465744018555
Epoch: 2, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.880 Vali Acc: 0.156 Test Loss: 1.880 Test Acc: 0.156
Validation loss decreased (-0.116647 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 3.198726177215576
Epoch: 3, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.811 Vali Acc: 0.250 Test Loss: 1.811 Test Acc: 0.250
Validation loss decreased (-0.155537 --> -0.249982).  Saving model ...
Epoch: 4 cost time: 3.2856247425079346
Epoch: 4, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.732 Vali Acc: 0.333 Test Loss: 1.732 Test Acc: 0.333
Validation loss decreased (-0.249982 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 3.253187656402588
Epoch: 5, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.616 Vali Acc: 0.439 Test Loss: 1.616 Test Acc: 0.439
Validation loss decreased (-0.333316 --> -0.438873).  Saving model ...
Epoch: 6 cost time: 3.317716360092163
Epoch: 6, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
Validation loss decreased (-0.438873 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 3.3721063137054443
Epoch: 7, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.218 Vali Acc: 0.556 Test Loss: 1.218 Test Acc: 0.556
Validation loss decreased (-0.488874 --> -0.555543).  Saving model ...
Epoch: 8 cost time: 3.1829497814178467
Epoch: 8, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.042 Vali Acc: 0.572 Test Loss: 1.042 Test Acc: 0.572
Validation loss decreased (-0.555543 --> -0.572212).  Saving model ...
Epoch: 9 cost time: 3.271446943283081
Epoch: 9, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.861 Vali Acc: 0.589 Test Loss: 0.861 Test Acc: 0.589
Validation loss decreased (-0.572212 --> -0.588880).  Saving model ...
Epoch: 10 cost time: 3.2884128093719482
Epoch: 10, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.783 Vali Acc: 0.589 Test Loss: 0.783 Test Acc: 0.589
Validation loss decreased (-0.588880 --> -0.588881).  Saving model ...
Epoch: 11 cost time: 3.0865590572357178
Epoch: 11, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.718 Vali Acc: 0.617 Test Loss: 0.718 Test Acc: 0.617
Validation loss decreased (-0.588881 --> -0.616659).  Saving model ...
Epoch: 12 cost time: 3.071981430053711
Epoch: 12, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.616 Vali Acc: 0.689 Test Loss: 0.616 Test Acc: 0.689
Validation loss decreased (-0.616659 --> -0.688883).  Saving model ...
Epoch: 13 cost time: 3.0982847213745117
Epoch: 13, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.562 Vali Acc: 0.728 Test Loss: 0.562 Test Acc: 0.728
Validation loss decreased (-0.688883 --> -0.727772).  Saving model ...
Epoch: 14 cost time: 2.877498149871826
Epoch: 14, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.512 Vali Acc: 0.728 Test Loss: 0.512 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727773).  Saving model ...
Epoch: 15 cost time: 2.9149186611175537
Epoch: 15, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.437 Vali Acc: 0.756 Test Loss: 0.437 Test Acc: 0.756
Validation loss decreased (-0.727773 --> -0.755551).  Saving model ...
Epoch: 16 cost time: 3.0634877681732178
Epoch: 16, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.415 Vali Acc: 0.783 Test Loss: 0.415 Test Acc: 0.783
Validation loss decreased (-0.755551 --> -0.783329).  Saving model ...
Epoch: 17 cost time: 3.0363690853118896
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.396 Vali Acc: 0.789 Test Loss: 0.396 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 3.2028145790100098
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.370 Vali Acc: 0.794 Test Loss: 0.370 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794441).  Saving model ...
Epoch: 19 cost time: 3.193781614303589
Epoch: 19, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
Validation loss decreased (-0.794441 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 3.2137720584869385
Epoch: 20, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2261524200439453
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.342 Vali Acc: 0.794 Test Loss: 0.342 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1948838233947754
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.321 Vali Acc: 0.817 Test Loss: 0.321 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 23 cost time: 3.0859174728393555
Epoch: 23, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.340 Vali Acc: 0.800 Test Loss: 0.340 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2188620567321777
Epoch: 24, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.396 Vali Acc: 0.811 Test Loss: 0.396 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.178858995437622
Epoch: 25, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.331 Vali Acc: 0.800 Test Loss: 0.331 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.034323215484619
Epoch: 26, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 27 cost time: 3.1732120513916016
Epoch: 27, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3092169761657715
Epoch: 28, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 2.9907357692718506
Epoch: 29, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 30 cost time: 3.323920249938965
Epoch: 30, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
Validation loss decreased (-0.827775 --> -0.833330).  Saving model ...
Epoch: 31 cost time: 3.1727817058563232
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.307 Vali Acc: 0.833 Test Loss: 0.307 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 32 cost time: 3.1190476417541504
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.434676170349121
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.3464276790618896
Epoch: 34, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.364 Vali Acc: 0.800 Test Loss: 0.364 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0366721153259277
Epoch: 35, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 36 cost time: 3.3738958835601807
Epoch: 36, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 37 cost time: 3.356653928756714
Epoch: 37, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 38 cost time: 3.1624443531036377
Epoch: 38, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.370 Vali Acc: 0.828 Test Loss: 0.370 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.238736867904663
Epoch: 39, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.0874626636505127
Epoch: 40, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 41 cost time: 3.1442549228668213
Epoch: 41, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 42 cost time: 3.147333860397339
Epoch: 42, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.372 Vali Acc: 0.856 Test Loss: 0.372 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.0712311267852783
Epoch: 43, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1676900386810303
Epoch: 44, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.4349777698516846
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.394365072250366
Epoch: 46, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.389 Vali Acc: 0.867 Test Loss: 0.389 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.985100269317627
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.365 Vali Acc: 0.894 Test Loss: 0.365 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 48 cost time: 3.0993616580963135
Epoch: 48, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2242767810821533
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 50 cost time: 3.18489670753479
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.304189920425415
Epoch: 51, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.213895559310913
Epoch: 52, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.089663028717041
Epoch: 53, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.042806625366211
Epoch: 54, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.1428775787353516
Epoch: 55, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.1582720279693604
Epoch: 56, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.1734519004821777
Epoch: 57, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.2363507747650146
Epoch: 58, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.1003570556640625
Epoch: 59, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.770292282104492
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.825 Vali Acc: 0.194 Test Loss: 1.825 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 3.3549551963806152
Epoch: 2, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.777 Vali Acc: 0.261 Test Loss: 1.777 Test Acc: 0.261
Validation loss decreased (-0.194426 --> -0.261093).  Saving model ...
Epoch: 3 cost time: 3.2323596477508545
Epoch: 3, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.701 Vali Acc: 0.317 Test Loss: 1.701 Test Acc: 0.317
Validation loss decreased (-0.261093 --> -0.316650).  Saving model ...
Epoch: 4 cost time: 3.0887832641601562
Epoch: 4, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.584 Vali Acc: 0.361 Test Loss: 1.584 Test Acc: 0.361
Validation loss decreased (-0.316650 --> -0.361095).  Saving model ...
Epoch: 5 cost time: 3.134769916534424
Epoch: 5, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.420 Vali Acc: 0.456 Test Loss: 1.420 Test Acc: 0.456
Validation loss decreased (-0.361095 --> -0.455541).  Saving model ...
Epoch: 6 cost time: 3.132535219192505
Epoch: 6, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.231 Vali Acc: 0.511 Test Loss: 1.231 Test Acc: 0.511
Validation loss decreased (-0.455541 --> -0.511099).  Saving model ...
Epoch: 7 cost time: 2.945935010910034
Epoch: 7, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
Validation loss decreased (-0.511099 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 2.9945850372314453
Epoch: 8, Steps: 12 | Train Loss: 1.222 Vali Loss: 0.901 Vali Acc: 0.550 Test Loss: 0.901 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549991).  Saving model ...
Epoch: 9 cost time: 2.7817511558532715
Epoch: 9, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.811 Vali Acc: 0.606 Test Loss: 0.811 Test Acc: 0.606
Validation loss decreased (-0.549991 --> -0.605547).  Saving model ...
Epoch: 10 cost time: 2.930870771408081
Epoch: 10, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.753 Vali Acc: 0.622 Test Loss: 0.753 Test Acc: 0.622
Validation loss decreased (-0.605547 --> -0.622215).  Saving model ...
Epoch: 11 cost time: 2.9832565784454346
Epoch: 11, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.695 Vali Acc: 0.683 Test Loss: 0.695 Test Acc: 0.683
Validation loss decreased (-0.622215 --> -0.683326).  Saving model ...
Epoch: 12 cost time: 2.978274345397949
Epoch: 12, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.595 Vali Acc: 0.683 Test Loss: 0.595 Test Acc: 0.683
Validation loss decreased (-0.683326 --> -0.683327).  Saving model ...
Epoch: 13 cost time: 2.9465951919555664
Epoch: 13, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.549 Vali Acc: 0.733 Test Loss: 0.549 Test Acc: 0.733
Validation loss decreased (-0.683327 --> -0.733328).  Saving model ...
Epoch: 14 cost time: 2.893367290496826
Epoch: 14, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 15 cost time: 3.1139883995056152
Epoch: 15, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.430 Vali Acc: 0.772 Test Loss: 0.430 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.297886848449707
Epoch: 16, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.393 Vali Acc: 0.800 Test Loss: 0.393 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 17 cost time: 3.412187337875366
Epoch: 17, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.391 Vali Acc: 0.778 Test Loss: 0.391 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.404881000518799
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.376 Vali Acc: 0.789 Test Loss: 0.376 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4509339332580566
Epoch: 19, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.358 Vali Acc: 0.800 Test Loss: 0.358 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 3.439159870147705
Epoch: 20, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 21 cost time: 3.521912097930908
Epoch: 21, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.340 Vali Acc: 0.811 Test Loss: 0.340 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.366860866546631
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 3.1924431324005127
Epoch: 23, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.376 Vali Acc: 0.794 Test Loss: 0.376 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1137404441833496
Epoch: 24, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2048351764678955
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.811 Test Loss: 0.349 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.038158416748047
Epoch: 26, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.326 Vali Acc: 0.817 Test Loss: 0.326 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1290977001190186
Epoch: 27, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.1755824089050293
Epoch: 28, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 29 cost time: 3.11788272857666
Epoch: 29, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.992990493774414
Epoch: 30, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0807454586029053
Epoch: 31, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 32 cost time: 3.273681640625
Epoch: 32, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1590921878814697
Epoch: 33, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.187023639678955
Epoch: 34, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.267897605895996
Epoch: 35, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 3.2422714233398438
Epoch: 36, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.9300098419189453
Epoch: 37, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.390 Vali Acc: 0.844 Test Loss: 0.390 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.208563804626465
Epoch: 38, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.348 Vali Acc: 0.856 Test Loss: 0.348 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.1660103797912598
Epoch: 39, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 40 cost time: 3.156421422958374
Epoch: 40, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.179492473602295
Epoch: 41, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 42 cost time: 3.03802227973938
Epoch: 42, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877774).  Saving model ...
Epoch: 43 cost time: 2.9718847274780273
Epoch: 43, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.970003366470337
Epoch: 44, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.412 Vali Acc: 0.867 Test Loss: 0.412 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.9695119857788086
Epoch: 45, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.407 Vali Acc: 0.872 Test Loss: 0.407 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.0224549770355225
Epoch: 46, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 47 cost time: 3.2641851902008057
Epoch: 47, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.423 Vali Acc: 0.878 Test Loss: 0.423 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.2924787998199463
Epoch: 48, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.367 Vali Acc: 0.894 Test Loss: 0.367 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 49 cost time: 3.223252773284912
Epoch: 49, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.210139274597168
Epoch: 50, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.430 Vali Acc: 0.867 Test Loss: 0.430 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.2950711250305176
Epoch: 51, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.3011343479156494
Epoch: 52, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 53 cost time: 3.276186227798462
Epoch: 53, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.052996873855591
Epoch: 54, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.467 Vali Acc: 0.883 Test Loss: 0.467 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.143850564956665
Epoch: 55, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911107).  Saving model ...
Epoch: 56 cost time: 3.218348503112793
Epoch: 56, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.111588478088379
Epoch: 57, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.3351995944976807
Epoch: 58, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.420 Vali Acc: 0.911 Test Loss: 0.420 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 59 cost time: 3.0186331272125244
Epoch: 59, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.390 Vali Acc: 0.911 Test Loss: 0.390 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 60 cost time: 3.088621139526367
Epoch: 60, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.179063558578491
Epoch: 61, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
Validation loss decreased (-0.911107 --> -0.927775).  Saving model ...
Epoch: 62 cost time: 3.2609095573425293
Epoch: 62, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.277076244354248
Epoch: 63, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.488 Vali Acc: 0.911 Test Loss: 0.488 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.2260024547576904
Epoch: 64, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.215327739715576
Epoch: 65, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.353 Vali Acc: 0.933 Test Loss: 0.353 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933330).  Saving model ...
Epoch: 66 cost time: 3.0978167057037354
Epoch: 66, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.047774076461792
Epoch: 67, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.0668046474456787
Epoch: 68, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.928 Test Loss: 0.303 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.2169904708862305
Epoch: 69, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.933 Test Loss: 0.353 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.1732680797576904
Epoch: 70, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.939 Test Loss: 0.354 Test Acc: 0.939
Validation loss decreased (-0.933330 --> -0.938885).  Saving model ...
Epoch: 71 cost time: 3.2398786544799805
Epoch: 71, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.928 Test Loss: 0.348 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.29367733001709
Epoch: 72, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.482 Vali Acc: 0.917 Test Loss: 0.482 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.385052442550659
Epoch: 73, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.464 Vali Acc: 0.933 Test Loss: 0.464 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.2367656230926514
Epoch: 74, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.338008403778076
Epoch: 75, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.580 Vali Acc: 0.911 Test Loss: 0.580 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.2498202323913574
Epoch: 76, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.2632758617401123
Epoch: 77, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.393 Vali Acc: 0.906 Test Loss: 0.393 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.2596826553344727
Epoch: 78, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 3.091374397277832
Epoch: 79, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.928 Test Loss: 0.399 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 3.083728551864624
Epoch: 80, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.894 Test Loss: 0.505 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.279947280883789
Epoch: 1, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.828 Vali Acc: 0.128 Test Loss: 1.828 Test Acc: 0.128
Validation loss decreased (inf --> -0.127759).  Saving model ...
Epoch: 2 cost time: 3.0978341102600098
Epoch: 2, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.784 Vali Acc: 0.161 Test Loss: 1.784 Test Acc: 0.161
Validation loss decreased (-0.127759 --> -0.161093).  Saving model ...
Epoch: 3 cost time: 3.0469226837158203
Epoch: 3, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.707 Vali Acc: 0.239 Test Loss: 1.707 Test Acc: 0.239
Validation loss decreased (-0.161093 --> -0.238872).  Saving model ...
Epoch: 4 cost time: 3.0984346866607666
Epoch: 4, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.597 Vali Acc: 0.372 Test Loss: 1.597 Test Acc: 0.372
Validation loss decreased (-0.238872 --> -0.372206).  Saving model ...
Epoch: 5 cost time: 3.3443002700805664
Epoch: 5, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
Validation loss decreased (-0.372206 --> -0.488875).  Saving model ...
Epoch: 6 cost time: 3.244933843612671
Epoch: 6, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.231 Vali Acc: 0.533 Test Loss: 1.231 Test Acc: 0.533
Validation loss decreased (-0.488875 --> -0.533321).  Saving model ...
Epoch: 7 cost time: 3.2322187423706055
Epoch: 7, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.029 Vali Acc: 0.561 Test Loss: 1.029 Test Acc: 0.561
Validation loss decreased (-0.533321 --> -0.561101).  Saving model ...
Epoch: 8 cost time: 3.1101231575012207
Epoch: 8, Steps: 12 | Train Loss: 1.286 Vali Loss: 0.877 Vali Acc: 0.589 Test Loss: 0.877 Test Acc: 0.589
Validation loss decreased (-0.561101 --> -0.588880).  Saving model ...
Epoch: 9 cost time: 3.1186931133270264
Epoch: 9, Steps: 12 | Train Loss: 0.995 Vali Loss: 0.787 Vali Acc: 0.572 Test Loss: 0.787 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.187361001968384
Epoch: 10, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.725 Vali Acc: 0.594 Test Loss: 0.725 Test Acc: 0.594
Validation loss decreased (-0.588880 --> -0.594437).  Saving model ...
Epoch: 11 cost time: 2.945754289627075
Epoch: 11, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.665 Vali Acc: 0.650 Test Loss: 0.665 Test Acc: 0.650
Validation loss decreased (-0.594437 --> -0.649993).  Saving model ...
Epoch: 12 cost time: 3.0894665718078613
Epoch: 12, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.567 Vali Acc: 0.689 Test Loss: 0.567 Test Acc: 0.689
Validation loss decreased (-0.649993 --> -0.688883).  Saving model ...
Epoch: 13 cost time: 3.101430654525757
Epoch: 13, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.541 Vali Acc: 0.689 Test Loss: 0.541 Test Acc: 0.689
Validation loss decreased (-0.688883 --> -0.688883).  Saving model ...
Epoch: 14 cost time: 3.0689034461975098
Epoch: 14, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.462 Vali Acc: 0.783 Test Loss: 0.462 Test Acc: 0.783
Validation loss decreased (-0.688883 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 3.1192569732666016
Epoch: 15, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.444 Vali Acc: 0.767 Test Loss: 0.444 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9509823322296143
Epoch: 16, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.406 Vali Acc: 0.794 Test Loss: 0.406 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 3.2936878204345703
Epoch: 17, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.412 Vali Acc: 0.767 Test Loss: 0.412 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3046741485595703
Epoch: 18, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.389 Vali Acc: 0.778 Test Loss: 0.389 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3464901447296143
Epoch: 19, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.378 Vali Acc: 0.772 Test Loss: 0.378 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3239352703094482
Epoch: 20, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.369 Vali Acc: 0.789 Test Loss: 0.369 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.165597438812256
Epoch: 21, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.357 Vali Acc: 0.789 Test Loss: 0.357 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.133953809738159
Epoch: 22, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.350 Vali Acc: 0.789 Test Loss: 0.350 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.1184134483337402
Epoch: 23, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.387 Vali Acc: 0.783 Test Loss: 0.387 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.399545192718506
Epoch: 24, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 25 cost time: 3.5288166999816895
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.350 Vali Acc: 0.806 Test Loss: 0.350 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 26 cost time: 3.436328172683716
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.335 Vali Acc: 0.811 Test Loss: 0.335 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811108).  Saving model ...
Epoch: 27 cost time: 3.222557306289673
Epoch: 27, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
Validation loss decreased (-0.811108 --> -0.827774).  Saving model ...
Epoch: 28 cost time: 3.261944055557251
Epoch: 28, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.335 Vali Acc: 0.811 Test Loss: 0.335 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4729011058807373
Epoch: 29, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.567852735519409
Epoch: 30, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.459710121154785
Epoch: 31, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.4993889331817627
Epoch: 32, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.373814582824707
Epoch: 33, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.357 Vali Acc: 0.811 Test Loss: 0.357 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8689942359924316
Epoch: 34, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.0237090587615967
Epoch: 35, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.946030378341675
Epoch: 36, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 37 cost time: 3.0650389194488525
Epoch: 37, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.912397861480713
Epoch: 38, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 39 cost time: 2.9934210777282715
Epoch: 39, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 40 cost time: 3.1960325241088867
Epoch: 40, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.398 Vali Acc: 0.844 Test Loss: 0.398 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.0788421630859375
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 42 cost time: 3.2268779277801514
Epoch: 42, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.406053304672241
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.356 Vali Acc: 0.856 Test Loss: 0.356 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1034393310546875
Epoch: 44, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 45 cost time: 3.1414153575897217
Epoch: 45, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 46 cost time: 3.0346789360046387
Epoch: 46, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.019742012023926
Epoch: 47, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.2028868198394775
Epoch: 48, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 49 cost time: 3.2702109813690186
Epoch: 49, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.380 Vali Acc: 0.878 Test Loss: 0.380 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.1829755306243896
Epoch: 50, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.0139358043670654
Epoch: 51, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.0459861755371094
Epoch: 52, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 53 cost time: 2.7372796535491943
Epoch: 53, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 54 cost time: 2.9770939350128174
Epoch: 54, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.136019706726074
Epoch: 55, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.1943445205688477
Epoch: 56, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.25236177444458
Epoch: 57, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.2638461589813232
Epoch: 58, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.903658628463745
Epoch: 59, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 3.1336824893951416
Epoch: 60, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.408 Vali Acc: 0.872 Test Loss: 0.408 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.9801275730133057
Epoch: 61, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.21262788772583
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.385 Vali Acc: 0.883 Test Loss: 0.385 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.4207851886749268
Epoch: 63, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 3.2245852947235107
Epoch: 64, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.662 Vali Acc: 0.867 Test Loss: 0.662 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.305986166000366
Epoch: 65, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.573 Vali Acc: 0.889 Test Loss: 0.573 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.448350429534912
Epoch: 66, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 3.5785577297210693
Epoch: 67, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 3.5943589210510254
Epoch: 68, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.662 Vali Acc: 0.872 Test Loss: 0.662 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 3.8804311752319336
Epoch: 69, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.65087103843689
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.13163161277771
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.971701145172119
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.386321783065796
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.339477777481079
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.3912596702575684
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4480321407318115
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2913222312927246
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.711726427078247
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3003358840942383
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5757882595062256
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2803452014923096
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.390852928161621
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.288300037384033
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.7157535552978516
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 339654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.51132345199585
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.803 Vali Acc: 0.183 Test Loss: 1.803 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 3.4678263664245605
Epoch: 2, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.652 Vali Acc: 0.361 Test Loss: 1.652 Test Acc: 0.361
Validation loss decreased (-0.183315 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 3.4943764209747314
Epoch: 3, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.502 Vali Acc: 0.456 Test Loss: 1.502 Test Acc: 0.456
Validation loss decreased (-0.361095 --> -0.455541).  Saving model ...
Epoch: 4 cost time: 3.3872663974761963
Epoch: 4, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.355 Vali Acc: 0.483 Test Loss: 1.355 Test Acc: 0.483
Validation loss decreased (-0.455541 --> -0.483320).  Saving model ...
Epoch: 5 cost time: 3.697023391723633
Epoch: 5, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.242 Vali Acc: 0.561 Test Loss: 1.242 Test Acc: 0.561
Validation loss decreased (-0.483320 --> -0.561099).  Saving model ...
Epoch: 6 cost time: 3.408848285675049
Epoch: 6, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.131 Vali Acc: 0.556 Test Loss: 1.131 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.202838659286499
Epoch: 7, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.028 Vali Acc: 0.572 Test Loss: 1.028 Test Acc: 0.572
Validation loss decreased (-0.561099 --> -0.572212).  Saving model ...
Epoch: 8 cost time: 3.0603692531585693
Epoch: 8, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.923 Vali Acc: 0.633 Test Loss: 0.923 Test Acc: 0.633
Validation loss decreased (-0.572212 --> -0.633324).  Saving model ...
Epoch: 9 cost time: 3.581275224685669
Epoch: 9, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.844 Vali Acc: 0.656 Test Loss: 0.844 Test Acc: 0.656
Validation loss decreased (-0.633324 --> -0.655547).  Saving model ...
Epoch: 10 cost time: 3.152404546737671
Epoch: 10, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.766 Vali Acc: 0.656 Test Loss: 0.766 Test Acc: 0.656
Validation loss decreased (-0.655547 --> -0.655548).  Saving model ...
Epoch: 11 cost time: 3.2806570529937744
Epoch: 11, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
Validation loss decreased (-0.655548 --> -0.716660).  Saving model ...
Epoch: 12 cost time: 3.227651834487915
Epoch: 12, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.578 Vali Acc: 0.739 Test Loss: 0.578 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738883).  Saving model ...
Epoch: 13 cost time: 3.267392158508301
Epoch: 13, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.548 Vali Acc: 0.739 Test Loss: 0.548 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 14 cost time: 3.242920398712158
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772217).  Saving model ...
Epoch: 15 cost time: 3.312211036682129
Epoch: 15, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.433 Vali Acc: 0.789 Test Loss: 0.433 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 16 cost time: 3.494563341140747
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.438 Vali Acc: 0.783 Test Loss: 0.438 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2003326416015625
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.388 Vali Acc: 0.794 Test Loss: 0.388 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794441).  Saving model ...
Epoch: 18 cost time: 3.4860024452209473
Epoch: 18, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
Validation loss decreased (-0.794441 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 3.45615816116333
Epoch: 19, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8181514739990234
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 2.6686205863952637
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.952260732650757
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 23 cost time: 2.87662410736084
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 2.8705875873565674
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9234092235565186
Epoch: 25, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.752150058746338
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.968402862548828
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 28 cost time: 3.1092052459716797
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 3.2868664264678955
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 3.5828025341033936
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 31 cost time: 3.4389069080352783
Epoch: 31, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6384918689727783
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.075983762741089
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 3.3409485816955566
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1929996013641357
Epoch: 35, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.400399684906006
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.0208966732025146
Epoch: 37, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.8573567867279053
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1204004287719727
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.9447691440582275
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.2410190105438232
Epoch: 41, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.0975587368011475
Epoch: 42, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.162015438079834
Epoch: 43, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.48882794380188
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.824 Vali Acc: 0.156 Test Loss: 1.824 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 3.309387683868408
Epoch: 2, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.710 Vali Acc: 0.289 Test Loss: 1.710 Test Acc: 0.289
Validation loss decreased (-0.155537 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 3.4848098754882812
Epoch: 3, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.591 Vali Acc: 0.356 Test Loss: 1.591 Test Acc: 0.356
Validation loss decreased (-0.288872 --> -0.355540).  Saving model ...
Epoch: 4 cost time: 3.314523696899414
Epoch: 4, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.468 Vali Acc: 0.456 Test Loss: 1.468 Test Acc: 0.456
Validation loss decreased (-0.355540 --> -0.455541).  Saving model ...
Epoch: 5 cost time: 3.3225393295288086
Epoch: 5, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.358 Vali Acc: 0.494 Test Loss: 1.358 Test Acc: 0.494
Validation loss decreased (-0.455541 --> -0.494431).  Saving model ...
Epoch: 6 cost time: 3.5220561027526855
Epoch: 6, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.245 Vali Acc: 0.522 Test Loss: 1.245 Test Acc: 0.522
Validation loss decreased (-0.494431 --> -0.522210).  Saving model ...
Epoch: 7 cost time: 3.288557291030884
Epoch: 7, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.136 Vali Acc: 0.539 Test Loss: 1.136 Test Acc: 0.539
Validation loss decreased (-0.522210 --> -0.538878).  Saving model ...
Epoch: 8 cost time: 3.311823844909668
Epoch: 8, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.026 Vali Acc: 0.561 Test Loss: 1.026 Test Acc: 0.561
Validation loss decreased (-0.538878 --> -0.561101).  Saving model ...
Epoch: 9 cost time: 3.1724750995635986
Epoch: 9, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.938 Vali Acc: 0.606 Test Loss: 0.938 Test Acc: 0.606
Validation loss decreased (-0.561101 --> -0.605546).  Saving model ...
Epoch: 10 cost time: 3.148050308227539
Epoch: 10, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.845 Vali Acc: 0.639 Test Loss: 0.845 Test Acc: 0.639
Validation loss decreased (-0.605546 --> -0.638880).  Saving model ...
Epoch: 11 cost time: 3.1630373001098633
Epoch: 11, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
Validation loss decreased (-0.638880 --> -0.722215).  Saving model ...
Epoch: 12 cost time: 3.0721170902252197
Epoch: 12, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.630 Vali Acc: 0.744 Test Loss: 0.630 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 3.3037312030792236
Epoch: 13, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.287956476211548
Epoch: 14, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.515 Vali Acc: 0.750 Test Loss: 0.515 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749995).  Saving model ...
Epoch: 15 cost time: 3.4754638671875
Epoch: 15, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.465 Vali Acc: 0.772 Test Loss: 0.465 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 16 cost time: 3.0821902751922607
Epoch: 16, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.448 Vali Acc: 0.800 Test Loss: 0.448 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799996).  Saving model ...
Epoch: 17 cost time: 3.190014600753784
Epoch: 17, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.408 Vali Acc: 0.778 Test Loss: 0.408 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1819777488708496
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 19 cost time: 3.2566609382629395
Epoch: 19, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 3.140366315841675
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.352 Vali Acc: 0.811 Test Loss: 0.352 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 21 cost time: 3.251677989959717
Epoch: 21, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
Validation loss decreased (-0.811108 --> -0.822219).  Saving model ...
Epoch: 22 cost time: 3.077498197555542
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 2.806912660598755
Epoch: 23, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4092977046966553
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.314 Vali Acc: 0.828 Test Loss: 0.314 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 25 cost time: 3.188075304031372
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
Validation loss decreased (-0.827775 --> -0.833330).  Saving model ...
Epoch: 26 cost time: 3.564281702041626
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 3.4085023403167725
Epoch: 27, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 28 cost time: 3.1565029621124268
Epoch: 28, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4816038608551025
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.844 Test Loss: 0.284 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.047091484069824
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 31 cost time: 2.730463981628418
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.874340772628784
Epoch: 32, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 33 cost time: 2.83075213432312
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 34 cost time: 2.802338123321533
Epoch: 34, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4767704010009766
Epoch: 35, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0863683223724365
Epoch: 36, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.5717549324035645
Epoch: 37, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.3742547035217285
Epoch: 38, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.311506986618042
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 40 cost time: 3.2835423946380615
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.160468101501465
Epoch: 41, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.8546557426452637
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 43 cost time: 3.10973858833313
Epoch: 43, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.124042510986328
Epoch: 44, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 45 cost time: 3.6724398136138916
Epoch: 45, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 3.201209306716919
Epoch: 46, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.646026611328125
Epoch: 47, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.33278489112854
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 3.5372674465179443
Epoch: 49, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 3.1451988220214844
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.1416444778442383
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.0508992671966553
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.3103649616241455
Epoch: 53, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.9672868251800537
Epoch: 54, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.2422287464141846
Epoch: 55, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.175924777984619
Epoch: 56, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.2868494987487793
Epoch: 57, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.142575263977051
Epoch: 58, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.5727555751800537
Epoch: 59, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.7235190868377686
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.804 Vali Acc: 0.183 Test Loss: 1.804 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 3.1101675033569336
Epoch: 2, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.727 Vali Acc: 0.261 Test Loss: 1.727 Test Acc: 0.261
Validation loss decreased (-0.183315 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 3.073831558227539
Epoch: 3, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
Validation loss decreased (-0.261094 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 3.111255407333374
Epoch: 4, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.551 Vali Acc: 0.378 Test Loss: 1.551 Test Acc: 0.378
Validation loss decreased (-0.299984 --> -0.377762).  Saving model ...
Epoch: 5 cost time: 3.375312089920044
Epoch: 5, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.465 Vali Acc: 0.361 Test Loss: 1.465 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1099932193756104
Epoch: 6, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.363 Vali Acc: 0.428 Test Loss: 1.363 Test Acc: 0.428
Validation loss decreased (-0.377762 --> -0.427764).  Saving model ...
Epoch: 7 cost time: 3.1716232299804688
Epoch: 7, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.259 Vali Acc: 0.450 Test Loss: 1.259 Test Acc: 0.450
Validation loss decreased (-0.427764 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 3.186187505722046
Epoch: 8, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 3.1465256214141846
Epoch: 9, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.037 Vali Acc: 0.528 Test Loss: 1.037 Test Acc: 0.528
Validation loss decreased (-0.499989 --> -0.527767).  Saving model ...
Epoch: 10 cost time: 3.3574697971343994
Epoch: 10, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.931 Vali Acc: 0.606 Test Loss: 0.931 Test Acc: 0.606
Validation loss decreased (-0.527767 --> -0.605546).  Saving model ...
Epoch: 11 cost time: 3.0146923065185547
Epoch: 11, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.821 Vali Acc: 0.633 Test Loss: 0.821 Test Acc: 0.633
Validation loss decreased (-0.605546 --> -0.633325).  Saving model ...
Epoch: 12 cost time: 2.6810803413391113
Epoch: 12, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.738 Vali Acc: 0.672 Test Loss: 0.738 Test Acc: 0.672
Validation loss decreased (-0.633325 --> -0.672215).  Saving model ...
Epoch: 13 cost time: 2.957932949066162
Epoch: 13, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.693 Vali Acc: 0.672 Test Loss: 0.693 Test Acc: 0.672
Validation loss decreased (-0.672215 --> -0.672215).  Saving model ...
Epoch: 14 cost time: 2.919612169265747
Epoch: 14, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (-0.672215 --> -0.722216).  Saving model ...
Epoch: 15 cost time: 2.6719212532043457
Epoch: 15, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.550 Vali Acc: 0.744 Test Loss: 0.550 Test Acc: 0.744
Validation loss decreased (-0.722216 --> -0.744439).  Saving model ...
Epoch: 16 cost time: 2.766428232192993
Epoch: 16, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.517 Vali Acc: 0.772 Test Loss: 0.517 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772217).  Saving model ...
Epoch: 17 cost time: 2.8058648109436035
Epoch: 17, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.463 Vali Acc: 0.772 Test Loss: 0.463 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 18 cost time: 3.2260165214538574
Epoch: 18, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.440 Vali Acc: 0.772 Test Loss: 0.440 Test Acc: 0.772
Validation loss decreased (-0.772218 --> -0.772218).  Saving model ...
Epoch: 19 cost time: 3.434203624725342
Epoch: 19, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.420 Vali Acc: 0.811 Test Loss: 0.420 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 3.112997055053711
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.408 Vali Acc: 0.789 Test Loss: 0.408 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1564688682556152
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.398 Vali Acc: 0.794 Test Loss: 0.398 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1349947452545166
Epoch: 22, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.404 Vali Acc: 0.800 Test Loss: 0.404 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0284111499786377
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 24 cost time: 3.177898406982422
Epoch: 24, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.389 Vali Acc: 0.800 Test Loss: 0.389 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9905059337615967
Epoch: 25, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.416 Vali Acc: 0.800 Test Loss: 0.416 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1032514572143555
Epoch: 26, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 27 cost time: 2.8171229362487793
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 28 cost time: 2.871877431869507
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 29 cost time: 2.9233713150024414
Epoch: 29, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0547657012939453
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.393 Vali Acc: 0.817 Test Loss: 0.393 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.977562427520752
Epoch: 31, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.415 Vali Acc: 0.811 Test Loss: 0.415 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.155177593231201
Epoch: 32, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 33 cost time: 3.184699535369873
Epoch: 33, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 34 cost time: 2.9521307945251465
Epoch: 34, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.657480239868164
Epoch: 35, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844440).  Saving model ...
Epoch: 36 cost time: 2.9152166843414307
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.051281690597534
Epoch: 37, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.435 Vali Acc: 0.828 Test Loss: 0.435 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.030480146408081
Epoch: 38, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.0307211875915527
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 40 cost time: 3.1800317764282227
Epoch: 40, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 41 cost time: 3.3741867542266846
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 42 cost time: 3.312392234802246
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.3273637294769287
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.422 Vali Acc: 0.856 Test Loss: 0.422 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1091649532318115
Epoch: 44, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.383 Vali Acc: 0.872 Test Loss: 0.383 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 45 cost time: 3.2155985832214355
Epoch: 45, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.427 Vali Acc: 0.872 Test Loss: 0.427 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.1813743114471436
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.440 Vali Acc: 0.856 Test Loss: 0.440 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1238744258880615
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.391 Vali Acc: 0.878 Test Loss: 0.391 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 48 cost time: 3.0666353702545166
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.390 Vali Acc: 0.872 Test Loss: 0.390 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2856388092041016
Epoch: 49, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.418 Vali Acc: 0.872 Test Loss: 0.418 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.1278131008148193
Epoch: 50, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.391 Vali Acc: 0.872 Test Loss: 0.391 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.069363832473755
Epoch: 51, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.358 Vali Acc: 0.894 Test Loss: 0.358 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 52 cost time: 2.994863986968994
Epoch: 52, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.357450246810913
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.2462687492370605
Epoch: 54, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.1585230827331543
Epoch: 55, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.308835506439209
Epoch: 56, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.4205522537231445
Epoch: 57, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.1983940601348877
Epoch: 58, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.688 Vali Acc: 0.861 Test Loss: 0.688 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.232830286026001
Epoch: 59, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.9618782997131348
Epoch: 60, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.507 Vali Acc: 0.883 Test Loss: 0.507 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.3553009033203125
Epoch: 61, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.043379783630371
Epoch: 1, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.840 Vali Acc: 0.167 Test Loss: 1.840 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 3.4077675342559814
Epoch: 2, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.774 Vali Acc: 0.250 Test Loss: 1.774 Test Acc: 0.250
Validation loss decreased (-0.166648 --> -0.249982).  Saving model ...
Epoch: 3 cost time: 3.247178554534912
Epoch: 3, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.710 Vali Acc: 0.239 Test Loss: 1.710 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3897206783294678
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.636 Vali Acc: 0.317 Test Loss: 1.636 Test Acc: 0.317
Validation loss decreased (-0.249982 --> -0.316650).  Saving model ...
Epoch: 5 cost time: 3.062633991241455
Epoch: 5, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.564 Vali Acc: 0.328 Test Loss: 1.564 Test Acc: 0.328
Validation loss decreased (-0.316650 --> -0.327762).  Saving model ...
Epoch: 6 cost time: 2.890014410018921
Epoch: 6, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.462 Vali Acc: 0.350 Test Loss: 1.462 Test Acc: 0.350
Validation loss decreased (-0.327762 --> -0.349985).  Saving model ...
Epoch: 7 cost time: 2.9186267852783203
Epoch: 7, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.340 Vali Acc: 0.433 Test Loss: 1.340 Test Acc: 0.433
Validation loss decreased (-0.349985 --> -0.433320).  Saving model ...
Epoch: 8 cost time: 3.1054775714874268
Epoch: 8, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.173 Vali Acc: 0.517 Test Loss: 1.173 Test Acc: 0.517
Validation loss decreased (-0.433320 --> -0.516655).  Saving model ...
Epoch: 9 cost time: 3.294234037399292
Epoch: 9, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.008 Vali Acc: 0.589 Test Loss: 1.008 Test Acc: 0.589
Validation loss decreased (-0.516655 --> -0.588879).  Saving model ...
Epoch: 10 cost time: 3.0604143142700195
Epoch: 10, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.894 Vali Acc: 0.572 Test Loss: 0.894 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.951301336288452
Epoch: 11, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.782 Vali Acc: 0.656 Test Loss: 0.782 Test Acc: 0.656
Validation loss decreased (-0.588879 --> -0.655548).  Saving model ...
Epoch: 12 cost time: 3.460846424102783
Epoch: 12, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.730 Vali Acc: 0.672 Test Loss: 0.730 Test Acc: 0.672
Validation loss decreased (-0.655548 --> -0.672215).  Saving model ...
Epoch: 13 cost time: 3.4387805461883545
Epoch: 13, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.698 Vali Acc: 0.656 Test Loss: 0.698 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.313114643096924
Epoch: 14, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.585 Vali Acc: 0.700 Test Loss: 0.585 Test Acc: 0.700
Validation loss decreased (-0.672215 --> -0.699994).  Saving model ...
Epoch: 15 cost time: 3.503763437271118
Epoch: 15, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.540 Vali Acc: 0.706 Test Loss: 0.540 Test Acc: 0.706
Validation loss decreased (-0.699994 --> -0.705550).  Saving model ...
Epoch: 16 cost time: 3.339099645614624
Epoch: 16, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.513 Vali Acc: 0.739 Test Loss: 0.513 Test Acc: 0.739
Validation loss decreased (-0.705550 --> -0.738884).  Saving model ...
Epoch: 17 cost time: 3.4282164573669434
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.462 Vali Acc: 0.750 Test Loss: 0.462 Test Acc: 0.750
Validation loss decreased (-0.738884 --> -0.749995).  Saving model ...
Epoch: 18 cost time: 3.0903139114379883
Epoch: 18, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.453 Vali Acc: 0.767 Test Loss: 0.453 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 19 cost time: 3.1410725116729736
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.438 Vali Acc: 0.767 Test Loss: 0.438 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766662).  Saving model ...
Epoch: 20 cost time: 3.0995545387268066
Epoch: 20, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.416 Vali Acc: 0.772 Test Loss: 0.416 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 21 cost time: 2.998690605163574
Epoch: 21, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.397 Vali Acc: 0.789 Test Loss: 0.397 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 22 cost time: 3.412299633026123
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 23 cost time: 3.3996071815490723
Epoch: 23, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.399 Vali Acc: 0.811 Test Loss: 0.399 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 24 cost time: 3.4009618759155273
Epoch: 24, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4497833251953125
Epoch: 25, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.397 Vali Acc: 0.800 Test Loss: 0.397 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.172940969467163
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.402 Vali Acc: 0.789 Test Loss: 0.402 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9814963340759277
Epoch: 27, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.394 Vali Acc: 0.800 Test Loss: 0.394 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9628655910491943
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 3.0233278274536133
Epoch: 29, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 3.2354047298431396
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2680304050445557
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.391 Vali Acc: 0.844 Test Loss: 0.391 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 32 cost time: 3.770164728164673
Epoch: 32, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.7219903469085693
Epoch: 33, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.405578374862671
Epoch: 34, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 35 cost time: 3.386857748031616
Epoch: 35, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 36 cost time: 3.5203158855438232
Epoch: 36, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2711193561553955
Epoch: 37, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3283939361572266
Epoch: 38, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3445851802825928
Epoch: 39, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.397 Vali Acc: 0.856 Test Loss: 0.397 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.3007514476776123
Epoch: 40, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.2451999187469482
Epoch: 41, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.365 Vali Acc: 0.856 Test Loss: 0.365 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.1299116611480713
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.041374444961548
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.689939260482788
Epoch: 44, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 45 cost time: 3.1376566886901855
Epoch: 45, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.408 Vali Acc: 0.878 Test Loss: 0.408 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 46 cost time: 3.1792757511138916
Epoch: 46, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.2611351013183594
Epoch: 47, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 48 cost time: 3.2544054985046387
Epoch: 48, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.411 Vali Acc: 0.894 Test Loss: 0.411 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894440).  Saving model ...
Epoch: 49 cost time: 3.1064391136169434
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.1345393657684326
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 3.265110969543457
Epoch: 51, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.361 Vali Acc: 0.911 Test Loss: 0.361 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 52 cost time: 3.1076500415802
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.1776301860809326
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.3024661540985107
Epoch: 54, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.407 Vali Acc: 0.906 Test Loss: 0.407 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.483046770095825
Epoch: 55, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.244800329208374
Epoch: 56, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.3992111682891846
Epoch: 57, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.227879285812378
Epoch: 58, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.727 Vali Acc: 0.878 Test Loss: 0.727 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.947749614715576
Epoch: 59, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.0185723304748535
Epoch: 60, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.559 Vali Acc: 0.894 Test Loss: 0.559 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.1805455684661865
Epoch: 61, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.348532438278198
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.890 Vali Acc: 0.089 Test Loss: 1.890 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 3.203131675720215
Epoch: 2, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.841 Vali Acc: 0.128 Test Loss: 1.841 Test Acc: 0.128
Validation loss decreased (-0.088870 --> -0.127759).  Saving model ...
Epoch: 3 cost time: 3.0945630073547363
Epoch: 3, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.786 Vali Acc: 0.178 Test Loss: 1.786 Test Acc: 0.178
Validation loss decreased (-0.127759 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 3.143416404724121
Epoch: 4, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.707 Vali Acc: 0.272 Test Loss: 1.707 Test Acc: 0.272
Validation loss decreased (-0.177760 --> -0.272205).  Saving model ...
Epoch: 5 cost time: 3.173506259918213
Epoch: 5, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.603 Vali Acc: 0.350 Test Loss: 1.603 Test Acc: 0.350
Validation loss decreased (-0.272205 --> -0.349984).  Saving model ...
Epoch: 6 cost time: 3.2543091773986816
Epoch: 6, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.441 Vali Acc: 0.428 Test Loss: 1.441 Test Acc: 0.428
Validation loss decreased (-0.349984 --> -0.427763).  Saving model ...
Epoch: 7 cost time: 3.037600040435791
Epoch: 7, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.228 Vali Acc: 0.550 Test Loss: 1.228 Test Acc: 0.550
Validation loss decreased (-0.427763 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 3.0567331314086914
Epoch: 8, Steps: 12 | Train Loss: 1.255 Vali Loss: 0.999 Vali Acc: 0.611 Test Loss: 0.999 Test Acc: 0.611
Validation loss decreased (-0.549988 --> -0.611101).  Saving model ...
Epoch: 9 cost time: 3.221397876739502
Epoch: 9, Steps: 12 | Train Loss: 1.008 Vali Loss: 0.852 Vali Acc: 0.639 Test Loss: 0.852 Test Acc: 0.639
Validation loss decreased (-0.611101 --> -0.638880).  Saving model ...
Epoch: 10 cost time: 3.3864526748657227
Epoch: 10, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.777 Vali Acc: 0.594 Test Loss: 0.777 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4245383739471436
Epoch: 11, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.701 Vali Acc: 0.678 Test Loss: 0.701 Test Acc: 0.678
Validation loss decreased (-0.638880 --> -0.677771).  Saving model ...
Epoch: 12 cost time: 3.5796477794647217
Epoch: 12, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (-0.677771 --> -0.722216).  Saving model ...
Epoch: 13 cost time: 3.4724209308624268
Epoch: 13, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722217).  Saving model ...
Epoch: 14 cost time: 3.096139430999756
Epoch: 14, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.496 Vali Acc: 0.750 Test Loss: 0.496 Test Acc: 0.750
Validation loss decreased (-0.722217 --> -0.749995).  Saving model ...
Epoch: 15 cost time: 3.151409149169922
Epoch: 15, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.441 Vali Acc: 0.756 Test Loss: 0.441 Test Acc: 0.756
Validation loss decreased (-0.749995 --> -0.755551).  Saving model ...
Epoch: 16 cost time: 3.088109016418457
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.433 Vali Acc: 0.772 Test Loss: 0.433 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 2.9897992610931396
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.386 Vali Acc: 0.783 Test Loss: 0.386 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 18 cost time: 3.3457062244415283
Epoch: 18, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 3.2169189453125
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.354 Vali Acc: 0.800 Test Loss: 0.354 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4409468173980713
Epoch: 20, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.347 Vali Acc: 0.783 Test Loss: 0.347 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.408626079559326
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.346 Vali Acc: 0.789 Test Loss: 0.346 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1493332386016846
Epoch: 22, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.329 Vali Acc: 0.811 Test Loss: 0.329 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0369694232940674
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.344 Vali Acc: 0.794 Test Loss: 0.344 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.954596519470215
Epoch: 24, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.366 Vali Acc: 0.800 Test Loss: 0.366 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.107374429702759
Epoch: 25, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 26 cost time: 2.967053174972534
Epoch: 26, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.401 Vali Acc: 0.806 Test Loss: 0.401 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.784973621368408
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.437706708908081
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.328026294708252
Epoch: 29, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.02669620513916
Epoch: 30, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.1634886264801025
Epoch: 31, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.4154438972473145
Epoch: 32, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.402 Vali Acc: 0.794 Test Loss: 0.402 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.8440959453582764
Epoch: 33, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3218162059783936
Epoch: 34, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.441549777984619
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 3.4317359924316406
Epoch: 36, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 37 cost time: 3.569239854812622
Epoch: 37, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.6052403450012207
Epoch: 38, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.0159494876861572
Epoch: 39, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.359 Vali Acc: 0.872 Test Loss: 0.359 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 40 cost time: 2.87489914894104
Epoch: 40, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 3.0031790733337402
Epoch: 41, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.0068113803863525
Epoch: 42, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.1644577980041504
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.5669403076171875
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.31350040435791
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.370 Vali Acc: 0.878 Test Loss: 0.370 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.518820285797119
Epoch: 46, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.0389604568481445
Epoch: 47, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.426 Vali Acc: 0.894 Test Loss: 0.426 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894440).  Saving model ...
Epoch: 48 cost time: 3.1151580810546875
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.437 Vali Acc: 0.894 Test Loss: 0.437 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.3125827312469482
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2461671829223633
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
Validation loss decreased (-0.894440 --> -0.911107).  Saving model ...
Epoch: 51 cost time: 3.524458646774292
Epoch: 51, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.473986864089966
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.5674126148223877
Epoch: 53, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.426619529724121
Epoch: 54, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.394885301589966
Epoch: 55, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.559614658355713
Epoch: 56, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 57 cost time: 3.1313674449920654
Epoch: 57, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.379 Vali Acc: 0.928 Test Loss: 0.379 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927774).  Saving model ...
Epoch: 58 cost time: 3.0499439239501953
Epoch: 58, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.0614006519317627
Epoch: 59, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.506387948989868
Epoch: 60, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.608567714691162
Epoch: 61, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.495311975479126
Epoch: 62, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.4758315086364746
Epoch: 63, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 3.0587000846862793
Epoch: 64, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 3.3080527782440186
Epoch: 65, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 3.0449554920196533
Epoch: 66, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927775).  Saving model ...
Epoch: 67 cost time: 3.1799628734588623
Epoch: 67, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.611147403717041
Epoch: 68, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.364 Vali Acc: 0.939 Test Loss: 0.364 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938885).  Saving model ...
Epoch: 69 cost time: 3.4978315830230713
Epoch: 69, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.933 Test Loss: 0.378 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.5761425495147705
Epoch: 70, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 3.6042544841766357
Epoch: 71, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.455 Vali Acc: 0.922 Test Loss: 0.455 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.468041181564331
Epoch: 72, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 3.3127286434173584
Epoch: 73, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.939 Test Loss: 0.242 Test Acc: 0.939
Validation loss decreased (-0.938885 --> -0.938886).  Saving model ...
Epoch: 74 cost time: 3.406399726867676
Epoch: 74, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 3.6519935131073
Epoch: 75, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 3.4423186779022217
Epoch: 76, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 3.7557222843170166
Epoch: 77, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 3.6400399208068848
Epoch: 78, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.401 Vali Acc: 0.917 Test Loss: 0.401 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 3.303034543991089
Epoch: 79, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.430 Vali Acc: 0.917 Test Loss: 0.430 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 3.2426321506500244
Epoch: 80, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 3.2790586948394775
Epoch: 81, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.922 Test Loss: 0.417 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 2.9458699226379395
Epoch: 82, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 2.94453763961792
Epoch: 83, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.922 Test Loss: 0.393 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.980938911437988
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.837 Vali Acc: 0.172 Test Loss: 1.837 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 3.4321837425231934
Epoch: 2, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.790 Vali Acc: 0.228 Test Loss: 1.790 Test Acc: 0.228
Validation loss decreased (-0.172204 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 3.316805601119995
Epoch: 3, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.724 Vali Acc: 0.306 Test Loss: 1.724 Test Acc: 0.306
Validation loss decreased (-0.227760 --> -0.305538).  Saving model ...
Epoch: 4 cost time: 3.334939479827881
Epoch: 4, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.620 Vali Acc: 0.378 Test Loss: 1.620 Test Acc: 0.378
Validation loss decreased (-0.305538 --> -0.377762).  Saving model ...
Epoch: 5 cost time: 3.3899757862091064
Epoch: 5, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.463 Vali Acc: 0.467 Test Loss: 1.463 Test Acc: 0.467
Validation loss decreased (-0.377762 --> -0.466652).  Saving model ...
Epoch: 6 cost time: 3.3176918029785156
Epoch: 6, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.251 Vali Acc: 0.544 Test Loss: 1.251 Test Acc: 0.544
Validation loss decreased (-0.466652 --> -0.544432).  Saving model ...
Epoch: 7 cost time: 2.959947347640991
Epoch: 7, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.028 Vali Acc: 0.578 Test Loss: 1.028 Test Acc: 0.578
Validation loss decreased (-0.544432 --> -0.577767).  Saving model ...
Epoch: 8 cost time: 3.163313150405884
Epoch: 8, Steps: 12 | Train Loss: 1.239 Vali Loss: 0.858 Vali Acc: 0.589 Test Loss: 0.858 Test Acc: 0.589
Validation loss decreased (-0.577767 --> -0.588880).  Saving model ...
Epoch: 9 cost time: 3.545799493789673
Epoch: 9, Steps: 12 | Train Loss: 0.925 Vali Loss: 0.780 Vali Acc: 0.606 Test Loss: 0.780 Test Acc: 0.606
Validation loss decreased (-0.588880 --> -0.605548).  Saving model ...
Epoch: 10 cost time: 3.3331403732299805
Epoch: 10, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.806 Vali Acc: 0.611 Test Loss: 0.806 Test Acc: 0.611
Validation loss decreased (-0.605548 --> -0.611103).  Saving model ...
Epoch: 11 cost time: 3.4808499813079834
Epoch: 11, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.710 Vali Acc: 0.656 Test Loss: 0.710 Test Acc: 0.656
Validation loss decreased (-0.611103 --> -0.655548).  Saving model ...
Epoch: 12 cost time: 2.9714109897613525
Epoch: 12, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.605 Vali Acc: 0.706 Test Loss: 0.605 Test Acc: 0.706
Validation loss decreased (-0.655548 --> -0.705550).  Saving model ...
Epoch: 13 cost time: 2.9343552589416504
Epoch: 13, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.575 Vali Acc: 0.694 Test Loss: 0.575 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.330944299697876
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.492 Vali Acc: 0.767 Test Loss: 0.492 Test Acc: 0.767
Validation loss decreased (-0.705550 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 3.164660692214966
Epoch: 15, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.428 Vali Acc: 0.778 Test Loss: 0.428 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 3.061134099960327
Epoch: 16, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.459 Vali Acc: 0.783 Test Loss: 0.459 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 17 cost time: 3.600867986679077
Epoch: 17, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.391 Vali Acc: 0.778 Test Loss: 0.391 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4631104469299316
Epoch: 18, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.378 Vali Acc: 0.800 Test Loss: 0.378 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 3.5616471767425537
Epoch: 19, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.351 Vali Acc: 0.811 Test Loss: 0.351 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811108).  Saving model ...
Epoch: 20 cost time: 3.2370035648345947
Epoch: 20, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.335 Vali Acc: 0.800 Test Loss: 0.335 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9250571727752686
Epoch: 21, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.334 Vali Acc: 0.806 Test Loss: 0.334 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9497084617614746
Epoch: 22, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.321 Vali Acc: 0.817 Test Loss: 0.321 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816663).  Saving model ...
Epoch: 23 cost time: 2.976691246032715
Epoch: 23, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.220653533935547
Epoch: 24, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.347 Vali Acc: 0.822 Test Loss: 0.347 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 25 cost time: 3.249833106994629
Epoch: 25, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.325 Vali Acc: 0.806 Test Loss: 0.325 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.476213216781616
Epoch: 26, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 27 cost time: 3.4914562702178955
Epoch: 27, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 28 cost time: 3.494982957839966
Epoch: 28, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 3.306264638900757
Epoch: 29, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 3.1424999237060547
Epoch: 30, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.070889472961426
Epoch: 31, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 32 cost time: 3.114466667175293
Epoch: 32, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.354 Vali Acc: 0.817 Test Loss: 0.354 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4030086994171143
Epoch: 33, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.328 Vali Acc: 0.822 Test Loss: 0.328 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.3570423126220703
Epoch: 34, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.2484567165374756
Epoch: 35, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 36 cost time: 3.2974231243133545
Epoch: 36, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.1394805908203125
Epoch: 37, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 38 cost time: 3.036355972290039
Epoch: 38, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2369120121002197
Epoch: 39, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 40 cost time: 3.0978128910064697
Epoch: 40, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 41 cost time: 3.2479567527770996
Epoch: 41, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.0931284427642822
Epoch: 42, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.193484306335449
Epoch: 43, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 44 cost time: 3.1986091136932373
Epoch: 44, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.117006778717041
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 2.8395516872406006
Epoch: 46, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.9972052574157715
Epoch: 47, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.0357367992401123
Epoch: 48, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 49 cost time: 2.9860548973083496
Epoch: 49, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.924738645553589
Epoch: 50, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 2.849092721939087
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.044679641723633
Epoch: 52, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.2927138805389404
Epoch: 53, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.4046928882598877
Epoch: 54, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.939 Test Loss: 0.234 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938887).  Saving model ...
Epoch: 55 cost time: 3.5380051136016846
Epoch: 55, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.5747106075286865
Epoch: 56, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.0529727935791016
Epoch: 57, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.1300649642944336
Epoch: 58, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.2529990673065186
Epoch: 59, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.163092851638794
Epoch: 60, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.208618402481079
Epoch: 61, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.4858179092407227
Epoch: 62, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.525383472442627
Epoch: 63, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.449852466583252
Epoch: 64, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.65196681022644
Epoch: 1, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.821 Vali Acc: 0.178 Test Loss: 1.821 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 3.1561248302459717
Epoch: 2, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.777 Vali Acc: 0.200 Test Loss: 1.777 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 3.068842887878418
Epoch: 3, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.712 Vali Acc: 0.272 Test Loss: 1.712 Test Acc: 0.272
Validation loss decreased (-0.199982 --> -0.272205).  Saving model ...
Epoch: 4 cost time: 3.449216604232788
Epoch: 4, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.612 Vali Acc: 0.400 Test Loss: 1.612 Test Acc: 0.400
Validation loss decreased (-0.272205 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 3.314521551132202
Epoch: 5, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.470 Vali Acc: 0.472 Test Loss: 1.470 Test Acc: 0.472
Validation loss decreased (-0.399984 --> -0.472208).  Saving model ...
Epoch: 6 cost time: 3.523244619369507
Epoch: 6, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.272 Vali Acc: 0.544 Test Loss: 1.272 Test Acc: 0.544
Validation loss decreased (-0.472208 --> -0.544432).  Saving model ...
Epoch: 7 cost time: 2.9468533992767334
Epoch: 7, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.060 Vali Acc: 0.606 Test Loss: 1.060 Test Acc: 0.606
Validation loss decreased (-0.544432 --> -0.605545).  Saving model ...
Epoch: 8 cost time: 3.057401180267334
Epoch: 8, Steps: 12 | Train Loss: 1.326 Vali Loss: 0.884 Vali Acc: 0.589 Test Loss: 0.884 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8812859058380127
Epoch: 9, Steps: 12 | Train Loss: 1.024 Vali Loss: 0.800 Vali Acc: 0.583 Test Loss: 0.800 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.320312976837158
Epoch: 10, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.801 Vali Acc: 0.589 Test Loss: 0.801 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.517242193222046
Epoch: 11, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.707 Vali Acc: 0.611 Test Loss: 0.707 Test Acc: 0.611
Validation loss decreased (-0.605545 --> -0.611104).  Saving model ...
Epoch: 12 cost time: 3.5979154109954834
Epoch: 12, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.622 Vali Acc: 0.672 Test Loss: 0.622 Test Acc: 0.672
Validation loss decreased (-0.611104 --> -0.672216).  Saving model ...
Epoch: 13 cost time: 3.554202079772949
Epoch: 13, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.595 Vali Acc: 0.667 Test Loss: 0.595 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3273775577545166
Epoch: 14, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.511 Vali Acc: 0.767 Test Loss: 0.511 Test Acc: 0.767
Validation loss decreased (-0.672216 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 3.3998982906341553
Epoch: 15, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.438 Vali Acc: 0.750 Test Loss: 0.438 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1397323608398438
Epoch: 16, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.432 Vali Acc: 0.778 Test Loss: 0.432 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 17 cost time: 3.231940269470215
Epoch: 17, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.384 Vali Acc: 0.767 Test Loss: 0.384 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0907535552978516
Epoch: 18, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.374 Vali Acc: 0.800 Test Loss: 0.374 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 3.7217798233032227
Epoch: 19, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.350 Vali Acc: 0.794 Test Loss: 0.350 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6404757499694824
Epoch: 20, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.341 Vali Acc: 0.800 Test Loss: 0.341 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799997).  Saving model ...
Epoch: 21 cost time: 3.490384817123413
Epoch: 21, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.345 Vali Acc: 0.783 Test Loss: 0.345 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6441619396209717
Epoch: 22, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.326 Vali Acc: 0.794 Test Loss: 0.326 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3347017765045166
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.353 Vali Acc: 0.811 Test Loss: 0.353 Test Acc: 0.811
Validation loss decreased (-0.799997 --> -0.811108).  Saving model ...
Epoch: 24 cost time: 3.238064765930176
Epoch: 24, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.340 Vali Acc: 0.794 Test Loss: 0.340 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0900588035583496
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.335 Vali Acc: 0.806 Test Loss: 0.335 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.074887990951538
Epoch: 26, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.352 Vali Acc: 0.806 Test Loss: 0.352 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.491760730743408
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.332 Vali Acc: 0.817 Test Loss: 0.332 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816663).  Saving model ...
Epoch: 28 cost time: 3.6673500537872314
Epoch: 28, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.358 Vali Acc: 0.817 Test Loss: 0.358 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4058616161346436
Epoch: 29, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.2690207958221436
Epoch: 30, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 31 cost time: 3.0876286029815674
Epoch: 31, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1799087524414062
Epoch: 32, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4151337146759033
Epoch: 33, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 34 cost time: 3.4592204093933105
Epoch: 34, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.49139404296875
Epoch: 35, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.9099109172821045
Epoch: 36, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.381983995437622
Epoch: 37, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.166959762573242
Epoch: 38, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.2000224590301514
Epoch: 39, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 40 cost time: 3.1704530715942383
Epoch: 40, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.112687110900879
Epoch: 41, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.439277410507202
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.5138659477233887
Epoch: 43, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 44 cost time: 3.4106006622314453
Epoch: 44, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 45 cost time: 3.3239548206329346
Epoch: 45, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.390 Vali Acc: 0.883 Test Loss: 0.390 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883329).  Saving model ...
Epoch: 46 cost time: 3.0502195358276367
Epoch: 46, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.137155771255493
Epoch: 47, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 48 cost time: 3.170240640640259
Epoch: 48, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.5468461513519287
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.417501926422119
Epoch: 50, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911108).  Saving model ...
Epoch: 51 cost time: 3.535616159439087
Epoch: 51, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.214416027069092
Epoch: 52, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.469761610031128
Epoch: 53, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.108574390411377
Epoch: 54, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 3.201645612716675
Epoch: 55, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.647765874862671
Epoch: 56, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.467761516571045
Epoch: 57, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927775).  Saving model ...
Epoch: 58 cost time: 3.749617576599121
Epoch: 58, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.4281866550445557
Epoch: 59, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.726402759552002
Epoch: 60, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.2822299003601074
Epoch: 61, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.1713881492614746
Epoch: 62, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.8234403133392334
Epoch: 63, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.465 Vali Acc: 0.911 Test Loss: 0.465 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 3.3949625492095947
Epoch: 64, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 3.4408583641052246
Epoch: 65, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 3.2344565391540527
Epoch: 66, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 67 cost time: 3.9186081886291504
Epoch: 67, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938886).  Saving model ...
Epoch: 68 cost time: 3.5098588466644287
Epoch: 68, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.578794002532959
Epoch: 69, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.928 Test Loss: 0.381 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.570371150970459
Epoch: 70, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.833982467651367
Epoch: 71, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.638162612915039
Epoch: 72, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.867396593093872
Epoch: 73, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.440340280532837
Epoch: 74, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 3.144334554672241
Epoch: 75, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.348 Vali Acc: 0.933 Test Loss: 0.348 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 3.304732084274292
Epoch: 76, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.928 Test Loss: 0.323 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 3.1447019577026367
Epoch: 77, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.458132266998291
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.0541534423828125
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.2282798290252686
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.169219493865967
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.471921920776367
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.56842303276062
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3343677520751953
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 3.138895034790039
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 3.4499008655548096
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 3.265038013458252
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3784971237182617
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.507823944091797
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.591219902038574
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.085435390472412
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 3.17006778717041
Epoch: 15, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 3.0747549533843994
Epoch: 16, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0592286586761475
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.279048442840576
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3318614959716797
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1040444374084473
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 3.119877576828003
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.937962770462036
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9174933433532715
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 3.333167314529419
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 3.3794150352478027
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4826745986938477
Epoch: 26, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 3.3498220443725586
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2649214267730713
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 3.321765899658203
Epoch: 29, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 4.185080289840698
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.470913887023926
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 3.403425931930542
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 3.1787240505218506
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 3.287217378616333
Epoch: 34, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.516209125518799
Epoch: 35, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2366416454315186
Epoch: 36, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.5403738021850586
Epoch: 37, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.488541603088379
Epoch: 38, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.074063777923584
Epoch: 39, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 3.0967369079589844
Epoch: 40, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 2.9455411434173584
Epoch: 41, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4790732860565186
Epoch: 42, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.820906639099121
Epoch: 43, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.592106580734253
Epoch: 44, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 3.6622724533081055
Epoch: 45, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 3.202232837677002
Epoch: 46, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 3.0705394744873047
Epoch: 47, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 3.0802955627441406
Epoch: 48, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.3372392654418945
Epoch: 49, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.6538844108581543
Epoch: 50, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.6198906898498535
Epoch: 51, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.2071521282196045
Epoch: 52, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.237928628921509
Epoch: 53, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.077141761779785
Epoch: 54, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 2.88657283782959
Epoch: 55, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.430898666381836
Epoch: 56, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.473045587539673
Epoch: 57, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 3.2287702560424805
Epoch: 58, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 2.9625203609466553
Epoch: 59, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.458667516708374
Epoch: 60, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.300455331802368
Epoch: 61, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 3.7070910930633545
Epoch: 62, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 3.4439799785614014
Epoch: 63, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 3.431748390197754
Epoch: 64, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.2024996280670166
Epoch: 65, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.2724695205688477
Epoch: 66, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 3.3817429542541504
Epoch: 67, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.5073535442352295
Epoch: 68, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 3.4196903705596924
Epoch: 69, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 3.496727466583252
Epoch: 70, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 3.163022756576538
Epoch: 71, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 3.16208815574646
Epoch: 72, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 3.0245521068573
Epoch: 73, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 3.4994797706604004
Epoch: 74, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 3.184866428375244
Epoch: 75, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 3.3660452365875244
Epoch: 76, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.923380136489868
Epoch: 77, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.161726474761963
Epoch: 78, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.074282169342041
Epoch: 79, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.96701717376709
Epoch: 80, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 3.280200481414795
Epoch: 81, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 3.2660348415374756
Epoch: 82, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 3.28009033203125
Epoch: 83, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 3.528618335723877
Epoch: 84, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 3.5566272735595703
Epoch: 85, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 241350
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.706439733505249
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.739 Vali Acc: 0.311 Test Loss: 1.739 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 3.4333693981170654
Epoch: 2, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.605 Vali Acc: 0.411 Test Loss: 1.605 Test Acc: 0.411
Validation loss decreased (-0.311094 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 3.600398540496826
Epoch: 3, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.465 Vali Acc: 0.494 Test Loss: 1.465 Test Acc: 0.494
Validation loss decreased (-0.411095 --> -0.494430).  Saving model ...
Epoch: 4 cost time: 3.511686086654663
Epoch: 4, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.330 Vali Acc: 0.528 Test Loss: 1.330 Test Acc: 0.528
Validation loss decreased (-0.494430 --> -0.527764).  Saving model ...
Epoch: 5 cost time: 3.611591339111328
Epoch: 5, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.220 Vali Acc: 0.528 Test Loss: 1.220 Test Acc: 0.528
Validation loss decreased (-0.527764 --> -0.527766).  Saving model ...
Epoch: 6 cost time: 2.9260659217834473
Epoch: 6, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.527766 --> -0.572211).  Saving model ...
Epoch: 7 cost time: 2.999297857284546
Epoch: 7, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.572211 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 3.435487985610962
Epoch: 8, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.933 Vali Acc: 0.617 Test Loss: 0.933 Test Acc: 0.617
Validation loss decreased (-0.599990 --> -0.616657).  Saving model ...
Epoch: 9 cost time: 3.4484596252441406
Epoch: 9, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.820 Vali Acc: 0.672 Test Loss: 0.820 Test Acc: 0.672
Validation loss decreased (-0.616657 --> -0.672214).  Saving model ...
Epoch: 10 cost time: 2.922508478164673
Epoch: 10, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.739 Vali Acc: 0.672 Test Loss: 0.739 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672215).  Saving model ...
Epoch: 11 cost time: 2.846764326095581
Epoch: 11, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
Validation loss decreased (-0.672215 --> -0.722216).  Saving model ...
Epoch: 12 cost time: 3.1562843322753906
Epoch: 12, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.574 Vali Acc: 0.767 Test Loss: 0.574 Test Acc: 0.767
Validation loss decreased (-0.722216 --> -0.766661).  Saving model ...
Epoch: 13 cost time: 3.548496723175049
Epoch: 13, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.518 Vali Acc: 0.722 Test Loss: 0.518 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.510852098464966
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 3.2652900218963623
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.442 Vali Acc: 0.811 Test Loss: 0.442 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 2.9715585708618164
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.419 Vali Acc: 0.811 Test Loss: 0.419 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 3.3000571727752686
Epoch: 17, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.768580675125122
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 3.5369017124176025
Epoch: 19, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 3.401968479156494
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1307754516601562
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 2.9822535514831543
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 3.2156753540039062
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 3.4505221843719482
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4404590129852295
Epoch: 25, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 3.3886594772338867
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.20855975151062
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 28 cost time: 3.1471540927886963
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.255331516265869
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.3051528930664062
Epoch: 30, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 3.2973549365997314
Epoch: 31, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.390073776245117
Epoch: 32, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 3.280993700027466
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.436814069747925
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.5546317100524902
Epoch: 35, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3109755516052246
Epoch: 36, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 3.4111340045928955
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.3795888423919678
Epoch: 38, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 39 cost time: 3.5346615314483643
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 40 cost time: 3.261894702911377
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.3461239337921143
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1790735721588135
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 43 cost time: 3.1704394817352295
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.4309585094451904
Epoch: 44, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.5483367443084717
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.5870816707611084
Epoch: 46, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.5097849369049072
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.367879867553711
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.0217044353485107
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 50 cost time: 3.67897367477417
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.6617984771728516
Epoch: 51, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.5618159770965576
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.455216407775879
Epoch: 53, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.3245160579681396
Epoch: 54, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.555964231491089
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 56 cost time: 3.554730176925659
Epoch: 56, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.7345519065856934
Epoch: 57, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.4979915618896484
Epoch: 58, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.189382314682007
Epoch: 59, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.1414999961853027
Epoch: 60, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.4921257495880127
Epoch: 61, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.3986730575561523
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.1784656047821045
Epoch: 63, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.5407204627990723
Epoch: 64, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.4195427894592285
Epoch: 65, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.511372089385986
Epoch: 1, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.780 Vali Acc: 0.256 Test Loss: 1.780 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 2.96970796585083
Epoch: 2, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.679 Vali Acc: 0.322 Test Loss: 1.679 Test Acc: 0.322
Validation loss decreased (-0.255538 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 3.307734489440918
Epoch: 3, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.568 Vali Acc: 0.350 Test Loss: 1.568 Test Acc: 0.350
Validation loss decreased (-0.322205 --> -0.349984).  Saving model ...
Epoch: 4 cost time: 3.4273757934570312
Epoch: 4, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.451 Vali Acc: 0.439 Test Loss: 1.451 Test Acc: 0.439
Validation loss decreased (-0.349984 --> -0.438874).  Saving model ...
Epoch: 5 cost time: 3.2791171073913574
Epoch: 5, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.346 Vali Acc: 0.450 Test Loss: 1.346 Test Acc: 0.450
Validation loss decreased (-0.438874 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 2.9804751873016357
Epoch: 6, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.237 Vali Acc: 0.533 Test Loss: 1.237 Test Acc: 0.533
Validation loss decreased (-0.449987 --> -0.533321).  Saving model ...
Epoch: 7 cost time: 3.062356472015381
Epoch: 7, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.134 Vali Acc: 0.561 Test Loss: 1.134 Test Acc: 0.561
Validation loss decreased (-0.533321 --> -0.561100).  Saving model ...
Epoch: 8 cost time: 3.03438663482666
Epoch: 8, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.033 Vali Acc: 0.594 Test Loss: 1.033 Test Acc: 0.594
Validation loss decreased (-0.561100 --> -0.594434).  Saving model ...
Epoch: 9 cost time: 3.417527437210083
Epoch: 9, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.914 Vali Acc: 0.639 Test Loss: 0.914 Test Acc: 0.639
Validation loss decreased (-0.594434 --> -0.638880).  Saving model ...
Epoch: 10 cost time: 3.234799385070801
Epoch: 10, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.820 Vali Acc: 0.650 Test Loss: 0.820 Test Acc: 0.650
Validation loss decreased (-0.638880 --> -0.649992).  Saving model ...
Epoch: 11 cost time: 3.3913145065307617
Epoch: 11, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.727 Vali Acc: 0.683 Test Loss: 0.727 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683326).  Saving model ...
Epoch: 12 cost time: 2.993518829345703
Epoch: 12, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.648 Vali Acc: 0.700 Test Loss: 0.648 Test Acc: 0.700
Validation loss decreased (-0.683326 --> -0.699994).  Saving model ...
Epoch: 13 cost time: 3.0339932441711426
Epoch: 13, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.699994 --> -0.716661).  Saving model ...
Epoch: 14 cost time: 2.9545536041259766
Epoch: 14, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.530 Vali Acc: 0.772 Test Loss: 0.530 Test Acc: 0.772
Validation loss decreased (-0.716661 --> -0.772217).  Saving model ...
Epoch: 15 cost time: 2.6988677978515625
Epoch: 15, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.493 Vali Acc: 0.778 Test Loss: 0.493 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 2.8417932987213135
Epoch: 16, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.452 Vali Acc: 0.789 Test Loss: 0.452 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 17 cost time: 2.9944655895233154
Epoch: 17, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.425 Vali Acc: 0.794 Test Loss: 0.425 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 18 cost time: 3.0163135528564453
Epoch: 18, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.398 Vali Acc: 0.794 Test Loss: 0.398 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 19 cost time: 3.1989073753356934
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 20 cost time: 3.3831627368927
Epoch: 20, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
Validation loss decreased (-0.805552 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 3.070047378540039
Epoch: 21, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9510743618011475
Epoch: 22, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.471062421798706
Epoch: 23, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3094890117645264
Epoch: 24, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.5274317264556885
Epoch: 25, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.344 Vali Acc: 0.828 Test Loss: 0.344 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.155453681945801
Epoch: 26, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1142866611480713
Epoch: 27, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3526647090911865
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 29 cost time: 3.27506685256958
Epoch: 29, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 3.4522202014923096
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.8678293228149414
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.0184757709503174
Epoch: 32, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3143868446350098
Epoch: 33, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 34 cost time: 3.376096487045288
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.0539188385009766
Epoch: 35, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 36 cost time: 3.0305562019348145
Epoch: 36, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 37 cost time: 3.1899733543395996
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.558049201965332
Epoch: 38, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.331 Vali Acc: 0.867 Test Loss: 0.331 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 39 cost time: 3.6184403896331787
Epoch: 39, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 40 cost time: 3.2079811096191406
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.0117743015289307
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.337 Vali Acc: 0.878 Test Loss: 0.337 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.381385326385498
Epoch: 42, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 3.4545836448669434
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.332315683364868
Epoch: 44, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.9284446239471436
Epoch: 45, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.0269877910614014
Epoch: 46, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.295228958129883
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.494659900665283
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.6267025470733643
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.068577527999878
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.9724605083465576
Epoch: 51, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 52 cost time: 2.8645105361938477
Epoch: 52, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.24153995513916
Epoch: 53, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.053849220275879
Epoch: 54, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.7377281188964844
Epoch: 55, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.027280807495117
Epoch: 56, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.238910436630249
Epoch: 57, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.035599708557129
Epoch: 58, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 59 cost time: 3.2147088050842285
Epoch: 59, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.8221163749694824
Epoch: 60, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.0386481285095215
Epoch: 61, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.2192165851593018
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.41007399559021
Epoch: 63, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.3821041584014893
Epoch: 64, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.1401240825653076
Epoch: 65, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.2119252681732178
Epoch: 66, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916663).  Saving model ...
Epoch: 67 cost time: 3.526312828063965
Epoch: 67, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.120161771774292
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.2642524242401123
Epoch: 69, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.911 Test Loss: 0.361 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.973414182662964
Epoch: 70, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.7378530502319336
Epoch: 71, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.8903653621673584
Epoch: 72, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 3.309199094772339
Epoch: 73, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.2789015769958496
Epoch: 74, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 2.860583543777466
Epoch: 75, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.911 Test Loss: 0.370 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 2.8578498363494873
Epoch: 76, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.86165452003479
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.775 Vali Acc: 0.189 Test Loss: 1.775 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.253659725189209
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.700 Vali Acc: 0.294 Test Loss: 1.700 Test Acc: 0.294
Validation loss decreased (-0.188871 --> -0.294427).  Saving model ...
Epoch: 3 cost time: 3.502382516860962
Epoch: 3, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.616 Vali Acc: 0.339 Test Loss: 1.616 Test Acc: 0.339
Validation loss decreased (-0.294427 --> -0.338873).  Saving model ...
Epoch: 4 cost time: 3.6027019023895264
Epoch: 4, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.526 Vali Acc: 0.367 Test Loss: 1.526 Test Acc: 0.367
Validation loss decreased (-0.338873 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 3.422379970550537
Epoch: 5, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.440 Vali Acc: 0.378 Test Loss: 1.440 Test Acc: 0.378
Validation loss decreased (-0.366651 --> -0.377763).  Saving model ...
Epoch: 6 cost time: 3.4422876834869385
Epoch: 6, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.343 Vali Acc: 0.417 Test Loss: 1.343 Test Acc: 0.417
Validation loss decreased (-0.377763 --> -0.416653).  Saving model ...
Epoch: 7 cost time: 3.385544538497925
Epoch: 7, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.241 Vali Acc: 0.433 Test Loss: 1.241 Test Acc: 0.433
Validation loss decreased (-0.416653 --> -0.433321).  Saving model ...
Epoch: 8 cost time: 3.3898322582244873
Epoch: 8, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.138 Vali Acc: 0.478 Test Loss: 1.138 Test Acc: 0.478
Validation loss decreased (-0.433321 --> -0.477766).  Saving model ...
Epoch: 9 cost time: 3.6305108070373535
Epoch: 9, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.001 Vali Acc: 0.594 Test Loss: 1.001 Test Acc: 0.594
Validation loss decreased (-0.477766 --> -0.594434).  Saving model ...
Epoch: 10 cost time: 3.4324707984924316
Epoch: 10, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.900 Vali Acc: 0.628 Test Loss: 0.900 Test Acc: 0.628
Validation loss decreased (-0.594434 --> -0.627769).  Saving model ...
Epoch: 11 cost time: 3.386324882507324
Epoch: 11, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.800 Vali Acc: 0.639 Test Loss: 0.800 Test Acc: 0.639
Validation loss decreased (-0.627769 --> -0.638881).  Saving model ...
Epoch: 12 cost time: 3.3262393474578857
Epoch: 12, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.736 Vali Acc: 0.661 Test Loss: 0.736 Test Acc: 0.661
Validation loss decreased (-0.638881 --> -0.661104).  Saving model ...
Epoch: 13 cost time: 2.9818649291992188
Epoch: 13, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.653 Vali Acc: 0.706 Test Loss: 0.653 Test Acc: 0.706
Validation loss decreased (-0.661104 --> -0.705549).  Saving model ...
Epoch: 14 cost time: 3.5903165340423584
Epoch: 14, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.597 Vali Acc: 0.733 Test Loss: 0.597 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733327).  Saving model ...
Epoch: 15 cost time: 3.5381076335906982
Epoch: 15, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.552 Vali Acc: 0.733 Test Loss: 0.552 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733328).  Saving model ...
Epoch: 16 cost time: 3.1400015354156494
Epoch: 16, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.500 Vali Acc: 0.739 Test Loss: 0.500 Test Acc: 0.739
Validation loss decreased (-0.733328 --> -0.738884).  Saving model ...
Epoch: 17 cost time: 3.152998685836792
Epoch: 17, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.473 Vali Acc: 0.744 Test Loss: 0.473 Test Acc: 0.744
Validation loss decreased (-0.738884 --> -0.744440).  Saving model ...
Epoch: 18 cost time: 3.192202568054199
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.426 Vali Acc: 0.750 Test Loss: 0.426 Test Acc: 0.750
Validation loss decreased (-0.744440 --> -0.749996).  Saving model ...
Epoch: 19 cost time: 3.284437417984009
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
Validation loss decreased (-0.749996 --> -0.794440).  Saving model ...
Epoch: 20 cost time: 3.159560441970825
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.423 Vali Acc: 0.783 Test Loss: 0.423 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5629124641418457
Epoch: 21, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.390 Vali Acc: 0.783 Test Loss: 0.390 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1312942504882812
Epoch: 22, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 23 cost time: 3.025712728500366
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7317612171173096
Epoch: 24, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.391 Vali Acc: 0.806 Test Loss: 0.391 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.852558135986328
Epoch: 25, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8836681842803955
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.2316811084747314
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.0864055156707764
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.384 Vali Acc: 0.811 Test Loss: 0.384 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.3874776363372803
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.2412619590759277
Epoch: 30, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.377 Vali Acc: 0.811 Test Loss: 0.377 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.3926079273223877
Epoch: 31, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.380 Vali Acc: 0.817 Test Loss: 0.380 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.4327495098114014
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 33 cost time: 3.47343373298645
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.344 Vali Acc: 0.856 Test Loss: 0.344 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 34 cost time: 3.3241543769836426
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 35 cost time: 3.375736713409424
Epoch: 35, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.246901035308838
Epoch: 36, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.1124918460845947
Epoch: 37, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.0426483154296875
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.428 Vali Acc: 0.856 Test Loss: 0.428 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.2067184448242188
Epoch: 39, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.981118679046631
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.360 Vali Acc: 0.894 Test Loss: 0.360 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894441).  Saving model ...
Epoch: 41 cost time: 2.899585723876953
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.1864569187164307
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.58447265625
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.663390636444092
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.222956418991089
Epoch: 45, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.3217227458953857
Epoch: 46, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.504228353500366
Epoch: 47, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 48 cost time: 3.2918028831481934
Epoch: 48, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.363933563232422
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.090808391571045
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911107).  Saving model ...
Epoch: 51 cost time: 3.2742867469787598
Epoch: 51, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.4769363403320312
Epoch: 52, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.350 Vali Acc: 0.878 Test Loss: 0.350 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.3303816318511963
Epoch: 53, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.389 Vali Acc: 0.856 Test Loss: 0.389 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.169069528579712
Epoch: 54, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.461 Vali Acc: 0.906 Test Loss: 0.461 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.3019449710845947
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.382723569869995
Epoch: 56, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.408 Vali Acc: 0.911 Test Loss: 0.408 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.413452625274658
Epoch: 57, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.5014700889587402
Epoch: 58, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 59 cost time: 3.229989767074585
Epoch: 59, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.362 Vali Acc: 0.894 Test Loss: 0.362 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.3523309230804443
Epoch: 60, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.5110549926757812
Epoch: 61, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.389 Vali Acc: 0.894 Test Loss: 0.389 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.1306703090667725
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.3501014709472656
Epoch: 63, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.0209851264953613
Epoch: 64, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.105696201324463
Epoch: 65, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.2241570949554443
Epoch: 66, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.148291826248169
Epoch: 67, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.372 Vali Acc: 0.906 Test Loss: 0.372 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.0901544094085693
Epoch: 68, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.395 Vali Acc: 0.917 Test Loss: 0.395 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.035034418106079
Epoch: 1, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.822 Vali Acc: 0.161 Test Loss: 1.822 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 3.4235095977783203
Epoch: 2, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.758 Vali Acc: 0.200 Test Loss: 1.758 Test Acc: 0.200
Validation loss decreased (-0.161093 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 3.3921375274658203
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.689 Vali Acc: 0.294 Test Loss: 1.689 Test Acc: 0.294
Validation loss decreased (-0.199982 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 3.412607431411743
Epoch: 4, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.613 Vali Acc: 0.344 Test Loss: 1.613 Test Acc: 0.344
Validation loss decreased (-0.294428 --> -0.344428).  Saving model ...
Epoch: 5 cost time: 3.308865785598755
Epoch: 5, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.541 Vali Acc: 0.322 Test Loss: 1.541 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1270363330841064
Epoch: 6, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.435 Vali Acc: 0.411 Test Loss: 1.435 Test Acc: 0.411
Validation loss decreased (-0.344428 --> -0.411097).  Saving model ...
Epoch: 7 cost time: 3.3024113178253174
Epoch: 7, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.302 Vali Acc: 0.511 Test Loss: 1.302 Test Acc: 0.511
Validation loss decreased (-0.411097 --> -0.511098).  Saving model ...
Epoch: 8 cost time: 3.1534526348114014
Epoch: 8, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.151 Vali Acc: 0.539 Test Loss: 1.151 Test Acc: 0.539
Validation loss decreased (-0.511098 --> -0.538877).  Saving model ...
Epoch: 9 cost time: 3.030571937561035
Epoch: 9, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
Validation loss decreased (-0.538877 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 2.9851231575012207
Epoch: 10, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.849 Vali Acc: 0.572 Test Loss: 0.849 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8948991298675537
Epoch: 11, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.748 Vali Acc: 0.633 Test Loss: 0.748 Test Acc: 0.633
Validation loss decreased (-0.599990 --> -0.633326).  Saving model ...
Epoch: 12 cost time: 3.326582431793213
Epoch: 12, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.710 Vali Acc: 0.628 Test Loss: 0.710 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2557613849639893
Epoch: 13, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.654 Vali Acc: 0.667 Test Loss: 0.654 Test Acc: 0.667
Validation loss decreased (-0.633326 --> -0.666660).  Saving model ...
Epoch: 14 cost time: 3.4526562690734863
Epoch: 14, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.592 Vali Acc: 0.689 Test Loss: 0.592 Test Acc: 0.689
Validation loss decreased (-0.666660 --> -0.688883).  Saving model ...
Epoch: 15 cost time: 3.5164284706115723
Epoch: 15, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.511 Vali Acc: 0.728 Test Loss: 0.511 Test Acc: 0.728
Validation loss decreased (-0.688883 --> -0.727773).  Saving model ...
Epoch: 16 cost time: 3.3562943935394287
Epoch: 16, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.468 Vali Acc: 0.717 Test Loss: 0.468 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.19158935546875
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.437 Vali Acc: 0.750 Test Loss: 0.437 Test Acc: 0.750
Validation loss decreased (-0.727773 --> -0.749996).  Saving model ...
Epoch: 18 cost time: 3.367628812789917
Epoch: 18, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.412 Vali Acc: 0.756 Test Loss: 0.412 Test Acc: 0.756
Validation loss decreased (-0.749996 --> -0.755551).  Saving model ...
Epoch: 19 cost time: 3.3584444522857666
Epoch: 19, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.412 Vali Acc: 0.772 Test Loss: 0.412 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
Epoch: 20 cost time: 2.989272117614746
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.434 Vali Acc: 0.767 Test Loss: 0.434 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.200639009475708
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.401 Vali Acc: 0.789 Test Loss: 0.401 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 22 cost time: 2.987663507461548
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 23 cost time: 2.99446439743042
Epoch: 23, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 24 cost time: 2.9711132049560547
Epoch: 24, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 2.967149496078491
Epoch: 25, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0330049991607666
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.384 Vali Acc: 0.806 Test Loss: 0.384 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3191306591033936
Epoch: 27, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.384 Vali Acc: 0.800 Test Loss: 0.384 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9510958194732666
Epoch: 28, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.381 Vali Acc: 0.817 Test Loss: 0.381 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 29 cost time: 3.3431556224823
Epoch: 29, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.477299213409424
Epoch: 30, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 31 cost time: 3.5050623416900635
Epoch: 31, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2878341674804688
Epoch: 32, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4552900791168213
Epoch: 33, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 34 cost time: 3.2117795944213867
Epoch: 34, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 35 cost time: 3.187262535095215
Epoch: 35, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 36 cost time: 3.2528135776519775
Epoch: 36, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.355195999145508
Epoch: 37, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.5389628410339355
Epoch: 38, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.402 Vali Acc: 0.839 Test Loss: 0.402 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.086554527282715
Epoch: 39, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 40 cost time: 2.796623706817627
Epoch: 40, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 41 cost time: 2.9329097270965576
Epoch: 41, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.430 Vali Acc: 0.872 Test Loss: 0.430 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.8484792709350586
Epoch: 42, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.175870418548584
Epoch: 43, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.457343578338623
Epoch: 44, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 3.338761568069458
Epoch: 45, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2268176078796387
Epoch: 46, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.4977402687072754
Epoch: 47, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 3.0824930667877197
Epoch: 48, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 49 cost time: 3.050506353378296
Epoch: 49, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3793845176696777
Epoch: 50, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.1626617908477783
Epoch: 51, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.4420080184936523
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.0327248573303223
Epoch: 53, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.0970895290374756
Epoch: 54, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.0521321296691895
Epoch: 55, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 56 cost time: 3.070009469985962
Epoch: 56, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.2582919597625732
Epoch: 57, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.1238245964050293
Epoch: 58, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.167034864425659
Epoch: 59, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.6235239505767822
Epoch: 60, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.63033390045166
Epoch: 61, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.465 Vali Acc: 0.894 Test Loss: 0.465 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.0263094902038574
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.447 Vali Acc: 0.911 Test Loss: 0.447 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.1731441020965576
Epoch: 63, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.894 Test Loss: 0.475 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 2.8354575634002686
Epoch: 64, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.032660722732544
Epoch: 65, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.928 Test Loss: 0.335 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 66 cost time: 2.965555429458618
Epoch: 66, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.911 Test Loss: 0.413 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.675752639770508
Epoch: 67, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.2217905521392822
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.911 Test Loss: 0.474 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.1953718662261963
Epoch: 69, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.917 Test Loss: 0.491 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.3353476524353027
Epoch: 70, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.911 Test Loss: 0.485 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 3.4035227298736572
Epoch: 71, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.906 Test Loss: 0.507 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 3.3492448329925537
Epoch: 72, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 3.2509067058563232
Epoch: 73, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 3.424867868423462
Epoch: 74, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.480 Vali Acc: 0.911 Test Loss: 0.480 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 3.496842622756958
Epoch: 75, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.906 Test Loss: 0.478 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4289960861206055
Epoch: 1, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.915 Vali Acc: 0.117 Test Loss: 1.915 Test Acc: 0.117
Validation loss decreased (inf --> -0.116648).  Saving model ...
Epoch: 2 cost time: 3.307872772216797
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.874 Vali Acc: 0.133 Test Loss: 1.874 Test Acc: 0.133
Validation loss decreased (-0.116648 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 3.283690929412842
Epoch: 3, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.815 Vali Acc: 0.194 Test Loss: 1.815 Test Acc: 0.194
Validation loss decreased (-0.133315 --> -0.194426).  Saving model ...
Epoch: 4 cost time: 2.9990346431732178
Epoch: 4, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.733 Vali Acc: 0.300 Test Loss: 1.733 Test Acc: 0.300
Validation loss decreased (-0.194426 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 3.036710023880005
Epoch: 5, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.623 Vali Acc: 0.361 Test Loss: 1.623 Test Acc: 0.361
Validation loss decreased (-0.299983 --> -0.361095).  Saving model ...
Epoch: 6 cost time: 2.95373797416687
Epoch: 6, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.456 Vali Acc: 0.483 Test Loss: 1.456 Test Acc: 0.483
Validation loss decreased (-0.361095 --> -0.483319).  Saving model ...
Epoch: 7 cost time: 3.405081272125244
Epoch: 7, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.215 Vali Acc: 0.611 Test Loss: 1.215 Test Acc: 0.611
Validation loss decreased (-0.483319 --> -0.611099).  Saving model ...
Epoch: 8 cost time: 3.2954540252685547
Epoch: 8, Steps: 12 | Train Loss: 1.237 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.611099 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 3.3989667892456055
Epoch: 9, Steps: 12 | Train Loss: 0.983 Vali Loss: 0.839 Vali Acc: 0.606 Test Loss: 0.839 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.518908739089966
Epoch: 10, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.823 Vali Acc: 0.583 Test Loss: 0.823 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4449563026428223
Epoch: 11, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.750 Vali Acc: 0.656 Test Loss: 0.750 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.786802053451538
Epoch: 12, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.717 Vali Acc: 0.611 Test Loss: 0.717 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.284883499145508
Epoch: 13, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.654 Vali Acc: 0.661 Test Loss: 0.654 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3911783695220947
Epoch: 14, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.559 Vali Acc: 0.717 Test Loss: 0.559 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.716661).  Saving model ...
Epoch: 15 cost time: 3.172835350036621
Epoch: 15, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.507 Vali Acc: 0.739 Test Loss: 0.507 Test Acc: 0.739
Validation loss decreased (-0.716661 --> -0.738884).  Saving model ...
Epoch: 16 cost time: 3.025301933288574
Epoch: 16, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.435 Vali Acc: 0.772 Test Loss: 0.435 Test Acc: 0.772
Validation loss decreased (-0.738884 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 3.109985828399658
Epoch: 17, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.408 Vali Acc: 0.789 Test Loss: 0.408 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 3.141058921813965
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.374 Vali Acc: 0.794 Test Loss: 0.374 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794441).  Saving model ...
Epoch: 19 cost time: 3.318397283554077
Epoch: 19, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.367 Vali Acc: 0.794 Test Loss: 0.367 Test Acc: 0.794
Validation loss decreased (-0.794441 --> -0.794441).  Saving model ...
Epoch: 20 cost time: 3.088688373565674
Epoch: 20, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
Validation loss decreased (-0.794441 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 3.0791256427764893
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.367 Vali Acc: 0.806 Test Loss: 0.367 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 22 cost time: 2.885747194290161
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 3.2212579250335693
Epoch: 23, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 24 cost time: 3.0891220569610596
Epoch: 24, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3084444999694824
Epoch: 25, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 26 cost time: 3.6150782108306885
Epoch: 26, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.351 Vali Acc: 0.811 Test Loss: 0.351 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3901307582855225
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 28 cost time: 3.765235424041748
Epoch: 28, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9920928478240967
Epoch: 29, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8495724201202393
Epoch: 30, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.353 Vali Acc: 0.806 Test Loss: 0.353 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.925999402999878
Epoch: 31, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.356 Vali Acc: 0.800 Test Loss: 0.356 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.0109617710113525
Epoch: 32, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 3.1961395740509033
Epoch: 33, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.966956615447998
Epoch: 34, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 35 cost time: 3.004344940185547
Epoch: 35, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.437 Vali Acc: 0.828 Test Loss: 0.437 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.0224757194519043
Epoch: 36, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.632371664047241
Epoch: 37, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.403447151184082
Epoch: 38, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.1050784587860107
Epoch: 39, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 40 cost time: 3.0789918899536133
Epoch: 40, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.346 Vali Acc: 0.856 Test Loss: 0.346 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.9523472785949707
Epoch: 41, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.411 Vali Acc: 0.872 Test Loss: 0.411 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 42 cost time: 3.128681182861328
Epoch: 42, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1596226692199707
Epoch: 43, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.0671238899230957
Epoch: 44, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.386098623275757
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.399808406829834
Epoch: 46, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 47 cost time: 3.3182289600372314
Epoch: 47, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 3.150294065475464
Epoch: 48, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.395 Vali Acc: 0.878 Test Loss: 0.395 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.0977540016174316
Epoch: 49, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.614025354385376
Epoch: 50, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.455409049987793
Epoch: 51, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.429 Vali Acc: 0.894 Test Loss: 0.429 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.364211082458496
Epoch: 52, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.5495829582214355
Epoch: 53, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.4982056617736816
Epoch: 54, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.2539310455322266
Epoch: 55, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.487 Vali Acc: 0.872 Test Loss: 0.487 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.4465575218200684
Epoch: 56, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 57 cost time: 3.2822511196136475
Epoch: 57, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.429 Vali Acc: 0.894 Test Loss: 0.429 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.2431371212005615
Epoch: 58, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.1926352977752686
Epoch: 59, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922218).  Saving model ...
Epoch: 60 cost time: 3.325876474380493
Epoch: 60, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.397 Vali Acc: 0.894 Test Loss: 0.397 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.3433992862701416
Epoch: 61, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.450 Vali Acc: 0.894 Test Loss: 0.450 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.0471279621124268
Epoch: 62, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.917 Test Loss: 0.408 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.2533342838287354
Epoch: 63, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.928 Test Loss: 0.303 Test Acc: 0.928
Validation loss decreased (-0.922218 --> -0.927775).  Saving model ...
Epoch: 64 cost time: 3.5602633953094482
Epoch: 64, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.267404794692993
Epoch: 65, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.479034662246704
Epoch: 66, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 3.552335739135742
Epoch: 67, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.3633689880371094
Epoch: 68, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.906 Test Loss: 0.439 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 2.94877552986145
Epoch: 69, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 2.9804461002349854
Epoch: 70, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 2.7723612785339355
Epoch: 71, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.8644611835479736
Epoch: 72, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 3.0166358947753906
Epoch: 73, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.8655078411102295
Epoch: 1, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.806 Vali Acc: 0.189 Test Loss: 1.806 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 2.858164072036743
Epoch: 2, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.753 Vali Acc: 0.222 Test Loss: 1.753 Test Acc: 0.222
Validation loss decreased (-0.188871 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 3.158198118209839
Epoch: 3, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.672 Vali Acc: 0.306 Test Loss: 1.672 Test Acc: 0.306
Validation loss decreased (-0.222205 --> -0.305539).  Saving model ...
Epoch: 4 cost time: 3.106703758239746
Epoch: 4, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.556 Vali Acc: 0.400 Test Loss: 1.556 Test Acc: 0.400
Validation loss decreased (-0.305539 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 3.1763594150543213
Epoch: 5, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.410 Vali Acc: 0.483 Test Loss: 1.410 Test Acc: 0.483
Validation loss decreased (-0.399984 --> -0.483319).  Saving model ...
Epoch: 6 cost time: 3.330366373062134
Epoch: 6, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.238 Vali Acc: 0.528 Test Loss: 1.238 Test Acc: 0.528
Validation loss decreased (-0.483319 --> -0.527765).  Saving model ...
Epoch: 7 cost time: 3.250765085220337
Epoch: 7, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.052 Vali Acc: 0.567 Test Loss: 1.052 Test Acc: 0.567
Validation loss decreased (-0.527765 --> -0.566656).  Saving model ...
Epoch: 8 cost time: 3.101006269454956
Epoch: 8, Steps: 12 | Train Loss: 1.233 Vali Loss: 0.909 Vali Acc: 0.561 Test Loss: 0.909 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0901639461517334
Epoch: 9, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.838 Vali Acc: 0.600 Test Loss: 0.838 Test Acc: 0.600
Validation loss decreased (-0.566656 --> -0.599992).  Saving model ...
Epoch: 10 cost time: 3.084852695465088
Epoch: 10, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.801 Vali Acc: 0.583 Test Loss: 0.801 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.054692506790161
Epoch: 11, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.697 Vali Acc: 0.628 Test Loss: 0.697 Test Acc: 0.628
Validation loss decreased (-0.599992 --> -0.627771).  Saving model ...
Epoch: 12 cost time: 2.9202091693878174
Epoch: 12, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.660 Vali Acc: 0.650 Test Loss: 0.660 Test Acc: 0.650
Validation loss decreased (-0.627771 --> -0.649993).  Saving model ...
Epoch: 13 cost time: 3.099048137664795
Epoch: 13, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.588 Vali Acc: 0.683 Test Loss: 0.588 Test Acc: 0.683
Validation loss decreased (-0.649993 --> -0.683327).  Saving model ...
Epoch: 14 cost time: 2.9794490337371826
Epoch: 14, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.475 Vali Acc: 0.772 Test Loss: 0.475 Test Acc: 0.772
Validation loss decreased (-0.683327 --> -0.772217).  Saving model ...
Epoch: 15 cost time: 3.1212949752807617
Epoch: 15, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.406 Vali Acc: 0.783 Test Loss: 0.406 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 16 cost time: 3.0891189575195312
Epoch: 16, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.397 Vali Acc: 0.794 Test Loss: 0.397 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 2.9302690029144287
Epoch: 17, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.385 Vali Acc: 0.800 Test Loss: 0.385 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 18 cost time: 2.9174845218658447
Epoch: 18, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.354 Vali Acc: 0.806 Test Loss: 0.354 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 19 cost time: 3.1054582595825195
Epoch: 19, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 3.262824535369873
Epoch: 20, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.346 Vali Acc: 0.811 Test Loss: 0.346 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.017817497253418
Epoch: 21, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 22 cost time: 3.1198487281799316
Epoch: 22, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.335 Vali Acc: 0.811 Test Loss: 0.335 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.216359853744507
Epoch: 23, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.342 Vali Acc: 0.794 Test Loss: 0.342 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0403525829315186
Epoch: 24, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.354 Vali Acc: 0.817 Test Loss: 0.354 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.16904616355896
Epoch: 25, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.347 Vali Acc: 0.811 Test Loss: 0.347 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2386510372161865
Epoch: 26, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.353 Vali Acc: 0.806 Test Loss: 0.353 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.01875901222229
Epoch: 27, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.2081964015960693
Epoch: 28, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 29 cost time: 3.204831123352051
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.387 Vali Acc: 0.839 Test Loss: 0.387 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 30 cost time: 3.2806966304779053
Epoch: 30, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 31 cost time: 3.416841745376587
Epoch: 31, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3217411041259766
Epoch: 32, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 3.124222993850708
Epoch: 33, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.98500657081604
Epoch: 34, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 35 cost time: 2.921729564666748
Epoch: 35, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.922804355621338
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.780132293701172
Epoch: 37, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.345 Vali Acc: 0.872 Test Loss: 0.345 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 38 cost time: 2.8455331325531006
Epoch: 38, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.9148447513580322
Epoch: 39, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.876852512359619
Epoch: 40, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 41 cost time: 2.6847786903381348
Epoch: 41, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.9692840576171875
Epoch: 42, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.403 Vali Acc: 0.872 Test Loss: 0.403 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.055940628051758
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.3331406116485596
Epoch: 44, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 3.4341204166412354
Epoch: 45, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.261878728866577
Epoch: 46, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.3881547451019287
Epoch: 47, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 3.327096939086914
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.146743059158325
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.1661648750305176
Epoch: 50, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.135770320892334
Epoch: 51, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.9395065307617188
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.047894239425659
Epoch: 53, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.1058244705200195
Epoch: 54, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.1532821655273438
Epoch: 55, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.188192367553711
Epoch: 56, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.276808023452759
Epoch: 57, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.695089817047119
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.851 Vali Acc: 0.211 Test Loss: 1.851 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 3.27632737159729
Epoch: 2, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.796 Vali Acc: 0.250 Test Loss: 1.796 Test Acc: 0.250
Validation loss decreased (-0.211093 --> -0.249982).  Saving model ...
Epoch: 3 cost time: 3.0745108127593994
Epoch: 3, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.715 Vali Acc: 0.294 Test Loss: 1.715 Test Acc: 0.294
Validation loss decreased (-0.249982 --> -0.294427).  Saving model ...
Epoch: 4 cost time: 2.9977312088012695
Epoch: 4, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.591 Vali Acc: 0.450 Test Loss: 1.591 Test Acc: 0.450
Validation loss decreased (-0.294427 --> -0.449984).  Saving model ...
Epoch: 5 cost time: 3.093160629272461
Epoch: 5, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.422 Vali Acc: 0.506 Test Loss: 1.422 Test Acc: 0.506
Validation loss decreased (-0.449984 --> -0.505541).  Saving model ...
Epoch: 6 cost time: 3.081382989883423
Epoch: 6, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.223 Vali Acc: 0.561 Test Loss: 1.223 Test Acc: 0.561
Validation loss decreased (-0.505541 --> -0.561099).  Saving model ...
Epoch: 7 cost time: 3.2385830879211426
Epoch: 7, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.023 Vali Acc: 0.556 Test Loss: 1.023 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1403064727783203
Epoch: 8, Steps: 12 | Train Loss: 1.260 Vali Loss: 0.880 Vali Acc: 0.572 Test Loss: 0.880 Test Acc: 0.572
Validation loss decreased (-0.561099 --> -0.572213).  Saving model ...
Epoch: 9 cost time: 2.937936782836914
Epoch: 9, Steps: 12 | Train Loss: 1.005 Vali Loss: 0.808 Vali Acc: 0.583 Test Loss: 0.808 Test Acc: 0.583
Validation loss decreased (-0.572213 --> -0.583325).  Saving model ...
Epoch: 10 cost time: 3.3522231578826904
Epoch: 10, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.752 Vali Acc: 0.611 Test Loss: 0.752 Test Acc: 0.611
Validation loss decreased (-0.583325 --> -0.611104).  Saving model ...
Epoch: 11 cost time: 3.3329646587371826
Epoch: 11, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.671 Vali Acc: 0.644 Test Loss: 0.671 Test Acc: 0.644
Validation loss decreased (-0.611104 --> -0.644438).  Saving model ...
Epoch: 12 cost time: 3.2943875789642334
Epoch: 12, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.621 Vali Acc: 0.667 Test Loss: 0.621 Test Acc: 0.667
Validation loss decreased (-0.644438 --> -0.666660).  Saving model ...
Epoch: 13 cost time: 3.4156060218811035
Epoch: 13, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.574 Vali Acc: 0.683 Test Loss: 0.574 Test Acc: 0.683
Validation loss decreased (-0.666660 --> -0.683328).  Saving model ...
Epoch: 14 cost time: 3.161165952682495
Epoch: 14, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.468 Vali Acc: 0.767 Test Loss: 0.468 Test Acc: 0.767
Validation loss decreased (-0.683328 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 3.0345942974090576
Epoch: 15, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.400 Vali Acc: 0.789 Test Loss: 0.400 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 16 cost time: 2.9589035511016846
Epoch: 16, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.390 Vali Acc: 0.806 Test Loss: 0.390 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 17 cost time: 3.0605621337890625
Epoch: 17, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.369 Vali Acc: 0.789 Test Loss: 0.369 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.062345504760742
Epoch: 18, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.339 Vali Acc: 0.789 Test Loss: 0.339 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1079039573669434
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.328 Vali Acc: 0.806 Test Loss: 0.328 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 20 cost time: 3.1442153453826904
Epoch: 20, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 21 cost time: 3.2416558265686035
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.329 Vali Acc: 0.811 Test Loss: 0.329 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.212796449661255
Epoch: 22, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.333 Vali Acc: 0.806 Test Loss: 0.333 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.248483180999756
Epoch: 23, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.334 Vali Acc: 0.794 Test Loss: 0.334 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.173278331756592
Epoch: 24, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.351 Vali Acc: 0.794 Test Loss: 0.351 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.059311866760254
Epoch: 25, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.348 Vali Acc: 0.800 Test Loss: 0.348 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.9367048740386963
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9856808185577393
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 28 cost time: 3.0725581645965576
Epoch: 28, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.056342363357544
Epoch: 29, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.167818307876587
Epoch: 30, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 31 cost time: 2.9087719917297363
Epoch: 31, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.8873367309570312
Epoch: 32, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 3.263429641723633
Epoch: 33, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.420 Vali Acc: 0.828 Test Loss: 0.420 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0137691497802734
Epoch: 34, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 35 cost time: 3.156125783920288
Epoch: 35, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.063601016998291
Epoch: 36, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.462 Vali Acc: 0.839 Test Loss: 0.462 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0998928546905518
Epoch: 37, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855551).  Saving model ...
Epoch: 38 cost time: 2.9534878730773926
Epoch: 38, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.800257921218872
Epoch: 39, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.8014018535614014
Epoch: 40, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 41 cost time: 3.0761513710021973
Epoch: 41, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.993729829788208
Epoch: 42, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.2211458683013916
Epoch: 43, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.537 Vali Acc: 0.839 Test Loss: 0.537 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.1115171909332275
Epoch: 44, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
Validation loss decreased (-0.872219 --> -0.911108).  Saving model ...
Epoch: 45 cost time: 2.9440231323242188
Epoch: 45, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.087113380432129
Epoch: 46, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.3787715435028076
Epoch: 47, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.324063301086426
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.261110544204712
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.1841225624084473
Epoch: 50, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.9154605865478516
Epoch: 51, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.785665273666382
Epoch: 52, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.411 Vali Acc: 0.883 Test Loss: 0.411 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.769418954849243
Epoch: 53, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.8620851039886475
Epoch: 54, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.896581411361694
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.4294564723968506
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.3488950729370117
Epoch: 3, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.4303126335144043
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.349944591522217
Epoch: 5, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.204561948776245
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.34836483001709
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 3.3254852294921875
Epoch: 8, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6625216007232666
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3476290702819824
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.315255880355835
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.101168155670166
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 3.421377420425415
Epoch: 13, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 3.2463817596435547
Epoch: 14, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3855807781219482
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1639926433563232
Epoch: 16, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 3.1304454803466797
Epoch: 17, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.188300609588623
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0476229190826416
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 3.242687225341797
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.042062759399414
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.321946620941162
Epoch: 22, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.522895574569702
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2281606197357178
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 3.227437973022461
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 3.4068398475646973
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.959564447402954
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 3.160351514816284
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.309321880340576
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.3801119327545166
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.551018714904785
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.3089725971221924
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.9761440753936768
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8548645973205566
Epoch: 34, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.8883471488952637
Epoch: 35, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.983821153640747
Epoch: 36, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.9935624599456787
Epoch: 37, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 192198
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.177392244338989
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.815 Vali Acc: 0.217 Test Loss: 1.815 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 3.210108518600464
Epoch: 2, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.678 Vali Acc: 0.328 Test Loss: 1.678 Test Acc: 0.328
Validation loss decreased (-0.216649 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 3.4037721157073975
Epoch: 3, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.547 Vali Acc: 0.428 Test Loss: 1.547 Test Acc: 0.428
Validation loss decreased (-0.327761 --> -0.427762).  Saving model ...
Epoch: 4 cost time: 3.437988519668579
Epoch: 4, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.417 Vali Acc: 0.472 Test Loss: 1.417 Test Acc: 0.472
Validation loss decreased (-0.427762 --> -0.472208).  Saving model ...
Epoch: 5 cost time: 3.8231096267700195
Epoch: 5, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.292 Vali Acc: 0.511 Test Loss: 1.292 Test Acc: 0.511
Validation loss decreased (-0.472208 --> -0.511098).  Saving model ...
Epoch: 6 cost time: 3.303873300552368
Epoch: 6, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.193 Vali Acc: 0.511 Test Loss: 1.193 Test Acc: 0.511
Validation loss decreased (-0.511098 --> -0.511099).  Saving model ...
Epoch: 7 cost time: 3.538752317428589
Epoch: 7, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.095 Vali Acc: 0.539 Test Loss: 1.095 Test Acc: 0.539
Validation loss decreased (-0.511099 --> -0.538878).  Saving model ...
Epoch: 8 cost time: 3.2718112468719482
Epoch: 8, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.538878 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 3.135805130004883
Epoch: 9, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.945 Vali Acc: 0.628 Test Loss: 0.945 Test Acc: 0.628
Validation loss decreased (-0.599990 --> -0.627768).  Saving model ...
Epoch: 10 cost time: 3.704294443130493
Epoch: 10, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
Validation loss decreased (-0.627768 --> -0.666658).  Saving model ...
Epoch: 11 cost time: 3.335503339767456
Epoch: 11, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.852 Vali Acc: 0.656 Test Loss: 0.852 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2801032066345215
Epoch: 12, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.801 Vali Acc: 0.661 Test Loss: 0.801 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.469809055328369
Epoch: 13, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.735 Vali Acc: 0.683 Test Loss: 0.735 Test Acc: 0.683
Validation loss decreased (-0.666658 --> -0.683326).  Saving model ...
Epoch: 14 cost time: 3.2967631816864014
Epoch: 14, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.676 Vali Acc: 0.711 Test Loss: 0.676 Test Acc: 0.711
Validation loss decreased (-0.683326 --> -0.711104).  Saving model ...
Epoch: 15 cost time: 3.1458516120910645
Epoch: 15, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.637 Vali Acc: 0.717 Test Loss: 0.637 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 16 cost time: 3.3443381786346436
Epoch: 16, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.602 Vali Acc: 0.728 Test Loss: 0.602 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 17 cost time: 3.4831223487854004
Epoch: 17, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.575 Vali Acc: 0.744 Test Loss: 0.575 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 18 cost time: 2.907047986984253
Epoch: 18, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.546 Vali Acc: 0.761 Test Loss: 0.546 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 19 cost time: 3.251647710800171
Epoch: 19, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.516 Vali Acc: 0.767 Test Loss: 0.516 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 20 cost time: 3.671015977859497
Epoch: 20, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 21 cost time: 3.0902018547058105
Epoch: 21, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.462 Vali Acc: 0.794 Test Loss: 0.462 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 22 cost time: 3.249830484390259
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.442 Vali Acc: 0.806 Test Loss: 0.442 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 23 cost time: 3.0680453777313232
Epoch: 23, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.448 Vali Acc: 0.806 Test Loss: 0.448 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.075244665145874
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 2.9522933959960938
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8249545097351074
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.401 Vali Acc: 0.817 Test Loss: 0.401 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2723138332366943
Epoch: 27, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.381 Vali Acc: 0.839 Test Loss: 0.381 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 3.148482322692871
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.3033621311187744
Epoch: 29, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 30 cost time: 3.3277885913848877
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 31 cost time: 3.1558971405029297
Epoch: 31, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
Validation loss decreased (-0.838885 --> -0.883330).  Saving model ...
Epoch: 32 cost time: 3.222975492477417
Epoch: 32, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.184936285018921
Epoch: 33, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5036797523498535
Epoch: 34, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.404 Vali Acc: 0.839 Test Loss: 0.404 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0295825004577637
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.422 Vali Acc: 0.800 Test Loss: 0.422 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.2836740016937256
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.25903582572937
Epoch: 37, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.347 Vali Acc: 0.811 Test Loss: 0.347 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.0856499671936035
Epoch: 38, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.5281662940979004
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.3579983711242676
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.334754467010498
Epoch: 41, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.323 Vali Acc: 0.867 Test Loss: 0.323 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6364586353302
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.780 Vali Acc: 0.239 Test Loss: 1.780 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 2.855144500732422
Epoch: 2, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.694 Vali Acc: 0.333 Test Loss: 1.694 Test Acc: 0.333
Validation loss decreased (-0.238871 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 2.9460158348083496
Epoch: 3, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.607 Vali Acc: 0.361 Test Loss: 1.607 Test Acc: 0.361
Validation loss decreased (-0.333316 --> -0.361095).  Saving model ...
Epoch: 4 cost time: 2.91798734664917
Epoch: 4, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.504 Vali Acc: 0.428 Test Loss: 1.504 Test Acc: 0.428
Validation loss decreased (-0.361095 --> -0.427763).  Saving model ...
Epoch: 5 cost time: 2.9419262409210205
Epoch: 5, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.397 Vali Acc: 0.439 Test Loss: 1.397 Test Acc: 0.439
Validation loss decreased (-0.427763 --> -0.438875).  Saving model ...
Epoch: 6 cost time: 3.539997100830078
Epoch: 6, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.302 Vali Acc: 0.456 Test Loss: 1.302 Test Acc: 0.456
Validation loss decreased (-0.438875 --> -0.455543).  Saving model ...
Epoch: 7 cost time: 3.413271188735962
Epoch: 7, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.209 Vali Acc: 0.506 Test Loss: 1.209 Test Acc: 0.506
Validation loss decreased (-0.455543 --> -0.505543).  Saving model ...
Epoch: 8 cost time: 3.3989715576171875
Epoch: 8, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.144 Vali Acc: 0.511 Test Loss: 1.144 Test Acc: 0.511
Validation loss decreased (-0.505543 --> -0.511100).  Saving model ...
Epoch: 9 cost time: 3.1857330799102783
Epoch: 9, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.073 Vali Acc: 0.522 Test Loss: 1.073 Test Acc: 0.522
Validation loss decreased (-0.511100 --> -0.522211).  Saving model ...
Epoch: 10 cost time: 3.156965494155884
Epoch: 10, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.026 Vali Acc: 0.544 Test Loss: 1.026 Test Acc: 0.544
Validation loss decreased (-0.522211 --> -0.544434).  Saving model ...
Epoch: 11 cost time: 3.1238362789154053
Epoch: 11, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.974 Vali Acc: 0.567 Test Loss: 0.974 Test Acc: 0.567
Validation loss decreased (-0.544434 --> -0.566657).  Saving model ...
Epoch: 12 cost time: 3.2593531608581543
Epoch: 12, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.935 Vali Acc: 0.606 Test Loss: 0.935 Test Acc: 0.606
Validation loss decreased (-0.566657 --> -0.605546).  Saving model ...
Epoch: 13 cost time: 3.2508602142333984
Epoch: 13, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.879 Vali Acc: 0.633 Test Loss: 0.879 Test Acc: 0.633
Validation loss decreased (-0.605546 --> -0.633325).  Saving model ...
Epoch: 14 cost time: 3.0052640438079834
Epoch: 14, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.812 Vali Acc: 0.639 Test Loss: 0.812 Test Acc: 0.639
Validation loss decreased (-0.633325 --> -0.638881).  Saving model ...
Epoch: 15 cost time: 3.0433170795440674
Epoch: 15, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.763 Vali Acc: 0.683 Test Loss: 0.763 Test Acc: 0.683
Validation loss decreased (-0.638881 --> -0.683326).  Saving model ...
Epoch: 16 cost time: 3.0326952934265137
Epoch: 16, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
Validation loss decreased (-0.683326 --> -0.711104).  Saving model ...
Epoch: 17 cost time: 3.21702241897583
Epoch: 17, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.651 Vali Acc: 0.711 Test Loss: 0.651 Test Acc: 0.711
Validation loss decreased (-0.711104 --> -0.711105).  Saving model ...
Epoch: 18 cost time: 3.418919324874878
Epoch: 18, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.648 Vali Acc: 0.711 Test Loss: 0.648 Test Acc: 0.711
Validation loss decreased (-0.711105 --> -0.711105).  Saving model ...
Epoch: 19 cost time: 3.1918864250183105
Epoch: 19, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.711105 --> -0.755550).  Saving model ...
Epoch: 20 cost time: 3.060245990753174
Epoch: 20, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 21 cost time: 2.9719173908233643
Epoch: 21, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.510 Vali Acc: 0.772 Test Loss: 0.510 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772217).  Saving model ...
Epoch: 22 cost time: 3.0530359745025635
Epoch: 22, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.494 Vali Acc: 0.778 Test Loss: 0.494 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 23 cost time: 3.057826280593872
Epoch: 23, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783328).  Saving model ...
Epoch: 24 cost time: 3.135544538497925
Epoch: 24, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.457 Vali Acc: 0.794 Test Loss: 0.457 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 25 cost time: 3.3973660469055176
Epoch: 25, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.450 Vali Acc: 0.794 Test Loss: 0.450 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 26 cost time: 3.2757532596588135
Epoch: 26, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.418 Vali Acc: 0.789 Test Loss: 0.418 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2590324878692627
Epoch: 27, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 28 cost time: 3.354600191116333
Epoch: 28, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.372051239013672
Epoch: 29, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.404 Vali Acc: 0.817 Test Loss: 0.404 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.666818380355835
Epoch: 30, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.409 Vali Acc: 0.806 Test Loss: 0.409 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.3749001026153564
Epoch: 31, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 32 cost time: 3.1642744541168213
Epoch: 32, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2118208408355713
Epoch: 33, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.0328166484832764
Epoch: 34, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 35 cost time: 2.8214855194091797
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.390 Vali Acc: 0.806 Test Loss: 0.390 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.9604814052581787
Epoch: 36, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.425 Vali Acc: 0.817 Test Loss: 0.425 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.974433422088623
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.917743444442749
Epoch: 38, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 39 cost time: 3.1321191787719727
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.1970975399017334
Epoch: 40, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.136937379837036
Epoch: 41, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.174912452697754
Epoch: 42, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.9284322261810303
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.2960855960845947
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.340 Vali Acc: 0.856 Test Loss: 0.340 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.26884388923645
Epoch: 45, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.3833532333374023
Epoch: 46, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 47 cost time: 3.066114664077759
Epoch: 47, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.044827699661255
Epoch: 48, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.2994208335876465
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.375338554382324
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.5881776809692383
Epoch: 51, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.576834201812744
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 53 cost time: 3.100001096725464
Epoch: 53, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.0282723903656006
Epoch: 54, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 2.9251468181610107
Epoch: 55, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.2557899951934814
Epoch: 56, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.342078447341919
Epoch: 57, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.250143527984619
Epoch: 58, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.27740740776062
Epoch: 59, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.4080357551574707
Epoch: 60, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.45597505569458
Epoch: 61, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.5639190673828125
Epoch: 62, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.2663278579711914
Epoch: 63, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 64 cost time: 3.352564573287964
Epoch: 64, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.2738447189331055
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.599817991256714
Epoch: 66, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 67 cost time: 3.3554370403289795
Epoch: 67, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.7084527015686035
Epoch: 68, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.557177782058716
Epoch: 69, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.325523853302002
Epoch: 70, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.5440642833709717
Epoch: 71, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.6000816822052
Epoch: 72, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 3.564542055130005
Epoch: 73, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.3777265548706055
Epoch: 74, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.440770149230957
Epoch: 75, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 3.348348379135132
Epoch: 76, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.940572500228882
Epoch: 1, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.764 Vali Acc: 0.239 Test Loss: 1.764 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 3.5413060188293457
Epoch: 2, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.709 Vali Acc: 0.300 Test Loss: 1.709 Test Acc: 0.300
Validation loss decreased (-0.238871 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 3.586341619491577
Epoch: 3, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.657 Vali Acc: 0.283 Test Loss: 1.657 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2472691535949707
Epoch: 4, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.585 Vali Acc: 0.311 Test Loss: 1.585 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311095).  Saving model ...
Epoch: 5 cost time: 3.148057699203491
Epoch: 5, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.507 Vali Acc: 0.372 Test Loss: 1.507 Test Acc: 0.372
Validation loss decreased (-0.311095 --> -0.372207).  Saving model ...
Epoch: 6 cost time: 3.0711803436279297
Epoch: 6, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.424 Vali Acc: 0.372 Test Loss: 1.424 Test Acc: 0.372
Validation loss decreased (-0.372207 --> -0.372208).  Saving model ...
Epoch: 7 cost time: 3.2198398113250732
Epoch: 7, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.349 Vali Acc: 0.394 Test Loss: 1.349 Test Acc: 0.394
Validation loss decreased (-0.372208 --> -0.394431).  Saving model ...
Epoch: 8 cost time: 3.384028196334839
Epoch: 8, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
Validation loss decreased (-0.394431 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 3.2991185188293457
Epoch: 9, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.231 Vali Acc: 0.428 Test Loss: 1.231 Test Acc: 0.428
Validation loss decreased (-0.399987 --> -0.427765).  Saving model ...
Epoch: 10 cost time: 3.4132003784179688
Epoch: 10, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.185 Vali Acc: 0.411 Test Loss: 1.185 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1221516132354736
Epoch: 11, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.131 Vali Acc: 0.478 Test Loss: 1.131 Test Acc: 0.478
Validation loss decreased (-0.427765 --> -0.477766).  Saving model ...
Epoch: 12 cost time: 3.059847593307495
Epoch: 12, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.081 Vali Acc: 0.472 Test Loss: 1.081 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2131881713867188
Epoch: 13, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.028 Vali Acc: 0.472 Test Loss: 1.028 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9827375411987305
Epoch: 14, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.934 Vali Acc: 0.522 Test Loss: 0.934 Test Acc: 0.522
Validation loss decreased (-0.477766 --> -0.522213).  Saving model ...
Epoch: 15 cost time: 3.126920461654663
Epoch: 15, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.849 Vali Acc: 0.589 Test Loss: 0.849 Test Acc: 0.589
Validation loss decreased (-0.522213 --> -0.588880).  Saving model ...
Epoch: 16 cost time: 2.9873549938201904
Epoch: 16, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.775 Vali Acc: 0.611 Test Loss: 0.775 Test Acc: 0.611
Validation loss decreased (-0.588880 --> -0.611103).  Saving model ...
Epoch: 17 cost time: 3.097846508026123
Epoch: 17, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.694 Vali Acc: 0.667 Test Loss: 0.694 Test Acc: 0.667
Validation loss decreased (-0.611103 --> -0.666660).  Saving model ...
Epoch: 18 cost time: 3.130643844604492
Epoch: 18, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.662 Vali Acc: 0.644 Test Loss: 0.662 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1180684566497803
Epoch: 19, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (-0.666660 --> -0.716661).  Saving model ...
Epoch: 20 cost time: 3.3767805099487305
Epoch: 20, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.540 Vali Acc: 0.739 Test Loss: 0.540 Test Acc: 0.739
Validation loss decreased (-0.716661 --> -0.738883).  Saving model ...
Epoch: 21 cost time: 3.106316089630127
Epoch: 21, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.484 Vali Acc: 0.756 Test Loss: 0.484 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755551).  Saving model ...
Epoch: 22 cost time: 3.3426053524017334
Epoch: 22, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.755551 --> -0.788884).  Saving model ...
Epoch: 23 cost time: 3.2757272720336914
Epoch: 23, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.463 Vali Acc: 0.767 Test Loss: 0.463 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1382803916931152
Epoch: 24, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 25 cost time: 3.1562106609344482
Epoch: 25, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.410 Vali Acc: 0.783 Test Loss: 0.410 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.19732403755188
Epoch: 26, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.378302812576294
Epoch: 27, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.348931312561035
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 29 cost time: 3.324733018875122
Epoch: 29, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.381 Vali Acc: 0.817 Test Loss: 0.381 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.1438252925872803
Epoch: 30, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 31 cost time: 3.4183096885681152
Epoch: 31, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.64687180519104
Epoch: 32, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.2415671348571777
Epoch: 33, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.4203896522521973
Epoch: 34, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0642433166503906
Epoch: 35, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.3714699745178223
Epoch: 36, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.570690631866455
Epoch: 37, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849996).  Saving model ...
Epoch: 38 cost time: 3.5380475521087646
Epoch: 38, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 39 cost time: 3.5962369441986084
Epoch: 39, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.359 Vali Acc: 0.839 Test Loss: 0.359 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.7136127948760986
Epoch: 40, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.394 Vali Acc: 0.872 Test Loss: 0.394 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 41 cost time: 3.605579376220703
Epoch: 41, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.732156276702881
Epoch: 42, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.5420875549316406
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.263075590133667
Epoch: 44, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.2808265686035156
Epoch: 45, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.4072041511535645
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 47 cost time: 3.1328811645507812
Epoch: 47, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.2111172676086426
Epoch: 48, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.414074182510376
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.8480472564697266
Epoch: 50, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.3344151973724365
Epoch: 51, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.3963701725006104
Epoch: 52, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.1197993755340576
Epoch: 53, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.592069387435913
Epoch: 54, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 55 cost time: 3.041398048400879
Epoch: 55, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.3407986164093018
Epoch: 56, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.0717272758483887
Epoch: 57, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.0761890411376953
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.8659393787384033
Epoch: 59, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.335 Vali Acc: 0.883 Test Loss: 0.335 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 60 cost time: 3.5066609382629395
Epoch: 60, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.368 Vali Acc: 0.878 Test Loss: 0.368 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.4640045166015625
Epoch: 61, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.4787216186523438
Epoch: 62, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.335 Vali Acc: 0.894 Test Loss: 0.335 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 63 cost time: 3.3289380073547363
Epoch: 63, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.2792136669158936
Epoch: 64, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.179361343383789
Epoch: 65, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.063922643661499
Epoch: 66, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 67 cost time: 3.1979568004608154
Epoch: 67, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.266550302505493
Epoch: 68, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.2256319522857666
Epoch: 69, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.219620704650879
Epoch: 70, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.1761584281921387
Epoch: 71, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.101712465286255
Epoch: 72, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.9502196311950684
Epoch: 73, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.366 Vali Acc: 0.883 Test Loss: 0.366 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 2.897167682647705
Epoch: 74, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.5366125106811523
Epoch: 75, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 3.3881709575653076
Epoch: 76, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 77 cost time: 3.598958730697632
Epoch: 77, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 3.2354960441589355
Epoch: 78, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 3.139859199523926
Epoch: 79, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 3.461503028869629
Epoch: 80, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 3.3702163696289062
Epoch: 81, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.325 Vali Acc: 0.883 Test Loss: 0.325 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 3.4571332931518555
Epoch: 82, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 83 cost time: 3.734459161758423
Epoch: 83, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 84 cost time: 3.3394124507904053
Epoch: 84, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 85 cost time: 3.5862674713134766
Epoch: 85, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.9502241611480713
Epoch: 86, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 3.256932020187378
Epoch: 87, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 3.16330623626709
Epoch: 88, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 3.276200532913208
Epoch: 89, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 3.4619522094726562
Epoch: 90, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 3.30399227142334
Epoch: 91, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 3.387120485305786
Epoch: 92, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 3.15626859664917
Epoch: 93, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 3.0424864292144775
Epoch: 94, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.906 Test Loss: 0.376 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.631777048110962
Epoch: 1, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.796 Vali Acc: 0.261 Test Loss: 1.796 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 3.4263525009155273
Epoch: 2, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.757 Vali Acc: 0.261 Test Loss: 1.757 Test Acc: 0.261
Validation loss decreased (-0.261093 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 3.543950080871582
Epoch: 3, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.727 Vali Acc: 0.228 Test Loss: 1.727 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5002799034118652
Epoch: 4, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.690 Vali Acc: 0.228 Test Loss: 1.690 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.359865427017212
Epoch: 5, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.635 Vali Acc: 0.311 Test Loss: 1.635 Test Acc: 0.311
Validation loss decreased (-0.261094 --> -0.311095).  Saving model ...
Epoch: 6 cost time: 3.40445613861084
Epoch: 6, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.568 Vali Acc: 0.372 Test Loss: 1.568 Test Acc: 0.372
Validation loss decreased (-0.311095 --> -0.372207).  Saving model ...
Epoch: 7 cost time: 3.433223247528076
Epoch: 7, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.501 Vali Acc: 0.372 Test Loss: 1.501 Test Acc: 0.372
Validation loss decreased (-0.372207 --> -0.372207).  Saving model ...
Epoch: 8 cost time: 3.2860922813415527
Epoch: 8, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.446 Vali Acc: 0.400 Test Loss: 1.446 Test Acc: 0.400
Validation loss decreased (-0.372207 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 3.234177827835083
Epoch: 9, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.386 Vali Acc: 0.406 Test Loss: 1.386 Test Acc: 0.406
Validation loss decreased (-0.399986 --> -0.405542).  Saving model ...
Epoch: 10 cost time: 3.1581850051879883
Epoch: 10, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.302 Vali Acc: 0.439 Test Loss: 1.302 Test Acc: 0.439
Validation loss decreased (-0.405542 --> -0.438876).  Saving model ...
Epoch: 11 cost time: 3.748225212097168
Epoch: 11, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.231 Vali Acc: 0.444 Test Loss: 1.231 Test Acc: 0.444
Validation loss decreased (-0.438876 --> -0.444432).  Saving model ...
Epoch: 12 cost time: 2.7890408039093018
Epoch: 12, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.444432 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 3.1186840534210205
Epoch: 13, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.993 Vali Acc: 0.511 Test Loss: 0.993 Test Acc: 0.511
Validation loss decreased (-0.466655 --> -0.511101).  Saving model ...
Epoch: 14 cost time: 2.896641731262207
Epoch: 14, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.908 Vali Acc: 0.533 Test Loss: 0.908 Test Acc: 0.533
Validation loss decreased (-0.511101 --> -0.533324).  Saving model ...
Epoch: 15 cost time: 3.0526838302612305
Epoch: 15, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.847 Vali Acc: 0.561 Test Loss: 0.847 Test Acc: 0.561
Validation loss decreased (-0.533324 --> -0.561103).  Saving model ...
Epoch: 16 cost time: 3.5527024269104004
Epoch: 16, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.775 Vali Acc: 0.583 Test Loss: 0.775 Test Acc: 0.583
Validation loss decreased (-0.561103 --> -0.583326).  Saving model ...
Epoch: 17 cost time: 3.2748279571533203
Epoch: 17, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.705 Vali Acc: 0.656 Test Loss: 0.705 Test Acc: 0.656
Validation loss decreased (-0.583326 --> -0.655549).  Saving model ...
Epoch: 18 cost time: 3.6133923530578613
Epoch: 18, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.668 Vali Acc: 0.644 Test Loss: 0.668 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.213287115097046
Epoch: 19, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.591 Vali Acc: 0.711 Test Loss: 0.591 Test Acc: 0.711
Validation loss decreased (-0.655549 --> -0.711105).  Saving model ...
Epoch: 20 cost time: 3.198397636413574
Epoch: 20, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.527 Vali Acc: 0.744 Test Loss: 0.527 Test Acc: 0.744
Validation loss decreased (-0.711105 --> -0.744439).  Saving model ...
Epoch: 21 cost time: 3.4455389976501465
Epoch: 21, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.493 Vali Acc: 0.772 Test Loss: 0.493 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772217).  Saving model ...
Epoch: 22 cost time: 3.2713589668273926
Epoch: 22, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.474 Vali Acc: 0.750 Test Loss: 0.474 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2556021213531494
Epoch: 23, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.447 Vali Acc: 0.761 Test Loss: 0.447 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5833141803741455
Epoch: 24, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 25 cost time: 3.538590431213379
Epoch: 25, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.396 Vali Acc: 0.767 Test Loss: 0.396 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2701425552368164
Epoch: 26, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 27 cost time: 3.1680760383605957
Epoch: 27, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 28 cost time: 3.0321199893951416
Epoch: 28, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 3.1427578926086426
Epoch: 29, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4518346786499023
Epoch: 30, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 31 cost time: 3.341184139251709
Epoch: 31, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.4310591220855713
Epoch: 32, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 33 cost time: 3.282578229904175
Epoch: 33, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.487093687057495
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0841763019561768
Epoch: 35, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.5424680709838867
Epoch: 36, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.278632402420044
Epoch: 37, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.2271268367767334
Epoch: 38, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 39 cost time: 3.5384724140167236
Epoch: 39, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.357 Vali Acc: 0.872 Test Loss: 0.357 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3737800121307373
Epoch: 40, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 41 cost time: 3.7153666019439697
Epoch: 41, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 42 cost time: 3.451035737991333
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.328 Vali Acc: 0.883 Test Loss: 0.328 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1636998653411865
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.362 Vali Acc: 0.872 Test Loss: 0.362 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.304255247116089
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.0153396129608154
Epoch: 45, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 46 cost time: 3.4127066135406494
Epoch: 46, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.351 Vali Acc: 0.883 Test Loss: 0.351 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4336795806884766
Epoch: 47, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.380358934402466
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.4250128269195557
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.345 Vali Acc: 0.883 Test Loss: 0.345 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.8413922786712646
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.381 Vali Acc: 0.883 Test Loss: 0.381 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.064567804336548
Epoch: 51, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.430 Vali Acc: 0.883 Test Loss: 0.430 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.080902099609375
Epoch: 52, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.1884379386901855
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 3.7349588871002197
Epoch: 54, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.870833396911621
Epoch: 55, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.605452060699463
Epoch: 56, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.3485982418060303
Epoch: 57, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.883 Test Loss: 0.368 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.373727798461914
Epoch: 58, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.378 Vali Acc: 0.883 Test Loss: 0.378 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.164083957672119
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 60 cost time: 3.3354380130767822
Epoch: 60, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.407 Vali Acc: 0.894 Test Loss: 0.407 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.222764730453491
Epoch: 61, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.393922805786133
Epoch: 62, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.384 Vali Acc: 0.906 Test Loss: 0.384 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 63 cost time: 3.5630884170532227
Epoch: 63, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 64 cost time: 3.5519728660583496
Epoch: 64, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.0064775943756104
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.415 Vali Acc: 0.894 Test Loss: 0.415 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.9048287868499756
Epoch: 66, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.8342556953430176
Epoch: 67, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 68 cost time: 2.946164608001709
Epoch: 68, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.1172657012939453
Epoch: 69, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.000298500061035
Epoch: 70, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.0724847316741943
Epoch: 71, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.245954751968384
Epoch: 72, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916663).  Saving model ...
Epoch: 73 cost time: 3.2978262901306152
Epoch: 73, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.450 Vali Acc: 0.911 Test Loss: 0.450 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 3.5697827339172363
Epoch: 74, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.894 Test Loss: 0.449 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 3.416821002960205
Epoch: 75, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.484 Vali Acc: 0.906 Test Loss: 0.484 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 3.2805988788604736
Epoch: 76, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 3.3007500171661377
Epoch: 77, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.906 Test Loss: 0.445 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 3.3562779426574707
Epoch: 78, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.911 Test Loss: 0.367 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 3.384589433670044
Epoch: 79, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 3.6215295791625977
Epoch: 80, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 3.8334927558898926
Epoch: 81, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.462 Vali Acc: 0.911 Test Loss: 0.462 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 3.5400941371917725
Epoch: 82, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.477195739746094
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.833 Vali Acc: 0.133 Test Loss: 1.833 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 3.4681668281555176
Epoch: 2, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.804 Vali Acc: 0.161 Test Loss: 1.804 Test Acc: 0.161
Validation loss decreased (-0.133315 --> -0.161093).  Saving model ...
Epoch: 3 cost time: 3.541217803955078
Epoch: 3, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.775 Vali Acc: 0.233 Test Loss: 1.775 Test Acc: 0.233
Validation loss decreased (-0.161093 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 3.4059641361236572
Epoch: 4, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.752 Vali Acc: 0.250 Test Loss: 1.752 Test Acc: 0.250
Validation loss decreased (-0.233316 --> -0.249982).  Saving model ...
Epoch: 5 cost time: 3.57155442237854
Epoch: 5, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.724 Vali Acc: 0.267 Test Loss: 1.724 Test Acc: 0.267
Validation loss decreased (-0.249982 --> -0.266649).  Saving model ...
Epoch: 6 cost time: 3.076460838317871
Epoch: 6, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.679 Vali Acc: 0.256 Test Loss: 1.679 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.653860330581665
Epoch: 7, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.619 Vali Acc: 0.267 Test Loss: 1.619 Test Acc: 0.267
Validation loss decreased (-0.266649 --> -0.266650).  Saving model ...
Epoch: 8 cost time: 3.488943576812744
Epoch: 8, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.553 Vali Acc: 0.322 Test Loss: 1.553 Test Acc: 0.322
Validation loss decreased (-0.266650 --> -0.322207).  Saving model ...
Epoch: 9 cost time: 3.4853174686431885
Epoch: 9, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.466 Vali Acc: 0.378 Test Loss: 1.466 Test Acc: 0.378
Validation loss decreased (-0.322207 --> -0.377763).  Saving model ...
Epoch: 10 cost time: 4.012455701828003
Epoch: 10, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.285 Vali Acc: 0.528 Test Loss: 1.285 Test Acc: 0.528
Validation loss decreased (-0.377763 --> -0.527765).  Saving model ...
Epoch: 11 cost time: 3.542236804962158
Epoch: 11, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.092 Vali Acc: 0.600 Test Loss: 1.092 Test Acc: 0.600
Validation loss decreased (-0.527765 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 3.4205374717712402
Epoch: 12, Steps: 12 | Train Loss: 1.078 Vali Loss: 0.921 Vali Acc: 0.606 Test Loss: 0.921 Test Acc: 0.606
Validation loss decreased (-0.599989 --> -0.605546).  Saving model ...
Epoch: 13 cost time: 2.970133066177368
Epoch: 13, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.807 Vali Acc: 0.611 Test Loss: 0.807 Test Acc: 0.611
Validation loss decreased (-0.605546 --> -0.611103).  Saving model ...
Epoch: 14 cost time: 3.0293140411376953
Epoch: 14, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.768 Vali Acc: 0.606 Test Loss: 0.768 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.497122049331665
Epoch: 15, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.696 Vali Acc: 0.678 Test Loss: 0.696 Test Acc: 0.678
Validation loss decreased (-0.611103 --> -0.677771).  Saving model ...
Epoch: 16 cost time: 3.640453338623047
Epoch: 16, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.638 Vali Acc: 0.644 Test Loss: 0.638 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4292757511138916
Epoch: 17, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.582 Vali Acc: 0.706 Test Loss: 0.582 Test Acc: 0.706
Validation loss decreased (-0.677771 --> -0.705550).  Saving model ...
Epoch: 18 cost time: 2.9832763671875
Epoch: 18, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.544 Vali Acc: 0.689 Test Loss: 0.544 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.261772871017456
Epoch: 19, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.506 Vali Acc: 0.728 Test Loss: 0.506 Test Acc: 0.728
Validation loss decreased (-0.705550 --> -0.727773).  Saving model ...
Epoch: 20 cost time: 3.409792184829712
Epoch: 20, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
Validation loss decreased (-0.727773 --> -0.799996).  Saving model ...
Epoch: 21 cost time: 3.3956031799316406
Epoch: 21, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.402 Vali Acc: 0.794 Test Loss: 0.402 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.532473087310791
Epoch: 22, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.394 Vali Acc: 0.783 Test Loss: 0.394 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.284109115600586
Epoch: 23, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.383 Vali Acc: 0.789 Test Loss: 0.383 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.083153247833252
Epoch: 24, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.343 Vali Acc: 0.806 Test Loss: 0.343 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 25 cost time: 2.924898147583008
Epoch: 25, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 26 cost time: 3.1606462001800537
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.325 Vali Acc: 0.822 Test Loss: 0.325 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 27 cost time: 3.6761274337768555
Epoch: 27, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.327 Vali Acc: 0.822 Test Loss: 0.327 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5289430618286133
Epoch: 28, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.321 Vali Acc: 0.806 Test Loss: 0.321 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6397759914398193
Epoch: 29, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.319 Vali Acc: 0.811 Test Loss: 0.319 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6596105098724365
Epoch: 30, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.311 Vali Acc: 0.811 Test Loss: 0.311 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.126495122909546
Epoch: 31, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.295 Vali Acc: 0.839 Test Loss: 0.295 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 32 cost time: 3.295973300933838
Epoch: 32, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.294 Vali Acc: 0.833 Test Loss: 0.294 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9510772228240967
Epoch: 33, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5603225231170654
Epoch: 34, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.286 Vali Acc: 0.839 Test Loss: 0.286 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 35 cost time: 3.5077526569366455
Epoch: 35, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 3.388583183288574
Epoch: 36, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.105361223220825
Epoch: 37, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.2857604026794434
Epoch: 38, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.346358299255371
Epoch: 39, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.5224225521087646
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 41 cost time: 3.3489983081817627
Epoch: 41, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 42 cost time: 3.10017466545105
Epoch: 42, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.235 Vali Acc: 0.872 Test Loss: 0.235 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1597061157226562
Epoch: 43, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.9060959815979004
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 3.192911148071289
Epoch: 45, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.3004608154296875
Epoch: 46, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.5163066387176514
Epoch: 47, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.215637445449829
Epoch: 48, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.5973258018493652
Epoch: 49, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.3840668201446533
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 4.050507307052612
Epoch: 51, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.362 Vali Acc: 0.894 Test Loss: 0.362 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 52 cost time: 3.4760003089904785
Epoch: 52, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 53 cost time: 3.609410524368286
Epoch: 53, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.894441 --> -0.922219).  Saving model ...
Epoch: 54 cost time: 3.1663568019866943
Epoch: 54, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.2793660163879395
Epoch: 55, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.167529821395874
Epoch: 56, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.154890537261963
Epoch: 57, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.773656129837036
Epoch: 58, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.46642804145813
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.3482553958892822
Epoch: 60, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.2205679416656494
Epoch: 61, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.113558769226074
Epoch: 62, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.288513660430908
Epoch: 63, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.423705339431763
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.826 Vali Acc: 0.189 Test Loss: 1.826 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.562824010848999
Epoch: 2, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.810 Vali Acc: 0.200 Test Loss: 1.810 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 3.1333441734313965
Epoch: 3, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.789 Vali Acc: 0.228 Test Loss: 1.789 Test Acc: 0.228
Validation loss decreased (-0.199982 --> -0.227760).  Saving model ...
Epoch: 4 cost time: 3.4194858074188232
Epoch: 4, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.765 Vali Acc: 0.250 Test Loss: 1.765 Test Acc: 0.250
Validation loss decreased (-0.227760 --> -0.249982).  Saving model ...
Epoch: 5 cost time: 3.271160840988159
Epoch: 5, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.732 Vali Acc: 0.256 Test Loss: 1.732 Test Acc: 0.256
Validation loss decreased (-0.249982 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 3.5992519855499268
Epoch: 6, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.687 Vali Acc: 0.339 Test Loss: 1.687 Test Acc: 0.339
Validation loss decreased (-0.255538 --> -0.338872).  Saving model ...
Epoch: 7 cost time: 3.6532375812530518
Epoch: 7, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.616 Vali Acc: 0.389 Test Loss: 1.616 Test Acc: 0.389
Validation loss decreased (-0.338872 --> -0.388873).  Saving model ...
Epoch: 8 cost time: 3.335698127746582
Epoch: 8, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.517 Vali Acc: 0.417 Test Loss: 1.517 Test Acc: 0.417
Validation loss decreased (-0.388873 --> -0.416651).  Saving model ...
Epoch: 9 cost time: 2.970228672027588
Epoch: 9, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.393 Vali Acc: 0.478 Test Loss: 1.393 Test Acc: 0.478
Validation loss decreased (-0.416651 --> -0.477764).  Saving model ...
Epoch: 10 cost time: 2.81642484664917
Epoch: 10, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.234 Vali Acc: 0.544 Test Loss: 1.234 Test Acc: 0.544
Validation loss decreased (-0.477764 --> -0.544432).  Saving model ...
Epoch: 11 cost time: 3.0740268230438232
Epoch: 11, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.087 Vali Acc: 0.544 Test Loss: 1.087 Test Acc: 0.544
Validation loss decreased (-0.544432 --> -0.544434).  Saving model ...
Epoch: 12 cost time: 3.0933220386505127
Epoch: 12, Steps: 12 | Train Loss: 1.081 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
Validation loss decreased (-0.544434 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 2.906839609146118
Epoch: 13, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.884 Vali Acc: 0.578 Test Loss: 0.884 Test Acc: 0.578
Validation loss decreased (-0.549990 --> -0.577769).  Saving model ...
Epoch: 14 cost time: 3.0823419094085693
Epoch: 14, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.821 Vali Acc: 0.583 Test Loss: 0.821 Test Acc: 0.583
Validation loss decreased (-0.577769 --> -0.583325).  Saving model ...
Epoch: 15 cost time: 3.4547643661499023
Epoch: 15, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.776 Vali Acc: 0.628 Test Loss: 0.776 Test Acc: 0.628
Validation loss decreased (-0.583325 --> -0.627770).  Saving model ...
Epoch: 16 cost time: 3.442262649536133
Epoch: 16, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.704 Vali Acc: 0.650 Test Loss: 0.704 Test Acc: 0.650
Validation loss decreased (-0.627770 --> -0.649993).  Saving model ...
Epoch: 17 cost time: 3.196559429168701
Epoch: 17, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (-0.649993 --> -0.722216).  Saving model ...
Epoch: 18 cost time: 2.8256571292877197
Epoch: 18, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.584 Vali Acc: 0.728 Test Loss: 0.584 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 19 cost time: 3.059915065765381
Epoch: 19, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.515 Vali Acc: 0.744 Test Loss: 0.515 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 20 cost time: 3.599985122680664
Epoch: 20, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.448 Vali Acc: 0.767 Test Loss: 0.448 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 21 cost time: 3.5779011249542236
Epoch: 21, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.441 Vali Acc: 0.789 Test Loss: 0.441 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 22 cost time: 3.58339524269104
Epoch: 22, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.408 Vali Acc: 0.756 Test Loss: 0.408 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.165512800216675
Epoch: 23, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.392 Vali Acc: 0.767 Test Loss: 0.392 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3734312057495117
Epoch: 24, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.352 Vali Acc: 0.794 Test Loss: 0.352 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794441).  Saving model ...
Epoch: 25 cost time: 3.357508659362793
Epoch: 25, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.324 Vali Acc: 0.800 Test Loss: 0.324 Test Acc: 0.800
Validation loss decreased (-0.794441 --> -0.799997).  Saving model ...
Epoch: 26 cost time: 3.717684268951416
Epoch: 26, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
Validation loss decreased (-0.799997 --> -0.827775).  Saving model ...
Epoch: 27 cost time: 3.5225448608398438
Epoch: 27, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.351640462875366
Epoch: 28, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.315 Vali Acc: 0.811 Test Loss: 0.315 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.454150915145874
Epoch: 29, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.316 Vali Acc: 0.833 Test Loss: 0.316 Test Acc: 0.833
Validation loss decreased (-0.827775 --> -0.833330).  Saving model ...
Epoch: 30 cost time: 3.315842628479004
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.411106824874878
Epoch: 31, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 32 cost time: 3.452892541885376
Epoch: 32, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.272 Vali Acc: 0.856 Test Loss: 0.272 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 33 cost time: 3.035165309906006
Epoch: 33, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.289 Vali Acc: 0.839 Test Loss: 0.289 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.140345811843872
Epoch: 34, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.555295705795288
Epoch: 35, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 3.6859652996063232
Epoch: 36, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 3.7539401054382324
Epoch: 37, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.466311454772949
Epoch: 38, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 3.3516364097595215
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.563089609146118
Epoch: 40, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.7035884857177734
Epoch: 41, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.622473955154419
Epoch: 42, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.5972323417663574
Epoch: 43, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.2090113162994385
Epoch: 44, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.196606159210205
Epoch: 45, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 46 cost time: 3.327434539794922
Epoch: 46, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.51641845703125
Epoch: 47, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.582756996154785
Epoch: 48, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.2116639614105225
Epoch: 49, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.8838720321655273
Epoch: 50, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.936448812484741
Epoch: 51, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.557833671569824
Epoch: 52, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.5206968784332275
Epoch: 53, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.101869821548462
Epoch: 54, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.075349807739258
Epoch: 55, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.017330646514893
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.844 Vali Acc: 0.144 Test Loss: 1.844 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 3.5136847496032715
Epoch: 2, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.821 Vali Acc: 0.167 Test Loss: 1.821 Test Acc: 0.167
Validation loss decreased (-0.144426 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 3.293332099914551
Epoch: 3, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.616163969039917
Epoch: 4, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.757 Vali Acc: 0.211 Test Loss: 1.757 Test Acc: 0.211
Validation loss decreased (-0.166649 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 3.7660679817199707
Epoch: 5, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.718 Vali Acc: 0.272 Test Loss: 1.718 Test Acc: 0.272
Validation loss decreased (-0.211094 --> -0.272205).  Saving model ...
Epoch: 6 cost time: 3.565126419067383
Epoch: 6, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.664 Vali Acc: 0.344 Test Loss: 1.664 Test Acc: 0.344
Validation loss decreased (-0.272205 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 3.3037493228912354
Epoch: 7, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.587 Vali Acc: 0.417 Test Loss: 1.587 Test Acc: 0.417
Validation loss decreased (-0.344428 --> -0.416651).  Saving model ...
Epoch: 8 cost time: 3.317448139190674
Epoch: 8, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.489 Vali Acc: 0.456 Test Loss: 1.489 Test Acc: 0.456
Validation loss decreased (-0.416651 --> -0.455541).  Saving model ...
Epoch: 9 cost time: 3.1739463806152344
Epoch: 9, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.361 Vali Acc: 0.528 Test Loss: 1.361 Test Acc: 0.528
Validation loss decreased (-0.455541 --> -0.527764).  Saving model ...
Epoch: 10 cost time: 3.4789695739746094
Epoch: 10, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.210 Vali Acc: 0.561 Test Loss: 1.210 Test Acc: 0.561
Validation loss decreased (-0.527764 --> -0.561099).  Saving model ...
Epoch: 11 cost time: 3.677016258239746
Epoch: 11, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.074 Vali Acc: 0.544 Test Loss: 1.074 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.372544050216675
Epoch: 12, Steps: 12 | Train Loss: 1.102 Vali Loss: 0.986 Vali Acc: 0.561 Test Loss: 0.986 Test Acc: 0.561
Validation loss decreased (-0.561099 --> -0.561101).  Saving model ...
Epoch: 13 cost time: 2.9190046787261963
Epoch: 13, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.923 Vali Acc: 0.567 Test Loss: 0.923 Test Acc: 0.567
Validation loss decreased (-0.561101 --> -0.566657).  Saving model ...
Epoch: 14 cost time: 3.3615832328796387
Epoch: 14, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.871 Vali Acc: 0.611 Test Loss: 0.871 Test Acc: 0.611
Validation loss decreased (-0.566657 --> -0.611102).  Saving model ...
Epoch: 15 cost time: 3.3700928688049316
Epoch: 15, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.839 Vali Acc: 0.622 Test Loss: 0.839 Test Acc: 0.622
Validation loss decreased (-0.611102 --> -0.622214).  Saving model ...
Epoch: 16 cost time: 3.1878130435943604
Epoch: 16, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.756 Vali Acc: 0.644 Test Loss: 0.756 Test Acc: 0.644
Validation loss decreased (-0.622214 --> -0.644437).  Saving model ...
Epoch: 17 cost time: 3.1810734272003174
Epoch: 17, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.680 Vali Acc: 0.694 Test Loss: 0.680 Test Acc: 0.694
Validation loss decreased (-0.644437 --> -0.694438).  Saving model ...
Epoch: 18 cost time: 3.2095091342926025
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.639 Vali Acc: 0.689 Test Loss: 0.639 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.621764659881592
Epoch: 19, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.564 Vali Acc: 0.694 Test Loss: 0.564 Test Acc: 0.694
Validation loss decreased (-0.694438 --> -0.694439).  Saving model ...
Epoch: 20 cost time: 3.549556016921997
Epoch: 20, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.494 Vali Acc: 0.728 Test Loss: 0.494 Test Acc: 0.728
Validation loss decreased (-0.694439 --> -0.727773).  Saving model ...
Epoch: 21 cost time: 3.4530513286590576
Epoch: 21, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.474 Vali Acc: 0.756 Test Loss: 0.474 Test Acc: 0.756
Validation loss decreased (-0.727773 --> -0.755551).  Saving model ...
Epoch: 22 cost time: 3.3049476146698
Epoch: 22, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.436 Vali Acc: 0.767 Test Loss: 0.436 Test Acc: 0.767
Validation loss decreased (-0.755551 --> -0.766662).  Saving model ...
Epoch: 23 cost time: 3.1477627754211426
Epoch: 23, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.408 Vali Acc: 0.761 Test Loss: 0.408 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.247692108154297
Epoch: 24, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794441).  Saving model ...
Epoch: 25 cost time: 3.335413694381714
Epoch: 25, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.345 Vali Acc: 0.800 Test Loss: 0.345 Test Acc: 0.800
Validation loss decreased (-0.794441 --> -0.799997).  Saving model ...
Epoch: 26 cost time: 3.358628273010254
Epoch: 26, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.345 Vali Acc: 0.794 Test Loss: 0.345 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.138204336166382
Epoch: 27, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.329 Vali Acc: 0.800 Test Loss: 0.329 Test Acc: 0.800
Validation loss decreased (-0.799997 --> -0.799997).  Saving model ...
Epoch: 28 cost time: 3.6438753604888916
Epoch: 28, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.333 Vali Acc: 0.800 Test Loss: 0.333 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2476730346679688
Epoch: 29, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.327 Vali Acc: 0.817 Test Loss: 0.327 Test Acc: 0.817
Validation loss decreased (-0.799997 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.0450918674468994
Epoch: 30, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.065005302429199
Epoch: 31, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 32 cost time: 3.4878435134887695
Epoch: 32, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 33 cost time: 3.4361205101013184
Epoch: 33, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 34 cost time: 3.339055299758911
Epoch: 34, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.089919328689575
Epoch: 35, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3600783348083496
Epoch: 36, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 37 cost time: 3.3463146686553955
Epoch: 37, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0334532260894775
Epoch: 38, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 39 cost time: 3.3253931999206543
Epoch: 39, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.47597074508667
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.4404938220977783
Epoch: 41, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.282212495803833
Epoch: 42, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 3.3753316402435303
Epoch: 43, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.389108180999756
Epoch: 44, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.618955135345459
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927776).  Saving model ...
Epoch: 46 cost time: 2.991635322570801
Epoch: 46, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.0443577766418457
Epoch: 47, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.4431841373443604
Epoch: 48, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.3987553119659424
Epoch: 49, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.988247871398926
Epoch: 50, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.030470132827759
Epoch: 51, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.2256362438201904
Epoch: 52, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.172804355621338
Epoch: 53, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.8922040462493896
Epoch: 54, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.108358144760132
Epoch: 55, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.807419776916504
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.1973493099212646
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.465468645095825
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.4311397075653076
Epoch: 4, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.171322822570801
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.036471128463745
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 3.510018825531006
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 3.3800549507141113
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 2.9903688430786133
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0340113639831543
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.389880895614624
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.350449800491333
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1501553058624268
Epoch: 13, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 3.068380832672119
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 3.443950891494751
Epoch: 15, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.410432815551758
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.657161235809326
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2439091205596924
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.249485731124878
Epoch: 19, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 3.414048671722412
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 3.5585997104644775
Epoch: 21, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 3.0960628986358643
Epoch: 22, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 3.12018084526062
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 3.6044421195983887
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5736231803894043
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.501898765563965
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0776448249816895
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1283273696899414
Epoch: 28, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.545098066329956
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.438770055770874
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 3.0127980709075928
Epoch: 31, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 2.9760901927948
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 2.7191386222839355
Epoch: 33, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0845272541046143
Epoch: 34, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.9972901344299316
Epoch: 35, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.948479175567627
Epoch: 36, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 3.4842097759246826
Epoch: 37, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 3.544313907623291
Epoch: 38, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.1275641918182373
Epoch: 39, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 3.182874917984009
Epoch: 40, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 3.534982442855835
Epoch: 41, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 3.5138561725616455
Epoch: 42, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.079496383666992
Epoch: 43, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1979658603668213
Epoch: 44, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.347001552581787
Epoch: 45, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.308358907699585
Epoch: 46, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.236067771911621
Epoch: 47, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.5692412853240967
Epoch: 48, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.5536065101623535
Epoch: 49, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.9893200397491455
Epoch: 50, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.889608860015869
Epoch: 51, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 435814
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.818154811859131
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.782 Vali Acc: 0.233 Test Loss: 1.782 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 3.5345382690429688
Epoch: 2, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.672 Vali Acc: 0.328 Test Loss: 1.672 Test Acc: 0.328
Validation loss decreased (-0.233316 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 3.687915325164795
Epoch: 3, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.553 Vali Acc: 0.367 Test Loss: 1.553 Test Acc: 0.367
Validation loss decreased (-0.327761 --> -0.366651).  Saving model ...
Epoch: 4 cost time: 3.083571195602417
Epoch: 4, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.437 Vali Acc: 0.450 Test Loss: 1.437 Test Acc: 0.450
Validation loss decreased (-0.366651 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 3.2073512077331543
Epoch: 5, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.328 Vali Acc: 0.483 Test Loss: 1.328 Test Acc: 0.483
Validation loss decreased (-0.449986 --> -0.483320).  Saving model ...
Epoch: 6 cost time: 3.5858402252197266
Epoch: 6, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.230 Vali Acc: 0.528 Test Loss: 1.230 Test Acc: 0.528
Validation loss decreased (-0.483320 --> -0.527765).  Saving model ...
Epoch: 7 cost time: 3.466601848602295
Epoch: 7, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.135 Vali Acc: 0.589 Test Loss: 1.135 Test Acc: 0.589
Validation loss decreased (-0.527765 --> -0.588878).  Saving model ...
Epoch: 8 cost time: 3.6833889484405518
Epoch: 8, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.033 Vali Acc: 0.594 Test Loss: 1.033 Test Acc: 0.594
Validation loss decreased (-0.588878 --> -0.594434).  Saving model ...
Epoch: 9 cost time: 3.433976888656616
Epoch: 9, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.957 Vali Acc: 0.639 Test Loss: 0.957 Test Acc: 0.639
Validation loss decreased (-0.594434 --> -0.638879).  Saving model ...
Epoch: 10 cost time: 3.635136842727661
Epoch: 10, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.871 Vali Acc: 0.622 Test Loss: 0.871 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.627126932144165
Epoch: 11, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.801 Vali Acc: 0.672 Test Loss: 0.801 Test Acc: 0.672
Validation loss decreased (-0.638879 --> -0.672214).  Saving model ...
Epoch: 12 cost time: 3.6293013095855713
Epoch: 12, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
Validation loss decreased (-0.672214 --> -0.711104).  Saving model ...
Epoch: 13 cost time: 3.1287777423858643
Epoch: 13, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 14 cost time: 3.678966522216797
Epoch: 14, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (-0.716660 --> -0.716660).  Saving model ...
Epoch: 15 cost time: 3.5975046157836914
Epoch: 15, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.584 Vali Acc: 0.756 Test Loss: 0.584 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755550).  Saving model ...
Epoch: 16 cost time: 2.9325811862945557
Epoch: 16, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.550 Vali Acc: 0.750 Test Loss: 0.550 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.314488410949707
Epoch: 17, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755550).  Saving model ...
Epoch: 18 cost time: 3.5137741565704346
Epoch: 18, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.480 Vali Acc: 0.767 Test Loss: 0.480 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 19 cost time: 3.397352933883667
Epoch: 19, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.473 Vali Acc: 0.778 Test Loss: 0.473 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 20 cost time: 3.0865142345428467
Epoch: 20, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.461 Vali Acc: 0.772 Test Loss: 0.461 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2539260387420654
Epoch: 21, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.426 Vali Acc: 0.800 Test Loss: 0.426 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 22 cost time: 3.3833022117614746
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.392 Vali Acc: 0.839 Test Loss: 0.392 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 3.279069662094116
Epoch: 23, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.390 Vali Acc: 0.839 Test Loss: 0.390 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 24 cost time: 3.280848503112793
Epoch: 24, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3611626625061035
Epoch: 25, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.369 Vali Acc: 0.839 Test Loss: 0.369 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 26 cost time: 3.8071887493133545
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.51163649559021
Epoch: 27, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 3.0779073238372803
Epoch: 28, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4936554431915283
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.7815167903900146
Epoch: 30, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5087342262268066
Epoch: 31, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.071909189224243
Epoch: 32, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.674891233444214
Epoch: 33, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.5911037921905518
Epoch: 34, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 3.2930588722229004
Epoch: 35, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 36 cost time: 3.387409210205078
Epoch: 36, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.342 Vali Acc: 0.856 Test Loss: 0.342 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.581411600112915
Epoch: 37, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.427371025085449
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3682913780212402
Epoch: 39, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.3596925735473633
Epoch: 40, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.144719362258911
Epoch: 41, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.5048370361328125
Epoch: 42, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 43 cost time: 3.1662824153900146
Epoch: 43, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2762086391448975
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 45 cost time: 3.3099160194396973
Epoch: 45, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.653258800506592
Epoch: 46, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.0459423065185547
Epoch: 47, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 48 cost time: 3.597114086151123
Epoch: 48, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 49 cost time: 3.262211799621582
Epoch: 49, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 3.1794190406799316
Epoch: 50, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.154106378555298
Epoch: 51, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 52 cost time: 3.2632181644439697
Epoch: 52, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.3336100578308105
Epoch: 53, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.878 Test Loss: 0.308 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.2235798835754395
Epoch: 54, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.014810085296631
Epoch: 55, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.6353492736816406
Epoch: 56, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.4923207759857178
Epoch: 57, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.254150867462158
Epoch: 58, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 59 cost time: 3.5820648670196533
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.311464786529541
Epoch: 60, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 61 cost time: 3.911390781402588
Epoch: 61, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.3726511001586914
Epoch: 62, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.8840932846069336
Epoch: 63, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.500215530395508
Epoch: 64, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.5620808601379395
Epoch: 65, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.506065607070923
Epoch: 66, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.308133840560913
Epoch: 67, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.282946825027466
Epoch: 68, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.211183547973633
Epoch: 69, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 3.0990941524505615
Epoch: 70, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8447964191436768
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.794 Vali Acc: 0.211 Test Loss: 1.794 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 2.832500457763672
Epoch: 2, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.704 Vali Acc: 0.256 Test Loss: 1.704 Test Acc: 0.256
Validation loss decreased (-0.211093 --> -0.255539).  Saving model ...
Epoch: 3 cost time: 2.934116840362549
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.612 Vali Acc: 0.278 Test Loss: 1.612 Test Acc: 0.278
Validation loss decreased (-0.255539 --> -0.277762).  Saving model ...
Epoch: 4 cost time: 3.0245437622070312
Epoch: 4, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.521 Vali Acc: 0.356 Test Loss: 1.521 Test Acc: 0.356
Validation loss decreased (-0.277762 --> -0.355540).  Saving model ...
Epoch: 5 cost time: 3.309807777404785
Epoch: 5, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.432 Vali Acc: 0.439 Test Loss: 1.432 Test Acc: 0.439
Validation loss decreased (-0.355540 --> -0.438875).  Saving model ...
Epoch: 6 cost time: 3.2268290519714355
Epoch: 6, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.352 Vali Acc: 0.444 Test Loss: 1.352 Test Acc: 0.444
Validation loss decreased (-0.438875 --> -0.444431).  Saving model ...
Epoch: 7 cost time: 3.2630932331085205
Epoch: 7, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.275 Vali Acc: 0.472 Test Loss: 1.275 Test Acc: 0.472
Validation loss decreased (-0.444431 --> -0.472209).  Saving model ...
Epoch: 8 cost time: 3.1715667247772217
Epoch: 8, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.190 Vali Acc: 0.472 Test Loss: 1.190 Test Acc: 0.472
Validation loss decreased (-0.472209 --> -0.472210).  Saving model ...
Epoch: 9 cost time: 3.2558908462524414
Epoch: 9, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.124 Vali Acc: 0.494 Test Loss: 1.124 Test Acc: 0.494
Validation loss decreased (-0.472210 --> -0.494433).  Saving model ...
Epoch: 10 cost time: 3.1207988262176514
Epoch: 10, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.051 Vali Acc: 0.528 Test Loss: 1.051 Test Acc: 0.528
Validation loss decreased (-0.494433 --> -0.527767).  Saving model ...
Epoch: 11 cost time: 3.2777645587921143
Epoch: 11, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.982 Vali Acc: 0.567 Test Loss: 0.982 Test Acc: 0.567
Validation loss decreased (-0.527767 --> -0.566657).  Saving model ...
Epoch: 12 cost time: 2.9567220211029053
Epoch: 12, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.913 Vali Acc: 0.633 Test Loss: 0.913 Test Acc: 0.633
Validation loss decreased (-0.566657 --> -0.633324).  Saving model ...
Epoch: 13 cost time: 2.967494249343872
Epoch: 13, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.851 Vali Acc: 0.622 Test Loss: 0.851 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0898377895355225
Epoch: 14, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.793 Vali Acc: 0.656 Test Loss: 0.793 Test Acc: 0.656
Validation loss decreased (-0.633324 --> -0.655548).  Saving model ...
Epoch: 15 cost time: 2.732603073120117
Epoch: 15, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.720 Vali Acc: 0.683 Test Loss: 0.720 Test Acc: 0.683
Validation loss decreased (-0.655548 --> -0.683326).  Saving model ...
Epoch: 16 cost time: 3.0124099254608154
Epoch: 16, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
Validation loss decreased (-0.683326 --> -0.716660).  Saving model ...
Epoch: 17 cost time: 2.756791830062866
Epoch: 17, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.605 Vali Acc: 0.728 Test Loss: 0.605 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 18 cost time: 2.866847515106201
Epoch: 18, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.555 Vali Acc: 0.778 Test Loss: 0.555 Test Acc: 0.778
Validation loss decreased (-0.727772 --> -0.777772).  Saving model ...
Epoch: 19 cost time: 2.721872329711914
Epoch: 19, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 20 cost time: 3.24420428276062
Epoch: 20, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.491 Vali Acc: 0.772 Test Loss: 0.491 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1711935997009277
Epoch: 21, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.452 Vali Acc: 0.789 Test Loss: 0.452 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 22 cost time: 3.1362946033477783
Epoch: 22, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.788884 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 3.026489734649658
Epoch: 23, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1276445388793945
Epoch: 24, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2110888957977295
Epoch: 25, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0985448360443115
Epoch: 26, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 3.192805290222168
Epoch: 27, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 2.95021653175354
Epoch: 28, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.970848798751831
Epoch: 29, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8864712715148926
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 31 cost time: 3.18951416015625
Epoch: 31, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3369674682617188
Epoch: 32, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 33 cost time: 3.286984443664551
Epoch: 33, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2604362964630127
Epoch: 34, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.610046148300171
Epoch: 35, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 36 cost time: 3.306075096130371
Epoch: 36, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.1905834674835205
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3099749088287354
Epoch: 38, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.295 Vali Acc: 0.833 Test Loss: 0.295 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.9082376956939697
Epoch: 39, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 3.103792905807495
Epoch: 40, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.858083963394165
Epoch: 41, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.121893882751465
Epoch: 42, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 43 cost time: 3.1933977603912354
Epoch: 43, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 3.2335805892944336
Epoch: 44, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.906057596206665
Epoch: 45, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.9931113719940186
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.3312649726867676
Epoch: 47, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 3.6198537349700928
Epoch: 48, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.493109941482544
Epoch: 49, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.324894666671753
Epoch: 50, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.209989070892334
Epoch: 51, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.076531410217285
Epoch: 52, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.975999116897583
Epoch: 53, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 54 cost time: 3.010082244873047
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.8269286155700684
Epoch: 55, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 56 cost time: 3.1284453868865967
Epoch: 56, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 57 cost time: 3.173490524291992
Epoch: 57, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.897636890411377
Epoch: 58, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.0476253032684326
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.898554563522339
Epoch: 60, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.379615068435669
Epoch: 61, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.25920033454895
Epoch: 62, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.4351720809936523
Epoch: 63, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.497640609741211
Epoch: 64, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.5745327472686768
Epoch: 65, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.403172016143799
Epoch: 66, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.613332748413086
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.771 Vali Acc: 0.222 Test Loss: 1.771 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 3.1102449893951416
Epoch: 2, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.696 Vali Acc: 0.278 Test Loss: 1.696 Test Acc: 0.278
Validation loss decreased (-0.222205 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 2.94016432762146
Epoch: 3, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.628 Vali Acc: 0.294 Test Loss: 1.628 Test Acc: 0.294
Validation loss decreased (-0.277761 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 3.065232753753662
Epoch: 4, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.561 Vali Acc: 0.344 Test Loss: 1.561 Test Acc: 0.344
Validation loss decreased (-0.294428 --> -0.344429).  Saving model ...
Epoch: 5 cost time: 3.1900599002838135
Epoch: 5, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.492 Vali Acc: 0.394 Test Loss: 1.492 Test Acc: 0.394
Validation loss decreased (-0.344429 --> -0.394430).  Saving model ...
Epoch: 6 cost time: 3.162466287612915
Epoch: 6, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.421 Vali Acc: 0.383 Test Loss: 1.421 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0776240825653076
Epoch: 7, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
Validation loss decreased (-0.394430 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 3.0120811462402344
Epoch: 8, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 3.381397008895874
Epoch: 9, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.235 Vali Acc: 0.411 Test Loss: 1.235 Test Acc: 0.411
Validation loss decreased (-0.399987 --> -0.411099).  Saving model ...
Epoch: 10 cost time: 3.3732194900512695
Epoch: 10, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.178 Vali Acc: 0.389 Test Loss: 1.178 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3624236583709717
Epoch: 11, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.114 Vali Acc: 0.439 Test Loss: 1.114 Test Acc: 0.439
Validation loss decreased (-0.411099 --> -0.438878).  Saving model ...
Epoch: 12 cost time: 3.4910049438476562
Epoch: 12, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.048 Vali Acc: 0.506 Test Loss: 1.048 Test Acc: 0.506
Validation loss decreased (-0.438878 --> -0.505545).  Saving model ...
Epoch: 13 cost time: 3.357431650161743
Epoch: 13, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.974 Vali Acc: 0.517 Test Loss: 0.974 Test Acc: 0.517
Validation loss decreased (-0.505545 --> -0.516657).  Saving model ...
Epoch: 14 cost time: 3.2954132556915283
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.910 Vali Acc: 0.572 Test Loss: 0.910 Test Acc: 0.572
Validation loss decreased (-0.516657 --> -0.572213).  Saving model ...
Epoch: 15 cost time: 3.2287776470184326
Epoch: 15, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.833 Vali Acc: 0.606 Test Loss: 0.833 Test Acc: 0.606
Validation loss decreased (-0.572213 --> -0.605547).  Saving model ...
Epoch: 16 cost time: 3.0334112644195557
Epoch: 16, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.762 Vali Acc: 0.628 Test Loss: 0.762 Test Acc: 0.628
Validation loss decreased (-0.605547 --> -0.627770).  Saving model ...
Epoch: 17 cost time: 3.2111051082611084
Epoch: 17, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.708 Vali Acc: 0.656 Test Loss: 0.708 Test Acc: 0.656
Validation loss decreased (-0.627770 --> -0.655548).  Saving model ...
Epoch: 18 cost time: 3.1924190521240234
Epoch: 18, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.636 Vali Acc: 0.667 Test Loss: 0.636 Test Acc: 0.667
Validation loss decreased (-0.655548 --> -0.666660).  Saving model ...
Epoch: 19 cost time: 3.231224536895752
Epoch: 19, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.578 Vali Acc: 0.711 Test Loss: 0.578 Test Acc: 0.711
Validation loss decreased (-0.666660 --> -0.711105).  Saving model ...
Epoch: 20 cost time: 3.127377986907959
Epoch: 20, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.555 Vali Acc: 0.728 Test Loss: 0.555 Test Acc: 0.728
Validation loss decreased (-0.711105 --> -0.727772).  Saving model ...
Epoch: 21 cost time: 3.300354480743408
Epoch: 21, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.494 Vali Acc: 0.761 Test Loss: 0.494 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 22 cost time: 3.1083078384399414
Epoch: 22, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.449 Vali Acc: 0.783 Test Loss: 0.449 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 23 cost time: 3.302276372909546
Epoch: 23, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.423 Vali Acc: 0.761 Test Loss: 0.423 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2125325202941895
Epoch: 24, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.420 Vali Acc: 0.789 Test Loss: 0.420 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 25 cost time: 3.1634137630462646
Epoch: 25, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.398 Vali Acc: 0.778 Test Loss: 0.398 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.316011905670166
Epoch: 26, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 27 cost time: 3.3322548866271973
Epoch: 27, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.364 Vali Acc: 0.789 Test Loss: 0.364 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1352527141571045
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 2.890723943710327
Epoch: 29, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.369 Vali Acc: 0.789 Test Loss: 0.369 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.978289842605591
Epoch: 30, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 31 cost time: 3.0622682571411133
Epoch: 31, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.333 Vali Acc: 0.811 Test Loss: 0.333 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.8971104621887207
Epoch: 32, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.342 Vali Acc: 0.811 Test Loss: 0.342 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.9416422843933105
Epoch: 33, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 34 cost time: 2.7825663089752197
Epoch: 34, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.342 Vali Acc: 0.806 Test Loss: 0.342 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8836660385131836
Epoch: 35, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 36 cost time: 3.0543031692504883
Epoch: 36, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.00573468208313
Epoch: 37, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 38 cost time: 2.9597132205963135
Epoch: 38, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.307316541671753
Epoch: 39, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 40 cost time: 3.2831668853759766
Epoch: 40, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.305 Vali Acc: 0.828 Test Loss: 0.305 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2667529582977295
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1579713821411133
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 43 cost time: 3.1839706897735596
Epoch: 43, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 44 cost time: 3.1612348556518555
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.1846234798431396
Epoch: 45, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.2140979766845703
Epoch: 46, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.9256927967071533
Epoch: 47, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 48 cost time: 2.899404764175415
Epoch: 48, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.0141005516052246
Epoch: 49, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.7462310791015625
Epoch: 50, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.8212664127349854
Epoch: 51, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.8204855918884277
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.067901611328125
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.045140027999878
Epoch: 54, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.166353702545166
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.1765856742858887
Epoch: 56, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 57 cost time: 3.478125810623169
Epoch: 57, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.4537289142608643
Epoch: 58, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.2150025367736816
Epoch: 59, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.154151678085327
Epoch: 60, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905552).  Saving model ...
Epoch: 61 cost time: 3.1734700202941895
Epoch: 61, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.469470500946045
Epoch: 62, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.6370625495910645
Epoch: 63, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.4169418811798096
Epoch: 64, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.454517364501953
Epoch: 65, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.1164541244506836
Epoch: 66, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 2.7480571269989014
Epoch: 67, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.269129991531372
Epoch: 68, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.3978826999664307
Epoch: 69, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 3.3259575366973877
Epoch: 70, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5380165576934814
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.769 Vali Acc: 0.206 Test Loss: 1.769 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 3.0662786960601807
Epoch: 2, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.729 Vali Acc: 0.267 Test Loss: 1.729 Test Acc: 0.267
Validation loss decreased (-0.205538 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 3.124624490737915
Epoch: 3, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.693 Vali Acc: 0.311 Test Loss: 1.693 Test Acc: 0.311
Validation loss decreased (-0.266649 --> -0.311094).  Saving model ...
Epoch: 4 cost time: 3.236626386642456
Epoch: 4, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.658 Vali Acc: 0.289 Test Loss: 1.658 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2356388568878174
Epoch: 5, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.612 Vali Acc: 0.322 Test Loss: 1.612 Test Acc: 0.322
Validation loss decreased (-0.311094 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 3.2131733894348145
Epoch: 6, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.554 Vali Acc: 0.367 Test Loss: 1.554 Test Acc: 0.367
Validation loss decreased (-0.322206 --> -0.366651).  Saving model ...
Epoch: 7 cost time: 3.1170623302459717
Epoch: 7, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.504 Vali Acc: 0.350 Test Loss: 1.504 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5024168491363525
Epoch: 8, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.428 Vali Acc: 0.383 Test Loss: 1.428 Test Acc: 0.383
Validation loss decreased (-0.366651 --> -0.383319).  Saving model ...
Epoch: 9 cost time: 3.236508846282959
Epoch: 9, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.365 Vali Acc: 0.422 Test Loss: 1.365 Test Acc: 0.422
Validation loss decreased (-0.383319 --> -0.422209).  Saving model ...
Epoch: 10 cost time: 3.3632760047912598
Epoch: 10, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.296 Vali Acc: 0.422 Test Loss: 1.296 Test Acc: 0.422
Validation loss decreased (-0.422209 --> -0.422209).  Saving model ...
Epoch: 11 cost time: 3.5490260124206543
Epoch: 11, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
Validation loss decreased (-0.422209 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 3.508441686630249
Epoch: 12, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
Validation loss decreased (-0.466655 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 3.348879337310791
Epoch: 13, Steps: 12 | Train Loss: 0.934 Vali Loss: 0.970 Vali Acc: 0.511 Test Loss: 0.970 Test Acc: 0.511
Validation loss decreased (-0.499989 --> -0.511101).  Saving model ...
Epoch: 14 cost time: 3.1862075328826904
Epoch: 14, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.893 Vali Acc: 0.578 Test Loss: 0.893 Test Acc: 0.578
Validation loss decreased (-0.511101 --> -0.577769).  Saving model ...
Epoch: 15 cost time: 3.2572269439697266
Epoch: 15, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.798 Vali Acc: 0.589 Test Loss: 0.798 Test Acc: 0.589
Validation loss decreased (-0.577769 --> -0.588881).  Saving model ...
Epoch: 16 cost time: 3.1635913848876953
Epoch: 16, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.716 Vali Acc: 0.656 Test Loss: 0.716 Test Acc: 0.656
Validation loss decreased (-0.588881 --> -0.655548).  Saving model ...
Epoch: 17 cost time: 3.3273463249206543
Epoch: 17, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.659 Vali Acc: 0.644 Test Loss: 0.659 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.085259199142456
Epoch: 18, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.597 Vali Acc: 0.700 Test Loss: 0.597 Test Acc: 0.700
Validation loss decreased (-0.655548 --> -0.699994).  Saving model ...
Epoch: 19 cost time: 3.213020086288452
Epoch: 19, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.554 Vali Acc: 0.728 Test Loss: 0.554 Test Acc: 0.728
Validation loss decreased (-0.699994 --> -0.727772).  Saving model ...
Epoch: 20 cost time: 3.1361324787139893
Epoch: 20, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.516 Vali Acc: 0.750 Test Loss: 0.516 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749995).  Saving model ...
Epoch: 21 cost time: 3.3148045539855957
Epoch: 21, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.470 Vali Acc: 0.767 Test Loss: 0.470 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 22 cost time: 3.49715256690979
Epoch: 22, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.417 Vali Acc: 0.756 Test Loss: 0.417 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.556124448776245
Epoch: 23, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.393 Vali Acc: 0.789 Test Loss: 0.393 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 24 cost time: 3.6280055046081543
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.386 Vali Acc: 0.772 Test Loss: 0.386 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.622347116470337
Epoch: 25, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.380 Vali Acc: 0.783 Test Loss: 0.380 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7458229064941406
Epoch: 26, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.377 Vali Acc: 0.789 Test Loss: 0.377 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788885).  Saving model ...
Epoch: 27 cost time: 3.6019973754882812
Epoch: 27, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 28 cost time: 3.80407452583313
Epoch: 28, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.369 Vali Acc: 0.800 Test Loss: 0.369 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.3170721530914307
Epoch: 29, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5662841796875
Epoch: 30, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.359 Vali Acc: 0.794 Test Loss: 0.359 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2449135780334473
Epoch: 31, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.361 Vali Acc: 0.811 Test Loss: 0.361 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2043285369873047
Epoch: 32, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 33 cost time: 3.702857255935669
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 34 cost time: 3.219393491744995
Epoch: 34, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 35 cost time: 3.3240063190460205
Epoch: 35, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3230743408203125
Epoch: 36, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.031841993331909
Epoch: 37, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.53495717048645
Epoch: 38, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.363 Vali Acc: 0.811 Test Loss: 0.363 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.324636220932007
Epoch: 39, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 40 cost time: 3.2948265075683594
Epoch: 40, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 41 cost time: 3.885258197784424
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.765796422958374
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 43 cost time: 3.545233726501465
Epoch: 43, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.5906288623809814
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 45 cost time: 3.8623366355895996
Epoch: 45, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 46 cost time: 3.2165136337280273
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.311274528503418
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.344 Vali Acc: 0.872 Test Loss: 0.344 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.1140873432159424
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.5173537731170654
Epoch: 49, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.391 Vali Acc: 0.867 Test Loss: 0.391 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.1386547088623047
Epoch: 50, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 51 cost time: 3.527604818344116
Epoch: 51, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.4271984100341797
Epoch: 52, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 3.400745153427124
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.718996524810791
Epoch: 54, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.498450517654419
Epoch: 55, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.459019422531128
Epoch: 56, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 57 cost time: 3.5857973098754883
Epoch: 57, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.74147891998291
Epoch: 58, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.6426970958709717
Epoch: 59, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.216236114501953
Epoch: 60, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.402 Vali Acc: 0.878 Test Loss: 0.402 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.1916933059692383
Epoch: 61, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.374 Vali Acc: 0.883 Test Loss: 0.374 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.1962037086486816
Epoch: 62, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 3.1847140789031982
Epoch: 63, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.181170701980591
Epoch: 64, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.1197052001953125
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.372 Vali Acc: 0.883 Test Loss: 0.372 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.1930389404296875
Epoch: 66, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.371 Vali Acc: 0.878 Test Loss: 0.371 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.1187994480133057
Epoch: 67, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 3.3320555686950684
Epoch: 68, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.398 Vali Acc: 0.878 Test Loss: 0.398 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 3.1408884525299072
Epoch: 69, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 3.322875499725342
Epoch: 70, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 3.323604106903076
Epoch: 71, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 72 cost time: 3.1047255992889404
Epoch: 72, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916663).  Saving model ...
Epoch: 73 cost time: 3.1240627765655518
Epoch: 73, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 3.3199727535247803
Epoch: 74, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 3.3334076404571533
Epoch: 75, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.336 Vali Acc: 0.872 Test Loss: 0.336 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 3.121617078781128
Epoch: 76, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 3.055673837661743
Epoch: 77, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.362 Vali Acc: 0.878 Test Loss: 0.362 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 3.3005502223968506
Epoch: 78, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 3.26737642288208
Epoch: 79, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.417 Vali Acc: 0.878 Test Loss: 0.417 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 3.3300514221191406
Epoch: 80, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 3.3927791118621826
Epoch: 81, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 3.447251558303833
Epoch: 82, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.445606708526611
Epoch: 1, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.833 Vali Acc: 0.144 Test Loss: 1.833 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 3.197457790374756
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.803 Vali Acc: 0.133 Test Loss: 1.803 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.182932138442993
Epoch: 3, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.780 Vali Acc: 0.183 Test Loss: 1.780 Test Acc: 0.183
Validation loss decreased (-0.144426 --> -0.183316).  Saving model ...
Epoch: 4 cost time: 2.9696357250213623
Epoch: 4, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.754 Vali Acc: 0.217 Test Loss: 1.754 Test Acc: 0.217
Validation loss decreased (-0.183316 --> -0.216649).  Saving model ...
Epoch: 5 cost time: 3.0792980194091797
Epoch: 5, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.725 Vali Acc: 0.239 Test Loss: 1.725 Test Acc: 0.239
Validation loss decreased (-0.216649 --> -0.238872).  Saving model ...
Epoch: 6 cost time: 3.060537815093994
Epoch: 6, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.687 Vali Acc: 0.256 Test Loss: 1.687 Test Acc: 0.256
Validation loss decreased (-0.238872 --> -0.255539).  Saving model ...
Epoch: 7 cost time: 3.193009614944458
Epoch: 7, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.655 Vali Acc: 0.250 Test Loss: 1.655 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.180668354034424
Epoch: 8, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.595 Vali Acc: 0.283 Test Loss: 1.595 Test Acc: 0.283
Validation loss decreased (-0.255539 --> -0.283317).  Saving model ...
Epoch: 9 cost time: 3.602292537689209
Epoch: 9, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.517 Vali Acc: 0.344 Test Loss: 1.517 Test Acc: 0.344
Validation loss decreased (-0.283317 --> -0.344429).  Saving model ...
Epoch: 10 cost time: 3.321620225906372
Epoch: 10, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.373 Vali Acc: 0.428 Test Loss: 1.373 Test Acc: 0.428
Validation loss decreased (-0.344429 --> -0.427764).  Saving model ...
Epoch: 11 cost time: 3.390395164489746
Epoch: 11, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.427764 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 3.503801107406616
Epoch: 12, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.009 Vali Acc: 0.556 Test Loss: 1.009 Test Acc: 0.556
Validation loss decreased (-0.499988 --> -0.555545).  Saving model ...
Epoch: 13 cost time: 3.328141450881958
Epoch: 13, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.907 Vali Acc: 0.539 Test Loss: 0.907 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2759337425231934
Epoch: 14, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.855 Vali Acc: 0.567 Test Loss: 0.855 Test Acc: 0.567
Validation loss decreased (-0.555545 --> -0.566658).  Saving model ...
Epoch: 15 cost time: 3.001648426055908
Epoch: 15, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.781 Vali Acc: 0.611 Test Loss: 0.781 Test Acc: 0.611
Validation loss decreased (-0.566658 --> -0.611103).  Saving model ...
Epoch: 16 cost time: 2.9411394596099854
Epoch: 16, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.704 Vali Acc: 0.633 Test Loss: 0.704 Test Acc: 0.633
Validation loss decreased (-0.611103 --> -0.633326).  Saving model ...
Epoch: 17 cost time: 2.997586727142334
Epoch: 17, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.665 Vali Acc: 0.617 Test Loss: 0.665 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.042759895324707
Epoch: 18, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.571 Vali Acc: 0.739 Test Loss: 0.571 Test Acc: 0.739
Validation loss decreased (-0.633326 --> -0.738883).  Saving model ...
Epoch: 19 cost time: 3.0186057090759277
Epoch: 19, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.517 Vali Acc: 0.772 Test Loss: 0.517 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772217).  Saving model ...
Epoch: 20 cost time: 3.3406875133514404
Epoch: 20, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.491 Vali Acc: 0.761 Test Loss: 0.491 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.436751365661621
Epoch: 21, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.461 Vali Acc: 0.750 Test Loss: 0.461 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0521256923675537
Epoch: 22, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.416 Vali Acc: 0.789 Test Loss: 0.416 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 23 cost time: 2.9052927494049072
Epoch: 23, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.411 Vali Acc: 0.806 Test Loss: 0.411 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805551).  Saving model ...
Epoch: 24 cost time: 3.531801462173462
Epoch: 24, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.386 Vali Acc: 0.772 Test Loss: 0.386 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.646541118621826
Epoch: 25, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.360 Vali Acc: 0.811 Test Loss: 0.360 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811108).  Saving model ...
Epoch: 26 cost time: 3.2197842597961426
Epoch: 26, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
Validation loss decreased (-0.811108 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 3.035496711730957
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 3.3019022941589355
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.026597261428833
Epoch: 29, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.338 Vali Acc: 0.800 Test Loss: 0.338 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9044642448425293
Epoch: 30, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.4224112033843994
Epoch: 31, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.331 Vali Acc: 0.817 Test Loss: 0.331 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.111905097961426
Epoch: 32, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.0315587520599365
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 34 cost time: 3.2603416442871094
Epoch: 34, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.329177141189575
Epoch: 35, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.223111391067505
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 37 cost time: 3.073913812637329
Epoch: 37, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 38 cost time: 2.8969345092773438
Epoch: 38, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.00557017326355
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.9019129276275635
Epoch: 40, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 41 cost time: 2.923569679260254
Epoch: 41, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.111915349960327
Epoch: 42, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 3.098341464996338
Epoch: 43, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.5833935737609863
Epoch: 44, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.3946449756622314
Epoch: 45, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.349 Vali Acc: 0.894 Test Loss: 0.349 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 46 cost time: 3.311919927597046
Epoch: 46, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.2312655448913574
Epoch: 47, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.4741122722625732
Epoch: 48, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.397 Vali Acc: 0.883 Test Loss: 0.397 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.494933605194092
Epoch: 49, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 50 cost time: 3.318556547164917
Epoch: 50, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.335 Vali Acc: 0.883 Test Loss: 0.335 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.2802155017852783
Epoch: 51, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.092033624649048
Epoch: 52, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.362 Vali Acc: 0.894 Test Loss: 0.362 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.372861623764038
Epoch: 53, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.9819889068603516
Epoch: 54, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.7986814975738525
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.872 Test Loss: 0.343 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.0478923320770264
Epoch: 56, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.0151755809783936
Epoch: 57, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.2413766384124756
Epoch: 58, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.7127175331115723
Epoch: 59, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 60 cost time: 3.265843152999878
Epoch: 60, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.282372236251831
Epoch: 61, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 62 cost time: 3.39768385887146
Epoch: 62, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.3973264694213867
Epoch: 63, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.1964128017425537
Epoch: 64, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 3.235764265060425
Epoch: 65, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.285229206085205
Epoch: 66, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.46832013130188
Epoch: 67, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 3.5325942039489746
Epoch: 68, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.990696668624878
Epoch: 69, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 3.314647912979126
Epoch: 70, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 71 cost time: 3.217907428741455
Epoch: 71, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.045273542404175
Epoch: 72, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.381523609161377
Epoch: 73, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.4185373783111572
Epoch: 74, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.69167423248291
Epoch: 75, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.5053036212921143
Epoch: 76, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.1946616172790527
Epoch: 77, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.3750243186950684
Epoch: 78, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 3.2469935417175293
Epoch: 79, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 3.404423475265503
Epoch: 80, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.534990549087524
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.839 Vali Acc: 0.161 Test Loss: 1.839 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 3.444812536239624
Epoch: 2, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.821 Vali Acc: 0.194 Test Loss: 1.821 Test Acc: 0.194
Validation loss decreased (-0.161093 --> -0.194426).  Saving model ...
Epoch: 3 cost time: 3.5398213863372803
Epoch: 3, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.799 Vali Acc: 0.206 Test Loss: 1.799 Test Acc: 0.206
Validation loss decreased (-0.194426 --> -0.205538).  Saving model ...
Epoch: 4 cost time: 3.265932559967041
Epoch: 4, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.244 Test Loss: 1.765 Test Acc: 0.244
Validation loss decreased (-0.205538 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 3.2232518196105957
Epoch: 5, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.721 Vali Acc: 0.261 Test Loss: 1.721 Test Acc: 0.261
Validation loss decreased (-0.244427 --> -0.261094).  Saving model ...
Epoch: 6 cost time: 3.234586715698242
Epoch: 6, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.671 Vali Acc: 0.278 Test Loss: 1.671 Test Acc: 0.278
Validation loss decreased (-0.261094 --> -0.277761).  Saving model ...
Epoch: 7 cost time: 3.1917426586151123
Epoch: 7, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.605 Vali Acc: 0.339 Test Loss: 1.605 Test Acc: 0.339
Validation loss decreased (-0.277761 --> -0.338873).  Saving model ...
Epoch: 8 cost time: 3.176651954650879
Epoch: 8, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.517 Vali Acc: 0.406 Test Loss: 1.517 Test Acc: 0.406
Validation loss decreased (-0.338873 --> -0.405540).  Saving model ...
Epoch: 9 cost time: 2.9024901390075684
Epoch: 9, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.402 Vali Acc: 0.478 Test Loss: 1.402 Test Acc: 0.478
Validation loss decreased (-0.405540 --> -0.477764).  Saving model ...
Epoch: 10 cost time: 3.2830259799957275
Epoch: 10, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.253 Vali Acc: 0.494 Test Loss: 1.253 Test Acc: 0.494
Validation loss decreased (-0.477764 --> -0.494432).  Saving model ...
Epoch: 11 cost time: 3.0365798473358154
Epoch: 11, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
Validation loss decreased (-0.494432 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 3.1140778064727783
Epoch: 12, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.012 Vali Acc: 0.578 Test Loss: 1.012 Test Acc: 0.578
Validation loss decreased (-0.533322 --> -0.577768).  Saving model ...
Epoch: 13 cost time: 2.9487171173095703
Epoch: 13, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.945 Vali Acc: 0.583 Test Loss: 0.945 Test Acc: 0.583
Validation loss decreased (-0.577768 --> -0.583324).  Saving model ...
Epoch: 14 cost time: 3.534069776535034
Epoch: 14, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.872 Vali Acc: 0.583 Test Loss: 0.872 Test Acc: 0.583
Validation loss decreased (-0.583324 --> -0.583325).  Saving model ...
Epoch: 15 cost time: 3.619156837463379
Epoch: 15, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.790 Vali Acc: 0.656 Test Loss: 0.790 Test Acc: 0.656
Validation loss decreased (-0.583325 --> -0.655548).  Saving model ...
Epoch: 16 cost time: 3.3869857788085938
Epoch: 16, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.688 Vali Acc: 0.683 Test Loss: 0.688 Test Acc: 0.683
Validation loss decreased (-0.655548 --> -0.683326).  Saving model ...
Epoch: 17 cost time: 3.2947282791137695
Epoch: 17, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
Validation loss decreased (-0.683326 --> -0.716660).  Saving model ...
Epoch: 18 cost time: 3.758666515350342
Epoch: 18, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.550 Vali Acc: 0.739 Test Loss: 0.550 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738883).  Saving model ...
Epoch: 19 cost time: 3.7997312545776367
Epoch: 19, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 20 cost time: 3.3128607273101807
Epoch: 20, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.433 Vali Acc: 0.756 Test Loss: 0.433 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3684797286987305
Epoch: 21, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.422 Vali Acc: 0.789 Test Loss: 0.422 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788885).  Saving model ...
Epoch: 22 cost time: 3.170815944671631
Epoch: 22, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 23 cost time: 3.2478394508361816
Epoch: 23, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.396 Vali Acc: 0.794 Test Loss: 0.396 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3023409843444824
Epoch: 24, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 3.261615753173828
Epoch: 25, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.298177719116211
Epoch: 26, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.346 Vali Acc: 0.811 Test Loss: 0.346 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.31482195854187
Epoch: 27, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 3.159855365753174
Epoch: 28, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4031996726989746
Epoch: 29, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.333 Vali Acc: 0.811 Test Loss: 0.333 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5579535961151123
Epoch: 30, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5225675106048584
Epoch: 31, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.4618093967437744
Epoch: 32, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.284435987472534
Epoch: 33, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 34 cost time: 3.263533353805542
Epoch: 34, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4534928798675537
Epoch: 35, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 36 cost time: 3.450061798095703
Epoch: 36, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.271 Vali Acc: 0.867 Test Loss: 0.271 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.0816893577575684
Epoch: 37, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3060803413391113
Epoch: 38, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3823587894439697
Epoch: 39, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883330).  Saving model ...
Epoch: 40 cost time: 3.5021872520446777
Epoch: 40, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 41 cost time: 3.152576446533203
Epoch: 41, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 42 cost time: 3.381788492202759
Epoch: 42, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.6028130054473877
Epoch: 43, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.235842704772949
Epoch: 44, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.8716533184051514
Epoch: 45, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 3.0411441326141357
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.167 Vali Acc: 0.928 Test Loss: 0.167 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 47 cost time: 3.387364149093628
Epoch: 47, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.0766265392303467
Epoch: 48, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.940293073654175
Epoch: 49, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.050307512283325
Epoch: 50, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.4339070320129395
Epoch: 51, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.4269092082977295
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 3.6648154258728027
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.4475131034851074
Epoch: 54, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.3910281658172607
Epoch: 55, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.4466495513916016
Epoch: 56, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.156172752380371
Epoch: 57, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.4705796241760254
Epoch: 58, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.827275276184082
Epoch: 59, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 3.013080596923828
Epoch: 60, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 2.643746852874756
Epoch: 61, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.8382327556610107
Epoch: 62, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.939 Test Loss: 0.185 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.706385374069214
Epoch: 63, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.910670280456543
Epoch: 64, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 65 cost time: 3.1158220767974854
Epoch: 65, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.065150022506714
Epoch: 66, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.9556286334991455
Epoch: 67, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 3.0630226135253906
Epoch: 68, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 3.2766194343566895
Epoch: 69, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 3.1769216060638428
Epoch: 70, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 3.086209774017334
Epoch: 71, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 3.0220108032226562
Epoch: 72, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 3.195077657699585
Epoch: 73, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 3.1383328437805176
Epoch: 74, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.939 Test Loss: 0.262 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.337878465652466
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.858 Vali Acc: 0.150 Test Loss: 1.858 Test Acc: 0.150
Validation loss decreased (inf --> -0.149981).  Saving model ...
Epoch: 2 cost time: 2.927267074584961
Epoch: 2, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.839 Vali Acc: 0.172 Test Loss: 1.839 Test Acc: 0.172
Validation loss decreased (-0.149981 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 3.0987892150878906
Epoch: 3, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.818 Vali Acc: 0.167 Test Loss: 1.818 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.999089002609253
Epoch: 4, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.784 Vali Acc: 0.200 Test Loss: 1.784 Test Acc: 0.200
Validation loss decreased (-0.172204 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 2.9852802753448486
Epoch: 5, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.739 Vali Acc: 0.278 Test Loss: 1.739 Test Acc: 0.278
Validation loss decreased (-0.199982 --> -0.277760).  Saving model ...
Epoch: 6 cost time: 3.1380786895751953
Epoch: 6, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.677 Vali Acc: 0.322 Test Loss: 1.677 Test Acc: 0.322
Validation loss decreased (-0.277760 --> -0.322205).  Saving model ...
Epoch: 7 cost time: 3.1126444339752197
Epoch: 7, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.596 Vali Acc: 0.356 Test Loss: 1.596 Test Acc: 0.356
Validation loss decreased (-0.322205 --> -0.355540).  Saving model ...
Epoch: 8 cost time: 3.034972667694092
Epoch: 8, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.490 Vali Acc: 0.417 Test Loss: 1.490 Test Acc: 0.417
Validation loss decreased (-0.355540 --> -0.416652).  Saving model ...
Epoch: 9 cost time: 2.815119504928589
Epoch: 9, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.363 Vali Acc: 0.450 Test Loss: 1.363 Test Acc: 0.450
Validation loss decreased (-0.416652 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 2.86729097366333
Epoch: 10, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.214 Vali Acc: 0.511 Test Loss: 1.214 Test Acc: 0.511
Validation loss decreased (-0.449986 --> -0.511099).  Saving model ...
Epoch: 11 cost time: 2.8967411518096924
Epoch: 11, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.511099 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 3.017495632171631
Epoch: 12, Steps: 12 | Train Loss: 1.138 Vali Loss: 0.971 Vali Acc: 0.578 Test Loss: 0.971 Test Acc: 0.578
Validation loss decreased (-0.533323 --> -0.577768).  Saving model ...
Epoch: 13 cost time: 3.0245134830474854
Epoch: 13, Steps: 12 | Train Loss: 1.015 Vali Loss: 0.937 Vali Acc: 0.572 Test Loss: 0.937 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9725987911224365
Epoch: 14, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.885 Vali Acc: 0.550 Test Loss: 0.885 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0963072776794434
Epoch: 15, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.845 Vali Acc: 0.622 Test Loss: 0.845 Test Acc: 0.622
Validation loss decreased (-0.577768 --> -0.622214).  Saving model ...
Epoch: 16 cost time: 3.1907169818878174
Epoch: 16, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.763 Vali Acc: 0.667 Test Loss: 0.763 Test Acc: 0.667
Validation loss decreased (-0.622214 --> -0.666659).  Saving model ...
Epoch: 17 cost time: 3.088526487350464
Epoch: 17, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
Validation loss decreased (-0.666659 --> -0.677771).  Saving model ...
Epoch: 18 cost time: 3.1770002841949463
Epoch: 18, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.640 Vali Acc: 0.694 Test Loss: 0.640 Test Acc: 0.694
Validation loss decreased (-0.677771 --> -0.694438).  Saving model ...
Epoch: 19 cost time: 2.956268072128296
Epoch: 19, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (-0.694438 --> -0.722216).  Saving model ...
Epoch: 20 cost time: 3.0983145236968994
Epoch: 20, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.552 Vali Acc: 0.733 Test Loss: 0.552 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 21 cost time: 2.912306785583496
Epoch: 21, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.529 Vali Acc: 0.722 Test Loss: 0.529 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9489729404449463
Epoch: 22, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 23 cost time: 2.8645217418670654
Epoch: 23, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.441 Vali Acc: 0.772 Test Loss: 0.441 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7135210037231445
Epoch: 24, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.400 Vali Acc: 0.794 Test Loss: 0.400 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 25 cost time: 2.842386484146118
Epoch: 25, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.001408338546753
Epoch: 26, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.368 Vali Acc: 0.800 Test Loss: 0.368 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 27 cost time: 3.2621591091156006
Epoch: 27, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.361 Vali Acc: 0.800 Test Loss: 0.361 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 28 cost time: 3.0411930084228516
Epoch: 28, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.355 Vali Acc: 0.794 Test Loss: 0.355 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.022428512573242
Epoch: 29, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 30 cost time: 2.9801974296569824
Epoch: 30, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.8317742347717285
Epoch: 31, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 32 cost time: 3.000638484954834
Epoch: 32, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.352 Vali Acc: 0.817 Test Loss: 0.352 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.162996530532837
Epoch: 33, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.9198238849639893
Epoch: 34, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.8803579807281494
Epoch: 35, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 36 cost time: 2.878490924835205
Epoch: 36, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 37 cost time: 2.938354253768921
Epoch: 37, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0937628746032715
Epoch: 38, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.0279242992401123
Epoch: 39, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 3.043118476867676
Epoch: 40, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2793996334075928
Epoch: 41, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 42 cost time: 3.1770241260528564
Epoch: 42, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 2.9003822803497314
Epoch: 43, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.084883689880371
Epoch: 44, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.884791612625122
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 46 cost time: 2.8357062339782715
Epoch: 46, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 2.9213385581970215
Epoch: 47, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.0191798210144043
Epoch: 48, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.2450292110443115
Epoch: 49, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.1355690956115723
Epoch: 50, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.0731470584869385
Epoch: 51, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.0999460220336914
Epoch: 52, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.9957103729248047
Epoch: 53, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.939784049987793
Epoch: 54, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.0922529697418213
Epoch: 55, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.140136957168579
Epoch: 56, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.979543447494507
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.3106954097747803
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.2185707092285156
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.30141019821167
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2327802181243896
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.06432843208313
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8972718715667725
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.973620891571045
Epoch: 8, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1128273010253906
Epoch: 9, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.048027276992798
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.052799701690674
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.274209976196289
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 239206
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.230179786682129
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.801 Vali Acc: 0.150 Test Loss: 1.801 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 3.3900399208068848
Epoch: 2, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.708 Vali Acc: 0.233 Test Loss: 1.708 Test Acc: 0.233
Validation loss decreased (-0.149982 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 3.0247926712036133
Epoch: 3, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.598 Vali Acc: 0.339 Test Loss: 1.598 Test Acc: 0.339
Validation loss decreased (-0.233316 --> -0.338873).  Saving model ...
Epoch: 4 cost time: 3.4051313400268555
Epoch: 4, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.482 Vali Acc: 0.456 Test Loss: 1.482 Test Acc: 0.456
Validation loss decreased (-0.338873 --> -0.455541).  Saving model ...
Epoch: 5 cost time: 3.214139699935913
Epoch: 5, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.375 Vali Acc: 0.489 Test Loss: 1.375 Test Acc: 0.489
Validation loss decreased (-0.455541 --> -0.488875).  Saving model ...
Epoch: 6 cost time: 3.0894203186035156
Epoch: 6, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.280 Vali Acc: 0.528 Test Loss: 1.280 Test Acc: 0.528
Validation loss decreased (-0.488875 --> -0.527765).  Saving model ...
Epoch: 7 cost time: 3.3957338333129883
Epoch: 7, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.195 Vali Acc: 0.533 Test Loss: 1.195 Test Acc: 0.533
Validation loss decreased (-0.527765 --> -0.533321).  Saving model ...
Epoch: 8 cost time: 2.8852508068084717
Epoch: 8, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.110 Vali Acc: 0.589 Test Loss: 1.110 Test Acc: 0.589
Validation loss decreased (-0.533321 --> -0.588878).  Saving model ...
Epoch: 9 cost time: 3.1318416595458984
Epoch: 9, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.588878 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 3.321420907974243
Epoch: 10, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 3.1044411659240723
Epoch: 11, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.898 Vali Acc: 0.611 Test Loss: 0.898 Test Acc: 0.611
Validation loss decreased (-0.599990 --> -0.611102).  Saving model ...
Epoch: 12 cost time: 3.2924671173095703
Epoch: 12, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.836 Vali Acc: 0.639 Test Loss: 0.836 Test Acc: 0.639
Validation loss decreased (-0.611102 --> -0.638881).  Saving model ...
Epoch: 13 cost time: 3.406020164489746
Epoch: 13, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.775 Vali Acc: 0.650 Test Loss: 0.775 Test Acc: 0.650
Validation loss decreased (-0.638881 --> -0.649992).  Saving model ...
Epoch: 14 cost time: 3.3815462589263916
Epoch: 14, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.713 Vali Acc: 0.683 Test Loss: 0.713 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683326).  Saving model ...
Epoch: 15 cost time: 3.223893642425537
Epoch: 15, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.645 Vali Acc: 0.728 Test Loss: 0.645 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727771).  Saving model ...
Epoch: 16 cost time: 2.688359260559082
Epoch: 16, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 3.1899659633636475
Epoch: 17, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788884).  Saving model ...
Epoch: 18 cost time: 2.8757498264312744
Epoch: 18, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.489 Vali Acc: 0.800 Test Loss: 0.489 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 19 cost time: 2.906735897064209
Epoch: 19, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.454 Vali Acc: 0.806 Test Loss: 0.454 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 20 cost time: 3.8289167881011963
Epoch: 20, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 3.5785045623779297
Epoch: 21, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844440).  Saving model ...
Epoch: 22 cost time: 3.672572374343872
Epoch: 22, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.370429754257202
Epoch: 23, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.624030590057373
Epoch: 24, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 3.0401556491851807
Epoch: 25, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.356 Vali Acc: 0.833 Test Loss: 0.356 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0515403747558594
Epoch: 26, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 3.0473649501800537
Epoch: 27, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.04231595993042
Epoch: 28, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 29 cost time: 2.871065855026245
Epoch: 29, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8446218967437744
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 3.3234376907348633
Epoch: 31, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2338829040527344
Epoch: 32, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4038662910461426
Epoch: 33, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.6932437419891357
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.4550137519836426
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.1929590702056885
Epoch: 36, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 3.146709442138672
Epoch: 37, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.0861823558807373
Epoch: 38, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3381259441375732
Epoch: 39, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.142744779586792
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.6788957118988037
Epoch: 41, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.6159398555755615
Epoch: 42, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.410912275314331
Epoch: 43, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 44 cost time: 3.489807605743408
Epoch: 44, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.081064224243164
Epoch: 45, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.0800719261169434
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.3234972953796387
Epoch: 47, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.0437700748443604
Epoch: 48, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.8494067192077637
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 50 cost time: 2.994480609893799
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 51 cost time: 2.8834030628204346
Epoch: 51, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 52 cost time: 3.2741758823394775
Epoch: 52, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.5214929580688477
Epoch: 53, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.334136724472046
Epoch: 54, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.3257062435150146
Epoch: 55, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.176522970199585
Epoch: 56, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.0256381034851074
Epoch: 57, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.138254404067993
Epoch: 58, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.1574950218200684
Epoch: 59, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.3333497047424316
Epoch: 60, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.0663270950317383
Epoch: 61, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 62 cost time: 3.3024158477783203
Epoch: 62, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.396723985671997
Epoch: 63, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 64 cost time: 3.2296323776245117
Epoch: 64, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 65 cost time: 3.323127269744873
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 3.1245787143707275
Epoch: 66, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.185791492462158
Epoch: 67, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 3.260214328765869
Epoch: 68, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.237534999847412
Epoch: 69, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.922 Test Loss: 0.187 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.281635284423828
Epoch: 70, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 3.3502414226531982
Epoch: 71, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.1920859813690186
Epoch: 72, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.472660541534424
Epoch: 73, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.2705440521240234
Epoch: 74, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.6731247901916504
Epoch: 75, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.518428325653076
Epoch: 76, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.468210458755493
Epoch: 77, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.466742992401123
Epoch: 78, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 3.304100275039673
Epoch: 79, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 80 cost time: 3.3203330039978027
Epoch: 80, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.112163782119751
Epoch: 81, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 3.090951442718506
Epoch: 82, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 3.0963640213012695
Epoch: 83, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.939 Test Loss: 0.181 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 3.3184726238250732
Epoch: 84, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 3.460577964782715
Epoch: 85, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.939 Test Loss: 0.180 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 3.1832215785980225
Epoch: 86, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 3.1939198970794678
Epoch: 87, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 3.1065478324890137
Epoch: 88, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 3.2614190578460693
Epoch: 89, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 3.479262351989746
Epoch: 90, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 3.1425907611846924
Epoch: 91, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 3.8731932640075684
Epoch: 92, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 3.5117971897125244
Epoch: 93, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 3.2991063594818115
Epoch: 94, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 3.3152692317962646
Epoch: 95, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 96 cost time: 3.39846134185791
Epoch: 96, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.939 Test Loss: 0.182 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 3.1829493045806885
Epoch: 97, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.939 Test Loss: 0.182 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 3.1881134510040283
Epoch: 98, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 2.9756059646606445
Epoch: 99, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.939 Test Loss: 0.178 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 3.2481625080108643
Epoch: 100, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.458040237426758
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.815 Vali Acc: 0.161 Test Loss: 1.815 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 3.035334348678589
Epoch: 2, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.745 Vali Acc: 0.211 Test Loss: 1.745 Test Acc: 0.211
Validation loss decreased (-0.161093 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 3.212758779525757
Epoch: 3, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.666 Vali Acc: 0.272 Test Loss: 1.666 Test Acc: 0.272
Validation loss decreased (-0.211094 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 3.0699093341827393
Epoch: 4, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.581 Vali Acc: 0.406 Test Loss: 1.581 Test Acc: 0.406
Validation loss decreased (-0.272206 --> -0.405540).  Saving model ...
Epoch: 5 cost time: 3.084139108657837
Epoch: 5, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.496 Vali Acc: 0.417 Test Loss: 1.496 Test Acc: 0.417
Validation loss decreased (-0.405540 --> -0.416652).  Saving model ...
Epoch: 6 cost time: 3.419065475463867
Epoch: 6, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.414 Vali Acc: 0.428 Test Loss: 1.414 Test Acc: 0.428
Validation loss decreased (-0.416652 --> -0.427764).  Saving model ...
Epoch: 7 cost time: 3.3437182903289795
Epoch: 7, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.334 Vali Acc: 0.467 Test Loss: 1.334 Test Acc: 0.467
Validation loss decreased (-0.427764 --> -0.466653).  Saving model ...
Epoch: 8 cost time: 3.5254576206207275
Epoch: 8, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.249 Vali Acc: 0.506 Test Loss: 1.249 Test Acc: 0.506
Validation loss decreased (-0.466653 --> -0.505543).  Saving model ...
Epoch: 9 cost time: 3.362267017364502
Epoch: 9, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.175 Vali Acc: 0.506 Test Loss: 1.175 Test Acc: 0.506
Validation loss decreased (-0.505543 --> -0.505544).  Saving model ...
Epoch: 10 cost time: 3.0014779567718506
Epoch: 10, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.106 Vali Acc: 0.544 Test Loss: 1.106 Test Acc: 0.544
Validation loss decreased (-0.505544 --> -0.544433).  Saving model ...
Epoch: 11 cost time: 3.2410085201263428
Epoch: 11, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.041 Vali Acc: 0.544 Test Loss: 1.041 Test Acc: 0.544
Validation loss decreased (-0.544433 --> -0.544434).  Saving model ...
Epoch: 12 cost time: 3.1309289932250977
Epoch: 12, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.978 Vali Acc: 0.572 Test Loss: 0.978 Test Acc: 0.572
Validation loss decreased (-0.544434 --> -0.572212).  Saving model ...
Epoch: 13 cost time: 3.058098793029785
Epoch: 13, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.913 Vali Acc: 0.589 Test Loss: 0.913 Test Acc: 0.589
Validation loss decreased (-0.572212 --> -0.588880).  Saving model ...
Epoch: 14 cost time: 3.223832845687866
Epoch: 14, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.842 Vali Acc: 0.617 Test Loss: 0.842 Test Acc: 0.617
Validation loss decreased (-0.588880 --> -0.616658).  Saving model ...
Epoch: 15 cost time: 3.393127918243408
Epoch: 15, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.756 Vali Acc: 0.667 Test Loss: 0.756 Test Acc: 0.667
Validation loss decreased (-0.616658 --> -0.666659).  Saving model ...
Epoch: 16 cost time: 3.381578207015991
Epoch: 16, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.682 Vali Acc: 0.706 Test Loss: 0.682 Test Acc: 0.706
Validation loss decreased (-0.666659 --> -0.705549).  Saving model ...
Epoch: 17 cost time: 3.0957441329956055
Epoch: 17, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 18 cost time: 3.073397397994995
Epoch: 18, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.541 Vali Acc: 0.761 Test Loss: 0.541 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 19 cost time: 3.1399641036987305
Epoch: 19, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.496 Vali Acc: 0.794 Test Loss: 0.496 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794439).  Saving model ...
Epoch: 20 cost time: 3.075483560562134
Epoch: 20, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.471 Vali Acc: 0.778 Test Loss: 0.471 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3569657802581787
Epoch: 21, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2352802753448486
Epoch: 22, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.411 Vali Acc: 0.794 Test Loss: 0.411 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 23 cost time: 3.222397804260254
Epoch: 23, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 24 cost time: 3.300389289855957
Epoch: 24, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.372 Vali Acc: 0.800 Test Loss: 0.372 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 25 cost time: 3.3533992767333984
Epoch: 25, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 3.1831817626953125
Epoch: 26, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.347 Vali Acc: 0.806 Test Loss: 0.347 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.127664804458618
Epoch: 27, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1461844444274902
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 3.1628992557525635
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 30 cost time: 3.2564079761505127
Epoch: 30, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.317 Vali Acc: 0.822 Test Loss: 0.317 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.343642473220825
Epoch: 31, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.314 Vali Acc: 0.817 Test Loss: 0.314 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2396790981292725
Epoch: 32, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 3.2183194160461426
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.294 Vali Acc: 0.839 Test Loss: 0.294 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0273401737213135
Epoch: 34, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 2.9476394653320312
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.039235830307007
Epoch: 36, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 37 cost time: 2.8926126956939697
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.261 Vali Acc: 0.850 Test Loss: 0.261 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.9381234645843506
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.512275218963623
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
Validation loss decreased (-0.872220 --> -0.894442).  Saving model ...
Epoch: 40 cost time: 3.303420066833496
Epoch: 40, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.236543893814087
Epoch: 41, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.115739345550537
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.242967367172241
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.3106417655944824
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 45 cost time: 3.0957834720611572
Epoch: 45, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.1061947345733643
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 47 cost time: 3.339669704437256
Epoch: 47, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.3727176189422607
Epoch: 48, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 49 cost time: 3.406921625137329
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.2999348640441895
Epoch: 50, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.8897180557250977
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.906 Test Loss: 0.197 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.7987213134765625
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.946075916290283
Epoch: 53, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 54 cost time: 2.9461662769317627
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.1727535724639893
Epoch: 55, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.207531452178955
Epoch: 56, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.1511032581329346
Epoch: 57, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.2506792545318604
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.9295778274536133
Epoch: 59, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.07574200630188
Epoch: 60, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.069890022277832
Epoch: 61, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 62 cost time: 3.18998122215271
Epoch: 62, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.900 Test Loss: 0.191 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.0350840091705322
Epoch: 63, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 64 cost time: 3.356821298599243
Epoch: 64, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 65 cost time: 3.3181371688842773
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.311978816986084
Epoch: 66, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 67 cost time: 3.277164936065674
Epoch: 67, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.2832860946655273
Epoch: 68, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.317854881286621
Epoch: 69, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.3141119480133057
Epoch: 70, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.06474232673645
Epoch: 71, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.114698648452759
Epoch: 72, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 3.1409168243408203
Epoch: 73, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.431666374206543
Epoch: 74, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.906 Test Loss: 0.190 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.293297529220581
Epoch: 75, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 3.0017642974853516
Epoch: 76, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.562938690185547
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.803 Vali Acc: 0.167 Test Loss: 1.803 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.14632511138916
Epoch: 2, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.758 Vali Acc: 0.222 Test Loss: 1.758 Test Acc: 0.222
Validation loss decreased (-0.166649 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 3.5339162349700928
Epoch: 3, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.707 Vali Acc: 0.300 Test Loss: 1.707 Test Acc: 0.300
Validation loss decreased (-0.222205 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 3.220993995666504
Epoch: 4, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.648 Vali Acc: 0.350 Test Loss: 1.648 Test Acc: 0.350
Validation loss decreased (-0.299983 --> -0.349984).  Saving model ...
Epoch: 5 cost time: 3.2657713890075684
Epoch: 5, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.589 Vali Acc: 0.350 Test Loss: 1.589 Test Acc: 0.350
Validation loss decreased (-0.349984 --> -0.349984).  Saving model ...
Epoch: 6 cost time: 3.117055892944336
Epoch: 6, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.526 Vali Acc: 0.361 Test Loss: 1.526 Test Acc: 0.361
Validation loss decreased (-0.349984 --> -0.361096).  Saving model ...
Epoch: 7 cost time: 3.278484344482422
Epoch: 7, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.462 Vali Acc: 0.383 Test Loss: 1.462 Test Acc: 0.383
Validation loss decreased (-0.361096 --> -0.383319).  Saving model ...
Epoch: 8 cost time: 3.12440824508667
Epoch: 8, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.385 Vali Acc: 0.428 Test Loss: 1.385 Test Acc: 0.428
Validation loss decreased (-0.383319 --> -0.427764).  Saving model ...
Epoch: 9 cost time: 3.3483664989471436
Epoch: 9, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.319 Vali Acc: 0.411 Test Loss: 1.319 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.207505941390991
Epoch: 10, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.252 Vali Acc: 0.433 Test Loss: 1.252 Test Acc: 0.433
Validation loss decreased (-0.427764 --> -0.433321).  Saving model ...
Epoch: 11 cost time: 3.094672679901123
Epoch: 11, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.184 Vali Acc: 0.444 Test Loss: 1.184 Test Acc: 0.444
Validation loss decreased (-0.433321 --> -0.444433).  Saving model ...
Epoch: 12 cost time: 3.2945737838745117
Epoch: 12, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.109 Vali Acc: 0.478 Test Loss: 1.109 Test Acc: 0.478
Validation loss decreased (-0.444433 --> -0.477767).  Saving model ...
Epoch: 13 cost time: 3.212374448776245
Epoch: 13, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.020 Vali Acc: 0.550 Test Loss: 1.020 Test Acc: 0.550
Validation loss decreased (-0.477767 --> -0.549990).  Saving model ...
Epoch: 14 cost time: 3.198472261428833
Epoch: 14, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.933 Vali Acc: 0.578 Test Loss: 0.933 Test Acc: 0.578
Validation loss decreased (-0.549990 --> -0.577768).  Saving model ...
Epoch: 15 cost time: 3.3597114086151123
Epoch: 15, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.850 Vali Acc: 0.639 Test Loss: 0.850 Test Acc: 0.639
Validation loss decreased (-0.577768 --> -0.638880).  Saving model ...
Epoch: 16 cost time: 3.3774096965789795
Epoch: 16, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.784 Vali Acc: 0.650 Test Loss: 0.784 Test Acc: 0.650
Validation loss decreased (-0.638880 --> -0.649992).  Saving model ...
Epoch: 17 cost time: 3.530334234237671
Epoch: 17, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.712 Vali Acc: 0.661 Test Loss: 0.712 Test Acc: 0.661
Validation loss decreased (-0.649992 --> -0.661104).  Saving model ...
Epoch: 18 cost time: 3.219484567642212
Epoch: 18, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.663 Vali Acc: 0.678 Test Loss: 0.663 Test Acc: 0.678
Validation loss decreased (-0.661104 --> -0.677771).  Saving model ...
Epoch: 19 cost time: 2.817671775817871
Epoch: 19, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.609 Vali Acc: 0.700 Test Loss: 0.609 Test Acc: 0.700
Validation loss decreased (-0.677771 --> -0.699994).  Saving model ...
Epoch: 20 cost time: 2.9283595085144043
Epoch: 20, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.573 Vali Acc: 0.733 Test Loss: 0.573 Test Acc: 0.733
Validation loss decreased (-0.699994 --> -0.733328).  Saving model ...
Epoch: 21 cost time: 3.111855983734131
Epoch: 21, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.534 Vali Acc: 0.728 Test Loss: 0.534 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8861634731292725
Epoch: 22, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.490 Vali Acc: 0.744 Test Loss: 0.490 Test Acc: 0.744
Validation loss decreased (-0.733328 --> -0.744440).  Saving model ...
Epoch: 23 cost time: 3.3955869674682617
Epoch: 23, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.476 Vali Acc: 0.750 Test Loss: 0.476 Test Acc: 0.750
Validation loss decreased (-0.744440 --> -0.749995).  Saving model ...
Epoch: 24 cost time: 3.3595638275146484
Epoch: 24, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.444 Vali Acc: 0.783 Test Loss: 0.444 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783329).  Saving model ...
Epoch: 25 cost time: 3.3819985389709473
Epoch: 25, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.443 Vali Acc: 0.772 Test Loss: 0.443 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.925645589828491
Epoch: 26, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.413 Vali Acc: 0.783 Test Loss: 0.413 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 27 cost time: 2.9240505695343018
Epoch: 27, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.422 Vali Acc: 0.789 Test Loss: 0.422 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 28 cost time: 3.1998281478881836
Epoch: 28, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.403 Vali Acc: 0.783 Test Loss: 0.403 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2242560386657715
Epoch: 29, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.398 Vali Acc: 0.794 Test Loss: 0.398 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794440).  Saving model ...
Epoch: 30 cost time: 3.2598469257354736
Epoch: 30, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.385 Vali Acc: 0.800 Test Loss: 0.385 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 31 cost time: 3.508749485015869
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 32 cost time: 3.481049060821533
Epoch: 32, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 33 cost time: 3.500976085662842
Epoch: 33, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0899698734283447
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 35 cost time: 3.1585848331451416
Epoch: 35, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2246367931365967
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 37 cost time: 3.128039836883545
Epoch: 37, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 38 cost time: 3.3260750770568848
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 39 cost time: 3.394941568374634
Epoch: 39, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.324434757232666
Epoch: 40, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.2008323669433594
Epoch: 41, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 2.9669532775878906
Epoch: 42, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.0850412845611572
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.104440689086914
Epoch: 44, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.3479676246643066
Epoch: 45, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.2267067432403564
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.3647215366363525
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.406379461288452
Epoch: 48, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.2429330348968506
Epoch: 49, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 50 cost time: 3.4105095863342285
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 3.2509076595306396
Epoch: 51, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.3951828479766846
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 3.3968355655670166
Epoch: 53, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.5481865406036377
Epoch: 54, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.288302421569824
Epoch: 55, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.304448366165161
Epoch: 56, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.1420960426330566
Epoch: 57, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.1721951961517334
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.745757579803467
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.653834342956543
Epoch: 60, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.2702112197875977
Epoch: 61, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.366189479827881
Epoch: 62, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.866801500320435
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 3.398517370223999
Epoch: 2, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.830 Vali Acc: 0.222 Test Loss: 1.830 Test Acc: 0.222
Validation loss decreased (-0.177759 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 3.3956987857818604
Epoch: 3, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.787 Vali Acc: 0.261 Test Loss: 1.787 Test Acc: 0.261
Validation loss decreased (-0.222204 --> -0.261093).  Saving model ...
Epoch: 4 cost time: 3.1297125816345215
Epoch: 4, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.741 Vali Acc: 0.289 Test Loss: 1.741 Test Acc: 0.289
Validation loss decreased (-0.261093 --> -0.288871).  Saving model ...
Epoch: 5 cost time: 3.092400074005127
Epoch: 5, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.698 Vali Acc: 0.300 Test Loss: 1.698 Test Acc: 0.300
Validation loss decreased (-0.288871 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 3.28214955329895
Epoch: 6, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.649 Vali Acc: 0.283 Test Loss: 1.649 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2000954151153564
Epoch: 7, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.600 Vali Acc: 0.283 Test Loss: 1.600 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4634578227996826
Epoch: 8, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.525 Vali Acc: 0.328 Test Loss: 1.525 Test Acc: 0.328
Validation loss decreased (-0.299983 --> -0.327763).  Saving model ...
Epoch: 9 cost time: 3.44083309173584
Epoch: 9, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.453 Vali Acc: 0.367 Test Loss: 1.453 Test Acc: 0.367
Validation loss decreased (-0.327763 --> -0.366652).  Saving model ...
Epoch: 10 cost time: 3.607274055480957
Epoch: 10, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.351 Vali Acc: 0.417 Test Loss: 1.351 Test Acc: 0.417
Validation loss decreased (-0.366652 --> -0.416653).  Saving model ...
Epoch: 11 cost time: 3.184532403945923
Epoch: 11, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.217 Vali Acc: 0.433 Test Loss: 1.217 Test Acc: 0.433
Validation loss decreased (-0.416653 --> -0.433321).  Saving model ...
Epoch: 12 cost time: 3.0014240741729736
Epoch: 12, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.070 Vali Acc: 0.517 Test Loss: 1.070 Test Acc: 0.517
Validation loss decreased (-0.433321 --> -0.516656).  Saving model ...
Epoch: 13 cost time: 3.1214566230773926
Epoch: 13, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.933 Vali Acc: 0.572 Test Loss: 0.933 Test Acc: 0.572
Validation loss decreased (-0.516656 --> -0.572213).  Saving model ...
Epoch: 14 cost time: 3.024599075317383
Epoch: 14, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.848 Vali Acc: 0.622 Test Loss: 0.848 Test Acc: 0.622
Validation loss decreased (-0.572213 --> -0.622214).  Saving model ...
Epoch: 15 cost time: 3.039212942123413
Epoch: 15, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.795 Vali Acc: 0.628 Test Loss: 0.795 Test Acc: 0.628
Validation loss decreased (-0.622214 --> -0.627770).  Saving model ...
Epoch: 16 cost time: 3.4024786949157715
Epoch: 16, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.734 Vali Acc: 0.656 Test Loss: 0.734 Test Acc: 0.656
Validation loss decreased (-0.627770 --> -0.655548).  Saving model ...
Epoch: 17 cost time: 3.414982795715332
Epoch: 17, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.672 Vali Acc: 0.661 Test Loss: 0.672 Test Acc: 0.661
Validation loss decreased (-0.655548 --> -0.661104).  Saving model ...
Epoch: 18 cost time: 3.4703078269958496
Epoch: 18, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.623 Vali Acc: 0.700 Test Loss: 0.623 Test Acc: 0.700
Validation loss decreased (-0.661104 --> -0.699994).  Saving model ...
Epoch: 19 cost time: 3.170234203338623
Epoch: 19, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.699994 --> -0.716661).  Saving model ...
Epoch: 20 cost time: 3.3386359214782715
Epoch: 20, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
Validation loss decreased (-0.716661 --> -0.722217).  Saving model ...
Epoch: 21 cost time: 3.414376735687256
Epoch: 21, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
Validation loss decreased (-0.722217 --> -0.788884).  Saving model ...
Epoch: 22 cost time: 3.4225072860717773
Epoch: 22, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.472 Vali Acc: 0.783 Test Loss: 0.472 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7751657962799072
Epoch: 23, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 24 cost time: 3.8874688148498535
Epoch: 24, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 25 cost time: 3.7214250564575195
Epoch: 25, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4249112606048584
Epoch: 26, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.401 Vali Acc: 0.811 Test Loss: 0.401 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 27 cost time: 3.3531992435455322
Epoch: 27, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.419 Vali Acc: 0.817 Test Loss: 0.419 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 28 cost time: 3.4918019771575928
Epoch: 28, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 29 cost time: 3.2485103607177734
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 30 cost time: 3.3233067989349365
Epoch: 30, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 31 cost time: 3.503803253173828
Epoch: 31, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5399560928344727
Epoch: 32, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4344420433044434
Epoch: 33, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.5124049186706543
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.961602210998535
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.1401493549346924
Epoch: 36, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 37 cost time: 3.026762008666992
Epoch: 37, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 38 cost time: 3.370521068572998
Epoch: 38, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 39 cost time: 3.537186861038208
Epoch: 39, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.846623420715332
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.579756736755371
Epoch: 41, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905552).  Saving model ...
Epoch: 42 cost time: 3.4461140632629395
Epoch: 42, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.0576770305633545
Epoch: 43, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1596035957336426
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 45 cost time: 3.5954642295837402
Epoch: 45, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.4909212589263916
Epoch: 46, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.4847252368927
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.233792304992676
Epoch: 48, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.1368722915649414
Epoch: 49, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 2.878364324569702
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.0478761196136475
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.2172958850860596
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.534219980239868
Epoch: 53, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.5986287593841553
Epoch: 54, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 3.3845367431640625
Epoch: 55, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.4263546466827393
Epoch: 56, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.2644824981689453
Epoch: 57, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.258568048477173
Epoch: 58, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.425435781478882
Epoch: 59, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.3748786449432373
Epoch: 60, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.2954280376434326
Epoch: 61, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.368140697479248
Epoch: 62, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.6838064193725586
Epoch: 63, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.4696850776672363
Epoch: 64, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4137725830078125
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.847 Vali Acc: 0.133 Test Loss: 1.847 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 3.128018617630005
Epoch: 2, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.827 Vali Acc: 0.150 Test Loss: 1.827 Test Acc: 0.150
Validation loss decreased (-0.133315 --> -0.149982).  Saving model ...
Epoch: 3 cost time: 3.279547929763794
Epoch: 3, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.802 Vali Acc: 0.178 Test Loss: 1.802 Test Acc: 0.178
Validation loss decreased (-0.149982 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 3.216242551803589
Epoch: 4, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.774 Vali Acc: 0.228 Test Loss: 1.774 Test Acc: 0.228
Validation loss decreased (-0.177760 --> -0.227760).  Saving model ...
Epoch: 5 cost time: 3.458986282348633
Epoch: 5, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.746 Vali Acc: 0.250 Test Loss: 1.746 Test Acc: 0.250
Validation loss decreased (-0.227760 --> -0.249983).  Saving model ...
Epoch: 6 cost time: 2.9680349826812744
Epoch: 6, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.711 Vali Acc: 0.261 Test Loss: 1.711 Test Acc: 0.261
Validation loss decreased (-0.249983 --> -0.261094).  Saving model ...
Epoch: 7 cost time: 2.922325372695923
Epoch: 7, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.670 Vali Acc: 0.283 Test Loss: 1.670 Test Acc: 0.283
Validation loss decreased (-0.261094 --> -0.283317).  Saving model ...
Epoch: 8 cost time: 2.8476619720458984
Epoch: 8, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.613 Vali Acc: 0.300 Test Loss: 1.613 Test Acc: 0.300
Validation loss decreased (-0.283317 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 2.794673204421997
Epoch: 9, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.539 Vali Acc: 0.356 Test Loss: 1.539 Test Acc: 0.356
Validation loss decreased (-0.299984 --> -0.355540).  Saving model ...
Epoch: 10 cost time: 3.330859422683716
Epoch: 10, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.429 Vali Acc: 0.411 Test Loss: 1.429 Test Acc: 0.411
Validation loss decreased (-0.355540 --> -0.411097).  Saving model ...
Epoch: 11 cost time: 3.1906867027282715
Epoch: 11, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.267 Vali Acc: 0.528 Test Loss: 1.267 Test Acc: 0.528
Validation loss decreased (-0.411097 --> -0.527765).  Saving model ...
Epoch: 12 cost time: 3.448162317276001
Epoch: 12, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.084 Vali Acc: 0.572 Test Loss: 1.084 Test Acc: 0.572
Validation loss decreased (-0.527765 --> -0.572211).  Saving model ...
Epoch: 13 cost time: 3.159827709197998
Epoch: 13, Steps: 12 | Train Loss: 1.006 Vali Loss: 0.926 Vali Acc: 0.578 Test Loss: 0.926 Test Acc: 0.578
Validation loss decreased (-0.572211 --> -0.577769).  Saving model ...
Epoch: 14 cost time: 3.129305124282837
Epoch: 14, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.857 Vali Acc: 0.567 Test Loss: 0.857 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1158347129821777
Epoch: 15, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.821 Vali Acc: 0.589 Test Loss: 0.821 Test Acc: 0.589
Validation loss decreased (-0.577769 --> -0.588881).  Saving model ...
Epoch: 16 cost time: 3.165745258331299
Epoch: 16, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.765 Vali Acc: 0.611 Test Loss: 0.765 Test Acc: 0.611
Validation loss decreased (-0.588881 --> -0.611103).  Saving model ...
Epoch: 17 cost time: 3.3446319103240967
Epoch: 17, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.699 Vali Acc: 0.644 Test Loss: 0.699 Test Acc: 0.644
Validation loss decreased (-0.611103 --> -0.644437).  Saving model ...
Epoch: 18 cost time: 3.2901055812835693
Epoch: 18, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.666 Vali Acc: 0.644 Test Loss: 0.666 Test Acc: 0.644
Validation loss decreased (-0.644437 --> -0.644438).  Saving model ...
Epoch: 19 cost time: 3.1906707286834717
Epoch: 19, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.625 Vali Acc: 0.689 Test Loss: 0.625 Test Acc: 0.689
Validation loss decreased (-0.644438 --> -0.688883).  Saving model ...
Epoch: 20 cost time: 2.8393537998199463
Epoch: 20, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.576 Vali Acc: 0.739 Test Loss: 0.576 Test Acc: 0.739
Validation loss decreased (-0.688883 --> -0.738883).  Saving model ...
Epoch: 21 cost time: 2.938187599182129
Epoch: 21, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 22 cost time: 3.1353423595428467
Epoch: 22, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.476 Vali Acc: 0.767 Test Loss: 0.476 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 23 cost time: 2.795293092727661
Epoch: 23, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.439 Vali Acc: 0.744 Test Loss: 0.439 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.212709665298462
Epoch: 24, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.417 Vali Acc: 0.756 Test Loss: 0.417 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.169736385345459
Epoch: 25, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.398 Vali Acc: 0.772 Test Loss: 0.398 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 26 cost time: 3.2520761489868164
Epoch: 26, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.377 Vali Acc: 0.778 Test Loss: 0.377 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777774).  Saving model ...
Epoch: 27 cost time: 2.883624315261841
Epoch: 27, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.365 Vali Acc: 0.789 Test Loss: 0.365 Test Acc: 0.789
Validation loss decreased (-0.777774 --> -0.788885).  Saving model ...
Epoch: 28 cost time: 3.0519216060638428
Epoch: 28, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.346 Vali Acc: 0.783 Test Loss: 0.346 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2058839797973633
Epoch: 29, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.338 Vali Acc: 0.789 Test Loss: 0.338 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788886).  Saving model ...
Epoch: 30 cost time: 3.5361831188201904
Epoch: 30, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.323 Vali Acc: 0.817 Test Loss: 0.323 Test Acc: 0.817
Validation loss decreased (-0.788886 --> -0.816663).  Saving model ...
Epoch: 31 cost time: 3.579354763031006
Epoch: 31, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.317 Vali Acc: 0.822 Test Loss: 0.317 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 32 cost time: 3.43941068649292
Epoch: 32, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 33 cost time: 3.1407220363616943
Epoch: 33, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.030229091644287
Epoch: 34, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 35 cost time: 3.080815076828003
Epoch: 35, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.315 Vali Acc: 0.822 Test Loss: 0.315 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.150390625
Epoch: 36, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.283 Vali Acc: 0.844 Test Loss: 0.283 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844442).  Saving model ...
Epoch: 37 cost time: 3.3386776447296143
Epoch: 37, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.288 Vali Acc: 0.828 Test Loss: 0.288 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2474708557128906
Epoch: 38, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.844442 --> -0.877775).  Saving model ...
Epoch: 39 cost time: 3.2509591579437256
Epoch: 39, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.256 Vali Acc: 0.867 Test Loss: 0.256 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.716888904571533
Epoch: 40, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.271 Vali Acc: 0.861 Test Loss: 0.271 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.8974814414978027
Epoch: 41, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.195 Vali Acc: 0.906 Test Loss: 0.195 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905554).  Saving model ...
Epoch: 42 cost time: 2.8094661235809326
Epoch: 42, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.9905641078948975
Epoch: 43, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.3865320682525635
Epoch: 44, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.194 Vali Acc: 0.894 Test Loss: 0.194 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.2145063877105713
Epoch: 45, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.974750280380249
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.026801109313965
Epoch: 47, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
Validation loss decreased (-0.905554 --> -0.927776).  Saving model ...
Epoch: 48 cost time: 3.0549216270446777
Epoch: 48, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.204 Vali Acc: 0.889 Test Loss: 0.204 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.1056110858917236
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.928 Test Loss: 0.165 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 50 cost time: 3.320859909057617
Epoch: 50, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.248077392578125
Epoch: 51, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.268732786178589
Epoch: 52, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.077843189239502
Epoch: 53, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.075096607208252
Epoch: 54, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.9943044185638428
Epoch: 55, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.1937267780303955
Epoch: 56, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.272603750228882
Epoch: 57, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.482841730117798
Epoch: 58, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 59 cost time: 3.255385160446167
Epoch: 59, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.928 Test Loss: 0.161 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.1624183654785156
Epoch: 60, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.928 Test Loss: 0.161 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.016295909881592
Epoch: 61, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.1715025901794434
Epoch: 62, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.032898187637329
Epoch: 63, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.290839433670044
Epoch: 64, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.229962110519409
Epoch: 65, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.246971368789673
Epoch: 66, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.081197500228882
Epoch: 67, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.1531553268432617
Epoch: 68, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.047598600387573
Epoch: 1, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.832 Vali Acc: 0.178 Test Loss: 1.832 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 3.316579818725586
Epoch: 2, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.814 Vali Acc: 0.189 Test Loss: 1.814 Test Acc: 0.189
Validation loss decreased (-0.177759 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 3.081037998199463
Epoch: 3, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.785 Vali Acc: 0.233 Test Loss: 1.785 Test Acc: 0.233
Validation loss decreased (-0.188871 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 3.078507661819458
Epoch: 4, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.749 Vali Acc: 0.256 Test Loss: 1.749 Test Acc: 0.256
Validation loss decreased (-0.233315 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 3.084775686264038
Epoch: 5, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.696 Vali Acc: 0.294 Test Loss: 1.696 Test Acc: 0.294
Validation loss decreased (-0.255538 --> -0.294427).  Saving model ...
Epoch: 6 cost time: 2.9265310764312744
Epoch: 6, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.628 Vali Acc: 0.361 Test Loss: 1.628 Test Acc: 0.361
Validation loss decreased (-0.294427 --> -0.361095).  Saving model ...
Epoch: 7 cost time: 3.2142446041107178
Epoch: 7, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.541 Vali Acc: 0.394 Test Loss: 1.541 Test Acc: 0.394
Validation loss decreased (-0.361095 --> -0.394429).  Saving model ...
Epoch: 8 cost time: 3.1937098503112793
Epoch: 8, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.439 Vali Acc: 0.506 Test Loss: 1.439 Test Acc: 0.506
Validation loss decreased (-0.394429 --> -0.505541).  Saving model ...
Epoch: 9 cost time: 2.9800190925598145
Epoch: 9, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.311 Vali Acc: 0.533 Test Loss: 1.311 Test Acc: 0.533
Validation loss decreased (-0.505541 --> -0.533320).  Saving model ...
Epoch: 10 cost time: 2.8417060375213623
Epoch: 10, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.182 Vali Acc: 0.539 Test Loss: 1.182 Test Acc: 0.539
Validation loss decreased (-0.533320 --> -0.538877).  Saving model ...
Epoch: 11 cost time: 3.08721661567688
Epoch: 11, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.538877 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 3.027712106704712
Epoch: 12, Steps: 12 | Train Loss: 1.022 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3918824195861816
Epoch: 13, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.906 Vali Acc: 0.567 Test Loss: 0.906 Test Acc: 0.567
Validation loss decreased (-0.549989 --> -0.566658).  Saving model ...
Epoch: 14 cost time: 3.3037209510803223
Epoch: 14, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.869 Vali Acc: 0.578 Test Loss: 0.869 Test Acc: 0.578
Validation loss decreased (-0.566658 --> -0.577769).  Saving model ...
Epoch: 15 cost time: 3.3469278812408447
Epoch: 15, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.839 Vali Acc: 0.600 Test Loss: 0.839 Test Acc: 0.600
Validation loss decreased (-0.577769 --> -0.599992).  Saving model ...
Epoch: 16 cost time: 3.0364856719970703
Epoch: 16, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.744 Vali Acc: 0.622 Test Loss: 0.744 Test Acc: 0.622
Validation loss decreased (-0.599992 --> -0.622215).  Saving model ...
Epoch: 17 cost time: 3.099092721939087
Epoch: 17, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.661 Vali Acc: 0.694 Test Loss: 0.661 Test Acc: 0.694
Validation loss decreased (-0.622215 --> -0.694438).  Saving model ...
Epoch: 18 cost time: 3.0886666774749756
Epoch: 18, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.595 Vali Acc: 0.728 Test Loss: 0.595 Test Acc: 0.728
Validation loss decreased (-0.694438 --> -0.727772).  Saving model ...
Epoch: 19 cost time: 3.519486665725708
Epoch: 19, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.534 Vali Acc: 0.772 Test Loss: 0.534 Test Acc: 0.772
Validation loss decreased (-0.727772 --> -0.772217).  Saving model ...
Epoch: 20 cost time: 3.438582181930542
Epoch: 20, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.500 Vali Acc: 0.761 Test Loss: 0.500 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6178905963897705
Epoch: 21, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 22 cost time: 3.3122401237487793
Epoch: 22, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 23 cost time: 3.3182172775268555
Epoch: 23, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 3.051325798034668
Epoch: 24, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5471181869506836
Epoch: 25, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.342 Vali Acc: 0.811 Test Loss: 0.342 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3673760890960693
Epoch: 26, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 3.373695135116577
Epoch: 27, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.349 Vali Acc: 0.822 Test Loss: 0.349 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8749144077301025
Epoch: 28, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 29 cost time: 2.9174365997314453
Epoch: 29, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9836528301239014
Epoch: 30, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 31 cost time: 2.711463212966919
Epoch: 31, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 32 cost time: 2.9861881732940674
Epoch: 32, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.286 Vali Acc: 0.811 Test Loss: 0.286 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1491618156433105
Epoch: 33, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.281 Vali Acc: 0.822 Test Loss: 0.281 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.0830204486846924
Epoch: 34, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.272 Vali Acc: 0.839 Test Loss: 0.272 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 35 cost time: 3.253451347351074
Epoch: 35, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.271 Vali Acc: 0.844 Test Loss: 0.271 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844442).  Saving model ...
Epoch: 36 cost time: 3.5282599925994873
Epoch: 36, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.283 Vali Acc: 0.828 Test Loss: 0.283 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.450242280960083
Epoch: 37, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.634505271911621
Epoch: 38, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.257 Vali Acc: 0.856 Test Loss: 0.257 Test Acc: 0.856
Validation loss decreased (-0.844442 --> -0.855553).  Saving model ...
Epoch: 39 cost time: 3.0217981338500977
Epoch: 39, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.256 Vali Acc: 0.856 Test Loss: 0.256 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 40 cost time: 3.023120880126953
Epoch: 40, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.241 Vali Acc: 0.861 Test Loss: 0.241 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861109).  Saving model ...
Epoch: 41 cost time: 2.982741594314575
Epoch: 41, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
Validation loss decreased (-0.861109 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 3.320770502090454
Epoch: 42, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.240 Vali Acc: 0.861 Test Loss: 0.240 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.3355305194854736
Epoch: 43, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 44 cost time: 3.4067420959472656
Epoch: 44, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 45 cost time: 2.9837982654571533
Epoch: 45, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.000962495803833
Epoch: 46, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.190 Vali Acc: 0.906 Test Loss: 0.190 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905554).  Saving model ...
Epoch: 47 cost time: 2.941422462463379
Epoch: 47, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.208 Vali Acc: 0.894 Test Loss: 0.208 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.3376410007476807
Epoch: 48, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916665).  Saving model ...
Epoch: 49 cost time: 3.2292191982269287
Epoch: 49, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.180 Vali Acc: 0.906 Test Loss: 0.180 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.0624921321868896
Epoch: 50, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.880134105682373
Epoch: 51, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 52 cost time: 2.9725985527038574
Epoch: 52, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.180 Vali Acc: 0.911 Test Loss: 0.180 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.9238688945770264
Epoch: 53, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.2765586376190186
Epoch: 54, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.2691972255706787
Epoch: 55, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.338937759399414
Epoch: 56, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.938791036605835
Epoch: 57, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.0996382236480713
Epoch: 58, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 3.3579723834991455
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 3.5872511863708496
Epoch: 60, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.6567938327789307
Epoch: 61, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.197786569595337
Epoch: 62, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.159693956375122
Epoch: 63, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.8518154621124268
Epoch: 64, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.296001672744751
Epoch: 65, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.306621789932251
Epoch: 66, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 3.4566025733947754
Epoch: 67, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.992525100708008
Epoch: 68, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 2.7844159603118896
Epoch: 69, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.019931077957153
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.844 Vali Acc: 0.100 Test Loss: 1.844 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 3.282663106918335
Epoch: 2, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.829 Vali Acc: 0.111 Test Loss: 1.829 Test Acc: 0.111
Validation loss decreased (-0.099982 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 3.177062749862671
Epoch: 3, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.807 Vali Acc: 0.128 Test Loss: 1.807 Test Acc: 0.128
Validation loss decreased (-0.111093 --> -0.127760).  Saving model ...
Epoch: 4 cost time: 3.272918224334717
Epoch: 4, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.777 Vali Acc: 0.189 Test Loss: 1.777 Test Acc: 0.189
Validation loss decreased (-0.127760 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 3.550930976867676
Epoch: 5, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.733 Vali Acc: 0.222 Test Loss: 1.733 Test Acc: 0.222
Validation loss decreased (-0.188871 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 3.3715829849243164
Epoch: 6, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.670 Vali Acc: 0.272 Test Loss: 1.670 Test Acc: 0.272
Validation loss decreased (-0.222205 --> -0.272206).  Saving model ...
Epoch: 7 cost time: 3.1528499126434326
Epoch: 7, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.584 Vali Acc: 0.344 Test Loss: 1.584 Test Acc: 0.344
Validation loss decreased (-0.272206 --> -0.344429).  Saving model ...
Epoch: 8 cost time: 3.1573612689971924
Epoch: 8, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.470 Vali Acc: 0.461 Test Loss: 1.470 Test Acc: 0.461
Validation loss decreased (-0.344429 --> -0.461096).  Saving model ...
Epoch: 9 cost time: 3.3749096393585205
Epoch: 9, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.334 Vali Acc: 0.528 Test Loss: 1.334 Test Acc: 0.528
Validation loss decreased (-0.461096 --> -0.527764).  Saving model ...
Epoch: 10 cost time: 3.809818744659424
Epoch: 10, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.194 Vali Acc: 0.556 Test Loss: 1.194 Test Acc: 0.556
Validation loss decreased (-0.527764 --> -0.555544).  Saving model ...
Epoch: 11 cost time: 3.564892292022705
Epoch: 11, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.060 Vali Acc: 0.539 Test Loss: 1.060 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5132782459259033
Epoch: 12, Steps: 12 | Train Loss: 1.103 Vali Loss: 0.982 Vali Acc: 0.522 Test Loss: 0.982 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.125619649887085
Epoch: 13, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.936 Vali Acc: 0.517 Test Loss: 0.936 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.139955759048462
Epoch: 14, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.910 Vali Acc: 0.561 Test Loss: 0.910 Test Acc: 0.561
Validation loss decreased (-0.555544 --> -0.561102).  Saving model ...
Epoch: 15 cost time: 3.251239538192749
Epoch: 15, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.890 Vali Acc: 0.589 Test Loss: 0.890 Test Acc: 0.589
Validation loss decreased (-0.561102 --> -0.588880).  Saving model ...
Epoch: 16 cost time: 3.4477715492248535
Epoch: 16, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.822 Vali Acc: 0.578 Test Loss: 0.822 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5439605712890625
Epoch: 17, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.728 Vali Acc: 0.656 Test Loss: 0.728 Test Acc: 0.656
Validation loss decreased (-0.588880 --> -0.655548).  Saving model ...
Epoch: 18 cost time: 2.9911251068115234
Epoch: 18, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.662 Vali Acc: 0.633 Test Loss: 0.662 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.280557632446289
Epoch: 19, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (-0.655548 --> -0.722216).  Saving model ...
Epoch: 20 cost time: 2.95832896232605
Epoch: 20, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.530 Vali Acc: 0.739 Test Loss: 0.530 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738884).  Saving model ...
Epoch: 21 cost time: 3.5777668952941895
Epoch: 21, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.449 Vali Acc: 0.756 Test Loss: 0.449 Test Acc: 0.756
Validation loss decreased (-0.738884 --> -0.755551).  Saving model ...
Epoch: 22 cost time: 3.407653331756592
Epoch: 22, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.415 Vali Acc: 0.778 Test Loss: 0.415 Test Acc: 0.778
Validation loss decreased (-0.755551 --> -0.777774).  Saving model ...
Epoch: 23 cost time: 3.41629958152771
Epoch: 23, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.397 Vali Acc: 0.778 Test Loss: 0.397 Test Acc: 0.778
Validation loss decreased (-0.777774 --> -0.777774).  Saving model ...
Epoch: 24 cost time: 3.1685009002685547
Epoch: 24, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.368 Vali Acc: 0.800 Test Loss: 0.368 Test Acc: 0.800
Validation loss decreased (-0.777774 --> -0.799996).  Saving model ...
Epoch: 25 cost time: 3.2015163898468018
Epoch: 25, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.362 Vali Acc: 0.800 Test Loss: 0.362 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 26 cost time: 3.534848690032959
Epoch: 26, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.357 Vali Acc: 0.800 Test Loss: 0.357 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 27 cost time: 3.656531572341919
Epoch: 27, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.356 Vali Acc: 0.806 Test Loss: 0.356 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 28 cost time: 3.6193413734436035
Epoch: 28, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.328 Vali Acc: 0.817 Test Loss: 0.328 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 29 cost time: 3.3176767826080322
Epoch: 29, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 30 cost time: 3.312727451324463
Epoch: 30, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.319 Vali Acc: 0.811 Test Loss: 0.319 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3983376026153564
Epoch: 31, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.316 Vali Acc: 0.817 Test Loss: 0.316 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6315417289733887
Epoch: 32, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.309 Vali Acc: 0.822 Test Loss: 0.309 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 33 cost time: 3.9000244140625
Epoch: 33, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.310 Vali Acc: 0.822 Test Loss: 0.310 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.7043840885162354
Epoch: 34, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.311 Vali Acc: 0.811 Test Loss: 0.311 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.122312545776367
Epoch: 35, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.299 Vali Acc: 0.811 Test Loss: 0.299 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.1665220260620117
Epoch: 36, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.315 Vali Acc: 0.822 Test Loss: 0.315 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.181070566177368
Epoch: 37, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.303 Vali Acc: 0.833 Test Loss: 0.303 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 38 cost time: 3.1822237968444824
Epoch: 38, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.289 Vali Acc: 0.839 Test Loss: 0.289 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 39 cost time: 3.2893245220184326
Epoch: 39, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855553).  Saving model ...
Epoch: 40 cost time: 3.851539134979248
Epoch: 40, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 41 cost time: 3.5495872497558594
Epoch: 41, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 42 cost time: 3.5052192211151123
Epoch: 42, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 43 cost time: 3.3795623779296875
Epoch: 43, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 3.604715347290039
Epoch: 44, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.256 Vali Acc: 0.856 Test Loss: 0.256 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.7348148822784424
Epoch: 45, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.4316952228546143
Epoch: 46, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.4458746910095215
Epoch: 47, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4019367694854736
Epoch: 48, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 49 cost time: 3.522644281387329
Epoch: 49, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.5751729011535645
Epoch: 50, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 51 cost time: 3.2096893787384033
Epoch: 51, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.434980630874634
Epoch: 52, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.618630886077881
Epoch: 53, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.6145761013031006
Epoch: 54, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 55 cost time: 3.1177103519439697
Epoch: 55, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.2829136848449707
Epoch: 56, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.4565069675445557
Epoch: 57, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 4.173848867416382
Epoch: 58, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.7993297576904297
Epoch: 59, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 3.6422054767608643
Epoch: 60, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.7159841060638428
Epoch: 61, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.773688554763794
Epoch: 62, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.7005093097686768
Epoch: 63, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 64 cost time: 3.895906448364258
Epoch: 64, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.4687373638153076
Epoch: 65, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.4569966793060303
Epoch: 66, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 3.7886126041412354
Epoch: 67, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.747744083404541
Epoch: 68, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.429 Vali Acc: 0.906 Test Loss: 0.429 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 3.709833860397339
Epoch: 69, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 3.233492851257324
Epoch: 70, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 71 cost time: 3.5296990871429443
Epoch: 71, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.899050235748291
Epoch: 72, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.829284191131592
Epoch: 73, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.3384292125701904
Epoch: 74, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.927775 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 3.261753559112549
Epoch: 75, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 76 cost time: 3.7322208881378174
Epoch: 76, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.604825019836426
Epoch: 77, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.922 Test Loss: 0.163 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.713373899459839
Epoch: 78, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.523070812225342
Epoch: 79, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 3.282602071762085
Epoch: 80, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 3.9762332439422607
Epoch: 81, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 3.868669271469116
Epoch: 82, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 3.5737171173095703
Epoch: 83, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 3.2505080699920654
Epoch: 84, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 2.938671350479126
Epoch: 85, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.328 Vali Acc: 0.928 Test Loss: 0.328 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5155417919158936
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.2166879177093506
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3848581314086914
Epoch: 3, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.582628011703491
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 3.018636703491211
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 3.220012664794922
Epoch: 6, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.004404306411743
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7139511108398438
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.743330478668213
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6830694675445557
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 3.266791582107544
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 3.2737605571746826
Epoch: 12, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.413516044616699
Epoch: 13, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 2.9985804557800293
Epoch: 14, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.251713275909424
Epoch: 15, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.865049123764038
Epoch: 16, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.868326425552368
Epoch: 17, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9597644805908203
Epoch: 18, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8814823627471924
Epoch: 19, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7805864810943604
Epoch: 20, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 2.9400219917297363
Epoch: 21, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 2.9108188152313232
Epoch: 22, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 3.0878145694732666
Epoch: 23, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.551426649093628
Epoch: 24, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.795865297317505
Epoch: 25, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.257333278656006
Epoch: 26, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.2251718044281006
Epoch: 27, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.359907865524292
Epoch: 28, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.065373659133911
Epoch: 29, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.1876068115234375
Epoch: 30, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.4388315677642822
Epoch: 31, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.1085445880889893
Epoch: 32, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 140902
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.737633943557739
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.755 Vali Acc: 0.244 Test Loss: 1.755 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 2.869375228881836
Epoch: 2, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.674 Vali Acc: 0.361 Test Loss: 1.674 Test Acc: 0.361
Validation loss decreased (-0.244427 --> -0.361094).  Saving model ...
Epoch: 3 cost time: 3.352975368499756
Epoch: 3, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.575 Vali Acc: 0.439 Test Loss: 1.575 Test Acc: 0.439
Validation loss decreased (-0.361094 --> -0.438873).  Saving model ...
Epoch: 4 cost time: 3.11104154586792
Epoch: 4, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.476 Vali Acc: 0.467 Test Loss: 1.476 Test Acc: 0.467
Validation loss decreased (-0.438873 --> -0.466652).  Saving model ...
Epoch: 5 cost time: 3.5103719234466553
Epoch: 5, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.380 Vali Acc: 0.483 Test Loss: 1.380 Test Acc: 0.483
Validation loss decreased (-0.466652 --> -0.483320).  Saving model ...
Epoch: 6 cost time: 3.135835886001587
Epoch: 6, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.289 Vali Acc: 0.544 Test Loss: 1.289 Test Acc: 0.544
Validation loss decreased (-0.483320 --> -0.544432).  Saving model ...
Epoch: 7 cost time: 3.3562517166137695
Epoch: 7, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.211 Vali Acc: 0.561 Test Loss: 1.211 Test Acc: 0.561
Validation loss decreased (-0.544432 --> -0.561099).  Saving model ...
Epoch: 8 cost time: 3.2426609992980957
Epoch: 8, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.561099 --> -0.572211).  Saving model ...
Epoch: 9 cost time: 3.465881109237671
Epoch: 9, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.065 Vali Acc: 0.594 Test Loss: 1.065 Test Acc: 0.594
Validation loss decreased (-0.572211 --> -0.594434).  Saving model ...
Epoch: 10 cost time: 3.437944173812866
Epoch: 10, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.996 Vali Acc: 0.594 Test Loss: 0.996 Test Acc: 0.594
Validation loss decreased (-0.594434 --> -0.594434).  Saving model ...
Epoch: 11 cost time: 3.0663506984710693
Epoch: 11, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
Validation loss decreased (-0.594434 --> -0.622213).  Saving model ...
Epoch: 12 cost time: 2.9935879707336426
Epoch: 12, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.858 Vali Acc: 0.633 Test Loss: 0.858 Test Acc: 0.633
Validation loss decreased (-0.622213 --> -0.633325).  Saving model ...
Epoch: 13 cost time: 3.012636184692383
Epoch: 13, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.794 Vali Acc: 0.650 Test Loss: 0.794 Test Acc: 0.650
Validation loss decreased (-0.633325 --> -0.649992).  Saving model ...
Epoch: 14 cost time: 3.32820725440979
Epoch: 14, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.743 Vali Acc: 0.656 Test Loss: 0.743 Test Acc: 0.656
Validation loss decreased (-0.649992 --> -0.655548).  Saving model ...
Epoch: 15 cost time: 3.52901291847229
Epoch: 15, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.686 Vali Acc: 0.689 Test Loss: 0.686 Test Acc: 0.689
Validation loss decreased (-0.655548 --> -0.688882).  Saving model ...
Epoch: 16 cost time: 3.11958384513855
Epoch: 16, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.643 Vali Acc: 0.706 Test Loss: 0.643 Test Acc: 0.706
Validation loss decreased (-0.688882 --> -0.705549).  Saving model ...
Epoch: 17 cost time: 3.3420937061309814
Epoch: 17, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722216).  Saving model ...
Epoch: 18 cost time: 3.474416494369507
Epoch: 18, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.557 Vali Acc: 0.733 Test Loss: 0.557 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 19 cost time: 3.6676604747772217
Epoch: 19, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.545 Vali Acc: 0.772 Test Loss: 0.545 Test Acc: 0.772
Validation loss decreased (-0.733328 --> -0.772217).  Saving model ...
Epoch: 20 cost time: 3.34761905670166
Epoch: 20, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.494 Vali Acc: 0.761 Test Loss: 0.494 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6479201316833496
Epoch: 21, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.481 Vali Acc: 0.783 Test Loss: 0.481 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 22 cost time: 3.6533961296081543
Epoch: 22, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.449 Vali Acc: 0.789 Test Loss: 0.449 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788884).  Saving model ...
Epoch: 23 cost time: 2.932415008544922
Epoch: 23, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.426 Vali Acc: 0.794 Test Loss: 0.426 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 24 cost time: 3.2740252017974854
Epoch: 24, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.414 Vali Acc: 0.806 Test Loss: 0.414 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 25 cost time: 3.0394115447998047
Epoch: 25, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 26 cost time: 3.0804502964019775
Epoch: 26, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4670228958129883
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.380 Vali Acc: 0.839 Test Loss: 0.380 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 3.357529878616333
Epoch: 28, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 3.960963726043701
Epoch: 29, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.360 Vali Acc: 0.856 Test Loss: 0.360 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 3.2948577404022217
Epoch: 30, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3035030364990234
Epoch: 31, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 32 cost time: 3.6174874305725098
Epoch: 32, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3770365715026855
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.663386583328247
Epoch: 34, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 3.7627594470977783
Epoch: 35, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 36 cost time: 3.6675784587860107
Epoch: 36, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 37 cost time: 3.0845866203308105
Epoch: 37, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 38 cost time: 2.8803722858428955
Epoch: 38, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.959848165512085
Epoch: 39, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 3.0783894062042236
Epoch: 40, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.271 Vali Acc: 0.856 Test Loss: 0.271 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4604220390319824
Epoch: 41, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.273 Vali Acc: 0.867 Test Loss: 0.273 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.588200807571411
Epoch: 42, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.293166160583496
Epoch: 43, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.12351131439209
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.3120267391204834
Epoch: 45, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.4962315559387207
Epoch: 46, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.253 Vali Acc: 0.883 Test Loss: 0.253 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.4646856784820557
Epoch: 47, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 3.424283742904663
Epoch: 48, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 49 cost time: 3.173487663269043
Epoch: 49, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 50 cost time: 3.542400598526001
Epoch: 50, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.1239044666290283
Epoch: 51, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.2584309577941895
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.19562029838562
Epoch: 53, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.883 Test Loss: 0.222 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.037461042404175
Epoch: 54, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 55 cost time: 2.852975368499756
Epoch: 55, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.2994048595428467
Epoch: 56, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.9561104774475098
Epoch: 57, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.024400472640991
Epoch: 58, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.1735923290252686
Epoch: 59, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.19496488571167
Epoch: 60, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 61 cost time: 3.175217628479004
Epoch: 61, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.3777291774749756
Epoch: 62, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.3855443000793457
Epoch: 63, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.424281120300293
Epoch: 64, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 65 cost time: 3.2937374114990234
Epoch: 65, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 66 cost time: 3.0684030055999756
Epoch: 66, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.445107936859131
Epoch: 67, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 68 cost time: 3.1460742950439453
Epoch: 68, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.343590259552002
Epoch: 69, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.906 Test Loss: 0.214 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.125300407409668
Epoch: 70, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 2.921670436859131
Epoch: 71, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.3650259971618652
Epoch: 72, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.07393741607666
Epoch: 73, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.3093276023864746
Epoch: 74, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 3.292417049407959
Epoch: 75, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 3.39766001701355
Epoch: 76, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 3.2876758575439453
Epoch: 77, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4947426319122314
Epoch: 1, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.772 Vali Acc: 0.172 Test Loss: 1.772 Test Acc: 0.172
Validation loss decreased (inf --> -0.172205).  Saving model ...
Epoch: 2 cost time: 3.059541702270508
Epoch: 2, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.707 Vali Acc: 0.250 Test Loss: 1.707 Test Acc: 0.250
Validation loss decreased (-0.172205 --> -0.249983).  Saving model ...
Epoch: 3 cost time: 3.0536386966705322
Epoch: 3, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.628 Vali Acc: 0.383 Test Loss: 1.628 Test Acc: 0.383
Validation loss decreased (-0.249983 --> -0.383317).  Saving model ...
Epoch: 4 cost time: 3.163322687149048
Epoch: 4, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.550 Vali Acc: 0.439 Test Loss: 1.550 Test Acc: 0.439
Validation loss decreased (-0.383317 --> -0.438873).  Saving model ...
Epoch: 5 cost time: 3.188720464706421
Epoch: 5, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.470 Vali Acc: 0.461 Test Loss: 1.470 Test Acc: 0.461
Validation loss decreased (-0.438873 --> -0.461096).  Saving model ...
Epoch: 6 cost time: 3.1149299144744873
Epoch: 6, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.391 Vali Acc: 0.467 Test Loss: 1.391 Test Acc: 0.467
Validation loss decreased (-0.461096 --> -0.466653).  Saving model ...
Epoch: 7 cost time: 3.19632625579834
Epoch: 7, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.321 Vali Acc: 0.489 Test Loss: 1.321 Test Acc: 0.489
Validation loss decreased (-0.466653 --> -0.488876).  Saving model ...
Epoch: 8 cost time: 3.343679189682007
Epoch: 8, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.248 Vali Acc: 0.511 Test Loss: 1.248 Test Acc: 0.511
Validation loss decreased (-0.488876 --> -0.511099).  Saving model ...
Epoch: 9 cost time: 3.430696487426758
Epoch: 9, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.177 Vali Acc: 0.539 Test Loss: 1.177 Test Acc: 0.539
Validation loss decreased (-0.511099 --> -0.538877).  Saving model ...
Epoch: 10 cost time: 3.5761802196502686
Epoch: 10, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
Validation loss decreased (-0.538877 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 3.2807443141937256
Epoch: 11, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.052 Vali Acc: 0.594 Test Loss: 1.052 Test Acc: 0.594
Validation loss decreased (-0.549989 --> -0.594434).  Saving model ...
Epoch: 12 cost time: 3.4197700023651123
Epoch: 12, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.983 Vali Acc: 0.606 Test Loss: 0.983 Test Acc: 0.606
Validation loss decreased (-0.594434 --> -0.605546).  Saving model ...
Epoch: 13 cost time: 3.450268030166626
Epoch: 13, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.928 Vali Acc: 0.639 Test Loss: 0.928 Test Acc: 0.639
Validation loss decreased (-0.605546 --> -0.638880).  Saving model ...
Epoch: 14 cost time: 3.162086248397827
Epoch: 14, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.871 Vali Acc: 0.644 Test Loss: 0.871 Test Acc: 0.644
Validation loss decreased (-0.638880 --> -0.644436).  Saving model ...
Epoch: 15 cost time: 3.1587765216827393
Epoch: 15, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.801 Vali Acc: 0.672 Test Loss: 0.801 Test Acc: 0.672
Validation loss decreased (-0.644436 --> -0.672214).  Saving model ...
Epoch: 16 cost time: 3.1719436645507812
Epoch: 16, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.742 Vali Acc: 0.694 Test Loss: 0.742 Test Acc: 0.694
Validation loss decreased (-0.672214 --> -0.694437).  Saving model ...
Epoch: 17 cost time: 3.131247043609619
Epoch: 17, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716660).  Saving model ...
Epoch: 18 cost time: 3.0663046836853027
Epoch: 18, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.626 Vali Acc: 0.733 Test Loss: 0.626 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 19 cost time: 3.387669086456299
Epoch: 19, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.598 Vali Acc: 0.739 Test Loss: 0.598 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 20 cost time: 3.0358519554138184
Epoch: 20, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.528 Vali Acc: 0.772 Test Loss: 0.528 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772217).  Saving model ...
Epoch: 21 cost time: 3.224019765853882
Epoch: 21, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.503 Vali Acc: 0.772 Test Loss: 0.503 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 22 cost time: 3.2227375507354736
Epoch: 22, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 23 cost time: 3.33381986618042
Epoch: 23, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.438 Vali Acc: 0.811 Test Loss: 0.438 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 24 cost time: 3.122528314590454
Epoch: 24, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.419 Vali Acc: 0.806 Test Loss: 0.419 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2040586471557617
Epoch: 25, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.384 Vali Acc: 0.844 Test Loss: 0.384 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 26 cost time: 3.5452897548675537
Epoch: 26, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4564995765686035
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.377 Vali Acc: 0.822 Test Loss: 0.377 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.564208507537842
Epoch: 28, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2827396392822266
Epoch: 29, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 3.274991273880005
Epoch: 30, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 31 cost time: 3.186685800552368
Epoch: 31, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 3.17742919921875
Epoch: 32, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 33 cost time: 3.3651235103607178
Epoch: 33, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4490675926208496
Epoch: 34, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.1239778995513916
Epoch: 35, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 2.9445879459381104
Epoch: 36, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.207806348800659
Epoch: 37, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.485621690750122
Epoch: 38, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 3.4770169258117676
Epoch: 39, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 3.1618618965148926
Epoch: 40, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 41 cost time: 3.5750925540924072
Epoch: 41, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.2090699672698975
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.917499542236328
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.3033864498138428
Epoch: 44, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.5849430561065674
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.270109176635742
Epoch: 46, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.436676502227783
Epoch: 47, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.274764060974121
Epoch: 48, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.2900891304016113
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.2330245971679688
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.973347425460815
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.764 Vali Acc: 0.228 Test Loss: 1.764 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 3.2548747062683105
Epoch: 2, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.722 Vali Acc: 0.283 Test Loss: 1.722 Test Acc: 0.283
Validation loss decreased (-0.227760 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 3.4849486351013184
Epoch: 3, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.667 Vali Acc: 0.317 Test Loss: 1.667 Test Acc: 0.317
Validation loss decreased (-0.283316 --> -0.316650).  Saving model ...
Epoch: 4 cost time: 2.939769983291626
Epoch: 4, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.612 Vali Acc: 0.328 Test Loss: 1.612 Test Acc: 0.328
Validation loss decreased (-0.316650 --> -0.327762).  Saving model ...
Epoch: 5 cost time: 3.2627861499786377
Epoch: 5, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.549 Vali Acc: 0.356 Test Loss: 1.549 Test Acc: 0.356
Validation loss decreased (-0.327762 --> -0.355540).  Saving model ...
Epoch: 6 cost time: 2.8913068771362305
Epoch: 6, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.484 Vali Acc: 0.378 Test Loss: 1.484 Test Acc: 0.378
Validation loss decreased (-0.355540 --> -0.377763).  Saving model ...
Epoch: 7 cost time: 3.1895320415496826
Epoch: 7, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.427 Vali Acc: 0.417 Test Loss: 1.427 Test Acc: 0.417
Validation loss decreased (-0.377763 --> -0.416652).  Saving model ...
Epoch: 8 cost time: 2.9450912475585938
Epoch: 8, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.361 Vali Acc: 0.439 Test Loss: 1.361 Test Acc: 0.439
Validation loss decreased (-0.416652 --> -0.438875).  Saving model ...
Epoch: 9 cost time: 3.4402174949645996
Epoch: 9, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.295 Vali Acc: 0.433 Test Loss: 1.295 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.318343162536621
Epoch: 10, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.228 Vali Acc: 0.478 Test Loss: 1.228 Test Acc: 0.478
Validation loss decreased (-0.438875 --> -0.477766).  Saving model ...
Epoch: 11 cost time: 3.226536273956299
Epoch: 11, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.165 Vali Acc: 0.506 Test Loss: 1.165 Test Acc: 0.506
Validation loss decreased (-0.477766 --> -0.505544).  Saving model ...
Epoch: 12 cost time: 3.2839813232421875
Epoch: 12, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.505544 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 3.265486001968384
Epoch: 13, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 3.3294808864593506
Epoch: 14, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.975 Vali Acc: 0.550 Test Loss: 0.975 Test Acc: 0.550
Validation loss decreased (-0.533323 --> -0.549990).  Saving model ...
Epoch: 15 cost time: 3.830669403076172
Epoch: 15, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.898 Vali Acc: 0.578 Test Loss: 0.898 Test Acc: 0.578
Validation loss decreased (-0.549990 --> -0.577769).  Saving model ...
Epoch: 16 cost time: 3.4133448600769043
Epoch: 16, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.841 Vali Acc: 0.606 Test Loss: 0.841 Test Acc: 0.606
Validation loss decreased (-0.577769 --> -0.605547).  Saving model ...
Epoch: 17 cost time: 3.5048060417175293
Epoch: 17, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.794 Vali Acc: 0.622 Test Loss: 0.794 Test Acc: 0.622
Validation loss decreased (-0.605547 --> -0.622214).  Saving model ...
Epoch: 18 cost time: 3.6047396659851074
Epoch: 18, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.740 Vali Acc: 0.633 Test Loss: 0.740 Test Acc: 0.633
Validation loss decreased (-0.622214 --> -0.633326).  Saving model ...
Epoch: 19 cost time: 3.1155436038970947
Epoch: 19, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.712 Vali Acc: 0.667 Test Loss: 0.712 Test Acc: 0.667
Validation loss decreased (-0.633326 --> -0.666660).  Saving model ...
Epoch: 20 cost time: 3.052335023880005
Epoch: 20, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.627 Vali Acc: 0.711 Test Loss: 0.627 Test Acc: 0.711
Validation loss decreased (-0.666660 --> -0.711105).  Saving model ...
Epoch: 21 cost time: 2.7629148960113525
Epoch: 21, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.588 Vali Acc: 0.706 Test Loss: 0.588 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.792644739151001
Epoch: 22, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.540 Vali Acc: 0.733 Test Loss: 0.540 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733328).  Saving model ...
Epoch: 23 cost time: 2.853517532348633
Epoch: 23, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 24 cost time: 3.024285316467285
Epoch: 24, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.478 Vali Acc: 0.778 Test Loss: 0.478 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 25 cost time: 2.9310364723205566
Epoch: 25, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.429 Vali Acc: 0.783 Test Loss: 0.429 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 26 cost time: 3.1795592308044434
Epoch: 26, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.421 Vali Acc: 0.789 Test Loss: 0.421 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 27 cost time: 3.1006827354431152
Epoch: 27, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794440).  Saving model ...
Epoch: 28 cost time: 3.54144024848938
Epoch: 28, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.396 Vali Acc: 0.783 Test Loss: 0.396 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4903080463409424
Epoch: 29, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 30 cost time: 3.3627800941467285
Epoch: 30, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.372 Vali Acc: 0.806 Test Loss: 0.372 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 31 cost time: 3.3734796047210693
Epoch: 31, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 32 cost time: 3.602595090866089
Epoch: 32, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3474042415618896
Epoch: 33, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 34 cost time: 3.065537452697754
Epoch: 34, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 35 cost time: 3.1729066371917725
Epoch: 35, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.471555709838867
Epoch: 36, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 37 cost time: 3.34702467918396
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.545588731765747
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.861108 --> -0.911108).  Saving model ...
Epoch: 39 cost time: 3.1450204849243164
Epoch: 39, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3087542057037354
Epoch: 40, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.4516806602478027
Epoch: 41, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.2019803524017334
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 43 cost time: 3.2152090072631836
Epoch: 43, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.889488697052002
Epoch: 44, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.048931121826172
Epoch: 45, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 46 cost time: 3.4063024520874023
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.5984885692596436
Epoch: 47, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.3402724266052246
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.3890438079833984
Epoch: 49, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.590634822845459
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.267402410507202
Epoch: 51, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.4042351245880127
Epoch: 52, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.503830671310425
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.3051037788391113
Epoch: 54, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.5138609409332275
Epoch: 55, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4063804149627686
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.800 Vali Acc: 0.189 Test Loss: 1.800 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 3.070998191833496
Epoch: 2, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.766 Vali Acc: 0.200 Test Loss: 1.766 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 3.1012420654296875
Epoch: 3, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.726 Vali Acc: 0.261 Test Loss: 1.726 Test Acc: 0.261
Validation loss decreased (-0.199982 --> -0.261094).  Saving model ...
Epoch: 4 cost time: 3.1120505332946777
Epoch: 4, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.690 Vali Acc: 0.233 Test Loss: 1.690 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.111672878265381
Epoch: 5, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.647 Vali Acc: 0.250 Test Loss: 1.647 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1755428314208984
Epoch: 6, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.604 Vali Acc: 0.278 Test Loss: 1.604 Test Acc: 0.278
Validation loss decreased (-0.261094 --> -0.277762).  Saving model ...
Epoch: 7 cost time: 3.124433994293213
Epoch: 7, Steps: 12 | Train Loss: 1.544 Vali Loss: 1.566 Vali Acc: 0.278 Test Loss: 1.566 Test Acc: 0.278
Validation loss decreased (-0.277762 --> -0.277762).  Saving model ...
Epoch: 8 cost time: 2.997509717941284
Epoch: 8, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.503 Vali Acc: 0.372 Test Loss: 1.503 Test Acc: 0.372
Validation loss decreased (-0.277762 --> -0.372207).  Saving model ...
Epoch: 9 cost time: 2.8910582065582275
Epoch: 9, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.436 Vali Acc: 0.383 Test Loss: 1.436 Test Acc: 0.383
Validation loss decreased (-0.372207 --> -0.383319).  Saving model ...
Epoch: 10 cost time: 2.7319531440734863
Epoch: 10, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.352 Vali Acc: 0.450 Test Loss: 1.352 Test Acc: 0.450
Validation loss decreased (-0.383319 --> -0.449986).  Saving model ...
Epoch: 11 cost time: 3.1444480419158936
Epoch: 11, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.252 Vali Acc: 0.511 Test Loss: 1.252 Test Acc: 0.511
Validation loss decreased (-0.449986 --> -0.511099).  Saving model ...
Epoch: 12 cost time: 2.8815503120422363
Epoch: 12, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.123 Vali Acc: 0.511 Test Loss: 1.123 Test Acc: 0.511
Validation loss decreased (-0.511099 --> -0.511100).  Saving model ...
Epoch: 13 cost time: 3.0636703968048096
Epoch: 13, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.002 Vali Acc: 0.544 Test Loss: 1.002 Test Acc: 0.544
Validation loss decreased (-0.511100 --> -0.544434).  Saving model ...
Epoch: 14 cost time: 3.0198018550872803
Epoch: 14, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.917 Vali Acc: 0.556 Test Loss: 0.917 Test Acc: 0.556
Validation loss decreased (-0.544434 --> -0.555546).  Saving model ...
Epoch: 15 cost time: 3.0680994987487793
Epoch: 15, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.828 Vali Acc: 0.594 Test Loss: 0.828 Test Acc: 0.594
Validation loss decreased (-0.555546 --> -0.594436).  Saving model ...
Epoch: 16 cost time: 3.3246803283691406
Epoch: 16, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.774 Vali Acc: 0.628 Test Loss: 0.774 Test Acc: 0.628
Validation loss decreased (-0.594436 --> -0.627770).  Saving model ...
Epoch: 17 cost time: 3.132847309112549
Epoch: 17, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.728 Vali Acc: 0.617 Test Loss: 0.728 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1822030544281006
Epoch: 18, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.669 Vali Acc: 0.661 Test Loss: 0.669 Test Acc: 0.661
Validation loss decreased (-0.627770 --> -0.661104).  Saving model ...
Epoch: 19 cost time: 3.218841314315796
Epoch: 19, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.644 Vali Acc: 0.689 Test Loss: 0.644 Test Acc: 0.689
Validation loss decreased (-0.661104 --> -0.688882).  Saving model ...
Epoch: 20 cost time: 3.081096887588501
Epoch: 20, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.567 Vali Acc: 0.706 Test Loss: 0.567 Test Acc: 0.706
Validation loss decreased (-0.688882 --> -0.705550).  Saving model ...
Epoch: 21 cost time: 2.823542594909668
Epoch: 21, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.530 Vali Acc: 0.744 Test Loss: 0.530 Test Acc: 0.744
Validation loss decreased (-0.705550 --> -0.744439).  Saving model ...
Epoch: 22 cost time: 3.044125556945801
Epoch: 22, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.480 Vali Acc: 0.744 Test Loss: 0.480 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744440).  Saving model ...
Epoch: 23 cost time: 2.9328930377960205
Epoch: 23, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.459 Vali Acc: 0.744 Test Loss: 0.459 Test Acc: 0.744
Validation loss decreased (-0.744440 --> -0.744440).  Saving model ...
Epoch: 24 cost time: 2.8147642612457275
Epoch: 24, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.446 Vali Acc: 0.750 Test Loss: 0.446 Test Acc: 0.750
Validation loss decreased (-0.744440 --> -0.749996).  Saving model ...
Epoch: 25 cost time: 2.8328030109405518
Epoch: 25, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.404 Vali Acc: 0.767 Test Loss: 0.404 Test Acc: 0.767
Validation loss decreased (-0.749996 --> -0.766663).  Saving model ...
Epoch: 26 cost time: 2.8634936809539795
Epoch: 26, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.403 Vali Acc: 0.800 Test Loss: 0.403 Test Acc: 0.800
Validation loss decreased (-0.766663 --> -0.799996).  Saving model ...
Epoch: 27 cost time: 2.9962384700775146
Epoch: 27, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.888906717300415
Epoch: 28, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.372 Vali Acc: 0.778 Test Loss: 0.372 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.100226879119873
Epoch: 29, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.363 Vali Acc: 0.789 Test Loss: 0.363 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0537540912628174
Epoch: 30, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.347 Vali Acc: 0.806 Test Loss: 0.347 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 31 cost time: 3.2726540565490723
Epoch: 31, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.333 Vali Acc: 0.811 Test Loss: 0.333 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811108).  Saving model ...
Epoch: 32 cost time: 3.1847240924835205
Epoch: 32, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.334 Vali Acc: 0.811 Test Loss: 0.334 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.115302324295044
Epoch: 33, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.329 Vali Acc: 0.811 Test Loss: 0.329 Test Acc: 0.811
Validation loss decreased (-0.811108 --> -0.811108).  Saving model ...
Epoch: 34 cost time: 3.108659505844116
Epoch: 34, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
Validation loss decreased (-0.811108 --> -0.833330).  Saving model ...
Epoch: 35 cost time: 3.013807535171509
Epoch: 35, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.1086385250091553
Epoch: 36, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 37 cost time: 3.041243314743042
Epoch: 37, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 38 cost time: 3.0276846885681152
Epoch: 38, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 3.0889506340026855
Epoch: 39, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.276 Vali Acc: 0.844 Test Loss: 0.276 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.926870822906494
Epoch: 40, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.011145830154419
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.956519365310669
Epoch: 42, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.883331 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 3.3321585655212402
Epoch: 43, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.256865978240967
Epoch: 44, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2510364055633545
Epoch: 45, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.168470621109009
Epoch: 46, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.0320446491241455
Epoch: 47, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.9309279918670654
Epoch: 48, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 3.0490071773529053
Epoch: 49, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.911 Test Loss: 0.186 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3306150436401367
Epoch: 50, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.3313872814178467
Epoch: 51, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.2463467121124268
Epoch: 52, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 53 cost time: 3.042738437652588
Epoch: 53, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.056727170944214
Epoch: 54, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.2024970054626465
Epoch: 55, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.286511182785034
Epoch: 56, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.2345244884490967
Epoch: 57, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.412 Vali Acc: 0.894 Test Loss: 0.412 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.2749924659729004
Epoch: 58, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.3370912075042725
Epoch: 59, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.218312978744507
Epoch: 60, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.0224766731262207
Epoch: 61, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.1775243282318115
Epoch: 62, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.337435722351074
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.850 Vali Acc: 0.172 Test Loss: 1.850 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 2.951660394668579
Epoch: 2, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.821 Vali Acc: 0.167 Test Loss: 1.821 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3211591243743896
Epoch: 3, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.789 Vali Acc: 0.161 Test Loss: 1.789 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2986602783203125
Epoch: 4, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.761 Vali Acc: 0.194 Test Loss: 1.761 Test Acc: 0.194
Validation loss decreased (-0.172204 --> -0.194427).  Saving model ...
Epoch: 5 cost time: 3.1910805702209473
Epoch: 5, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.721 Vali Acc: 0.278 Test Loss: 1.721 Test Acc: 0.278
Validation loss decreased (-0.194427 --> -0.277761).  Saving model ...
Epoch: 6 cost time: 3.2344768047332764
Epoch: 6, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.689 Vali Acc: 0.317 Test Loss: 1.689 Test Acc: 0.317
Validation loss decreased (-0.277761 --> -0.316650).  Saving model ...
Epoch: 7 cost time: 3.4200708866119385
Epoch: 7, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.657 Vali Acc: 0.317 Test Loss: 1.657 Test Acc: 0.317
Validation loss decreased (-0.316650 --> -0.316650).  Saving model ...
Epoch: 8 cost time: 3.5145316123962402
Epoch: 8, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.596 Vali Acc: 0.344 Test Loss: 1.596 Test Acc: 0.344
Validation loss decreased (-0.316650 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 3.1931345462799072
Epoch: 9, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.512 Vali Acc: 0.356 Test Loss: 1.512 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355540).  Saving model ...
Epoch: 10 cost time: 3.155614137649536
Epoch: 10, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.398 Vali Acc: 0.422 Test Loss: 1.398 Test Acc: 0.422
Validation loss decreased (-0.355540 --> -0.422208).  Saving model ...
Epoch: 11 cost time: 3.152491331100464
Epoch: 11, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.238 Vali Acc: 0.472 Test Loss: 1.238 Test Acc: 0.472
Validation loss decreased (-0.422208 --> -0.472210).  Saving model ...
Epoch: 12 cost time: 3.1056067943573
Epoch: 12, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.043 Vali Acc: 0.528 Test Loss: 1.043 Test Acc: 0.528
Validation loss decreased (-0.472210 --> -0.527767).  Saving model ...
Epoch: 13 cost time: 3.2455646991729736
Epoch: 13, Steps: 12 | Train Loss: 0.934 Vali Loss: 0.885 Vali Acc: 0.594 Test Loss: 0.885 Test Acc: 0.594
Validation loss decreased (-0.527767 --> -0.594436).  Saving model ...
Epoch: 14 cost time: 2.839573383331299
Epoch: 14, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.779 Vali Acc: 0.633 Test Loss: 0.779 Test Acc: 0.633
Validation loss decreased (-0.594436 --> -0.633326).  Saving model ...
Epoch: 15 cost time: 2.7252261638641357
Epoch: 15, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.685 Vali Acc: 0.706 Test Loss: 0.685 Test Acc: 0.706
Validation loss decreased (-0.633326 --> -0.705549).  Saving model ...
Epoch: 16 cost time: 2.90053129196167
Epoch: 16, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.653 Vali Acc: 0.694 Test Loss: 0.653 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1224095821380615
Epoch: 17, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.600 Vali Acc: 0.711 Test Loss: 0.600 Test Acc: 0.711
Validation loss decreased (-0.705549 --> -0.711105).  Saving model ...
Epoch: 18 cost time: 3.383908748626709
Epoch: 18, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.711105 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 3.1857993602752686
Epoch: 19, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.527 Vali Acc: 0.744 Test Loss: 0.527 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5008366107940674
Epoch: 20, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.467 Vali Acc: 0.761 Test Loss: 0.467 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 21 cost time: 3.026106834411621
Epoch: 21, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 22 cost time: 2.8419415950775146
Epoch: 22, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.455 Vali Acc: 0.778 Test Loss: 0.455 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.131258964538574
Epoch: 23, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 24 cost time: 3.2143056392669678
Epoch: 24, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9887473583221436
Epoch: 25, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.407 Vali Acc: 0.800 Test Loss: 0.407 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.390049934387207
Epoch: 26, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 27 cost time: 3.383336067199707
Epoch: 27, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.156979560852051
Epoch: 28, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.62106990814209
Epoch: 29, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8888988494873047
Epoch: 30, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.7442288398742676
Epoch: 31, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 32 cost time: 3.36702036857605
Epoch: 32, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.473069190979004
Epoch: 33, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 34 cost time: 3.2359185218811035
Epoch: 34, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 35 cost time: 3.3392863273620605
Epoch: 35, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3162221908569336
Epoch: 36, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.3410489559173584
Epoch: 37, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 38 cost time: 3.202965259552002
Epoch: 38, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 39 cost time: 3.226977825164795
Epoch: 39, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.300987958908081
Epoch: 40, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 41 cost time: 3.549751043319702
Epoch: 41, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 3.4349682331085205
Epoch: 42, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 43 cost time: 3.605254650115967
Epoch: 43, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.468332290649414
Epoch: 44, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 45 cost time: 3.521883964538574
Epoch: 45, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2409415245056152
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927776).  Saving model ...
Epoch: 47 cost time: 3.522797107696533
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.2816872596740723
Epoch: 48, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.3410775661468506
Epoch: 49, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.1778852939605713
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.8508639335632324
Epoch: 51, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.841810703277588
Epoch: 52, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.3915483951568604
Epoch: 53, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.3590598106384277
Epoch: 54, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.2395248413085938
Epoch: 55, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.4236433506011963
Epoch: 56, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.742633819580078
Epoch: 1, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.854 Vali Acc: 0.167 Test Loss: 1.854 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 3.2454640865325928
Epoch: 2, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.834 Vali Acc: 0.189 Test Loss: 1.834 Test Acc: 0.189
Validation loss decreased (-0.166648 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 3.2891979217529297
Epoch: 3, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.808 Vali Acc: 0.206 Test Loss: 1.808 Test Acc: 0.206
Validation loss decreased (-0.188871 --> -0.205537).  Saving model ...
Epoch: 4 cost time: 3.111109495162964
Epoch: 4, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.778 Vali Acc: 0.233 Test Loss: 1.778 Test Acc: 0.233
Validation loss decreased (-0.205537 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 3.5502982139587402
Epoch: 5, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.737 Vali Acc: 0.250 Test Loss: 1.737 Test Acc: 0.250
Validation loss decreased (-0.233316 --> -0.249983).  Saving model ...
Epoch: 6 cost time: 3.370103597640991
Epoch: 6, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.681 Vali Acc: 0.311 Test Loss: 1.681 Test Acc: 0.311
Validation loss decreased (-0.249983 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 3.522792100906372
Epoch: 7, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.604 Vali Acc: 0.339 Test Loss: 1.604 Test Acc: 0.339
Validation loss decreased (-0.311094 --> -0.338873).  Saving model ...
Epoch: 8 cost time: 3.2970714569091797
Epoch: 8, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.502 Vali Acc: 0.389 Test Loss: 1.502 Test Acc: 0.389
Validation loss decreased (-0.338873 --> -0.388874).  Saving model ...
Epoch: 9 cost time: 3.50140118598938
Epoch: 9, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
Validation loss decreased (-0.388874 --> -0.499986).  Saving model ...
Epoch: 10 cost time: 3.180795907974243
Epoch: 10, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.231 Vali Acc: 0.517 Test Loss: 1.231 Test Acc: 0.517
Validation loss decreased (-0.499986 --> -0.516654).  Saving model ...
Epoch: 11 cost time: 3.182560920715332
Epoch: 11, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.090 Vali Acc: 0.539 Test Loss: 1.090 Test Acc: 0.539
Validation loss decreased (-0.516654 --> -0.538878).  Saving model ...
Epoch: 12 cost time: 3.106713056564331
Epoch: 12, Steps: 12 | Train Loss: 1.092 Vali Loss: 0.993 Vali Acc: 0.517 Test Loss: 0.993 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2463293075561523
Epoch: 13, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.943 Vali Acc: 0.522 Test Loss: 0.943 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.927464723587036
Epoch: 14, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.916 Vali Acc: 0.556 Test Loss: 0.916 Test Acc: 0.556
Validation loss decreased (-0.538878 --> -0.555546).  Saving model ...
Epoch: 15 cost time: 3.176401138305664
Epoch: 15, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.841 Vali Acc: 0.578 Test Loss: 0.841 Test Acc: 0.578
Validation loss decreased (-0.555546 --> -0.577769).  Saving model ...
Epoch: 16 cost time: 3.0990869998931885
Epoch: 16, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.800 Vali Acc: 0.617 Test Loss: 0.800 Test Acc: 0.617
Validation loss decreased (-0.577769 --> -0.616659).  Saving model ...
Epoch: 17 cost time: 3.128117561340332
Epoch: 17, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.763 Vali Acc: 0.633 Test Loss: 0.763 Test Acc: 0.633
Validation loss decreased (-0.616659 --> -0.633326).  Saving model ...
Epoch: 18 cost time: 3.207186460494995
Epoch: 18, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.689 Vali Acc: 0.672 Test Loss: 0.689 Test Acc: 0.672
Validation loss decreased (-0.633326 --> -0.672215).  Saving model ...
Epoch: 19 cost time: 3.7333462238311768
Epoch: 19, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.653 Vali Acc: 0.694 Test Loss: 0.653 Test Acc: 0.694
Validation loss decreased (-0.672215 --> -0.694438).  Saving model ...
Epoch: 20 cost time: 3.536677598953247
Epoch: 20, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.558 Vali Acc: 0.733 Test Loss: 0.558 Test Acc: 0.733
Validation loss decreased (-0.694438 --> -0.733328).  Saving model ...
Epoch: 21 cost time: 3.418246269226074
Epoch: 21, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.522 Vali Acc: 0.739 Test Loss: 0.522 Test Acc: 0.739
Validation loss decreased (-0.733328 --> -0.738884).  Saving model ...
Epoch: 22 cost time: 3.6374990940093994
Epoch: 22, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.475 Vali Acc: 0.767 Test Loss: 0.475 Test Acc: 0.767
Validation loss decreased (-0.738884 --> -0.766662).  Saving model ...
Epoch: 23 cost time: 3.465193748474121
Epoch: 23, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.441 Vali Acc: 0.767 Test Loss: 0.441 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766662).  Saving model ...
Epoch: 24 cost time: 3.152146816253662
Epoch: 24, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.429 Vali Acc: 0.789 Test Loss: 0.429 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 25 cost time: 3.4641895294189453
Epoch: 25, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.400 Vali Acc: 0.806 Test Loss: 0.400 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 26 cost time: 3.630067825317383
Epoch: 26, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.387 Vali Acc: 0.794 Test Loss: 0.387 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2594223022460938
Epoch: 27, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2982890605926514
Epoch: 28, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 29 cost time: 3.11092209815979
Epoch: 29, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.393 Vali Acc: 0.783 Test Loss: 0.393 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2487709522247314
Epoch: 30, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.377 Vali Acc: 0.789 Test Loss: 0.377 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2189066410064697
Epoch: 31, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.375 Vali Acc: 0.794 Test Loss: 0.375 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3620686531066895
Epoch: 32, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.384 Vali Acc: 0.817 Test Loss: 0.384 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 33 cost time: 3.0312769412994385
Epoch: 33, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.367 Vali Acc: 0.789 Test Loss: 0.367 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2542903423309326
Epoch: 34, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.374 Vali Acc: 0.800 Test Loss: 0.374 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.2001819610595703
Epoch: 35, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.381 Vali Acc: 0.783 Test Loss: 0.381 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.259307861328125
Epoch: 36, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9694793224334717
Epoch: 37, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 38 cost time: 2.8484842777252197
Epoch: 38, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.985569477081299
Epoch: 39, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.334 Vali Acc: 0.817 Test Loss: 0.334 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.4766476154327393
Epoch: 40, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 41 cost time: 3.344144105911255
Epoch: 41, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.1600637435913086
Epoch: 42, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 43 cost time: 3.1899185180664062
Epoch: 43, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.1932430267333984
Epoch: 44, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2678141593933105
Epoch: 45, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 46 cost time: 3.247185468673706
Epoch: 46, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
Validation loss decreased (-0.872219 --> -0.911109).  Saving model ...
Epoch: 47 cost time: 3.3193066120147705
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.432931423187256
Epoch: 48, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.0930933952331543
Epoch: 49, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.4583535194396973
Epoch: 50, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 51 cost time: 2.8919804096221924
Epoch: 51, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.98994779586792
Epoch: 52, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.896141529083252
Epoch: 53, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.139943838119507
Epoch: 54, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.003782272338867
Epoch: 55, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 3.5470521450042725
Epoch: 56, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.5237419605255127
Epoch: 57, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 3.352262496948242
Epoch: 58, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.3179852962493896
Epoch: 59, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.622291326522827
Epoch: 60, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 61 cost time: 3.280670642852783
Epoch: 61, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.261 Vali Acc: 0.928 Test Loss: 0.261 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.2871315479278564
Epoch: 62, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 3.5428686141967773
Epoch: 63, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.309055805206299
Epoch: 64, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.490068197250366
Epoch: 65, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.3103461265563965
Epoch: 66, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.4737181663513184
Epoch: 67, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 68 cost time: 3.740650177001953
Epoch: 68, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.4288971424102783
Epoch: 69, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.3407511711120605
Epoch: 70, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.0341849327087402
Epoch: 71, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.1903388500213623
Epoch: 72, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944441).  Saving model ...
Epoch: 73 cost time: 3.232215166091919
Epoch: 73, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 3.2406632900238037
Epoch: 74, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 3.2022407054901123
Epoch: 75, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 3.1537697315216064
Epoch: 76, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 3.2813034057617188
Epoch: 77, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 3.5276236534118652
Epoch: 78, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 3.575385093688965
Epoch: 79, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 3.4519455432891846
Epoch: 80, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.317 Vali Acc: 0.933 Test Loss: 0.317 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 3.211682081222534
Epoch: 81, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.288 Vali Acc: 0.939 Test Loss: 0.288 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 3.1221368312835693
Epoch: 82, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 3.0577263832092285
Epoch: 83, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.9964277744293213
Epoch: 84, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 3.1291491985321045
Epoch: 85, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 3.0403010845184326
Epoch: 86, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 3.2691073417663574
Epoch: 87, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 3.41624116897583
Epoch: 88, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 3.622633934020996
Epoch: 89, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 3.4611318111419678
Epoch: 90, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.939 Test Loss: 0.237 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 3.3870437145233154
Epoch: 91, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 3.276033878326416
Epoch: 92, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.346 Vali Acc: 0.933 Test Loss: 0.346 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.776026248931885
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.840 Vali Acc: 0.133 Test Loss: 1.840 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 3.258742332458496
Epoch: 2, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.822 Vali Acc: 0.172 Test Loss: 1.822 Test Acc: 0.172
Validation loss decreased (-0.133315 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 3.677342176437378
Epoch: 3, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.798 Vali Acc: 0.189 Test Loss: 1.798 Test Acc: 0.189
Validation loss decreased (-0.172204 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 3.4159419536590576
Epoch: 4, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.771 Vali Acc: 0.206 Test Loss: 1.771 Test Acc: 0.206
Validation loss decreased (-0.188871 --> -0.205538).  Saving model ...
Epoch: 5 cost time: 3.5860095024108887
Epoch: 5, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.731 Vali Acc: 0.250 Test Loss: 1.731 Test Acc: 0.250
Validation loss decreased (-0.205538 --> -0.249983).  Saving model ...
Epoch: 6 cost time: 3.417239189147949
Epoch: 6, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.681 Vali Acc: 0.261 Test Loss: 1.681 Test Acc: 0.261
Validation loss decreased (-0.249983 --> -0.261094).  Saving model ...
Epoch: 7 cost time: 2.990743398666382
Epoch: 7, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.612 Vali Acc: 0.344 Test Loss: 1.612 Test Acc: 0.344
Validation loss decreased (-0.261094 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 3.070363759994507
Epoch: 8, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.515 Vali Acc: 0.417 Test Loss: 1.515 Test Acc: 0.417
Validation loss decreased (-0.344428 --> -0.416652).  Saving model ...
Epoch: 9 cost time: 3.1764614582061768
Epoch: 9, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.385 Vali Acc: 0.472 Test Loss: 1.385 Test Acc: 0.472
Validation loss decreased (-0.416652 --> -0.472208).  Saving model ...
Epoch: 10 cost time: 3.128446578979492
Epoch: 10, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.249 Vali Acc: 0.522 Test Loss: 1.249 Test Acc: 0.522
Validation loss decreased (-0.472208 --> -0.522210).  Saving model ...
Epoch: 11 cost time: 2.998039484024048
Epoch: 11, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.106 Vali Acc: 0.550 Test Loss: 1.106 Test Acc: 0.550
Validation loss decreased (-0.522210 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 2.923274517059326
Epoch: 12, Steps: 12 | Train Loss: 1.173 Vali Loss: 0.989 Vali Acc: 0.567 Test Loss: 0.989 Test Acc: 0.567
Validation loss decreased (-0.549989 --> -0.566657).  Saving model ...
Epoch: 13 cost time: 3.1220288276672363
Epoch: 13, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.927 Vali Acc: 0.544 Test Loss: 0.927 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.386725664138794
Epoch: 14, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.894 Vali Acc: 0.539 Test Loss: 0.894 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5631539821624756
Epoch: 15, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.828 Vali Acc: 0.567 Test Loss: 0.828 Test Acc: 0.567
Validation loss decreased (-0.566657 --> -0.566658).  Saving model ...
Epoch: 16 cost time: 3.6450185775756836
Epoch: 16, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.790 Vali Acc: 0.611 Test Loss: 0.790 Test Acc: 0.611
Validation loss decreased (-0.566658 --> -0.611103).  Saving model ...
Epoch: 17 cost time: 3.407924175262451
Epoch: 17, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.737 Vali Acc: 0.633 Test Loss: 0.737 Test Acc: 0.633
Validation loss decreased (-0.611103 --> -0.633326).  Saving model ...
Epoch: 18 cost time: 3.4784467220306396
Epoch: 18, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.685 Vali Acc: 0.667 Test Loss: 0.685 Test Acc: 0.667
Validation loss decreased (-0.633326 --> -0.666660).  Saving model ...
Epoch: 19 cost time: 3.367999792098999
Epoch: 19, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.648 Vali Acc: 0.683 Test Loss: 0.648 Test Acc: 0.683
Validation loss decreased (-0.666660 --> -0.683327).  Saving model ...
Epoch: 20 cost time: 3.3629517555236816
Epoch: 20, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.569 Vali Acc: 0.733 Test Loss: 0.569 Test Acc: 0.733
Validation loss decreased (-0.683327 --> -0.733328).  Saving model ...
Epoch: 21 cost time: 3.4172568321228027
Epoch: 21, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.519 Vali Acc: 0.744 Test Loss: 0.519 Test Acc: 0.744
Validation loss decreased (-0.733328 --> -0.744439).  Saving model ...
Epoch: 22 cost time: 3.622314929962158
Epoch: 22, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.479 Vali Acc: 0.761 Test Loss: 0.479 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 23 cost time: 3.5877490043640137
Epoch: 23, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.452 Vali Acc: 0.733 Test Loss: 0.452 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.657304525375366
Epoch: 24, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.444 Vali Acc: 0.756 Test Loss: 0.444 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3409743309020996
Epoch: 25, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.426 Vali Acc: 0.778 Test Loss: 0.426 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777774).  Saving model ...
Epoch: 26 cost time: 3.443614959716797
Epoch: 26, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.396 Vali Acc: 0.761 Test Loss: 0.396 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3417491912841797
Epoch: 27, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.374 Vali Acc: 0.778 Test Loss: 0.374 Test Acc: 0.778
Validation loss decreased (-0.777774 --> -0.777774).  Saving model ...
Epoch: 28 cost time: 3.0942301750183105
Epoch: 28, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.362 Vali Acc: 0.794 Test Loss: 0.362 Test Acc: 0.794
Validation loss decreased (-0.777774 --> -0.794441).  Saving model ...
Epoch: 29 cost time: 3.0987308025360107
Epoch: 29, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.370 Vali Acc: 0.783 Test Loss: 0.370 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.515939235687256
Epoch: 30, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.354 Vali Acc: 0.783 Test Loss: 0.354 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.213404655456543
Epoch: 31, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.346 Vali Acc: 0.794 Test Loss: 0.346 Test Acc: 0.794
Validation loss decreased (-0.794441 --> -0.794441).  Saving model ...
Epoch: 32 cost time: 3.1069986820220947
Epoch: 32, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.345 Vali Acc: 0.794 Test Loss: 0.345 Test Acc: 0.794
Validation loss decreased (-0.794441 --> -0.794441).  Saving model ...
Epoch: 33 cost time: 3.2328081130981445
Epoch: 33, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.340 Vali Acc: 0.806 Test Loss: 0.340 Test Acc: 0.806
Validation loss decreased (-0.794441 --> -0.805552).  Saving model ...
Epoch: 34 cost time: 3.826955795288086
Epoch: 34, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.341 Vali Acc: 0.800 Test Loss: 0.341 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.357043743133545
Epoch: 35, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.327 Vali Acc: 0.806 Test Loss: 0.327 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 36 cost time: 3.432766914367676
Epoch: 36, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.340 Vali Acc: 0.800 Test Loss: 0.340 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.488330364227295
Epoch: 37, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 38 cost time: 3.1723477840423584
Epoch: 38, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 39 cost time: 3.2561490535736084
Epoch: 39, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 40 cost time: 3.2306084632873535
Epoch: 40, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.298 Vali Acc: 0.817 Test Loss: 0.298 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4285950660705566
Epoch: 41, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.0480973720550537
Epoch: 42, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.308 Vali Acc: 0.800 Test Loss: 0.308 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.8809759616851807
Epoch: 43, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 44 cost time: 3.055434226989746
Epoch: 44, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.2160587310791016
Epoch: 45, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 46 cost time: 3.0956947803497314
Epoch: 46, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 47 cost time: 3.497373342514038
Epoch: 47, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.253 Vali Acc: 0.861 Test Loss: 0.253 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.238140821456909
Epoch: 48, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 3.168590784072876
Epoch: 49, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.148127555847168
Epoch: 50, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 51 cost time: 2.8901114463806152
Epoch: 51, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.019784927368164
Epoch: 52, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.5901787281036377
Epoch: 53, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 54 cost time: 3.459568500518799
Epoch: 54, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.236647605895996
Epoch: 55, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.373647451400757
Epoch: 56, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 57 cost time: 3.5955371856689453
Epoch: 57, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.4574215412139893
Epoch: 58, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.423663854598999
Epoch: 59, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.933332 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 3.006223201751709
Epoch: 60, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.949998 --> -0.961110).  Saving model ...
Epoch: 61 cost time: 2.85103702545166
Epoch: 61, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.939 Test Loss: 0.159 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.866483449935913
Epoch: 62, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.891756057739258
Epoch: 63, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.0116543769836426
Epoch: 64, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.008781909942627
Epoch: 65, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.939 Test Loss: 0.159 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.0398895740509033
Epoch: 66, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.1227784156799316
Epoch: 67, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 3.453906774520874
Epoch: 68, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.3557567596435547
Epoch: 69, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 3.223863363265991
Epoch: 70, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.834295749664307
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.5534162521362305
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.308213233947754
Epoch: 3, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 3.2449989318847656
Epoch: 4, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6048662662506104
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4343621730804443
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.631079912185669
Epoch: 7, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.577617645263672
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0800764560699463
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0625815391540527
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.0085837841033936
Epoch: 11, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.979250192642212
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.89896297454834
Epoch: 13, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 91750
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.950494050979614
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.817 Vali Acc: 0.156 Test Loss: 1.817 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 3.2212860584259033
Epoch: 2, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.747 Vali Acc: 0.244 Test Loss: 1.747 Test Acc: 0.244
Validation loss decreased (-0.155537 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 3.3211264610290527
Epoch: 3, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.668 Vali Acc: 0.322 Test Loss: 1.668 Test Acc: 0.322
Validation loss decreased (-0.244427 --> -0.322206).  Saving model ...
Epoch: 4 cost time: 3.465071678161621
Epoch: 4, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.578 Vali Acc: 0.433 Test Loss: 1.578 Test Acc: 0.433
Validation loss decreased (-0.322206 --> -0.433318).  Saving model ...
Epoch: 5 cost time: 3.027594804763794
Epoch: 5, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.486 Vali Acc: 0.506 Test Loss: 1.486 Test Acc: 0.506
Validation loss decreased (-0.433318 --> -0.505541).  Saving model ...
Epoch: 6 cost time: 3.1750800609588623
Epoch: 6, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.402 Vali Acc: 0.528 Test Loss: 1.402 Test Acc: 0.528
Validation loss decreased (-0.505541 --> -0.527764).  Saving model ...
Epoch: 7 cost time: 3.101321220397949
Epoch: 7, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.318 Vali Acc: 0.567 Test Loss: 1.318 Test Acc: 0.567
Validation loss decreased (-0.527764 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 2.9033257961273193
Epoch: 8, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.228 Vali Acc: 0.556 Test Loss: 1.228 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0367534160614014
Epoch: 9, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.155 Vali Acc: 0.606 Test Loss: 1.155 Test Acc: 0.606
Validation loss decreased (-0.566653 --> -0.605544).  Saving model ...
Epoch: 10 cost time: 2.9602909088134766
Epoch: 10, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.087 Vali Acc: 0.611 Test Loss: 1.087 Test Acc: 0.611
Validation loss decreased (-0.605544 --> -0.611100).  Saving model ...
Epoch: 11 cost time: 3.0628483295440674
Epoch: 11, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.002 Vali Acc: 0.617 Test Loss: 1.002 Test Acc: 0.617
Validation loss decreased (-0.611100 --> -0.616657).  Saving model ...
Epoch: 12 cost time: 3.193694829940796
Epoch: 12, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.928 Vali Acc: 0.633 Test Loss: 0.928 Test Acc: 0.633
Validation loss decreased (-0.616657 --> -0.633324).  Saving model ...
Epoch: 13 cost time: 3.085636615753174
Epoch: 13, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.875 Vali Acc: 0.633 Test Loss: 0.875 Test Acc: 0.633
Validation loss decreased (-0.633324 --> -0.633325).  Saving model ...
Epoch: 14 cost time: 3.1376793384552
Epoch: 14, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.813 Vali Acc: 0.678 Test Loss: 0.813 Test Acc: 0.678
Validation loss decreased (-0.633325 --> -0.677770).  Saving model ...
Epoch: 15 cost time: 3.3027796745300293
Epoch: 15, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.741 Vali Acc: 0.683 Test Loss: 0.741 Test Acc: 0.683
Validation loss decreased (-0.677770 --> -0.683326).  Saving model ...
Epoch: 16 cost time: 3.070385217666626
Epoch: 16, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.695 Vali Acc: 0.694 Test Loss: 0.695 Test Acc: 0.694
Validation loss decreased (-0.683326 --> -0.694437).  Saving model ...
Epoch: 17 cost time: 2.9892868995666504
Epoch: 17, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.651 Vali Acc: 0.694 Test Loss: 0.651 Test Acc: 0.694
Validation loss decreased (-0.694437 --> -0.694438).  Saving model ...
Epoch: 18 cost time: 3.1197311878204346
Epoch: 18, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.610 Vali Acc: 0.711 Test Loss: 0.610 Test Acc: 0.711
Validation loss decreased (-0.694438 --> -0.711105).  Saving model ...
Epoch: 19 cost time: 2.9693548679351807
Epoch: 19, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.558 Vali Acc: 0.761 Test Loss: 0.558 Test Acc: 0.761
Validation loss decreased (-0.711105 --> -0.761106).  Saving model ...
Epoch: 20 cost time: 3.0561864376068115
Epoch: 20, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.523 Vali Acc: 0.767 Test Loss: 0.523 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766661).  Saving model ...
Epoch: 21 cost time: 3.2435593605041504
Epoch: 21, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.500 Vali Acc: 0.778 Test Loss: 0.500 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 22 cost time: 3.0516152381896973
Epoch: 22, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.464 Vali Acc: 0.817 Test Loss: 0.464 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816662).  Saving model ...
Epoch: 23 cost time: 3.0306262969970703
Epoch: 23, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.448 Vali Acc: 0.794 Test Loss: 0.448 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2348875999450684
Epoch: 24, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.433 Vali Acc: 0.817 Test Loss: 0.433 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 25 cost time: 3.2323811054229736
Epoch: 25, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.434 Vali Acc: 0.806 Test Loss: 0.434 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.495151996612549
Epoch: 26, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1818089485168457
Epoch: 27, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 28 cost time: 3.2255265712738037
Epoch: 28, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 3.2368040084838867
Epoch: 29, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.383 Vali Acc: 0.811 Test Loss: 0.383 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.105529546737671
Epoch: 30, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 31 cost time: 3.196455955505371
Epoch: 31, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.120748281478882
Epoch: 32, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.4074740409851074
Epoch: 33, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 34 cost time: 3.4197237491607666
Epoch: 34, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 35 cost time: 3.6763131618499756
Epoch: 35, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 36 cost time: 3.439734697341919
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2020678520202637
Epoch: 37, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 38 cost time: 2.7701475620269775
Epoch: 38, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.9683010578155518
Epoch: 39, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.900725841522217
Epoch: 40, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.0541443824768066
Epoch: 41, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 42 cost time: 3.294919967651367
Epoch: 42, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 43 cost time: 3.5307185649871826
Epoch: 43, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.33701491355896
Epoch: 44, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.276 Vali Acc: 0.856 Test Loss: 0.276 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.6820154190063477
Epoch: 45, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 46 cost time: 3.1145143508911133
Epoch: 46, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.2150936126708984
Epoch: 47, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.256647825241089
Epoch: 48, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 3.243004083633423
Epoch: 49, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 3.33693528175354
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 3.4788262844085693
Epoch: 51, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 52 cost time: 3.3493261337280273
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 53 cost time: 3.5200648307800293
Epoch: 53, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.160444498062134
Epoch: 54, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.9719419479370117
Epoch: 55, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 56 cost time: 2.9106032848358154
Epoch: 56, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 57 cost time: 2.944192886352539
Epoch: 57, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 58 cost time: 3.0602986812591553
Epoch: 58, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 59 cost time: 3.344254970550537
Epoch: 59, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.2555956840515137
Epoch: 60, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 3.36264967918396
Epoch: 61, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 62 cost time: 2.861860752105713
Epoch: 62, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.194 Vali Acc: 0.911 Test Loss: 0.194 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.9696695804595947
Epoch: 63, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.915675401687622
Epoch: 64, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.2755093574523926
Epoch: 65, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 66 cost time: 3.133082628250122
Epoch: 66, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 3.311800241470337
Epoch: 67, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.5039615631103516
Epoch: 68, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.305903673171997
Epoch: 69, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.2597172260284424
Epoch: 70, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.1416900157928467
Epoch: 71, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.1273090839385986
Epoch: 72, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.9459681510925293
Epoch: 73, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.0218560695648193
Epoch: 74, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 2.9519684314727783
Epoch: 75, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 3.2786865234375
Epoch: 76, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.768080949783325
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.828 Vali Acc: 0.122 Test Loss: 1.828 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 3.2821242809295654
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.777 Vali Acc: 0.211 Test Loss: 1.777 Test Acc: 0.211
Validation loss decreased (-0.122204 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 3.6133034229278564
Epoch: 3, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.720 Vali Acc: 0.283 Test Loss: 1.720 Test Acc: 0.283
Validation loss decreased (-0.211093 --> -0.283316).  Saving model ...
Epoch: 4 cost time: 3.7157235145568848
Epoch: 4, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.652 Vali Acc: 0.333 Test Loss: 1.652 Test Acc: 0.333
Validation loss decreased (-0.283316 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 3.4676623344421387
Epoch: 5, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.581 Vali Acc: 0.400 Test Loss: 1.581 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 3.400700807571411
Epoch: 6, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.514 Vali Acc: 0.417 Test Loss: 1.514 Test Acc: 0.417
Validation loss decreased (-0.399984 --> -0.416652).  Saving model ...
Epoch: 7 cost time: 3.563542366027832
Epoch: 7, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.444 Vali Acc: 0.417 Test Loss: 1.444 Test Acc: 0.417
Validation loss decreased (-0.416652 --> -0.416652).  Saving model ...
Epoch: 8 cost time: 3.4524145126342773
Epoch: 8, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.367 Vali Acc: 0.422 Test Loss: 1.367 Test Acc: 0.422
Validation loss decreased (-0.416652 --> -0.422209).  Saving model ...
Epoch: 9 cost time: 3.6559338569641113
Epoch: 9, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.298 Vali Acc: 0.483 Test Loss: 1.298 Test Acc: 0.483
Validation loss decreased (-0.422209 --> -0.483320).  Saving model ...
Epoch: 10 cost time: 3.6221206188201904
Epoch: 10, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.231 Vali Acc: 0.506 Test Loss: 1.231 Test Acc: 0.506
Validation loss decreased (-0.483320 --> -0.505543).  Saving model ...
Epoch: 11 cost time: 3.437514305114746
Epoch: 11, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
Validation loss decreased (-0.505543 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 4.173466920852661
Epoch: 12, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.075 Vali Acc: 0.561 Test Loss: 1.075 Test Acc: 0.561
Validation loss decreased (-0.533322 --> -0.561100).  Saving model ...
Epoch: 13 cost time: 3.2071545124053955
Epoch: 13, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.010 Vali Acc: 0.611 Test Loss: 1.010 Test Acc: 0.611
Validation loss decreased (-0.561100 --> -0.611101).  Saving model ...
Epoch: 14 cost time: 3.571925163269043
Epoch: 14, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.935 Vali Acc: 0.644 Test Loss: 0.935 Test Acc: 0.644
Validation loss decreased (-0.611101 --> -0.644435).  Saving model ...
Epoch: 15 cost time: 3.213238477706909
Epoch: 15, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.857 Vali Acc: 0.661 Test Loss: 0.857 Test Acc: 0.661
Validation loss decreased (-0.644435 --> -0.661103).  Saving model ...
Epoch: 16 cost time: 3.463578462600708
Epoch: 16, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.796 Vali Acc: 0.667 Test Loss: 0.796 Test Acc: 0.667
Validation loss decreased (-0.661103 --> -0.666659).  Saving model ...
Epoch: 17 cost time: 3.017961263656616
Epoch: 17, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.734 Vali Acc: 0.700 Test Loss: 0.734 Test Acc: 0.700
Validation loss decreased (-0.666659 --> -0.699993).  Saving model ...
Epoch: 18 cost time: 3.1357858180999756
Epoch: 18, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.676 Vali Acc: 0.711 Test Loss: 0.676 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711104).  Saving model ...
Epoch: 19 cost time: 3.287909507751465
Epoch: 19, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.614 Vali Acc: 0.739 Test Loss: 0.614 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738883).  Saving model ...
Epoch: 20 cost time: 2.685561180114746
Epoch: 20, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.575 Vali Acc: 0.744 Test Loss: 0.575 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744439).  Saving model ...
Epoch: 21 cost time: 2.9802157878875732
Epoch: 21, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755550).  Saving model ...
Epoch: 22 cost time: 3.450775384902954
Epoch: 22, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.493 Vali Acc: 0.794 Test Loss: 0.493 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794440).  Saving model ...
Epoch: 23 cost time: 3.5433406829833984
Epoch: 23, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.475 Vali Acc: 0.794 Test Loss: 0.475 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 24 cost time: 3.537257194519043
Epoch: 24, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.450 Vali Acc: 0.806 Test Loss: 0.450 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 25 cost time: 3.6183159351348877
Epoch: 25, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.449 Vali Acc: 0.789 Test Loss: 0.449 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.205754518508911
Epoch: 26, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.416 Vali Acc: 0.800 Test Loss: 0.416 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.132626533508301
Epoch: 27, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.402 Vali Acc: 0.811 Test Loss: 0.402 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 28 cost time: 3.138172149658203
Epoch: 28, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.391 Vali Acc: 0.806 Test Loss: 0.391 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0947232246398926
Epoch: 29, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.374 Vali Acc: 0.833 Test Loss: 0.374 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 30 cost time: 3.3772530555725098
Epoch: 30, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 31 cost time: 3.5766310691833496
Epoch: 31, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5399179458618164
Epoch: 32, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 3.3180150985717773
Epoch: 33, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.314697265625
Epoch: 34, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 35 cost time: 3.03532338142395
Epoch: 35, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 3.0800106525421143
Epoch: 36, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.91576886177063
Epoch: 37, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 38 cost time: 2.8212826251983643
Epoch: 38, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.5379440784454346
Epoch: 39, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.501803398132324
Epoch: 40, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 41 cost time: 3.8495070934295654
Epoch: 41, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 42 cost time: 3.05727219581604
Epoch: 42, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 43 cost time: 3.2550737857818604
Epoch: 43, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.1997601985931396
Epoch: 44, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 45 cost time: 3.23724102973938
Epoch: 45, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 46 cost time: 3.3034448623657227
Epoch: 46, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 3.4276609420776367
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.5413084030151367
Epoch: 48, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.5110087394714355
Epoch: 49, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.268740653991699
Epoch: 50, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 51 cost time: 2.905306577682495
Epoch: 51, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 52 cost time: 3.070244550704956
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.137012481689453
Epoch: 53, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.0217199325561523
Epoch: 54, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.667833089828491
Epoch: 55, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 3.3189406394958496
Epoch: 56, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.4159927368164062
Epoch: 57, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.0503013134002686
Epoch: 58, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.3583831787109375
Epoch: 59, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.5991146564483643
Epoch: 60, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.2711689472198486
Epoch: 61, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.5822699069976807
Epoch: 62, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.489598512649536
Epoch: 63, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.450924873352051
Epoch: 64, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.358590841293335
Epoch: 65, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.486312627792358
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.776 Vali Acc: 0.200 Test Loss: 1.776 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 3.255894660949707
Epoch: 2, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.738 Vali Acc: 0.267 Test Loss: 1.738 Test Acc: 0.267
Validation loss decreased (-0.199982 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 3.030935049057007
Epoch: 3, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.700 Vali Acc: 0.278 Test Loss: 1.700 Test Acc: 0.278
Validation loss decreased (-0.266649 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 3.1963794231414795
Epoch: 4, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.652 Vali Acc: 0.317 Test Loss: 1.652 Test Acc: 0.317
Validation loss decreased (-0.277761 --> -0.316650).  Saving model ...
Epoch: 5 cost time: 3.0280957221984863
Epoch: 5, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.601 Vali Acc: 0.356 Test Loss: 1.601 Test Acc: 0.356
Validation loss decreased (-0.316650 --> -0.355540).  Saving model ...
Epoch: 6 cost time: 3.151355743408203
Epoch: 6, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.555 Vali Acc: 0.383 Test Loss: 1.555 Test Acc: 0.383
Validation loss decreased (-0.355540 --> -0.383318).  Saving model ...
Epoch: 7 cost time: 3.2410125732421875
Epoch: 7, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.508 Vali Acc: 0.378 Test Loss: 1.508 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6330599784851074
Epoch: 8, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.450 Vali Acc: 0.400 Test Loss: 1.450 Test Acc: 0.400
Validation loss decreased (-0.383318 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 3.383009433746338
Epoch: 9, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.396 Vali Acc: 0.400 Test Loss: 1.396 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 3.0634069442749023
Epoch: 10, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.341 Vali Acc: 0.456 Test Loss: 1.341 Test Acc: 0.456
Validation loss decreased (-0.399986 --> -0.455542).  Saving model ...
Epoch: 11 cost time: 2.9585015773773193
Epoch: 11, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.261 Vali Acc: 0.478 Test Loss: 1.261 Test Acc: 0.478
Validation loss decreased (-0.455542 --> -0.477765).  Saving model ...
Epoch: 12 cost time: 2.9490671157836914
Epoch: 12, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.194 Vali Acc: 0.478 Test Loss: 1.194 Test Acc: 0.478
Validation loss decreased (-0.477765 --> -0.477766).  Saving model ...
Epoch: 13 cost time: 3.245121479034424
Epoch: 13, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.123 Vali Acc: 0.511 Test Loss: 1.123 Test Acc: 0.511
Validation loss decreased (-0.477766 --> -0.511100).  Saving model ...
Epoch: 14 cost time: 3.1692757606506348
Epoch: 14, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.037 Vali Acc: 0.528 Test Loss: 1.037 Test Acc: 0.528
Validation loss decreased (-0.511100 --> -0.527767).  Saving model ...
Epoch: 15 cost time: 3.3565433025360107
Epoch: 15, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.949 Vali Acc: 0.556 Test Loss: 0.949 Test Acc: 0.556
Validation loss decreased (-0.527767 --> -0.555546).  Saving model ...
Epoch: 16 cost time: 3.528465747833252
Epoch: 16, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.873 Vali Acc: 0.622 Test Loss: 0.873 Test Acc: 0.622
Validation loss decreased (-0.555546 --> -0.622213).  Saving model ...
Epoch: 17 cost time: 3.3006558418273926
Epoch: 17, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.804 Vali Acc: 0.644 Test Loss: 0.804 Test Acc: 0.644
Validation loss decreased (-0.622213 --> -0.644436).  Saving model ...
Epoch: 18 cost time: 3.1990737915039062
Epoch: 18, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.744 Vali Acc: 0.694 Test Loss: 0.744 Test Acc: 0.694
Validation loss decreased (-0.644436 --> -0.694437).  Saving model ...
Epoch: 19 cost time: 2.775456428527832
Epoch: 19, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.688 Vali Acc: 0.694 Test Loss: 0.688 Test Acc: 0.694
Validation loss decreased (-0.694437 --> -0.694438).  Saving model ...
Epoch: 20 cost time: 3.1816608905792236
Epoch: 20, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.645 Vali Acc: 0.694 Test Loss: 0.645 Test Acc: 0.694
Validation loss decreased (-0.694438 --> -0.694438).  Saving model ...
Epoch: 21 cost time: 2.9031269550323486
Epoch: 21, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.613 Vali Acc: 0.694 Test Loss: 0.613 Test Acc: 0.694
Validation loss decreased (-0.694438 --> -0.694438).  Saving model ...
Epoch: 22 cost time: 3.0203895568847656
Epoch: 22, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.562 Vali Acc: 0.739 Test Loss: 0.562 Test Acc: 0.739
Validation loss decreased (-0.694438 --> -0.738883).  Saving model ...
Epoch: 23 cost time: 3.140739679336548
Epoch: 23, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.532 Vali Acc: 0.750 Test Loss: 0.532 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749995).  Saving model ...
Epoch: 24 cost time: 3.435797691345215
Epoch: 24, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.507 Vali Acc: 0.750 Test Loss: 0.507 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 25 cost time: 3.456390619277954
Epoch: 25, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.506 Vali Acc: 0.750 Test Loss: 0.506 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 26 cost time: 2.9450647830963135
Epoch: 26, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772217).  Saving model ...
Epoch: 27 cost time: 2.9921116828918457
Epoch: 27, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.463 Vali Acc: 0.750 Test Loss: 0.463 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.193910598754883
Epoch: 28, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.440 Vali Acc: 0.778 Test Loss: 0.440 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 29 cost time: 3.486294984817505
Epoch: 29, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.437 Vali Acc: 0.783 Test Loss: 0.437 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 30 cost time: 3.4092488288879395
Epoch: 30, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.426 Vali Acc: 0.778 Test Loss: 0.426 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.570364475250244
Epoch: 31, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.410 Vali Acc: 0.789 Test Loss: 0.410 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 32 cost time: 3.7338149547576904
Epoch: 32, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.389 Vali Acc: 0.794 Test Loss: 0.389 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794441).  Saving model ...
Epoch: 33 cost time: 3.3857836723327637
Epoch: 33, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
Validation loss decreased (-0.794441 --> -0.799996).  Saving model ...
Epoch: 34 cost time: 3.5077064037323
Epoch: 34, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1214280128479004
Epoch: 35, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.05277681350708
Epoch: 36, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.401 Vali Acc: 0.794 Test Loss: 0.401 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.341712236404419
Epoch: 37, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 38 cost time: 3.2783360481262207
Epoch: 38, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 39 cost time: 3.296665668487549
Epoch: 39, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.394350051879883
Epoch: 40, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 41 cost time: 3.0570337772369385
Epoch: 41, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 42 cost time: 3.0457396507263184
Epoch: 42, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.356 Vali Acc: 0.856 Test Loss: 0.356 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 43 cost time: 3.024021625518799
Epoch: 43, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 44 cost time: 3.0831973552703857
Epoch: 44, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 45 cost time: 3.2188973426818848
Epoch: 45, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2800426483154297
Epoch: 46, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.334 Vali Acc: 0.883 Test Loss: 0.334 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 47 cost time: 3.32682204246521
Epoch: 47, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.5042011737823486
Epoch: 48, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.1628105640411377
Epoch: 49, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 3.1190285682678223
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.950589656829834
Epoch: 51, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.871206760406494
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.354 Vali Acc: 0.883 Test Loss: 0.354 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.6248114109039307
Epoch: 53, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.883 Test Loss: 0.351 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.329615354537964
Epoch: 54, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 55 cost time: 3.3053359985351562
Epoch: 55, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 56 cost time: 3.0997703075408936
Epoch: 56, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.253002643585205
Epoch: 57, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.2777645587921143
Epoch: 58, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.382 Vali Acc: 0.894 Test Loss: 0.382 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.995778799057007
Epoch: 59, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.2243142127990723
Epoch: 60, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.3101651668548584
Epoch: 61, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 62 cost time: 3.6101298332214355
Epoch: 62, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.2979750633239746
Epoch: 63, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.4817025661468506
Epoch: 64, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.4143564701080322
Epoch: 65, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.2998757362365723
Epoch: 66, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.1324799060821533
Epoch: 67, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 3.363189220428467
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 3.3059277534484863
Epoch: 69, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 3.4475460052490234
Epoch: 70, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 71 cost time: 3.1327788829803467
Epoch: 71, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.1646125316619873
Epoch: 72, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.31882643699646
Epoch: 73, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.899819850921631
Epoch: 74, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.358 Vali Acc: 0.894 Test Loss: 0.358 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.260927200317383
Epoch: 75, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 76 cost time: 3.3844099044799805
Epoch: 76, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.3616254329681396
Epoch: 77, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.2352454662323
Epoch: 78, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.2160115242004395
Epoch: 79, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 3.4521594047546387
Epoch: 80, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.2009034156799316
Epoch: 81, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 3.1692094802856445
Epoch: 82, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 3.557756185531616
Epoch: 83, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 3.1701700687408447
Epoch: 84, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 3.3190972805023193
Epoch: 85, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 3.253382444381714
Epoch: 86, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 3.3880207538604736
Epoch: 87, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 3.161926507949829
Epoch: 88, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 3.1269443035125732
Epoch: 89, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.059971332550049
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.807 Vali Acc: 0.211 Test Loss: 1.807 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 3.4250240325927734
Epoch: 2, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.776 Vali Acc: 0.211 Test Loss: 1.776 Test Acc: 0.211
Validation loss decreased (-0.211093 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 3.009810447692871
Epoch: 3, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.754 Vali Acc: 0.200 Test Loss: 1.754 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.417660713195801
Epoch: 4, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.722 Vali Acc: 0.189 Test Loss: 1.722 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.867072582244873
Epoch: 5, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.684 Vali Acc: 0.211 Test Loss: 1.684 Test Acc: 0.211
Validation loss decreased (-0.211093 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 3.1892430782318115
Epoch: 6, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.651 Vali Acc: 0.233 Test Loss: 1.651 Test Acc: 0.233
Validation loss decreased (-0.211094 --> -0.233317).  Saving model ...
Epoch: 7 cost time: 3.2165589332580566
Epoch: 7, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.617 Vali Acc: 0.239 Test Loss: 1.617 Test Acc: 0.239
Validation loss decreased (-0.233317 --> -0.238873).  Saving model ...
Epoch: 8 cost time: 3.4715018272399902
Epoch: 8, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.569 Vali Acc: 0.272 Test Loss: 1.569 Test Acc: 0.272
Validation loss decreased (-0.238873 --> -0.272207).  Saving model ...
Epoch: 9 cost time: 3.4978623390197754
Epoch: 9, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (-0.272207 --> -0.299985).  Saving model ...
Epoch: 10 cost time: 3.0157482624053955
Epoch: 10, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.472 Vali Acc: 0.328 Test Loss: 1.472 Test Acc: 0.328
Validation loss decreased (-0.299985 --> -0.327763).  Saving model ...
Epoch: 11 cost time: 3.03310489654541
Epoch: 11, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.353 Vali Acc: 0.428 Test Loss: 1.353 Test Acc: 0.428
Validation loss decreased (-0.327763 --> -0.427764).  Saving model ...
Epoch: 12 cost time: 3.0227479934692383
Epoch: 12, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.247 Vali Acc: 0.467 Test Loss: 1.247 Test Acc: 0.467
Validation loss decreased (-0.427764 --> -0.466654).  Saving model ...
Epoch: 13 cost time: 2.890294075012207
Epoch: 13, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.097 Vali Acc: 0.556 Test Loss: 1.097 Test Acc: 0.556
Validation loss decreased (-0.466654 --> -0.555545).  Saving model ...
Epoch: 14 cost time: 3.46686053276062
Epoch: 14, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.945 Vali Acc: 0.583 Test Loss: 0.945 Test Acc: 0.583
Validation loss decreased (-0.555545 --> -0.583324).  Saving model ...
Epoch: 15 cost time: 3.5343167781829834
Epoch: 15, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.843 Vali Acc: 0.583 Test Loss: 0.843 Test Acc: 0.583
Validation loss decreased (-0.583324 --> -0.583325).  Saving model ...
Epoch: 16 cost time: 3.6417973041534424
Epoch: 16, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.784 Vali Acc: 0.611 Test Loss: 0.784 Test Acc: 0.611
Validation loss decreased (-0.583325 --> -0.611103).  Saving model ...
Epoch: 17 cost time: 3.348200798034668
Epoch: 17, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.734 Vali Acc: 0.628 Test Loss: 0.734 Test Acc: 0.628
Validation loss decreased (-0.611103 --> -0.627770).  Saving model ...
Epoch: 18 cost time: 3.198277235031128
Epoch: 18, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.682 Vali Acc: 0.661 Test Loss: 0.682 Test Acc: 0.661
Validation loss decreased (-0.627770 --> -0.661104).  Saving model ...
Epoch: 19 cost time: 3.3725547790527344
Epoch: 19, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.622 Vali Acc: 0.694 Test Loss: 0.622 Test Acc: 0.694
Validation loss decreased (-0.661104 --> -0.694438).  Saving model ...
Epoch: 20 cost time: 3.507699489593506
Epoch: 20, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.558 Vali Acc: 0.733 Test Loss: 0.558 Test Acc: 0.733
Validation loss decreased (-0.694438 --> -0.733328).  Saving model ...
Epoch: 21 cost time: 3.184218406677246
Epoch: 21, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.524 Vali Acc: 0.744 Test Loss: 0.524 Test Acc: 0.744
Validation loss decreased (-0.733328 --> -0.744439).  Saving model ...
Epoch: 22 cost time: 3.4716837406158447
Epoch: 22, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.477 Vali Acc: 0.744 Test Loss: 0.477 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744440).  Saving model ...
Epoch: 23 cost time: 3.5244393348693848
Epoch: 23, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.447 Vali Acc: 0.761 Test Loss: 0.447 Test Acc: 0.761
Validation loss decreased (-0.744440 --> -0.761107).  Saving model ...
Epoch: 24 cost time: 3.333758592605591
Epoch: 24, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.428 Vali Acc: 0.761 Test Loss: 0.428 Test Acc: 0.761
Validation loss decreased (-0.761107 --> -0.761107).  Saving model ...
Epoch: 25 cost time: 3.152831554412842
Epoch: 25, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.419 Vali Acc: 0.772 Test Loss: 0.419 Test Acc: 0.772
Validation loss decreased (-0.761107 --> -0.772218).  Saving model ...
Epoch: 26 cost time: 2.9554388523101807
Epoch: 26, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.390 Vali Acc: 0.789 Test Loss: 0.390 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 27 cost time: 2.750988245010376
Epoch: 27, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.368 Vali Acc: 0.800 Test Loss: 0.368 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 28 cost time: 2.964426279067993
Epoch: 28, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.361 Vali Acc: 0.806 Test Loss: 0.361 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 29 cost time: 3.2992608547210693
Epoch: 29, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.387472152709961
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 31 cost time: 3.455038070678711
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 32 cost time: 3.308098077774048
Epoch: 32, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 33 cost time: 3.1773226261138916
Epoch: 33, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.344259738922119
Epoch: 34, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 35 cost time: 3.1197056770324707
Epoch: 35, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 36 cost time: 3.321239948272705
Epoch: 36, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 37 cost time: 3.555692434310913
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 38 cost time: 3.4529342651367188
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2755959033966064
Epoch: 39, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 3.415393590927124
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.1270499229431152
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.355804204940796
Epoch: 42, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.683016061782837
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 44 cost time: 3.5564045906066895
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 45 cost time: 3.4137697219848633
Epoch: 45, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.21050763130188
Epoch: 46, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.836881160736084
Epoch: 47, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.099311113357544
Epoch: 48, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.389463186264038
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.739600896835327
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 3.5908684730529785
Epoch: 51, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.628145217895508
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.4994559288024902
Epoch: 53, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.2189812660217285
Epoch: 54, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.1826345920562744
Epoch: 55, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.296 Vali Acc: 0.928 Test Loss: 0.296 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 56 cost time: 3.545253038406372
Epoch: 56, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.481051445007324
Epoch: 57, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.464503526687622
Epoch: 58, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.3048598766326904
Epoch: 59, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.1495673656463623
Epoch: 60, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.0535542964935303
Epoch: 61, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.8479602336883545
Epoch: 62, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.4983930587768555
Epoch: 63, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.478106737136841
Epoch: 64, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.9285874366760254
Epoch: 65, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.134398460388184
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.811 Vali Acc: 0.139 Test Loss: 1.811 Test Acc: 0.139
Validation loss decreased (inf --> -0.138871).  Saving model ...
Epoch: 2 cost time: 3.1677982807159424
Epoch: 2, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.793 Vali Acc: 0.183 Test Loss: 1.793 Test Acc: 0.183
Validation loss decreased (-0.138871 --> -0.183315).  Saving model ...
Epoch: 3 cost time: 2.951683759689331
Epoch: 3, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.782 Vali Acc: 0.206 Test Loss: 1.782 Test Acc: 0.206
Validation loss decreased (-0.183315 --> -0.205538).  Saving model ...
Epoch: 4 cost time: 3.4517500400543213
Epoch: 4, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.762 Vali Acc: 0.211 Test Loss: 1.762 Test Acc: 0.211
Validation loss decreased (-0.205538 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 2.8822479248046875
Epoch: 5, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.739 Vali Acc: 0.233 Test Loss: 1.739 Test Acc: 0.233
Validation loss decreased (-0.211093 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 3.127755641937256
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.716 Vali Acc: 0.239 Test Loss: 1.716 Test Acc: 0.239
Validation loss decreased (-0.233316 --> -0.238872).  Saving model ...
Epoch: 7 cost time: 2.9755961894989014
Epoch: 7, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.687 Vali Acc: 0.239 Test Loss: 1.687 Test Acc: 0.239
Validation loss decreased (-0.238872 --> -0.238872).  Saving model ...
Epoch: 8 cost time: 3.3976752758026123
Epoch: 8, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.642 Vali Acc: 0.244 Test Loss: 1.642 Test Acc: 0.244
Validation loss decreased (-0.238872 --> -0.244428).  Saving model ...
Epoch: 9 cost time: 3.5149927139282227
Epoch: 9, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.583 Vali Acc: 0.250 Test Loss: 1.583 Test Acc: 0.250
Validation loss decreased (-0.244428 --> -0.249984).  Saving model ...
Epoch: 10 cost time: 3.531475067138672
Epoch: 10, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.494 Vali Acc: 0.322 Test Loss: 1.494 Test Acc: 0.322
Validation loss decreased (-0.249984 --> -0.322207).  Saving model ...
Epoch: 11 cost time: 3.737156629562378
Epoch: 11, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.327 Vali Acc: 0.456 Test Loss: 1.327 Test Acc: 0.456
Validation loss decreased (-0.322207 --> -0.455542).  Saving model ...
Epoch: 12 cost time: 3.27032732963562
Epoch: 12, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.162 Vali Acc: 0.561 Test Loss: 1.162 Test Acc: 0.561
Validation loss decreased (-0.455542 --> -0.561099).  Saving model ...
Epoch: 13 cost time: 3.078425168991089
Epoch: 13, Steps: 12 | Train Loss: 1.080 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.561099 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 2.9030425548553467
Epoch: 14, Steps: 12 | Train Loss: 0.964 Vali Loss: 0.855 Vali Acc: 0.617 Test Loss: 0.855 Test Acc: 0.617
Validation loss decreased (-0.599990 --> -0.616658).  Saving model ...
Epoch: 15 cost time: 3.092362403869629
Epoch: 15, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.774 Vali Acc: 0.639 Test Loss: 0.774 Test Acc: 0.639
Validation loss decreased (-0.616658 --> -0.638881).  Saving model ...
Epoch: 16 cost time: 3.1983158588409424
Epoch: 16, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.736 Vali Acc: 0.661 Test Loss: 0.736 Test Acc: 0.661
Validation loss decreased (-0.638881 --> -0.661104).  Saving model ...
Epoch: 17 cost time: 3.3210809230804443
Epoch: 17, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.699 Vali Acc: 0.639 Test Loss: 0.699 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1284773349761963
Epoch: 18, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.655 Vali Acc: 0.689 Test Loss: 0.655 Test Acc: 0.689
Validation loss decreased (-0.661104 --> -0.688882).  Saving model ...
Epoch: 19 cost time: 3.1064612865448
Epoch: 19, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.605 Vali Acc: 0.711 Test Loss: 0.605 Test Acc: 0.711
Validation loss decreased (-0.688882 --> -0.711105).  Saving model ...
Epoch: 20 cost time: 2.923447847366333
Epoch: 20, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.568 Vali Acc: 0.728 Test Loss: 0.568 Test Acc: 0.728
Validation loss decreased (-0.711105 --> -0.727772).  Saving model ...
Epoch: 21 cost time: 2.920727014541626
Epoch: 21, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.532 Vali Acc: 0.744 Test Loss: 0.532 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 22 cost time: 3.383303642272949
Epoch: 22, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.471 Vali Acc: 0.761 Test Loss: 0.471 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 23 cost time: 3.4474165439605713
Epoch: 23, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.451 Vali Acc: 0.772 Test Loss: 0.451 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 24 cost time: 3.453756332397461
Epoch: 24, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.414 Vali Acc: 0.778 Test Loss: 0.414 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777774).  Saving model ...
Epoch: 25 cost time: 3.19850754737854
Epoch: 25, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.429 Vali Acc: 0.767 Test Loss: 0.429 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.055753707885742
Epoch: 26, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.391 Vali Acc: 0.772 Test Loss: 0.391 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.215552806854248
Epoch: 27, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
Validation loss decreased (-0.777774 --> -0.805552).  Saving model ...
Epoch: 28 cost time: 3.4024922847747803
Epoch: 28, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.370 Vali Acc: 0.806 Test Loss: 0.370 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 29 cost time: 3.3999440670013428
Epoch: 29, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 30 cost time: 3.6113457679748535
Epoch: 30, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 31 cost time: 3.2132060527801514
Epoch: 31, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3242013454437256
Epoch: 32, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 33 cost time: 3.212496757507324
Epoch: 33, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.405094623565674
Epoch: 34, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.635819435119629
Epoch: 35, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 36 cost time: 3.647791624069214
Epoch: 36, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.4413628578186035
Epoch: 37, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.1735222339630127
Epoch: 38, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 39 cost time: 3.317214250564575
Epoch: 39, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.4016366004943848
Epoch: 40, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.637247085571289
Epoch: 41, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.3840413093566895
Epoch: 42, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 43 cost time: 3.651519536972046
Epoch: 43, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.8756136894226074
Epoch: 44, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 45 cost time: 3.4323477745056152
Epoch: 45, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.307300329208374
Epoch: 46, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 47 cost time: 3.66890811920166
Epoch: 47, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 48 cost time: 3.6372334957122803
Epoch: 48, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 49 cost time: 3.817565441131592
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.1798200607299805
Epoch: 50, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.287365198135376
Epoch: 51, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.1665141582489014
Epoch: 52, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.254770278930664
Epoch: 53, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.837960720062256
Epoch: 54, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.592736005783081
Epoch: 55, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.9579834938049316
Epoch: 56, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 3.2941908836364746
Epoch: 57, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.105712652206421
Epoch: 58, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.2035906314849854
Epoch: 59, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 60 cost time: 3.6452488899230957
Epoch: 60, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.5408077239990234
Epoch: 61, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.3551177978515625
Epoch: 62, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.413316249847412
Epoch: 63, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 3.1567294597625732
Epoch: 64, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.3078808784484863
Epoch: 65, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.558537006378174
Epoch: 66, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 3.32366943359375
Epoch: 67, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.3128502368927
Epoch: 68, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.774580478668213
Epoch: 69, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.617218255996704
Epoch: 70, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 3.479142665863037
Epoch: 71, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.028770923614502
Epoch: 72, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 3.1593430042266846
Epoch: 73, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.674935817718506
Epoch: 74, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.5329806804656982
Epoch: 75, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 3.7302563190460205
Epoch: 76, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.219286918640137
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.821 Vali Acc: 0.150 Test Loss: 1.821 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 3.442486524581909
Epoch: 2, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.807 Vali Acc: 0.167 Test Loss: 1.807 Test Acc: 0.167
Validation loss decreased (-0.149982 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.6181607246398926
Epoch: 3, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.790 Vali Acc: 0.189 Test Loss: 1.790 Test Acc: 0.189
Validation loss decreased (-0.166649 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 3.0961427688598633
Epoch: 4, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.765 Vali Acc: 0.200 Test Loss: 1.765 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 3.2298591136932373
Epoch: 5, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.734 Vali Acc: 0.244 Test Loss: 1.734 Test Acc: 0.244
Validation loss decreased (-0.199982 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 3.3201708793640137
Epoch: 6, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.690 Vali Acc: 0.289 Test Loss: 1.690 Test Acc: 0.289
Validation loss decreased (-0.244427 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 3.3642144203186035
Epoch: 7, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.633 Vali Acc: 0.322 Test Loss: 1.633 Test Acc: 0.322
Validation loss decreased (-0.288872 --> -0.322206).  Saving model ...
Epoch: 8 cost time: 3.413364887237549
Epoch: 8, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.551 Vali Acc: 0.389 Test Loss: 1.551 Test Acc: 0.389
Validation loss decreased (-0.322206 --> -0.388873).  Saving model ...
Epoch: 9 cost time: 3.2630834579467773
Epoch: 9, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.449 Vali Acc: 0.422 Test Loss: 1.449 Test Acc: 0.422
Validation loss decreased (-0.388873 --> -0.422208).  Saving model ...
Epoch: 10 cost time: 2.754145860671997
Epoch: 10, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.333 Vali Acc: 0.456 Test Loss: 1.333 Test Acc: 0.456
Validation loss decreased (-0.422208 --> -0.455542).  Saving model ...
Epoch: 11 cost time: 2.974604845046997
Epoch: 11, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.196 Vali Acc: 0.506 Test Loss: 1.196 Test Acc: 0.506
Validation loss decreased (-0.455542 --> -0.505544).  Saving model ...
Epoch: 12 cost time: 3.27013897895813
Epoch: 12, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.076 Vali Acc: 0.544 Test Loss: 1.076 Test Acc: 0.544
Validation loss decreased (-0.505544 --> -0.544434).  Saving model ...
Epoch: 13 cost time: 3.4232099056243896
Epoch: 13, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.004 Vali Acc: 0.539 Test Loss: 1.004 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.839845657348633
Epoch: 14, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.953 Vali Acc: 0.550 Test Loss: 0.953 Test Acc: 0.550
Validation loss decreased (-0.544434 --> -0.549990).  Saving model ...
Epoch: 15 cost time: 3.177985429763794
Epoch: 15, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.921 Vali Acc: 0.522 Test Loss: 0.921 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6996569633483887
Epoch: 16, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.879 Vali Acc: 0.594 Test Loss: 0.879 Test Acc: 0.594
Validation loss decreased (-0.549990 --> -0.594436).  Saving model ...
Epoch: 17 cost time: 3.0673272609710693
Epoch: 17, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.828 Vali Acc: 0.600 Test Loss: 0.828 Test Acc: 0.600
Validation loss decreased (-0.594436 --> -0.599992).  Saving model ...
Epoch: 18 cost time: 3.3144304752349854
Epoch: 18, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.759 Vali Acc: 0.633 Test Loss: 0.759 Test Acc: 0.633
Validation loss decreased (-0.599992 --> -0.633326).  Saving model ...
Epoch: 19 cost time: 3.1547799110412598
Epoch: 19, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.673 Vali Acc: 0.667 Test Loss: 0.673 Test Acc: 0.667
Validation loss decreased (-0.633326 --> -0.666660).  Saving model ...
Epoch: 20 cost time: 3.000274181365967
Epoch: 20, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.585 Vali Acc: 0.711 Test Loss: 0.585 Test Acc: 0.711
Validation loss decreased (-0.666660 --> -0.711105).  Saving model ...
Epoch: 21 cost time: 3.005849838256836
Epoch: 21, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.547 Vali Acc: 0.711 Test Loss: 0.547 Test Acc: 0.711
Validation loss decreased (-0.711105 --> -0.711106).  Saving model ...
Epoch: 22 cost time: 3.328054189682007
Epoch: 22, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.477 Vali Acc: 0.750 Test Loss: 0.477 Test Acc: 0.750
Validation loss decreased (-0.711106 --> -0.749995).  Saving model ...
Epoch: 23 cost time: 3.3557546138763428
Epoch: 23, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.414 Vali Acc: 0.789 Test Loss: 0.414 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.788885).  Saving model ...
Epoch: 24 cost time: 3.529778480529785
Epoch: 24, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.396 Vali Acc: 0.772 Test Loss: 0.396 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0914764404296875
Epoch: 25, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.398 Vali Acc: 0.761 Test Loss: 0.398 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.28633189201355
Epoch: 26, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.388 Vali Acc: 0.783 Test Loss: 0.388 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.2355120182037354
Epoch: 27, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 28 cost time: 3.544788360595703
Epoch: 28, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.374 Vali Acc: 0.794 Test Loss: 0.374 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5195910930633545
Epoch: 29, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.354 Vali Acc: 0.806 Test Loss: 0.354 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 30 cost time: 3.244652032852173
Epoch: 30, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.330 Vali Acc: 0.806 Test Loss: 0.330 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 31 cost time: 3.263963222503662
Epoch: 31, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.357 Vali Acc: 0.811 Test Loss: 0.357 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811108).  Saving model ...
Epoch: 32 cost time: 3.056880235671997
Epoch: 32, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
Validation loss decreased (-0.811108 --> -0.822219).  Saving model ...
Epoch: 33 cost time: 3.348301410675049
Epoch: 33, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.349 Vali Acc: 0.806 Test Loss: 0.349 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4420018196105957
Epoch: 34, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.356 Vali Acc: 0.811 Test Loss: 0.356 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.9380993843078613
Epoch: 35, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.327 Vali Acc: 0.822 Test Loss: 0.327 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 36 cost time: 3.095475912094116
Epoch: 36, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.7901782989501953
Epoch: 37, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.368 Vali Acc: 0.811 Test Loss: 0.368 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4275941848754883
Epoch: 38, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 39 cost time: 3.442537784576416
Epoch: 39, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.7215800285339355
Epoch: 40, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.3278753757476807
Epoch: 41, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.245136260986328
Epoch: 42, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 43 cost time: 3.496483087539673
Epoch: 43, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.359 Vali Acc: 0.856 Test Loss: 0.359 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.6215250492095947
Epoch: 44, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 3.6340413093566895
Epoch: 45, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.321058988571167
Epoch: 46, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 47 cost time: 3.3886709213256836
Epoch: 47, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.011735677719116
Epoch: 48, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 49 cost time: 3.5180273056030273
Epoch: 49, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3585243225097656
Epoch: 50, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905552).  Saving model ...
Epoch: 51 cost time: 3.3813600540161133
Epoch: 51, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 52 cost time: 3.227977752685547
Epoch: 52, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.874047040939331
Epoch: 53, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.34139084815979
Epoch: 54, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.2545907497406006
Epoch: 55, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.213 Vali Acc: 0.894 Test Loss: 0.213 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.4994943141937256
Epoch: 56, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.146207094192505
Epoch: 57, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.1787688732147217
Epoch: 58, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 59 cost time: 3.4587323665618896
Epoch: 59, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.287398338317871
Epoch: 60, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.7071969509124756
Epoch: 61, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.1483514308929443
Epoch: 62, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.3498663902282715
Epoch: 63, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.45456600189209
Epoch: 64, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.4833571910858154
Epoch: 65, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.1919636726379395
Epoch: 66, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.3447651863098145
Epoch: 67, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.5435378551483154
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.349 Vali Acc: 0.928 Test Loss: 0.349 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.413172960281372
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.804 Vali Acc: 0.189 Test Loss: 1.804 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 2.943647861480713
Epoch: 2, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.790 Vali Acc: 0.228 Test Loss: 1.790 Test Acc: 0.228
Validation loss decreased (-0.188871 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 2.816790819168091
Epoch: 3, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.776 Vali Acc: 0.239 Test Loss: 1.776 Test Acc: 0.239
Validation loss decreased (-0.227760 --> -0.238871).  Saving model ...
Epoch: 4 cost time: 3.5221951007843018
Epoch: 4, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.750 Vali Acc: 0.261 Test Loss: 1.750 Test Acc: 0.261
Validation loss decreased (-0.238871 --> -0.261094).  Saving model ...
Epoch: 5 cost time: 3.546060085296631
Epoch: 5, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.715 Vali Acc: 0.328 Test Loss: 1.715 Test Acc: 0.328
Validation loss decreased (-0.261094 --> -0.327761).  Saving model ...
Epoch: 6 cost time: 3.430631399154663
Epoch: 6, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.671 Vali Acc: 0.361 Test Loss: 1.671 Test Acc: 0.361
Validation loss decreased (-0.327761 --> -0.361094).  Saving model ...
Epoch: 7 cost time: 3.236818313598633
Epoch: 7, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.611 Vali Acc: 0.383 Test Loss: 1.611 Test Acc: 0.383
Validation loss decreased (-0.361094 --> -0.383317).  Saving model ...
Epoch: 8 cost time: 3.491680383682251
Epoch: 8, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.527 Vali Acc: 0.422 Test Loss: 1.527 Test Acc: 0.422
Validation loss decreased (-0.383317 --> -0.422207).  Saving model ...
Epoch: 9 cost time: 3.5067131519317627
Epoch: 9, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.418 Vali Acc: 0.494 Test Loss: 1.418 Test Acc: 0.494
Validation loss decreased (-0.422207 --> -0.494430).  Saving model ...
Epoch: 10 cost time: 3.5473079681396484
Epoch: 10, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.299 Vali Acc: 0.567 Test Loss: 1.299 Test Acc: 0.567
Validation loss decreased (-0.494430 --> -0.566654).  Saving model ...
Epoch: 11 cost time: 3.1051321029663086
Epoch: 11, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.164 Vali Acc: 0.606 Test Loss: 1.164 Test Acc: 0.606
Validation loss decreased (-0.566654 --> -0.605544).  Saving model ...
Epoch: 12 cost time: 3.125615119934082
Epoch: 12, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.051 Vali Acc: 0.583 Test Loss: 1.051 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6417038440704346
Epoch: 13, Steps: 12 | Train Loss: 1.080 Vali Loss: 0.981 Vali Acc: 0.539 Test Loss: 0.981 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.473358392715454
Epoch: 14, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.931 Vali Acc: 0.550 Test Loss: 0.931 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.422285318374634
Epoch: 15, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.906 Vali Acc: 0.561 Test Loss: 0.906 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9733197689056396
Epoch: 16, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.882 Vali Acc: 0.572 Test Loss: 0.882 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.012406826019287
Epoch: 17, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.836 Vali Acc: 0.583 Test Loss: 0.836 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.342268466949463
Epoch: 18, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.769 Vali Acc: 0.650 Test Loss: 0.769 Test Acc: 0.650
Validation loss decreased (-0.605544 --> -0.649992).  Saving model ...
Epoch: 19 cost time: 3.536036729812622
Epoch: 19, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.698 Vali Acc: 0.656 Test Loss: 0.698 Test Acc: 0.656
Validation loss decreased (-0.649992 --> -0.655549).  Saving model ...
Epoch: 20 cost time: 3.3448753356933594
Epoch: 20, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.614 Vali Acc: 0.700 Test Loss: 0.614 Test Acc: 0.700
Validation loss decreased (-0.655549 --> -0.699994).  Saving model ...
Epoch: 21 cost time: 3.123610019683838
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.560 Vali Acc: 0.728 Test Loss: 0.560 Test Acc: 0.728
Validation loss decreased (-0.699994 --> -0.727772).  Saving model ...
Epoch: 22 cost time: 2.9404349327087402
Epoch: 22, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.492 Vali Acc: 0.739 Test Loss: 0.492 Test Acc: 0.739
Validation loss decreased (-0.727772 --> -0.738884).  Saving model ...
Epoch: 23 cost time: 3.486698627471924
Epoch: 23, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
Validation loss decreased (-0.738884 --> -0.794440).  Saving model ...
Epoch: 24 cost time: 3.498760938644409
Epoch: 24, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 25 cost time: 3.434605836868286
Epoch: 25, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 26 cost time: 3.2272961139678955
Epoch: 26, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.390 Vali Acc: 0.767 Test Loss: 0.390 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.567455291748047
Epoch: 27, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.375 Vali Acc: 0.789 Test Loss: 0.375 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8510677814483643
Epoch: 28, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.358 Vali Acc: 0.806 Test Loss: 0.358 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 29 cost time: 3.8011369705200195
Epoch: 29, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.344 Vali Acc: 0.800 Test Loss: 0.344 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2690439224243164
Epoch: 30, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.327 Vali Acc: 0.822 Test Loss: 0.327 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 31 cost time: 3.285322904586792
Epoch: 31, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.337 Vali Acc: 0.806 Test Loss: 0.337 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.7155473232269287
Epoch: 32, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 33 cost time: 3.5529942512512207
Epoch: 33, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.325 Vali Acc: 0.811 Test Loss: 0.325 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.6824898719787598
Epoch: 34, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.338 Vali Acc: 0.794 Test Loss: 0.338 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.5271897315979004
Epoch: 35, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.310 Vali Acc: 0.822 Test Loss: 0.310 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.4857938289642334
Epoch: 36, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.9742448329925537
Epoch: 37, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.296 Vali Acc: 0.822 Test Loss: 0.296 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.4722530841827393
Epoch: 38, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.268 Vali Acc: 0.844 Test Loss: 0.268 Test Acc: 0.844
Validation loss decreased (-0.827775 --> -0.844442).  Saving model ...
Epoch: 39 cost time: 3.127554416656494
Epoch: 39, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0612566471099854
Epoch: 40, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.292 Vali Acc: 0.833 Test Loss: 0.292 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.046983480453491
Epoch: 41, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.844442 --> -0.849997).  Saving model ...
Epoch: 42 cost time: 3.560270071029663
Epoch: 42, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.260 Vali Acc: 0.856 Test Loss: 0.260 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 43 cost time: 3.421196937561035
Epoch: 43, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.115565776824951
Epoch: 44, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.855553 --> -0.894442).  Saving model ...
Epoch: 45 cost time: 3.1893928050994873
Epoch: 45, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.0964722633361816
Epoch: 46, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 3.414370536804199
Epoch: 47, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.219 Vali Acc: 0.883 Test Loss: 0.219 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.5289533138275146
Epoch: 48, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.0506176948547363
Epoch: 49, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.024125576019287
Epoch: 50, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.2932815551757812
Epoch: 51, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.3803954124450684
Epoch: 52, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 3.4372527599334717
Epoch: 53, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.1034226417541504
Epoch: 54, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.1760847568511963
Epoch: 55, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.181 Vali Acc: 0.911 Test Loss: 0.181 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.1552035808563232
Epoch: 56, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 57 cost time: 3.289682626724243
Epoch: 57, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.5205166339874268
Epoch: 58, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.224395990371704
Epoch: 59, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.102863073348999
Epoch: 60, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.939 Test Loss: 0.219 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 61 cost time: 3.415235757827759
Epoch: 61, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.415464162826538
Epoch: 62, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.939 Test Loss: 0.173 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 63 cost time: 3.551272392272949
Epoch: 63, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.1906700134277344
Epoch: 64, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.073063850402832
Epoch: 65, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.081028938293457
Epoch: 66, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.028552770614624
Epoch: 67, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 3.323763132095337
Epoch: 68, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 3.198573589324951
Epoch: 69, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 3.3195276260375977
Epoch: 70, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 3.053974151611328
Epoch: 71, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 3.168715715408325
Epoch: 72, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 67174
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.704470157623291
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 3.085405111312866
Epoch: 2, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 3.672506093978882
Epoch: 3, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.485600471496582
Epoch: 4, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2301087379455566
Epoch: 5, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.374610424041748
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.416804313659668
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4900758266448975
Epoch: 8, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.30483078956604
Epoch: 9, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.2317051887512207
Epoch: 10, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.163625478744507
Epoch: 11, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.274033546447754
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_FEDformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.16666666666666666
model parameter : 67174
model size : 1.50MB
