Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.379098653793335
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.377 Vali Acc: 0.597 Test Loss: 1.377 Test Acc: 0.597
Validation loss decreased (inf --> -0.597208).  Saving model ...
Epoch: 2 cost time: 11.883981466293335
Epoch: 2, Steps: 7 | Train Loss: 0.381 Vali Loss: 1.407 Vali Acc: 0.819 Test Loss: 1.407 Test Acc: 0.819
Validation loss decreased (-0.597208 --> -0.819430).  Saving model ...
Epoch: 3 cost time: 12.200430154800415
Epoch: 3, Steps: 7 | Train Loss: 0.069 Vali Loss: 3.182 Vali Acc: 0.708 Test Loss: 3.182 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.7851243019104
Epoch: 4, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.994 Vali Acc: 0.792 Test Loss: 2.994 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.469590902328491
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.260 Vali Acc: 0.806 Test Loss: 3.260 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.500223636627197
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.622 Vali Acc: 0.667 Test Loss: 4.622 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.79665493965149
Epoch: 7, Steps: 7 | Train Loss: 0.242 Vali Loss: 4.876 Vali Acc: 0.722 Test Loss: 4.876 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.869381427764893
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 8.456 Vali Acc: 0.653 Test Loss: 8.456 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.591066122055054
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 4.611 Vali Acc: 0.778 Test Loss: 4.611 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.0804603099823
Epoch: 10, Steps: 7 | Train Loss: 0.185 Vali Loss: 5.326 Vali Acc: 0.778 Test Loss: 5.326 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.795632362365723
Epoch: 11, Steps: 7 | Train Loss: 0.822 Vali Loss: 6.348 Vali Acc: 0.722 Test Loss: 6.348 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.781992197036743
Epoch: 12, Steps: 7 | Train Loss: 0.263 Vali Loss: 8.825 Vali Acc: 0.653 Test Loss: 8.825 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.671652793884277
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 1.609 Vali Acc: 0.597 Test Loss: 1.609 Test Acc: 0.597
Validation loss decreased (inf --> -0.597206).  Saving model ...
Epoch: 2 cost time: 9.523841142654419
Epoch: 2, Steps: 7 | Train Loss: 0.583 Vali Loss: 1.460 Vali Acc: 0.708 Test Loss: 1.460 Test Acc: 0.708
Validation loss decreased (-0.597206 --> -0.708319).  Saving model ...
Epoch: 3 cost time: 11.730145931243896
Epoch: 3, Steps: 7 | Train Loss: 0.037 Vali Loss: 2.876 Vali Acc: 0.694 Test Loss: 2.876 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.320294857025146
Epoch: 4, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.554 Vali Acc: 0.778 Test Loss: 2.554 Test Acc: 0.778
Validation loss decreased (-0.708319 --> -0.777752).  Saving model ...
Epoch: 5 cost time: 10.711499214172363
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.722 Test Loss: 2.548 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.829591512680054
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.738 Vali Acc: 0.722 Test Loss: 2.738 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.112027883529663
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.912 Vali Acc: 0.778 Test Loss: 2.912 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.376789808273315
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.466 Vali Acc: 0.722 Test Loss: 3.466 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.422802925109863
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.918 Vali Acc: 0.708 Test Loss: 3.918 Test Acc: 0.708
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.836971998214722
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.831 Vali Acc: 0.722 Test Loss: 3.831 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.150532722473145
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.676 Vali Acc: 0.722 Test Loss: 3.676 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.30073595046997
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.608 Vali Acc: 0.722 Test Loss: 3.608 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.917415618896484
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.722 Test Loss: 3.576 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.780604124069214
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.559 Vali Acc: 0.708 Test Loss: 3.559 Test Acc: 0.708
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.461133480072021
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.021 Vali Acc: 0.375 Test Loss: 2.021 Test Acc: 0.375
Validation loss decreased (inf --> -0.374980).  Saving model ...
Epoch: 2 cost time: 12.001789093017578
Epoch: 2, Steps: 7 | Train Loss: 0.898 Vali Loss: 2.264 Vali Acc: 0.597 Test Loss: 2.264 Test Acc: 0.597
Validation loss decreased (-0.374980 --> -0.597200).  Saving model ...
Epoch: 3 cost time: 9.193111419677734
Epoch: 3, Steps: 7 | Train Loss: 0.128 Vali Loss: 2.562 Vali Acc: 0.694 Test Loss: 2.562 Test Acc: 0.694
Validation loss decreased (-0.597200 --> -0.694419).  Saving model ...
Epoch: 4 cost time: 8.61181092262268
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.643 Vali Acc: 0.653 Test Loss: 3.643 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.051344394683838
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 2.968 Vali Acc: 0.625 Test Loss: 2.968 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.12004566192627
Epoch: 6, Steps: 7 | Train Loss: 0.027 Vali Loss: 6.056 Vali Acc: 0.653 Test Loss: 6.056 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.540955305099487
Epoch: 7, Steps: 7 | Train Loss: 0.720 Vali Loss: 5.844 Vali Acc: 0.611 Test Loss: 5.844 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.013981342315674
Epoch: 8, Steps: 7 | Train Loss: 0.266 Vali Loss: 5.269 Vali Acc: 0.569 Test Loss: 5.269 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.132690191268921
Epoch: 9, Steps: 7 | Train Loss: 0.379 Vali Loss: 6.702 Vali Acc: 0.681 Test Loss: 6.702 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.285944700241089
Epoch: 10, Steps: 7 | Train Loss: 0.218 Vali Loss: 8.836 Vali Acc: 0.611 Test Loss: 8.836 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.52140474319458
Epoch: 11, Steps: 7 | Train Loss: 0.044 Vali Loss: 7.978 Vali Acc: 0.667 Test Loss: 7.978 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.432944059371948
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 17.037 Vali Acc: 0.431 Test Loss: 17.037 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.098814725875854
Epoch: 13, Steps: 7 | Train Loss: 1.504 Vali Loss: 8.288 Vali Acc: 0.611 Test Loss: 8.288 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6944444444444444
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.274500131607056
Epoch: 1, Steps: 7 | Train Loss: 2.609 Vali Loss: 2.455 Vali Acc: 0.222 Test Loss: 2.455 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 7.0712878704071045
Epoch: 2, Steps: 7 | Train Loss: 0.930 Vali Loss: 2.400 Vali Acc: 0.486 Test Loss: 2.400 Test Acc: 0.486
Validation loss decreased (-0.222198 --> -0.486087).  Saving model ...
Epoch: 3 cost time: 7.394591331481934
Epoch: 3, Steps: 7 | Train Loss: 0.145 Vali Loss: 3.944 Vali Acc: 0.569 Test Loss: 3.944 Test Acc: 0.569
Validation loss decreased (-0.486087 --> -0.569405).  Saving model ...
Epoch: 4 cost time: 9.931310653686523
Epoch: 4, Steps: 7 | Train Loss: 0.057 Vali Loss: 3.196 Vali Acc: 0.597 Test Loss: 3.196 Test Acc: 0.597
Validation loss decreased (-0.569405 --> -0.597190).  Saving model ...
Epoch: 5 cost time: 6.376798391342163
Epoch: 5, Steps: 7 | Train Loss: 0.018 Vali Loss: 3.369 Vali Acc: 0.569 Test Loss: 3.369 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.27025032043457
Epoch: 6, Steps: 7 | Train Loss: 0.055 Vali Loss: 3.670 Vali Acc: 0.597 Test Loss: 3.670 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.9165990352630615
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 4.206 Vali Acc: 0.583 Test Loss: 4.206 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.181583404541016
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 4.174 Vali Acc: 0.611 Test Loss: 4.174 Test Acc: 0.611
Validation loss decreased (-0.597190 --> -0.611069).  Saving model ...
Epoch: 9 cost time: 7.432545185089111
Epoch: 9, Steps: 7 | Train Loss: 0.161 Vali Loss: 3.931 Vali Acc: 0.708 Test Loss: 3.931 Test Acc: 0.708
Validation loss decreased (-0.611069 --> -0.708294).  Saving model ...
Epoch: 10 cost time: 8.498210906982422
Epoch: 10, Steps: 7 | Train Loss: 0.605 Vali Loss: 4.831 Vali Acc: 0.625 Test Loss: 4.831 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.090913772583008
Epoch: 11, Steps: 7 | Train Loss: 0.160 Vali Loss: 5.795 Vali Acc: 0.597 Test Loss: 5.795 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.26447868347168
Epoch: 12, Steps: 7 | Train Loss: 0.152 Vali Loss: 10.635 Vali Acc: 0.500 Test Loss: 10.635 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.356963872909546
Epoch: 13, Steps: 7 | Train Loss: 0.765 Vali Loss: 10.581 Vali Acc: 0.597 Test Loss: 10.581 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.124620914459229
Epoch: 14, Steps: 7 | Train Loss: 0.996 Vali Loss: 13.004 Vali Acc: 0.514 Test Loss: 13.004 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.303609371185303
Epoch: 15, Steps: 7 | Train Loss: 0.526 Vali Loss: 12.609 Vali Acc: 0.528 Test Loss: 12.609 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.313555479049683
Epoch: 16, Steps: 7 | Train Loss: 1.366 Vali Loss: 20.203 Vali Acc: 0.486 Test Loss: 20.203 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.280528783798218
Epoch: 17, Steps: 7 | Train Loss: 0.698 Vali Loss: 16.989 Vali Acc: 0.500 Test Loss: 16.989 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.509293556213379
Epoch: 18, Steps: 7 | Train Loss: 0.598 Vali Loss: 15.623 Vali Acc: 0.528 Test Loss: 15.623 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.193443059921265
Epoch: 19, Steps: 7 | Train Loss: 0.706 Vali Loss: 19.434 Vali Acc: 0.514 Test Loss: 19.434 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7083333333333334
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.174504041671753
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.674 Vali Acc: 0.236 Test Loss: 2.674 Test Acc: 0.236
Validation loss decreased (inf --> -0.236084).  Saving model ...
Epoch: 2 cost time: 7.712656259536743
Epoch: 2, Steps: 7 | Train Loss: 0.993 Vali Loss: 3.250 Vali Acc: 0.306 Test Loss: 3.250 Test Acc: 0.306
Validation loss decreased (-0.236084 --> -0.305523).  Saving model ...
Epoch: 3 cost time: 8.632148504257202
Epoch: 3, Steps: 7 | Train Loss: 0.108 Vali Loss: 5.649 Vali Acc: 0.375 Test Loss: 5.649 Test Acc: 0.375
Validation loss decreased (-0.305523 --> -0.374944).  Saving model ...
Epoch: 4 cost time: 6.540949821472168
Epoch: 4, Steps: 7 | Train Loss: 0.156 Vali Loss: 5.218 Vali Acc: 0.306 Test Loss: 5.218 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.092741012573242
Epoch: 5, Steps: 7 | Train Loss: 0.403 Vali Loss: 7.457 Vali Acc: 0.333 Test Loss: 7.457 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.272480726242065
Epoch: 6, Steps: 7 | Train Loss: 0.249 Vali Loss: 10.325 Vali Acc: 0.347 Test Loss: 10.325 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.274045705795288
Epoch: 7, Steps: 7 | Train Loss: 0.098 Vali Loss: 6.718 Vali Acc: 0.403 Test Loss: 6.718 Test Acc: 0.403
Validation loss decreased (-0.374944 --> -0.402711).  Saving model ...
Epoch: 8 cost time: 6.0595879554748535
Epoch: 8, Steps: 7 | Train Loss: 0.106 Vali Loss: 11.566 Vali Acc: 0.250 Test Loss: 11.566 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.915663242340088
Epoch: 9, Steps: 7 | Train Loss: 0.151 Vali Loss: 12.024 Vali Acc: 0.306 Test Loss: 12.024 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.376996994018555
Epoch: 10, Steps: 7 | Train Loss: 0.318 Vali Loss: 10.800 Vali Acc: 0.361 Test Loss: 10.800 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.551675319671631
Epoch: 11, Steps: 7 | Train Loss: 1.203 Vali Loss: 12.963 Vali Acc: 0.444 Test Loss: 12.963 Test Acc: 0.444
Validation loss decreased (-0.402711 --> -0.444315).  Saving model ...
Epoch: 12 cost time: 5.341965675354004
Epoch: 12, Steps: 7 | Train Loss: 1.579 Vali Loss: 16.251 Vali Acc: 0.403 Test Loss: 16.251 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.569905996322632
Epoch: 13, Steps: 7 | Train Loss: 0.475 Vali Loss: 13.527 Vali Acc: 0.361 Test Loss: 13.527 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.388321399688721
Epoch: 14, Steps: 7 | Train Loss: 0.318 Vali Loss: 23.137 Vali Acc: 0.333 Test Loss: 23.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.872691631317139
Epoch: 15, Steps: 7 | Train Loss: 0.624 Vali Loss: 16.392 Vali Acc: 0.417 Test Loss: 16.392 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.462578535079956
Epoch: 16, Steps: 7 | Train Loss: 0.312 Vali Loss: 22.072 Vali Acc: 0.431 Test Loss: 22.072 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.503098487854004
Epoch: 17, Steps: 7 | Train Loss: 1.005 Vali Loss: 17.695 Vali Acc: 0.389 Test Loss: 17.695 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.574762344360352
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 27.643 Vali Acc: 0.458 Test Loss: 27.643 Test Acc: 0.458
Validation loss decreased (-0.444315 --> -0.458057).  Saving model ...
Epoch: 19 cost time: 7.151479005813599
Epoch: 19, Steps: 7 | Train Loss: 0.528 Vali Loss: 18.245 Vali Acc: 0.500 Test Loss: 18.245 Test Acc: 0.500
Validation loss decreased (-0.458057 --> -0.499818).  Saving model ...
Epoch: 20 cost time: 7.750447034835815
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 18.061 Vali Acc: 0.472 Test Loss: 18.061 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.553784608840942
Epoch: 21, Steps: 7 | Train Loss: 0.059 Vali Loss: 19.632 Vali Acc: 0.431 Test Loss: 19.632 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.80218505859375
Epoch: 22, Steps: 7 | Train Loss: 0.036 Vali Loss: 16.331 Vali Acc: 0.472 Test Loss: 16.331 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.420132398605347
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 17.721 Vali Acc: 0.528 Test Loss: 17.721 Test Acc: 0.528
Validation loss decreased (-0.499818 --> -0.527601).  Saving model ...
Epoch: 24 cost time: 7.429213047027588
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.571 Vali Acc: 0.542 Test Loss: 19.571 Test Acc: 0.542
Validation loss decreased (-0.527601 --> -0.541471).  Saving model ...
Epoch: 25 cost time: 7.734413146972656
Epoch: 25, Steps: 7 | Train Loss: 0.049 Vali Loss: 16.524 Vali Acc: 0.486 Test Loss: 16.524 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.04677414894104
Epoch: 26, Steps: 7 | Train Loss: 0.877 Vali Loss: 29.733 Vali Acc: 0.417 Test Loss: 29.733 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.2111711502075195
Epoch: 27, Steps: 7 | Train Loss: 0.806 Vali Loss: 33.458 Vali Acc: 0.250 Test Loss: 33.458 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.722965717315674
Epoch: 28, Steps: 7 | Train Loss: 1.481 Vali Loss: 20.523 Vali Acc: 0.528 Test Loss: 20.523 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.107217788696289
Epoch: 29, Steps: 7 | Train Loss: 0.279 Vali Loss: 18.111 Vali Acc: 0.583 Test Loss: 18.111 Test Acc: 0.583
Validation loss decreased (-0.541471 --> -0.583152).  Saving model ...
Epoch: 30 cost time: 8.463362216949463
Epoch: 30, Steps: 7 | Train Loss: 0.370 Vali Loss: 16.133 Vali Acc: 0.625 Test Loss: 16.133 Test Acc: 0.625
Validation loss decreased (-0.583152 --> -0.624839).  Saving model ...
Epoch: 31 cost time: 5.776915788650513
Epoch: 31, Steps: 7 | Train Loss: 0.379 Vali Loss: 22.625 Vali Acc: 0.528 Test Loss: 22.625 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.123782634735107
Epoch: 32, Steps: 7 | Train Loss: 0.349 Vali Loss: 27.329 Vali Acc: 0.389 Test Loss: 27.329 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 9.064640760421753
Epoch: 33, Steps: 7 | Train Loss: 0.409 Vali Loss: 24.403 Vali Acc: 0.514 Test Loss: 24.403 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 8.506798267364502
Epoch: 34, Steps: 7 | Train Loss: 0.650 Vali Loss: 30.775 Vali Acc: 0.375 Test Loss: 30.775 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 8.146305799484253
Epoch: 35, Steps: 7 | Train Loss: 0.664 Vali Loss: 28.601 Vali Acc: 0.514 Test Loss: 28.601 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 7.793528079986572
Epoch: 36, Steps: 7 | Train Loss: 0.949 Vali Loss: 32.216 Vali Acc: 0.514 Test Loss: 32.216 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 7.598366975784302
Epoch: 37, Steps: 7 | Train Loss: 2.012 Vali Loss: 28.909 Vali Acc: 0.458 Test Loss: 28.909 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 8.219241619110107
Epoch: 38, Steps: 7 | Train Loss: 0.196 Vali Loss: 33.321 Vali Acc: 0.458 Test Loss: 33.321 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 7.153841018676758
Epoch: 39, Steps: 7 | Train Loss: 0.436 Vali Loss: 42.732 Vali Acc: 0.403 Test Loss: 42.732 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 7.825017690658569
Epoch: 40, Steps: 7 | Train Loss: 0.717 Vali Loss: 45.124 Vali Acc: 0.444 Test Loss: 45.124 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.625
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.406712532043457
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.631 Vali Acc: 0.236 Test Loss: 2.631 Test Acc: 0.236
Validation loss decreased (inf --> -0.236085).  Saving model ...
Epoch: 2 cost time: 5.76121187210083
Epoch: 2, Steps: 7 | Train Loss: 1.172 Vali Loss: 2.850 Vali Acc: 0.236 Test Loss: 2.850 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.315706729888916
Epoch: 3, Steps: 7 | Train Loss: 0.145 Vali Loss: 3.509 Vali Acc: 0.417 Test Loss: 3.509 Test Acc: 0.417
Validation loss decreased (-0.236085 --> -0.416632).  Saving model ...
Epoch: 4 cost time: 7.384958505630493
Epoch: 4, Steps: 7 | Train Loss: 0.036 Vali Loss: 5.714 Vali Acc: 0.292 Test Loss: 5.714 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.665668964385986
Epoch: 5, Steps: 7 | Train Loss: 0.106 Vali Loss: 5.078 Vali Acc: 0.472 Test Loss: 5.078 Test Acc: 0.472
Validation loss decreased (-0.416632 --> -0.472171).  Saving model ...
Epoch: 6 cost time: 6.780458450317383
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 4.755 Vali Acc: 0.431 Test Loss: 4.755 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.496948957443237
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 8.564 Vali Acc: 0.361 Test Loss: 8.564 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.168464422225952
Epoch: 8, Steps: 7 | Train Loss: 0.089 Vali Loss: 5.736 Vali Acc: 0.417 Test Loss: 5.736 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.528376817703247
Epoch: 9, Steps: 7 | Train Loss: 0.093 Vali Loss: 4.932 Vali Acc: 0.389 Test Loss: 4.932 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.576217889785767
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.756 Vali Acc: 0.417 Test Loss: 7.756 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.4021196365356445
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 7.205 Vali Acc: 0.417 Test Loss: 7.205 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.154693126678467
Epoch: 12, Steps: 7 | Train Loss: 0.184 Vali Loss: 12.123 Vali Acc: 0.319 Test Loss: 12.123 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.595553874969482
Epoch: 13, Steps: 7 | Train Loss: 0.098 Vali Loss: 13.097 Vali Acc: 0.306 Test Loss: 13.097 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.625112056732178
Epoch: 14, Steps: 7 | Train Loss: 1.563 Vali Loss: 14.439 Vali Acc: 0.417 Test Loss: 14.439 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.626277446746826
Epoch: 15, Steps: 7 | Train Loss: 2.376 Vali Loss: 13.725 Vali Acc: 0.389 Test Loss: 13.725 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.088472366333008
Epoch: 1, Steps: 7 | Train Loss: 2.663 Vali Loss: 2.558 Vali Acc: 0.222 Test Loss: 2.558 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 7.20586633682251
Epoch: 2, Steps: 7 | Train Loss: 1.244 Vali Loss: 2.159 Vali Acc: 0.389 Test Loss: 2.159 Test Acc: 0.389
Validation loss decreased (-0.222197 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 4.87505578994751
Epoch: 3, Steps: 7 | Train Loss: 0.214 Vali Loss: 2.936 Vali Acc: 0.403 Test Loss: 2.936 Test Acc: 0.403
Validation loss decreased (-0.388867 --> -0.402748).  Saving model ...
Epoch: 4 cost time: 5.560344696044922
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 3.817 Vali Acc: 0.333 Test Loss: 3.817 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.280343294143677
Epoch: 5, Steps: 7 | Train Loss: 0.121 Vali Loss: 6.289 Vali Acc: 0.236 Test Loss: 6.289 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.362317323684692
Epoch: 6, Steps: 7 | Train Loss: 0.098 Vali Loss: 4.797 Vali Acc: 0.403 Test Loss: 4.797 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.261326789855957
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 4.085 Vali Acc: 0.431 Test Loss: 4.085 Test Acc: 0.431
Validation loss decreased (-0.402748 --> -0.430515).  Saving model ...
Epoch: 8 cost time: 6.158645391464233
Epoch: 8, Steps: 7 | Train Loss: 0.204 Vali Loss: 5.363 Vali Acc: 0.472 Test Loss: 5.363 Test Acc: 0.472
Validation loss decreased (-0.430515 --> -0.472169).  Saving model ...
Epoch: 9 cost time: 6.08432674407959
Epoch: 9, Steps: 7 | Train Loss: 0.152 Vali Loss: 6.383 Vali Acc: 0.431 Test Loss: 6.383 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.222792863845825
Epoch: 10, Steps: 7 | Train Loss: 0.260 Vali Loss: 8.604 Vali Acc: 0.375 Test Loss: 8.604 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.599314212799072
Epoch: 11, Steps: 7 | Train Loss: 0.124 Vali Loss: 8.426 Vali Acc: 0.444 Test Loss: 8.426 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.715971231460571
Epoch: 12, Steps: 7 | Train Loss: 0.259 Vali Loss: 7.706 Vali Acc: 0.444 Test Loss: 7.706 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.7922844886779785
Epoch: 13, Steps: 7 | Train Loss: 0.093 Vali Loss: 16.025 Vali Acc: 0.319 Test Loss: 16.025 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.346059322357178
Epoch: 14, Steps: 7 | Train Loss: 0.316 Vali Loss: 6.272 Vali Acc: 0.597 Test Loss: 6.272 Test Acc: 0.597
Validation loss decreased (-0.472169 --> -0.597160).  Saving model ...
Epoch: 15 cost time: 5.377514839172363
Epoch: 15, Steps: 7 | Train Loss: 0.380 Vali Loss: 7.888 Vali Acc: 0.542 Test Loss: 7.888 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.985016822814941
Epoch: 16, Steps: 7 | Train Loss: 0.314 Vali Loss: 10.822 Vali Acc: 0.472 Test Loss: 10.822 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.67786431312561
Epoch: 17, Steps: 7 | Train Loss: 0.292 Vali Loss: 21.115 Vali Acc: 0.389 Test Loss: 21.115 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.71087646484375
Epoch: 18, Steps: 7 | Train Loss: 0.537 Vali Loss: 16.713 Vali Acc: 0.306 Test Loss: 16.713 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.988822937011719
Epoch: 19, Steps: 7 | Train Loss: 0.470 Vali Loss: 8.313 Vali Acc: 0.486 Test Loss: 8.313 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.140170574188232
Epoch: 20, Steps: 7 | Train Loss: 0.042 Vali Loss: 11.433 Vali Acc: 0.500 Test Loss: 11.433 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.407758474349976
Epoch: 21, Steps: 7 | Train Loss: 0.094 Vali Loss: 12.885 Vali Acc: 0.458 Test Loss: 12.885 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.008851528167725
Epoch: 22, Steps: 7 | Train Loss: 0.154 Vali Loss: 24.507 Vali Acc: 0.375 Test Loss: 24.507 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.849050045013428
Epoch: 23, Steps: 7 | Train Loss: 0.451 Vali Loss: 10.747 Vali Acc: 0.486 Test Loss: 10.747 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.442348957061768
Epoch: 24, Steps: 7 | Train Loss: 0.134 Vali Loss: 11.664 Vali Acc: 0.472 Test Loss: 11.664 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5972222222222222
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.03818154335022
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.642 Vali Acc: 0.194 Test Loss: 2.642 Test Acc: 0.194
Validation loss decreased (inf --> -0.194418).  Saving model ...
Epoch: 2 cost time: 5.6849730014801025
Epoch: 2, Steps: 7 | Train Loss: 1.373 Vali Loss: 2.576 Vali Acc: 0.250 Test Loss: 2.576 Test Acc: 0.250
Validation loss decreased (-0.194418 --> -0.249974).  Saving model ...
Epoch: 3 cost time: 5.606980562210083
Epoch: 3, Steps: 7 | Train Loss: 0.256 Vali Loss: 3.646 Vali Acc: 0.431 Test Loss: 3.646 Test Acc: 0.431
Validation loss decreased (-0.249974 --> -0.430519).  Saving model ...
Epoch: 4 cost time: 6.4217798709869385
Epoch: 4, Steps: 7 | Train Loss: 0.070 Vali Loss: 5.930 Vali Acc: 0.181 Test Loss: 5.930 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.949581146240234
Epoch: 5, Steps: 7 | Train Loss: 0.057 Vali Loss: 4.896 Vali Acc: 0.278 Test Loss: 4.896 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.9928436279296875
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 4.334 Vali Acc: 0.361 Test Loss: 4.334 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.464382648468018
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.595 Vali Acc: 0.347 Test Loss: 6.595 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.411970138549805
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 8.088 Vali Acc: 0.306 Test Loss: 8.088 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.310141324996948
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 7.006 Vali Acc: 0.264 Test Loss: 7.006 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.505091428756714
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 6.639 Vali Acc: 0.264 Test Loss: 6.639 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.660205125808716
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 5.767 Vali Acc: 0.250 Test Loss: 5.767 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.315826654434204
Epoch: 12, Steps: 7 | Train Loss: 0.059 Vali Loss: 9.166 Vali Acc: 0.236 Test Loss: 9.166 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.562973976135254
Epoch: 13, Steps: 7 | Train Loss: 0.104 Vali Loss: 6.841 Vali Acc: 0.389 Test Loss: 6.841 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.349709510803223
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.605 Vali Acc: 0.250 Test Loss: 2.605 Test Acc: 0.250
Validation loss decreased (inf --> -0.249974).  Saving model ...
Epoch: 2 cost time: 5.955556154251099
Epoch: 2, Steps: 7 | Train Loss: 1.642 Vali Loss: 2.880 Vali Acc: 0.208 Test Loss: 2.880 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.9244349002838135
Epoch: 3, Steps: 7 | Train Loss: 0.547 Vali Loss: 3.308 Vali Acc: 0.264 Test Loss: 3.308 Test Acc: 0.264
Validation loss decreased (-0.249974 --> -0.263856).  Saving model ...
Epoch: 4 cost time: 6.635250568389893
Epoch: 4, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.775 Vali Acc: 0.306 Test Loss: 2.775 Test Acc: 0.306
Validation loss decreased (-0.263856 --> -0.305528).  Saving model ...
Epoch: 5 cost time: 4.985909461975098
Epoch: 5, Steps: 7 | Train Loss: 0.073 Vali Loss: 5.252 Vali Acc: 0.194 Test Loss: 5.252 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.478335380554199
Epoch: 6, Steps: 7 | Train Loss: 0.071 Vali Loss: 6.613 Vali Acc: 0.167 Test Loss: 6.613 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.875126123428345
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 7.300 Vali Acc: 0.153 Test Loss: 7.300 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.773096799850464
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 7.599 Vali Acc: 0.181 Test Loss: 7.599 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.103480815887451
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 7.294 Vali Acc: 0.250 Test Loss: 7.294 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.100277423858643
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.551 Vali Acc: 0.208 Test Loss: 6.551 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.363922357559204
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.175 Vali Acc: 0.306 Test Loss: 6.175 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.013521194458008
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.071 Vali Acc: 0.319 Test Loss: 6.071 Test Acc: 0.319
Validation loss decreased (-0.305528 --> -0.319384).  Saving model ...
Epoch: 13 cost time: 5.426171064376831
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.881 Vali Acc: 0.333 Test Loss: 5.881 Test Acc: 0.333
Validation loss decreased (-0.319384 --> -0.333275).  Saving model ...
Epoch: 14 cost time: 6.457923412322998
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.768 Vali Acc: 0.333 Test Loss: 5.768 Test Acc: 0.333
Validation loss decreased (-0.333275 --> -0.333276).  Saving model ...
Epoch: 15 cost time: 6.117283821105957
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.705 Vali Acc: 0.333 Test Loss: 5.705 Test Acc: 0.333
Validation loss decreased (-0.333276 --> -0.333276).  Saving model ...
Epoch: 16 cost time: 6.2364020347595215
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.670 Vali Acc: 0.333 Test Loss: 5.670 Test Acc: 0.333
Validation loss decreased (-0.333276 --> -0.333277).  Saving model ...
Epoch: 17 cost time: 6.260796070098877
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.646 Vali Acc: 0.347 Test Loss: 5.646 Test Acc: 0.347
Validation loss decreased (-0.333277 --> -0.347166).  Saving model ...
Epoch: 18 cost time: 5.357735633850098
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.631 Vali Acc: 0.347 Test Loss: 5.631 Test Acc: 0.347
Validation loss decreased (-0.347166 --> -0.347166).  Saving model ...
Epoch: 19 cost time: 5.406836271286011
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.620 Vali Acc: 0.361 Test Loss: 5.620 Test Acc: 0.361
Validation loss decreased (-0.347166 --> -0.361055).  Saving model ...
Epoch: 20 cost time: 5.884205102920532
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.610 Vali Acc: 0.361 Test Loss: 5.610 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361055).  Saving model ...
Epoch: 21 cost time: 6.747639417648315
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.600 Vali Acc: 0.361 Test Loss: 5.600 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361055).  Saving model ...
Epoch: 22 cost time: 6.394632577896118
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.591 Vali Acc: 0.361 Test Loss: 5.591 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361055).  Saving model ...
Epoch: 23 cost time: 6.276300668716431
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.582 Vali Acc: 0.361 Test Loss: 5.582 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361055).  Saving model ...
Epoch: 24 cost time: 5.225825786590576
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.573 Vali Acc: 0.361 Test Loss: 5.573 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361055).  Saving model ...
Epoch: 25 cost time: 5.511078119277954
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.566 Vali Acc: 0.361 Test Loss: 5.566 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361055).  Saving model ...
Epoch: 26 cost time: 6.638480186462402
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.560 Vali Acc: 0.361 Test Loss: 5.560 Test Acc: 0.361
Validation loss decreased (-0.361055 --> -0.361056).  Saving model ...
Epoch: 27 cost time: 7.2950053215026855
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.554 Vali Acc: 0.361 Test Loss: 5.554 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 28 cost time: 6.243717670440674
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.361 Test Loss: 5.546 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 29 cost time: 5.921508550643921
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.539 Vali Acc: 0.361 Test Loss: 5.539 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 30 cost time: 6.255325078964233
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.533 Vali Acc: 0.361 Test Loss: 5.533 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 31 cost time: 6.188734769821167
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.527 Vali Acc: 0.361 Test Loss: 5.527 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 32 cost time: 6.648423433303833
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.519 Vali Acc: 0.361 Test Loss: 5.519 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 33 cost time: 5.217773675918579
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.512 Vali Acc: 0.361 Test Loss: 5.512 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 34 cost time: 6.271685361862183
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.505 Vali Acc: 0.361 Test Loss: 5.505 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 35 cost time: 4.933618068695068
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.499 Vali Acc: 0.361 Test Loss: 5.499 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 36 cost time: 6.151321172714233
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.492 Vali Acc: 0.361 Test Loss: 5.492 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 37 cost time: 5.690252065658569
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.486 Vali Acc: 0.361 Test Loss: 5.486 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 38 cost time: 7.625962734222412
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.479 Vali Acc: 0.361 Test Loss: 5.479 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 39 cost time: 5.379680633544922
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.473 Vali Acc: 0.361 Test Loss: 5.473 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 40 cost time: 5.2025465965271
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.467 Vali Acc: 0.361 Test Loss: 5.467 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 41 cost time: 5.679816722869873
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.462 Vali Acc: 0.361 Test Loss: 5.462 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361056).  Saving model ...
Epoch: 42 cost time: 5.3985371589660645
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.456 Vali Acc: 0.361 Test Loss: 5.456 Test Acc: 0.361
Validation loss decreased (-0.361056 --> -0.361057).  Saving model ...
Epoch: 43 cost time: 6.441558837890625
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.450 Vali Acc: 0.361 Test Loss: 5.450 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 44 cost time: 6.5619096755981445
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.445 Vali Acc: 0.361 Test Loss: 5.445 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 45 cost time: 5.540496826171875
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.440 Vali Acc: 0.361 Test Loss: 5.440 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 46 cost time: 4.850114822387695
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.435 Vali Acc: 0.361 Test Loss: 5.435 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 47 cost time: 5.001871109008789
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.430 Vali Acc: 0.361 Test Loss: 5.430 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 48 cost time: 6.312017440795898
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.426 Vali Acc: 0.361 Test Loss: 5.426 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 49 cost time: 6.614492893218994
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.421 Vali Acc: 0.361 Test Loss: 5.421 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 50 cost time: 5.864264249801636
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.416 Vali Acc: 0.361 Test Loss: 5.416 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 51 cost time: 4.985515356063843
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.410 Vali Acc: 0.361 Test Loss: 5.410 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 52 cost time: 5.252731084823608
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.406 Vali Acc: 0.361 Test Loss: 5.406 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 53 cost time: 4.4777679443359375
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.403 Vali Acc: 0.361 Test Loss: 5.403 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 54 cost time: 4.715345144271851
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.399 Vali Acc: 0.361 Test Loss: 5.399 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 55 cost time: 5.850296497344971
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.396 Vali Acc: 0.361 Test Loss: 5.396 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 56 cost time: 5.136310338973999
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.393 Vali Acc: 0.361 Test Loss: 5.393 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 57 cost time: 5.731698751449585
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.389 Vali Acc: 0.361 Test Loss: 5.389 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 58 cost time: 5.811898469924927
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.385 Vali Acc: 0.361 Test Loss: 5.385 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 59 cost time: 5.685807943344116
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.381 Vali Acc: 0.361 Test Loss: 5.381 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 60 cost time: 5.014589071273804
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.378 Vali Acc: 0.361 Test Loss: 5.378 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 61 cost time: 5.167234897613525
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.376 Vali Acc: 0.361 Test Loss: 5.376 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 62 cost time: 5.511244297027588
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.374 Vali Acc: 0.361 Test Loss: 5.374 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 63 cost time: 5.713125944137573
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.370 Vali Acc: 0.361 Test Loss: 5.370 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 64 cost time: 5.3224358558654785
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.367 Vali Acc: 0.361 Test Loss: 5.367 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 65 cost time: 6.124893426895142
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.363 Vali Acc: 0.361 Test Loss: 5.363 Test Acc: 0.361
Validation loss decreased (-0.361057 --> -0.361057).  Saving model ...
Epoch: 66 cost time: 6.072438478469849
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.359 Vali Acc: 0.375 Test Loss: 5.359 Test Acc: 0.375
Validation loss decreased (-0.361057 --> -0.374946).  Saving model ...
Epoch: 67 cost time: 5.238368272781372
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.355 Vali Acc: 0.375 Test Loss: 5.355 Test Acc: 0.375
Validation loss decreased (-0.374946 --> -0.374946).  Saving model ...
Epoch: 68 cost time: 5.644331932067871
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.350 Vali Acc: 0.375 Test Loss: 5.350 Test Acc: 0.375
Validation loss decreased (-0.374946 --> -0.374946).  Saving model ...
Epoch: 69 cost time: 5.404943943023682
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.347 Vali Acc: 0.375 Test Loss: 5.347 Test Acc: 0.375
Validation loss decreased (-0.374946 --> -0.374947).  Saving model ...
Epoch: 70 cost time: 5.736547946929932
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.345 Vali Acc: 0.375 Test Loss: 5.345 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 71 cost time: 6.069991588592529
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.342 Vali Acc: 0.375 Test Loss: 5.342 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 72 cost time: 5.103914499282837
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.339 Vali Acc: 0.375 Test Loss: 5.339 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 73 cost time: 5.253246068954468
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.336 Vali Acc: 0.375 Test Loss: 5.336 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 74 cost time: 4.834561586380005
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.332 Vali Acc: 0.375 Test Loss: 5.332 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 75 cost time: 5.367166996002197
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.329 Vali Acc: 0.375 Test Loss: 5.329 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 76 cost time: 6.916802883148193
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.326 Vali Acc: 0.375 Test Loss: 5.326 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 77 cost time: 6.45200514793396
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.324 Vali Acc: 0.375 Test Loss: 5.324 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 78 cost time: 4.801658391952515
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.322 Vali Acc: 0.375 Test Loss: 5.322 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 79 cost time: 5.526703119277954
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.318 Vali Acc: 0.375 Test Loss: 5.318 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 80 cost time: 6.791969299316406
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.315 Vali Acc: 0.375 Test Loss: 5.315 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 81 cost time: 6.497539043426514
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.312 Vali Acc: 0.375 Test Loss: 5.312 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 82 cost time: 5.855731248855591
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.309 Vali Acc: 0.375 Test Loss: 5.309 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 83 cost time: 5.619386196136475
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.305 Vali Acc: 0.375 Test Loss: 5.305 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 84 cost time: 5.087468147277832
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.302 Vali Acc: 0.375 Test Loss: 5.302 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 85 cost time: 5.990780353546143
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.298 Vali Acc: 0.375 Test Loss: 5.298 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 86 cost time: 6.295048952102661
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.296 Vali Acc: 0.375 Test Loss: 5.296 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 87 cost time: 6.884875297546387
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.292 Vali Acc: 0.375 Test Loss: 5.292 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 88 cost time: 6.441623210906982
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.291 Vali Acc: 0.375 Test Loss: 5.291 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 89 cost time: 5.063610076904297
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.288 Vali Acc: 0.375 Test Loss: 5.288 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 90 cost time: 5.489366054534912
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.286 Vali Acc: 0.375 Test Loss: 5.286 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 91 cost time: 6.670098781585693
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.284 Vali Acc: 0.375 Test Loss: 5.284 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 92 cost time: 6.989728212356567
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.282 Vali Acc: 0.375 Test Loss: 5.282 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 93 cost time: 6.011754274368286
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.280 Vali Acc: 0.375 Test Loss: 5.280 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 94 cost time: 5.1569859981536865
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.277 Vali Acc: 0.375 Test Loss: 5.277 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 95 cost time: 5.874334812164307
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.276 Vali Acc: 0.375 Test Loss: 5.276 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 96 cost time: 5.044830083847046
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.274 Vali Acc: 0.375 Test Loss: 5.274 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 97 cost time: 5.603424310684204
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.272 Vali Acc: 0.375 Test Loss: 5.272 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 98 cost time: 6.141616106033325
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.270 Vali Acc: 0.375 Test Loss: 5.270 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 99 cost time: 6.752451181411743
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.267 Vali Acc: 0.375 Test Loss: 5.267 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
Epoch: 100 cost time: 6.193063020706177
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.265 Vali Acc: 0.375 Test Loss: 5.265 Test Acc: 0.375
Validation loss decreased (-0.374947 --> -0.374947).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.375
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.306861162185669
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.811 Vali Acc: 0.208 Test Loss: 2.811 Test Acc: 0.208
Validation loss decreased (inf --> -0.208305).  Saving model ...
Epoch: 2 cost time: 6.5055577754974365
Epoch: 2, Steps: 7 | Train Loss: 1.508 Vali Loss: 3.786 Vali Acc: 0.167 Test Loss: 3.786 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.751028060913086
Epoch: 3, Steps: 7 | Train Loss: 0.490 Vali Loss: 4.231 Vali Acc: 0.208 Test Loss: 4.231 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.652418851852417
Epoch: 4, Steps: 7 | Train Loss: 0.089 Vali Loss: 5.828 Vali Acc: 0.222 Test Loss: 5.828 Test Acc: 0.222
Validation loss decreased (-0.208305 --> -0.222164).  Saving model ...
Epoch: 5 cost time: 5.8175458908081055
Epoch: 5, Steps: 7 | Train Loss: 0.074 Vali Loss: 5.764 Vali Acc: 0.194 Test Loss: 5.764 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.064188003540039
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 8.117 Vali Acc: 0.236 Test Loss: 8.117 Test Acc: 0.236
Validation loss decreased (-0.222164 --> -0.236030).  Saving model ...
Epoch: 7 cost time: 6.3504345417022705
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 7.812 Vali Acc: 0.167 Test Loss: 7.812 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.351478099822998
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 6.899 Vali Acc: 0.264 Test Loss: 6.899 Test Acc: 0.264
Validation loss decreased (-0.236030 --> -0.263820).  Saving model ...
Epoch: 9 cost time: 5.622727632522583
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 7.066 Vali Acc: 0.264 Test Loss: 7.066 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.035583257675171
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.324 Vali Acc: 0.264 Test Loss: 7.324 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.4198479652404785
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.522 Vali Acc: 0.292 Test Loss: 6.522 Test Acc: 0.292
Validation loss decreased (-0.263820 --> -0.291601).  Saving model ...
Epoch: 12 cost time: 5.871530771255493
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.260 Vali Acc: 0.306 Test Loss: 6.260 Test Acc: 0.306
Validation loss decreased (-0.291601 --> -0.305493).  Saving model ...
Epoch: 13 cost time: 6.810596466064453
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.687 Vali Acc: 0.236 Test Loss: 6.687 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.618427276611328
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.685 Vali Acc: 0.264 Test Loss: 7.685 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.969634056091309
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 6.863 Vali Acc: 0.278 Test Loss: 6.863 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.90890645980835
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 7.849 Vali Acc: 0.236 Test Loss: 7.849 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.493556976318359
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.466 Vali Acc: 0.222 Test Loss: 10.466 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.744301080703735
Epoch: 18, Steps: 7 | Train Loss: 0.038 Vali Loss: 6.500 Vali Acc: 0.250 Test Loss: 6.500 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.0848236083984375
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 14.399 Vali Acc: 0.139 Test Loss: 14.399 Test Acc: 0.139
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.69911789894104
Epoch: 20, Steps: 7 | Train Loss: 0.130 Vali Loss: 13.140 Vali Acc: 0.111 Test Loss: 13.140 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.98000168800354
Epoch: 21, Steps: 7 | Train Loss: 0.097 Vali Loss: 9.833 Vali Acc: 0.292 Test Loss: 9.833 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.744584560394287
Epoch: 22, Steps: 7 | Train Loss: 0.271 Vali Loss: 11.715 Vali Acc: 0.306 Test Loss: 11.715 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3055555555555556
model parameter : 24165900
model size : 111.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.475304365158081
Epoch: 1, Steps: 7 | Train Loss: 2.372 Vali Loss: 1.280 Vali Acc: 0.653 Test Loss: 1.280 Test Acc: 0.653
Validation loss decreased (inf --> -0.652765).  Saving model ...
Epoch: 2 cost time: 10.247702360153198
Epoch: 2, Steps: 7 | Train Loss: 0.298 Vali Loss: 1.463 Vali Acc: 0.792 Test Loss: 1.463 Test Acc: 0.792
Validation loss decreased (-0.652765 --> -0.791652).  Saving model ...
Epoch: 3 cost time: 10.852519035339355
Epoch: 3, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.612 Vali Acc: 0.764 Test Loss: 2.612 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.547279834747314
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.098 Vali Acc: 0.806 Test Loss: 3.098 Test Acc: 0.806
Validation loss decreased (-0.791652 --> -0.805525).  Saving model ...
Epoch: 5 cost time: 10.640218734741211
Epoch: 5, Steps: 7 | Train Loss: 0.067 Vali Loss: 2.591 Vali Acc: 0.903 Test Loss: 2.591 Test Acc: 0.903
Validation loss decreased (-0.805525 --> -0.902752).  Saving model ...
Epoch: 6 cost time: 12.164819240570068
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 3.960 Vali Acc: 0.792 Test Loss: 3.960 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.614355325698853
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 5.378 Vali Acc: 0.806 Test Loss: 5.378 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.582937479019165
Epoch: 8, Steps: 7 | Train Loss: 0.218 Vali Loss: 4.579 Vali Acc: 0.819 Test Loss: 4.579 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.990600347518921
Epoch: 9, Steps: 7 | Train Loss: 0.160 Vali Loss: 7.942 Vali Acc: 0.625 Test Loss: 7.942 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.688690900802612
Epoch: 10, Steps: 7 | Train Loss: 0.151 Vali Loss: 7.105 Vali Acc: 0.750 Test Loss: 7.105 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.488135576248169
Epoch: 11, Steps: 7 | Train Loss: 0.098 Vali Loss: 6.912 Vali Acc: 0.778 Test Loss: 6.912 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.980875253677368
Epoch: 12, Steps: 7 | Train Loss: 0.136 Vali Loss: 8.091 Vali Acc: 0.667 Test Loss: 8.091 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.847541570663452
Epoch: 13, Steps: 7 | Train Loss: 0.140 Vali Loss: 10.732 Vali Acc: 0.681 Test Loss: 10.732 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.876846075057983
Epoch: 14, Steps: 7 | Train Loss: 1.095 Vali Loss: 13.574 Vali Acc: 0.722 Test Loss: 13.574 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.032583713531494
Epoch: 15, Steps: 7 | Train Loss: 0.367 Vali Loss: 10.109 Vali Acc: 0.750 Test Loss: 10.109 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.137374877929688
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 1.536 Vali Acc: 0.583 Test Loss: 1.536 Test Acc: 0.583
Validation loss decreased (inf --> -0.583318).  Saving model ...
Epoch: 2 cost time: 8.484785079956055
Epoch: 2, Steps: 7 | Train Loss: 0.467 Vali Loss: 1.526 Vali Acc: 0.681 Test Loss: 1.526 Test Acc: 0.681
Validation loss decreased (-0.583318 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 8.019080400466919
Epoch: 3, Steps: 7 | Train Loss: 0.084 Vali Loss: 3.745 Vali Acc: 0.639 Test Loss: 3.745 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.32311201095581
Epoch: 4, Steps: 7 | Train Loss: 0.122 Vali Loss: 3.265 Vali Acc: 0.722 Test Loss: 3.265 Test Acc: 0.722
Validation loss decreased (-0.680540 --> -0.722190).  Saving model ...
Epoch: 5 cost time: 9.805641412734985
Epoch: 5, Steps: 7 | Train Loss: 0.288 Vali Loss: 4.042 Vali Acc: 0.736 Test Loss: 4.042 Test Acc: 0.736
Validation loss decreased (-0.722190 --> -0.736071).  Saving model ...
Epoch: 6 cost time: 6.985294342041016
Epoch: 6, Steps: 7 | Train Loss: 0.096 Vali Loss: 6.609 Vali Acc: 0.653 Test Loss: 6.609 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.38564682006836
Epoch: 7, Steps: 7 | Train Loss: 0.110 Vali Loss: 4.725 Vali Acc: 0.722 Test Loss: 4.725 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.13434362411499
Epoch: 8, Steps: 7 | Train Loss: 0.056 Vali Loss: 6.020 Vali Acc: 0.639 Test Loss: 6.020 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.442224264144897
Epoch: 9, Steps: 7 | Train Loss: 0.116 Vali Loss: 7.139 Vali Acc: 0.611 Test Loss: 7.139 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.864850044250488
Epoch: 10, Steps: 7 | Train Loss: 0.540 Vali Loss: 6.073 Vali Acc: 0.750 Test Loss: 6.073 Test Acc: 0.750
Validation loss decreased (-0.736071 --> -0.749939).  Saving model ...
Epoch: 11 cost time: 8.724473476409912
Epoch: 11, Steps: 7 | Train Loss: 0.467 Vali Loss: 6.380 Vali Acc: 0.778 Test Loss: 6.380 Test Acc: 0.778
Validation loss decreased (-0.749939 --> -0.777714).  Saving model ...
Epoch: 12 cost time: 12.704092979431152
Epoch: 12, Steps: 7 | Train Loss: 0.697 Vali Loss: 13.587 Vali Acc: 0.583 Test Loss: 13.587 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.20822787284851
Epoch: 13, Steps: 7 | Train Loss: 0.267 Vali Loss: 9.614 Vali Acc: 0.736 Test Loss: 9.614 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.061439275741577
Epoch: 14, Steps: 7 | Train Loss: 0.694 Vali Loss: 8.345 Vali Acc: 0.750 Test Loss: 8.345 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.510581731796265
Epoch: 15, Steps: 7 | Train Loss: 0.052 Vali Loss: 19.089 Vali Acc: 0.611 Test Loss: 19.089 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.504308223724365
Epoch: 16, Steps: 7 | Train Loss: 0.234 Vali Loss: 14.513 Vali Acc: 0.625 Test Loss: 14.513 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.882554769515991
Epoch: 17, Steps: 7 | Train Loss: 0.385 Vali Loss: 14.129 Vali Acc: 0.597 Test Loss: 14.129 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.266259670257568
Epoch: 18, Steps: 7 | Train Loss: 0.329 Vali Loss: 11.417 Vali Acc: 0.736 Test Loss: 11.417 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.856738805770874
Epoch: 19, Steps: 7 | Train Loss: 0.203 Vali Loss: 15.984 Vali Acc: 0.708 Test Loss: 15.984 Test Acc: 0.708
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.675983667373657
Epoch: 20, Steps: 7 | Train Loss: 0.143 Vali Loss: 14.187 Vali Acc: 0.736 Test Loss: 14.187 Test Acc: 0.736
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.931244373321533
Epoch: 21, Steps: 7 | Train Loss: 0.279 Vali Loss: 15.161 Vali Acc: 0.667 Test Loss: 15.161 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.935545921325684
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 1.966 Vali Acc: 0.403 Test Loss: 1.966 Test Acc: 0.403
Validation loss decreased (inf --> -0.402758).  Saving model ...
Epoch: 2 cost time: 5.856492757797241
Epoch: 2, Steps: 7 | Train Loss: 0.862 Vali Loss: 2.744 Vali Acc: 0.597 Test Loss: 2.744 Test Acc: 0.597
Validation loss decreased (-0.402758 --> -0.597195).  Saving model ...
Epoch: 3 cost time: 7.284387588500977
Epoch: 3, Steps: 7 | Train Loss: 0.206 Vali Loss: 3.510 Vali Acc: 0.556 Test Loss: 3.510 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.697126388549805
Epoch: 4, Steps: 7 | Train Loss: 0.071 Vali Loss: 3.109 Vali Acc: 0.681 Test Loss: 3.109 Test Acc: 0.681
Validation loss decreased (-0.597195 --> -0.680524).  Saving model ...
Epoch: 5 cost time: 7.583583354949951
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.342 Vali Acc: 0.722 Test Loss: 2.342 Test Acc: 0.722
Validation loss decreased (-0.680524 --> -0.722199).  Saving model ...
Epoch: 6 cost time: 7.844752073287964
Epoch: 6, Steps: 7 | Train Loss: 0.200 Vali Loss: 4.284 Vali Acc: 0.653 Test Loss: 4.284 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.5913026332855225
Epoch: 7, Steps: 7 | Train Loss: 0.509 Vali Loss: 3.778 Vali Acc: 0.750 Test Loss: 3.778 Test Acc: 0.750
Validation loss decreased (-0.722199 --> -0.749962).  Saving model ...
Epoch: 8 cost time: 6.86124324798584
Epoch: 8, Steps: 7 | Train Loss: 0.287 Vali Loss: 6.218 Vali Acc: 0.528 Test Loss: 6.218 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.598982334136963
Epoch: 9, Steps: 7 | Train Loss: 0.546 Vali Loss: 8.983 Vali Acc: 0.458 Test Loss: 8.983 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.522361516952515
Epoch: 10, Steps: 7 | Train Loss: 0.069 Vali Loss: 8.306 Vali Acc: 0.583 Test Loss: 8.306 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.887528657913208
Epoch: 11, Steps: 7 | Train Loss: 0.417 Vali Loss: 8.003 Vali Acc: 0.653 Test Loss: 8.003 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.496568202972412
Epoch: 12, Steps: 7 | Train Loss: 0.058 Vali Loss: 10.462 Vali Acc: 0.611 Test Loss: 10.462 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.718816757202148
Epoch: 13, Steps: 7 | Train Loss: 0.381 Vali Loss: 13.344 Vali Acc: 0.500 Test Loss: 13.344 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.117772817611694
Epoch: 14, Steps: 7 | Train Loss: 1.023 Vali Loss: 10.970 Vali Acc: 0.625 Test Loss: 10.970 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.910247802734375
Epoch: 15, Steps: 7 | Train Loss: 0.661 Vali Loss: 15.235 Vali Acc: 0.583 Test Loss: 15.235 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.952769994735718
Epoch: 16, Steps: 7 | Train Loss: 0.564 Vali Loss: 12.290 Vali Acc: 0.722 Test Loss: 12.290 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.016357660293579
Epoch: 17, Steps: 7 | Train Loss: 0.857 Vali Loss: 16.236 Vali Acc: 0.583 Test Loss: 16.236 Test Acc: 0.583
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.75
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.2156195640563965
Epoch: 1, Steps: 7 | Train Loss: 2.615 Vali Loss: 2.373 Vali Acc: 0.306 Test Loss: 2.373 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 7.9290454387664795
Epoch: 2, Steps: 7 | Train Loss: 0.915 Vali Loss: 2.782 Vali Acc: 0.472 Test Loss: 2.782 Test Acc: 0.472
Validation loss decreased (-0.305532 --> -0.472194).  Saving model ...
Epoch: 3 cost time: 6.736366510391235
Epoch: 3, Steps: 7 | Train Loss: 0.136 Vali Loss: 4.227 Vali Acc: 0.486 Test Loss: 4.227 Test Acc: 0.486
Validation loss decreased (-0.472194 --> -0.486069).  Saving model ...
Epoch: 4 cost time: 6.679128170013428
Epoch: 4, Steps: 7 | Train Loss: 0.309 Vali Loss: 3.230 Vali Acc: 0.597 Test Loss: 3.230 Test Acc: 0.597
Validation loss decreased (-0.486069 --> -0.597190).  Saving model ...
Epoch: 5 cost time: 5.470845460891724
Epoch: 5, Steps: 7 | Train Loss: 0.024 Vali Loss: 4.136 Vali Acc: 0.528 Test Loss: 4.136 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.210464000701904
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 4.147 Vali Acc: 0.542 Test Loss: 4.147 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.792811393737793
Epoch: 7, Steps: 7 | Train Loss: 0.159 Vali Loss: 5.113 Vali Acc: 0.500 Test Loss: 5.113 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.883883953094482
Epoch: 8, Steps: 7 | Train Loss: 0.133 Vali Loss: 7.985 Vali Acc: 0.500 Test Loss: 7.985 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.708904981613159
Epoch: 9, Steps: 7 | Train Loss: 0.375 Vali Loss: 8.617 Vali Acc: 0.528 Test Loss: 8.617 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.1270904541015625
Epoch: 10, Steps: 7 | Train Loss: 0.147 Vali Loss: 7.168 Vali Acc: 0.681 Test Loss: 7.168 Test Acc: 0.681
Validation loss decreased (-0.597190 --> -0.680484).  Saving model ...
Epoch: 11 cost time: 5.776042222976685
Epoch: 11, Steps: 7 | Train Loss: 0.198 Vali Loss: 7.793 Vali Acc: 0.569 Test Loss: 7.793 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.4860100746154785
Epoch: 12, Steps: 7 | Train Loss: 0.135 Vali Loss: 6.463 Vali Acc: 0.653 Test Loss: 6.463 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.980045557022095
Epoch: 13, Steps: 7 | Train Loss: 1.353 Vali Loss: 6.762 Vali Acc: 0.653 Test Loss: 6.762 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.785125970840454
Epoch: 14, Steps: 7 | Train Loss: 0.739 Vali Loss: 9.388 Vali Acc: 0.611 Test Loss: 9.388 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.211863040924072
Epoch: 15, Steps: 7 | Train Loss: 0.092 Vali Loss: 13.079 Vali Acc: 0.528 Test Loss: 13.079 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.781279563903809
Epoch: 16, Steps: 7 | Train Loss: 0.945 Vali Loss: 12.976 Vali Acc: 0.528 Test Loss: 12.976 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.542115211486816
Epoch: 17, Steps: 7 | Train Loss: 0.667 Vali Loss: 18.090 Vali Acc: 0.472 Test Loss: 18.090 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.277021884918213
Epoch: 18, Steps: 7 | Train Loss: 0.236 Vali Loss: 27.318 Vali Acc: 0.361 Test Loss: 27.318 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.754286289215088
Epoch: 19, Steps: 7 | Train Loss: 1.281 Vali Loss: 14.161 Vali Acc: 0.500 Test Loss: 14.161 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.940645933151245
Epoch: 20, Steps: 7 | Train Loss: 0.597 Vali Loss: 10.680 Vali Acc: 0.667 Test Loss: 10.680 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6805555555555556
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.509457349777222
Epoch: 1, Steps: 7 | Train Loss: 2.657 Vali Loss: 2.629 Vali Acc: 0.236 Test Loss: 2.629 Test Acc: 0.236
Validation loss decreased (inf --> -0.236085).  Saving model ...
Epoch: 2 cost time: 5.989220857620239
Epoch: 2, Steps: 7 | Train Loss: 0.892 Vali Loss: 3.494 Vali Acc: 0.264 Test Loss: 3.494 Test Acc: 0.264
Validation loss decreased (-0.236085 --> -0.263854).  Saving model ...
Epoch: 3 cost time: 6.388094425201416
Epoch: 3, Steps: 7 | Train Loss: 0.200 Vali Loss: 5.551 Vali Acc: 0.306 Test Loss: 5.551 Test Acc: 0.306
Validation loss decreased (-0.263854 --> -0.305500).  Saving model ...
Epoch: 4 cost time: 4.837117910385132
Epoch: 4, Steps: 7 | Train Loss: 0.098 Vali Loss: 6.621 Vali Acc: 0.306 Test Loss: 6.621 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.288556337356567
Epoch: 5, Steps: 7 | Train Loss: 0.126 Vali Loss: 5.098 Vali Acc: 0.417 Test Loss: 5.098 Test Acc: 0.417
Validation loss decreased (-0.305500 --> -0.416616).  Saving model ...
Epoch: 6 cost time: 5.297979354858398
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 8.477 Vali Acc: 0.361 Test Loss: 8.477 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.626143932342529
Epoch: 7, Steps: 7 | Train Loss: 0.048 Vali Loss: 9.002 Vali Acc: 0.375 Test Loss: 9.002 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.120279788970947
Epoch: 8, Steps: 7 | Train Loss: 0.056 Vali Loss: 9.574 Vali Acc: 0.431 Test Loss: 9.574 Test Acc: 0.431
Validation loss decreased (-0.416616 --> -0.430460).  Saving model ...
Epoch: 9 cost time: 5.916118621826172
Epoch: 9, Steps: 7 | Train Loss: 0.602 Vali Loss: 8.204 Vali Acc: 0.389 Test Loss: 8.204 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.195120573043823
Epoch: 10, Steps: 7 | Train Loss: 1.106 Vali Loss: 13.499 Vali Acc: 0.347 Test Loss: 13.499 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.835831642150879
Epoch: 11, Steps: 7 | Train Loss: 1.428 Vali Loss: 19.841 Vali Acc: 0.181 Test Loss: 19.841 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.817626237869263
Epoch: 12, Steps: 7 | Train Loss: 0.310 Vali Loss: 12.170 Vali Acc: 0.361 Test Loss: 12.170 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.562718391418457
Epoch: 13, Steps: 7 | Train Loss: 0.271 Vali Loss: 13.590 Vali Acc: 0.347 Test Loss: 13.590 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.40748405456543
Epoch: 14, Steps: 7 | Train Loss: 0.427 Vali Loss: 12.783 Vali Acc: 0.431 Test Loss: 12.783 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.564379692077637
Epoch: 15, Steps: 7 | Train Loss: 0.201 Vali Loss: 17.359 Vali Acc: 0.417 Test Loss: 17.359 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.8310627937316895
Epoch: 16, Steps: 7 | Train Loss: 0.561 Vali Loss: 16.889 Vali Acc: 0.403 Test Loss: 16.889 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.035893678665161
Epoch: 17, Steps: 7 | Train Loss: 0.567 Vali Loss: 17.227 Vali Acc: 0.444 Test Loss: 17.227 Test Acc: 0.444
Validation loss decreased (-0.430460 --> -0.444272).  Saving model ...
Epoch: 18 cost time: 5.087627649307251
Epoch: 18, Steps: 7 | Train Loss: 0.129 Vali Loss: 22.445 Vali Acc: 0.444 Test Loss: 22.445 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.208850622177124
Epoch: 19, Steps: 7 | Train Loss: 0.037 Vali Loss: 20.698 Vali Acc: 0.306 Test Loss: 20.698 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.67880916595459
Epoch: 20, Steps: 7 | Train Loss: 0.460 Vali Loss: 21.995 Vali Acc: 0.431 Test Loss: 21.995 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.154698371887207
Epoch: 21, Steps: 7 | Train Loss: 0.067 Vali Loss: 16.853 Vali Acc: 0.444 Test Loss: 16.853 Test Acc: 0.444
Validation loss decreased (-0.444272 --> -0.444276).  Saving model ...
Epoch: 22 cost time: 6.837670564651489
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 19.980 Vali Acc: 0.431 Test Loss: 19.980 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.591675758361816
Epoch: 23, Steps: 7 | Train Loss: 0.402 Vali Loss: 21.581 Vali Acc: 0.458 Test Loss: 21.581 Test Acc: 0.458
Validation loss decreased (-0.444276 --> -0.458118).  Saving model ...
Epoch: 24 cost time: 5.034056186676025
Epoch: 24, Steps: 7 | Train Loss: 0.160 Vali Loss: 21.794 Vali Acc: 0.417 Test Loss: 21.794 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.033627271652222
Epoch: 25, Steps: 7 | Train Loss: 0.158 Vali Loss: 23.530 Vali Acc: 0.375 Test Loss: 23.530 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.512561082839966
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 24.446 Vali Acc: 0.403 Test Loss: 24.446 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.566965103149414
Epoch: 27, Steps: 7 | Train Loss: 0.106 Vali Loss: 24.574 Vali Acc: 0.417 Test Loss: 24.574 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.756330251693726
Epoch: 28, Steps: 7 | Train Loss: 0.032 Vali Loss: 19.174 Vali Acc: 0.458 Test Loss: 19.174 Test Acc: 0.458
Validation loss decreased (-0.458118 --> -0.458142).  Saving model ...
Epoch: 29 cost time: 5.697903633117676
Epoch: 29, Steps: 7 | Train Loss: 0.320 Vali Loss: 20.412 Vali Acc: 0.431 Test Loss: 20.412 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.0724875926971436
Epoch: 30, Steps: 7 | Train Loss: 0.099 Vali Loss: 28.158 Vali Acc: 0.431 Test Loss: 28.158 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.16954493522644
Epoch: 31, Steps: 7 | Train Loss: 0.137 Vali Loss: 23.207 Vali Acc: 0.403 Test Loss: 23.207 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.821504354476929
Epoch: 32, Steps: 7 | Train Loss: 0.046 Vali Loss: 25.427 Vali Acc: 0.361 Test Loss: 25.427 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.83713436126709
Epoch: 33, Steps: 7 | Train Loss: 0.443 Vali Loss: 26.903 Vali Acc: 0.458 Test Loss: 26.903 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.873843193054199
Epoch: 34, Steps: 7 | Train Loss: 1.203 Vali Loss: 22.202 Vali Acc: 0.431 Test Loss: 22.202 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.0688982009887695
Epoch: 35, Steps: 7 | Train Loss: 0.372 Vali Loss: 34.594 Vali Acc: 0.361 Test Loss: 34.594 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.508238077163696
Epoch: 36, Steps: 7 | Train Loss: 1.582 Vali Loss: 29.436 Vali Acc: 0.417 Test Loss: 29.436 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.241992712020874
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 37.695 Vali Acc: 0.403 Test Loss: 37.695 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 6.500888347625732
Epoch: 38, Steps: 7 | Train Loss: 0.255 Vali Loss: 29.818 Vali Acc: 0.375 Test Loss: 29.818 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.654160976409912
Epoch: 1, Steps: 7 | Train Loss: 2.638 Vali Loss: 2.578 Vali Acc: 0.153 Test Loss: 2.578 Test Acc: 0.153
Validation loss decreased (inf --> -0.152752).  Saving model ...
Epoch: 2 cost time: 4.868960618972778
Epoch: 2, Steps: 7 | Train Loss: 1.209 Vali Loss: 3.392 Vali Acc: 0.181 Test Loss: 3.392 Test Acc: 0.181
Validation loss decreased (-0.152752 --> -0.180522).  Saving model ...
Epoch: 3 cost time: 4.137447834014893
Epoch: 3, Steps: 7 | Train Loss: 0.337 Vali Loss: 5.357 Vali Acc: 0.236 Test Loss: 5.357 Test Acc: 0.236
Validation loss decreased (-0.180522 --> -0.236058).  Saving model ...
Epoch: 4 cost time: 4.69918417930603
Epoch: 4, Steps: 7 | Train Loss: 0.102 Vali Loss: 5.365 Vali Acc: 0.347 Test Loss: 5.365 Test Acc: 0.347
Validation loss decreased (-0.236058 --> -0.347169).  Saving model ...
Epoch: 5 cost time: 4.292953729629517
Epoch: 5, Steps: 7 | Train Loss: 0.086 Vali Loss: 5.233 Vali Acc: 0.319 Test Loss: 5.233 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.5223228931427
Epoch: 6, Steps: 7 | Train Loss: 0.073 Vali Loss: 6.594 Vali Acc: 0.319 Test Loss: 6.594 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.306817293167114
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 6.973 Vali Acc: 0.306 Test Loss: 6.973 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.809760093688965
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 9.594 Vali Acc: 0.403 Test Loss: 9.594 Test Acc: 0.403
Validation loss decreased (-0.347169 --> -0.402682).  Saving model ...
Epoch: 9 cost time: 4.9586522579193115
Epoch: 9, Steps: 7 | Train Loss: 0.156 Vali Loss: 6.847 Vali Acc: 0.375 Test Loss: 6.847 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.539958477020264
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 8.392 Vali Acc: 0.431 Test Loss: 8.392 Test Acc: 0.431
Validation loss decreased (-0.402682 --> -0.430472).  Saving model ...
Epoch: 11 cost time: 5.3426361083984375
Epoch: 11, Steps: 7 | Train Loss: 0.270 Vali Loss: 10.620 Vali Acc: 0.347 Test Loss: 10.620 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.817364454269409
Epoch: 12, Steps: 7 | Train Loss: 0.151 Vali Loss: 10.407 Vali Acc: 0.347 Test Loss: 10.407 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.211114168167114
Epoch: 13, Steps: 7 | Train Loss: 0.778 Vali Loss: 16.704 Vali Acc: 0.222 Test Loss: 16.704 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.443831205368042
Epoch: 14, Steps: 7 | Train Loss: 0.253 Vali Loss: 9.002 Vali Acc: 0.458 Test Loss: 9.002 Test Acc: 0.458
Validation loss decreased (-0.430472 --> -0.458243).  Saving model ...
Epoch: 15 cost time: 5.515872955322266
Epoch: 15, Steps: 7 | Train Loss: 0.160 Vali Loss: 12.341 Vali Acc: 0.444 Test Loss: 12.341 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.56614089012146
Epoch: 16, Steps: 7 | Train Loss: 1.313 Vali Loss: 18.637 Vali Acc: 0.417 Test Loss: 18.637 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.107237815856934
Epoch: 17, Steps: 7 | Train Loss: 1.669 Vali Loss: 22.116 Vali Acc: 0.333 Test Loss: 22.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.431902885437012
Epoch: 18, Steps: 7 | Train Loss: 0.743 Vali Loss: 20.700 Vali Acc: 0.417 Test Loss: 20.700 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.5919508934021
Epoch: 19, Steps: 7 | Train Loss: 0.169 Vali Loss: 23.568 Vali Acc: 0.292 Test Loss: 23.568 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.766733407974243
Epoch: 20, Steps: 7 | Train Loss: 0.109 Vali Loss: 21.500 Vali Acc: 0.403 Test Loss: 21.500 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.761809825897217
Epoch: 21, Steps: 7 | Train Loss: 0.067 Vali Loss: 16.384 Vali Acc: 0.528 Test Loss: 16.384 Test Acc: 0.528
Validation loss decreased (-0.458243 --> -0.527614).  Saving model ...
Epoch: 22 cost time: 4.853634595870972
Epoch: 22, Steps: 7 | Train Loss: 0.740 Vali Loss: 14.034 Vali Acc: 0.556 Test Loss: 14.034 Test Acc: 0.556
Validation loss decreased (-0.527614 --> -0.555415).  Saving model ...
Epoch: 23 cost time: 4.94178318977356
Epoch: 23, Steps: 7 | Train Loss: 0.181 Vali Loss: 14.294 Vali Acc: 0.472 Test Loss: 14.294 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.9050962924957275
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 31.084 Vali Acc: 0.306 Test Loss: 31.084 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.682966470718384
Epoch: 25, Steps: 7 | Train Loss: 1.709 Vali Loss: 18.506 Vali Acc: 0.417 Test Loss: 18.506 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.232285261154175
Epoch: 26, Steps: 7 | Train Loss: 0.343 Vali Loss: 25.770 Vali Acc: 0.361 Test Loss: 25.770 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.570730924606323
Epoch: 27, Steps: 7 | Train Loss: 0.174 Vali Loss: 22.741 Vali Acc: 0.417 Test Loss: 22.741 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.256112098693848
Epoch: 28, Steps: 7 | Train Loss: 0.081 Vali Loss: 16.680 Vali Acc: 0.542 Test Loss: 16.680 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.5172765254974365
Epoch: 29, Steps: 7 | Train Loss: 0.424 Vali Loss: 31.961 Vali Acc: 0.292 Test Loss: 31.961 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.159786939620972
Epoch: 30, Steps: 7 | Train Loss: 0.169 Vali Loss: 23.664 Vali Acc: 0.361 Test Loss: 23.664 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.0886805057525635
Epoch: 31, Steps: 7 | Train Loss: 0.243 Vali Loss: 18.594 Vali Acc: 0.500 Test Loss: 18.594 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.378372669219971
Epoch: 32, Steps: 7 | Train Loss: 0.548 Vali Loss: 24.975 Vali Acc: 0.472 Test Loss: 24.975 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5555555555555556
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.127078056335449
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.515 Vali Acc: 0.236 Test Loss: 2.515 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 4.996784687042236
Epoch: 2, Steps: 7 | Train Loss: 1.283 Vali Loss: 3.174 Vali Acc: 0.167 Test Loss: 3.174 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.089750051498413
Epoch: 3, Steps: 7 | Train Loss: 0.194 Vali Loss: 3.450 Vali Acc: 0.375 Test Loss: 3.450 Test Acc: 0.375
Validation loss decreased (-0.236086 --> -0.374966).  Saving model ...
Epoch: 4 cost time: 5.000413656234741
Epoch: 4, Steps: 7 | Train Loss: 0.036 Vali Loss: 3.850 Vali Acc: 0.417 Test Loss: 3.850 Test Acc: 0.417
Validation loss decreased (-0.374966 --> -0.416628).  Saving model ...
Epoch: 5 cost time: 5.152419328689575
Epoch: 5, Steps: 7 | Train Loss: 0.163 Vali Loss: 5.761 Vali Acc: 0.250 Test Loss: 5.761 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.02882981300354
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 3.830 Vali Acc: 0.361 Test Loss: 3.830 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.860934734344482
Epoch: 7, Steps: 7 | Train Loss: 0.051 Vali Loss: 6.422 Vali Acc: 0.347 Test Loss: 6.422 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.728180408477783
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 7.403 Vali Acc: 0.264 Test Loss: 7.403 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.439134359359741
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.244 Vali Acc: 0.278 Test Loss: 5.244 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.435802936553955
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 8.256 Vali Acc: 0.333 Test Loss: 8.256 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.559791088104248
Epoch: 11, Steps: 7 | Train Loss: 0.051 Vali Loss: 6.349 Vali Acc: 0.361 Test Loss: 6.349 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.609023094177246
Epoch: 12, Steps: 7 | Train Loss: 0.225 Vali Loss: 19.802 Vali Acc: 0.125 Test Loss: 19.802 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.889960765838623
Epoch: 13, Steps: 7 | Train Loss: 0.264 Vali Loss: 16.177 Vali Acc: 0.292 Test Loss: 16.177 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.8415367603302
Epoch: 14, Steps: 7 | Train Loss: 0.922 Vali Loss: 14.795 Vali Acc: 0.403 Test Loss: 14.795 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.100517988204956
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.548 Vali Acc: 0.236 Test Loss: 2.548 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 4.8810038566589355
Epoch: 2, Steps: 7 | Train Loss: 1.365 Vali Loss: 3.153 Vali Acc: 0.181 Test Loss: 3.153 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.464922666549683
Epoch: 3, Steps: 7 | Train Loss: 0.135 Vali Loss: 3.743 Vali Acc: 0.347 Test Loss: 3.743 Test Acc: 0.347
Validation loss decreased (-0.236086 --> -0.347185).  Saving model ...
Epoch: 4 cost time: 4.711394786834717
Epoch: 4, Steps: 7 | Train Loss: 0.115 Vali Loss: 3.473 Vali Acc: 0.264 Test Loss: 3.473 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.6739091873168945
Epoch: 5, Steps: 7 | Train Loss: 0.120 Vali Loss: 4.629 Vali Acc: 0.417 Test Loss: 4.629 Test Acc: 0.417
Validation loss decreased (-0.347185 --> -0.416620).  Saving model ...
Epoch: 6 cost time: 4.696619272232056
Epoch: 6, Steps: 7 | Train Loss: 0.030 Vali Loss: 6.094 Vali Acc: 0.222 Test Loss: 6.094 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9964356422424316
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.829 Vali Acc: 0.306 Test Loss: 5.829 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.409805059432983
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.835 Vali Acc: 0.389 Test Loss: 4.835 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.994917631149292
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.777 Vali Acc: 0.417 Test Loss: 4.777 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.994704484939575
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.052 Vali Acc: 0.403 Test Loss: 5.052 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.368032217025757
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.653 Vali Acc: 0.333 Test Loss: 5.653 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.850468397140503
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.088 Vali Acc: 0.319 Test Loss: 6.088 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.6607584953308105
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.585 Vali Acc: 0.319 Test Loss: 5.585 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5401017665863037
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.165 Vali Acc: 0.333 Test Loss: 5.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.727928161621094
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.974 Vali Acc: 0.375 Test Loss: 4.974 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.304723262786865
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.531 Vali Acc: 0.250 Test Loss: 2.531 Test Acc: 0.250
Validation loss decreased (inf --> -0.249975).  Saving model ...
Epoch: 2 cost time: 4.65118670463562
Epoch: 2, Steps: 7 | Train Loss: 1.698 Vali Loss: 3.467 Vali Acc: 0.181 Test Loss: 3.467 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.015162229537964
Epoch: 3, Steps: 7 | Train Loss: 0.356 Vali Loss: 3.221 Vali Acc: 0.181 Test Loss: 3.221 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.0240209102630615
Epoch: 4, Steps: 7 | Train Loss: 0.091 Vali Loss: 7.848 Vali Acc: 0.097 Test Loss: 7.848 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.724154710769653
Epoch: 5, Steps: 7 | Train Loss: 0.111 Vali Loss: 4.895 Vali Acc: 0.264 Test Loss: 4.895 Test Acc: 0.264
Validation loss decreased (-0.249975 --> -0.263840).  Saving model ...
Epoch: 6 cost time: 4.261817693710327
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 6.868 Vali Acc: 0.153 Test Loss: 6.868 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.956778526306152
Epoch: 7, Steps: 7 | Train Loss: 0.037 Vali Loss: 6.542 Vali Acc: 0.167 Test Loss: 6.542 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.7926881313323975
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.934 Vali Acc: 0.236 Test Loss: 5.934 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.79331636428833
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 13.487 Vali Acc: 0.167 Test Loss: 13.487 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.072897434234619
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 9.688 Vali Acc: 0.236 Test Loss: 9.688 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.044257164001465
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 7.273 Vali Acc: 0.306 Test Loss: 7.273 Test Acc: 0.306
Validation loss decreased (-0.263840 --> -0.305483).  Saving model ...
Epoch: 12 cost time: 3.8669886589050293
Epoch: 12, Steps: 7 | Train Loss: 0.088 Vali Loss: 11.537 Vali Acc: 0.139 Test Loss: 11.537 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.725764274597168
Epoch: 13, Steps: 7 | Train Loss: 0.082 Vali Loss: 16.407 Vali Acc: 0.181 Test Loss: 16.407 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.930279731750488
Epoch: 14, Steps: 7 | Train Loss: 0.498 Vali Loss: 15.074 Vali Acc: 0.167 Test Loss: 15.074 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.815481185913086
Epoch: 15, Steps: 7 | Train Loss: 0.049 Vali Loss: 10.131 Vali Acc: 0.333 Test Loss: 10.131 Test Acc: 0.333
Validation loss decreased (-0.305483 --> -0.333232).  Saving model ...
Epoch: 16 cost time: 5.532516956329346
Epoch: 16, Steps: 7 | Train Loss: 0.142 Vali Loss: 12.374 Vali Acc: 0.292 Test Loss: 12.374 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.6035544872283936
Epoch: 17, Steps: 7 | Train Loss: 0.050 Vali Loss: 11.128 Vali Acc: 0.208 Test Loss: 11.128 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.486051321029663
Epoch: 18, Steps: 7 | Train Loss: 0.201 Vali Loss: 12.148 Vali Acc: 0.208 Test Loss: 12.148 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.558337926864624
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 11.173 Vali Acc: 0.347 Test Loss: 11.173 Test Acc: 0.347
Validation loss decreased (-0.333232 --> -0.347110).  Saving model ...
Epoch: 20 cost time: 4.5733137130737305
Epoch: 20, Steps: 7 | Train Loss: 0.124 Vali Loss: 28.353 Vali Acc: 0.097 Test Loss: 28.353 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.742233753204346
Epoch: 21, Steps: 7 | Train Loss: 0.134 Vali Loss: 20.328 Vali Acc: 0.167 Test Loss: 20.328 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.131854772567749
Epoch: 22, Steps: 7 | Train Loss: 0.164 Vali Loss: 15.732 Vali Acc: 0.194 Test Loss: 15.732 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.7355406284332275
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 16.170 Vali Acc: 0.278 Test Loss: 16.170 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.738891363143921
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 9.511 Vali Acc: 0.431 Test Loss: 9.511 Test Acc: 0.431
Validation loss decreased (-0.347110 --> -0.430460).  Saving model ...
Epoch: 25 cost time: 4.2308876514434814
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 9.833 Vali Acc: 0.306 Test Loss: 9.833 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.880514144897461
Epoch: 26, Steps: 7 | Train Loss: 0.016 Vali Loss: 33.149 Vali Acc: 0.097 Test Loss: 33.149 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.493887662887573
Epoch: 27, Steps: 7 | Train Loss: 0.025 Vali Loss: 21.580 Vali Acc: 0.097 Test Loss: 21.580 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.9957115650177
Epoch: 28, Steps: 7 | Train Loss: 0.113 Vali Loss: 12.143 Vali Acc: 0.333 Test Loss: 12.143 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.519189834594727
Epoch: 29, Steps: 7 | Train Loss: 0.094 Vali Loss: 17.406 Vali Acc: 0.264 Test Loss: 17.406 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.519493103027344
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 20.215 Vali Acc: 0.306 Test Loss: 20.215 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.942568778991699
Epoch: 31, Steps: 7 | Train Loss: 0.247 Vali Loss: 15.309 Vali Acc: 0.319 Test Loss: 15.309 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.176230192184448
Epoch: 32, Steps: 7 | Train Loss: 0.316 Vali Loss: 19.233 Vali Acc: 0.264 Test Loss: 19.233 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.9818649291992188
Epoch: 33, Steps: 7 | Train Loss: 0.303 Vali Loss: 16.668 Vali Acc: 0.250 Test Loss: 16.668 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.671217203140259
Epoch: 34, Steps: 7 | Train Loss: 0.253 Vali Loss: 22.067 Vali Acc: 0.347 Test Loss: 22.067 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.731644868850708
Epoch: 1, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.659 Vali Acc: 0.181 Test Loss: 2.659 Test Acc: 0.181
Validation loss decreased (inf --> -0.180529).  Saving model ...
Epoch: 2 cost time: 4.833011627197266
Epoch: 2, Steps: 7 | Train Loss: 1.499 Vali Loss: 4.064 Vali Acc: 0.208 Test Loss: 4.064 Test Acc: 0.208
Validation loss decreased (-0.180529 --> -0.208293).  Saving model ...
Epoch: 3 cost time: 3.8884494304656982
Epoch: 3, Steps: 7 | Train Loss: 0.534 Vali Loss: 4.909 Vali Acc: 0.125 Test Loss: 4.909 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.4747419357299805
Epoch: 4, Steps: 7 | Train Loss: 0.169 Vali Loss: 5.499 Vali Acc: 0.222 Test Loss: 5.499 Test Acc: 0.222
Validation loss decreased (-0.208293 --> -0.222167).  Saving model ...
Epoch: 5 cost time: 3.8460819721221924
Epoch: 5, Steps: 7 | Train Loss: 0.238 Vali Loss: 8.281 Vali Acc: 0.208 Test Loss: 8.281 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.532516717910767
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 7.384 Vali Acc: 0.181 Test Loss: 7.384 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9684553146362305
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 7.219 Vali Acc: 0.181 Test Loss: 7.219 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.083536386489868
Epoch: 8, Steps: 7 | Train Loss: 0.095 Vali Loss: 6.833 Vali Acc: 0.222 Test Loss: 6.833 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.570513725280762
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 6.053 Vali Acc: 0.181 Test Loss: 6.053 Test Acc: 0.181
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.389790773391724
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.968 Vali Acc: 0.236 Test Loss: 7.968 Test Acc: 0.236
Validation loss decreased (-0.222167 --> -0.236031).  Saving model ...
Epoch: 11 cost time: 4.443599462509155
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 8.420 Vali Acc: 0.236 Test Loss: 8.420 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6762168407440186
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.078 Vali Acc: 0.306 Test Loss: 8.078 Test Acc: 0.306
Validation loss decreased (-0.236031 --> -0.305475).  Saving model ...
Epoch: 13 cost time: 3.778290271759033
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.938 Vali Acc: 0.292 Test Loss: 7.938 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.412723541259766
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.848 Vali Acc: 0.278 Test Loss: 7.848 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.940176725387573
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.770 Vali Acc: 0.278 Test Loss: 7.770 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.405104637145996
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.670 Vali Acc: 0.278 Test Loss: 7.670 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.049207448959351
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.566 Vali Acc: 0.278 Test Loss: 7.566 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.938070774078369
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.479 Vali Acc: 0.278 Test Loss: 7.479 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.496890544891357
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.420 Vali Acc: 0.278 Test Loss: 7.420 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9152605533599854
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.362 Vali Acc: 0.278 Test Loss: 7.362 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.175753116607666
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.337 Vali Acc: 0.292 Test Loss: 7.337 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.38863205909729
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.321 Vali Acc: 0.292 Test Loss: 7.321 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3055555555555556
model parameter : 21020172
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.256968021392822
Epoch: 1, Steps: 7 | Train Loss: 2.340 Vali Loss: 1.128 Vali Acc: 0.708 Test Loss: 1.128 Test Acc: 0.708
Validation loss decreased (inf --> -0.708322).  Saving model ...
Epoch: 2 cost time: 8.022906064987183
Epoch: 2, Steps: 7 | Train Loss: 0.375 Vali Loss: 1.796 Vali Acc: 0.750 Test Loss: 1.796 Test Acc: 0.750
Validation loss decreased (-0.708322 --> -0.749982).  Saving model ...
Epoch: 3 cost time: 9.718286275863647
Epoch: 3, Steps: 7 | Train Loss: 0.029 Vali Loss: 3.370 Vali Acc: 0.736 Test Loss: 3.370 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.011822938919067
Epoch: 4, Steps: 7 | Train Loss: 0.026 Vali Loss: 3.360 Vali Acc: 0.819 Test Loss: 3.360 Test Acc: 0.819
Validation loss decreased (-0.749982 --> -0.819411).  Saving model ...
Epoch: 5 cost time: 8.19406795501709
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.654 Vali Acc: 0.778 Test Loss: 3.654 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.012864351272583
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.238 Vali Acc: 0.736 Test Loss: 4.238 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.544018745422363
Epoch: 7, Steps: 7 | Train Loss: 0.079 Vali Loss: 3.528 Vali Acc: 0.750 Test Loss: 3.528 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.383824586868286
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.068 Vali Acc: 0.847 Test Loss: 3.068 Test Acc: 0.847
Validation loss decreased (-0.819411 --> -0.847192).  Saving model ...
Epoch: 9 cost time: 10.119249820709229
Epoch: 9, Steps: 7 | Train Loss: 0.709 Vali Loss: 4.589 Vali Acc: 0.764 Test Loss: 4.589 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.927741050720215
Epoch: 10, Steps: 7 | Train Loss: 0.863 Vali Loss: 7.091 Vali Acc: 0.694 Test Loss: 7.091 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.848561763763428
Epoch: 11, Steps: 7 | Train Loss: 0.302 Vali Loss: 6.009 Vali Acc: 0.806 Test Loss: 6.009 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.551444292068481
Epoch: 12, Steps: 7 | Train Loss: 0.379 Vali Loss: 5.595 Vali Acc: 0.806 Test Loss: 5.595 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.680511236190796
Epoch: 13, Steps: 7 | Train Loss: 0.570 Vali Loss: 8.464 Vali Acc: 0.736 Test Loss: 8.464 Test Acc: 0.736
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.425812005996704
Epoch: 14, Steps: 7 | Train Loss: 0.600 Vali Loss: 9.376 Vali Acc: 0.722 Test Loss: 9.376 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.709630966186523
Epoch: 15, Steps: 7 | Train Loss: 0.126 Vali Loss: 16.445 Vali Acc: 0.667 Test Loss: 16.445 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.770479917526245
Epoch: 16, Steps: 7 | Train Loss: 0.545 Vali Loss: 12.586 Vali Acc: 0.736 Test Loss: 12.586 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.412822961807251
Epoch: 17, Steps: 7 | Train Loss: 1.602 Vali Loss: 13.789 Vali Acc: 0.708 Test Loss: 13.789 Test Acc: 0.708
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.63284969329834
Epoch: 18, Steps: 7 | Train Loss: 0.300 Vali Loss: 12.692 Vali Acc: 0.722 Test Loss: 12.692 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.832671403884888
Epoch: 1, Steps: 7 | Train Loss: 2.392 Vali Loss: 1.300 Vali Acc: 0.639 Test Loss: 1.300 Test Acc: 0.639
Validation loss decreased (inf --> -0.638876).  Saving model ...
Epoch: 2 cost time: 8.026672840118408
Epoch: 2, Steps: 7 | Train Loss: 0.503 Vali Loss: 1.424 Vali Acc: 0.750 Test Loss: 1.424 Test Acc: 0.750
Validation loss decreased (-0.638876 --> -0.749986).  Saving model ...
Epoch: 3 cost time: 7.286009788513184
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.129 Vali Acc: 0.736 Test Loss: 2.129 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.368124961853027
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 3.300 Vali Acc: 0.681 Test Loss: 3.300 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.013658285140991
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.000 Vali Acc: 0.667 Test Loss: 4.000 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.349065065383911
Epoch: 6, Steps: 7 | Train Loss: 0.069 Vali Loss: 4.288 Vali Acc: 0.708 Test Loss: 4.288 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.030741214752197
Epoch: 7, Steps: 7 | Train Loss: 0.148 Vali Loss: 6.630 Vali Acc: 0.597 Test Loss: 6.630 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.623532056808472
Epoch: 8, Steps: 7 | Train Loss: 0.214 Vali Loss: 7.243 Vali Acc: 0.625 Test Loss: 7.243 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.451349258422852
Epoch: 9, Steps: 7 | Train Loss: 0.217 Vali Loss: 6.302 Vali Acc: 0.639 Test Loss: 6.302 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.649576663970947
Epoch: 10, Steps: 7 | Train Loss: 0.232 Vali Loss: 5.239 Vali Acc: 0.764 Test Loss: 5.239 Test Acc: 0.764
Validation loss decreased (-0.749986 --> -0.763836).  Saving model ...
Epoch: 11 cost time: 8.714311838150024
Epoch: 11, Steps: 7 | Train Loss: 0.213 Vali Loss: 6.160 Vali Acc: 0.750 Test Loss: 6.160 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.2483155727386475
Epoch: 12, Steps: 7 | Train Loss: 0.326 Vali Loss: 8.965 Vali Acc: 0.722 Test Loss: 8.965 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.453256845474243
Epoch: 13, Steps: 7 | Train Loss: 0.457 Vali Loss: 11.020 Vali Acc: 0.667 Test Loss: 11.020 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.5410897731781
Epoch: 14, Steps: 7 | Train Loss: 0.177 Vali Loss: 9.540 Vali Acc: 0.750 Test Loss: 9.540 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.70784878730774
Epoch: 15, Steps: 7 | Train Loss: 0.073 Vali Loss: 13.388 Vali Acc: 0.694 Test Loss: 13.388 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.019281148910522
Epoch: 16, Steps: 7 | Train Loss: 0.168 Vali Loss: 10.641 Vali Acc: 0.722 Test Loss: 10.641 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.122324705123901
Epoch: 17, Steps: 7 | Train Loss: 0.333 Vali Loss: 9.760 Vali Acc: 0.722 Test Loss: 9.760 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.092164754867554
Epoch: 18, Steps: 7 | Train Loss: 0.177 Vali Loss: 14.960 Vali Acc: 0.639 Test Loss: 14.960 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.195976495742798
Epoch: 19, Steps: 7 | Train Loss: 0.752 Vali Loss: 9.042 Vali Acc: 0.750 Test Loss: 9.042 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.54593563079834
Epoch: 20, Steps: 7 | Train Loss: 0.429 Vali Loss: 9.296 Vali Acc: 0.750 Test Loss: 9.296 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7638888888888888
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.71445631980896
Epoch: 1, Steps: 7 | Train Loss: 2.449 Vali Loss: 1.568 Vali Acc: 0.583 Test Loss: 1.568 Test Acc: 0.583
Validation loss decreased (inf --> -0.583318).  Saving model ...
Epoch: 2 cost time: 7.7027130126953125
Epoch: 2, Steps: 7 | Train Loss: 0.639 Vali Loss: 1.685 Vali Acc: 0.681 Test Loss: 1.685 Test Acc: 0.681
Validation loss decreased (-0.583318 --> -0.680539).  Saving model ...
Epoch: 3 cost time: 6.468777179718018
Epoch: 3, Steps: 7 | Train Loss: 0.153 Vali Loss: 2.373 Vali Acc: 0.556 Test Loss: 2.373 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.459794521331787
Epoch: 4, Steps: 7 | Train Loss: 0.149 Vali Loss: 2.828 Vali Acc: 0.597 Test Loss: 2.828 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.426568031311035
Epoch: 5, Steps: 7 | Train Loss: 0.103 Vali Loss: 4.854 Vali Acc: 0.514 Test Loss: 4.854 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.515366077423096
Epoch: 6, Steps: 7 | Train Loss: 0.116 Vali Loss: 4.515 Vali Acc: 0.667 Test Loss: 4.515 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.757757663726807
Epoch: 7, Steps: 7 | Train Loss: 0.232 Vali Loss: 5.368 Vali Acc: 0.653 Test Loss: 5.368 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.9171624183654785
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 6.523 Vali Acc: 0.625 Test Loss: 6.523 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.523199796676636
Epoch: 9, Steps: 7 | Train Loss: 0.616 Vali Loss: 7.078 Vali Acc: 0.583 Test Loss: 7.078 Test Acc: 0.583
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.7686607837677
Epoch: 10, Steps: 7 | Train Loss: 0.376 Vali Loss: 11.187 Vali Acc: 0.431 Test Loss: 11.187 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.283282041549683
Epoch: 11, Steps: 7 | Train Loss: 0.221 Vali Loss: 5.853 Vali Acc: 0.722 Test Loss: 5.853 Test Acc: 0.722
Validation loss decreased (-0.680539 --> -0.722164).  Saving model ...
Epoch: 12 cost time: 7.742737531661987
Epoch: 12, Steps: 7 | Train Loss: 0.330 Vali Loss: 9.926 Vali Acc: 0.639 Test Loss: 9.926 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.56119179725647
Epoch: 13, Steps: 7 | Train Loss: 0.516 Vali Loss: 8.375 Vali Acc: 0.597 Test Loss: 8.375 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.901902198791504
Epoch: 14, Steps: 7 | Train Loss: 0.236 Vali Loss: 8.367 Vali Acc: 0.556 Test Loss: 8.367 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.45019268989563
Epoch: 15, Steps: 7 | Train Loss: 0.190 Vali Loss: 7.578 Vali Acc: 0.611 Test Loss: 7.578 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.788976192474365
Epoch: 16, Steps: 7 | Train Loss: 1.655 Vali Loss: 15.240 Vali Acc: 0.458 Test Loss: 15.240 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.139469146728516
Epoch: 17, Steps: 7 | Train Loss: 1.481 Vali Loss: 9.684 Vali Acc: 0.639 Test Loss: 9.684 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.340399026870728
Epoch: 18, Steps: 7 | Train Loss: 0.023 Vali Loss: 11.405 Vali Acc: 0.611 Test Loss: 11.405 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.093647003173828
Epoch: 19, Steps: 7 | Train Loss: 0.296 Vali Loss: 8.474 Vali Acc: 0.694 Test Loss: 8.474 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.169722557067871
Epoch: 20, Steps: 7 | Train Loss: 0.134 Vali Loss: 12.708 Vali Acc: 0.583 Test Loss: 12.708 Test Acc: 0.583
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.376322031021118
Epoch: 21, Steps: 7 | Train Loss: 0.575 Vali Loss: 12.776 Vali Acc: 0.667 Test Loss: 12.776 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7222222222222222
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.88627028465271
Epoch: 1, Steps: 7 | Train Loss: 2.536 Vali Loss: 1.847 Vali Acc: 0.389 Test Loss: 1.847 Test Acc: 0.389
Validation loss decreased (inf --> -0.388870).  Saving model ...
Epoch: 2 cost time: 6.531419038772583
Epoch: 2, Steps: 7 | Train Loss: 0.690 Vali Loss: 2.156 Vali Acc: 0.556 Test Loss: 2.156 Test Acc: 0.556
Validation loss decreased (-0.388870 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 6.93324875831604
Epoch: 3, Steps: 7 | Train Loss: 0.122 Vali Loss: 3.586 Vali Acc: 0.542 Test Loss: 3.586 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.5756659507751465
Epoch: 4, Steps: 7 | Train Loss: 0.061 Vali Loss: 3.887 Vali Acc: 0.514 Test Loss: 3.887 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.845841646194458
Epoch: 5, Steps: 7 | Train Loss: 0.106 Vali Loss: 5.070 Vali Acc: 0.597 Test Loss: 5.070 Test Acc: 0.597
Validation loss decreased (-0.555534 --> -0.597172).  Saving model ...
Epoch: 6 cost time: 4.892823696136475
Epoch: 6, Steps: 7 | Train Loss: 0.066 Vali Loss: 6.327 Vali Acc: 0.569 Test Loss: 6.327 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.1958160400390625
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 6.050 Vali Acc: 0.569 Test Loss: 6.050 Test Acc: 0.569
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.311709403991699
Epoch: 8, Steps: 7 | Train Loss: 0.271 Vali Loss: 5.457 Vali Acc: 0.556 Test Loss: 5.457 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.7196595668792725
Epoch: 9, Steps: 7 | Train Loss: 0.213 Vali Loss: 7.962 Vali Acc: 0.458 Test Loss: 7.962 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.978003025054932
Epoch: 10, Steps: 7 | Train Loss: 0.135 Vali Loss: 7.050 Vali Acc: 0.583 Test Loss: 7.050 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.26309871673584
Epoch: 11, Steps: 7 | Train Loss: 0.503 Vali Loss: 10.107 Vali Acc: 0.514 Test Loss: 10.107 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.53866982460022
Epoch: 12, Steps: 7 | Train Loss: 0.652 Vali Loss: 12.085 Vali Acc: 0.542 Test Loss: 12.085 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.5513434410095215
Epoch: 13, Steps: 7 | Train Loss: 0.207 Vali Loss: 13.614 Vali Acc: 0.500 Test Loss: 13.614 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.7419445514678955
Epoch: 14, Steps: 7 | Train Loss: 0.583 Vali Loss: 14.973 Vali Acc: 0.528 Test Loss: 14.973 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.14670205116272
Epoch: 15, Steps: 7 | Train Loss: 0.589 Vali Loss: 14.278 Vali Acc: 0.528 Test Loss: 14.278 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5972222222222222
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.44821572303772
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.248 Vali Acc: 0.250 Test Loss: 2.248 Test Acc: 0.250
Validation loss decreased (inf --> -0.249978).  Saving model ...
Epoch: 2 cost time: 5.543034791946411
Epoch: 2, Steps: 7 | Train Loss: 0.847 Vali Loss: 2.866 Vali Acc: 0.361 Test Loss: 2.866 Test Acc: 0.361
Validation loss decreased (-0.249978 --> -0.361082).  Saving model ...
Epoch: 3 cost time: 5.245981931686401
Epoch: 3, Steps: 7 | Train Loss: 0.071 Vali Loss: 5.165 Vali Acc: 0.250 Test Loss: 5.165 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.4460203647613525
Epoch: 4, Steps: 7 | Train Loss: 0.451 Vali Loss: 7.791 Vali Acc: 0.278 Test Loss: 7.791 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.190437078475952
Epoch: 5, Steps: 7 | Train Loss: 0.129 Vali Loss: 10.742 Vali Acc: 0.236 Test Loss: 10.742 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.265568017959595
Epoch: 6, Steps: 7 | Train Loss: 0.238 Vali Loss: 8.401 Vali Acc: 0.361 Test Loss: 8.401 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.025741100311279
Epoch: 7, Steps: 7 | Train Loss: 0.460 Vali Loss: 10.529 Vali Acc: 0.417 Test Loss: 10.529 Test Acc: 0.417
Validation loss decreased (-0.361082 --> -0.416561).  Saving model ...
Epoch: 8 cost time: 5.953022003173828
Epoch: 8, Steps: 7 | Train Loss: 0.288 Vali Loss: 7.677 Vali Acc: 0.417 Test Loss: 7.677 Test Acc: 0.417
Validation loss decreased (-0.416561 --> -0.416590).  Saving model ...
Epoch: 9 cost time: 4.423556089401245
Epoch: 9, Steps: 7 | Train Loss: 0.420 Vali Loss: 7.591 Vali Acc: 0.472 Test Loss: 7.591 Test Acc: 0.472
Validation loss decreased (-0.416590 --> -0.472146).  Saving model ...
Epoch: 10 cost time: 5.585927248001099
Epoch: 10, Steps: 7 | Train Loss: 0.096 Vali Loss: 11.758 Vali Acc: 0.375 Test Loss: 11.758 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4588916301727295
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 12.624 Vali Acc: 0.333 Test Loss: 12.624 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.709878444671631
Epoch: 12, Steps: 7 | Train Loss: 0.948 Vali Loss: 13.661 Vali Acc: 0.347 Test Loss: 13.661 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.06358003616333
Epoch: 13, Steps: 7 | Train Loss: 0.302 Vali Loss: 17.677 Vali Acc: 0.306 Test Loss: 17.677 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.731522083282471
Epoch: 14, Steps: 7 | Train Loss: 0.685 Vali Loss: 20.036 Vali Acc: 0.403 Test Loss: 20.036 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.645321369171143
Epoch: 15, Steps: 7 | Train Loss: 0.567 Vali Loss: 20.302 Vali Acc: 0.333 Test Loss: 20.302 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.433189392089844
Epoch: 16, Steps: 7 | Train Loss: 0.738 Vali Loss: 18.200 Vali Acc: 0.347 Test Loss: 18.200 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.488630056381226
Epoch: 17, Steps: 7 | Train Loss: 0.218 Vali Loss: 23.028 Vali Acc: 0.431 Test Loss: 23.028 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.428566217422485
Epoch: 18, Steps: 7 | Train Loss: 0.215 Vali Loss: 19.995 Vali Acc: 0.458 Test Loss: 19.995 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.381566047668457
Epoch: 19, Steps: 7 | Train Loss: 0.696 Vali Loss: 25.906 Vali Acc: 0.444 Test Loss: 25.906 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.184373140335083
Epoch: 1, Steps: 7 | Train Loss: 2.598 Vali Loss: 2.178 Vali Acc: 0.222 Test Loss: 2.178 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 4.4029271602630615
Epoch: 2, Steps: 7 | Train Loss: 0.986 Vali Loss: 2.079 Vali Acc: 0.333 Test Loss: 2.079 Test Acc: 0.333
Validation loss decreased (-0.222200 --> -0.333313).  Saving model ...
Epoch: 3 cost time: 4.769941806793213
Epoch: 3, Steps: 7 | Train Loss: 0.233 Vali Loss: 4.090 Vali Acc: 0.264 Test Loss: 4.090 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.771285772323608
Epoch: 4, Steps: 7 | Train Loss: 0.258 Vali Loss: 5.174 Vali Acc: 0.361 Test Loss: 5.174 Test Acc: 0.361
Validation loss decreased (-0.333313 --> -0.361059).  Saving model ...
Epoch: 5 cost time: 3.9197380542755127
Epoch: 5, Steps: 7 | Train Loss: 0.055 Vali Loss: 8.598 Vali Acc: 0.236 Test Loss: 8.598 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.768265247344971
Epoch: 6, Steps: 7 | Train Loss: 0.059 Vali Loss: 7.326 Vali Acc: 0.292 Test Loss: 7.326 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.812304496765137
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 8.713 Vali Acc: 0.292 Test Loss: 8.713 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.583303928375244
Epoch: 8, Steps: 7 | Train Loss: 0.039 Vali Loss: 8.712 Vali Acc: 0.333 Test Loss: 8.712 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.64327073097229
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 6.694 Vali Acc: 0.347 Test Loss: 6.694 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.753397464752197
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 6.522 Vali Acc: 0.389 Test Loss: 6.522 Test Acc: 0.389
Validation loss decreased (-0.361059 --> -0.388824).  Saving model ...
Epoch: 11 cost time: 4.494381666183472
Epoch: 11, Steps: 7 | Train Loss: 0.059 Vali Loss: 14.803 Vali Acc: 0.222 Test Loss: 14.803 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.960132360458374
Epoch: 12, Steps: 7 | Train Loss: 0.057 Vali Loss: 9.424 Vali Acc: 0.306 Test Loss: 9.424 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.354921102523804
Epoch: 13, Steps: 7 | Train Loss: 0.213 Vali Loss: 8.806 Vali Acc: 0.389 Test Loss: 8.806 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.737850666046143
Epoch: 14, Steps: 7 | Train Loss: 0.110 Vali Loss: 6.840 Vali Acc: 0.500 Test Loss: 6.840 Test Acc: 0.500
Validation loss decreased (-0.388824 --> -0.499932).  Saving model ...
Epoch: 15 cost time: 4.6330246925354
Epoch: 15, Steps: 7 | Train Loss: 0.146 Vali Loss: 5.940 Vali Acc: 0.528 Test Loss: 5.940 Test Acc: 0.528
Validation loss decreased (-0.499932 --> -0.527718).  Saving model ...
Epoch: 16 cost time: 5.43636679649353
Epoch: 16, Steps: 7 | Train Loss: 0.416 Vali Loss: 9.077 Vali Acc: 0.431 Test Loss: 9.077 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.647546291351318
Epoch: 17, Steps: 7 | Train Loss: 0.202 Vali Loss: 9.182 Vali Acc: 0.458 Test Loss: 9.182 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.297600507736206
Epoch: 18, Steps: 7 | Train Loss: 0.468 Vali Loss: 14.264 Vali Acc: 0.333 Test Loss: 14.264 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.588266372680664
Epoch: 19, Steps: 7 | Train Loss: 1.502 Vali Loss: 15.724 Vali Acc: 0.486 Test Loss: 15.724 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.575772523880005
Epoch: 20, Steps: 7 | Train Loss: 1.273 Vali Loss: 15.342 Vali Acc: 0.458 Test Loss: 15.342 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.003968238830566
Epoch: 21, Steps: 7 | Train Loss: 0.402 Vali Loss: 12.551 Vali Acc: 0.486 Test Loss: 12.551 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.8089759349823
Epoch: 22, Steps: 7 | Train Loss: 0.183 Vali Loss: 18.104 Vali Acc: 0.431 Test Loss: 18.104 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.914570093154907
Epoch: 23, Steps: 7 | Train Loss: 0.245 Vali Loss: 15.970 Vali Acc: 0.528 Test Loss: 15.970 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.7223005294799805
Epoch: 24, Steps: 7 | Train Loss: 0.242 Vali Loss: 17.520 Vali Acc: 0.514 Test Loss: 17.520 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.516389846801758
Epoch: 25, Steps: 7 | Train Loss: 0.939 Vali Loss: 20.418 Vali Acc: 0.444 Test Loss: 20.418 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5277777777777778
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.023301839828491
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.190 Vali Acc: 0.264 Test Loss: 2.190 Test Acc: 0.264
Validation loss decreased (inf --> -0.263867).  Saving model ...
Epoch: 2 cost time: 4.268444061279297
Epoch: 2, Steps: 7 | Train Loss: 1.086 Vali Loss: 2.111 Vali Acc: 0.361 Test Loss: 2.111 Test Acc: 0.361
Validation loss decreased (-0.263867 --> -0.361090).  Saving model ...
Epoch: 3 cost time: 5.081310987472534
Epoch: 3, Steps: 7 | Train Loss: 0.219 Vali Loss: 2.964 Vali Acc: 0.347 Test Loss: 2.964 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8267600536346436
Epoch: 4, Steps: 7 | Train Loss: 0.129 Vali Loss: 4.666 Vali Acc: 0.361 Test Loss: 4.666 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8761396408081055
Epoch: 5, Steps: 7 | Train Loss: 0.149 Vali Loss: 6.677 Vali Acc: 0.264 Test Loss: 6.677 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.021311521530151
Epoch: 6, Steps: 7 | Train Loss: 0.161 Vali Loss: 4.646 Vali Acc: 0.194 Test Loss: 4.646 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7206029891967773
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 5.337 Vali Acc: 0.403 Test Loss: 5.337 Test Acc: 0.403
Validation loss decreased (-0.361090 --> -0.402724).  Saving model ...
Epoch: 8 cost time: 5.4230804443359375
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 5.172 Vali Acc: 0.431 Test Loss: 5.172 Test Acc: 0.431
Validation loss decreased (-0.402724 --> -0.430504).  Saving model ...
Epoch: 9 cost time: 4.419471502304077
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 6.815 Vali Acc: 0.333 Test Loss: 6.815 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.82707405090332
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 14.311 Vali Acc: 0.222 Test Loss: 14.311 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.916706085205078
Epoch: 11, Steps: 7 | Train Loss: 0.197 Vali Loss: 8.330 Vali Acc: 0.403 Test Loss: 8.330 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9197826385498047
Epoch: 12, Steps: 7 | Train Loss: 0.236 Vali Loss: 9.038 Vali Acc: 0.458 Test Loss: 9.038 Test Acc: 0.458
Validation loss decreased (-0.430504 --> -0.458243).  Saving model ...
Epoch: 13 cost time: 4.452174425125122
Epoch: 13, Steps: 7 | Train Loss: 0.244 Vali Loss: 10.029 Vali Acc: 0.417 Test Loss: 10.029 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8641462326049805
Epoch: 14, Steps: 7 | Train Loss: 0.219 Vali Loss: 10.319 Vali Acc: 0.417 Test Loss: 10.319 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.2253782749176025
Epoch: 15, Steps: 7 | Train Loss: 0.507 Vali Loss: 11.274 Vali Acc: 0.444 Test Loss: 11.274 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.434892177581787
Epoch: 16, Steps: 7 | Train Loss: 1.048 Vali Loss: 16.360 Vali Acc: 0.431 Test Loss: 16.360 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.071641206741333
Epoch: 17, Steps: 7 | Train Loss: 0.456 Vali Loss: 14.572 Vali Acc: 0.403 Test Loss: 14.572 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.014682292938232
Epoch: 18, Steps: 7 | Train Loss: 0.184 Vali Loss: 13.581 Vali Acc: 0.458 Test Loss: 13.581 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.101392030715942
Epoch: 19, Steps: 7 | Train Loss: 0.099 Vali Loss: 19.408 Vali Acc: 0.236 Test Loss: 19.408 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.78976845741272
Epoch: 20, Steps: 7 | Train Loss: 0.245 Vali Loss: 18.207 Vali Acc: 0.292 Test Loss: 18.207 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.036786794662476
Epoch: 21, Steps: 7 | Train Loss: 0.228 Vali Loss: 9.837 Vali Acc: 0.569 Test Loss: 9.837 Test Acc: 0.569
Validation loss decreased (-0.458243 --> -0.569346).  Saving model ...
Epoch: 22 cost time: 5.449172735214233
Epoch: 22, Steps: 7 | Train Loss: 0.127 Vali Loss: 13.649 Vali Acc: 0.528 Test Loss: 13.649 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.670002222061157
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 14.534 Vali Acc: 0.486 Test Loss: 14.534 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.497457981109619
Epoch: 24, Steps: 7 | Train Loss: 0.113 Vali Loss: 14.271 Vali Acc: 0.458 Test Loss: 14.271 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.490596055984497
Epoch: 25, Steps: 7 | Train Loss: 1.046 Vali Loss: 19.266 Vali Acc: 0.403 Test Loss: 19.266 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.153540372848511
Epoch: 26, Steps: 7 | Train Loss: 0.520 Vali Loss: 18.875 Vali Acc: 0.500 Test Loss: 18.875 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.158921957015991
Epoch: 27, Steps: 7 | Train Loss: 0.164 Vali Loss: 15.685 Vali Acc: 0.528 Test Loss: 15.685 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.117526054382324
Epoch: 28, Steps: 7 | Train Loss: 0.178 Vali Loss: 20.160 Vali Acc: 0.431 Test Loss: 20.160 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.1347410678863525
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 23.410 Vali Acc: 0.486 Test Loss: 23.410 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.252851963043213
Epoch: 30, Steps: 7 | Train Loss: 0.051 Vali Loss: 18.150 Vali Acc: 0.542 Test Loss: 18.150 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.818294525146484
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 16.929 Vali Acc: 0.556 Test Loss: 16.929 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5694444444444444
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.211683511734009
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.369 Vali Acc: 0.153 Test Loss: 2.369 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 4.401510953903198
Epoch: 2, Steps: 7 | Train Loss: 1.155 Vali Loss: 2.193 Vali Acc: 0.306 Test Loss: 2.193 Test Acc: 0.306
Validation loss decreased (-0.152754 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 4.146407127380371
Epoch: 3, Steps: 7 | Train Loss: 0.210 Vali Loss: 3.864 Vali Acc: 0.236 Test Loss: 3.864 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.881976366043091
Epoch: 4, Steps: 7 | Train Loss: 0.097 Vali Loss: 3.854 Vali Acc: 0.431 Test Loss: 3.854 Test Acc: 0.431
Validation loss decreased (-0.305534 --> -0.430517).  Saving model ...
Epoch: 5 cost time: 5.173208475112915
Epoch: 5, Steps: 7 | Train Loss: 0.164 Vali Loss: 5.571 Vali Acc: 0.319 Test Loss: 5.571 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.434469938278198
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 4.366 Vali Acc: 0.319 Test Loss: 4.366 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.543183088302612
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 5.358 Vali Acc: 0.472 Test Loss: 5.358 Test Acc: 0.472
Validation loss decreased (-0.430517 --> -0.472169).  Saving model ...
Epoch: 8 cost time: 4.275537014007568
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 5.367 Vali Acc: 0.361 Test Loss: 5.367 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9455721378326416
Epoch: 9, Steps: 7 | Train Loss: 0.051 Vali Loss: 8.163 Vali Acc: 0.194 Test Loss: 8.163 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.355591297149658
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.866 Vali Acc: 0.361 Test Loss: 7.866 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.62853741645813
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 7.420 Vali Acc: 0.347 Test Loss: 7.420 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.89571475982666
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 6.945 Vali Acc: 0.417 Test Loss: 6.945 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.297056674957275
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 7.863 Vali Acc: 0.292 Test Loss: 7.863 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.2698705196380615
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.776 Vali Acc: 0.375 Test Loss: 6.776 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.201644659042358
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.958 Vali Acc: 0.431 Test Loss: 5.958 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7314720153808594
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.322 Vali Acc: 0.431 Test Loss: 6.322 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.311527967453003
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.660 Vali Acc: 0.431 Test Loss: 6.660 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.466103553771973
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.376 Vali Acc: 0.194 Test Loss: 2.376 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 4.792354583740234
Epoch: 2, Steps: 7 | Train Loss: 1.429 Vali Loss: 2.508 Vali Acc: 0.250 Test Loss: 2.508 Test Acc: 0.250
Validation loss decreased (-0.194421 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 4.399694442749023
Epoch: 3, Steps: 7 | Train Loss: 0.353 Vali Loss: 3.525 Vali Acc: 0.194 Test Loss: 3.525 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.618549346923828
Epoch: 4, Steps: 7 | Train Loss: 0.152 Vali Loss: 5.399 Vali Acc: 0.153 Test Loss: 5.399 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.267752170562744
Epoch: 5, Steps: 7 | Train Loss: 0.187 Vali Loss: 4.068 Vali Acc: 0.250 Test Loss: 4.068 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.606061697006226
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 4.107 Vali Acc: 0.292 Test Loss: 4.107 Test Acc: 0.292
Validation loss decreased (-0.249975 --> -0.291626).  Saving model ...
Epoch: 7 cost time: 4.314490556716919
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 8.062 Vali Acc: 0.167 Test Loss: 8.062 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.777061223983765
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 7.790 Vali Acc: 0.194 Test Loss: 7.790 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.328930616378784
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 9.224 Vali Acc: 0.278 Test Loss: 9.224 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.741562366485596
Epoch: 10, Steps: 7 | Train Loss: 0.272 Vali Loss: 7.056 Vali Acc: 0.278 Test Loss: 7.056 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.469508647918701
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 8.313 Vali Acc: 0.306 Test Loss: 8.313 Test Acc: 0.306
Validation loss decreased (-0.291626 --> -0.305472).  Saving model ...
Epoch: 12 cost time: 3.6948039531707764
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.712 Vali Acc: 0.236 Test Loss: 6.712 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.251346588134766
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 6.473 Vali Acc: 0.222 Test Loss: 6.473 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.046326160430908
Epoch: 14, Steps: 7 | Train Loss: 0.045 Vali Loss: 6.941 Vali Acc: 0.347 Test Loss: 6.941 Test Acc: 0.347
Validation loss decreased (-0.305472 --> -0.347153).  Saving model ...
Epoch: 15 cost time: 4.601929426193237
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.666 Vali Acc: 0.250 Test Loss: 6.666 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.4768288135528564
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.439 Vali Acc: 0.292 Test Loss: 6.439 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.520622253417969
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.276 Vali Acc: 0.194 Test Loss: 6.276 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.1792402267456055
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.090 Vali Acc: 0.222 Test Loss: 6.090 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4687702655792236
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.876 Vali Acc: 0.264 Test Loss: 5.876 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5695459842681885
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.839 Vali Acc: 0.306 Test Loss: 5.839 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.192412376403809
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.795 Vali Acc: 0.319 Test Loss: 5.795 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.080077171325684
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.748 Vali Acc: 0.319 Test Loss: 5.748 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.727187871932983
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.719 Vali Acc: 0.306 Test Loss: 5.719 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.352534055709839
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.695 Vali Acc: 0.306 Test Loss: 5.695 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3472222222222222
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.9146833419799805
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.563 Vali Acc: 0.139 Test Loss: 2.563 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 4.216497182846069
Epoch: 2, Steps: 7 | Train Loss: 1.384 Vali Loss: 2.915 Vali Acc: 0.181 Test Loss: 2.915 Test Acc: 0.181
Validation loss decreased (-0.138863 --> -0.180526).  Saving model ...
Epoch: 3 cost time: 4.530221939086914
Epoch: 3, Steps: 7 | Train Loss: 0.390 Vali Loss: 3.734 Vali Acc: 0.181 Test Loss: 3.734 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.210247039794922
Epoch: 4, Steps: 7 | Train Loss: 0.307 Vali Loss: 5.509 Vali Acc: 0.125 Test Loss: 5.509 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.088359355926514
Epoch: 5, Steps: 7 | Train Loss: 0.218 Vali Loss: 6.402 Vali Acc: 0.194 Test Loss: 6.402 Test Acc: 0.194
Validation loss decreased (-0.180526 --> -0.194380).  Saving model ...
Epoch: 6 cost time: 4.370491027832031
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 6.380 Vali Acc: 0.194 Test Loss: 6.380 Test Acc: 0.194
Validation loss decreased (-0.194380 --> -0.194381).  Saving model ...
Epoch: 7 cost time: 3.7721686363220215
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 5.690 Vali Acc: 0.222 Test Loss: 5.690 Test Acc: 0.222
Validation loss decreased (-0.194381 --> -0.222165).  Saving model ...
Epoch: 8 cost time: 3.8570847511291504
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 6.433 Vali Acc: 0.194 Test Loss: 6.433 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1306257247924805
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 6.623 Vali Acc: 0.236 Test Loss: 6.623 Test Acc: 0.236
Validation loss decreased (-0.222165 --> -0.236045).  Saving model ...
Epoch: 10 cost time: 5.0248823165893555
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 5.560 Vali Acc: 0.292 Test Loss: 5.560 Test Acc: 0.292
Validation loss decreased (-0.236045 --> -0.291611).  Saving model ...
Epoch: 11 cost time: 4.790877103805542
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.897 Vali Acc: 0.208 Test Loss: 6.897 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.1403892040252686
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 8.658 Vali Acc: 0.125 Test Loss: 8.658 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.861800193786621
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 9.647 Vali Acc: 0.139 Test Loss: 9.647 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.731336832046509
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 9.939 Vali Acc: 0.167 Test Loss: 9.939 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.11229395866394
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 9.968 Vali Acc: 0.167 Test Loss: 9.968 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.013551235198975
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.483 Vali Acc: 0.167 Test Loss: 10.483 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.2931365966796875
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.287 Vali Acc: 0.167 Test Loss: 10.287 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.516671180725098
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 11.007 Vali Acc: 0.236 Test Loss: 11.007 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7445316314697266
Epoch: 19, Steps: 7 | Train Loss: 0.026 Vali Loss: 9.675 Vali Acc: 0.181 Test Loss: 9.675 Test Acc: 0.181
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.0075390338897705
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 11.918 Vali Acc: 0.181 Test Loss: 11.918 Test Acc: 0.181
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 19447308
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.116886377334595
Epoch: 1, Steps: 7 | Train Loss: 2.341 Vali Loss: 1.570 Vali Acc: 0.653 Test Loss: 1.570 Test Acc: 0.653
Validation loss decreased (inf --> -0.652762).  Saving model ...
Epoch: 2 cost time: 8.813892364501953
Epoch: 2, Steps: 7 | Train Loss: 0.411 Vali Loss: 2.076 Vali Acc: 0.653 Test Loss: 2.076 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.131218194961548
Epoch: 3, Steps: 7 | Train Loss: 0.152 Vali Loss: 2.716 Vali Acc: 0.708 Test Loss: 2.716 Test Acc: 0.708
Validation loss decreased (-0.652762 --> -0.708306).  Saving model ...
Epoch: 4 cost time: 9.599772214889526
Epoch: 4, Steps: 7 | Train Loss: 0.100 Vali Loss: 4.238 Vali Acc: 0.667 Test Loss: 4.238 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.813312292098999
Epoch: 5, Steps: 7 | Train Loss: 0.021 Vali Loss: 5.863 Vali Acc: 0.653 Test Loss: 5.863 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.3195219039917
Epoch: 6, Steps: 7 | Train Loss: 0.027 Vali Loss: 5.973 Vali Acc: 0.722 Test Loss: 5.973 Test Acc: 0.722
Validation loss decreased (-0.708306 --> -0.722162).  Saving model ...
Epoch: 7 cost time: 7.826707363128662
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.798 Vali Acc: 0.694 Test Loss: 6.798 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.731837511062622
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 5.655 Vali Acc: 0.694 Test Loss: 5.655 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.73973274230957
Epoch: 9, Steps: 7 | Train Loss: 0.102 Vali Loss: 4.618 Vali Acc: 0.764 Test Loss: 4.618 Test Acc: 0.764
Validation loss decreased (-0.722162 --> -0.763843).  Saving model ...
Epoch: 10 cost time: 7.984086513519287
Epoch: 10, Steps: 7 | Train Loss: 0.078 Vali Loss: 6.093 Vali Acc: 0.708 Test Loss: 6.093 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.874008655548096
Epoch: 11, Steps: 7 | Train Loss: 0.333 Vali Loss: 8.679 Vali Acc: 0.625 Test Loss: 8.679 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.779337644577026
Epoch: 12, Steps: 7 | Train Loss: 0.213 Vali Loss: 5.667 Vali Acc: 0.736 Test Loss: 5.667 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.102048397064209
Epoch: 13, Steps: 7 | Train Loss: 0.179 Vali Loss: 11.897 Vali Acc: 0.625 Test Loss: 11.897 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.200368642807007
Epoch: 14, Steps: 7 | Train Loss: 0.414 Vali Loss: 11.126 Vali Acc: 0.653 Test Loss: 11.126 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.044421434402466
Epoch: 15, Steps: 7 | Train Loss: 0.293 Vali Loss: 10.429 Vali Acc: 0.653 Test Loss: 10.429 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.840416669845581
Epoch: 16, Steps: 7 | Train Loss: 0.615 Vali Loss: 9.996 Vali Acc: 0.764 Test Loss: 9.996 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.69059944152832
Epoch: 17, Steps: 7 | Train Loss: 0.361 Vali Loss: 18.427 Vali Acc: 0.625 Test Loss: 18.427 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.897579669952393
Epoch: 18, Steps: 7 | Train Loss: 0.847 Vali Loss: 14.418 Vali Acc: 0.722 Test Loss: 14.418 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.432788372039795
Epoch: 19, Steps: 7 | Train Loss: 0.646 Vali Loss: 12.922 Vali Acc: 0.708 Test Loss: 12.922 Test Acc: 0.708
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7638888888888888
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.065624713897705
Epoch: 1, Steps: 7 | Train Loss: 2.428 Vali Loss: 1.763 Vali Acc: 0.639 Test Loss: 1.763 Test Acc: 0.639
Validation loss decreased (inf --> -0.638871).  Saving model ...
Epoch: 2 cost time: 6.6075732707977295
Epoch: 2, Steps: 7 | Train Loss: 0.637 Vali Loss: 2.349 Vali Acc: 0.569 Test Loss: 2.349 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.518925666809082
Epoch: 3, Steps: 7 | Train Loss: 0.281 Vali Loss: 2.680 Vali Acc: 0.681 Test Loss: 2.680 Test Acc: 0.681
Validation loss decreased (-0.638871 --> -0.680529).  Saving model ...
Epoch: 4 cost time: 8.188690185546875
Epoch: 4, Steps: 7 | Train Loss: 0.081 Vali Loss: 2.934 Vali Acc: 0.694 Test Loss: 2.934 Test Acc: 0.694
Validation loss decreased (-0.680529 --> -0.694415).  Saving model ...
Epoch: 5 cost time: 8.03061032295227
Epoch: 5, Steps: 7 | Train Loss: 0.095 Vali Loss: 6.550 Vali Acc: 0.681 Test Loss: 6.550 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.338064670562744
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.954 Vali Acc: 0.750 Test Loss: 5.954 Test Acc: 0.750
Validation loss decreased (-0.694415 --> -0.749940).  Saving model ...
Epoch: 7 cost time: 7.069955587387085
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 3.991 Vali Acc: 0.722 Test Loss: 3.991 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.822256803512573
Epoch: 8, Steps: 7 | Train Loss: 0.117 Vali Loss: 5.221 Vali Acc: 0.708 Test Loss: 5.221 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.57038950920105
Epoch: 9, Steps: 7 | Train Loss: 0.050 Vali Loss: 6.630 Vali Acc: 0.681 Test Loss: 6.630 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.9246985912323
Epoch: 10, Steps: 7 | Train Loss: 0.120 Vali Loss: 8.507 Vali Acc: 0.639 Test Loss: 8.507 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.090215921401978
Epoch: 11, Steps: 7 | Train Loss: 0.193 Vali Loss: 11.471 Vali Acc: 0.681 Test Loss: 11.471 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.70053744316101
Epoch: 12, Steps: 7 | Train Loss: 0.070 Vali Loss: 11.129 Vali Acc: 0.653 Test Loss: 11.129 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.622000455856323
Epoch: 13, Steps: 7 | Train Loss: 0.345 Vali Loss: 9.528 Vali Acc: 0.694 Test Loss: 9.528 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.016899108886719
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 8.550 Vali Acc: 0.708 Test Loss: 8.550 Test Acc: 0.708
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.756792306900024
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.011 Vali Acc: 0.625 Test Loss: 12.011 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.963783025741577
Epoch: 16, Steps: 7 | Train Loss: 0.667 Vali Loss: 16.103 Vali Acc: 0.597 Test Loss: 16.103 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.75
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.662645101547241
Epoch: 1, Steps: 7 | Train Loss: 2.461 Vali Loss: 2.029 Vali Acc: 0.556 Test Loss: 2.029 Test Acc: 0.556
Validation loss decreased (inf --> -0.555535).  Saving model ...
Epoch: 2 cost time: 6.306852579116821
Epoch: 2, Steps: 7 | Train Loss: 0.801 Vali Loss: 2.260 Vali Acc: 0.556 Test Loss: 2.260 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.891347646713257
Epoch: 3, Steps: 7 | Train Loss: 0.144 Vali Loss: 1.781 Vali Acc: 0.736 Test Loss: 1.781 Test Acc: 0.736
Validation loss decreased (-0.555535 --> -0.736093).  Saving model ...
Epoch: 4 cost time: 6.518697738647461
Epoch: 4, Steps: 7 | Train Loss: 0.099 Vali Loss: 3.099 Vali Acc: 0.653 Test Loss: 3.099 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.611884593963623
Epoch: 5, Steps: 7 | Train Loss: 0.195 Vali Loss: 3.190 Vali Acc: 0.722 Test Loss: 3.190 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.140343189239502
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 3.392 Vali Acc: 0.694 Test Loss: 3.392 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.40386438369751
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.556 Vali Acc: 0.681 Test Loss: 4.556 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.317514419555664
Epoch: 8, Steps: 7 | Train Loss: 0.105 Vali Loss: 3.849 Vali Acc: 0.736 Test Loss: 3.849 Test Acc: 0.736
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.021888971328735
Epoch: 9, Steps: 7 | Train Loss: 0.129 Vali Loss: 5.798 Vali Acc: 0.556 Test Loss: 5.798 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.342569351196289
Epoch: 10, Steps: 7 | Train Loss: 0.054 Vali Loss: 7.233 Vali Acc: 0.542 Test Loss: 7.233 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.999350309371948
Epoch: 11, Steps: 7 | Train Loss: 0.072 Vali Loss: 7.491 Vali Acc: 0.528 Test Loss: 7.491 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.691448450088501
Epoch: 12, Steps: 7 | Train Loss: 0.066 Vali Loss: 8.340 Vali Acc: 0.653 Test Loss: 8.340 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.525964975357056
Epoch: 13, Steps: 7 | Train Loss: 0.305 Vali Loss: 5.331 Vali Acc: 0.625 Test Loss: 5.331 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7361111111111112
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.735241413116455
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.401 Vali Acc: 0.431 Test Loss: 2.401 Test Acc: 0.431
Validation loss decreased (inf --> -0.430532).  Saving model ...
Epoch: 2 cost time: 6.083390712738037
Epoch: 2, Steps: 7 | Train Loss: 0.883 Vali Loss: 2.737 Vali Acc: 0.458 Test Loss: 2.737 Test Acc: 0.458
Validation loss decreased (-0.430532 --> -0.458306).  Saving model ...
Epoch: 3 cost time: 5.187638282775879
Epoch: 3, Steps: 7 | Train Loss: 0.154 Vali Loss: 2.923 Vali Acc: 0.528 Test Loss: 2.923 Test Acc: 0.528
Validation loss decreased (-0.458306 --> -0.527749).  Saving model ...
Epoch: 4 cost time: 5.08571457862854
Epoch: 4, Steps: 7 | Train Loss: 0.188 Vali Loss: 3.051 Vali Acc: 0.556 Test Loss: 3.051 Test Acc: 0.556
Validation loss decreased (-0.527749 --> -0.555525).  Saving model ...
Epoch: 5 cost time: 5.382260322570801
Epoch: 5, Steps: 7 | Train Loss: 0.045 Vali Loss: 3.391 Vali Acc: 0.556 Test Loss: 3.391 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.634751081466675
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 3.410 Vali Acc: 0.611 Test Loss: 3.410 Test Acc: 0.611
Validation loss decreased (-0.555525 --> -0.611077).  Saving model ...
Epoch: 7 cost time: 6.27610969543457
Epoch: 7, Steps: 7 | Train Loss: 0.120 Vali Loss: 8.710 Vali Acc: 0.431 Test Loss: 8.710 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.955430269241333
Epoch: 8, Steps: 7 | Train Loss: 0.635 Vali Loss: 6.468 Vali Acc: 0.472 Test Loss: 6.468 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.838915109634399
Epoch: 9, Steps: 7 | Train Loss: 0.114 Vali Loss: 8.199 Vali Acc: 0.347 Test Loss: 8.199 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.692133903503418
Epoch: 10, Steps: 7 | Train Loss: 0.271 Vali Loss: 5.297 Vali Acc: 0.597 Test Loss: 5.297 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.967419862747192
Epoch: 11, Steps: 7 | Train Loss: 0.177 Vali Loss: 7.267 Vali Acc: 0.514 Test Loss: 7.267 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.652790307998657
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 8.861 Vali Acc: 0.556 Test Loss: 8.861 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.5642900466918945
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 8.075 Vali Acc: 0.542 Test Loss: 8.075 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.702936172485352
Epoch: 14, Steps: 7 | Train Loss: 0.094 Vali Loss: 9.153 Vali Acc: 0.611 Test Loss: 9.153 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.409918546676636
Epoch: 15, Steps: 7 | Train Loss: 0.592 Vali Loss: 11.819 Vali Acc: 0.583 Test Loss: 11.819 Test Acc: 0.583
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.060467481613159
Epoch: 16, Steps: 7 | Train Loss: 1.043 Vali Loss: 24.312 Vali Acc: 0.306 Test Loss: 24.312 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6111111111111112
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.426721572875977
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.719 Vali Acc: 0.292 Test Loss: 2.719 Test Acc: 0.292
Validation loss decreased (inf --> -0.291639).  Saving model ...
Epoch: 2 cost time: 4.25315260887146
Epoch: 2, Steps: 7 | Train Loss: 0.975 Vali Loss: 4.538 Vali Acc: 0.292 Test Loss: 4.538 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.568747282028198
Epoch: 3, Steps: 7 | Train Loss: 0.286 Vali Loss: 3.345 Vali Acc: 0.347 Test Loss: 3.345 Test Acc: 0.347
Validation loss decreased (-0.291639 --> -0.347189).  Saving model ...
Epoch: 4 cost time: 5.628544569015503
Epoch: 4, Steps: 7 | Train Loss: 0.073 Vali Loss: 6.347 Vali Acc: 0.389 Test Loss: 6.347 Test Acc: 0.389
Validation loss decreased (-0.347189 --> -0.388825).  Saving model ...
Epoch: 5 cost time: 5.226820468902588
Epoch: 5, Steps: 7 | Train Loss: 0.093 Vali Loss: 5.556 Vali Acc: 0.375 Test Loss: 5.556 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.236480712890625
Epoch: 6, Steps: 7 | Train Loss: 0.104 Vali Loss: 6.546 Vali Acc: 0.431 Test Loss: 6.546 Test Acc: 0.431
Validation loss decreased (-0.388825 --> -0.430490).  Saving model ...
Epoch: 7 cost time: 4.916532516479492
Epoch: 7, Steps: 7 | Train Loss: 0.066 Vali Loss: 9.591 Vali Acc: 0.333 Test Loss: 9.591 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.526672840118408
Epoch: 8, Steps: 7 | Train Loss: 0.124 Vali Loss: 7.120 Vali Acc: 0.458 Test Loss: 7.120 Test Acc: 0.458
Validation loss decreased (-0.430490 --> -0.458262).  Saving model ...
Epoch: 9 cost time: 4.658381938934326
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 9.833 Vali Acc: 0.431 Test Loss: 9.833 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9092020988464355
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 9.664 Vali Acc: 0.361 Test Loss: 9.664 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.64339542388916
Epoch: 11, Steps: 7 | Train Loss: 0.113 Vali Loss: 12.216 Vali Acc: 0.292 Test Loss: 12.216 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.43129563331604
Epoch: 12, Steps: 7 | Train Loss: 0.216 Vali Loss: 14.267 Vali Acc: 0.361 Test Loss: 14.267 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.859500408172607
Epoch: 13, Steps: 7 | Train Loss: 0.873 Vali Loss: 15.421 Vali Acc: 0.306 Test Loss: 15.421 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.336713552474976
Epoch: 14, Steps: 7 | Train Loss: 0.874 Vali Loss: 21.286 Vali Acc: 0.250 Test Loss: 21.286 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.150914907455444
Epoch: 15, Steps: 7 | Train Loss: 0.074 Vali Loss: 19.126 Vali Acc: 0.264 Test Loss: 19.126 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.156893730163574
Epoch: 16, Steps: 7 | Train Loss: 0.224 Vali Loss: 16.077 Vali Acc: 0.361 Test Loss: 16.077 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.409649848937988
Epoch: 17, Steps: 7 | Train Loss: 1.028 Vali Loss: 17.737 Vali Acc: 0.403 Test Loss: 17.737 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.471835374832153
Epoch: 18, Steps: 7 | Train Loss: 0.656 Vali Loss: 22.300 Vali Acc: 0.403 Test Loss: 22.300 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.950956106185913
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.567 Vali Acc: 0.236 Test Loss: 2.567 Test Acc: 0.236
Validation loss decreased (inf --> -0.236085).  Saving model ...
Epoch: 2 cost time: 3.927868366241455
Epoch: 2, Steps: 7 | Train Loss: 1.120 Vali Loss: 3.931 Vali Acc: 0.250 Test Loss: 3.931 Test Acc: 0.250
Validation loss decreased (-0.236085 --> -0.249961).  Saving model ...
Epoch: 3 cost time: 3.466726064682007
Epoch: 3, Steps: 7 | Train Loss: 0.233 Vali Loss: 3.154 Vali Acc: 0.333 Test Loss: 3.154 Test Acc: 0.333
Validation loss decreased (-0.249961 --> -0.333302).  Saving model ...
Epoch: 4 cost time: 3.838927984237671
Epoch: 4, Steps: 7 | Train Loss: 0.155 Vali Loss: 5.207 Vali Acc: 0.333 Test Loss: 5.207 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9071874618530273
Epoch: 5, Steps: 7 | Train Loss: 0.066 Vali Loss: 4.494 Vali Acc: 0.306 Test Loss: 4.494 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.784770965576172
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 6.113 Vali Acc: 0.389 Test Loss: 6.113 Test Acc: 0.389
Validation loss decreased (-0.333302 --> -0.388828).  Saving model ...
Epoch: 7 cost time: 4.274040937423706
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 8.260 Vali Acc: 0.264 Test Loss: 8.260 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.002413034439087
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 6.241 Vali Acc: 0.375 Test Loss: 6.241 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.719048500061035
Epoch: 9, Steps: 7 | Train Loss: 0.039 Vali Loss: 6.587 Vali Acc: 0.333 Test Loss: 6.587 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8045284748077393
Epoch: 10, Steps: 7 | Train Loss: 0.238 Vali Loss: 5.378 Vali Acc: 0.431 Test Loss: 5.378 Test Acc: 0.431
Validation loss decreased (-0.388828 --> -0.430502).  Saving model ...
Epoch: 11 cost time: 4.955669164657593
Epoch: 11, Steps: 7 | Train Loss: 0.426 Vali Loss: 9.763 Vali Acc: 0.319 Test Loss: 9.763 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.927659511566162
Epoch: 12, Steps: 7 | Train Loss: 0.212 Vali Loss: 9.493 Vali Acc: 0.361 Test Loss: 9.493 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.919404745101929
Epoch: 13, Steps: 7 | Train Loss: 0.069 Vali Loss: 9.721 Vali Acc: 0.319 Test Loss: 9.721 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.431663513183594
Epoch: 14, Steps: 7 | Train Loss: 0.308 Vali Loss: 10.085 Vali Acc: 0.375 Test Loss: 10.085 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.271902561187744
Epoch: 15, Steps: 7 | Train Loss: 0.283 Vali Loss: 14.922 Vali Acc: 0.333 Test Loss: 14.922 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9776811599731445
Epoch: 16, Steps: 7 | Train Loss: 0.458 Vali Loss: 12.759 Vali Acc: 0.444 Test Loss: 12.759 Test Acc: 0.444
Validation loss decreased (-0.430502 --> -0.444317).  Saving model ...
Epoch: 17 cost time: 4.312687635421753
Epoch: 17, Steps: 7 | Train Loss: 1.001 Vali Loss: 16.596 Vali Acc: 0.375 Test Loss: 16.596 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.8891706466674805
Epoch: 18, Steps: 7 | Train Loss: 0.266 Vali Loss: 29.467 Vali Acc: 0.194 Test Loss: 29.467 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.631800651550293
Epoch: 19, Steps: 7 | Train Loss: 1.148 Vali Loss: 17.784 Vali Acc: 0.333 Test Loss: 17.784 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.2897679805755615
Epoch: 20, Steps: 7 | Train Loss: 0.490 Vali Loss: 19.571 Vali Acc: 0.403 Test Loss: 19.571 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.965876817703247
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 15.626 Vali Acc: 0.403 Test Loss: 15.626 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.855069875717163
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 16.611 Vali Acc: 0.514 Test Loss: 16.611 Test Acc: 0.514
Validation loss decreased (-0.444317 --> -0.513723).  Saving model ...
Epoch: 23 cost time: 4.8641273975372314
Epoch: 23, Steps: 7 | Train Loss: 0.495 Vali Loss: 35.472 Vali Acc: 0.264 Test Loss: 35.472 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.703662157058716
Epoch: 24, Steps: 7 | Train Loss: 0.772 Vali Loss: 19.503 Vali Acc: 0.333 Test Loss: 19.503 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.576639175415039
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 20.752 Vali Acc: 0.431 Test Loss: 20.752 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.387596368789673
Epoch: 26, Steps: 7 | Train Loss: 0.186 Vali Loss: 19.365 Vali Acc: 0.444 Test Loss: 19.365 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.3597798347473145
Epoch: 27, Steps: 7 | Train Loss: 0.227 Vali Loss: 23.400 Vali Acc: 0.556 Test Loss: 23.400 Test Acc: 0.556
Validation loss decreased (-0.513723 --> -0.555322).  Saving model ...
Epoch: 28 cost time: 4.807961940765381
Epoch: 28, Steps: 7 | Train Loss: 0.146 Vali Loss: 29.622 Vali Acc: 0.417 Test Loss: 29.622 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.49529504776001
Epoch: 29, Steps: 7 | Train Loss: 0.252 Vali Loss: 22.097 Vali Acc: 0.472 Test Loss: 22.097 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.816138744354248
Epoch: 30, Steps: 7 | Train Loss: 0.112 Vali Loss: 21.572 Vali Acc: 0.528 Test Loss: 21.572 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.256586790084839
Epoch: 31, Steps: 7 | Train Loss: 0.373 Vali Loss: 24.210 Vali Acc: 0.472 Test Loss: 24.210 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.638050556182861
Epoch: 32, Steps: 7 | Train Loss: 0.137 Vali Loss: 15.326 Vali Acc: 0.569 Test Loss: 15.326 Test Acc: 0.569
Validation loss decreased (-0.555322 --> -0.569291).  Saving model ...
Epoch: 33 cost time: 5.16627311706543
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 21.665 Vali Acc: 0.472 Test Loss: 21.665 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.2462334632873535
Epoch: 34, Steps: 7 | Train Loss: 0.188 Vali Loss: 18.068 Vali Acc: 0.597 Test Loss: 18.068 Test Acc: 0.597
Validation loss decreased (-0.569291 --> -0.597042).  Saving model ...
Epoch: 35 cost time: 5.428077697753906
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 17.602 Vali Acc: 0.583 Test Loss: 17.602 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.569166421890259
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 18.361 Vali Acc: 0.542 Test Loss: 18.361 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.0922300815582275
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 18.916 Vali Acc: 0.542 Test Loss: 18.916 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.821509599685669
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.227 Vali Acc: 0.528 Test Loss: 19.227 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.102622985839844
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.396 Vali Acc: 0.528 Test Loss: 19.396 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.271053791046143
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.479 Vali Acc: 0.528 Test Loss: 19.479 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.1716628074646
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.437 Vali Acc: 0.528 Test Loss: 19.437 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.300685167312622
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.417 Vali Acc: 0.528 Test Loss: 19.417 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.717087030410767
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.406 Vali Acc: 0.528 Test Loss: 19.406 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.295721769332886
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.400 Vali Acc: 0.514 Test Loss: 19.400 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5972222222222222
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.860659599304199
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.507 Vali Acc: 0.181 Test Loss: 2.507 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 4.429701805114746
Epoch: 2, Steps: 7 | Train Loss: 1.272 Vali Loss: 3.719 Vali Acc: 0.292 Test Loss: 3.719 Test Acc: 0.292
Validation loss decreased (-0.180530 --> -0.291629).  Saving model ...
Epoch: 3 cost time: 4.123202323913574
Epoch: 3, Steps: 7 | Train Loss: 0.286 Vali Loss: 3.732 Vali Acc: 0.222 Test Loss: 3.732 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.856971502304077
Epoch: 4, Steps: 7 | Train Loss: 0.157 Vali Loss: 4.199 Vali Acc: 0.306 Test Loss: 4.199 Test Acc: 0.306
Validation loss decreased (-0.291629 --> -0.305514).  Saving model ...
Epoch: 5 cost time: 3.502500057220459
Epoch: 5, Steps: 7 | Train Loss: 0.023 Vali Loss: 3.021 Vali Acc: 0.333 Test Loss: 3.021 Test Acc: 0.333
Validation loss decreased (-0.305514 --> -0.333303).  Saving model ...
Epoch: 6 cost time: 4.136428117752075
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 6.607 Vali Acc: 0.319 Test Loss: 6.607 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.462045192718506
Epoch: 7, Steps: 7 | Train Loss: 0.355 Vali Loss: 7.077 Vali Acc: 0.306 Test Loss: 7.077 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.967634916305542
Epoch: 8, Steps: 7 | Train Loss: 0.147 Vali Loss: 7.962 Vali Acc: 0.292 Test Loss: 7.962 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.368568658828735
Epoch: 9, Steps: 7 | Train Loss: 0.244 Vali Loss: 6.738 Vali Acc: 0.333 Test Loss: 6.738 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.1858229637146
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 14.413 Vali Acc: 0.167 Test Loss: 14.413 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.471636772155762
Epoch: 11, Steps: 7 | Train Loss: 0.040 Vali Loss: 7.938 Vali Acc: 0.444 Test Loss: 7.938 Test Acc: 0.444
Validation loss decreased (-0.333303 --> -0.444365).  Saving model ...
Epoch: 12 cost time: 4.225151062011719
Epoch: 12, Steps: 7 | Train Loss: 0.166 Vali Loss: 12.085 Vali Acc: 0.361 Test Loss: 12.085 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9205710887908936
Epoch: 13, Steps: 7 | Train Loss: 0.241 Vali Loss: 8.544 Vali Acc: 0.333 Test Loss: 8.544 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.537470817565918
Epoch: 14, Steps: 7 | Train Loss: 0.119 Vali Loss: 7.819 Vali Acc: 0.347 Test Loss: 7.819 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.060043096542358
Epoch: 15, Steps: 7 | Train Loss: 0.258 Vali Loss: 12.078 Vali Acc: 0.458 Test Loss: 12.078 Test Acc: 0.458
Validation loss decreased (-0.444365 --> -0.458213).  Saving model ...
Epoch: 16 cost time: 4.016051530838013
Epoch: 16, Steps: 7 | Train Loss: 0.060 Vali Loss: 20.206 Vali Acc: 0.222 Test Loss: 20.206 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.781530857086182
Epoch: 17, Steps: 7 | Train Loss: 0.225 Vali Loss: 19.635 Vali Acc: 0.208 Test Loss: 19.635 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.175706386566162
Epoch: 18, Steps: 7 | Train Loss: 0.682 Vali Loss: 5.746 Vali Acc: 0.556 Test Loss: 5.746 Test Acc: 0.556
Validation loss decreased (-0.458213 --> -0.555498).  Saving model ...
Epoch: 19 cost time: 4.229527473449707
Epoch: 19, Steps: 7 | Train Loss: 0.613 Vali Loss: 11.196 Vali Acc: 0.458 Test Loss: 11.196 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.371008634567261
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 11.647 Vali Acc: 0.347 Test Loss: 11.647 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7418620586395264
Epoch: 21, Steps: 7 | Train Loss: 0.389 Vali Loss: 10.733 Vali Acc: 0.444 Test Loss: 10.733 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.356282949447632
Epoch: 22, Steps: 7 | Train Loss: 0.032 Vali Loss: 20.248 Vali Acc: 0.403 Test Loss: 20.248 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.7572662830352783
Epoch: 23, Steps: 7 | Train Loss: 0.176 Vali Loss: 15.543 Vali Acc: 0.347 Test Loss: 15.543 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.957592010498047
Epoch: 24, Steps: 7 | Train Loss: 0.065 Vali Loss: 12.288 Vali Acc: 0.431 Test Loss: 12.288 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.729686737060547
Epoch: 25, Steps: 7 | Train Loss: 0.300 Vali Loss: 10.197 Vali Acc: 0.417 Test Loss: 10.197 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.5721471309661865
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 13.009 Vali Acc: 0.375 Test Loss: 13.009 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.393264055252075
Epoch: 27, Steps: 7 | Train Loss: 0.140 Vali Loss: 14.795 Vali Acc: 0.417 Test Loss: 14.795 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.8798069953918457
Epoch: 28, Steps: 7 | Train Loss: 0.118 Vali Loss: 14.396 Vali Acc: 0.486 Test Loss: 14.396 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5555555555555556
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.741222143173218
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.709 Vali Acc: 0.125 Test Loss: 2.709 Test Acc: 0.125
Validation loss decreased (inf --> -0.124973).  Saving model ...
Epoch: 2 cost time: 3.9281702041625977
Epoch: 2, Steps: 7 | Train Loss: 1.369 Vali Loss: 3.477 Vali Acc: 0.194 Test Loss: 3.477 Test Acc: 0.194
Validation loss decreased (-0.124973 --> -0.194410).  Saving model ...
Epoch: 3 cost time: 4.504629135131836
Epoch: 3, Steps: 7 | Train Loss: 0.249 Vali Loss: 3.212 Vali Acc: 0.208 Test Loss: 3.212 Test Acc: 0.208
Validation loss decreased (-0.194410 --> -0.208301).  Saving model ...
Epoch: 4 cost time: 5.085626602172852
Epoch: 4, Steps: 7 | Train Loss: 0.105 Vali Loss: 4.354 Vali Acc: 0.306 Test Loss: 4.354 Test Acc: 0.306
Validation loss decreased (-0.208301 --> -0.305512).  Saving model ...
Epoch: 5 cost time: 3.8103151321411133
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.551 Vali Acc: 0.333 Test Loss: 3.551 Test Acc: 0.333
Validation loss decreased (-0.305512 --> -0.333298).  Saving model ...
Epoch: 6 cost time: 4.093398094177246
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 6.377 Vali Acc: 0.403 Test Loss: 6.377 Test Acc: 0.403
Validation loss decreased (-0.333298 --> -0.402714).  Saving model ...
Epoch: 7 cost time: 4.0458972454071045
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.673 Vali Acc: 0.333 Test Loss: 5.673 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.158900737762451
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 7.872 Vali Acc: 0.167 Test Loss: 7.872 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.924250841140747
Epoch: 9, Steps: 7 | Train Loss: 0.064 Vali Loss: 10.159 Vali Acc: 0.153 Test Loss: 10.159 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.260582208633423
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 7.981 Vali Acc: 0.181 Test Loss: 7.981 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.7024476528167725
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 5.468 Vali Acc: 0.278 Test Loss: 5.468 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.80059552192688
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 8.802 Vali Acc: 0.264 Test Loss: 8.802 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.097137212753296
Epoch: 13, Steps: 7 | Train Loss: 0.075 Vali Loss: 6.769 Vali Acc: 0.333 Test Loss: 6.769 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.76226806640625
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.054 Vali Acc: 0.375 Test Loss: 5.054 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8891093730926514
Epoch: 15, Steps: 7 | Train Loss: 0.311 Vali Loss: 7.144 Vali Acc: 0.417 Test Loss: 7.144 Test Acc: 0.417
Validation loss decreased (-0.402714 --> -0.416595).  Saving model ...
Epoch: 16 cost time: 4.94659161567688
Epoch: 16, Steps: 7 | Train Loss: 0.663 Vali Loss: 9.439 Vali Acc: 0.250 Test Loss: 9.439 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.554175615310669
Epoch: 17, Steps: 7 | Train Loss: 1.169 Vali Loss: 12.564 Vali Acc: 0.361 Test Loss: 12.564 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.997944355010986
Epoch: 18, Steps: 7 | Train Loss: 0.883 Vali Loss: 14.968 Vali Acc: 0.319 Test Loss: 14.968 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.168768405914307
Epoch: 19, Steps: 7 | Train Loss: 1.564 Vali Loss: 29.937 Vali Acc: 0.153 Test Loss: 29.937 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.010805130004883
Epoch: 20, Steps: 7 | Train Loss: 1.267 Vali Loss: 37.605 Vali Acc: 0.139 Test Loss: 37.605 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7701480388641357
Epoch: 21, Steps: 7 | Train Loss: 1.083 Vali Loss: 25.558 Vali Acc: 0.306 Test Loss: 25.558 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.385990858078003
Epoch: 22, Steps: 7 | Train Loss: 0.147 Vali Loss: 18.993 Vali Acc: 0.361 Test Loss: 18.993 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.1375086307525635
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 22.856 Vali Acc: 0.347 Test Loss: 22.856 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.444327354431152
Epoch: 24, Steps: 7 | Train Loss: 0.275 Vali Loss: 16.528 Vali Acc: 0.347 Test Loss: 16.528 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.048285961151123
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 31.709 Vali Acc: 0.222 Test Loss: 31.709 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.882514476776123
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.587 Vali Acc: 0.181 Test Loss: 2.587 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 3.5622434616088867
Epoch: 2, Steps: 7 | Train Loss: 1.717 Vali Loss: 3.398 Vali Acc: 0.167 Test Loss: 3.398 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4596424102783203
Epoch: 3, Steps: 7 | Train Loss: 0.629 Vali Loss: 5.790 Vali Acc: 0.125 Test Loss: 5.790 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.143370151519775
Epoch: 4, Steps: 7 | Train Loss: 0.199 Vali Loss: 5.045 Vali Acc: 0.250 Test Loss: 5.045 Test Acc: 0.250
Validation loss decreased (-0.180530 --> -0.249950).  Saving model ...
Epoch: 5 cost time: 4.19898796081543
Epoch: 5, Steps: 7 | Train Loss: 0.111 Vali Loss: 4.087 Vali Acc: 0.236 Test Loss: 4.087 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.197840452194214
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 9.823 Vali Acc: 0.097 Test Loss: 9.823 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.572035789489746
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 9.062 Vali Acc: 0.139 Test Loss: 9.062 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.995546579360962
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 6.537 Vali Acc: 0.181 Test Loss: 6.537 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.185830593109131
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.611 Vali Acc: 0.375 Test Loss: 4.611 Test Acc: 0.375
Validation loss decreased (-0.249950 --> -0.374954).  Saving model ...
Epoch: 10 cost time: 3.455000400543213
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 6.319 Vali Acc: 0.333 Test Loss: 6.319 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.15417218208313
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 6.189 Vali Acc: 0.306 Test Loss: 6.189 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.35772967338562
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 10.951 Vali Acc: 0.181 Test Loss: 10.951 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.268381595611572
Epoch: 13, Steps: 7 | Train Loss: 0.034 Vali Loss: 12.701 Vali Acc: 0.167 Test Loss: 12.701 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.569717645645142
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 13.396 Vali Acc: 0.139 Test Loss: 13.396 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.066831827163696
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 14.898 Vali Acc: 0.153 Test Loss: 14.898 Test Acc: 0.153
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.193778038024902
Epoch: 16, Steps: 7 | Train Loss: 0.130 Vali Loss: 26.542 Vali Acc: 0.097 Test Loss: 26.542 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.492659091949463
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 12.329 Vali Acc: 0.167 Test Loss: 12.329 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.970551013946533
Epoch: 18, Steps: 7 | Train Loss: 0.222 Vali Loss: 13.147 Vali Acc: 0.236 Test Loss: 13.147 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2698171138763428
Epoch: 19, Steps: 7 | Train Loss: 0.073 Vali Loss: 10.815 Vali Acc: 0.389 Test Loss: 10.815 Test Acc: 0.389
Validation loss decreased (-0.374954 --> -0.388781).  Saving model ...
Epoch: 20 cost time: 4.342409372329712
Epoch: 20, Steps: 7 | Train Loss: 0.207 Vali Loss: 11.235 Vali Acc: 0.403 Test Loss: 11.235 Test Acc: 0.403
Validation loss decreased (-0.388781 --> -0.402665).  Saving model ...
Epoch: 21 cost time: 4.394779682159424
Epoch: 21, Steps: 7 | Train Loss: 0.093 Vali Loss: 19.248 Vali Acc: 0.264 Test Loss: 19.248 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.01683783531189
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 18.844 Vali Acc: 0.208 Test Loss: 18.844 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.3887107372283936
Epoch: 23, Steps: 7 | Train Loss: 0.064 Vali Loss: 14.994 Vali Acc: 0.222 Test Loss: 14.994 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4724478721618652
Epoch: 24, Steps: 7 | Train Loss: 0.047 Vali Loss: 16.182 Vali Acc: 0.139 Test Loss: 16.182 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.339165925979614
Epoch: 25, Steps: 7 | Train Loss: 0.848 Vali Loss: 23.437 Vali Acc: 0.167 Test Loss: 23.437 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.9630613327026367
Epoch: 26, Steps: 7 | Train Loss: 0.133 Vali Loss: 19.038 Vali Acc: 0.194 Test Loss: 19.038 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.6373889446258545
Epoch: 27, Steps: 7 | Train Loss: 0.151 Vali Loss: 17.811 Vali Acc: 0.167 Test Loss: 17.811 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8773977756500244
Epoch: 28, Steps: 7 | Train Loss: 2.590 Vali Loss: 18.569 Vali Acc: 0.250 Test Loss: 18.569 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.286886930465698
Epoch: 29, Steps: 7 | Train Loss: 0.536 Vali Loss: 15.394 Vali Acc: 0.250 Test Loss: 15.394 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.422724962234497
Epoch: 30, Steps: 7 | Train Loss: 0.314 Vali Loss: 21.903 Vali Acc: 0.111 Test Loss: 21.903 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4027777777777778
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.972783327102661
Epoch: 1, Steps: 7 | Train Loss: 2.493 Vali Loss: 2.802 Vali Acc: 0.111 Test Loss: 2.802 Test Acc: 0.111
Validation loss decreased (inf --> -0.111083).  Saving model ...
Epoch: 2 cost time: 3.666938066482544
Epoch: 2, Steps: 7 | Train Loss: 1.617 Vali Loss: 3.938 Vali Acc: 0.111 Test Loss: 3.938 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.446176528930664
Epoch: 3, Steps: 7 | Train Loss: 0.476 Vali Loss: 3.857 Vali Acc: 0.181 Test Loss: 3.857 Test Acc: 0.181
Validation loss decreased (-0.111083 --> -0.180517).  Saving model ...
Epoch: 4 cost time: 4.1650614738464355
Epoch: 4, Steps: 7 | Train Loss: 0.108 Vali Loss: 6.573 Vali Acc: 0.222 Test Loss: 6.573 Test Acc: 0.222
Validation loss decreased (-0.180517 --> -0.222156).  Saving model ...
Epoch: 5 cost time: 4.696664810180664
Epoch: 5, Steps: 7 | Train Loss: 0.072 Vali Loss: 7.125 Vali Acc: 0.167 Test Loss: 7.125 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.285313844680786
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 6.064 Vali Acc: 0.153 Test Loss: 6.064 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.675503730773926
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 9.654 Vali Acc: 0.222 Test Loss: 9.654 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.616805076599121
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 7.229 Vali Acc: 0.208 Test Loss: 7.229 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.054664373397827
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 8.846 Vali Acc: 0.194 Test Loss: 8.846 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8268814086914062
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 9.406 Vali Acc: 0.139 Test Loss: 9.406 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5182063579559326
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.613 Vali Acc: 0.194 Test Loss: 9.613 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.117669582366943
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 9.085 Vali Acc: 0.250 Test Loss: 9.085 Test Acc: 0.250
Validation loss decreased (-0.222156 --> -0.249909).  Saving model ...
Epoch: 13 cost time: 4.0440452098846436
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 13.934 Vali Acc: 0.236 Test Loss: 13.934 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.662142276763916
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 11.393 Vali Acc: 0.194 Test Loss: 11.393 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8474488258361816
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 8.584 Vali Acc: 0.208 Test Loss: 8.584 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.094156265258789
Epoch: 16, Steps: 7 | Train Loss: 0.078 Vali Loss: 10.420 Vali Acc: 0.208 Test Loss: 10.420 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6374425888061523
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 14.632 Vali Acc: 0.097 Test Loss: 14.632 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.121991872787476
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 13.020 Vali Acc: 0.222 Test Loss: 13.020 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.6242380142211914
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 13.359 Vali Acc: 0.306 Test Loss: 13.359 Test Acc: 0.306
Validation loss decreased (-0.249909 --> -0.305422).  Saving model ...
Epoch: 20 cost time: 4.5072643756866455
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 14.172 Vali Acc: 0.278 Test Loss: 14.172 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.645432949066162
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 14.120 Vali Acc: 0.278 Test Loss: 14.120 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.0408244132995605
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 13.402 Vali Acc: 0.278 Test Loss: 13.402 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.925393581390381
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.948 Vali Acc: 0.264 Test Loss: 12.948 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5772695541381836
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.699 Vali Acc: 0.264 Test Loss: 12.699 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.863981246948242
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.517 Vali Acc: 0.264 Test Loss: 12.517 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.84181809425354
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.400 Vali Acc: 0.264 Test Loss: 12.400 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.203430652618408
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.314 Vali Acc: 0.264 Test Loss: 12.314 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.256552696228027
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.244 Vali Acc: 0.264 Test Loss: 12.244 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.422320127487183
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 12.193 Vali Acc: 0.264 Test Loss: 12.193 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3055555555555556
model parameter : 18660876
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.864411115646362
Epoch: 1, Steps: 7 | Train Loss: 2.284 Vali Loss: 1.487 Vali Acc: 0.486 Test Loss: 1.487 Test Acc: 0.486
Validation loss decreased (inf --> -0.486096).  Saving model ...
Epoch: 2 cost time: 8.105597972869873
Epoch: 2, Steps: 7 | Train Loss: 0.340 Vali Loss: 2.535 Vali Acc: 0.722 Test Loss: 2.535 Test Acc: 0.722
Validation loss decreased (-0.486096 --> -0.722197).  Saving model ...
Epoch: 3 cost time: 9.610356330871582
Epoch: 3, Steps: 7 | Train Loss: 0.031 Vali Loss: 2.375 Vali Acc: 0.806 Test Loss: 2.375 Test Acc: 0.806
Validation loss decreased (-0.722197 --> -0.805532).  Saving model ...
Epoch: 4 cost time: 9.140140056610107
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.784 Vali Acc: 0.792 Test Loss: 2.784 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.442404747009277
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.219 Vali Acc: 0.750 Test Loss: 4.219 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.571062564849854
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.780 Vali Acc: 0.778 Test Loss: 3.780 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.183046102523804
Epoch: 7, Steps: 7 | Train Loss: 0.407 Vali Loss: 3.940 Vali Acc: 0.792 Test Loss: 3.940 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.418519258499146
Epoch: 8, Steps: 7 | Train Loss: 0.140 Vali Loss: 6.362 Vali Acc: 0.681 Test Loss: 6.362 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.289290189743042
Epoch: 9, Steps: 7 | Train Loss: 0.172 Vali Loss: 4.197 Vali Acc: 0.806 Test Loss: 4.197 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.299197912216187
Epoch: 10, Steps: 7 | Train Loss: 0.285 Vali Loss: 4.908 Vali Acc: 0.806 Test Loss: 4.908 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.515784502029419
Epoch: 11, Steps: 7 | Train Loss: 0.574 Vali Loss: 5.088 Vali Acc: 0.750 Test Loss: 5.088 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.77887511253357
Epoch: 12, Steps: 7 | Train Loss: 0.140 Vali Loss: 8.644 Vali Acc: 0.653 Test Loss: 8.644 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.864111185073853
Epoch: 13, Steps: 7 | Train Loss: 0.200 Vali Loss: 6.085 Vali Acc: 0.750 Test Loss: 6.085 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8055555555555556
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.450339794158936
Epoch: 1, Steps: 7 | Train Loss: 2.347 Vali Loss: 1.589 Vali Acc: 0.431 Test Loss: 1.589 Test Acc: 0.431
Validation loss decreased (inf --> -0.430540).  Saving model ...
Epoch: 2 cost time: 6.298177003860474
Epoch: 2, Steps: 7 | Train Loss: 0.442 Vali Loss: 2.253 Vali Acc: 0.722 Test Loss: 2.253 Test Acc: 0.722
Validation loss decreased (-0.430540 --> -0.722200).  Saving model ...
Epoch: 3 cost time: 6.547477722167969
Epoch: 3, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.166 Vali Acc: 0.764 Test Loss: 2.166 Test Acc: 0.764
Validation loss decreased (-0.722200 --> -0.763867).  Saving model ...
Epoch: 4 cost time: 6.952552080154419
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.557 Vali Acc: 0.750 Test Loss: 2.557 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.475844860076904
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.476 Vali Acc: 0.722 Test Loss: 4.476 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.341198205947876
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.107 Vali Acc: 0.750 Test Loss: 3.107 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.36669921875
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 5.138 Vali Acc: 0.736 Test Loss: 5.138 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.080564022064209
Epoch: 8, Steps: 7 | Train Loss: 0.120 Vali Loss: 5.434 Vali Acc: 0.667 Test Loss: 5.434 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.62764573097229
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 6.534 Vali Acc: 0.708 Test Loss: 6.534 Test Acc: 0.708
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.811643600463867
Epoch: 10, Steps: 7 | Train Loss: 0.117 Vali Loss: 5.360 Vali Acc: 0.778 Test Loss: 5.360 Test Acc: 0.778
Validation loss decreased (-0.763867 --> -0.777724).  Saving model ...
Epoch: 11 cost time: 7.0898237228393555
Epoch: 11, Steps: 7 | Train Loss: 0.391 Vali Loss: 5.575 Vali Acc: 0.681 Test Loss: 5.575 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.785742521286011
Epoch: 12, Steps: 7 | Train Loss: 0.308 Vali Loss: 11.391 Vali Acc: 0.556 Test Loss: 11.391 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.243898153305054
Epoch: 13, Steps: 7 | Train Loss: 0.718 Vali Loss: 9.338 Vali Acc: 0.681 Test Loss: 9.338 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.422706842422485
Epoch: 14, Steps: 7 | Train Loss: 0.325 Vali Loss: 11.124 Vali Acc: 0.708 Test Loss: 11.124 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.343748092651367
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 13.295 Vali Acc: 0.681 Test Loss: 13.295 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.15876054763794
Epoch: 16, Steps: 7 | Train Loss: 0.443 Vali Loss: 13.940 Vali Acc: 0.667 Test Loss: 13.940 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.990389347076416
Epoch: 17, Steps: 7 | Train Loss: 0.320 Vali Loss: 13.579 Vali Acc: 0.653 Test Loss: 13.579 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.743978023529053
Epoch: 18, Steps: 7 | Train Loss: 0.141 Vali Loss: 15.091 Vali Acc: 0.694 Test Loss: 15.091 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.609535217285156
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 18.055 Vali Acc: 0.778 Test Loss: 18.055 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.716323852539062
Epoch: 20, Steps: 7 | Train Loss: 0.032 Vali Loss: 12.717 Vali Acc: 0.681 Test Loss: 12.717 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.565726518630981
Epoch: 1, Steps: 7 | Train Loss: 2.421 Vali Loss: 1.831 Vali Acc: 0.361 Test Loss: 1.831 Test Acc: 0.361
Validation loss decreased (inf --> -0.361093).  Saving model ...
Epoch: 2 cost time: 6.635540962219238
Epoch: 2, Steps: 7 | Train Loss: 0.674 Vali Loss: 2.001 Vali Acc: 0.653 Test Loss: 2.001 Test Acc: 0.653
Validation loss decreased (-0.361093 --> -0.652758).  Saving model ...
Epoch: 3 cost time: 6.907385587692261
Epoch: 3, Steps: 7 | Train Loss: 0.190 Vali Loss: 2.682 Vali Acc: 0.694 Test Loss: 2.682 Test Acc: 0.694
Validation loss decreased (-0.652758 --> -0.694418).  Saving model ...
Epoch: 4 cost time: 7.705050706863403
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 3.551 Vali Acc: 0.528 Test Loss: 3.551 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.680011034011841
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.631 Vali Acc: 0.694 Test Loss: 2.631 Test Acc: 0.694
Validation loss decreased (-0.694418 --> -0.694418).  Saving model ...
Epoch: 6 cost time: 7.087697744369507
Epoch: 6, Steps: 7 | Train Loss: 0.056 Vali Loss: 3.524 Vali Acc: 0.694 Test Loss: 3.524 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.523031711578369
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 2.686 Vali Acc: 0.736 Test Loss: 2.686 Test Acc: 0.736
Validation loss decreased (-0.694418 --> -0.736084).  Saving model ...
Epoch: 8 cost time: 6.410374879837036
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 2.560 Vali Acc: 0.708 Test Loss: 2.560 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.566112756729126
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 7.686 Vali Acc: 0.528 Test Loss: 7.686 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.4794933795928955
Epoch: 10, Steps: 7 | Train Loss: 0.266 Vali Loss: 7.848 Vali Acc: 0.528 Test Loss: 7.848 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.869447708129883
Epoch: 11, Steps: 7 | Train Loss: 0.319 Vali Loss: 11.937 Vali Acc: 0.514 Test Loss: 11.937 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.246216535568237
Epoch: 12, Steps: 7 | Train Loss: 0.570 Vali Loss: 9.681 Vali Acc: 0.569 Test Loss: 9.681 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.6971049308776855
Epoch: 13, Steps: 7 | Train Loss: 0.420 Vali Loss: 11.157 Vali Acc: 0.556 Test Loss: 11.157 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.20954704284668
Epoch: 14, Steps: 7 | Train Loss: 0.230 Vali Loss: 9.084 Vali Acc: 0.597 Test Loss: 9.084 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.7052693367004395
Epoch: 15, Steps: 7 | Train Loss: 0.231 Vali Loss: 11.720 Vali Acc: 0.583 Test Loss: 11.720 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.364335298538208
Epoch: 16, Steps: 7 | Train Loss: 0.320 Vali Loss: 9.023 Vali Acc: 0.611 Test Loss: 9.023 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.409403562545776
Epoch: 17, Steps: 7 | Train Loss: 0.420 Vali Loss: 7.355 Vali Acc: 0.611 Test Loss: 7.355 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7361111111111112
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.260752439498901
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.326 Vali Acc: 0.278 Test Loss: 2.326 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 5.325106859207153
Epoch: 2, Steps: 7 | Train Loss: 0.868 Vali Loss: 2.683 Vali Acc: 0.542 Test Loss: 2.683 Test Acc: 0.542
Validation loss decreased (-0.277755 --> -0.541640).  Saving model ...
Epoch: 3 cost time: 5.023640155792236
Epoch: 3, Steps: 7 | Train Loss: 0.264 Vali Loss: 3.326 Vali Acc: 0.500 Test Loss: 3.326 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.533164978027344
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 5.187 Vali Acc: 0.500 Test Loss: 5.187 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.802941560745239
Epoch: 5, Steps: 7 | Train Loss: 0.056 Vali Loss: 5.726 Vali Acc: 0.472 Test Loss: 5.726 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.110491991043091
Epoch: 6, Steps: 7 | Train Loss: 0.244 Vali Loss: 7.290 Vali Acc: 0.556 Test Loss: 7.290 Test Acc: 0.556
Validation loss decreased (-0.541640 --> -0.555483).  Saving model ...
Epoch: 7 cost time: 5.529001235961914
Epoch: 7, Steps: 7 | Train Loss: 0.132 Vali Loss: 6.400 Vali Acc: 0.556 Test Loss: 6.400 Test Acc: 0.556
Validation loss decreased (-0.555483 --> -0.555492).  Saving model ...
Epoch: 8 cost time: 5.970865488052368
Epoch: 8, Steps: 7 | Train Loss: 0.272 Vali Loss: 11.472 Vali Acc: 0.375 Test Loss: 11.472 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.984727144241333
Epoch: 9, Steps: 7 | Train Loss: 0.272 Vali Loss: 6.930 Vali Acc: 0.528 Test Loss: 6.930 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.5433619022369385
Epoch: 10, Steps: 7 | Train Loss: 0.027 Vali Loss: 4.356 Vali Acc: 0.625 Test Loss: 4.356 Test Acc: 0.625
Validation loss decreased (-0.555492 --> -0.624956).  Saving model ...
Epoch: 11 cost time: 5.126692533493042
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.615 Vali Acc: 0.542 Test Loss: 6.615 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.521756172180176
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.402 Vali Acc: 0.569 Test Loss: 6.402 Test Acc: 0.569
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.580278396606445
Epoch: 13, Steps: 7 | Train Loss: 0.079 Vali Loss: 5.722 Vali Acc: 0.583 Test Loss: 5.722 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.302558898925781
Epoch: 14, Steps: 7 | Train Loss: 0.273 Vali Loss: 8.189 Vali Acc: 0.583 Test Loss: 8.189 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.920531749725342
Epoch: 15, Steps: 7 | Train Loss: 0.182 Vali Loss: 11.186 Vali Acc: 0.514 Test Loss: 11.186 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.0995306968688965
Epoch: 16, Steps: 7 | Train Loss: 0.183 Vali Loss: 11.767 Vali Acc: 0.569 Test Loss: 11.767 Test Acc: 0.569
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.523732423782349
Epoch: 17, Steps: 7 | Train Loss: 0.337 Vali Loss: 19.116 Vali Acc: 0.556 Test Loss: 19.116 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.829678773880005
Epoch: 18, Steps: 7 | Train Loss: 1.450 Vali Loss: 9.848 Vali Acc: 0.556 Test Loss: 9.848 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.372493028640747
Epoch: 19, Steps: 7 | Train Loss: 0.757 Vali Loss: 17.118 Vali Acc: 0.472 Test Loss: 17.118 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.253968000411987
Epoch: 20, Steps: 7 | Train Loss: 0.758 Vali Loss: 24.034 Vali Acc: 0.528 Test Loss: 24.034 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.625
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.058973073959351
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.640 Vali Acc: 0.236 Test Loss: 2.640 Test Acc: 0.236
Validation loss decreased (inf --> -0.236085).  Saving model ...
Epoch: 2 cost time: 4.602111339569092
Epoch: 2, Steps: 7 | Train Loss: 1.031 Vali Loss: 3.838 Vali Acc: 0.250 Test Loss: 3.838 Test Acc: 0.250
Validation loss decreased (-0.236085 --> -0.249962).  Saving model ...
Epoch: 3 cost time: 4.101096868515015
Epoch: 3, Steps: 7 | Train Loss: 0.213 Vali Loss: 3.815 Vali Acc: 0.403 Test Loss: 3.815 Test Acc: 0.403
Validation loss decreased (-0.249962 --> -0.402740).  Saving model ...
Epoch: 4 cost time: 3.9768433570861816
Epoch: 4, Steps: 7 | Train Loss: 0.062 Vali Loss: 5.781 Vali Acc: 0.375 Test Loss: 5.781 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.8921990394592285
Epoch: 5, Steps: 7 | Train Loss: 0.156 Vali Loss: 7.466 Vali Acc: 0.361 Test Loss: 7.466 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.773589134216309
Epoch: 6, Steps: 7 | Train Loss: 0.220 Vali Loss: 8.830 Vali Acc: 0.264 Test Loss: 8.830 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.959522485733032
Epoch: 7, Steps: 7 | Train Loss: 0.291 Vali Loss: 10.523 Vali Acc: 0.347 Test Loss: 10.523 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.411686897277832
Epoch: 8, Steps: 7 | Train Loss: 0.044 Vali Loss: 7.253 Vali Acc: 0.431 Test Loss: 7.253 Test Acc: 0.431
Validation loss decreased (-0.402740 --> -0.430483).  Saving model ...
Epoch: 9 cost time: 4.773656129837036
Epoch: 9, Steps: 7 | Train Loss: 0.106 Vali Loss: 8.468 Vali Acc: 0.444 Test Loss: 8.468 Test Acc: 0.444
Validation loss decreased (-0.430483 --> -0.444360).  Saving model ...
Epoch: 10 cost time: 4.236060380935669
Epoch: 10, Steps: 7 | Train Loss: 0.178 Vali Loss: 8.531 Vali Acc: 0.417 Test Loss: 8.531 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.922449111938477
Epoch: 11, Steps: 7 | Train Loss: 0.132 Vali Loss: 11.064 Vali Acc: 0.375 Test Loss: 11.064 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.985531568527222
Epoch: 12, Steps: 7 | Train Loss: 0.269 Vali Loss: 19.519 Vali Acc: 0.278 Test Loss: 19.519 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.978960037231445
Epoch: 13, Steps: 7 | Train Loss: 0.683 Vali Loss: 16.025 Vali Acc: 0.333 Test Loss: 16.025 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.551171541213989
Epoch: 14, Steps: 7 | Train Loss: 0.911 Vali Loss: 15.307 Vali Acc: 0.458 Test Loss: 15.307 Test Acc: 0.458
Validation loss decreased (-0.444360 --> -0.458180).  Saving model ...
Epoch: 15 cost time: 5.87199068069458
Epoch: 15, Steps: 7 | Train Loss: 0.610 Vali Loss: 24.131 Vali Acc: 0.319 Test Loss: 24.131 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.497394323348999
Epoch: 16, Steps: 7 | Train Loss: 0.512 Vali Loss: 18.087 Vali Acc: 0.361 Test Loss: 18.087 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.490775108337402
Epoch: 17, Steps: 7 | Train Loss: 0.024 Vali Loss: 15.960 Vali Acc: 0.444 Test Loss: 15.960 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.717579126358032
Epoch: 18, Steps: 7 | Train Loss: 0.037 Vali Loss: 17.514 Vali Acc: 0.431 Test Loss: 17.514 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.069960355758667
Epoch: 19, Steps: 7 | Train Loss: 0.030 Vali Loss: 24.000 Vali Acc: 0.403 Test Loss: 24.000 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.778852939605713
Epoch: 20, Steps: 7 | Train Loss: 0.208 Vali Loss: 19.700 Vali Acc: 0.431 Test Loss: 19.700 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.532533645629883
Epoch: 21, Steps: 7 | Train Loss: 0.542 Vali Loss: 24.011 Vali Acc: 0.319 Test Loss: 24.011 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.1543214321136475
Epoch: 22, Steps: 7 | Train Loss: 0.516 Vali Loss: 25.257 Vali Acc: 0.458 Test Loss: 25.257 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.4972639083862305
Epoch: 23, Steps: 7 | Train Loss: 0.149 Vali Loss: 27.367 Vali Acc: 0.444 Test Loss: 27.367 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.800980091094971
Epoch: 24, Steps: 7 | Train Loss: 0.056 Vali Loss: 25.983 Vali Acc: 0.431 Test Loss: 25.983 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.674623012542725
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.634 Vali Acc: 0.125 Test Loss: 2.634 Test Acc: 0.125
Validation loss decreased (inf --> -0.124974).  Saving model ...
Epoch: 2 cost time: 4.816395282745361
Epoch: 2, Steps: 7 | Train Loss: 1.166 Vali Loss: 3.677 Vali Acc: 0.264 Test Loss: 3.677 Test Acc: 0.264
Validation loss decreased (-0.124974 --> -0.263852).  Saving model ...
Epoch: 3 cost time: 4.970164060592651
Epoch: 3, Steps: 7 | Train Loss: 0.229 Vali Loss: 4.941 Vali Acc: 0.236 Test Loss: 4.941 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8571841716766357
Epoch: 4, Steps: 7 | Train Loss: 0.071 Vali Loss: 5.325 Vali Acc: 0.236 Test Loss: 5.325 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.095624923706055
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 6.258 Vali Acc: 0.264 Test Loss: 6.258 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.08821964263916
Epoch: 6, Steps: 7 | Train Loss: 0.157 Vali Loss: 6.048 Vali Acc: 0.292 Test Loss: 6.048 Test Acc: 0.292
Validation loss decreased (-0.263852 --> -0.291606).  Saving model ...
Epoch: 7 cost time: 4.381084442138672
Epoch: 7, Steps: 7 | Train Loss: 0.136 Vali Loss: 6.790 Vali Acc: 0.389 Test Loss: 6.790 Test Acc: 0.389
Validation loss decreased (-0.291606 --> -0.388821).  Saving model ...
Epoch: 8 cost time: 4.593674898147583
Epoch: 8, Steps: 7 | Train Loss: 0.291 Vali Loss: 8.840 Vali Acc: 0.361 Test Loss: 8.840 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.850771188735962
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 8.775 Vali Acc: 0.361 Test Loss: 8.775 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.061886548995972
Epoch: 10, Steps: 7 | Train Loss: 0.161 Vali Loss: 8.594 Vali Acc: 0.361 Test Loss: 8.594 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.280825853347778
Epoch: 11, Steps: 7 | Train Loss: 0.067 Vali Loss: 8.933 Vali Acc: 0.375 Test Loss: 8.933 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.076006889343262
Epoch: 12, Steps: 7 | Train Loss: 0.336 Vali Loss: 11.461 Vali Acc: 0.361 Test Loss: 11.461 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.921860456466675
Epoch: 13, Steps: 7 | Train Loss: 0.246 Vali Loss: 14.348 Vali Acc: 0.264 Test Loss: 14.348 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.165854454040527
Epoch: 14, Steps: 7 | Train Loss: 0.733 Vali Loss: 14.816 Vali Acc: 0.375 Test Loss: 14.816 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.477006673812866
Epoch: 15, Steps: 7 | Train Loss: 0.045 Vali Loss: 17.767 Vali Acc: 0.208 Test Loss: 17.767 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.024648189544678
Epoch: 16, Steps: 7 | Train Loss: 0.146 Vali Loss: 14.659 Vali Acc: 0.431 Test Loss: 14.659 Test Acc: 0.431
Validation loss decreased (-0.388821 --> -0.430409).  Saving model ...
Epoch: 17 cost time: 4.741998195648193
Epoch: 17, Steps: 7 | Train Loss: 0.449 Vali Loss: 15.892 Vali Acc: 0.361 Test Loss: 15.892 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.211625814437866
Epoch: 18, Steps: 7 | Train Loss: 0.222 Vali Loss: 13.430 Vali Acc: 0.472 Test Loss: 13.430 Test Acc: 0.472
Validation loss decreased (-0.430409 --> -0.472088).  Saving model ...
Epoch: 19 cost time: 4.249749422073364
Epoch: 19, Steps: 7 | Train Loss: 0.065 Vali Loss: 13.383 Vali Acc: 0.431 Test Loss: 13.383 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.763629674911499
Epoch: 20, Steps: 7 | Train Loss: 0.225 Vali Loss: 14.020 Vali Acc: 0.403 Test Loss: 14.020 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9506633281707764
Epoch: 21, Steps: 7 | Train Loss: 0.424 Vali Loss: 17.255 Vali Acc: 0.417 Test Loss: 17.255 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.124503135681152
Epoch: 22, Steps: 7 | Train Loss: 0.621 Vali Loss: 16.202 Vali Acc: 0.444 Test Loss: 16.202 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.504186391830444
Epoch: 23, Steps: 7 | Train Loss: 0.098 Vali Loss: 19.338 Vali Acc: 0.458 Test Loss: 19.338 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.8975934982299805
Epoch: 24, Steps: 7 | Train Loss: 0.191 Vali Loss: 16.626 Vali Acc: 0.569 Test Loss: 16.626 Test Acc: 0.569
Validation loss decreased (-0.472088 --> -0.569278).  Saving model ...
Epoch: 25 cost time: 4.434054374694824
Epoch: 25, Steps: 7 | Train Loss: 0.335 Vali Loss: 20.705 Vali Acc: 0.458 Test Loss: 20.705 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.076029539108276
Epoch: 26, Steps: 7 | Train Loss: 0.788 Vali Loss: 18.657 Vali Acc: 0.542 Test Loss: 18.657 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.513165235519409
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 16.446 Vali Acc: 0.528 Test Loss: 16.446 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.018073320388794
Epoch: 28, Steps: 7 | Train Loss: 0.699 Vali Loss: 16.487 Vali Acc: 0.528 Test Loss: 16.487 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.17391037940979
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 28.927 Vali Acc: 0.347 Test Loss: 28.927 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.924335956573486
Epoch: 30, Steps: 7 | Train Loss: 0.243 Vali Loss: 19.342 Vali Acc: 0.444 Test Loss: 19.342 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.30785346031189
Epoch: 31, Steps: 7 | Train Loss: 0.129 Vali Loss: 32.325 Vali Acc: 0.319 Test Loss: 32.325 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.956160306930542
Epoch: 32, Steps: 7 | Train Loss: 0.519 Vali Loss: 26.339 Vali Acc: 0.306 Test Loss: 26.339 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.460249185562134
Epoch: 33, Steps: 7 | Train Loss: 0.060 Vali Loss: 22.613 Vali Acc: 0.458 Test Loss: 22.613 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.908498525619507
Epoch: 34, Steps: 7 | Train Loss: 0.067 Vali Loss: 26.438 Vali Acc: 0.472 Test Loss: 26.438 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5694444444444444
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.249931812286377
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.572 Vali Acc: 0.167 Test Loss: 2.572 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 4.784038782119751
Epoch: 2, Steps: 7 | Train Loss: 1.303 Vali Loss: 3.198 Vali Acc: 0.250 Test Loss: 3.198 Test Acc: 0.250
Validation loss decreased (-0.166641 --> -0.249968).  Saving model ...
Epoch: 3 cost time: 4.509368419647217
Epoch: 3, Steps: 7 | Train Loss: 0.234 Vali Loss: 3.914 Vali Acc: 0.264 Test Loss: 3.914 Test Acc: 0.264
Validation loss decreased (-0.249968 --> -0.263850).  Saving model ...
Epoch: 4 cost time: 3.8318660259246826
Epoch: 4, Steps: 7 | Train Loss: 0.079 Vali Loss: 4.538 Vali Acc: 0.278 Test Loss: 4.538 Test Acc: 0.278
Validation loss decreased (-0.263850 --> -0.277732).  Saving model ...
Epoch: 5 cost time: 3.7506141662597656
Epoch: 5, Steps: 7 | Train Loss: 0.123 Vali Loss: 5.889 Vali Acc: 0.167 Test Loss: 5.889 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.037062406539917
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 6.954 Vali Acc: 0.250 Test Loss: 6.954 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.560868263244629
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 5.856 Vali Acc: 0.375 Test Loss: 5.856 Test Acc: 0.375
Validation loss decreased (-0.277732 --> -0.374941).  Saving model ...
Epoch: 8 cost time: 5.135119438171387
Epoch: 8, Steps: 7 | Train Loss: 0.152 Vali Loss: 4.871 Vali Acc: 0.431 Test Loss: 4.871 Test Acc: 0.431
Validation loss decreased (-0.374941 --> -0.430507).  Saving model ...
Epoch: 9 cost time: 4.245433568954468
Epoch: 9, Steps: 7 | Train Loss: 0.162 Vali Loss: 5.397 Vali Acc: 0.486 Test Loss: 5.397 Test Acc: 0.486
Validation loss decreased (-0.430507 --> -0.486057).  Saving model ...
Epoch: 10 cost time: 3.9287149906158447
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 6.263 Vali Acc: 0.375 Test Loss: 6.263 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.704014301300049
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 6.569 Vali Acc: 0.486 Test Loss: 6.569 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.135175943374634
Epoch: 12, Steps: 7 | Train Loss: 0.251 Vali Loss: 6.663 Vali Acc: 0.444 Test Loss: 6.663 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4224679470062256
Epoch: 13, Steps: 7 | Train Loss: 0.071 Vali Loss: 13.919 Vali Acc: 0.250 Test Loss: 13.919 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8392493724823
Epoch: 14, Steps: 7 | Train Loss: 0.706 Vali Loss: 13.019 Vali Acc: 0.417 Test Loss: 13.019 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.523373126983643
Epoch: 15, Steps: 7 | Train Loss: 0.486 Vali Loss: 11.515 Vali Acc: 0.403 Test Loss: 11.515 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.573047161102295
Epoch: 16, Steps: 7 | Train Loss: 0.446 Vali Loss: 15.551 Vali Acc: 0.278 Test Loss: 15.551 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.2347657680511475
Epoch: 17, Steps: 7 | Train Loss: 0.481 Vali Loss: 19.027 Vali Acc: 0.264 Test Loss: 19.027 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.598035573959351
Epoch: 18, Steps: 7 | Train Loss: 0.045 Vali Loss: 14.610 Vali Acc: 0.472 Test Loss: 14.610 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.115405321121216
Epoch: 19, Steps: 7 | Train Loss: 0.082 Vali Loss: 25.942 Vali Acc: 0.167 Test Loss: 25.942 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.180984258651733
Epoch: 1, Steps: 7 | Train Loss: 2.574 Vali Loss: 2.663 Vali Acc: 0.097 Test Loss: 2.663 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 4.60689902305603
Epoch: 2, Steps: 7 | Train Loss: 1.385 Vali Loss: 3.358 Vali Acc: 0.222 Test Loss: 3.358 Test Acc: 0.222
Validation loss decreased (-0.097196 --> -0.222189).  Saving model ...
Epoch: 3 cost time: 4.327476263046265
Epoch: 3, Steps: 7 | Train Loss: 0.260 Vali Loss: 3.602 Vali Acc: 0.306 Test Loss: 3.602 Test Acc: 0.306
Validation loss decreased (-0.222189 --> -0.305520).  Saving model ...
Epoch: 4 cost time: 4.2351579666137695
Epoch: 4, Steps: 7 | Train Loss: 0.035 Vali Loss: 4.941 Vali Acc: 0.236 Test Loss: 4.941 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.001863241195679
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 6.297 Vali Acc: 0.097 Test Loss: 6.297 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.72112774848938
Epoch: 6, Steps: 7 | Train Loss: 0.144 Vali Loss: 6.375 Vali Acc: 0.278 Test Loss: 6.375 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.162435054779053
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 7.134 Vali Acc: 0.431 Test Loss: 7.134 Test Acc: 0.431
Validation loss decreased (-0.305520 --> -0.430484).  Saving model ...
Epoch: 8 cost time: 3.7187016010284424
Epoch: 8, Steps: 7 | Train Loss: 0.185 Vali Loss: 7.294 Vali Acc: 0.347 Test Loss: 7.294 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.5975565910339355
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 9.306 Vali Acc: 0.292 Test Loss: 9.306 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7800076007843018
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 6.825 Vali Acc: 0.444 Test Loss: 6.825 Test Acc: 0.444
Validation loss decreased (-0.430484 --> -0.444376).  Saving model ...
Epoch: 11 cost time: 4.323222875595093
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 9.471 Vali Acc: 0.292 Test Loss: 9.471 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.117864370346069
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 8.762 Vali Acc: 0.347 Test Loss: 8.762 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.58769154548645
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.462 Vali Acc: 0.375 Test Loss: 9.462 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.600861072540283
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.099 Vali Acc: 0.361 Test Loss: 10.099 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5978777408599854
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.542 Vali Acc: 0.347 Test Loss: 10.542 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.615842819213867
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.701 Vali Acc: 0.333 Test Loss: 10.701 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.43314003944397
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.688 Vali Acc: 0.347 Test Loss: 10.688 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.095525026321411
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.533 Vali Acc: 0.347 Test Loss: 10.533 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.378080368041992
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.147 Vali Acc: 0.347 Test Loss: 10.147 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.101020336151123
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.933 Vali Acc: 0.347 Test Loss: 9.933 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.5793750286102295
Epoch: 1, Steps: 7 | Train Loss: 2.542 Vali Loss: 2.535 Vali Acc: 0.167 Test Loss: 2.535 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 4.505701780319214
Epoch: 2, Steps: 7 | Train Loss: 1.711 Vali Loss: 3.943 Vali Acc: 0.083 Test Loss: 3.943 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9037837982177734
Epoch: 3, Steps: 7 | Train Loss: 0.595 Vali Loss: 3.553 Vali Acc: 0.264 Test Loss: 3.553 Test Acc: 0.264
Validation loss decreased (-0.166641 --> -0.263853).  Saving model ...
Epoch: 4 cost time: 4.499475717544556
Epoch: 4, Steps: 7 | Train Loss: 0.118 Vali Loss: 5.034 Vali Acc: 0.125 Test Loss: 5.034 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7231369018554688
Epoch: 5, Steps: 7 | Train Loss: 0.078 Vali Loss: 5.825 Vali Acc: 0.139 Test Loss: 5.825 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8642828464508057
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 7.615 Vali Acc: 0.236 Test Loss: 7.615 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2498674392700195
Epoch: 7, Steps: 7 | Train Loss: 0.068 Vali Loss: 5.852 Vali Acc: 0.278 Test Loss: 5.852 Test Acc: 0.278
Validation loss decreased (-0.263853 --> -0.277719).  Saving model ...
Epoch: 8 cost time: 3.5242152214050293
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 7.363 Vali Acc: 0.264 Test Loss: 7.363 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0025393962860107
Epoch: 9, Steps: 7 | Train Loss: 0.037 Vali Loss: 6.255 Vali Acc: 0.264 Test Loss: 6.255 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.230570077896118
Epoch: 10, Steps: 7 | Train Loss: 0.074 Vali Loss: 6.599 Vali Acc: 0.278 Test Loss: 6.599 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.907790184020996
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 9.718 Vali Acc: 0.236 Test Loss: 9.718 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.707115411758423
Epoch: 12, Steps: 7 | Train Loss: 0.260 Vali Loss: 6.580 Vali Acc: 0.278 Test Loss: 6.580 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7063021659851074
Epoch: 13, Steps: 7 | Train Loss: 0.077 Vali Loss: 9.024 Vali Acc: 0.264 Test Loss: 9.024 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.108136177062988
Epoch: 14, Steps: 7 | Train Loss: 0.161 Vali Loss: 12.433 Vali Acc: 0.222 Test Loss: 12.433 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3097190856933594
Epoch: 15, Steps: 7 | Train Loss: 0.043 Vali Loss: 10.653 Vali Acc: 0.278 Test Loss: 10.653 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.868443012237549
Epoch: 16, Steps: 7 | Train Loss: 0.070 Vali Loss: 7.369 Vali Acc: 0.375 Test Loss: 7.369 Test Acc: 0.375
Validation loss decreased (-0.277719 --> -0.374926).  Saving model ...
Epoch: 17 cost time: 3.34011173248291
Epoch: 17, Steps: 7 | Train Loss: 0.022 Vali Loss: 9.693 Vali Acc: 0.306 Test Loss: 9.693 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.390358924865723
Epoch: 18, Steps: 7 | Train Loss: 0.165 Vali Loss: 11.813 Vali Acc: 0.319 Test Loss: 11.813 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.696978807449341
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 15.676 Vali Acc: 0.250 Test Loss: 15.676 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.326193571090698
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 15.989 Vali Acc: 0.278 Test Loss: 15.989 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.931541681289673
Epoch: 21, Steps: 7 | Train Loss: 0.317 Vali Loss: 18.235 Vali Acc: 0.181 Test Loss: 18.235 Test Acc: 0.181
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.9482054710388184
Epoch: 22, Steps: 7 | Train Loss: 0.422 Vali Loss: 22.636 Vali Acc: 0.208 Test Loss: 22.636 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.40053129196167
Epoch: 23, Steps: 7 | Train Loss: 0.233 Vali Loss: 19.648 Vali Acc: 0.264 Test Loss: 19.648 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6220459938049316
Epoch: 24, Steps: 7 | Train Loss: 0.144 Vali Loss: 16.191 Vali Acc: 0.264 Test Loss: 16.191 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2457644939422607
Epoch: 25, Steps: 7 | Train Loss: 0.212 Vali Loss: 15.208 Vali Acc: 0.319 Test Loss: 15.208 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.290578842163086
Epoch: 26, Steps: 7 | Train Loss: 0.194 Vali Loss: 15.179 Vali Acc: 0.333 Test Loss: 15.179 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.375
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.703427076339722
Epoch: 1, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.666 Vali Acc: 0.208 Test Loss: 2.666 Test Acc: 0.208
Validation loss decreased (inf --> -0.208307).  Saving model ...
Epoch: 2 cost time: 3.868170738220215
Epoch: 2, Steps: 7 | Train Loss: 1.569 Vali Loss: 3.786 Vali Acc: 0.167 Test Loss: 3.786 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9470980167388916
Epoch: 3, Steps: 7 | Train Loss: 0.592 Vali Loss: 4.654 Vali Acc: 0.222 Test Loss: 4.654 Test Acc: 0.222
Validation loss decreased (-0.208307 --> -0.222176).  Saving model ...
Epoch: 4 cost time: 3.476470470428467
Epoch: 4, Steps: 7 | Train Loss: 0.153 Vali Loss: 6.073 Vali Acc: 0.222 Test Loss: 6.073 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7946345806121826
Epoch: 5, Steps: 7 | Train Loss: 0.072 Vali Loss: 6.294 Vali Acc: 0.222 Test Loss: 6.294 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.122356176376343
Epoch: 6, Steps: 7 | Train Loss: 0.052 Vali Loss: 7.640 Vali Acc: 0.222 Test Loss: 7.640 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.117125988006592
Epoch: 7, Steps: 7 | Train Loss: 0.035 Vali Loss: 8.086 Vali Acc: 0.222 Test Loss: 8.086 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.5684990882873535
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 9.370 Vali Acc: 0.306 Test Loss: 9.370 Test Acc: 0.306
Validation loss decreased (-0.222176 --> -0.305462).  Saving model ...
Epoch: 9 cost time: 4.059725999832153
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 8.545 Vali Acc: 0.236 Test Loss: 8.545 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9791016578674316
Epoch: 10, Steps: 7 | Train Loss: 0.141 Vali Loss: 11.978 Vali Acc: 0.278 Test Loss: 11.978 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.701348066329956
Epoch: 11, Steps: 7 | Train Loss: 0.087 Vali Loss: 9.615 Vali Acc: 0.153 Test Loss: 9.615 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.913956642150879
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 13.047 Vali Acc: 0.181 Test Loss: 13.047 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.7279715538024902
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 12.730 Vali Acc: 0.208 Test Loss: 12.730 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.2871270179748535
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 15.402 Vali Acc: 0.250 Test Loss: 15.402 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.148973226547241
Epoch: 15, Steps: 7 | Train Loss: 0.051 Vali Loss: 17.151 Vali Acc: 0.194 Test Loss: 17.151 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.1180641651153564
Epoch: 16, Steps: 7 | Train Loss: 0.042 Vali Loss: 21.543 Vali Acc: 0.194 Test Loss: 21.543 Test Acc: 0.194
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.578672170639038
Epoch: 17, Steps: 7 | Train Loss: 0.061 Vali Loss: 19.153 Vali Acc: 0.264 Test Loss: 19.153 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.6495425701141357
Epoch: 18, Steps: 7 | Train Loss: 0.052 Vali Loss: 18.260 Vali Acc: 0.194 Test Loss: 18.260 Test Acc: 0.194
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3055555555555556
model parameter : 18267660
model size : 89.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.027799367904663
Epoch: 1, Steps: 7 | Train Loss: 2.518 Vali Loss: 1.624 Vali Acc: 0.542 Test Loss: 1.624 Test Acc: 0.542
Validation loss decreased (inf --> -0.541650).  Saving model ...
Epoch: 2 cost time: 5.919567346572876
Epoch: 2, Steps: 7 | Train Loss: 0.604 Vali Loss: 1.049 Vali Acc: 0.736 Test Loss: 1.049 Test Acc: 0.736
Validation loss decreased (-0.541650 --> -0.736101).  Saving model ...
Epoch: 3 cost time: 5.094563007354736
Epoch: 3, Steps: 7 | Train Loss: 0.052 Vali Loss: 1.423 Vali Acc: 0.833 Test Loss: 1.423 Test Acc: 0.833
Validation loss decreased (-0.736101 --> -0.833319).  Saving model ...
Epoch: 4 cost time: 6.059525966644287
Epoch: 4, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.846 Vali Acc: 0.736 Test Loss: 1.846 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.18886137008667
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.196 Vali Acc: 0.708 Test Loss: 3.196 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.139039754867554
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.974 Vali Acc: 0.694 Test Loss: 2.974 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.898983716964722
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.943 Vali Acc: 0.764 Test Loss: 2.943 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.809512376785278
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.959 Vali Acc: 0.708 Test Loss: 2.959 Test Acc: 0.708
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.06130576133728
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.771 Vali Acc: 0.750 Test Loss: 2.771 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.332095384597778
Epoch: 10, Steps: 7 | Train Loss: 0.063 Vali Loss: 2.694 Vali Acc: 0.819 Test Loss: 2.694 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.260227203369141
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.828 Vali Acc: 0.833 Test Loss: 2.828 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.681715726852417
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.912 Vali Acc: 0.819 Test Loss: 2.912 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.366391181945801
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.820 Vali Acc: 0.819 Test Loss: 2.820 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8333333333333334
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.043909549713135
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 1.811 Vali Acc: 0.444 Test Loss: 1.811 Test Acc: 0.444
Validation loss decreased (inf --> -0.444426).  Saving model ...
Epoch: 2 cost time: 4.507348537445068
Epoch: 2, Steps: 7 | Train Loss: 0.780 Vali Loss: 1.139 Vali Acc: 0.722 Test Loss: 1.139 Test Acc: 0.722
Validation loss decreased (-0.444426 --> -0.722211).  Saving model ...
Epoch: 3 cost time: 4.506646633148193
Epoch: 3, Steps: 7 | Train Loss: 0.044 Vali Loss: 1.245 Vali Acc: 0.792 Test Loss: 1.245 Test Acc: 0.792
Validation loss decreased (-0.722211 --> -0.791654).  Saving model ...
Epoch: 4 cost time: 3.9109182357788086
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.902 Vali Acc: 0.722 Test Loss: 1.902 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.156530857086182
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.279 Vali Acc: 0.722 Test Loss: 2.279 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.686557292938232
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.135 Vali Acc: 0.736 Test Loss: 2.135 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.788231372833252
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.102 Vali Acc: 0.792 Test Loss: 2.102 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.034701824188232
Epoch: 8, Steps: 7 | Train Loss: 0.071 Vali Loss: 2.129 Vali Acc: 0.722 Test Loss: 2.129 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.593254804611206
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.786 Vali Acc: 0.653 Test Loss: 2.786 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.221236944198608
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.305 Vali Acc: 0.722 Test Loss: 2.305 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.456556797027588
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.344 Vali Acc: 0.722 Test Loss: 2.344 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.3403425216674805
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.722 Test Loss: 2.386 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.563330411911011
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.379 Vali Acc: 0.750 Test Loss: 2.379 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7916666666666666
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.7981390953063965
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.018 Vali Acc: 0.333 Test Loss: 2.018 Test Acc: 0.333
Validation loss decreased (inf --> -0.333313).  Saving model ...
Epoch: 2 cost time: 3.515740156173706
Epoch: 2, Steps: 7 | Train Loss: 0.965 Vali Loss: 1.495 Vali Acc: 0.625 Test Loss: 1.495 Test Acc: 0.625
Validation loss decreased (-0.333313 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 3.9308664798736572
Epoch: 3, Steps: 7 | Train Loss: 0.106 Vali Loss: 1.512 Vali Acc: 0.708 Test Loss: 1.512 Test Acc: 0.708
Validation loss decreased (-0.624985 --> -0.708318).  Saving model ...
Epoch: 4 cost time: 3.808354139328003
Epoch: 4, Steps: 7 | Train Loss: 0.049 Vali Loss: 2.044 Vali Acc: 0.639 Test Loss: 2.044 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.27959132194519
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.542 Vali Acc: 0.653 Test Loss: 1.542 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.942747116088867
Epoch: 6, Steps: 7 | Train Loss: 0.070 Vali Loss: 2.313 Vali Acc: 0.639 Test Loss: 2.313 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.846217155456543
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 4.345 Vali Acc: 0.542 Test Loss: 4.345 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.759431600570679
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.956 Vali Acc: 0.569 Test Loss: 3.956 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.040085554122925
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.949 Vali Acc: 0.653 Test Loss: 1.949 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6521353721618652
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.517 Vali Acc: 0.528 Test Loss: 3.517 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8851630687713623
Epoch: 11, Steps: 7 | Train Loss: 0.123 Vali Loss: 3.373 Vali Acc: 0.639 Test Loss: 3.373 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.6189513206481934
Epoch: 12, Steps: 7 | Train Loss: 0.209 Vali Loss: 3.878 Vali Acc: 0.583 Test Loss: 3.878 Test Acc: 0.583
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.056683301925659
Epoch: 13, Steps: 7 | Train Loss: 0.122 Vali Loss: 3.949 Vali Acc: 0.611 Test Loss: 3.949 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7083333333333334
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.692718505859375
Epoch: 1, Steps: 7 | Train Loss: 2.573 Vali Loss: 2.173 Vali Acc: 0.264 Test Loss: 2.173 Test Acc: 0.264
Validation loss decreased (inf --> -0.263867).  Saving model ...
Epoch: 2 cost time: 3.6778485774993896
Epoch: 2, Steps: 7 | Train Loss: 1.112 Vali Loss: 1.926 Vali Acc: 0.500 Test Loss: 1.926 Test Acc: 0.500
Validation loss decreased (-0.263867 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 3.4204766750335693
Epoch: 3, Steps: 7 | Train Loss: 0.151 Vali Loss: 2.061 Vali Acc: 0.556 Test Loss: 2.061 Test Acc: 0.556
Validation loss decreased (-0.499981 --> -0.555535).  Saving model ...
Epoch: 4 cost time: 3.584937810897827
Epoch: 4, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.899 Vali Acc: 0.542 Test Loss: 1.899 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9074416160583496
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.372 Vali Acc: 0.528 Test Loss: 2.372 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.71085786819458
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 1.886 Vali Acc: 0.639 Test Loss: 1.886 Test Acc: 0.639
Validation loss decreased (-0.555535 --> -0.638870).  Saving model ...
Epoch: 7 cost time: 4.466944456100464
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.942 Vali Acc: 0.528 Test Loss: 2.942 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9849584102630615
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.169 Vali Acc: 0.528 Test Loss: 3.169 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.481590986251831
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.002 Vali Acc: 0.583 Test Loss: 3.002 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.634777307510376
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.791 Vali Acc: 0.500 Test Loss: 3.791 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4192230701446533
Epoch: 11, Steps: 7 | Train Loss: 0.087 Vali Loss: 5.154 Vali Acc: 0.500 Test Loss: 5.154 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.747427463531494
Epoch: 12, Steps: 7 | Train Loss: 0.162 Vali Loss: 4.683 Vali Acc: 0.514 Test Loss: 4.683 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.000546932220459
Epoch: 13, Steps: 7 | Train Loss: 0.156 Vali Loss: 5.915 Vali Acc: 0.514 Test Loss: 5.915 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.023238658905029
Epoch: 14, Steps: 7 | Train Loss: 0.194 Vali Loss: 4.666 Vali Acc: 0.569 Test Loss: 4.666 Test Acc: 0.569
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.06856107711792
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 6.131 Vali Acc: 0.514 Test Loss: 6.131 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.4291651248931885
Epoch: 16, Steps: 7 | Train Loss: 0.193 Vali Loss: 4.947 Vali Acc: 0.556 Test Loss: 4.947 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6388888888888888
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.127702474594116
Epoch: 1, Steps: 7 | Train Loss: 2.651 Vali Loss: 2.410 Vali Acc: 0.194 Test Loss: 2.410 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 3.44557523727417
Epoch: 2, Steps: 7 | Train Loss: 1.229 Vali Loss: 2.558 Vali Acc: 0.278 Test Loss: 2.558 Test Acc: 0.278
Validation loss decreased (-0.194420 --> -0.277752).  Saving model ...
Epoch: 3 cost time: 3.360621213912964
Epoch: 3, Steps: 7 | Train Loss: 0.243 Vali Loss: 3.032 Vali Acc: 0.347 Test Loss: 3.032 Test Acc: 0.347
Validation loss decreased (-0.277752 --> -0.347192).  Saving model ...
Epoch: 4 cost time: 3.9704790115356445
Epoch: 4, Steps: 7 | Train Loss: 0.030 Vali Loss: 3.648 Vali Acc: 0.389 Test Loss: 3.648 Test Acc: 0.389
Validation loss decreased (-0.347192 --> -0.388852).  Saving model ...
Epoch: 5 cost time: 3.5857224464416504
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.724 Vali Acc: 0.417 Test Loss: 3.724 Test Acc: 0.417
Validation loss decreased (-0.388852 --> -0.416629).  Saving model ...
Epoch: 6 cost time: 3.6166014671325684
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 4.127 Vali Acc: 0.403 Test Loss: 4.127 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4255130290985107
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.736 Vali Acc: 0.403 Test Loss: 4.736 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2625911235809326
Epoch: 8, Steps: 7 | Train Loss: 0.033 Vali Loss: 3.599 Vali Acc: 0.361 Test Loss: 3.599 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.104630947113037
Epoch: 9, Steps: 7 | Train Loss: 0.161 Vali Loss: 4.967 Vali Acc: 0.431 Test Loss: 4.967 Test Acc: 0.431
Validation loss decreased (-0.416629 --> -0.430506).  Saving model ...
Epoch: 10 cost time: 3.2685770988464355
Epoch: 10, Steps: 7 | Train Loss: 0.096 Vali Loss: 4.691 Vali Acc: 0.403 Test Loss: 4.691 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3071799278259277
Epoch: 11, Steps: 7 | Train Loss: 0.073 Vali Loss: 5.589 Vali Acc: 0.458 Test Loss: 5.589 Test Acc: 0.458
Validation loss decreased (-0.430506 --> -0.458277).  Saving model ...
Epoch: 12 cost time: 3.904259443283081
Epoch: 12, Steps: 7 | Train Loss: 0.219 Vali Loss: 6.526 Vali Acc: 0.431 Test Loss: 6.526 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.108771800994873
Epoch: 13, Steps: 7 | Train Loss: 0.059 Vali Loss: 8.715 Vali Acc: 0.278 Test Loss: 8.715 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7644832134246826
Epoch: 14, Steps: 7 | Train Loss: 0.152 Vali Loss: 10.589 Vali Acc: 0.292 Test Loss: 10.589 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.423452377319336
Epoch: 15, Steps: 7 | Train Loss: 0.679 Vali Loss: 7.600 Vali Acc: 0.347 Test Loss: 7.600 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.687246799468994
Epoch: 16, Steps: 7 | Train Loss: 0.141 Vali Loss: 9.819 Vali Acc: 0.333 Test Loss: 9.819 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1488306522369385
Epoch: 17, Steps: 7 | Train Loss: 0.309 Vali Loss: 13.569 Vali Acc: 0.347 Test Loss: 13.569 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3325281143188477
Epoch: 18, Steps: 7 | Train Loss: 0.453 Vali Loss: 15.566 Vali Acc: 0.181 Test Loss: 15.566 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.19692325592041
Epoch: 19, Steps: 7 | Train Loss: 0.326 Vali Loss: 17.978 Vali Acc: 0.208 Test Loss: 17.978 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5496814250946045
Epoch: 20, Steps: 7 | Train Loss: 1.308 Vali Loss: 16.617 Vali Acc: 0.347 Test Loss: 16.617 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.601475238800049
Epoch: 21, Steps: 7 | Train Loss: 0.173 Vali Loss: 12.212 Vali Acc: 0.333 Test Loss: 12.212 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.492286682128906
Epoch: 1, Steps: 7 | Train Loss: 2.652 Vali Loss: 2.376 Vali Acc: 0.167 Test Loss: 2.376 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 3.053837537765503
Epoch: 2, Steps: 7 | Train Loss: 1.382 Vali Loss: 2.290 Vali Acc: 0.306 Test Loss: 2.290 Test Acc: 0.306
Validation loss decreased (-0.166643 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 2.926719903945923
Epoch: 3, Steps: 7 | Train Loss: 0.347 Vali Loss: 2.795 Vali Acc: 0.222 Test Loss: 2.795 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.958364486694336
Epoch: 4, Steps: 7 | Train Loss: 0.080 Vali Loss: 2.316 Vali Acc: 0.444 Test Loss: 2.316 Test Acc: 0.444
Validation loss decreased (-0.305533 --> -0.444421).  Saving model ...
Epoch: 5 cost time: 3.2222628593444824
Epoch: 5, Steps: 7 | Train Loss: 0.048 Vali Loss: 3.738 Vali Acc: 0.347 Test Loss: 3.738 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1444056034088135
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.982 Vali Acc: 0.431 Test Loss: 2.982 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5762078762054443
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.825 Vali Acc: 0.403 Test Loss: 3.825 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.310602903366089
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.326 Vali Acc: 0.347 Test Loss: 4.326 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.687904119491577
Epoch: 9, Steps: 7 | Train Loss: 0.052 Vali Loss: 4.231 Vali Acc: 0.417 Test Loss: 4.231 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0133719444274902
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 4.652 Vali Acc: 0.403 Test Loss: 4.652 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.125561475753784
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.950 Vali Acc: 0.361 Test Loss: 4.950 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0629658699035645
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 4.413 Vali Acc: 0.403 Test Loss: 4.413 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.3369150161743164
Epoch: 13, Steps: 7 | Train Loss: 0.052 Vali Loss: 4.468 Vali Acc: 0.403 Test Loss: 4.468 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.100621223449707
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.581 Vali Acc: 0.389 Test Loss: 6.581 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.271599054336548
Epoch: 1, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.381 Vali Acc: 0.125 Test Loss: 2.381 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.8963565826416016
Epoch: 2, Steps: 7 | Train Loss: 1.510 Vali Loss: 2.257 Vali Acc: 0.319 Test Loss: 2.257 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 3.0176424980163574
Epoch: 3, Steps: 7 | Train Loss: 0.453 Vali Loss: 2.580 Vali Acc: 0.208 Test Loss: 2.580 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0816633701324463
Epoch: 4, Steps: 7 | Train Loss: 0.096 Vali Loss: 1.955 Vali Acc: 0.361 Test Loss: 1.955 Test Acc: 0.361
Validation loss decreased (-0.319422 --> -0.361092).  Saving model ...
Epoch: 5 cost time: 2.8781487941741943
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.545 Vali Acc: 0.472 Test Loss: 2.545 Test Acc: 0.472
Validation loss decreased (-0.361092 --> -0.472197).  Saving model ...
Epoch: 6 cost time: 3.0664186477661133
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.431 Test Loss: 1.949 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5303752422332764
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.503 Vali Acc: 0.472 Test Loss: 2.503 Test Acc: 0.472
Validation loss decreased (-0.472197 --> -0.472197).  Saving model ...
Epoch: 8 cost time: 3.4344542026519775
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.716 Vali Acc: 0.486 Test Loss: 2.716 Test Acc: 0.486
Validation loss decreased (-0.472197 --> -0.486084).  Saving model ...
Epoch: 9 cost time: 3.0336875915527344
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.472 Test Loss: 2.726 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.206404447555542
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.729 Vali Acc: 0.431 Test Loss: 2.729 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.329387903213501
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.431 Test Loss: 2.708 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.216902017593384
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.671 Vali Acc: 0.431 Test Loss: 2.671 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8432695865631104
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.630 Vali Acc: 0.431 Test Loss: 2.630 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2098989486694336
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.592 Vali Acc: 0.431 Test Loss: 2.592 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7393271923065186
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.559 Vali Acc: 0.431 Test Loss: 2.559 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7993485927581787
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.534 Vali Acc: 0.444 Test Loss: 2.534 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2556920051574707
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.508 Vali Acc: 0.444 Test Loss: 2.508 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.972984552383423
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.487 Vali Acc: 0.444 Test Loss: 2.487 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.348349571228027
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.437 Vali Acc: 0.097 Test Loss: 2.437 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 3.0444960594177246
Epoch: 2, Steps: 7 | Train Loss: 1.597 Vali Loss: 2.392 Vali Acc: 0.319 Test Loss: 2.392 Test Acc: 0.319
Validation loss decreased (-0.097198 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 2.943873167037964
Epoch: 3, Steps: 7 | Train Loss: 0.451 Vali Loss: 2.762 Vali Acc: 0.167 Test Loss: 2.762 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.735187292098999
Epoch: 4, Steps: 7 | Train Loss: 0.072 Vali Loss: 2.090 Vali Acc: 0.375 Test Loss: 2.090 Test Acc: 0.375
Validation loss decreased (-0.319421 --> -0.374979).  Saving model ...
Epoch: 5 cost time: 2.9499568939208984
Epoch: 5, Steps: 7 | Train Loss: 0.018 Vali Loss: 2.814 Vali Acc: 0.417 Test Loss: 2.814 Test Acc: 0.417
Validation loss decreased (-0.374979 --> -0.416639).  Saving model ...
Epoch: 6 cost time: 3.033256769180298
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.340 Vali Acc: 0.389 Test Loss: 2.340 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.371000051498413
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.948 Vali Acc: 0.431 Test Loss: 3.948 Test Acc: 0.431
Validation loss decreased (-0.416639 --> -0.430516).  Saving model ...
Epoch: 8 cost time: 3.0813915729522705
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.970 Vali Acc: 0.431 Test Loss: 3.970 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2329862117767334
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.761 Vali Acc: 0.389 Test Loss: 4.761 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2245311737060547
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.759 Vali Acc: 0.403 Test Loss: 3.759 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.298007011413574
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.728 Vali Acc: 0.417 Test Loss: 3.728 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9274721145629883
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.765 Vali Acc: 0.486 Test Loss: 3.765 Test Acc: 0.486
Validation loss decreased (-0.430516 --> -0.486073).  Saving model ...
Epoch: 13 cost time: 2.9881770610809326
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.605 Vali Acc: 0.458 Test Loss: 3.605 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0788557529449463
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.574 Vali Acc: 0.444 Test Loss: 3.574 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.964308500289917
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.573 Vali Acc: 0.444 Test Loss: 3.573 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.407575845718384
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.581 Vali Acc: 0.444 Test Loss: 3.581 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.957068681716919
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.593 Vali Acc: 0.444 Test Loss: 3.593 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.552025556564331
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.608 Vali Acc: 0.444 Test Loss: 3.608 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1267056465148926
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.618 Vali Acc: 0.444 Test Loss: 3.618 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.680391788482666
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.624 Vali Acc: 0.444 Test Loss: 3.624 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.034916639328003
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.630 Vali Acc: 0.444 Test Loss: 3.630 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.938112497329712
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.632 Vali Acc: 0.444 Test Loss: 3.632 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.869835376739502
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.401 Vali Acc: 0.236 Test Loss: 2.401 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 3.485557794570923
Epoch: 2, Steps: 7 | Train Loss: 1.851 Vali Loss: 2.543 Vali Acc: 0.250 Test Loss: 2.543 Test Acc: 0.250
Validation loss decreased (-0.236087 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 3.0773916244506836
Epoch: 3, Steps: 7 | Train Loss: 0.768 Vali Loss: 3.084 Vali Acc: 0.153 Test Loss: 3.084 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.570033073425293
Epoch: 4, Steps: 7 | Train Loss: 0.200 Vali Loss: 2.670 Vali Acc: 0.222 Test Loss: 2.670 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7776811122894287
Epoch: 5, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.939 Vali Acc: 0.278 Test Loss: 2.939 Test Acc: 0.278
Validation loss decreased (-0.249975 --> -0.277748).  Saving model ...
Epoch: 6 cost time: 2.9233622550964355
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.097 Vali Acc: 0.222 Test Loss: 3.097 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.556393623352051
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.659 Vali Acc: 0.292 Test Loss: 3.659 Test Acc: 0.292
Validation loss decreased (-0.277748 --> -0.291630).  Saving model ...
Epoch: 8 cost time: 2.9514803886413574
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.483 Vali Acc: 0.236 Test Loss: 3.483 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9550249576568604
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.268 Vali Acc: 0.278 Test Loss: 3.268 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.143622398376465
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.288 Vali Acc: 0.306 Test Loss: 3.288 Test Acc: 0.306
Validation loss decreased (-0.291630 --> -0.305523).  Saving model ...
Epoch: 11 cost time: 2.958515167236328
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.272 Vali Acc: 0.306 Test Loss: 3.272 Test Acc: 0.306
Validation loss decreased (-0.305523 --> -0.305523).  Saving model ...
Epoch: 12 cost time: 3.1454343795776367
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.293 Vali Acc: 0.333 Test Loss: 3.293 Test Acc: 0.333
Validation loss decreased (-0.305523 --> -0.333300).  Saving model ...
Epoch: 13 cost time: 3.077610492706299
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.422 Vali Acc: 0.292 Test Loss: 3.422 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.025712251663208
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.476 Vali Acc: 0.264 Test Loss: 3.476 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1020467281341553
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.452 Vali Acc: 0.264 Test Loss: 3.452 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9715676307678223
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.406 Vali Acc: 0.264 Test Loss: 3.406 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1779847145080566
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.347 Vali Acc: 0.264 Test Loss: 3.347 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.805473566055298
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.283 Vali Acc: 0.278 Test Loss: 3.283 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3454859256744385
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.234 Vali Acc: 0.264 Test Loss: 3.234 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0903003215789795
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.250 Test Loss: 3.189 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.3220481872558594
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.250 Test Loss: 3.170 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1047706604003906
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.162 Vali Acc: 0.264 Test Loss: 3.162 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3333333333333333
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.192105054855347
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.448 Vali Acc: 0.167 Test Loss: 2.448 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.611145257949829
Epoch: 2, Steps: 7 | Train Loss: 1.756 Vali Loss: 3.161 Vali Acc: 0.194 Test Loss: 3.161 Test Acc: 0.194
Validation loss decreased (-0.166642 --> -0.194413).  Saving model ...
Epoch: 3 cost time: 3.3430488109588623
Epoch: 3, Steps: 7 | Train Loss: 0.872 Vali Loss: 3.293 Vali Acc: 0.264 Test Loss: 3.293 Test Acc: 0.264
Validation loss decreased (-0.194413 --> -0.263856).  Saving model ...
Epoch: 4 cost time: 3.049729585647583
Epoch: 4, Steps: 7 | Train Loss: 0.306 Vali Loss: 3.120 Vali Acc: 0.167 Test Loss: 3.120 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.398684501647949
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 4.033 Vali Acc: 0.181 Test Loss: 4.033 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.072531223297119
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 4.786 Vali Acc: 0.208 Test Loss: 4.786 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.14982533454895
Epoch: 7, Steps: 7 | Train Loss: 0.023 Vali Loss: 6.901 Vali Acc: 0.153 Test Loss: 6.901 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8812601566314697
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 5.600 Vali Acc: 0.236 Test Loss: 5.600 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9003803730010986
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 5.779 Vali Acc: 0.222 Test Loss: 5.779 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8790218830108643
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 7.545 Vali Acc: 0.264 Test Loss: 7.545 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9018824100494385
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 8.337 Vali Acc: 0.264 Test Loss: 8.337 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3064446449279785
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.205 Vali Acc: 0.264 Test Loss: 8.205 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0452442169189453
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.907 Vali Acc: 0.250 Test Loss: 7.907 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2638888888888889
model parameter : 9461516
model size : 45.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.300818920135498
Epoch: 1, Steps: 7 | Train Loss: 2.360 Vali Loss: 1.608 Vali Acc: 0.611 Test Loss: 1.608 Test Acc: 0.611
Validation loss decreased (inf --> -0.611095).  Saving model ...
Epoch: 2 cost time: 4.97095513343811
Epoch: 2, Steps: 7 | Train Loss: 0.534 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.611095 --> -0.749990).  Saving model ...
Epoch: 3 cost time: 4.483549118041992
Epoch: 3, Steps: 7 | Train Loss: 0.027 Vali Loss: 1.529 Vali Acc: 0.806 Test Loss: 1.529 Test Acc: 0.806
Validation loss decreased (-0.749990 --> -0.805540).  Saving model ...
Epoch: 4 cost time: 4.350451231002808
Epoch: 4, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.483 Vali Acc: 0.750 Test Loss: 1.483 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.842284440994263
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.546 Vali Acc: 0.736 Test Loss: 2.546 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.2275917530059814
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.438 Vali Acc: 0.778 Test Loss: 2.438 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.186299562454224
Epoch: 7, Steps: 7 | Train Loss: 0.045 Vali Loss: 2.087 Vali Acc: 0.764 Test Loss: 2.087 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.904911279678345
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.032 Vali Acc: 0.819 Test Loss: 2.032 Test Acc: 0.819
Validation loss decreased (-0.805540 --> -0.819424).  Saving model ...
Epoch: 9 cost time: 5.124580383300781
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.124 Vali Acc: 0.750 Test Loss: 3.124 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.15904688835144
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 2.810 Vali Acc: 0.736 Test Loss: 2.810 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.445573091506958
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.389 Vali Acc: 0.722 Test Loss: 2.389 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.509433269500732
Epoch: 12, Steps: 7 | Train Loss: 0.060 Vali Loss: 2.966 Vali Acc: 0.722 Test Loss: 2.966 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.984785079956055
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.395 Vali Acc: 0.778 Test Loss: 3.395 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.418139696121216
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.210 Vali Acc: 0.778 Test Loss: 4.210 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.999192237854004
Epoch: 15, Steps: 7 | Train Loss: 0.061 Vali Loss: 4.220 Vali Acc: 0.778 Test Loss: 4.220 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.957446098327637
Epoch: 16, Steps: 7 | Train Loss: 0.029 Vali Loss: 3.838 Vali Acc: 0.819 Test Loss: 3.838 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.538611173629761
Epoch: 17, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.961 Vali Acc: 0.764 Test Loss: 3.961 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.2755537033081055
Epoch: 18, Steps: 7 | Train Loss: 0.016 Vali Loss: 4.767 Vali Acc: 0.750 Test Loss: 4.767 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.28798770904541
Epoch: 1, Steps: 7 | Train Loss: 2.419 Vali Loss: 1.817 Vali Acc: 0.569 Test Loss: 1.817 Test Acc: 0.569
Validation loss decreased (inf --> -0.569426).  Saving model ...
Epoch: 2 cost time: 4.82140851020813
Epoch: 2, Steps: 7 | Train Loss: 0.678 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
Validation loss decreased (-0.569426 --> -0.749991).  Saving model ...
Epoch: 3 cost time: 5.11143684387207
Epoch: 3, Steps: 7 | Train Loss: 0.076 Vali Loss: 1.226 Vali Acc: 0.778 Test Loss: 1.226 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777766).  Saving model ...
Epoch: 4 cost time: 3.940366506576538
Epoch: 4, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.028 Vali Acc: 0.694 Test Loss: 2.028 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.2554614543914795
Epoch: 5, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.734 Vali Acc: 0.667 Test Loss: 2.734 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.723111152648926
Epoch: 6, Steps: 7 | Train Loss: 0.122 Vali Loss: 2.622 Vali Acc: 0.694 Test Loss: 2.622 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.241717100143433
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.887 Vali Acc: 0.681 Test Loss: 2.887 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.8604960441589355
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.602 Vali Acc: 0.708 Test Loss: 3.602 Test Acc: 0.708
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.006123304367065
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.834 Vali Acc: 0.653 Test Loss: 3.834 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.111948490142822
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.843 Vali Acc: 0.736 Test Loss: 2.843 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.431942462921143
Epoch: 11, Steps: 7 | Train Loss: 0.041 Vali Loss: 2.943 Vali Acc: 0.736 Test Loss: 2.943 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7584283351898193
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.712 Vali Acc: 0.653 Test Loss: 3.712 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.664937257766724
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.800 Vali Acc: 0.694 Test Loss: 3.800 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.180964708328247
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 2.033 Vali Acc: 0.444 Test Loss: 2.033 Test Acc: 0.444
Validation loss decreased (inf --> -0.444424).  Saving model ...
Epoch: 2 cost time: 3.6499853134155273
Epoch: 2, Steps: 7 | Train Loss: 0.833 Vali Loss: 1.099 Vali Acc: 0.694 Test Loss: 1.099 Test Acc: 0.694
Validation loss decreased (-0.444424 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 4.3943116664886475
Epoch: 3, Steps: 7 | Train Loss: 0.166 Vali Loss: 1.209 Vali Acc: 0.736 Test Loss: 1.209 Test Acc: 0.736
Validation loss decreased (-0.694433 --> -0.736099).  Saving model ...
Epoch: 4 cost time: 3.6318609714508057
Epoch: 4, Steps: 7 | Train Loss: 0.051 Vali Loss: 2.302 Vali Acc: 0.639 Test Loss: 2.302 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5234622955322266
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.585 Vali Acc: 0.722 Test Loss: 1.585 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.085123777389526
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 1.612 Vali Acc: 0.681 Test Loss: 1.612 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8011727333068848
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.681 Test Loss: 1.171 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.401972532272339
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.778 Test Loss: 1.009 Test Acc: 0.778
Validation loss decreased (-0.736099 --> -0.777768).  Saving model ...
Epoch: 9 cost time: 4.045593738555908
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.764 Test Loss: 1.102 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.707576513290405
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.764 Test Loss: 1.178 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7579269409179688
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.764 Test Loss: 1.207 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.7545487880706787
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.764 Test Loss: 1.200 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8608639240264893
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.764 Test Loss: 1.190 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9907538890838623
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.764 Test Loss: 1.177 Test Acc: 0.764
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.2491981983184814
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.764 Test Loss: 1.167 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.592761993408203
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.764 Test Loss: 1.158 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.1956422328948975
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.764 Test Loss: 1.150 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.186628818511963
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.764 Test Loss: 1.144 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.219067096710205
Epoch: 1, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.260 Vali Acc: 0.347 Test Loss: 2.260 Test Acc: 0.347
Validation loss decreased (inf --> -0.347200).  Saving model ...
Epoch: 2 cost time: 3.4412102699279785
Epoch: 2, Steps: 7 | Train Loss: 1.033 Vali Loss: 1.505 Vali Acc: 0.542 Test Loss: 1.505 Test Acc: 0.542
Validation loss decreased (-0.347200 --> -0.541652).  Saving model ...
Epoch: 3 cost time: 3.746621608734131
Epoch: 3, Steps: 7 | Train Loss: 0.195 Vali Loss: 2.194 Vali Acc: 0.611 Test Loss: 2.194 Test Acc: 0.611
Validation loss decreased (-0.541652 --> -0.611089).  Saving model ...
Epoch: 4 cost time: 3.4202380180358887
Epoch: 4, Steps: 7 | Train Loss: 0.058 Vali Loss: 2.380 Vali Acc: 0.486 Test Loss: 2.380 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7802200317382812
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.244 Vali Acc: 0.569 Test Loss: 2.244 Test Acc: 0.569
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.339498996734619
Epoch: 6, Steps: 7 | Train Loss: 0.036 Vali Loss: 2.433 Vali Acc: 0.569 Test Loss: 2.433 Test Acc: 0.569
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5704345703125
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.023 Vali Acc: 0.583 Test Loss: 3.023 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1164543628692627
Epoch: 8, Steps: 7 | Train Loss: 0.088 Vali Loss: 3.614 Vali Acc: 0.542 Test Loss: 3.614 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2327613830566406
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 4.593 Vali Acc: 0.542 Test Loss: 4.593 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2310571670532227
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 3.451 Vali Acc: 0.597 Test Loss: 3.451 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.1365766525268555
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 3.660 Vali Acc: 0.583 Test Loss: 3.660 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3636157512664795
Epoch: 12, Steps: 7 | Train Loss: 0.189 Vali Loss: 3.089 Vali Acc: 0.597 Test Loss: 3.089 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.851332902908325
Epoch: 13, Steps: 7 | Train Loss: 0.176 Vali Loss: 4.518 Vali Acc: 0.569 Test Loss: 4.518 Test Acc: 0.569
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6111111111111112
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.195460796356201
Epoch: 1, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.559 Vali Acc: 0.153 Test Loss: 2.559 Test Acc: 0.153
Validation loss decreased (inf --> -0.152752).  Saving model ...
Epoch: 2 cost time: 2.9608500003814697
Epoch: 2, Steps: 7 | Train Loss: 1.289 Vali Loss: 2.322 Vali Acc: 0.306 Test Loss: 2.322 Test Acc: 0.306
Validation loss decreased (-0.152752 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 2.50931978225708
Epoch: 3, Steps: 7 | Train Loss: 0.232 Vali Loss: 2.701 Vali Acc: 0.361 Test Loss: 2.701 Test Acc: 0.361
Validation loss decreased (-0.305532 --> -0.361084).  Saving model ...
Epoch: 4 cost time: 3.3413565158843994
Epoch: 4, Steps: 7 | Train Loss: 0.018 Vali Loss: 3.246 Vali Acc: 0.347 Test Loss: 3.246 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0154168605804443
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.663 Vali Acc: 0.347 Test Loss: 3.663 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6159703731536865
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.436 Vali Acc: 0.361 Test Loss: 4.436 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0839250087738037
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.324 Vali Acc: 0.389 Test Loss: 3.324 Test Acc: 0.389
Validation loss decreased (-0.361084 --> -0.388856).  Saving model ...
Epoch: 8 cost time: 3.4794392585754395
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.119 Vali Acc: 0.444 Test Loss: 4.119 Test Acc: 0.444
Validation loss decreased (-0.388856 --> -0.444403).  Saving model ...
Epoch: 9 cost time: 2.768681287765503
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 5.932 Vali Acc: 0.403 Test Loss: 5.932 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.116504430770874
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 4.186 Vali Acc: 0.375 Test Loss: 4.186 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8465890884399414
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.368 Vali Acc: 0.375 Test Loss: 4.368 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1368038654327393
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.868 Vali Acc: 0.431 Test Loss: 3.868 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.251434087753296
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.889 Vali Acc: 0.458 Test Loss: 3.889 Test Acc: 0.458
Validation loss decreased (-0.444403 --> -0.458294).  Saving model ...
Epoch: 14 cost time: 3.640713691711426
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.336 Vali Acc: 0.431 Test Loss: 4.336 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1859052181243896
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.572 Vali Acc: 0.403 Test Loss: 4.572 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4774065017700195
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.603 Vali Acc: 0.389 Test Loss: 4.603 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.201859474182129
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.573 Vali Acc: 0.417 Test Loss: 4.573 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.244356870651245
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.546 Vali Acc: 0.431 Test Loss: 4.546 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.973515033721924
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.516 Vali Acc: 0.431 Test Loss: 4.516 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2260196208953857
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.493 Vali Acc: 0.431 Test Loss: 4.493 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1554996967315674
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.476 Vali Acc: 0.431 Test Loss: 4.476 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.271942377090454
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.461 Vali Acc: 0.431 Test Loss: 4.461 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5874152183532715
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.446 Vali Acc: 0.431 Test Loss: 4.446 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.934556484222412
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.455 Vali Acc: 0.194 Test Loss: 2.455 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.700361967086792
Epoch: 2, Steps: 7 | Train Loss: 1.387 Vali Loss: 1.941 Vali Acc: 0.417 Test Loss: 1.941 Test Acc: 0.417
Validation loss decreased (-0.194420 --> -0.416647).  Saving model ...
Epoch: 3 cost time: 2.6732420921325684
Epoch: 3, Steps: 7 | Train Loss: 0.287 Vali Loss: 2.886 Vali Acc: 0.264 Test Loss: 2.886 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7693874835968018
Epoch: 4, Steps: 7 | Train Loss: 0.069 Vali Loss: 3.146 Vali Acc: 0.389 Test Loss: 3.146 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.660804271697998
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 3.700 Vali Acc: 0.278 Test Loss: 3.700 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.165649652481079
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 4.455 Vali Acc: 0.375 Test Loss: 4.455 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7780826091766357
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.916 Vali Acc: 0.333 Test Loss: 3.916 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2831485271453857
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.844 Vali Acc: 0.347 Test Loss: 2.844 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6737875938415527
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.247 Vali Acc: 0.347 Test Loss: 6.247 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1083414554595947
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.650 Vali Acc: 0.403 Test Loss: 4.650 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6018004417419434
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.477 Vali Acc: 0.417 Test Loss: 4.477 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9239120483398438
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.740 Vali Acc: 0.403 Test Loss: 3.740 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.0340752601623535
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.444 Vali Acc: 0.250 Test Loss: 2.444 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 2.6807191371917725
Epoch: 2, Steps: 7 | Train Loss: 1.523 Vali Loss: 1.968 Vali Acc: 0.431 Test Loss: 1.968 Test Acc: 0.431
Validation loss decreased (-0.249976 --> -0.430536).  Saving model ...
Epoch: 3 cost time: 2.7191545963287354
Epoch: 3, Steps: 7 | Train Loss: 0.325 Vali Loss: 2.251 Vali Acc: 0.292 Test Loss: 2.251 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.824110507965088
Epoch: 4, Steps: 7 | Train Loss: 0.079 Vali Loss: 2.850 Vali Acc: 0.361 Test Loss: 2.850 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0496675968170166
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.815 Vali Acc: 0.375 Test Loss: 2.815 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4678292274475098
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 2.986 Vali Acc: 0.389 Test Loss: 2.986 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.722102403640747
Epoch: 7, Steps: 7 | Train Loss: 0.023 Vali Loss: 3.403 Vali Acc: 0.472 Test Loss: 3.403 Test Acc: 0.472
Validation loss decreased (-0.430536 --> -0.472188).  Saving model ...
Epoch: 8 cost time: 2.654768466949463
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.638 Vali Acc: 0.472 Test Loss: 2.638 Test Acc: 0.472
Validation loss decreased (-0.472188 --> -0.472196).  Saving model ...
Epoch: 9 cost time: 2.6360273361206055
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.410 Vali Acc: 0.486 Test Loss: 3.410 Test Acc: 0.486
Validation loss decreased (-0.472196 --> -0.486077).  Saving model ...
Epoch: 10 cost time: 2.829789638519287
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 3.352 Vali Acc: 0.486 Test Loss: 3.352 Test Acc: 0.486
Validation loss decreased (-0.486077 --> -0.486078).  Saving model ...
Epoch: 11 cost time: 2.8967177867889404
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.847 Vali Acc: 0.472 Test Loss: 2.847 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6595635414123535
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.672 Vali Acc: 0.500 Test Loss: 2.672 Test Acc: 0.500
Validation loss decreased (-0.486078 --> -0.499973).  Saving model ...
Epoch: 13 cost time: 2.8962674140930176
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.622 Vali Acc: 0.500 Test Loss: 2.622 Test Acc: 0.500
Validation loss decreased (-0.499973 --> -0.499974).  Saving model ...
Epoch: 14 cost time: 2.6859259605407715
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.631 Vali Acc: 0.514 Test Loss: 2.631 Test Acc: 0.514
Validation loss decreased (-0.499974 --> -0.513863).  Saving model ...
Epoch: 15 cost time: 3.111536741256714
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.644 Vali Acc: 0.514 Test Loss: 2.644 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.743276834487915
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.514 Test Loss: 2.650 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8380699157714844
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.514 Test Loss: 2.650 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0178279876708984
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.648 Vali Acc: 0.514 Test Loss: 2.648 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.597058057785034
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.646 Vali Acc: 0.514 Test Loss: 2.646 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2006444931030273
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.644 Vali Acc: 0.514 Test Loss: 2.644 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.946140766143799
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.638 Vali Acc: 0.500 Test Loss: 2.638 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.080690383911133
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.631 Vali Acc: 0.500 Test Loss: 2.631 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.946291208267212
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.627 Vali Acc: 0.500 Test Loss: 2.627 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8579459190368652
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.623 Vali Acc: 0.500 Test Loss: 2.623 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5138888888888888
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.807799816131592
Epoch: 1, Steps: 7 | Train Loss: 2.542 Vali Loss: 2.429 Vali Acc: 0.250 Test Loss: 2.429 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 2.6848652362823486
Epoch: 2, Steps: 7 | Train Loss: 1.613 Vali Loss: 2.183 Vali Acc: 0.444 Test Loss: 2.183 Test Acc: 0.444
Validation loss decreased (-0.249976 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 2.91021728515625
Epoch: 3, Steps: 7 | Train Loss: 0.379 Vali Loss: 2.882 Vali Acc: 0.278 Test Loss: 2.882 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6134185791015625
Epoch: 4, Steps: 7 | Train Loss: 0.064 Vali Loss: 2.362 Vali Acc: 0.389 Test Loss: 2.362 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9685680866241455
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.838 Vali Acc: 0.444 Test Loss: 2.838 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.82565975189209
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.008 Vali Acc: 0.472 Test Loss: 3.008 Test Acc: 0.472
Validation loss decreased (-0.444423 --> -0.472192).  Saving model ...
Epoch: 7 cost time: 3.0268259048461914
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.143 Vali Acc: 0.431 Test Loss: 3.143 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.435966968536377
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.502 Vali Acc: 0.431 Test Loss: 3.502 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6608736515045166
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.641 Vali Acc: 0.444 Test Loss: 3.641 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6180930137634277
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.984 Vali Acc: 0.472 Test Loss: 3.984 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6972572803497314
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.361 Vali Acc: 0.542 Test Loss: 3.361 Test Acc: 0.542
Validation loss decreased (-0.472192 --> -0.541633).  Saving model ...
Epoch: 12 cost time: 2.6548707485198975
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.281 Vali Acc: 0.514 Test Loss: 3.281 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7609024047851562
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.285 Vali Acc: 0.500 Test Loss: 3.285 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0705385208129883
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.250 Vali Acc: 0.500 Test Loss: 3.250 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7076332569122314
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.188 Vali Acc: 0.500 Test Loss: 3.188 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8404767513275146
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.147 Vali Acc: 0.486 Test Loss: 3.147 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.909207582473755
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.130 Vali Acc: 0.486 Test Loss: 3.130 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6876442432403564
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.126 Vali Acc: 0.486 Test Loss: 3.126 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6427762508392334
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.129 Vali Acc: 0.486 Test Loss: 3.129 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.42747163772583
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.136 Vali Acc: 0.500 Test Loss: 3.136 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5729706287384033
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.141 Vali Acc: 0.500 Test Loss: 3.141 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5416666666666666
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.691256284713745
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.543 Vali Acc: 0.236 Test Loss: 2.543 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 2.805724859237671
Epoch: 2, Steps: 7 | Train Loss: 1.865 Vali Loss: 2.660 Vali Acc: 0.194 Test Loss: 2.660 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.944835901260376
Epoch: 3, Steps: 7 | Train Loss: 0.791 Vali Loss: 3.046 Vali Acc: 0.194 Test Loss: 3.046 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6710026264190674
Epoch: 4, Steps: 7 | Train Loss: 0.217 Vali Loss: 2.848 Vali Acc: 0.139 Test Loss: 2.848 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7890594005584717
Epoch: 5, Steps: 7 | Train Loss: 0.041 Vali Loss: 4.266 Vali Acc: 0.125 Test Loss: 4.266 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5762345790863037
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 3.222 Vali Acc: 0.333 Test Loss: 3.222 Test Acc: 0.333
Validation loss decreased (-0.236086 --> -0.333301).  Saving model ...
Epoch: 7 cost time: 2.623610019683838
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 3.638 Vali Acc: 0.194 Test Loss: 3.638 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6350693702697754
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.712 Vali Acc: 0.347 Test Loss: 3.712 Test Acc: 0.347
Validation loss decreased (-0.333301 --> -0.347185).  Saving model ...
Epoch: 9 cost time: 2.5689284801483154
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.836 Vali Acc: 0.292 Test Loss: 3.836 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.196239709854126
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.913 Vali Acc: 0.264 Test Loss: 3.913 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7614972591400146
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.845 Vali Acc: 0.236 Test Loss: 3.845 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.121511220932007
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.624 Vali Acc: 0.208 Test Loss: 3.624 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8059253692626953
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.344 Vali Acc: 0.250 Test Loss: 3.344 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.069221258163452
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.188 Vali Acc: 0.250 Test Loss: 3.188 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7336041927337646
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.134 Vali Acc: 0.236 Test Loss: 3.134 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.6641128063201904
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.125 Vali Acc: 0.236 Test Loss: 3.125 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.599050998687744
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.131 Vali Acc: 0.236 Test Loss: 3.131 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7657504081726074
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.137 Vali Acc: 0.236 Test Loss: 3.137 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3472222222222222
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.846834659576416
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.478 Vali Acc: 0.194 Test Loss: 2.478 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.658672571182251
Epoch: 2, Steps: 7 | Train Loss: 1.805 Vali Loss: 3.332 Vali Acc: 0.222 Test Loss: 3.332 Test Acc: 0.222
Validation loss decreased (-0.194420 --> -0.222189).  Saving model ...
Epoch: 3 cost time: 2.936227321624756
Epoch: 3, Steps: 7 | Train Loss: 0.799 Vali Loss: 3.276 Vali Acc: 0.208 Test Loss: 3.276 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.48248291015625
Epoch: 4, Steps: 7 | Train Loss: 0.230 Vali Loss: 2.966 Vali Acc: 0.250 Test Loss: 2.966 Test Acc: 0.250
Validation loss decreased (-0.222189 --> -0.249970).  Saving model ...
Epoch: 5 cost time: 2.7447493076324463
Epoch: 5, Steps: 7 | Train Loss: 0.100 Vali Loss: 4.490 Vali Acc: 0.194 Test Loss: 4.490 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6329190731048584
Epoch: 6, Steps: 7 | Train Loss: 0.097 Vali Loss: 5.215 Vali Acc: 0.236 Test Loss: 5.215 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7899200916290283
Epoch: 7, Steps: 7 | Train Loss: 0.032 Vali Loss: 4.803 Vali Acc: 0.278 Test Loss: 4.803 Test Acc: 0.278
Validation loss decreased (-0.249970 --> -0.277730).  Saving model ...
Epoch: 8 cost time: 2.817108154296875
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 5.927 Vali Acc: 0.222 Test Loss: 5.927 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9938571453094482
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 6.293 Vali Acc: 0.236 Test Loss: 6.293 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.911717176437378
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.653 Vali Acc: 0.278 Test Loss: 5.653 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6833605766296387
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 5.339 Vali Acc: 0.264 Test Loss: 5.339 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.199307441711426
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.533 Vali Acc: 0.319 Test Loss: 5.533 Test Acc: 0.319
Validation loss decreased (-0.277730 --> -0.319389).  Saving model ...
Epoch: 13 cost time: 2.8106729984283447
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.552 Vali Acc: 0.278 Test Loss: 5.552 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.750762939453125
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.592 Vali Acc: 0.264 Test Loss: 5.592 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4940247535705566
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.593 Vali Acc: 0.278 Test Loss: 5.593 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7386975288391113
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.577 Vali Acc: 0.292 Test Loss: 5.577 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.603571891784668
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.537 Vali Acc: 0.264 Test Loss: 5.537 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.666095495223999
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.502 Vali Acc: 0.278 Test Loss: 5.502 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9231531620025635
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.482 Vali Acc: 0.278 Test Loss: 5.482 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7953736782073975
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.506 Vali Acc: 0.264 Test Loss: 5.506 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0330116748809814
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.535 Vali Acc: 0.264 Test Loss: 5.535 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.839402198791504
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.551 Vali Acc: 0.264 Test Loss: 5.551 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3194444444444444
model parameter : 7888652
model size : 39.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.5503318309783936
Epoch: 1, Steps: 7 | Train Loss: 2.422 Vali Loss: 1.462 Vali Acc: 0.569 Test Loss: 1.462 Test Acc: 0.569
Validation loss decreased (inf --> -0.569430).  Saving model ...
Epoch: 2 cost time: 5.542058706283569
Epoch: 2, Steps: 7 | Train Loss: 0.564 Vali Loss: 1.116 Vali Acc: 0.778 Test Loss: 1.116 Test Acc: 0.778
Validation loss decreased (-0.569430 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 4.834409236907959
Epoch: 3, Steps: 7 | Train Loss: 0.046 Vali Loss: 1.424 Vali Acc: 0.778 Test Loss: 1.424 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.660796880722046
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.043 Vali Acc: 0.736 Test Loss: 2.043 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.351466417312622
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.285 Vali Acc: 0.778 Test Loss: 2.285 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.580812454223633
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.554 Vali Acc: 0.764 Test Loss: 2.554 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8622257709503174
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.764 Test Loss: 2.593 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.305482625961304
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.554 Vali Acc: 0.778 Test Loss: 2.554 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.103606224060059
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.778 Test Loss: 2.530 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.732014179229736
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.778 Test Loss: 2.516 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.854584455490112
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.778 Test Loss: 2.503 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.474905490875244
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.778 Test Loss: 2.494 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.546363115310669
Epoch: 1, Steps: 7 | Train Loss: 2.453 Vali Loss: 1.663 Vali Acc: 0.472 Test Loss: 1.663 Test Acc: 0.472
Validation loss decreased (inf --> -0.472206).  Saving model ...
Epoch: 2 cost time: 4.22748589515686
Epoch: 2, Steps: 7 | Train Loss: 0.702 Vali Loss: 1.047 Vali Acc: 0.778 Test Loss: 1.047 Test Acc: 0.778
Validation loss decreased (-0.472206 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 4.730512857437134
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 1.680 Vali Acc: 0.722 Test Loss: 1.680 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.004174470901489
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 2.025 Vali Acc: 0.736 Test Loss: 2.025 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.163584232330322
Epoch: 5, Steps: 7 | Train Loss: 0.044 Vali Loss: 1.777 Vali Acc: 0.764 Test Loss: 1.777 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.577181339263916
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.425 Vali Acc: 0.667 Test Loss: 3.425 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.149240732192993
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.281 Vali Acc: 0.750 Test Loss: 2.281 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.341360807418823
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.380 Vali Acc: 0.708 Test Loss: 2.380 Test Acc: 0.708
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.22739052772522
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.722 Test Loss: 2.513 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.625581979751587
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.499 Vali Acc: 0.653 Test Loss: 3.499 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.177374362945557
Epoch: 11, Steps: 7 | Train Loss: 0.064 Vali Loss: 1.989 Vali Acc: 0.778 Test Loss: 1.989 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.949357032775879
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.108 Vali Acc: 0.653 Test Loss: 3.108 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.409389019012451
Epoch: 1, Steps: 7 | Train Loss: 2.451 Vali Loss: 1.899 Vali Acc: 0.375 Test Loss: 1.899 Test Acc: 0.375
Validation loss decreased (inf --> -0.374981).  Saving model ...
Epoch: 2 cost time: 4.2055253982543945
Epoch: 2, Steps: 7 | Train Loss: 0.917 Vali Loss: 1.518 Vali Acc: 0.653 Test Loss: 1.518 Test Acc: 0.653
Validation loss decreased (-0.374981 --> -0.652763).  Saving model ...
Epoch: 3 cost time: 3.7869906425476074
Epoch: 3, Steps: 7 | Train Loss: 0.229 Vali Loss: 1.639 Vali Acc: 0.653 Test Loss: 1.639 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.410258769989014
Epoch: 4, Steps: 7 | Train Loss: 0.064 Vali Loss: 1.499 Vali Acc: 0.722 Test Loss: 1.499 Test Acc: 0.722
Validation loss decreased (-0.652763 --> -0.722207).  Saving model ...
Epoch: 5 cost time: 3.394728660583496
Epoch: 5, Steps: 7 | Train Loss: 0.103 Vali Loss: 1.746 Vali Acc: 0.681 Test Loss: 1.746 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4254531860351562
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.514 Vali Acc: 0.750 Test Loss: 2.514 Test Acc: 0.750
Validation loss decreased (-0.722207 --> -0.749975).  Saving model ...
Epoch: 7 cost time: 3.6973772048950195
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.290 Vali Acc: 0.681 Test Loss: 2.290 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.045036554336548
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.334 Vali Acc: 0.625 Test Loss: 2.334 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.49750280380249
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.667 Test Loss: 1.949 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7223198413848877
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.669 Vali Acc: 0.750 Test Loss: 1.669 Test Acc: 0.750
Validation loss decreased (-0.749975 --> -0.749983).  Saving model ...
Epoch: 11 cost time: 4.5191638469696045
Epoch: 11, Steps: 7 | Train Loss: 0.058 Vali Loss: 2.381 Vali Acc: 0.653 Test Loss: 2.381 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.603475332260132
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.010 Vali Acc: 0.681 Test Loss: 3.010 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5295004844665527
Epoch: 13, Steps: 7 | Train Loss: 0.254 Vali Loss: 4.082 Vali Acc: 0.625 Test Loss: 4.082 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.795395851135254
Epoch: 14, Steps: 7 | Train Loss: 0.071 Vali Loss: 3.607 Vali Acc: 0.569 Test Loss: 3.607 Test Acc: 0.569
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3864049911499023
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 5.196 Vali Acc: 0.611 Test Loss: 5.196 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.235186576843262
Epoch: 16, Steps: 7 | Train Loss: 0.135 Vali Loss: 5.522 Vali Acc: 0.528 Test Loss: 5.522 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.112571477890015
Epoch: 17, Steps: 7 | Train Loss: 0.151 Vali Loss: 5.631 Vali Acc: 0.653 Test Loss: 5.631 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.545315980911255
Epoch: 18, Steps: 7 | Train Loss: 0.094 Vali Loss: 7.072 Vali Acc: 0.583 Test Loss: 7.072 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6694254875183105
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 6.559 Vali Acc: 0.653 Test Loss: 6.559 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9376182556152344
Epoch: 20, Steps: 7 | Train Loss: 0.177 Vali Loss: 7.196 Vali Acc: 0.653 Test Loss: 7.196 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.75
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.785574913024902
Epoch: 1, Steps: 7 | Train Loss: 2.506 Vali Loss: 2.129 Vali Acc: 0.264 Test Loss: 2.129 Test Acc: 0.264
Validation loss decreased (inf --> -0.263868).  Saving model ...
Epoch: 2 cost time: 3.2361371517181396
Epoch: 2, Steps: 7 | Train Loss: 1.055 Vali Loss: 1.830 Vali Acc: 0.458 Test Loss: 1.830 Test Acc: 0.458
Validation loss decreased (-0.263868 --> -0.458315).  Saving model ...
Epoch: 3 cost time: 3.7118895053863525
Epoch: 3, Steps: 7 | Train Loss: 0.260 Vali Loss: 2.001 Vali Acc: 0.542 Test Loss: 2.001 Test Acc: 0.542
Validation loss decreased (-0.458315 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 3.4596428871154785
Epoch: 4, Steps: 7 | Train Loss: 0.024 Vali Loss: 1.588 Vali Acc: 0.667 Test Loss: 1.588 Test Acc: 0.667
Validation loss decreased (-0.541647 --> -0.666651).  Saving model ...
Epoch: 5 cost time: 3.231518268585205
Epoch: 5, Steps: 7 | Train Loss: 0.080 Vali Loss: 2.678 Vali Acc: 0.542 Test Loss: 2.678 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.128861665725708
Epoch: 6, Steps: 7 | Train Loss: 0.089 Vali Loss: 2.415 Vali Acc: 0.611 Test Loss: 2.415 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9803619384765625
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 3.529 Vali Acc: 0.528 Test Loss: 3.529 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.123223304748535
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.981 Vali Acc: 0.597 Test Loss: 2.981 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5155065059661865
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.885 Vali Acc: 0.556 Test Loss: 3.885 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6051766872406006
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 3.964 Vali Acc: 0.583 Test Loss: 3.964 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.285252094268799
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 4.339 Vali Acc: 0.514 Test Loss: 4.339 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.733384370803833
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.771 Vali Acc: 0.569 Test Loss: 3.771 Test Acc: 0.569
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1713075637817383
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.286 Vali Acc: 0.569 Test Loss: 5.286 Test Acc: 0.569
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.303501844406128
Epoch: 14, Steps: 7 | Train Loss: 0.198 Vali Loss: 6.049 Vali Acc: 0.403 Test Loss: 6.049 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6666666666666666
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.472386360168457
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.286 Vali Acc: 0.167 Test Loss: 2.286 Test Acc: 0.167
Validation loss decreased (inf --> -0.166644).  Saving model ...
Epoch: 2 cost time: 3.2685272693634033
Epoch: 2, Steps: 7 | Train Loss: 1.201 Vali Loss: 2.231 Vali Acc: 0.375 Test Loss: 2.231 Test Acc: 0.375
Validation loss decreased (-0.166644 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 2.884531259536743
Epoch: 3, Steps: 7 | Train Loss: 0.224 Vali Loss: 3.727 Vali Acc: 0.333 Test Loss: 3.727 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.381730318069458
Epoch: 4, Steps: 7 | Train Loss: 0.129 Vali Loss: 3.874 Vali Acc: 0.389 Test Loss: 3.874 Test Acc: 0.389
Validation loss decreased (-0.374978 --> -0.388850).  Saving model ...
Epoch: 5 cost time: 2.919619560241699
Epoch: 5, Steps: 7 | Train Loss: 0.029 Vali Loss: 4.179 Vali Acc: 0.403 Test Loss: 4.179 Test Acc: 0.403
Validation loss decreased (-0.388850 --> -0.402736).  Saving model ...
Epoch: 6 cost time: 3.006065845489502
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.027 Vali Acc: 0.347 Test Loss: 4.027 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8194146156311035
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 5.417 Vali Acc: 0.347 Test Loss: 5.417 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.948352098464966
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.685 Vali Acc: 0.375 Test Loss: 5.685 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.695359945297241
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 5.296 Vali Acc: 0.431 Test Loss: 5.296 Test Acc: 0.431
Validation loss decreased (-0.402736 --> -0.430503).  Saving model ...
Epoch: 10 cost time: 3.35204815864563
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 6.082 Vali Acc: 0.389 Test Loss: 6.082 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.14162278175354
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 6.719 Vali Acc: 0.403 Test Loss: 6.719 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.157731533050537
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 6.454 Vali Acc: 0.333 Test Loss: 6.454 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.251323938369751
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 7.966 Vali Acc: 0.306 Test Loss: 7.966 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0426697731018066
Epoch: 14, Steps: 7 | Train Loss: 0.242 Vali Loss: 7.680 Vali Acc: 0.347 Test Loss: 7.680 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3113372325897217
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 8.609 Vali Acc: 0.347 Test Loss: 8.609 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8290812969207764
Epoch: 16, Steps: 7 | Train Loss: 0.322 Vali Loss: 8.155 Vali Acc: 0.389 Test Loss: 8.155 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9253652095794678
Epoch: 17, Steps: 7 | Train Loss: 0.079 Vali Loss: 9.032 Vali Acc: 0.264 Test Loss: 9.032 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8903074264526367
Epoch: 18, Steps: 7 | Train Loss: 0.134 Vali Loss: 8.381 Vali Acc: 0.292 Test Loss: 8.381 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0874221324920654
Epoch: 19, Steps: 7 | Train Loss: 0.108 Vali Loss: 12.544 Vali Acc: 0.292 Test Loss: 12.544 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7904605865478516
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.273 Vali Acc: 0.222 Test Loss: 2.273 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 3.154592514038086
Epoch: 2, Steps: 7 | Train Loss: 1.319 Vali Loss: 2.050 Vali Acc: 0.403 Test Loss: 2.050 Test Acc: 0.403
Validation loss decreased (-0.222199 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 2.6082499027252197
Epoch: 3, Steps: 7 | Train Loss: 0.255 Vali Loss: 3.055 Vali Acc: 0.375 Test Loss: 3.055 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.787651538848877
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 3.256 Vali Acc: 0.375 Test Loss: 3.256 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5020017623901367
Epoch: 5, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.124 Vali Acc: 0.444 Test Loss: 3.124 Test Acc: 0.444
Validation loss decreased (-0.402757 --> -0.444413).  Saving model ...
Epoch: 6 cost time: 2.548816204071045
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.620 Vali Acc: 0.347 Test Loss: 3.620 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8153860569000244
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.633 Vali Acc: 0.403 Test Loss: 4.633 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7868494987487793
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.494 Vali Acc: 0.417 Test Loss: 3.494 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0868349075317383
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.387 Vali Acc: 0.444 Test Loss: 3.387 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8614091873168945
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.487 Vali Acc: 0.417 Test Loss: 3.487 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0393710136413574
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.759 Vali Acc: 0.486 Test Loss: 3.759 Test Acc: 0.486
Validation loss decreased (-0.444413 --> -0.486074).  Saving model ...
Epoch: 12 cost time: 2.832885265350342
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.091 Vali Acc: 0.458 Test Loss: 4.091 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7711710929870605
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.554 Vali Acc: 0.417 Test Loss: 4.554 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.974313497543335
Epoch: 14, Steps: 7 | Train Loss: 0.044 Vali Loss: 4.581 Vali Acc: 0.431 Test Loss: 4.581 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.695479393005371
Epoch: 15, Steps: 7 | Train Loss: 0.178 Vali Loss: 6.080 Vali Acc: 0.444 Test Loss: 6.080 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8181631565093994
Epoch: 16, Steps: 7 | Train Loss: 0.113 Vali Loss: 7.363 Vali Acc: 0.389 Test Loss: 7.363 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8807406425476074
Epoch: 17, Steps: 7 | Train Loss: 0.191 Vali Loss: 8.090 Vali Acc: 0.431 Test Loss: 8.090 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0851993560791016
Epoch: 18, Steps: 7 | Train Loss: 0.582 Vali Loss: 13.686 Vali Acc: 0.222 Test Loss: 13.686 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7109503746032715
Epoch: 19, Steps: 7 | Train Loss: 0.161 Vali Loss: 11.390 Vali Acc: 0.306 Test Loss: 11.390 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8965256214141846
Epoch: 20, Steps: 7 | Train Loss: 0.537 Vali Loss: 7.385 Vali Acc: 0.458 Test Loss: 7.385 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.028337240219116
Epoch: 21, Steps: 7 | Train Loss: 0.331 Vali Loss: 7.079 Vali Acc: 0.403 Test Loss: 7.079 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.739659547805786
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.297 Vali Acc: 0.278 Test Loss: 2.297 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 2.463608503341675
Epoch: 2, Steps: 7 | Train Loss: 1.448 Vali Loss: 1.962 Vali Acc: 0.431 Test Loss: 1.962 Test Acc: 0.431
Validation loss decreased (-0.277755 --> -0.430536).  Saving model ...
Epoch: 3 cost time: 2.5606589317321777
Epoch: 3, Steps: 7 | Train Loss: 0.367 Vali Loss: 3.648 Vali Acc: 0.264 Test Loss: 3.648 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8033552169799805
Epoch: 4, Steps: 7 | Train Loss: 0.114 Vali Loss: 2.278 Vali Acc: 0.278 Test Loss: 2.278 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.490180015563965
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.972 Vali Acc: 0.375 Test Loss: 2.972 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.859126329421997
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.148 Vali Acc: 0.389 Test Loss: 3.148 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.666764736175537
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 4.071 Vali Acc: 0.458 Test Loss: 4.071 Test Acc: 0.458
Validation loss decreased (-0.430536 --> -0.458293).  Saving model ...
Epoch: 8 cost time: 2.572768211364746
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.265 Vali Acc: 0.431 Test Loss: 3.265 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4529457092285156
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 5.100 Vali Acc: 0.319 Test Loss: 5.100 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4715394973754883
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 4.223 Vali Acc: 0.431 Test Loss: 4.223 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6700377464294434
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.593 Vali Acc: 0.347 Test Loss: 4.593 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.512997627258301
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.857 Vali Acc: 0.389 Test Loss: 3.857 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.693490505218506
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.179 Vali Acc: 0.431 Test Loss: 3.179 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9885990619659424
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.908 Vali Acc: 0.431 Test Loss: 2.908 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.70501708984375
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.795 Vali Acc: 0.444 Test Loss: 2.795 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9727702140808105
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.748 Vali Acc: 0.458 Test Loss: 2.748 Test Acc: 0.458
Validation loss decreased (-0.458293 --> -0.458306).  Saving model ...
Epoch: 17 cost time: 2.671633005142212
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.735 Vali Acc: 0.458 Test Loss: 2.735 Test Acc: 0.458
Validation loss decreased (-0.458306 --> -0.458306).  Saving model ...
Epoch: 18 cost time: 2.9835379123687744
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.735 Vali Acc: 0.458 Test Loss: 2.735 Test Acc: 0.458
Validation loss decreased (-0.458306 --> -0.458306).  Saving model ...
Epoch: 19 cost time: 2.5200388431549072
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.746 Vali Acc: 0.458 Test Loss: 2.746 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.460149049758911
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.765 Vali Acc: 0.458 Test Loss: 2.765 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.512667417526245
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.781 Vali Acc: 0.444 Test Loss: 2.781 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5909788608551025
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.801 Vali Acc: 0.444 Test Loss: 2.801 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.699392795562744
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.444 Test Loss: 2.814 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.815215587615967
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.444 Test Loss: 2.828 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.943666696548462
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.444 Test Loss: 2.839 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7057912349700928
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.444 Test Loss: 2.845 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0240519046783447
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.849 Vali Acc: 0.444 Test Loss: 2.849 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7525153160095215
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.444 Test Loss: 2.854 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.035229682922363
Epoch: 1, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.396 Vali Acc: 0.167 Test Loss: 2.396 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 3.240518569946289
Epoch: 2, Steps: 7 | Train Loss: 1.511 Vali Loss: 2.130 Vali Acc: 0.472 Test Loss: 2.130 Test Acc: 0.472
Validation loss decreased (-0.166643 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 2.494194746017456
Epoch: 3, Steps: 7 | Train Loss: 0.393 Vali Loss: 3.670 Vali Acc: 0.222 Test Loss: 3.670 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8818130493164062
Epoch: 4, Steps: 7 | Train Loss: 0.136 Vali Loss: 2.812 Vali Acc: 0.208 Test Loss: 2.812 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.599128246307373
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.926 Vali Acc: 0.375 Test Loss: 2.926 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.816122531890869
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 3.393 Vali Acc: 0.347 Test Loss: 3.393 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7390236854553223
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.778 Vali Acc: 0.403 Test Loss: 3.778 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3538243770599365
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.730 Vali Acc: 0.403 Test Loss: 2.730 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.524768352508545
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.982 Vali Acc: 0.333 Test Loss: 3.982 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5740535259246826
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.638 Vali Acc: 0.375 Test Loss: 3.638 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6318325996398926
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.941 Vali Acc: 0.403 Test Loss: 2.941 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.485830545425415
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.715 Vali Acc: 0.417 Test Loss: 2.715 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9194374084472656
Epoch: 1, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.454 Vali Acc: 0.167 Test Loss: 2.454 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.5197367668151855
Epoch: 2, Steps: 7 | Train Loss: 1.796 Vali Loss: 2.417 Vali Acc: 0.222 Test Loss: 2.417 Test Acc: 0.222
Validation loss decreased (-0.166642 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 2.881873846054077
Epoch: 3, Steps: 7 | Train Loss: 0.780 Vali Loss: 3.626 Vali Acc: 0.236 Test Loss: 3.626 Test Acc: 0.236
Validation loss decreased (-0.222198 --> -0.236075).  Saving model ...
Epoch: 4 cost time: 2.398811101913452
Epoch: 4, Steps: 7 | Train Loss: 0.341 Vali Loss: 3.052 Vali Acc: 0.250 Test Loss: 3.052 Test Acc: 0.250
Validation loss decreased (-0.236075 --> -0.249969).  Saving model ...
Epoch: 5 cost time: 2.335024118423462
Epoch: 5, Steps: 7 | Train Loss: 0.121 Vali Loss: 3.570 Vali Acc: 0.097 Test Loss: 3.570 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.784950017929077
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 3.839 Vali Acc: 0.278 Test Loss: 3.839 Test Acc: 0.278
Validation loss decreased (-0.249969 --> -0.277739).  Saving model ...
Epoch: 7 cost time: 2.7119555473327637
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 4.175 Vali Acc: 0.097 Test Loss: 4.175 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9331119060516357
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 6.021 Vali Acc: 0.125 Test Loss: 6.021 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.666564702987671
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.612 Vali Acc: 0.292 Test Loss: 3.612 Test Acc: 0.292
Validation loss decreased (-0.277739 --> -0.291631).  Saving model ...
Epoch: 10 cost time: 2.7932727336883545
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.926 Vali Acc: 0.139 Test Loss: 4.926 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7036280632019043
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 7.715 Vali Acc: 0.097 Test Loss: 7.715 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.891829252243042
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.628 Vali Acc: 0.111 Test Loss: 6.628 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5655319690704346
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.092 Vali Acc: 0.250 Test Loss: 5.092 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6050150394439697
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.149 Vali Acc: 0.194 Test Loss: 5.149 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5823612213134766
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.974 Vali Acc: 0.194 Test Loss: 4.974 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7153685092926025
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.540 Vali Acc: 0.250 Test Loss: 4.540 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7647321224212646
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.215 Vali Acc: 0.278 Test Loss: 4.215 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.777888774871826
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.058 Vali Acc: 0.292 Test Loss: 4.058 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.773056983947754
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.983 Vali Acc: 0.292 Test Loss: 3.983 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9506216049194336
Epoch: 1, Steps: 7 | Train Loss: 2.527 Vali Loss: 2.389 Vali Acc: 0.250 Test Loss: 2.389 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 2.3599634170532227
Epoch: 2, Steps: 7 | Train Loss: 1.732 Vali Loss: 2.751 Vali Acc: 0.236 Test Loss: 2.751 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.744675397872925
Epoch: 3, Steps: 7 | Train Loss: 0.770 Vali Loss: 3.390 Vali Acc: 0.250 Test Loss: 3.390 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6612491607666016
Epoch: 4, Steps: 7 | Train Loss: 0.318 Vali Loss: 3.830 Vali Acc: 0.236 Test Loss: 3.830 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.602174997329712
Epoch: 5, Steps: 7 | Train Loss: 0.200 Vali Loss: 4.188 Vali Acc: 0.194 Test Loss: 4.188 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.824183464050293
Epoch: 6, Steps: 7 | Train Loss: 0.070 Vali Loss: 5.687 Vali Acc: 0.167 Test Loss: 5.687 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.792858123779297
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 5.537 Vali Acc: 0.236 Test Loss: 5.537 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.577214479446411
Epoch: 8, Steps: 7 | Train Loss: 0.061 Vali Loss: 5.759 Vali Acc: 0.236 Test Loss: 5.759 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.746793746948242
Epoch: 9, Steps: 7 | Train Loss: 0.050 Vali Loss: 6.033 Vali Acc: 0.236 Test Loss: 6.033 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8331663608551025
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 5.726 Vali Acc: 0.292 Test Loss: 5.726 Test Acc: 0.292
Validation loss decreased (-0.249976 --> -0.291609).  Saving model ...
Epoch: 11 cost time: 3.0178887844085693
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 5.252 Vali Acc: 0.278 Test Loss: 5.252 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.685777425765991
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.455 Vali Acc: 0.292 Test Loss: 5.455 Test Acc: 0.292
Validation loss decreased (-0.291609 --> -0.291612).  Saving model ...
Epoch: 13 cost time: 2.769024133682251
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.638 Vali Acc: 0.306 Test Loss: 5.638 Test Acc: 0.306
Validation loss decreased (-0.291612 --> -0.305499).  Saving model ...
Epoch: 14 cost time: 2.846980333328247
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.771 Vali Acc: 0.292 Test Loss: 5.771 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.782585859298706
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.819 Vali Acc: 0.306 Test Loss: 5.819 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6705682277679443
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.764 Vali Acc: 0.292 Test Loss: 5.764 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.596381425857544
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.714 Vali Acc: 0.292 Test Loss: 5.714 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.876857042312622
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.656 Vali Acc: 0.292 Test Loss: 5.656 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6193408966064453
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.611 Vali Acc: 0.292 Test Loss: 5.611 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8933191299438477
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.562 Vali Acc: 0.292 Test Loss: 5.562 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.7749173641204834
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.523 Vali Acc: 0.278 Test Loss: 5.523 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.590280532836914
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.520 Vali Acc: 0.278 Test Loss: 5.520 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.638935089111328
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.523 Vali Acc: 0.278 Test Loss: 5.523 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3055555555555556
model parameter : 7102220
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.129709959030151
Epoch: 1, Steps: 7 | Train Loss: 2.407 Vali Loss: 1.400 Vali Acc: 0.736 Test Loss: 1.400 Test Acc: 0.736
Validation loss decreased (inf --> -0.736097).  Saving model ...
Epoch: 2 cost time: 4.875402212142944
Epoch: 2, Steps: 7 | Train Loss: 0.487 Vali Loss: 1.097 Vali Acc: 0.792 Test Loss: 1.097 Test Acc: 0.792
Validation loss decreased (-0.736097 --> -0.791656).  Saving model ...
Epoch: 3 cost time: 4.954700708389282
Epoch: 3, Steps: 7 | Train Loss: 0.022 Vali Loss: 1.308 Vali Acc: 0.806 Test Loss: 1.308 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805542).  Saving model ...
Epoch: 4 cost time: 4.274750709533691
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.772 Vali Acc: 0.806 Test Loss: 1.772 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.6060004234313965
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.996 Vali Acc: 0.750 Test Loss: 2.996 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.928086996078491
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.558 Vali Acc: 0.806 Test Loss: 2.558 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.676845550537109
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.433 Vali Acc: 0.806 Test Loss: 2.433 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7230119705200195
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.259 Vali Acc: 0.750 Test Loss: 3.259 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.314295530319214
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.883 Vali Acc: 0.722 Test Loss: 2.883 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.13481593132019
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.860 Vali Acc: 0.764 Test Loss: 2.860 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.805479049682617
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.922 Vali Acc: 0.764 Test Loss: 2.922 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.534093379974365
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.953 Vali Acc: 0.764 Test Loss: 2.953 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.480292558670044
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.932 Vali Acc: 0.764 Test Loss: 2.932 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8055555555555556
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.475645303726196
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 1.632 Vali Acc: 0.583 Test Loss: 1.632 Test Acc: 0.583
Validation loss decreased (inf --> -0.583317).  Saving model ...
Epoch: 2 cost time: 4.2003703117370605
Epoch: 2, Steps: 7 | Train Loss: 0.648 Vali Loss: 1.068 Vali Acc: 0.792 Test Loss: 1.068 Test Acc: 0.792
Validation loss decreased (-0.583317 --> -0.791656).  Saving model ...
Epoch: 3 cost time: 4.432345390319824
Epoch: 3, Steps: 7 | Train Loss: 0.045 Vali Loss: 1.251 Vali Acc: 0.736 Test Loss: 1.251 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.536056280136108
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.345 Vali Acc: 0.778 Test Loss: 1.345 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.488846778869629
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.503 Vali Acc: 0.736 Test Loss: 1.503 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.330021381378174
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.778 Test Loss: 1.792 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.087294340133667
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.859 Vali Acc: 0.708 Test Loss: 1.859 Test Acc: 0.708
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8184688091278076
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 1.913 Vali Acc: 0.667 Test Loss: 1.913 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.851475715637207
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.681 Test Loss: 1.934 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.236065626144409
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.242 Vali Acc: 0.736 Test Loss: 2.242 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.60766863822937
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.436 Vali Acc: 0.681 Test Loss: 4.436 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.729700803756714
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.219 Vali Acc: 0.750 Test Loss: 2.219 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7916666666666666
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.307792901992798
Epoch: 1, Steps: 7 | Train Loss: 2.511 Vali Loss: 1.900 Vali Acc: 0.500 Test Loss: 1.900 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 4.096679210662842
Epoch: 2, Steps: 7 | Train Loss: 0.871 Vali Loss: 1.502 Vali Acc: 0.625 Test Loss: 1.502 Test Acc: 0.625
Validation loss decreased (-0.499981 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 3.616337776184082
Epoch: 3, Steps: 7 | Train Loss: 0.113 Vali Loss: 1.511 Vali Acc: 0.681 Test Loss: 1.511 Test Acc: 0.681
Validation loss decreased (-0.624985 --> -0.680540).  Saving model ...
Epoch: 4 cost time: 4.073370695114136
Epoch: 4, Steps: 7 | Train Loss: 0.053 Vali Loss: 1.419 Vali Acc: 0.681 Test Loss: 1.419 Test Acc: 0.681
Validation loss decreased (-0.680540 --> -0.680541).  Saving model ...
Epoch: 5 cost time: 3.5826988220214844
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.184 Vali Acc: 0.736 Test Loss: 1.184 Test Acc: 0.736
Validation loss decreased (-0.680541 --> -0.736099).  Saving model ...
Epoch: 6 cost time: 3.793504476547241
Epoch: 6, Steps: 7 | Train Loss: 0.114 Vali Loss: 1.230 Vali Acc: 0.750 Test Loss: 1.230 Test Acc: 0.750
Validation loss decreased (-0.736099 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 3.5472280979156494
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.108 Vali Acc: 0.681 Test Loss: 2.108 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2039289474487305
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.460 Vali Acc: 0.694 Test Loss: 2.460 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.538400888442993
Epoch: 9, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.366 Vali Acc: 0.653 Test Loss: 2.366 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6463546752929688
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.824 Vali Acc: 0.778 Test Loss: 1.824 Test Acc: 0.778
Validation loss decreased (-0.749988 --> -0.777760).  Saving model ...
Epoch: 11 cost time: 4.421061754226685
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.306 Vali Acc: 0.611 Test Loss: 3.306 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.639723062515259
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.692 Vali Acc: 0.708 Test Loss: 2.692 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.799966335296631
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.959 Vali Acc: 0.639 Test Loss: 2.959 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0027151107788086
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.686 Vali Acc: 0.694 Test Loss: 2.686 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7015702724456787
Epoch: 15, Steps: 7 | Train Loss: 0.143 Vali Loss: 4.066 Vali Acc: 0.694 Test Loss: 4.066 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4996631145477295
Epoch: 16, Steps: 7 | Train Loss: 0.517 Vali Loss: 3.715 Vali Acc: 0.639 Test Loss: 3.715 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4589686393737793
Epoch: 17, Steps: 7 | Train Loss: 0.044 Vali Loss: 3.512 Vali Acc: 0.681 Test Loss: 3.512 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.562931776046753
Epoch: 18, Steps: 7 | Train Loss: 0.043 Vali Loss: 6.783 Vali Acc: 0.597 Test Loss: 6.783 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6127023696899414
Epoch: 19, Steps: 7 | Train Loss: 0.279 Vali Loss: 4.228 Vali Acc: 0.681 Test Loss: 4.228 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.031318187713623
Epoch: 20, Steps: 7 | Train Loss: 0.206 Vali Loss: 7.278 Vali Acc: 0.556 Test Loss: 7.278 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.956164598464966
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.094 Vali Acc: 0.375 Test Loss: 2.094 Test Acc: 0.375
Validation loss decreased (inf --> -0.374979).  Saving model ...
Epoch: 2 cost time: 3.0187935829162598
Epoch: 2, Steps: 7 | Train Loss: 1.018 Vali Loss: 1.873 Vali Acc: 0.431 Test Loss: 1.873 Test Acc: 0.431
Validation loss decreased (-0.374979 --> -0.430537).  Saving model ...
Epoch: 3 cost time: 2.959954261779785
Epoch: 3, Steps: 7 | Train Loss: 0.111 Vali Loss: 2.013 Vali Acc: 0.542 Test Loss: 2.013 Test Acc: 0.542
Validation loss decreased (-0.430537 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 3.3551721572875977
Epoch: 4, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.755 Vali Acc: 0.625 Test Loss: 1.755 Test Acc: 0.625
Validation loss decreased (-0.541647 --> -0.624982).  Saving model ...
Epoch: 5 cost time: 3.572725296020508
Epoch: 5, Steps: 7 | Train Loss: 0.021 Vali Loss: 2.803 Vali Acc: 0.514 Test Loss: 2.803 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.105886936187744
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 3.070 Vali Acc: 0.597 Test Loss: 3.070 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6159415245056152
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.914 Vali Acc: 0.583 Test Loss: 2.914 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1849026679992676
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.623 Vali Acc: 0.611 Test Loss: 2.623 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3586244583129883
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.678 Vali Acc: 0.625 Test Loss: 2.678 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8036906719207764
Epoch: 10, Steps: 7 | Train Loss: 0.103 Vali Loss: 2.869 Vali Acc: 0.583 Test Loss: 2.869 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.295135736465454
Epoch: 11, Steps: 7 | Train Loss: 0.102 Vali Loss: 4.012 Vali Acc: 0.583 Test Loss: 4.012 Test Acc: 0.583
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2057785987854004
Epoch: 12, Steps: 7 | Train Loss: 0.041 Vali Loss: 3.765 Vali Acc: 0.625 Test Loss: 3.765 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7987959384918213
Epoch: 13, Steps: 7 | Train Loss: 0.180 Vali Loss: 4.402 Vali Acc: 0.611 Test Loss: 4.402 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.432771921157837
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 3.626 Vali Acc: 0.653 Test Loss: 3.626 Test Acc: 0.653
Validation loss decreased (-0.624982 --> -0.652742).  Saving model ...
Epoch: 15 cost time: 3.811760902404785
Epoch: 15, Steps: 7 | Train Loss: 0.043 Vali Loss: 4.078 Vali Acc: 0.569 Test Loss: 4.078 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3639636039733887
Epoch: 16, Steps: 7 | Train Loss: 0.175 Vali Loss: 5.758 Vali Acc: 0.597 Test Loss: 5.758 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.603278636932373
Epoch: 17, Steps: 7 | Train Loss: 0.148 Vali Loss: 6.031 Vali Acc: 0.486 Test Loss: 6.031 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.004897356033325
Epoch: 18, Steps: 7 | Train Loss: 0.355 Vali Loss: 8.323 Vali Acc: 0.542 Test Loss: 8.323 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3316402435302734
Epoch: 19, Steps: 7 | Train Loss: 0.172 Vali Loss: 10.239 Vali Acc: 0.542 Test Loss: 10.239 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.163266897201538
Epoch: 20, Steps: 7 | Train Loss: 0.254 Vali Loss: 6.479 Vali Acc: 0.569 Test Loss: 6.479 Test Acc: 0.569
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.646484375
Epoch: 21, Steps: 7 | Train Loss: 0.330 Vali Loss: 9.634 Vali Acc: 0.486 Test Loss: 9.634 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.5720393657684326
Epoch: 22, Steps: 7 | Train Loss: 0.646 Vali Loss: 12.262 Vali Acc: 0.444 Test Loss: 12.262 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4718873500823975
Epoch: 23, Steps: 7 | Train Loss: 0.347 Vali Loss: 11.943 Vali Acc: 0.389 Test Loss: 11.943 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.280158281326294
Epoch: 24, Steps: 7 | Train Loss: 0.156 Vali Loss: 14.462 Vali Acc: 0.486 Test Loss: 14.462 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6527777777777778
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.170125484466553
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.231 Vali Acc: 0.208 Test Loss: 2.231 Test Acc: 0.208
Validation loss decreased (inf --> -0.208311).  Saving model ...
Epoch: 2 cost time: 2.8430392742156982
Epoch: 2, Steps: 7 | Train Loss: 1.152 Vali Loss: 2.434 Vali Acc: 0.306 Test Loss: 2.434 Test Acc: 0.306
Validation loss decreased (-0.208311 --> -0.305531).  Saving model ...
Epoch: 3 cost time: 3.0102405548095703
Epoch: 3, Steps: 7 | Train Loss: 0.196 Vali Loss: 2.986 Vali Acc: 0.347 Test Loss: 2.986 Test Acc: 0.347
Validation loss decreased (-0.305531 --> -0.347192).  Saving model ...
Epoch: 4 cost time: 2.6377112865448
Epoch: 4, Steps: 7 | Train Loss: 0.106 Vali Loss: 3.302 Vali Acc: 0.319 Test Loss: 3.302 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.787797689437866
Epoch: 5, Steps: 7 | Train Loss: 0.022 Vali Loss: 3.442 Vali Acc: 0.292 Test Loss: 3.442 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3828017711639404
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 4.153 Vali Acc: 0.333 Test Loss: 4.153 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9793128967285156
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 6.387 Vali Acc: 0.319 Test Loss: 6.387 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7925615310668945
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 5.035 Vali Acc: 0.417 Test Loss: 5.035 Test Acc: 0.417
Validation loss decreased (-0.347192 --> -0.416616).  Saving model ...
Epoch: 9 cost time: 2.818380117416382
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.810 Vali Acc: 0.361 Test Loss: 4.810 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.480006694793701
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 5.209 Vali Acc: 0.389 Test Loss: 5.209 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.892554521560669
Epoch: 11, Steps: 7 | Train Loss: 0.131 Vali Loss: 7.431 Vali Acc: 0.292 Test Loss: 7.431 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8408796787261963
Epoch: 12, Steps: 7 | Train Loss: 0.412 Vali Loss: 7.277 Vali Acc: 0.389 Test Loss: 7.277 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1795592308044434
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 9.635 Vali Acc: 0.319 Test Loss: 9.635 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8955514430999756
Epoch: 14, Steps: 7 | Train Loss: 0.283 Vali Loss: 8.865 Vali Acc: 0.292 Test Loss: 8.865 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3874289989471436
Epoch: 15, Steps: 7 | Train Loss: 0.113 Vali Loss: 14.035 Vali Acc: 0.236 Test Loss: 14.035 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8419599533081055
Epoch: 16, Steps: 7 | Train Loss: 0.490 Vali Loss: 12.274 Vali Acc: 0.347 Test Loss: 12.274 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.106247901916504
Epoch: 17, Steps: 7 | Train Loss: 0.202 Vali Loss: 13.309 Vali Acc: 0.236 Test Loss: 13.309 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7132725715637207
Epoch: 18, Steps: 7 | Train Loss: 0.509 Vali Loss: 18.132 Vali Acc: 0.347 Test Loss: 18.132 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9495410919189453
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.228 Vali Acc: 0.222 Test Loss: 2.228 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 2.7806050777435303
Epoch: 2, Steps: 7 | Train Loss: 1.287 Vali Loss: 2.123 Vali Acc: 0.306 Test Loss: 2.123 Test Acc: 0.306
Validation loss decreased (-0.222200 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 2.655970573425293
Epoch: 3, Steps: 7 | Train Loss: 0.268 Vali Loss: 2.965 Vali Acc: 0.389 Test Loss: 2.965 Test Acc: 0.389
Validation loss decreased (-0.305534 --> -0.388859).  Saving model ...
Epoch: 4 cost time: 2.916299343109131
Epoch: 4, Steps: 7 | Train Loss: 0.058 Vali Loss: 2.403 Vali Acc: 0.444 Test Loss: 2.403 Test Acc: 0.444
Validation loss decreased (-0.388859 --> -0.444420).  Saving model ...
Epoch: 5 cost time: 2.9082210063934326
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.151 Vali Acc: 0.458 Test Loss: 3.151 Test Acc: 0.458
Validation loss decreased (-0.444420 --> -0.458302).  Saving model ...
Epoch: 6 cost time: 3.0374767780303955
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.654 Vali Acc: 0.472 Test Loss: 2.654 Test Acc: 0.472
Validation loss decreased (-0.458302 --> -0.472196).  Saving model ...
Epoch: 7 cost time: 2.492107629776001
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.623 Vali Acc: 0.500 Test Loss: 2.623 Test Acc: 0.500
Validation loss decreased (-0.472196 --> -0.499974).  Saving model ...
Epoch: 8 cost time: 2.5723068714141846
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.755 Vali Acc: 0.500 Test Loss: 2.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.374147415161133
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.909 Vali Acc: 0.514 Test Loss: 2.909 Test Acc: 0.514
Validation loss decreased (-0.499974 --> -0.513860).  Saving model ...
Epoch: 10 cost time: 2.7011682987213135
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.086 Vali Acc: 0.500 Test Loss: 3.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9304757118225098
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.181 Vali Acc: 0.472 Test Loss: 3.181 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.781648874282837
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.221 Vali Acc: 0.444 Test Loss: 3.221 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6203694343566895
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.209 Vali Acc: 0.444 Test Loss: 3.209 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9024975299835205
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.168 Vali Acc: 0.444 Test Loss: 3.168 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.869218587875366
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.126 Vali Acc: 0.444 Test Loss: 3.126 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.641343593597412
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.100 Vali Acc: 0.444 Test Loss: 3.100 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.735163450241089
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.089 Vali Acc: 0.444 Test Loss: 3.089 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.709688186645508
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.081 Vali Acc: 0.444 Test Loss: 3.081 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.883188247680664
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.071 Vali Acc: 0.444 Test Loss: 3.071 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5138888888888888
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9751224517822266
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.242 Vali Acc: 0.208 Test Loss: 2.242 Test Acc: 0.208
Validation loss decreased (inf --> -0.208311).  Saving model ...
Epoch: 2 cost time: 2.873997688293457
Epoch: 2, Steps: 7 | Train Loss: 1.416 Vali Loss: 2.229 Vali Acc: 0.236 Test Loss: 2.229 Test Acc: 0.236
Validation loss decreased (-0.208311 --> -0.236089).  Saving model ...
Epoch: 3 cost time: 2.5334997177124023
Epoch: 3, Steps: 7 | Train Loss: 0.321 Vali Loss: 3.062 Vali Acc: 0.333 Test Loss: 3.062 Test Acc: 0.333
Validation loss decreased (-0.236089 --> -0.333303).  Saving model ...
Epoch: 4 cost time: 3.065011978149414
Epoch: 4, Steps: 7 | Train Loss: 0.135 Vali Loss: 2.436 Vali Acc: 0.292 Test Loss: 2.436 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.098069190979004
Epoch: 5, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.814 Vali Acc: 0.319 Test Loss: 2.814 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.768819808959961
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.075 Vali Acc: 0.361 Test Loss: 2.075 Test Acc: 0.361
Validation loss decreased (-0.333303 --> -0.361090).  Saving model ...
Epoch: 7 cost time: 2.564486503601074
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.721 Vali Acc: 0.375 Test Loss: 3.721 Test Acc: 0.375
Validation loss decreased (-0.361090 --> -0.374963).  Saving model ...
Epoch: 8 cost time: 2.7147018909454346
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.415 Vali Acc: 0.347 Test Loss: 4.415 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7461278438568115
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.202 Vali Acc: 0.389 Test Loss: 3.202 Test Acc: 0.389
Validation loss decreased (-0.374963 --> -0.388857).  Saving model ...
Epoch: 10 cost time: 2.822559356689453
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.440 Vali Acc: 0.403 Test Loss: 2.440 Test Acc: 0.403
Validation loss decreased (-0.388857 --> -0.402753).  Saving model ...
Epoch: 11 cost time: 2.8110544681549072
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.403 Test Loss: 2.284 Test Acc: 0.403
Validation loss decreased (-0.402753 --> -0.402755).  Saving model ...
Epoch: 12 cost time: 2.853090763092041
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.444 Test Loss: 2.296 Test Acc: 0.444
Validation loss decreased (-0.402755 --> -0.444421).  Saving model ...
Epoch: 13 cost time: 2.8658323287963867
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.286 Vali Acc: 0.458 Test Loss: 2.286 Test Acc: 0.458
Validation loss decreased (-0.444421 --> -0.458310).  Saving model ...
Epoch: 14 cost time: 2.6621782779693604
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.444 Test Loss: 2.296 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.595463991165161
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.458 Test Loss: 2.331 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7462692260742188
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.458 Test Loss: 2.373 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.778310537338257
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.403 Vali Acc: 0.458 Test Loss: 2.403 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7452521324157715
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.420 Vali Acc: 0.458 Test Loss: 2.420 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.994016408920288
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.434 Vali Acc: 0.458 Test Loss: 2.434 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.743903875350952
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.431 Test Loss: 2.449 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6041905879974365
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.431 Test Loss: 2.461 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0711257457733154
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.480 Vali Acc: 0.431 Test Loss: 2.480 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.101426601409912
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.493 Vali Acc: 0.431 Test Loss: 2.493 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6230807304382324
Epoch: 1, Steps: 7 | Train Loss: 2.625 Vali Loss: 2.304 Vali Acc: 0.181 Test Loss: 2.304 Test Acc: 0.181
Validation loss decreased (inf --> -0.180533).  Saving model ...
Epoch: 2 cost time: 2.558330774307251
Epoch: 2, Steps: 7 | Train Loss: 1.537 Vali Loss: 2.415 Vali Acc: 0.236 Test Loss: 2.415 Test Acc: 0.236
Validation loss decreased (-0.180533 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 2.7027716636657715
Epoch: 3, Steps: 7 | Train Loss: 0.376 Vali Loss: 2.954 Vali Acc: 0.306 Test Loss: 2.954 Test Acc: 0.306
Validation loss decreased (-0.236087 --> -0.305526).  Saving model ...
Epoch: 4 cost time: 2.4466238021850586
Epoch: 4, Steps: 7 | Train Loss: 0.123 Vali Loss: 2.857 Vali Acc: 0.264 Test Loss: 2.857 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6852309703826904
Epoch: 5, Steps: 7 | Train Loss: 0.022 Vali Loss: 3.471 Vali Acc: 0.347 Test Loss: 3.471 Test Acc: 0.347
Validation loss decreased (-0.305526 --> -0.347188).  Saving model ...
Epoch: 6 cost time: 2.814889907836914
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.069 Vali Acc: 0.319 Test Loss: 3.069 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.493037700653076
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 4.696 Vali Acc: 0.361 Test Loss: 4.696 Test Acc: 0.361
Validation loss decreased (-0.347188 --> -0.361064).  Saving model ...
Epoch: 8 cost time: 2.4571287631988525
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.550 Vali Acc: 0.444 Test Loss: 5.550 Test Acc: 0.444
Validation loss decreased (-0.361064 --> -0.444389).  Saving model ...
Epoch: 9 cost time: 2.652360677719116
Epoch: 9, Steps: 7 | Train Loss: 0.064 Vali Loss: 3.778 Vali Acc: 0.431 Test Loss: 3.778 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5322318077087402
Epoch: 10, Steps: 7 | Train Loss: 0.064 Vali Loss: 4.290 Vali Acc: 0.431 Test Loss: 4.290 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4133658409118652
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.072 Vali Acc: 0.431 Test Loss: 4.072 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6318228244781494
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.720 Vali Acc: 0.444 Test Loss: 3.720 Test Acc: 0.444
Validation loss decreased (-0.444389 --> -0.444407).  Saving model ...
Epoch: 13 cost time: 2.679136037826538
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.608 Vali Acc: 0.444 Test Loss: 4.608 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.577470541000366
Epoch: 14, Steps: 7 | Train Loss: 0.030 Vali Loss: 3.328 Vali Acc: 0.444 Test Loss: 3.328 Test Acc: 0.444
Validation loss decreased (-0.444407 --> -0.444411).  Saving model ...
Epoch: 15 cost time: 2.6947147846221924
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.589 Vali Acc: 0.472 Test Loss: 3.589 Test Acc: 0.472
Validation loss decreased (-0.444411 --> -0.472186).  Saving model ...
Epoch: 16 cost time: 2.640723943710327
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.692 Vali Acc: 0.472 Test Loss: 3.692 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6649060249328613
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.881 Vali Acc: 0.472 Test Loss: 3.881 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.687263250350952
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.534 Vali Acc: 0.500 Test Loss: 3.534 Test Acc: 0.500
Validation loss decreased (-0.472186 --> -0.499965).  Saving model ...
Epoch: 19 cost time: 2.652730941772461
Epoch: 19, Steps: 7 | Train Loss: 0.292 Vali Loss: 4.743 Vali Acc: 0.514 Test Loss: 4.743 Test Acc: 0.514
Validation loss decreased (-0.499965 --> -0.513841).  Saving model ...
Epoch: 20 cost time: 2.609135389328003
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.337 Vali Acc: 0.361 Test Loss: 5.337 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.516038417816162
Epoch: 21, Steps: 7 | Train Loss: 0.133 Vali Loss: 6.307 Vali Acc: 0.444 Test Loss: 6.307 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6222808361053467
Epoch: 22, Steps: 7 | Train Loss: 0.566 Vali Loss: 8.069 Vali Acc: 0.375 Test Loss: 8.069 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9292709827423096
Epoch: 23, Steps: 7 | Train Loss: 0.024 Vali Loss: 10.324 Vali Acc: 0.264 Test Loss: 10.324 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.56775164604187
Epoch: 24, Steps: 7 | Train Loss: 0.025 Vali Loss: 10.629 Vali Acc: 0.264 Test Loss: 10.629 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8559961318969727
Epoch: 25, Steps: 7 | Train Loss: 0.041 Vali Loss: 11.075 Vali Acc: 0.375 Test Loss: 11.075 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7390682697296143
Epoch: 26, Steps: 7 | Train Loss: 0.179 Vali Loss: 12.212 Vali Acc: 0.472 Test Loss: 12.212 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.6131091117858887
Epoch: 27, Steps: 7 | Train Loss: 0.063 Vali Loss: 10.666 Vali Acc: 0.375 Test Loss: 10.666 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7450475692749023
Epoch: 28, Steps: 7 | Train Loss: 0.029 Vali Loss: 11.075 Vali Acc: 0.389 Test Loss: 11.075 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5740556716918945
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 12.417 Vali Acc: 0.278 Test Loss: 12.417 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5138888888888888
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.068503141403198
Epoch: 1, Steps: 7 | Train Loss: 2.582 Vali Loss: 2.365 Vali Acc: 0.139 Test Loss: 2.365 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.626927375793457
Epoch: 2, Steps: 7 | Train Loss: 1.825 Vali Loss: 2.678 Vali Acc: 0.153 Test Loss: 2.678 Test Acc: 0.153
Validation loss decreased (-0.138865 --> -0.152751).  Saving model ...
Epoch: 3 cost time: 2.910076141357422
Epoch: 3, Steps: 7 | Train Loss: 0.791 Vali Loss: 3.024 Vali Acc: 0.194 Test Loss: 3.024 Test Acc: 0.194
Validation loss decreased (-0.152751 --> -0.194414).  Saving model ...
Epoch: 4 cost time: 2.5325560569763184
Epoch: 4, Steps: 7 | Train Loss: 0.344 Vali Loss: 2.887 Vali Acc: 0.208 Test Loss: 2.887 Test Acc: 0.208
Validation loss decreased (-0.194414 --> -0.208304).  Saving model ...
Epoch: 5 cost time: 2.7372207641601562
Epoch: 5, Steps: 7 | Train Loss: 0.052 Vali Loss: 3.417 Vali Acc: 0.097 Test Loss: 3.417 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.551514148712158
Epoch: 6, Steps: 7 | Train Loss: 0.021 Vali Loss: 3.076 Vali Acc: 0.167 Test Loss: 3.076 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5745537281036377
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.792 Vali Acc: 0.125 Test Loss: 3.792 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4246649742126465
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.626 Vali Acc: 0.181 Test Loss: 3.626 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5115866661071777
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 6.381 Vali Acc: 0.111 Test Loss: 6.381 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3313920497894287
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.753 Vali Acc: 0.250 Test Loss: 3.753 Test Acc: 0.250
Validation loss decreased (-0.208304 --> -0.249962).  Saving model ...
Epoch: 11 cost time: 2.6809163093566895
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.341 Vali Acc: 0.264 Test Loss: 3.341 Test Acc: 0.264
Validation loss decreased (-0.249962 --> -0.263855).  Saving model ...
Epoch: 12 cost time: 2.628089189529419
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.009 Vali Acc: 0.347 Test Loss: 3.009 Test Acc: 0.347
Validation loss decreased (-0.263855 --> -0.347192).  Saving model ...
Epoch: 13 cost time: 2.724111795425415
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.212 Vali Acc: 0.306 Test Loss: 3.212 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5576469898223877
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.862 Vali Acc: 0.139 Test Loss: 3.862 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7604453563690186
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.370 Vali Acc: 0.125 Test Loss: 4.370 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.475893497467041
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.564 Vali Acc: 0.125 Test Loss: 4.564 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.332587242126465
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.543 Vali Acc: 0.125 Test Loss: 4.543 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5645153522491455
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.422 Vali Acc: 0.125 Test Loss: 4.422 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4421181678771973
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.256 Vali Acc: 0.125 Test Loss: 4.256 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6312673091888428
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.107 Vali Acc: 0.125 Test Loss: 4.107 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7302870750427246
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.995 Vali Acc: 0.139 Test Loss: 3.995 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.550623655319214
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.907 Vali Acc: 0.139 Test Loss: 3.907 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3472222222222222
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.007257461547852
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.402 Vali Acc: 0.222 Test Loss: 2.402 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 2.5214836597442627
Epoch: 2, Steps: 7 | Train Loss: 1.815 Vali Loss: 3.375 Vali Acc: 0.181 Test Loss: 3.375 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6174163818359375
Epoch: 3, Steps: 7 | Train Loss: 0.910 Vali Loss: 2.905 Vali Acc: 0.264 Test Loss: 2.905 Test Acc: 0.264
Validation loss decreased (-0.222198 --> -0.263860).  Saving model ...
Epoch: 4 cost time: 2.5764119625091553
Epoch: 4, Steps: 7 | Train Loss: 0.319 Vali Loss: 3.016 Vali Acc: 0.236 Test Loss: 3.016 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6598758697509766
Epoch: 5, Steps: 7 | Train Loss: 0.079 Vali Loss: 3.598 Vali Acc: 0.222 Test Loss: 3.598 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4952502250671387
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 3.923 Vali Acc: 0.194 Test Loss: 3.923 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6389148235321045
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 4.940 Vali Acc: 0.153 Test Loss: 4.940 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7285473346710205
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 5.123 Vali Acc: 0.292 Test Loss: 5.123 Test Acc: 0.292
Validation loss decreased (-0.263860 --> -0.291615).  Saving model ...
Epoch: 9 cost time: 2.6485655307769775
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 5.504 Vali Acc: 0.194 Test Loss: 5.504 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8470704555511475
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.462 Vali Acc: 0.181 Test Loss: 5.462 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4461190700531006
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.999 Vali Acc: 0.208 Test Loss: 4.999 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.656388759613037
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.064 Vali Acc: 0.222 Test Loss: 5.064 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.444338321685791
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.461 Vali Acc: 0.208 Test Loss: 5.461 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5393571853637695
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.598 Vali Acc: 0.236 Test Loss: 5.598 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.522395610809326
Epoch: 15, Steps: 7 | Train Loss: 0.026 Vali Loss: 5.893 Vali Acc: 0.250 Test Loss: 5.893 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5064666271209717
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.047 Vali Acc: 0.278 Test Loss: 6.047 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.949824094772339
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.004 Vali Acc: 0.264 Test Loss: 6.004 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.694868564605713
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.098 Vali Acc: 0.236 Test Loss: 6.098 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 6709004
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.016122579574585
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 1.735 Vali Acc: 0.611 Test Loss: 1.735 Test Acc: 0.611
Validation loss decreased (inf --> -0.611094).  Saving model ...
Epoch: 2 cost time: 4.0093770027160645
Epoch: 2, Steps: 7 | Train Loss: 0.665 Vali Loss: 1.093 Vali Acc: 0.750 Test Loss: 1.093 Test Acc: 0.750
Validation loss decreased (-0.611094 --> -0.749989).  Saving model ...
Epoch: 3 cost time: 4.587014436721802
Epoch: 3, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.741 Vali Acc: 0.736 Test Loss: 1.741 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.403415203094482
Epoch: 4, Steps: 7 | Train Loss: 0.031 Vali Loss: 1.236 Vali Acc: 0.861 Test Loss: 1.236 Test Acc: 0.861
Validation loss decreased (-0.749989 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 5.0838422775268555
Epoch: 5, Steps: 7 | Train Loss: 0.036 Vali Loss: 2.218 Vali Acc: 0.750 Test Loss: 2.218 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.663107872009277
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.612 Vali Acc: 0.778 Test Loss: 2.612 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.131709337234497
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.798 Vali Acc: 0.778 Test Loss: 2.798 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.14259934425354
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.243 Vali Acc: 0.819 Test Loss: 2.243 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.328434228897095
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.847 Test Loss: 2.075 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1631433963775635
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.024 Vali Acc: 0.847 Test Loss: 2.024 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.961858034133911
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.847 Test Loss: 2.003 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.856727838516235
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.847 Test Loss: 1.992 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.803119421005249
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.847 Test Loss: 1.986 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.659902095794678
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.847 Test Loss: 1.982 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.966058969497681
Epoch: 1, Steps: 7 | Train Loss: 2.604 Vali Loss: 1.934 Vali Acc: 0.556 Test Loss: 1.934 Test Acc: 0.556
Validation loss decreased (inf --> -0.555536).  Saving model ...
Epoch: 2 cost time: 3.991408109664917
Epoch: 2, Steps: 7 | Train Loss: 0.833 Vali Loss: 1.069 Vali Acc: 0.722 Test Loss: 1.069 Test Acc: 0.722
Validation loss decreased (-0.555536 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 3.748875141143799
Epoch: 3, Steps: 7 | Train Loss: 0.091 Vali Loss: 1.864 Vali Acc: 0.694 Test Loss: 1.864 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.328176259994507
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.167 Vali Acc: 0.778 Test Loss: 1.167 Test Acc: 0.778
Validation loss decreased (-0.722212 --> -0.777766).  Saving model ...
Epoch: 5 cost time: 4.341737508773804
Epoch: 5, Steps: 7 | Train Loss: 0.024 Vali Loss: 3.321 Vali Acc: 0.625 Test Loss: 3.321 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.618873119354248
Epoch: 6, Steps: 7 | Train Loss: 0.071 Vali Loss: 2.524 Vali Acc: 0.764 Test Loss: 2.524 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.905461072921753
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.802 Vali Acc: 0.722 Test Loss: 2.802 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3922247886657715
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 3.779 Vali Acc: 0.653 Test Loss: 3.779 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.520070791244507
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.883 Vali Acc: 0.625 Test Loss: 3.883 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.77677583694458
Epoch: 10, Steps: 7 | Train Loss: 0.096 Vali Loss: 2.578 Vali Acc: 0.736 Test Loss: 2.578 Test Acc: 0.736
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.2733070850372314
Epoch: 11, Steps: 7 | Train Loss: 0.090 Vali Loss: 3.073 Vali Acc: 0.681 Test Loss: 3.073 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.8742475509643555
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 3.676 Vali Acc: 0.694 Test Loss: 3.676 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.755800724029541
Epoch: 13, Steps: 7 | Train Loss: 0.086 Vali Loss: 3.799 Vali Acc: 0.708 Test Loss: 3.799 Test Acc: 0.708
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2737784385681152
Epoch: 14, Steps: 7 | Train Loss: 0.039 Vali Loss: 5.078 Vali Acc: 0.653 Test Loss: 5.078 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.526185989379883
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.167 Vali Acc: 0.403 Test Loss: 2.167 Test Acc: 0.403
Validation loss decreased (inf --> -0.402756).  Saving model ...
Epoch: 2 cost time: 3.7759623527526855
Epoch: 2, Steps: 7 | Train Loss: 1.044 Vali Loss: 1.474 Vali Acc: 0.625 Test Loss: 1.474 Test Acc: 0.625
Validation loss decreased (-0.402756 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 3.4018077850341797
Epoch: 3, Steps: 7 | Train Loss: 0.249 Vali Loss: 2.018 Vali Acc: 0.611 Test Loss: 2.018 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.689748764038086
Epoch: 4, Steps: 7 | Train Loss: 0.082 Vali Loss: 2.080 Vali Acc: 0.653 Test Loss: 2.080 Test Acc: 0.653
Validation loss decreased (-0.624985 --> -0.652757).  Saving model ...
Epoch: 5 cost time: 3.2631657123565674
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.968 Vali Acc: 0.653 Test Loss: 1.968 Test Acc: 0.653
Validation loss decreased (-0.652757 --> -0.652758).  Saving model ...
Epoch: 6 cost time: 3.355123996734619
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.054 Vali Acc: 0.639 Test Loss: 2.054 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.358245372772217
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.288 Vali Acc: 0.625 Test Loss: 2.288 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3433144092559814
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.892 Vali Acc: 0.597 Test Loss: 2.892 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4267427921295166
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.980 Vali Acc: 0.597 Test Loss: 2.980 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.472809314727783
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.804 Vali Acc: 0.597 Test Loss: 2.804 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5213592052459717
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.597 Test Loss: 2.691 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.6177473068237305
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.624 Vali Acc: 0.597 Test Loss: 2.624 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.694230556488037
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.583 Vali Acc: 0.597 Test Loss: 2.583 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.311131715774536
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.560 Vali Acc: 0.611 Test Loss: 2.560 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.355733633041382
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.541 Vali Acc: 0.611 Test Loss: 2.541 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6527777777777778
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.731234312057495
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.368 Vali Acc: 0.319 Test Loss: 2.368 Test Acc: 0.319
Validation loss decreased (inf --> -0.319421).  Saving model ...
Epoch: 2 cost time: 3.1195125579833984
Epoch: 2, Steps: 7 | Train Loss: 1.228 Vali Loss: 1.759 Vali Acc: 0.514 Test Loss: 1.759 Test Acc: 0.514
Validation loss decreased (-0.319421 --> -0.513871).  Saving model ...
Epoch: 3 cost time: 3.5284931659698486
Epoch: 3, Steps: 7 | Train Loss: 0.237 Vali Loss: 2.326 Vali Acc: 0.514 Test Loss: 2.326 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.256683826446533
Epoch: 4, Steps: 7 | Train Loss: 0.078 Vali Loss: 1.861 Vali Acc: 0.514 Test Loss: 1.861 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.105545997619629
Epoch: 5, Steps: 7 | Train Loss: 0.066 Vali Loss: 2.433 Vali Acc: 0.611 Test Loss: 2.433 Test Acc: 0.611
Validation loss decreased (-0.513871 --> -0.611087).  Saving model ...
Epoch: 6 cost time: 2.9850869178771973
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.587 Vali Acc: 0.583 Test Loss: 2.587 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3737099170684814
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.419 Vali Acc: 0.583 Test Loss: 2.419 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7731330394744873
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.951 Vali Acc: 0.528 Test Loss: 2.951 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.655117988586426
Epoch: 9, Steps: 7 | Train Loss: 0.051 Vali Loss: 2.565 Vali Acc: 0.583 Test Loss: 2.565 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.118663787841797
Epoch: 10, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.342 Vali Acc: 0.583 Test Loss: 2.342 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.6058597564697266
Epoch: 11, Steps: 7 | Train Loss: 0.062 Vali Loss: 4.004 Vali Acc: 0.514 Test Loss: 4.004 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2489442825317383
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 5.610 Vali Acc: 0.458 Test Loss: 5.610 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.6860318183898926
Epoch: 13, Steps: 7 | Train Loss: 0.075 Vali Loss: 2.866 Vali Acc: 0.583 Test Loss: 2.866 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0012927055358887
Epoch: 14, Steps: 7 | Train Loss: 0.069 Vali Loss: 4.433 Vali Acc: 0.569 Test Loss: 4.433 Test Acc: 0.569
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1656415462493896
Epoch: 15, Steps: 7 | Train Loss: 0.215 Vali Loss: 8.246 Vali Acc: 0.375 Test Loss: 8.246 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6111111111111112
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.109347820281982
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.595 Vali Acc: 0.222 Test Loss: 2.595 Test Acc: 0.222
Validation loss decreased (inf --> -0.222196).  Saving model ...
Epoch: 2 cost time: 2.9558539390563965
Epoch: 2, Steps: 7 | Train Loss: 1.386 Vali Loss: 2.205 Vali Acc: 0.278 Test Loss: 2.205 Test Acc: 0.278
Validation loss decreased (-0.222196 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 2.6432127952575684
Epoch: 3, Steps: 7 | Train Loss: 0.245 Vali Loss: 2.910 Vali Acc: 0.403 Test Loss: 2.910 Test Acc: 0.403
Validation loss decreased (-0.277756 --> -0.402749).  Saving model ...
Epoch: 4 cost time: 3.0868496894836426
Epoch: 4, Steps: 7 | Train Loss: 0.092 Vali Loss: 3.893 Vali Acc: 0.264 Test Loss: 3.893 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.840059995651245
Epoch: 5, Steps: 7 | Train Loss: 0.037 Vali Loss: 3.422 Vali Acc: 0.403 Test Loss: 3.422 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7350924015045166
Epoch: 6, Steps: 7 | Train Loss: 0.033 Vali Loss: 3.688 Vali Acc: 0.389 Test Loss: 3.688 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5198113918304443
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 4.441 Vali Acc: 0.361 Test Loss: 4.441 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.870565414428711
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 5.284 Vali Acc: 0.431 Test Loss: 5.284 Test Acc: 0.431
Validation loss decreased (-0.402749 --> -0.430503).  Saving model ...
Epoch: 9 cost time: 2.891523599624634
Epoch: 9, Steps: 7 | Train Loss: 0.118 Vali Loss: 5.455 Vali Acc: 0.375 Test Loss: 5.455 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.977703332901001
Epoch: 10, Steps: 7 | Train Loss: 0.359 Vali Loss: 6.907 Vali Acc: 0.375 Test Loss: 6.907 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.920518159866333
Epoch: 11, Steps: 7 | Train Loss: 0.200 Vali Loss: 7.679 Vali Acc: 0.361 Test Loss: 7.679 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8720152378082275
Epoch: 12, Steps: 7 | Train Loss: 0.155 Vali Loss: 7.367 Vali Acc: 0.431 Test Loss: 7.367 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0024161338806152
Epoch: 13, Steps: 7 | Train Loss: 0.054 Vali Loss: 7.809 Vali Acc: 0.361 Test Loss: 7.809 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.858687400817871
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 8.011 Vali Acc: 0.319 Test Loss: 8.011 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.957657814025879
Epoch: 15, Steps: 7 | Train Loss: 0.146 Vali Loss: 9.722 Vali Acc: 0.292 Test Loss: 9.722 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.750833511352539
Epoch: 16, Steps: 7 | Train Loss: 0.257 Vali Loss: 8.090 Vali Acc: 0.431 Test Loss: 8.090 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5533945560455322
Epoch: 17, Steps: 7 | Train Loss: 0.473 Vali Loss: 13.358 Vali Acc: 0.347 Test Loss: 13.358 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.855361223220825
Epoch: 18, Steps: 7 | Train Loss: 0.406 Vali Loss: 8.733 Vali Acc: 0.333 Test Loss: 8.733 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.597540855407715
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.446 Vali Acc: 0.194 Test Loss: 2.446 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.7714083194732666
Epoch: 2, Steps: 7 | Train Loss: 1.492 Vali Loss: 2.046 Vali Acc: 0.347 Test Loss: 2.046 Test Acc: 0.347
Validation loss decreased (-0.194420 --> -0.347202).  Saving model ...
Epoch: 3 cost time: 2.6917059421539307
Epoch: 3, Steps: 7 | Train Loss: 0.342 Vali Loss: 2.296 Vali Acc: 0.306 Test Loss: 2.296 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.951709747314453
Epoch: 4, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.935 Vali Acc: 0.458 Test Loss: 1.935 Test Acc: 0.458
Validation loss decreased (-0.347202 --> -0.458314).  Saving model ...
Epoch: 5 cost time: 2.4218883514404297
Epoch: 5, Steps: 7 | Train Loss: 0.022 Vali Loss: 3.398 Vali Acc: 0.458 Test Loss: 3.398 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.567248821258545
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.350 Vali Acc: 0.458 Test Loss: 3.350 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6292309761047363
Epoch: 7, Steps: 7 | Train Loss: 0.057 Vali Loss: 3.900 Vali Acc: 0.444 Test Loss: 3.900 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.289041042327881
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.553 Vali Acc: 0.403 Test Loss: 4.553 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.926920175552368
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.569 Vali Acc: 0.431 Test Loss: 4.569 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5557703971862793
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.972 Vali Acc: 0.361 Test Loss: 4.972 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9580492973327637
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.651 Vali Acc: 0.375 Test Loss: 4.651 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6714043617248535
Epoch: 12, Steps: 7 | Train Loss: 0.055 Vali Loss: 4.630 Vali Acc: 0.403 Test Loss: 4.630 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6273744106292725
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 4.951 Vali Acc: 0.431 Test Loss: 4.951 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.992936611175537
Epoch: 14, Steps: 7 | Train Loss: 0.240 Vali Loss: 5.867 Vali Acc: 0.389 Test Loss: 5.867 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.07915735244751
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.411 Vali Acc: 0.222 Test Loss: 2.411 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 2.592853307723999
Epoch: 2, Steps: 7 | Train Loss: 1.582 Vali Loss: 1.953 Vali Acc: 0.361 Test Loss: 1.953 Test Acc: 0.361
Validation loss decreased (-0.222198 --> -0.361092).  Saving model ...
Epoch: 3 cost time: 2.556656837463379
Epoch: 3, Steps: 7 | Train Loss: 0.374 Vali Loss: 2.116 Vali Acc: 0.389 Test Loss: 2.116 Test Acc: 0.389
Validation loss decreased (-0.361092 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 2.6383135318756104
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 2.398 Vali Acc: 0.306 Test Loss: 2.398 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.511507272720337
Epoch: 5, Steps: 7 | Train Loss: 0.111 Vali Loss: 3.027 Vali Acc: 0.431 Test Loss: 3.027 Test Acc: 0.431
Validation loss decreased (-0.388868 --> -0.430525).  Saving model ...
Epoch: 6 cost time: 2.721472978591919
Epoch: 6, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.534 Vali Acc: 0.458 Test Loss: 2.534 Test Acc: 0.458
Validation loss decreased (-0.430525 --> -0.458308).  Saving model ...
Epoch: 7 cost time: 2.6107122898101807
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.116 Vali Acc: 0.472 Test Loss: 3.116 Test Acc: 0.472
Validation loss decreased (-0.458308 --> -0.472191).  Saving model ...
Epoch: 8 cost time: 2.6789281368255615
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.846 Vali Acc: 0.403 Test Loss: 3.846 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.543077230453491
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.357 Vali Acc: 0.375 Test Loss: 4.357 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.709534168243408
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.366 Vali Acc: 0.403 Test Loss: 4.366 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6640257835388184
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.464 Vali Acc: 0.431 Test Loss: 3.464 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.55269193649292
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.122 Vali Acc: 0.431 Test Loss: 3.122 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.742706537246704
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.109 Vali Acc: 0.431 Test Loss: 3.109 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.691263437271118
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.135 Vali Acc: 0.444 Test Loss: 3.135 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7572789192199707
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.157 Vali Acc: 0.458 Test Loss: 3.157 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.577427864074707
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.163 Vali Acc: 0.458 Test Loss: 3.163 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6903018951416016
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.165 Vali Acc: 0.458 Test Loss: 3.165 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4242494106292725
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.459 Vali Acc: 0.194 Test Loss: 2.459 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.48376202583313
Epoch: 2, Steps: 7 | Train Loss: 1.610 Vali Loss: 2.144 Vali Acc: 0.292 Test Loss: 2.144 Test Acc: 0.292
Validation loss decreased (-0.194420 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 2.4024136066436768
Epoch: 3, Steps: 7 | Train Loss: 0.425 Vali Loss: 2.324 Vali Acc: 0.431 Test Loss: 2.324 Test Acc: 0.431
Validation loss decreased (-0.291645 --> -0.430532).  Saving model ...
Epoch: 4 cost time: 2.6768898963928223
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 2.376 Vali Acc: 0.333 Test Loss: 2.376 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.549732208251953
Epoch: 5, Steps: 7 | Train Loss: 0.035 Vali Loss: 3.712 Vali Acc: 0.333 Test Loss: 3.712 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5571706295013428
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.660 Vali Acc: 0.347 Test Loss: 3.660 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.629049301147461
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.300 Vali Acc: 0.278 Test Loss: 4.300 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.465116500854492
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 5.978 Vali Acc: 0.250 Test Loss: 5.978 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.358722448348999
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.260 Vali Acc: 0.417 Test Loss: 4.260 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.389667510986328
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.973 Vali Acc: 0.361 Test Loss: 3.973 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.52311110496521
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.481 Vali Acc: 0.444 Test Loss: 3.481 Test Acc: 0.444
Validation loss decreased (-0.430532 --> -0.444410).  Saving model ...
Epoch: 12 cost time: 2.3842036724090576
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.834 Vali Acc: 0.444 Test Loss: 3.834 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3730831146240234
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.824 Vali Acc: 0.486 Test Loss: 3.824 Test Acc: 0.486
Validation loss decreased (-0.444410 --> -0.486073).  Saving model ...
Epoch: 14 cost time: 2.644561767578125
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.063 Vali Acc: 0.486 Test Loss: 4.063 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.487025022506714
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.149 Vali Acc: 0.472 Test Loss: 4.149 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.577312707901001
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.141 Vali Acc: 0.458 Test Loss: 4.141 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4483461380004883
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.093 Vali Acc: 0.444 Test Loss: 4.093 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4507761001586914
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.062 Vali Acc: 0.458 Test Loss: 4.062 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4960336685180664
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.042 Vali Acc: 0.458 Test Loss: 4.042 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3881173133850098
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.027 Vali Acc: 0.458 Test Loss: 4.027 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5799903869628906
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.015 Vali Acc: 0.472 Test Loss: 4.015 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.402247190475464
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.472 Test Loss: 4.006 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3723018169403076
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.999 Vali Acc: 0.472 Test Loss: 3.999 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.1460185050964355
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.410 Vali Acc: 0.278 Test Loss: 2.410 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 2.6065778732299805
Epoch: 2, Steps: 7 | Train Loss: 1.874 Vali Loss: 2.401 Vali Acc: 0.250 Test Loss: 2.401 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.656304121017456
Epoch: 3, Steps: 7 | Train Loss: 0.822 Vali Loss: 2.591 Vali Acc: 0.333 Test Loss: 2.591 Test Acc: 0.333
Validation loss decreased (-0.277754 --> -0.333307).  Saving model ...
Epoch: 4 cost time: 2.7308318614959717
Epoch: 4, Steps: 7 | Train Loss: 0.246 Vali Loss: 2.631 Vali Acc: 0.250 Test Loss: 2.631 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.739090919494629
Epoch: 5, Steps: 7 | Train Loss: 0.066 Vali Loss: 3.455 Vali Acc: 0.194 Test Loss: 3.455 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.634185552597046
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 3.819 Vali Acc: 0.153 Test Loss: 3.819 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6149866580963135
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 4.282 Vali Acc: 0.139 Test Loss: 4.282 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.666928768157959
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.831 Vali Acc: 0.319 Test Loss: 3.831 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.731574296951294
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.662 Vali Acc: 0.125 Test Loss: 4.662 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7901251316070557
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 6.073 Vali Acc: 0.125 Test Loss: 6.073 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.417351245880127
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.635 Vali Acc: 0.264 Test Loss: 4.635 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7733044624328613
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.906 Vali Acc: 0.222 Test Loss: 4.906 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5222325325012207
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 11.206 Vali Acc: 0.083 Test Loss: 11.206 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3333333333333333
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6770756244659424
Epoch: 1, Steps: 7 | Train Loss: 2.521 Vali Loss: 2.388 Vali Acc: 0.194 Test Loss: 2.388 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 2.4869794845581055
Epoch: 2, Steps: 7 | Train Loss: 1.845 Vali Loss: 3.089 Vali Acc: 0.181 Test Loss: 3.089 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.759321928024292
Epoch: 3, Steps: 7 | Train Loss: 0.845 Vali Loss: 2.931 Vali Acc: 0.181 Test Loss: 2.931 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5374319553375244
Epoch: 4, Steps: 7 | Train Loss: 0.258 Vali Loss: 3.105 Vali Acc: 0.167 Test Loss: 3.105 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.614610195159912
Epoch: 5, Steps: 7 | Train Loss: 0.067 Vali Loss: 3.422 Vali Acc: 0.236 Test Loss: 3.422 Test Acc: 0.236
Validation loss decreased (-0.194421 --> -0.236077).  Saving model ...
Epoch: 6 cost time: 2.5894007682800293
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 4.385 Vali Acc: 0.264 Test Loss: 4.385 Test Acc: 0.264
Validation loss decreased (-0.236077 --> -0.263845).  Saving model ...
Epoch: 7 cost time: 2.6443543434143066
Epoch: 7, Steps: 7 | Train Loss: 0.030 Vali Loss: 4.228 Vali Acc: 0.278 Test Loss: 4.228 Test Acc: 0.278
Validation loss decreased (-0.263845 --> -0.277735).  Saving model ...
Epoch: 8 cost time: 2.7845382690429688
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.625 Vali Acc: 0.264 Test Loss: 4.625 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5671534538269043
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.312 Vali Acc: 0.208 Test Loss: 5.312 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.760645866394043
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.293 Vali Acc: 0.139 Test Loss: 6.293 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.604766368865967
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 6.616 Vali Acc: 0.153 Test Loss: 6.616 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8022332191467285
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.838 Vali Acc: 0.194 Test Loss: 6.838 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.764777183532715
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.811 Vali Acc: 0.208 Test Loss: 6.811 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9537513256073
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.498 Vali Acc: 0.208 Test Loss: 6.498 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.772130012512207
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.287 Vali Acc: 0.208 Test Loss: 6.287 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6358721256256104
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.175 Vali Acc: 0.222 Test Loss: 6.175 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.90004563331604
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.098 Vali Acc: 0.222 Test Loss: 6.098 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2777777777777778
model parameter : 6512396
model size : 34.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.6196088790893555
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 1.861 Vali Acc: 0.597 Test Loss: 1.861 Test Acc: 0.597
Validation loss decreased (inf --> -0.597204).  Saving model ...
Epoch: 2 cost time: 3.442941665649414
Epoch: 2, Steps: 7 | Train Loss: 1.043 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
Validation loss decreased (-0.597204 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 3.4173905849456787
Epoch: 3, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.977 Vali Acc: 0.833 Test Loss: 0.977 Test Acc: 0.833
Validation loss decreased (-0.722212 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 3.298541307449341
Epoch: 4, Steps: 7 | Train Loss: 0.037 Vali Loss: 1.196 Vali Acc: 0.792 Test Loss: 1.196 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.943444013595581
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.500 Vali Acc: 0.778 Test Loss: 1.500 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5568509101867676
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.445 Vali Acc: 0.778 Test Loss: 1.445 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.213747501373291
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.736 Test Loss: 1.801 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.356158494949341
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.562 Vali Acc: 0.778 Test Loss: 1.562 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.223083734512329
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.847 Test Loss: 1.275 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847209).  Saving model ...
Epoch: 10 cost time: 3.41085147857666
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.833 Test Loss: 1.217 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4373409748077393
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.847 Test Loss: 1.200 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847210).  Saving model ...
Epoch: 12 cost time: 3.624645709991455
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.847 Test Loss: 1.190 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847210).  Saving model ...
Epoch: 13 cost time: 3.3094582557678223
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.847 Test Loss: 1.184 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847210).  Saving model ...
Epoch: 14 cost time: 3.607062578201294
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.847 Test Loss: 1.181 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847210).  Saving model ...
Epoch: 15 cost time: 3.150421380996704
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.833 Test Loss: 1.181 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.943115472793579
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.833 Test Loss: 1.180 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1369500160217285
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.833 Test Loss: 1.179 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.068129301071167
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.847 Test Loss: 1.179 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847210).  Saving model ...
Epoch: 19 cost time: 3.4189300537109375
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.847 Test Loss: 1.179 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9643335342407227
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.847 Test Loss: 1.180 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.7930068969726562
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.847 Test Loss: 1.180 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9038984775543213
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.847 Test Loss: 1.180 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4582931995391846
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.847 Test Loss: 1.181 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.317279815673828
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.847 Test Loss: 1.181 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.493356943130493
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.847 Test Loss: 1.182 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.565398931503296
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.847 Test Loss: 1.183 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.221099138259888
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.847 Test Loss: 1.184 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.2347073554992676
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.847 Test Loss: 1.184 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.769633769989014
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 1.994 Vali Acc: 0.542 Test Loss: 1.994 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 2.902122974395752
Epoch: 2, Steps: 7 | Train Loss: 1.257 Vali Loss: 1.123 Vali Acc: 0.708 Test Loss: 1.123 Test Acc: 0.708
Validation loss decreased (-0.541647 --> -0.708322).  Saving model ...
Epoch: 3 cost time: 3.3466620445251465
Epoch: 3, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.904 Vali Acc: 0.806 Test Loss: 0.904 Test Acc: 0.806
Validation loss decreased (-0.708322 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 2.965575695037842
Epoch: 4, Steps: 7 | Train Loss: 0.049 Vali Loss: 1.146 Vali Acc: 0.750 Test Loss: 1.146 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2227330207824707
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.309 Vali Acc: 0.722 Test Loss: 1.309 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7298309803009033
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.819 Test Loss: 1.131 Test Acc: 0.819
Validation loss decreased (-0.805547 --> -0.819433).  Saving model ...
Epoch: 7 cost time: 3.158588171005249
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.764 Test Loss: 1.352 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.835937261581421
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.722 Test Loss: 1.545 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6869442462921143
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.750 Test Loss: 1.428 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.26363205909729
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.750 Test Loss: 1.320 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8101649284362793
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.778 Test Loss: 1.256 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.318993330001831
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.806 Test Loss: 1.221 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9947564601898193
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.806 Test Loss: 1.202 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.158496141433716
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.792 Test Loss: 1.190 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9176971912384033
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.792 Test Loss: 1.181 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.195842742919922
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.792 Test Loss: 1.175 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.3651206493377686
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.141 Vali Acc: 0.389 Test Loss: 2.141 Test Acc: 0.389
Validation loss decreased (inf --> -0.388867).  Saving model ...
Epoch: 2 cost time: 2.988271951675415
Epoch: 2, Steps: 7 | Train Loss: 1.458 Vali Loss: 1.383 Vali Acc: 0.611 Test Loss: 1.383 Test Acc: 0.611
Validation loss decreased (-0.388867 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 2.8598387241363525
Epoch: 3, Steps: 7 | Train Loss: 0.382 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
Validation loss decreased (-0.611097 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 3.031510829925537
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 1.221 Vali Acc: 0.708 Test Loss: 1.221 Test Acc: 0.708
Validation loss decreased (-0.624988 --> -0.708321).  Saving model ...
Epoch: 5 cost time: 2.767885446548462
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.088 Vali Acc: 0.708 Test Loss: 1.088 Test Acc: 0.708
Validation loss decreased (-0.708321 --> -0.708322).  Saving model ...
Epoch: 6 cost time: 3.13706374168396
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.148 Vali Acc: 0.736 Test Loss: 1.148 Test Acc: 0.736
Validation loss decreased (-0.708322 --> -0.736100).  Saving model ...
Epoch: 7 cost time: 2.8025801181793213
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.264 Vali Acc: 0.681 Test Loss: 1.264 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.643345594406128
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.736 Test Loss: 1.179 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8530032634735107
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.736 Test Loss: 1.350 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6342265605926514
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.764 Test Loss: 1.294 Test Acc: 0.764
Validation loss decreased (-0.736100 --> -0.763876).  Saving model ...
Epoch: 11 cost time: 3.198322296142578
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.764 Test Loss: 1.203 Test Acc: 0.764
Validation loss decreased (-0.763876 --> -0.763877).  Saving model ...
Epoch: 12 cost time: 3.012960195541382
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.778 Test Loss: 1.171 Test Acc: 0.778
Validation loss decreased (-0.763877 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 3.171085834503174
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.778 Test Loss: 1.158 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 14 cost time: 3.103496789932251
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.778 Test Loss: 1.152 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 15 cost time: 3.109846353530884
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.778 Test Loss: 1.149 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 16 cost time: 2.708360195159912
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.145 Vali Acc: 0.778 Test Loss: 1.145 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 17 cost time: 2.8842172622680664
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.778 Test Loss: 1.139 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 18 cost time: 3.0596797466278076
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.778 Test Loss: 1.135 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 19 cost time: 2.8769514560699463
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.778 Test Loss: 1.129 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 2.977200746536255
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.778 Test Loss: 1.124 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777767).  Saving model ...
Epoch: 21 cost time: 2.920088529586792
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.778 Test Loss: 1.120 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 22 cost time: 3.2490570545196533
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.778 Test Loss: 1.116 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 23 cost time: 2.933100938796997
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.111 Vali Acc: 0.778 Test Loss: 1.111 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 24 cost time: 3.2306647300720215
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.778 Test Loss: 1.108 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 25 cost time: 2.6603050231933594
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.778 Test Loss: 1.105 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 26 cost time: 2.9606776237487793
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.778 Test Loss: 1.101 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 27 cost time: 2.848554849624634
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.778 Test Loss: 1.099 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 28 cost time: 2.805535316467285
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.778 Test Loss: 1.096 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 29 cost time: 2.9173882007598877
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.778 Test Loss: 1.094 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 30 cost time: 3.1151111125946045
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.778 Test Loss: 1.092 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 31 cost time: 3.031038761138916
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.764 Test Loss: 1.090 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1875810623168945
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.764 Test Loss: 1.087 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.792949914932251
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.778 Test Loss: 1.087 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 34 cost time: 2.869727849960327
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.778 Test Loss: 1.085 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 35 cost time: 2.9425342082977295
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.778 Test Loss: 1.082 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 36 cost time: 2.9822354316711426
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.778 Test Loss: 1.081 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 37 cost time: 2.8415660858154297
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.778 Test Loss: 1.080 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 38 cost time: 2.7666919231414795
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.778 Test Loss: 1.078 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 39 cost time: 3.207327365875244
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.778 Test Loss: 1.077 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 40 cost time: 2.9130616188049316
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.778 Test Loss: 1.074 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 41 cost time: 2.992175817489624
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.778 Test Loss: 1.073 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 42 cost time: 2.85036563873291
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.778 Test Loss: 1.071 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 43 cost time: 3.090204954147339
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.778 Test Loss: 1.070 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 44 cost time: 2.7123589515686035
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.778 Test Loss: 1.070 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 45 cost time: 2.823455810546875
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.778 Test Loss: 1.068 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 46 cost time: 2.7466139793395996
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.778 Test Loss: 1.067 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 47 cost time: 2.57708740234375
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.778 Test Loss: 1.066 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 48 cost time: 3.2753219604492188
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.778 Test Loss: 1.064 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 49 cost time: 2.77095365524292
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.778 Test Loss: 1.064 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 50 cost time: 3.2566020488739014
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.778 Test Loss: 1.063 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 51 cost time: 3.027766227722168
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.778 Test Loss: 1.062 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 52 cost time: 3.1199557781219482
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.778 Test Loss: 1.062 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 53 cost time: 2.6738030910491943
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.778 Test Loss: 1.060 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 54 cost time: 2.8372161388397217
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.778 Test Loss: 1.060 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 55 cost time: 2.8396799564361572
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.778 Test Loss: 1.059 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 56 cost time: 3.089901924133301
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.778 Test Loss: 1.057 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 57 cost time: 3.1823384761810303
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 58 cost time: 3.268657922744751
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.778 Test Loss: 1.055 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 59 cost time: 2.9366977214813232
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.778 Test Loss: 1.055 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.360950469970703
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.778 Test Loss: 1.054 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 61 cost time: 2.8163585662841797
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.778 Test Loss: 1.055 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.851551055908203
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.778 Test Loss: 1.055 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.5750186443328857
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.778 Test Loss: 1.055 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.90537428855896
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 2.796595811843872
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 2.7502079010009766
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 3.0359363555908203
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 2.9183058738708496
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 3.081367254257202
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 2.792346239089966
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.778 Test Loss: 1.056 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9973933696746826
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.295 Vali Acc: 0.306 Test Loss: 2.295 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 2.7166783809661865
Epoch: 2, Steps: 7 | Train Loss: 1.651 Vali Loss: 1.744 Vali Acc: 0.417 Test Loss: 1.744 Test Acc: 0.417
Validation loss decreased (-0.305533 --> -0.416649).  Saving model ...
Epoch: 3 cost time: 2.9813525676727295
Epoch: 3, Steps: 7 | Train Loss: 0.475 Vali Loss: 1.532 Vali Acc: 0.542 Test Loss: 1.532 Test Acc: 0.542
Validation loss decreased (-0.416649 --> -0.541651).  Saving model ...
Epoch: 4 cost time: 2.7233784198760986
Epoch: 4, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.463 Vali Acc: 0.625 Test Loss: 1.463 Test Acc: 0.625
Validation loss decreased (-0.541651 --> -0.624985).  Saving model ...
Epoch: 5 cost time: 3.168300151824951
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.263 Vali Acc: 0.681 Test Loss: 1.263 Test Acc: 0.681
Validation loss decreased (-0.624985 --> -0.680543).  Saving model ...
Epoch: 6 cost time: 2.8866336345672607
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.214 Vali Acc: 0.653 Test Loss: 1.214 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.005312919616699
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.639 Test Loss: 1.337 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8553829193115234
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.611 Test Loss: 1.512 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8549985885620117
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.653 Test Loss: 1.513 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7107198238372803
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.667 Test Loss: 1.498 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8100054264068604
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.653 Test Loss: 1.481 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9394960403442383
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.667 Test Loss: 1.466 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.741508722305298
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.681 Test Loss: 1.453 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.035626173019409
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.681 Test Loss: 1.445 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8790597915649414
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.681 Test Loss: 1.440 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6805555555555556
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8005449771881104
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.341 Vali Acc: 0.208 Test Loss: 2.341 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.53169322013855
Epoch: 2, Steps: 7 | Train Loss: 1.730 Vali Loss: 2.173 Vali Acc: 0.292 Test Loss: 2.173 Test Acc: 0.292
Validation loss decreased (-0.208310 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 2.646803140640259
Epoch: 3, Steps: 7 | Train Loss: 0.591 Vali Loss: 2.066 Vali Acc: 0.389 Test Loss: 2.066 Test Acc: 0.389
Validation loss decreased (-0.291645 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 2.5592222213745117
Epoch: 4, Steps: 7 | Train Loss: 0.144 Vali Loss: 2.371 Vali Acc: 0.444 Test Loss: 2.371 Test Acc: 0.444
Validation loss decreased (-0.388868 --> -0.444421).  Saving model ...
Epoch: 5 cost time: 2.8749313354492188
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.607 Vali Acc: 0.333 Test Loss: 2.607 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5781092643737793
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.579 Vali Acc: 0.458 Test Loss: 2.579 Test Acc: 0.458
Validation loss decreased (-0.444421 --> -0.458308).  Saving model ...
Epoch: 7 cost time: 2.6834380626678467
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.573 Vali Acc: 0.472 Test Loss: 2.573 Test Acc: 0.472
Validation loss decreased (-0.458308 --> -0.472196).  Saving model ...
Epoch: 8 cost time: 2.6272804737091064
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.001 Vali Acc: 0.444 Test Loss: 3.001 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.858855962753296
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.792 Vali Acc: 0.444 Test Loss: 2.792 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.614180564880371
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.458 Test Loss: 2.818 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3206071853637695
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.824 Vali Acc: 0.431 Test Loss: 2.824 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7427079677581787
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.787 Vali Acc: 0.431 Test Loss: 2.787 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7107622623443604
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.724 Vali Acc: 0.431 Test Loss: 2.724 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.334632396697998
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.667 Vali Acc: 0.431 Test Loss: 2.667 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6369073390960693
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.632 Vali Acc: 0.431 Test Loss: 2.632 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.355069398880005
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.613 Vali Acc: 0.431 Test Loss: 2.613 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.740372657775879
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.596 Vali Acc: 0.431 Test Loss: 2.596 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6919705867767334
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.323 Vali Acc: 0.181 Test Loss: 2.323 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 2.3485805988311768
Epoch: 2, Steps: 7 | Train Loss: 1.863 Vali Loss: 2.036 Vali Acc: 0.236 Test Loss: 2.036 Test Acc: 0.236
Validation loss decreased (-0.180532 --> -0.236091).  Saving model ...
Epoch: 3 cost time: 2.4186246395111084
Epoch: 3, Steps: 7 | Train Loss: 0.721 Vali Loss: 2.003 Vali Acc: 0.375 Test Loss: 2.003 Test Acc: 0.375
Validation loss decreased (-0.236091 --> -0.374980).  Saving model ...
Epoch: 4 cost time: 2.5633609294891357
Epoch: 4, Steps: 7 | Train Loss: 0.204 Vali Loss: 1.972 Vali Acc: 0.361 Test Loss: 1.972 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5367941856384277
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 2.228 Vali Acc: 0.389 Test Loss: 2.228 Test Acc: 0.389
Validation loss decreased (-0.374980 --> -0.388867).  Saving model ...
Epoch: 6 cost time: 2.630317211151123
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.702 Vali Acc: 0.347 Test Loss: 2.702 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4684219360351562
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.488 Vali Acc: 0.486 Test Loss: 2.488 Test Acc: 0.486
Validation loss decreased (-0.388867 --> -0.486086).  Saving model ...
Epoch: 8 cost time: 2.5652379989624023
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.458 Test Loss: 2.845 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6763863563537598
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.948 Vali Acc: 0.444 Test Loss: 2.948 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.564633369445801
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.739 Vali Acc: 0.500 Test Loss: 2.739 Test Acc: 0.500
Validation loss decreased (-0.486086 --> -0.499973).  Saving model ...
Epoch: 11 cost time: 2.570134162902832
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.608 Vali Acc: 0.514 Test Loss: 2.608 Test Acc: 0.514
Validation loss decreased (-0.499973 --> -0.513863).  Saving model ...
Epoch: 12 cost time: 2.520005226135254
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.539 Vali Acc: 0.486 Test Loss: 2.539 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.675783157348633
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.496 Vali Acc: 0.472 Test Loss: 2.496 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3317246437072754
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.472 Test Loss: 2.470 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.397531032562256
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.486 Test Loss: 2.457 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.426602602005005
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.486 Test Loss: 2.448 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.492957830429077
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.438 Vali Acc: 0.486 Test Loss: 2.438 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3607892990112305
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.426 Vali Acc: 0.472 Test Loss: 2.426 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.710947275161743
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.422 Vali Acc: 0.472 Test Loss: 2.422 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3223490715026855
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.423 Vali Acc: 0.486 Test Loss: 2.423 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.728637218475342
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.427 Vali Acc: 0.486 Test Loss: 2.427 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5138888888888888
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6580448150634766
Epoch: 1, Steps: 7 | Train Loss: 2.570 Vali Loss: 2.352 Vali Acc: 0.194 Test Loss: 2.352 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 2.4285075664520264
Epoch: 2, Steps: 7 | Train Loss: 1.963 Vali Loss: 2.078 Vali Acc: 0.306 Test Loss: 2.078 Test Acc: 0.306
Validation loss decreased (-0.194421 --> -0.305535).  Saving model ...
Epoch: 3 cost time: 2.3689827919006348
Epoch: 3, Steps: 7 | Train Loss: 0.879 Vali Loss: 1.956 Vali Acc: 0.333 Test Loss: 1.956 Test Acc: 0.333
Validation loss decreased (-0.305535 --> -0.333314).  Saving model ...
Epoch: 4 cost time: 2.6120948791503906
Epoch: 4, Steps: 7 | Train Loss: 0.289 Vali Loss: 1.799 Vali Acc: 0.375 Test Loss: 1.799 Test Acc: 0.375
Validation loss decreased (-0.333314 --> -0.374982).  Saving model ...
Epoch: 5 cost time: 2.556840658187866
Epoch: 5, Steps: 7 | Train Loss: 0.073 Vali Loss: 1.625 Vali Acc: 0.458 Test Loss: 1.625 Test Acc: 0.458
Validation loss decreased (-0.374982 --> -0.458317).  Saving model ...
Epoch: 6 cost time: 2.622810125350952
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.998 Vali Acc: 0.458 Test Loss: 1.998 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3890676498413086
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.047 Vali Acc: 0.500 Test Loss: 2.047 Test Acc: 0.500
Validation loss decreased (-0.458317 --> -0.499980).  Saving model ...
Epoch: 8 cost time: 2.381880283355713
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.486 Test Loss: 1.709 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6075212955474854
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.528 Test Loss: 1.674 Test Acc: 0.528
Validation loss decreased (-0.499980 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 2.4249799251556396
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.528 Test Loss: 1.800 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.488039016723633
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.528 Test Loss: 1.910 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.595142126083374
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.514 Test Loss: 1.934 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5328359603881836
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.542 Test Loss: 1.881 Test Acc: 0.542
Validation loss decreased (-0.527761 --> -0.541648).  Saving model ...
Epoch: 14 cost time: 2.557105779647827
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.528 Test Loss: 1.848 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3360438346862793
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.528 Test Loss: 1.828 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.605055570602417
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.528 Test Loss: 1.817 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.708503484725952
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.528 Test Loss: 1.805 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.581569194793701
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.528 Test Loss: 1.796 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4026095867156982
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.542 Test Loss: 1.796 Test Acc: 0.542
Validation loss decreased (-0.541648 --> -0.541649).  Saving model ...
Epoch: 20 cost time: 2.495976686477661
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.542 Test Loss: 1.799 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.587066650390625
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.528 Test Loss: 1.811 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3988804817199707
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.528 Test Loss: 1.820 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.368096113204956
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.528 Test Loss: 1.826 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.492624044418335
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.542 Test Loss: 1.822 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.464026927947998
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.542 Test Loss: 1.825 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.510040521621704
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.542 Test Loss: 1.827 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5331997871398926
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.528 Test Loss: 1.825 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0750489234924316
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.528 Test Loss: 1.828 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.670769214630127
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.528 Test Loss: 1.828 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5416666666666666
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7975964546203613
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.375 Vali Acc: 0.250 Test Loss: 2.375 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 2.497267723083496
Epoch: 2, Steps: 7 | Train Loss: 2.033 Vali Loss: 2.191 Vali Acc: 0.250 Test Loss: 2.191 Test Acc: 0.250
Validation loss decreased (-0.249976 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 2.521038293838501
Epoch: 3, Steps: 7 | Train Loss: 0.969 Vali Loss: 2.043 Vali Acc: 0.319 Test Loss: 2.043 Test Acc: 0.319
Validation loss decreased (-0.249978 --> -0.319424).  Saving model ...
Epoch: 4 cost time: 2.473647117614746
Epoch: 4, Steps: 7 | Train Loss: 0.314 Vali Loss: 2.139 Vali Acc: 0.306 Test Loss: 2.139 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.383288860321045
Epoch: 5, Steps: 7 | Train Loss: 0.068 Vali Loss: 1.698 Vali Acc: 0.458 Test Loss: 1.698 Test Acc: 0.458
Validation loss decreased (-0.319424 --> -0.458316).  Saving model ...
Epoch: 6 cost time: 2.5774500370025635
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.500 Vali Acc: 0.403 Test Loss: 2.500 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.492628812789917
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.246 Vali Acc: 0.375 Test Loss: 2.246 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5153660774230957
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.082 Vali Acc: 0.375 Test Loss: 2.082 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5399255752563477
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.417 Test Loss: 1.960 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.545450448989868
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.062 Vali Acc: 0.444 Test Loss: 2.062 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.541597843170166
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.188 Vali Acc: 0.403 Test Loss: 2.188 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.674880027770996
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.417 Test Loss: 2.220 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.564649820327759
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.176 Vali Acc: 0.417 Test Loss: 2.176 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.583433151245117
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.431 Test Loss: 2.135 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.473235607147217
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.431 Test Loss: 2.107 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.521878957748413
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.421 Vali Acc: 0.181 Test Loss: 2.421 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.2916574478149414
Epoch: 2, Steps: 7 | Train Loss: 2.208 Vali Loss: 2.332 Vali Acc: 0.181 Test Loss: 2.332 Test Acc: 0.181
Validation loss decreased (-0.180531 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 2.3851230144500732
Epoch: 3, Steps: 7 | Train Loss: 1.326 Vali Loss: 2.232 Vali Acc: 0.236 Test Loss: 2.232 Test Acc: 0.236
Validation loss decreased (-0.180532 --> -0.236089).  Saving model ...
Epoch: 4 cost time: 2.4888248443603516
Epoch: 4, Steps: 7 | Train Loss: 0.632 Vali Loss: 2.605 Vali Acc: 0.153 Test Loss: 2.605 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3605222702026367
Epoch: 5, Steps: 7 | Train Loss: 0.236 Vali Loss: 2.119 Vali Acc: 0.194 Test Loss: 2.119 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4922783374786377
Epoch: 6, Steps: 7 | Train Loss: 0.065 Vali Loss: 2.741 Vali Acc: 0.292 Test Loss: 2.741 Test Acc: 0.292
Validation loss decreased (-0.236089 --> -0.291639).  Saving model ...
Epoch: 7 cost time: 2.3794474601745605
Epoch: 7, Steps: 7 | Train Loss: 0.026 Vali Loss: 1.937 Vali Acc: 0.278 Test Loss: 1.937 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3459231853485107
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.855 Vali Acc: 0.319 Test Loss: 2.855 Test Acc: 0.319
Validation loss decreased (-0.291639 --> -0.319416).  Saving model ...
Epoch: 9 cost time: 2.411961317062378
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.673 Vali Acc: 0.250 Test Loss: 2.673 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.309908628463745
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.586 Vali Acc: 0.236 Test Loss: 2.586 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2232816219329834
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.715 Vali Acc: 0.236 Test Loss: 2.715 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2950427532196045
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.859 Vali Acc: 0.278 Test Loss: 2.859 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.194476842880249
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.278 Test Loss: 2.814 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3093690872192383
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.695 Vali Acc: 0.264 Test Loss: 2.695 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2397425174713135
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.592 Vali Acc: 0.278 Test Loss: 2.592 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.335399866104126
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.526 Vali Acc: 0.292 Test Loss: 2.526 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4761695861816406
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.491 Vali Acc: 0.292 Test Loss: 2.491 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2527565956115723
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.292 Test Loss: 2.513 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3194444444444444
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.388270854949951
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.435 Vali Acc: 0.167 Test Loss: 2.435 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.3234450817108154
Epoch: 2, Steps: 7 | Train Loss: 2.137 Vali Loss: 2.603 Vali Acc: 0.167 Test Loss: 2.603 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4156360626220703
Epoch: 3, Steps: 7 | Train Loss: 1.285 Vali Loss: 2.715 Vali Acc: 0.125 Test Loss: 2.715 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6257410049438477
Epoch: 4, Steps: 7 | Train Loss: 0.624 Vali Loss: 2.969 Vali Acc: 0.181 Test Loss: 2.969 Test Acc: 0.181
Validation loss decreased (-0.166642 --> -0.180526).  Saving model ...
Epoch: 5 cost time: 2.5643582344055176
Epoch: 5, Steps: 7 | Train Loss: 0.299 Vali Loss: 2.834 Vali Acc: 0.194 Test Loss: 2.834 Test Acc: 0.194
Validation loss decreased (-0.180526 --> -0.194416).  Saving model ...
Epoch: 6 cost time: 2.5540761947631836
Epoch: 6, Steps: 7 | Train Loss: 0.139 Vali Loss: 3.942 Vali Acc: 0.222 Test Loss: 3.942 Test Acc: 0.222
Validation loss decreased (-0.194416 --> -0.222183).  Saving model ...
Epoch: 7 cost time: 2.425750970840454
Epoch: 7, Steps: 7 | Train Loss: 0.071 Vali Loss: 3.736 Vali Acc: 0.208 Test Loss: 3.736 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6402957439422607
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 4.216 Vali Acc: 0.194 Test Loss: 4.216 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6491448879241943
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 4.887 Vali Acc: 0.250 Test Loss: 4.887 Test Acc: 0.250
Validation loss decreased (-0.222183 --> -0.249951).  Saving model ...
Epoch: 10 cost time: 2.379265785217285
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 5.691 Vali Acc: 0.181 Test Loss: 5.691 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6048531532287598
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.811 Vali Acc: 0.194 Test Loss: 4.811 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6332526206970215
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 5.544 Vali Acc: 0.194 Test Loss: 5.544 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6353702545166016
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 5.965 Vali Acc: 0.153 Test Loss: 5.965 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3187127113342285
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.344 Vali Acc: 0.222 Test Loss: 5.344 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4001293182373047
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.409 Vali Acc: 0.250 Test Loss: 5.409 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2853844165802
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.433 Vali Acc: 0.250 Test Loss: 5.433 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6696290969848633
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.377 Vali Acc: 0.264 Test Loss: 5.377 Test Acc: 0.264
Validation loss decreased (-0.249951 --> -0.263835).  Saving model ...
Epoch: 18 cost time: 2.4885876178741455
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.386 Vali Acc: 0.264 Test Loss: 5.386 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.572699546813965
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.382 Vali Acc: 0.264 Test Loss: 5.382 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2920331954956055
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.359 Vali Acc: 0.250 Test Loss: 5.359 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2692928314208984
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.404 Vali Acc: 0.250 Test Loss: 5.404 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4527814388275146
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.409 Vali Acc: 0.250 Test Loss: 5.409 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3135592937469482
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.437 Vali Acc: 0.250 Test Loss: 5.437 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3034234046936035
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.565 Vali Acc: 0.264 Test Loss: 5.565 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.354930877685547
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.647 Vali Acc: 0.264 Test Loss: 5.647 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.218500852584839
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.664 Vali Acc: 0.264 Test Loss: 5.664 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.40175199508667
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.697 Vali Acc: 0.264 Test Loss: 5.697 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2638888888888889
model parameter : 4075404
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.425096035003662
Epoch: 1, Steps: 7 | Train Loss: 2.440 Vali Loss: 1.861 Vali Acc: 0.583 Test Loss: 1.861 Test Acc: 0.583
Validation loss decreased (inf --> -0.583315).  Saving model ...
Epoch: 2 cost time: 3.5242888927459717
Epoch: 2, Steps: 7 | Train Loss: 1.027 Vali Loss: 0.886 Vali Acc: 0.792 Test Loss: 0.886 Test Acc: 0.792
Validation loss decreased (-0.583315 --> -0.791658).  Saving model ...
Epoch: 3 cost time: 2.8757681846618652
Epoch: 3, Steps: 7 | Train Loss: 0.155 Vali Loss: 1.107 Vali Acc: 0.778 Test Loss: 1.107 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0205891132354736
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.433 Vali Acc: 0.750 Test Loss: 1.433 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2921462059020996
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.528 Vali Acc: 0.764 Test Loss: 1.528 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2941665649414062
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.778 Test Loss: 1.542 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2982113361358643
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.806 Test Loss: 1.687 Test Acc: 0.806
Validation loss decreased (-0.791658 --> -0.805539).  Saving model ...
Epoch: 8 cost time: 3.6737258434295654
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.806 Test Loss: 1.846 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.033761501312256
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.792 Test Loss: 1.898 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5861129760742188
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.792 Test Loss: 1.874 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0677876472473145
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.806 Test Loss: 1.808 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.169508218765259
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.806 Test Loss: 1.760 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.257977247238159
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.806 Test Loss: 1.723 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9966156482696533
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.819 Test Loss: 1.692 Test Acc: 0.819
Validation loss decreased (-0.805539 --> -0.819428).  Saving model ...
Epoch: 15 cost time: 2.877532482147217
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.819 Test Loss: 1.671 Test Acc: 0.819
Validation loss decreased (-0.819428 --> -0.819428).  Saving model ...
Epoch: 16 cost time: 2.716947555541992
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.833 Test Loss: 1.653 Test Acc: 0.833
Validation loss decreased (-0.819428 --> -0.833317).  Saving model ...
Epoch: 17 cost time: 2.9043123722076416
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.833 Test Loss: 1.639 Test Acc: 0.833
Validation loss decreased (-0.833317 --> -0.833317).  Saving model ...
Epoch: 18 cost time: 2.8586080074310303
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.833 Test Loss: 1.625 Test Acc: 0.833
Validation loss decreased (-0.833317 --> -0.833317).  Saving model ...
Epoch: 19 cost time: 3.0675220489501953
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.847 Test Loss: 1.610 Test Acc: 0.847
Validation loss decreased (-0.833317 --> -0.847206).  Saving model ...
Epoch: 20 cost time: 3.185979127883911
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.847 Test Loss: 1.597 Test Acc: 0.847
Validation loss decreased (-0.847206 --> -0.847206).  Saving model ...
Epoch: 21 cost time: 3.5857315063476562
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.847 Test Loss: 1.585 Test Acc: 0.847
Validation loss decreased (-0.847206 --> -0.847206).  Saving model ...
Epoch: 22 cost time: 3.1909027099609375
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.847 Test Loss: 1.575 Test Acc: 0.847
Validation loss decreased (-0.847206 --> -0.847206).  Saving model ...
Epoch: 23 cost time: 3.3567073345184326
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.861 Test Loss: 1.565 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861095).  Saving model ...
Epoch: 24 cost time: 3.138451099395752
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.861 Test Loss: 1.556 Test Acc: 0.861
Validation loss decreased (-0.861095 --> -0.861096).  Saving model ...
Epoch: 25 cost time: 3.073101282119751
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.861 Test Loss: 1.548 Test Acc: 0.861
Validation loss decreased (-0.861096 --> -0.861096).  Saving model ...
Epoch: 26 cost time: 2.7962100505828857
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.861 Test Loss: 1.540 Test Acc: 0.861
Validation loss decreased (-0.861096 --> -0.861096).  Saving model ...
Epoch: 27 cost time: 3.085223436355591
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.861 Test Loss: 1.531 Test Acc: 0.861
Validation loss decreased (-0.861096 --> -0.861096).  Saving model ...
Epoch: 28 cost time: 3.1564791202545166
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.861 Test Loss: 1.523 Test Acc: 0.861
Validation loss decreased (-0.861096 --> -0.861096).  Saving model ...
Epoch: 29 cost time: 3.4118032455444336
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.875 Test Loss: 1.516 Test Acc: 0.875
Validation loss decreased (-0.861096 --> -0.874985).  Saving model ...
Epoch: 30 cost time: 3.1552770137786865
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.875 Test Loss: 1.509 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 31 cost time: 3.5649311542510986
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.875 Test Loss: 1.503 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 32 cost time: 3.35099458694458
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.875 Test Loss: 1.497 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 33 cost time: 3.0809361934661865
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.875 Test Loss: 1.490 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 34 cost time: 2.943873643875122
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.875 Test Loss: 1.484 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 35 cost time: 3.038957357406616
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.875 Test Loss: 1.479 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 36 cost time: 2.7641043663024902
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.875 Test Loss: 1.473 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 37 cost time: 3.4824023246765137
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.875 Test Loss: 1.467 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 38 cost time: 3.1005592346191406
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.875 Test Loss: 1.461 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 39 cost time: 3.3508732318878174
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.875 Test Loss: 1.456 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 40 cost time: 3.1532084941864014
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.875 Test Loss: 1.451 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874985).  Saving model ...
Epoch: 41 cost time: 3.123633623123169
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.875 Test Loss: 1.446 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874986).  Saving model ...
Epoch: 42 cost time: 3.1416618824005127
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.875 Test Loss: 1.442 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 43 cost time: 2.951653003692627
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.875 Test Loss: 1.438 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 44 cost time: 3.083613395690918
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.875 Test Loss: 1.434 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 45 cost time: 2.9681622982025146
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.875 Test Loss: 1.429 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 46 cost time: 3.0401718616485596
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.875 Test Loss: 1.426 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 47 cost time: 3.167099952697754
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.875 Test Loss: 1.422 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 48 cost time: 3.150261640548706
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.875 Test Loss: 1.417 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 49 cost time: 3.456827402114868
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.875 Test Loss: 1.414 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 50 cost time: 3.3433148860931396
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.875 Test Loss: 1.412 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 51 cost time: 2.9043567180633545
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.875 Test Loss: 1.409 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 52 cost time: 3.046130657196045
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.875 Test Loss: 1.407 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 53 cost time: 2.9889979362487793
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.875 Test Loss: 1.404 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 54 cost time: 2.735414505004883
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.875 Test Loss: 1.401 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 55 cost time: 3.2180535793304443
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.875 Test Loss: 1.398 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 56 cost time: 3.10429048538208
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.875 Test Loss: 1.395 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 57 cost time: 3.3701603412628174
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.875 Test Loss: 1.393 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 58 cost time: 3.156181812286377
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.875 Test Loss: 1.391 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 59 cost time: 3.1284966468811035
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.875 Test Loss: 1.389 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 60 cost time: 2.8963565826416016
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.875 Test Loss: 1.386 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 61 cost time: 2.956470251083374
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.875 Test Loss: 1.384 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 62 cost time: 2.906583547592163
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.875 Test Loss: 1.382 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 63 cost time: 3.247133255004883
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.875 Test Loss: 1.380 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 64 cost time: 3.2993862628936768
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.875 Test Loss: 1.379 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 65 cost time: 3.347775936126709
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.875 Test Loss: 1.377 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 66 cost time: 3.026524066925049
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.875 Test Loss: 1.375 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 67 cost time: 3.5758907794952393
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.875 Test Loss: 1.373 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 68 cost time: 2.820297956466675
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.875 Test Loss: 1.371 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 69 cost time: 3.2186405658721924
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.875 Test Loss: 1.369 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 70 cost time: 2.9421639442443848
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.875 Test Loss: 1.368 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 71 cost time: 2.9343159198760986
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.875 Test Loss: 1.366 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 72 cost time: 3.09704852104187
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.875 Test Loss: 1.364 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 73 cost time: 3.3352391719818115
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.875 Test Loss: 1.363 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 74 cost time: 2.9833357334136963
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.875 Test Loss: 1.361 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 75 cost time: 3.497671365737915
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.875 Test Loss: 1.359 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 76 cost time: 2.9385673999786377
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.875 Test Loss: 1.358 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 77 cost time: 3.1338019371032715
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.875 Test Loss: 1.356 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 78 cost time: 2.915147304534912
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.875 Test Loss: 1.355 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 79 cost time: 3.2403993606567383
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.875 Test Loss: 1.355 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 80 cost time: 3.1645891666412354
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.875 Test Loss: 1.354 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 81 cost time: 3.53694748878479
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.875 Test Loss: 1.353 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 82 cost time: 3.2686681747436523
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.875 Test Loss: 1.352 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 83 cost time: 3.428837299346924
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.875 Test Loss: 1.351 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 84 cost time: 3.1286182403564453
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.875 Test Loss: 1.350 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874987).  Saving model ...
Epoch: 85 cost time: 3.112919569015503
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.875 Test Loss: 1.349 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 86 cost time: 3.17368745803833
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.875 Test Loss: 1.348 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 87 cost time: 3.19518780708313
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.875 Test Loss: 1.348 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 88 cost time: 2.895408868789673
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.875 Test Loss: 1.348 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 89 cost time: 3.2611615657806396
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.875 Test Loss: 1.346 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 90 cost time: 3.2854835987091064
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.875 Test Loss: 1.346 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 91 cost time: 3.2527916431427
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.875 Test Loss: 1.346 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 92 cost time: 3.3085126876831055
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.875 Test Loss: 1.345 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 93 cost time: 3.3558361530303955
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.875 Test Loss: 1.344 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 94 cost time: 2.93693470954895
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.875 Test Loss: 1.344 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 95 cost time: 3.2435531616210938
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.875 Test Loss: 1.343 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 96 cost time: 2.8288750648498535
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.875 Test Loss: 1.343 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 97 cost time: 3.2912065982818604
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.875 Test Loss: 1.342 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 98 cost time: 3.275658130645752
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.875 Test Loss: 1.341 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 99 cost time: 3.557112455368042
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.875 Test Loss: 1.341 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
Epoch: 100 cost time: 3.1653201580047607
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.875 Test Loss: 1.341 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874987).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9445056915283203
Epoch: 1, Steps: 7 | Train Loss: 2.481 Vali Loss: 1.990 Vali Acc: 0.556 Test Loss: 1.990 Test Acc: 0.556
Validation loss decreased (inf --> -0.555536).  Saving model ...
Epoch: 2 cost time: 2.8781018257141113
Epoch: 2, Steps: 7 | Train Loss: 1.217 Vali Loss: 0.997 Vali Acc: 0.792 Test Loss: 0.997 Test Acc: 0.792
Validation loss decreased (-0.555536 --> -0.791657).  Saving model ...
Epoch: 3 cost time: 2.990386724472046
Epoch: 3, Steps: 7 | Train Loss: 0.251 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9565157890319824
Epoch: 4, Steps: 7 | Train Loss: 0.042 Vali Loss: 1.093 Vali Acc: 0.764 Test Loss: 1.093 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.258934736251831
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.750 Test Loss: 1.321 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8861937522888184
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.515 Vali Acc: 0.736 Test Loss: 1.515 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.1959474086761475
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.819 Test Loss: 1.301 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819431).  Saving model ...
Epoch: 8 cost time: 2.8214917182922363
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.250 Vali Acc: 0.833 Test Loss: 1.250 Test Acc: 0.833
Validation loss decreased (-0.819431 --> -0.833321).  Saving model ...
Epoch: 9 cost time: 2.812504529953003
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.464 Vali Acc: 0.792 Test Loss: 1.464 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7283637523651123
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.819 Test Loss: 1.380 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9083409309387207
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 1.810 Vali Acc: 0.792 Test Loss: 1.810 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7809107303619385
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.241 Vali Acc: 0.778 Test Loss: 1.241 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.757190465927124
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.061 Vali Acc: 0.736 Test Loss: 2.061 Test Acc: 0.736
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.118053674697876
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.800 Vali Acc: 0.806 Test Loss: 1.800 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.976943016052246
Epoch: 15, Steps: 7 | Train Loss: 0.121 Vali Loss: 1.554 Vali Acc: 0.806 Test Loss: 1.554 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3281564712524414
Epoch: 16, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.627 Vali Acc: 0.750 Test Loss: 2.627 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.885870933532715
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.929 Vali Acc: 0.806 Test Loss: 1.929 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.0467071533203125
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.021 Vali Acc: 0.750 Test Loss: 2.021 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8333333333333334
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8195717334747314
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.170 Vali Acc: 0.403 Test Loss: 2.170 Test Acc: 0.403
Validation loss decreased (inf --> -0.402756).  Saving model ...
Epoch: 2 cost time: 2.723111867904663
Epoch: 2, Steps: 7 | Train Loss: 1.403 Vali Loss: 1.318 Vali Acc: 0.694 Test Loss: 1.318 Test Acc: 0.694
Validation loss decreased (-0.402756 --> -0.694431).  Saving model ...
Epoch: 3 cost time: 2.553333044052124
Epoch: 3, Steps: 7 | Train Loss: 0.405 Vali Loss: 1.250 Vali Acc: 0.694 Test Loss: 1.250 Test Acc: 0.694
Validation loss decreased (-0.694431 --> -0.694432).  Saving model ...
Epoch: 4 cost time: 2.6303865909576416
Epoch: 4, Steps: 7 | Train Loss: 0.133 Vali Loss: 1.243 Vali Acc: 0.667 Test Loss: 1.243 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.545302629470825
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.729 Vali Acc: 0.625 Test Loss: 1.729 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6195504665374756
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.171 Vali Acc: 0.764 Test Loss: 1.171 Test Acc: 0.764
Validation loss decreased (-0.694432 --> -0.763877).  Saving model ...
Epoch: 7 cost time: 2.7268075942993164
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.548264265060425
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.736 Test Loss: 1.313 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6280295848846436
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.722 Test Loss: 1.460 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5010929107666016
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.736 Test Loss: 1.336 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5801661014556885
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.722 Test Loss: 1.241 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5939104557037354
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.736 Test Loss: 1.191 Test Acc: 0.736
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.594850540161133
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.750 Test Loss: 1.160 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.758989095687866
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.750 Test Loss: 1.144 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.70064115524292
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.750 Test Loss: 1.141 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7997000217437744
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.750 Test Loss: 1.142 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7638888888888888
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.99782133102417
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.293 Vali Acc: 0.333 Test Loss: 2.293 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 2.5704081058502197
Epoch: 2, Steps: 7 | Train Loss: 1.608 Vali Loss: 1.611 Vali Acc: 0.542 Test Loss: 1.611 Test Acc: 0.542
Validation loss decreased (-0.333310 --> -0.541651).  Saving model ...
Epoch: 3 cost time: 2.692861557006836
Epoch: 3, Steps: 7 | Train Loss: 0.466 Vali Loss: 1.594 Vali Acc: 0.569 Test Loss: 1.594 Test Acc: 0.569
Validation loss decreased (-0.541651 --> -0.569429).  Saving model ...
Epoch: 4 cost time: 2.8302981853485107
Epoch: 4, Steps: 7 | Train Loss: 0.101 Vali Loss: 1.732 Vali Acc: 0.569 Test Loss: 1.732 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6311075687408447
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.685 Vali Acc: 0.611 Test Loss: 1.685 Test Acc: 0.611
Validation loss decreased (-0.569429 --> -0.611094).  Saving model ...
Epoch: 6 cost time: 2.7337472438812256
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.471 Vali Acc: 0.639 Test Loss: 1.471 Test Acc: 0.639
Validation loss decreased (-0.611094 --> -0.638874).  Saving model ...
Epoch: 7 cost time: 2.4587361812591553
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.625 Test Loss: 1.596 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.591820478439331
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.667 Test Loss: 1.592 Test Acc: 0.667
Validation loss decreased (-0.638874 --> -0.666651).  Saving model ...
Epoch: 9 cost time: 2.7312381267547607
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.653 Test Loss: 1.617 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.36433744430542
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.681 Test Loss: 1.541 Test Acc: 0.681
Validation loss decreased (-0.666651 --> -0.680540).  Saving model ...
Epoch: 11 cost time: 2.550452709197998
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.681 Test Loss: 1.489 Test Acc: 0.681
Validation loss decreased (-0.680540 --> -0.680541).  Saving model ...
Epoch: 12 cost time: 2.4094951152801514
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.681 Test Loss: 1.463 Test Acc: 0.681
Validation loss decreased (-0.680541 --> -0.680541).  Saving model ...
Epoch: 13 cost time: 2.483306407928467
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.667 Test Loss: 1.458 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.496022939682007
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.667 Test Loss: 1.460 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4550440311431885
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.667 Test Loss: 1.464 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7307629585266113
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.681 Test Loss: 1.471 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5730884075164795
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.681 Test Loss: 1.479 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.72379994392395
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.681 Test Loss: 1.486 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5828309059143066
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.681 Test Loss: 1.490 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5020265579223633
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.681 Test Loss: 1.492 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.829103946685791
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.681 Test Loss: 1.495 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4877288341522217
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.681 Test Loss: 1.497 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6805555555555556
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.572781562805176
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.409 Vali Acc: 0.167 Test Loss: 2.409 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.620868682861328
Epoch: 2, Steps: 7 | Train Loss: 1.803 Vali Loss: 2.034 Vali Acc: 0.306 Test Loss: 2.034 Test Acc: 0.306
Validation loss decreased (-0.166643 --> -0.305535).  Saving model ...
Epoch: 3 cost time: 2.1821327209472656
Epoch: 3, Steps: 7 | Train Loss: 0.570 Vali Loss: 2.091 Vali Acc: 0.375 Test Loss: 2.091 Test Acc: 0.375
Validation loss decreased (-0.305535 --> -0.374979).  Saving model ...
Epoch: 4 cost time: 2.2940218448638916
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 2.301 Vali Acc: 0.347 Test Loss: 2.301 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.436551809310913
Epoch: 5, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.439 Vali Acc: 0.431 Test Loss: 2.439 Test Acc: 0.431
Validation loss decreased (-0.374979 --> -0.430531).  Saving model ...
Epoch: 6 cost time: 2.429023027420044
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.784 Vali Acc: 0.458 Test Loss: 2.784 Test Acc: 0.458
Validation loss decreased (-0.430531 --> -0.458305).  Saving model ...
Epoch: 7 cost time: 2.418135166168213
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.760 Vali Acc: 0.444 Test Loss: 2.760 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3146169185638428
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.891 Vali Acc: 0.361 Test Loss: 2.891 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6106555461883545
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.148 Vali Acc: 0.389 Test Loss: 3.148 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4723198413848877
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.299 Vali Acc: 0.417 Test Loss: 3.299 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5135231018066406
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.339 Vali Acc: 0.417 Test Loss: 3.339 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4949517250061035
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.310 Vali Acc: 0.431 Test Loss: 3.310 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7091119289398193
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.240 Vali Acc: 0.444 Test Loss: 3.240 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8283960819244385
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.163 Vali Acc: 0.444 Test Loss: 3.163 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.787966012954712
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.096 Vali Acc: 0.431 Test Loss: 3.096 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6636476516723633
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.045 Vali Acc: 0.431 Test Loss: 3.045 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8187496662139893
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.398 Vali Acc: 0.139 Test Loss: 2.398 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.43306827545166
Epoch: 2, Steps: 7 | Train Loss: 1.919 Vali Loss: 1.981 Vali Acc: 0.278 Test Loss: 1.981 Test Acc: 0.278
Validation loss decreased (-0.138865 --> -0.277758).  Saving model ...
Epoch: 3 cost time: 2.473926305770874
Epoch: 3, Steps: 7 | Train Loss: 0.739 Vali Loss: 1.878 Vali Acc: 0.347 Test Loss: 1.878 Test Acc: 0.347
Validation loss decreased (-0.277758 --> -0.347203).  Saving model ...
Epoch: 4 cost time: 2.461620569229126
Epoch: 4, Steps: 7 | Train Loss: 0.186 Vali Loss: 2.207 Vali Acc: 0.389 Test Loss: 2.207 Test Acc: 0.389
Validation loss decreased (-0.347203 --> -0.388867).  Saving model ...
Epoch: 5 cost time: 2.208397150039673
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 2.368 Vali Acc: 0.389 Test Loss: 2.368 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2696008682250977
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 2.741 Vali Acc: 0.361 Test Loss: 2.741 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2824618816375732
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.266 Vali Acc: 0.431 Test Loss: 2.266 Test Acc: 0.431
Validation loss decreased (-0.388867 --> -0.430533).  Saving model ...
Epoch: 8 cost time: 2.4934425354003906
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.738 Vali Acc: 0.444 Test Loss: 2.738 Test Acc: 0.444
Validation loss decreased (-0.430533 --> -0.444417).  Saving model ...
Epoch: 9 cost time: 2.2610228061676025
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.248 Vali Acc: 0.514 Test Loss: 2.248 Test Acc: 0.514
Validation loss decreased (-0.444417 --> -0.513866).  Saving model ...
Epoch: 10 cost time: 2.2718253135681152
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.375 Vali Acc: 0.528 Test Loss: 2.375 Test Acc: 0.528
Validation loss decreased (-0.513866 --> -0.527754).  Saving model ...
Epoch: 11 cost time: 2.4586734771728516
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.294 Vali Acc: 0.500 Test Loss: 2.294 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.487877607345581
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.486 Test Loss: 2.296 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.433234930038452
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.500 Test Loss: 2.323 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.381620168685913
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.500 Test Loss: 2.350 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2892513275146484
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.365 Vali Acc: 0.500 Test Loss: 2.365 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3424789905548096
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.376 Vali Acc: 0.500 Test Loss: 2.376 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.475295066833496
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.378 Vali Acc: 0.500 Test Loss: 2.378 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3675150871276855
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.380 Vali Acc: 0.500 Test Loss: 2.380 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.402231454849243
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.377 Vali Acc: 0.500 Test Loss: 2.377 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3983547687530518
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.379 Vali Acc: 0.500 Test Loss: 2.379 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5277777777777778
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.625488758087158
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.395 Vali Acc: 0.097 Test Loss: 2.395 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.334146738052368
Epoch: 2, Steps: 7 | Train Loss: 2.052 Vali Loss: 2.001 Vali Acc: 0.361 Test Loss: 2.001 Test Acc: 0.361
Validation loss decreased (-0.097198 --> -0.361091).  Saving model ...
Epoch: 3 cost time: 2.5131826400756836
Epoch: 3, Steps: 7 | Train Loss: 0.910 Vali Loss: 1.869 Vali Acc: 0.389 Test Loss: 1.869 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388870).  Saving model ...
Epoch: 4 cost time: 2.3056604862213135
Epoch: 4, Steps: 7 | Train Loss: 0.275 Vali Loss: 2.102 Vali Acc: 0.389 Test Loss: 2.102 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2914369106292725
Epoch: 5, Steps: 7 | Train Loss: 0.071 Vali Loss: 1.981 Vali Acc: 0.389 Test Loss: 1.981 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.311474323272705
Epoch: 6, Steps: 7 | Train Loss: 0.024 Vali Loss: 1.920 Vali Acc: 0.472 Test Loss: 1.920 Test Acc: 0.472
Validation loss decreased (-0.388870 --> -0.472203).  Saving model ...
Epoch: 7 cost time: 2.434459924697876
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.763 Vali Acc: 0.472 Test Loss: 1.763 Test Acc: 0.472
Validation loss decreased (-0.472203 --> -0.472205).  Saving model ...
Epoch: 8 cost time: 2.411771297454834
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.901 Vali Acc: 0.500 Test Loss: 1.901 Test Acc: 0.500
Validation loss decreased (-0.472205 --> -0.499981).  Saving model ...
Epoch: 9 cost time: 2.3276591300964355
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.766 Vali Acc: 0.486 Test Loss: 1.766 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.282792568206787
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.556 Test Loss: 1.547 Test Acc: 0.556
Validation loss decreased (-0.499981 --> -0.555540).  Saving model ...
Epoch: 11 cost time: 2.486191987991333
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.583 Test Loss: 1.527 Test Acc: 0.583
Validation loss decreased (-0.555540 --> -0.583318).  Saving model ...
Epoch: 12 cost time: 2.521092653274536
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.556 Test Loss: 1.581 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2649943828582764
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.542 Test Loss: 1.645 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3652241230010986
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.528 Test Loss: 1.695 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3014187812805176
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.528 Test Loss: 1.718 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.473506450653076
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.514 Test Loss: 1.737 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.528463125228882
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.514 Test Loss: 1.740 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3992786407470703
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.500 Test Loss: 1.735 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3545773029327393
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.500 Test Loss: 1.725 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.702989339828491
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.500 Test Loss: 1.712 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4830851554870605
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.500 Test Loss: 1.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5833333333333334
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.025591135025024
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.435 Vali Acc: 0.111 Test Loss: 2.435 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 2.6274874210357666
Epoch: 2, Steps: 7 | Train Loss: 2.077 Vali Loss: 2.115 Vali Acc: 0.306 Test Loss: 2.115 Test Acc: 0.306
Validation loss decreased (-0.111087 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 2.3413658142089844
Epoch: 3, Steps: 7 | Train Loss: 1.010 Vali Loss: 2.109 Vali Acc: 0.236 Test Loss: 2.109 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4486777782440186
Epoch: 4, Steps: 7 | Train Loss: 0.313 Vali Loss: 2.104 Vali Acc: 0.389 Test Loss: 2.104 Test Acc: 0.389
Validation loss decreased (-0.305534 --> -0.388868).  Saving model ...
Epoch: 5 cost time: 2.558624029159546
Epoch: 5, Steps: 7 | Train Loss: 0.072 Vali Loss: 2.118 Vali Acc: 0.361 Test Loss: 2.118 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.392293930053711
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.549 Vali Acc: 0.306 Test Loss: 2.549 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.321276903152466
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.544 Vali Acc: 0.361 Test Loss: 2.544 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5658822059631348
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.528 Vali Acc: 0.417 Test Loss: 2.528 Test Acc: 0.417
Validation loss decreased (-0.388868 --> -0.416641).  Saving model ...
Epoch: 9 cost time: 2.51645565032959
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.459 Vali Acc: 0.375 Test Loss: 2.459 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.185514211654663
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.191 Vali Acc: 0.417 Test Loss: 2.191 Test Acc: 0.417
Validation loss decreased (-0.416641 --> -0.416645).  Saving model ...
Epoch: 11 cost time: 2.2802183628082275
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.084 Vali Acc: 0.458 Test Loss: 2.084 Test Acc: 0.458
Validation loss decreased (-0.416645 --> -0.458312).  Saving model ...
Epoch: 12 cost time: 2.504809617996216
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.077 Vali Acc: 0.444 Test Loss: 2.077 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5798146724700928
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.097 Vali Acc: 0.431 Test Loss: 2.097 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3990042209625244
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.121 Vali Acc: 0.458 Test Loss: 2.121 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.524127244949341
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.472 Test Loss: 2.136 Test Acc: 0.472
Validation loss decreased (-0.458312 --> -0.472201).  Saving model ...
Epoch: 16 cost time: 2.7975382804870605
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.159 Vali Acc: 0.472 Test Loss: 2.159 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7941553592681885
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.472 Test Loss: 2.173 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6343493461608887
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.472 Test Loss: 2.173 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.641322374343872
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.161 Vali Acc: 0.472 Test Loss: 2.161 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4907875061035156
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.155 Vali Acc: 0.472 Test Loss: 2.155 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5331249237060547
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.157 Vali Acc: 0.472 Test Loss: 2.157 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5289382934570312
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.157 Vali Acc: 0.486 Test Loss: 2.157 Test Acc: 0.486
Validation loss decreased (-0.472201 --> -0.486090).  Saving model ...
Epoch: 23 cost time: 2.5719962120056152
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.152 Vali Acc: 0.458 Test Loss: 2.152 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.763746976852417
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.144 Vali Acc: 0.458 Test Loss: 2.144 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.6341068744659424
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.144 Vali Acc: 0.458 Test Loss: 2.144 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.373192548751831
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.168 Vali Acc: 0.444 Test Loss: 2.168 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5413458347320557
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.444 Test Loss: 2.174 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3777523040771484
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.189 Vali Acc: 0.431 Test Loss: 2.189 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.534433603286743
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.195 Vali Acc: 0.431 Test Loss: 2.195 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3792994022369385
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.431 Test Loss: 2.204 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.370711326599121
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.431 Test Loss: 2.203 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.571993827819824
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.431 Test Loss: 2.206 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.542904853820801
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.444 Vali Acc: 0.139 Test Loss: 2.444 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 2.522952079772949
Epoch: 2, Steps: 7 | Train Loss: 2.175 Vali Loss: 2.274 Vali Acc: 0.222 Test Loss: 2.274 Test Acc: 0.222
Validation loss decreased (-0.138864 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 2.517179489135742
Epoch: 3, Steps: 7 | Train Loss: 1.371 Vali Loss: 2.263 Vali Acc: 0.167 Test Loss: 2.263 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.655674457550049
Epoch: 4, Steps: 7 | Train Loss: 0.638 Vali Loss: 2.289 Vali Acc: 0.306 Test Loss: 2.289 Test Acc: 0.306
Validation loss decreased (-0.222199 --> -0.305533).  Saving model ...
Epoch: 5 cost time: 2.646880626678467
Epoch: 5, Steps: 7 | Train Loss: 0.204 Vali Loss: 2.109 Vali Acc: 0.222 Test Loss: 2.109 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4949748516082764
Epoch: 6, Steps: 7 | Train Loss: 0.129 Vali Loss: 2.851 Vali Acc: 0.167 Test Loss: 2.851 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.818514823913574
Epoch: 7, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.366 Vali Acc: 0.278 Test Loss: 2.366 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.543738603591919
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.202 Vali Acc: 0.333 Test Loss: 2.202 Test Acc: 0.333
Validation loss decreased (-0.305533 --> -0.333311).  Saving model ...
Epoch: 9 cost time: 2.478837251663208
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.963 Vali Acc: 0.181 Test Loss: 2.963 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5239429473876953
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.210 Vali Acc: 0.181 Test Loss: 3.210 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4491372108459473
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.888 Vali Acc: 0.208 Test Loss: 2.888 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4589784145355225
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.683 Vali Acc: 0.278 Test Loss: 2.683 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2825093269348145
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.606 Vali Acc: 0.306 Test Loss: 2.606 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3618052005767822
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.306 Test Loss: 2.593 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4597971439361572
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.306 Test Loss: 2.641 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.30900239944458
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.701 Vali Acc: 0.319 Test Loss: 2.701 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.440995931625366
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.264 Test Loss: 2.726 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4238836765289307
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.767 Vali Acc: 0.264 Test Loss: 2.767 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3333333333333333
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.829591751098633
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.311 Vali Acc: 0.181 Test Loss: 2.311 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 2.540952205657959
Epoch: 2, Steps: 7 | Train Loss: 2.139 Vali Loss: 2.454 Vali Acc: 0.194 Test Loss: 2.454 Test Acc: 0.194
Validation loss decreased (-0.180532 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 2.289670467376709
Epoch: 3, Steps: 7 | Train Loss: 1.277 Vali Loss: 2.675 Vali Acc: 0.153 Test Loss: 2.675 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5258426666259766
Epoch: 4, Steps: 7 | Train Loss: 0.647 Vali Loss: 2.473 Vali Acc: 0.250 Test Loss: 2.473 Test Acc: 0.250
Validation loss decreased (-0.194420 --> -0.249975).  Saving model ...
Epoch: 5 cost time: 2.635410785675049
Epoch: 5, Steps: 7 | Train Loss: 0.266 Vali Loss: 2.618 Vali Acc: 0.222 Test Loss: 2.618 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3571860790252686
Epoch: 6, Steps: 7 | Train Loss: 0.139 Vali Loss: 3.204 Vali Acc: 0.208 Test Loss: 3.204 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4124534130096436
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 3.333 Vali Acc: 0.194 Test Loss: 3.333 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4116311073303223
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 3.592 Vali Acc: 0.264 Test Loss: 3.592 Test Acc: 0.264
Validation loss decreased (-0.249975 --> -0.263853).  Saving model ...
Epoch: 9 cost time: 2.5683610439300537
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 4.713 Vali Acc: 0.236 Test Loss: 4.713 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4409923553466797
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.395 Vali Acc: 0.222 Test Loss: 4.395 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.277728319168091
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.259 Vali Acc: 0.208 Test Loss: 4.259 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5240683555603027
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.421 Vali Acc: 0.222 Test Loss: 4.421 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7055294513702393
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.711 Vali Acc: 0.236 Test Loss: 4.711 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4629266262054443
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.941 Vali Acc: 0.250 Test Loss: 4.941 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.333984613418579
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.989 Vali Acc: 0.236 Test Loss: 4.989 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.357262372970581
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.919 Vali Acc: 0.222 Test Loss: 4.919 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.56512713432312
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.869 Vali Acc: 0.222 Test Loss: 4.869 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.460916042327881
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.859 Vali Acc: 0.222 Test Loss: 4.859 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2638888888888889
model parameter : 3288972
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.5393149852752686
Epoch: 1, Steps: 7 | Train Loss: 2.443 Vali Loss: 1.789 Vali Acc: 0.556 Test Loss: 1.789 Test Acc: 0.556
Validation loss decreased (inf --> -0.555538).  Saving model ...
Epoch: 2 cost time: 2.992469549179077
Epoch: 2, Steps: 7 | Train Loss: 0.926 Vali Loss: 0.993 Vali Acc: 0.694 Test Loss: 0.993 Test Acc: 0.694
Validation loss decreased (-0.555538 --> -0.694435).  Saving model ...
Epoch: 3 cost time: 2.956350564956665
Epoch: 3, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.004 Vali Acc: 0.806 Test Loss: 1.004 Test Acc: 0.806
Validation loss decreased (-0.694435 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 2.814908027648926
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.087 Vali Acc: 0.806 Test Loss: 1.087 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.146034002304077
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.469 Vali Acc: 0.750 Test Loss: 1.469 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.103682518005371
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.819 Test Loss: 1.331 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819431).  Saving model ...
Epoch: 7 cost time: 3.0770814418792725
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.847 Test Loss: 1.257 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847210).  Saving model ...
Epoch: 8 cost time: 3.3097643852233887
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.847 Test Loss: 1.264 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.110214948654175
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.847 Test Loss: 1.274 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.19077467918396
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.833 Test Loss: 1.310 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0791492462158203
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.833 Test Loss: 1.343 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.138788938522339
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.833 Test Loss: 1.366 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.741929054260254
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.833 Test Loss: 1.374 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.029836416244507
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.833 Test Loss: 1.372 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7577033042907715
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.833 Test Loss: 1.368 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0222699642181396
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.847 Test Loss: 1.364 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.930690288543701
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.861 Test Loss: 1.359 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861098).  Saving model ...
Epoch: 18 cost time: 3.24172306060791
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.861 Test Loss: 1.356 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861098).  Saving model ...
Epoch: 19 cost time: 3.0211241245269775
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.861 Test Loss: 1.354 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861098).  Saving model ...
Epoch: 20 cost time: 3.3579440116882324
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.861 Test Loss: 1.353 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861098).  Saving model ...
Epoch: 21 cost time: 2.840355634689331
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.861 Test Loss: 1.352 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861098).  Saving model ...
Epoch: 22 cost time: 3.1855454444885254
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.861 Test Loss: 1.351 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861098).  Saving model ...
Epoch: 23 cost time: 2.9853246212005615
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.861 Test Loss: 1.352 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.254129648208618
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.861 Test Loss: 1.351 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.910912275314331
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.861 Test Loss: 1.352 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.531106472015381
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.847 Test Loss: 1.351 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.2200465202331543
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.847 Test Loss: 1.352 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.388197898864746
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.847 Test Loss: 1.352 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.1307661533355713
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.847 Test Loss: 1.352 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.363114356994629
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.847 Test Loss: 1.353 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.869178056716919
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.847 Test Loss: 1.353 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.0094006061553955
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.847 Test Loss: 1.353 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.101975202560425
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 1.966 Vali Acc: 0.431 Test Loss: 1.966 Test Acc: 0.431
Validation loss decreased (inf --> -0.430536).  Saving model ...
Epoch: 2 cost time: 3.0798914432525635
Epoch: 2, Steps: 7 | Train Loss: 1.150 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
Validation loss decreased (-0.430536 --> -0.638877).  Saving model ...
Epoch: 3 cost time: 2.883357524871826
Epoch: 3, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.976 Vali Acc: 0.778 Test Loss: 0.976 Test Acc: 0.778
Validation loss decreased (-0.638877 --> -0.777768).  Saving model ...
Epoch: 4 cost time: 2.9882140159606934
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.295 Vali Acc: 0.722 Test Loss: 1.295 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.850310802459717
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.313 Vali Acc: 0.736 Test Loss: 1.313 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.839461326599121
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.764 Test Loss: 1.245 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6229279041290283
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.778 Test Loss: 1.328 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8071250915527344
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.778 Test Loss: 1.364 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.734930992126465
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.778 Test Loss: 1.393 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0854008197784424
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.778 Test Loss: 1.416 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.838855028152466
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.764 Test Loss: 1.435 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.91975998878479
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.764 Test Loss: 1.447 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.933749198913574
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.750 Test Loss: 1.454 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7769436836242676
Epoch: 1, Steps: 7 | Train Loss: 2.549 Vali Loss: 2.170 Vali Acc: 0.375 Test Loss: 2.170 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 2.4962308406829834
Epoch: 2, Steps: 7 | Train Loss: 1.393 Vali Loss: 1.448 Vali Acc: 0.597 Test Loss: 1.448 Test Acc: 0.597
Validation loss decreased (-0.374978 --> -0.597208).  Saving model ...
Epoch: 3 cost time: 2.5887277126312256
Epoch: 3, Steps: 7 | Train Loss: 0.328 Vali Loss: 1.053 Vali Acc: 0.722 Test Loss: 1.053 Test Acc: 0.722
Validation loss decreased (-0.597208 --> -0.722212).  Saving model ...
Epoch: 4 cost time: 2.5551559925079346
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 1.315 Vali Acc: 0.653 Test Loss: 1.315 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6137208938598633
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.935 Vali Acc: 0.764 Test Loss: 0.935 Test Acc: 0.764
Validation loss decreased (-0.722212 --> -0.763880).  Saving model ...
Epoch: 6 cost time: 2.679673433303833
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.927 Vali Acc: 0.708 Test Loss: 0.927 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5465927124023438
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.639 Test Loss: 1.623 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6603565216064453
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.132 Vali Acc: 0.611 Test Loss: 2.132 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5971388816833496
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.238 Vali Acc: 0.694 Test Loss: 1.238 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.686933994293213
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.531 Vali Acc: 0.694 Test Loss: 1.531 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8124403953552246
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.180 Vali Acc: 0.694 Test Loss: 2.180 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6773507595062256
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.286 Vali Acc: 0.653 Test Loss: 2.286 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.575716972351074
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.774 Vali Acc: 0.667 Test Loss: 1.774 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.8661909103393555
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.681 Test Loss: 2.035 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8214383125305176
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.653 Test Loss: 2.275 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7638888888888888
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.050726652145386
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.270 Vali Acc: 0.292 Test Loss: 2.270 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 2.507521629333496
Epoch: 2, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.674 Vali Acc: 0.514 Test Loss: 1.674 Test Acc: 0.514
Validation loss decreased (-0.291644 --> -0.513872).  Saving model ...
Epoch: 3 cost time: 2.474503993988037
Epoch: 3, Steps: 7 | Train Loss: 0.396 Vali Loss: 1.356 Vali Acc: 0.583 Test Loss: 1.356 Test Acc: 0.583
Validation loss decreased (-0.513872 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 2.610769510269165
Epoch: 4, Steps: 7 | Train Loss: 0.058 Vali Loss: 1.560 Vali Acc: 0.583 Test Loss: 1.560 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4442853927612305
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.240 Vali Acc: 0.611 Test Loss: 1.240 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611099).  Saving model ...
Epoch: 6 cost time: 2.5947446823120117
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.625 Test Loss: 1.564 Test Acc: 0.625
Validation loss decreased (-0.611099 --> -0.624984).  Saving model ...
Epoch: 7 cost time: 2.6972296237945557
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.625 Test Loss: 1.634 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4640729427337646
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.597 Test Loss: 1.642 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.615583658218384
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.625 Test Loss: 1.418 Test Acc: 0.625
Validation loss decreased (-0.624984 --> -0.624986).  Saving model ...
Epoch: 10 cost time: 2.5224924087524414
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.611 Test Loss: 1.461 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5343074798583984
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.611 Test Loss: 1.469 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4374771118164062
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.625 Test Loss: 1.426 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.364299774169922
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.625 Test Loss: 1.401 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624986).  Saving model ...
Epoch: 14 cost time: 2.394225835800171
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.625 Test Loss: 1.391 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624986).  Saving model ...
Epoch: 15 cost time: 2.33302903175354
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.639 Test Loss: 1.391 Test Acc: 0.639
Validation loss decreased (-0.624986 --> -0.638875).  Saving model ...
Epoch: 16 cost time: 2.448268175125122
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.639 Test Loss: 1.392 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.518935203552246
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.625 Test Loss: 1.394 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3171865940093994
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.625 Test Loss: 1.397 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.607588291168213
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.625 Test Loss: 1.400 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.450324058532715
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.625 Test Loss: 1.402 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6825649738311768
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.625 Test Loss: 1.403 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4749948978424072
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.625 Test Loss: 1.405 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7356295585632324
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.625 Test Loss: 1.409 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.594623327255249
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.625 Test Loss: 1.411 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5853190422058105
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.625 Test Loss: 1.414 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6388888888888888
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7106285095214844
Epoch: 1, Steps: 7 | Train Loss: 2.506 Vali Loss: 2.408 Vali Acc: 0.153 Test Loss: 2.408 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 2.3550219535827637
Epoch: 2, Steps: 7 | Train Loss: 1.701 Vali Loss: 2.128 Vali Acc: 0.319 Test Loss: 2.128 Test Acc: 0.319
Validation loss decreased (-0.152754 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 2.4337871074676514
Epoch: 3, Steps: 7 | Train Loss: 0.513 Vali Loss: 2.131 Vali Acc: 0.361 Test Loss: 2.131 Test Acc: 0.361
Validation loss decreased (-0.319423 --> -0.361090).  Saving model ...
Epoch: 4 cost time: 2.4691386222839355
Epoch: 4, Steps: 7 | Train Loss: 0.125 Vali Loss: 2.555 Vali Acc: 0.375 Test Loss: 2.555 Test Acc: 0.375
Validation loss decreased (-0.361090 --> -0.374974).  Saving model ...
Epoch: 5 cost time: 2.194790840148926
Epoch: 5, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.688 Vali Acc: 0.458 Test Loss: 2.688 Test Acc: 0.458
Validation loss decreased (-0.374974 --> -0.458306).  Saving model ...
Epoch: 6 cost time: 2.258711099624634
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.491 Vali Acc: 0.403 Test Loss: 2.491 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.338820695877075
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.888 Vali Acc: 0.361 Test Loss: 2.888 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.375699996948242
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.192 Vali Acc: 0.361 Test Loss: 3.192 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2889034748077393
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.387 Vali Acc: 0.417 Test Loss: 3.387 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2800490856170654
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.409 Vali Acc: 0.403 Test Loss: 3.409 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4624953269958496
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.318 Vali Acc: 0.403 Test Loss: 3.318 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.553804874420166
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.208 Vali Acc: 0.403 Test Loss: 3.208 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.443814516067505
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.124 Vali Acc: 0.389 Test Loss: 3.124 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.460312604904175
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.072 Vali Acc: 0.403 Test Loss: 3.072 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3503403663635254
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.050 Vali Acc: 0.403 Test Loss: 3.050 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5949153900146484
Epoch: 1, Steps: 7 | Train Loss: 2.520 Vali Loss: 2.408 Vali Acc: 0.125 Test Loss: 2.408 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.537693738937378
Epoch: 2, Steps: 7 | Train Loss: 1.868 Vali Loss: 2.041 Vali Acc: 0.306 Test Loss: 2.041 Test Acc: 0.306
Validation loss decreased (-0.124976 --> -0.305535).  Saving model ...
Epoch: 3 cost time: 2.3512802124023438
Epoch: 3, Steps: 7 | Train Loss: 0.655 Vali Loss: 1.877 Vali Acc: 0.417 Test Loss: 1.877 Test Acc: 0.417
Validation loss decreased (-0.305535 --> -0.416648).  Saving model ...
Epoch: 4 cost time: 2.461632251739502
Epoch: 4, Steps: 7 | Train Loss: 0.206 Vali Loss: 2.423 Vali Acc: 0.361 Test Loss: 2.423 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.420405864715576
Epoch: 5, Steps: 7 | Train Loss: 0.068 Vali Loss: 1.969 Vali Acc: 0.486 Test Loss: 1.969 Test Acc: 0.486
Validation loss decreased (-0.416648 --> -0.486091).  Saving model ...
Epoch: 6 cost time: 2.4975178241729736
Epoch: 6, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.693 Vali Acc: 0.403 Test Loss: 2.693 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.50750470161438
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.036 Vali Acc: 0.458 Test Loss: 2.036 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.529107093811035
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.976 Vali Acc: 0.389 Test Loss: 2.976 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.539113759994507
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.934 Vali Acc: 0.375 Test Loss: 2.934 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3937668800354004
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.848 Vali Acc: 0.361 Test Loss: 2.848 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3869681358337402
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.698 Vali Acc: 0.389 Test Loss: 2.698 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5296123027801514
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.567 Vali Acc: 0.403 Test Loss: 2.567 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3971922397613525
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.520 Vali Acc: 0.431 Test Loss: 2.520 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4240293502807617
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.518 Vali Acc: 0.458 Test Loss: 2.518 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.571906566619873
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.522 Vali Acc: 0.444 Test Loss: 2.522 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.608940601348877
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.385 Vali Acc: 0.208 Test Loss: 2.385 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.3256261348724365
Epoch: 2, Steps: 7 | Train Loss: 1.972 Vali Loss: 2.082 Vali Acc: 0.319 Test Loss: 2.082 Test Acc: 0.319
Validation loss decreased (-0.208309 --> -0.319424).  Saving model ...
Epoch: 3 cost time: 2.471754789352417
Epoch: 3, Steps: 7 | Train Loss: 0.779 Vali Loss: 1.835 Vali Acc: 0.458 Test Loss: 1.835 Test Acc: 0.458
Validation loss decreased (-0.319424 --> -0.458315).  Saving model ...
Epoch: 4 cost time: 2.3291709423065186
Epoch: 4, Steps: 7 | Train Loss: 0.274 Vali Loss: 2.211 Vali Acc: 0.333 Test Loss: 2.211 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.533198595046997
Epoch: 5, Steps: 7 | Train Loss: 0.062 Vali Loss: 1.824 Vali Acc: 0.500 Test Loss: 1.824 Test Acc: 0.500
Validation loss decreased (-0.458315 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 2.434910297393799
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.840 Vali Acc: 0.458 Test Loss: 1.840 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.453673839569092
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.867 Vali Acc: 0.444 Test Loss: 1.867 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2977957725524902
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.976 Vali Acc: 0.458 Test Loss: 1.976 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.335117816925049
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.500 Test Loss: 1.815 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499982).  Saving model ...
Epoch: 10 cost time: 2.285862922668457
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.458 Test Loss: 1.777 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5404257774353027
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.458 Test Loss: 1.821 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.506422996520996
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.444 Test Loss: 1.862 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.458333969116211
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.444 Test Loss: 1.879 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5756983757019043
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.431 Test Loss: 1.889 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6960113048553467
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.444 Test Loss: 1.894 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4537391662597656
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.458 Test Loss: 1.874 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4252209663391113
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.472 Test Loss: 1.862 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.422715187072754
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.472 Test Loss: 1.850 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.39434814453125
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.472 Test Loss: 1.835 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4720709323883057
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.403 Vali Acc: 0.194 Test Loss: 2.403 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.4530186653137207
Epoch: 2, Steps: 7 | Train Loss: 2.021 Vali Loss: 2.189 Vali Acc: 0.292 Test Loss: 2.189 Test Acc: 0.292
Validation loss decreased (-0.194420 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 2.3085131645202637
Epoch: 3, Steps: 7 | Train Loss: 0.887 Vali Loss: 1.997 Vali Acc: 0.444 Test Loss: 1.997 Test Acc: 0.444
Validation loss decreased (-0.291645 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 2.459007740020752
Epoch: 4, Steps: 7 | Train Loss: 0.306 Vali Loss: 2.401 Vali Acc: 0.375 Test Loss: 2.401 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.210645914077759
Epoch: 5, Steps: 7 | Train Loss: 0.074 Vali Loss: 1.977 Vali Acc: 0.389 Test Loss: 1.977 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4117960929870605
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.014 Vali Acc: 0.472 Test Loss: 2.014 Test Acc: 0.472
Validation loss decreased (-0.444424 --> -0.472202).  Saving model ...
Epoch: 7 cost time: 2.443798780441284
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.307 Vali Acc: 0.431 Test Loss: 2.307 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.425138473510742
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.120 Vali Acc: 0.389 Test Loss: 2.120 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.52974009513855
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.077 Vali Acc: 0.389 Test Loss: 2.077 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8287854194641113
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.009 Vali Acc: 0.444 Test Loss: 2.009 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.564423084259033
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.472 Test Loss: 2.135 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5984885692596436
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.272 Vali Acc: 0.458 Test Loss: 2.272 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3535125255584717
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.472 Test Loss: 2.271 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.509978771209717
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.458 Test Loss: 2.227 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.348906993865967
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.458 Test Loss: 2.182 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3032455444335938
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.458 Test Loss: 2.141 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8364317417144775
Epoch: 1, Steps: 7 | Train Loss: 2.536 Vali Loss: 2.435 Vali Acc: 0.139 Test Loss: 2.435 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.570827007293701
Epoch: 2, Steps: 7 | Train Loss: 2.211 Vali Loss: 2.326 Vali Acc: 0.167 Test Loss: 2.326 Test Acc: 0.167
Validation loss decreased (-0.138865 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 2.4419538974761963
Epoch: 3, Steps: 7 | Train Loss: 1.235 Vali Loss: 2.289 Vali Acc: 0.236 Test Loss: 2.289 Test Acc: 0.236
Validation loss decreased (-0.166643 --> -0.236088).  Saving model ...
Epoch: 4 cost time: 2.569719076156616
Epoch: 4, Steps: 7 | Train Loss: 0.604 Vali Loss: 2.449 Vali Acc: 0.153 Test Loss: 2.449 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4450490474700928
Epoch: 5, Steps: 7 | Train Loss: 0.199 Vali Loss: 2.324 Vali Acc: 0.250 Test Loss: 2.324 Test Acc: 0.250
Validation loss decreased (-0.236088 --> -0.249977).  Saving model ...
Epoch: 6 cost time: 2.436331272125244
Epoch: 6, Steps: 7 | Train Loss: 0.079 Vali Loss: 2.461 Vali Acc: 0.264 Test Loss: 2.461 Test Acc: 0.264
Validation loss decreased (-0.249977 --> -0.263864).  Saving model ...
Epoch: 7 cost time: 2.6691553592681885
Epoch: 7, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.524 Vali Acc: 0.292 Test Loss: 2.524 Test Acc: 0.292
Validation loss decreased (-0.263864 --> -0.291641).  Saving model ...
Epoch: 8 cost time: 2.787443161010742
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.474 Vali Acc: 0.264 Test Loss: 2.474 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6227047443389893
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.779 Vali Acc: 0.250 Test Loss: 2.779 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.484963893890381
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.368 Vali Acc: 0.236 Test Loss: 2.368 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.562063694000244
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.414 Vali Acc: 0.278 Test Loss: 2.414 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.539508581161499
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.539 Vali Acc: 0.278 Test Loss: 2.539 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.55169415473938
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.578 Vali Acc: 0.250 Test Loss: 2.578 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6314895153045654
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.518 Vali Acc: 0.250 Test Loss: 2.518 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.642472505569458
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.533 Vali Acc: 0.292 Test Loss: 2.533 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7829253673553467
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.264 Test Loss: 2.547 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.429440975189209
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.565 Vali Acc: 0.250 Test Loss: 2.565 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3756301403045654
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.406 Vali Acc: 0.181 Test Loss: 2.406 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.352973222732544
Epoch: 2, Steps: 7 | Train Loss: 2.100 Vali Loss: 2.699 Vali Acc: 0.222 Test Loss: 2.699 Test Acc: 0.222
Validation loss decreased (-0.180531 --> -0.222195).  Saving model ...
Epoch: 3 cost time: 2.4697201251983643
Epoch: 3, Steps: 7 | Train Loss: 1.256 Vali Loss: 2.651 Vali Acc: 0.208 Test Loss: 2.651 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3672447204589844
Epoch: 4, Steps: 7 | Train Loss: 0.646 Vali Loss: 2.721 Vali Acc: 0.208 Test Loss: 2.721 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3662006855010986
Epoch: 5, Steps: 7 | Train Loss: 0.246 Vali Loss: 2.816 Vali Acc: 0.250 Test Loss: 2.816 Test Acc: 0.250
Validation loss decreased (-0.222195 --> -0.249972).  Saving model ...
Epoch: 6 cost time: 2.2791528701782227
Epoch: 6, Steps: 7 | Train Loss: 0.099 Vali Loss: 3.241 Vali Acc: 0.236 Test Loss: 3.241 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3732731342315674
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 3.498 Vali Acc: 0.153 Test Loss: 3.498 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.386267900466919
Epoch: 8, Steps: 7 | Train Loss: 0.033 Vali Loss: 3.756 Vali Acc: 0.222 Test Loss: 3.756 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.284045934677124
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 4.964 Vali Acc: 0.264 Test Loss: 4.964 Test Acc: 0.264
Validation loss decreased (-0.249972 --> -0.263839).  Saving model ...
Epoch: 10 cost time: 2.3359248638153076
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 4.581 Vali Acc: 0.208 Test Loss: 4.581 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4881949424743652
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.579 Vali Acc: 0.250 Test Loss: 4.579 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.463940143585205
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 5.171 Vali Acc: 0.208 Test Loss: 5.171 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.324418544769287
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.580 Vali Acc: 0.236 Test Loss: 5.580 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3992018699645996
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.759 Vali Acc: 0.236 Test Loss: 5.759 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.46834659576416
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.702 Vali Acc: 0.222 Test Loss: 5.702 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5521204471588135
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.534 Vali Acc: 0.236 Test Loss: 5.534 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.299565553665161
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.410 Vali Acc: 0.236 Test Loss: 5.410 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.355717658996582
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.325 Vali Acc: 0.222 Test Loss: 5.325 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.55073881149292
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.323 Vali Acc: 0.236 Test Loss: 5.323 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2638888888888889
model parameter : 2895756
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.242056608200073
Epoch: 1, Steps: 7 | Train Loss: 2.506 Vali Loss: 1.923 Vali Acc: 0.569 Test Loss: 1.923 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 3.3184778690338135
Epoch: 2, Steps: 7 | Train Loss: 1.016 Vali Loss: 0.989 Vali Acc: 0.681 Test Loss: 0.989 Test Acc: 0.681
Validation loss decreased (-0.569425 --> -0.680546).  Saving model ...
Epoch: 3 cost time: 3.0122077465057373
Epoch: 3, Steps: 7 | Train Loss: 0.172 Vali Loss: 1.176 Vali Acc: 0.764 Test Loss: 1.176 Test Acc: 0.764
Validation loss decreased (-0.680546 --> -0.763877).  Saving model ...
Epoch: 4 cost time: 3.2021989822387695
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.370 Vali Acc: 0.792 Test Loss: 1.370 Test Acc: 0.792
Validation loss decreased (-0.763877 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 3.003265380859375
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.191 Vali Acc: 0.861 Test Loss: 1.191 Test Acc: 0.861
Validation loss decreased (-0.791653 --> -0.861099).  Saving model ...
Epoch: 6 cost time: 3.0064637660980225
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.819 Test Loss: 1.250 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1651182174682617
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.819 Test Loss: 1.320 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0098676681518555
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.833 Test Loss: 1.358 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.437861204147339
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.819 Test Loss: 1.375 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.255737543106079
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.833 Test Loss: 1.385 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3605687618255615
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.833 Test Loss: 1.391 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9555106163024902
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.833 Test Loss: 1.396 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2838950157165527
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.819 Test Loss: 1.399 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.968681812286377
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.819 Test Loss: 1.402 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.413459539413452
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.819 Test Loss: 1.405 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.1146204471588135
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.058 Vali Acc: 0.486 Test Loss: 2.058 Test Acc: 0.486
Validation loss decreased (inf --> -0.486091).  Saving model ...
Epoch: 2 cost time: 3.0278985500335693
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 1.158 Vali Acc: 0.681 Test Loss: 1.158 Test Acc: 0.681
Validation loss decreased (-0.486091 --> -0.680544).  Saving model ...
Epoch: 3 cost time: 2.9627981185913086
Epoch: 3, Steps: 7 | Train Loss: 0.267 Vali Loss: 1.181 Vali Acc: 0.681 Test Loss: 1.181 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.963451385498047
Epoch: 4, Steps: 7 | Train Loss: 0.041 Vali Loss: 1.157 Vali Acc: 0.806 Test Loss: 1.157 Test Acc: 0.806
Validation loss decreased (-0.680544 --> -0.805544).  Saving model ...
Epoch: 5 cost time: 2.5634396076202393
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.091 Vali Acc: 0.806 Test Loss: 1.091 Test Acc: 0.806
Validation loss decreased (-0.805544 --> -0.805545).  Saving model ...
Epoch: 6 cost time: 2.728008270263672
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.290 Vali Acc: 0.764 Test Loss: 1.290 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7132668495178223
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.427 Vali Acc: 0.736 Test Loss: 1.427 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.033092498779297
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.750 Test Loss: 1.572 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.068000316619873
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.778 Test Loss: 1.751 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.168509006500244
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.778 Test Loss: 1.730 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9306325912475586
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.778 Test Loss: 1.695 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.135936975479126
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.778 Test Loss: 1.675 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.796623945236206
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.778 Test Loss: 1.660 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7746286392211914
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.778 Test Loss: 1.644 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7669200897216797
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.778 Test Loss: 1.634 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8055555555555556
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.318864822387695
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.200 Vali Acc: 0.389 Test Loss: 2.200 Test Acc: 0.389
Validation loss decreased (inf --> -0.388867).  Saving model ...
Epoch: 2 cost time: 2.742870807647705
Epoch: 2, Steps: 7 | Train Loss: 1.478 Vali Loss: 1.463 Vali Acc: 0.597 Test Loss: 1.463 Test Acc: 0.597
Validation loss decreased (-0.388867 --> -0.597208).  Saving model ...
Epoch: 3 cost time: 2.814358711242676
Epoch: 3, Steps: 7 | Train Loss: 0.451 Vali Loss: 1.329 Vali Acc: 0.681 Test Loss: 1.329 Test Acc: 0.681
Validation loss decreased (-0.597208 --> -0.680542).  Saving model ...
Epoch: 4 cost time: 2.7338132858276367
Epoch: 4, Steps: 7 | Train Loss: 0.098 Vali Loss: 1.008 Vali Acc: 0.736 Test Loss: 1.008 Test Acc: 0.736
Validation loss decreased (-0.680542 --> -0.736101).  Saving model ...
Epoch: 5 cost time: 2.6799283027648926
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.477 Vali Acc: 0.625 Test Loss: 1.477 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9319677352905273
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.775 Vali Acc: 0.611 Test Loss: 1.775 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.526582956314087
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.366 Vali Acc: 0.708 Test Loss: 1.366 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6547625064849854
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.750 Test Loss: 1.348 Test Acc: 0.750
Validation loss decreased (-0.736101 --> -0.749987).  Saving model ...
Epoch: 9 cost time: 2.5757863521575928
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.750 Test Loss: 1.332 Test Acc: 0.750
Validation loss decreased (-0.749987 --> -0.749987).  Saving model ...
Epoch: 10 cost time: 2.9206011295318604
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.750 Test Loss: 1.205 Test Acc: 0.750
Validation loss decreased (-0.749987 --> -0.749988).  Saving model ...
Epoch: 11 cost time: 2.59930419921875
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.764 Test Loss: 1.176 Test Acc: 0.764
Validation loss decreased (-0.749988 --> -0.763877).  Saving model ...
Epoch: 12 cost time: 2.692126989364624
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.778 Test Loss: 1.173 Test Acc: 0.778
Validation loss decreased (-0.763877 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 2.668907642364502
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.778 Test Loss: 1.173 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 14 cost time: 2.6749649047851562
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.792 Test Loss: 1.172 Test Acc: 0.792
Validation loss decreased (-0.777766 --> -0.791655).  Saving model ...
Epoch: 15 cost time: 2.635164737701416
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.806 Test Loss: 1.172 Test Acc: 0.806
Validation loss decreased (-0.791655 --> -0.805544).  Saving model ...
Epoch: 16 cost time: 2.638801097869873
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.806 Test Loss: 1.169 Test Acc: 0.806
Validation loss decreased (-0.805544 --> -0.805544).  Saving model ...
Epoch: 17 cost time: 2.813899278640747
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.792 Test Loss: 1.167 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.693115711212158
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.792 Test Loss: 1.166 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4238202571868896
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.792 Test Loss: 1.166 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.764683246612549
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.792 Test Loss: 1.166 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.626558303833008
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.778 Test Loss: 1.166 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6986985206604004
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.764 Test Loss: 1.167 Test Acc: 0.764
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4584028720855713
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.764 Test Loss: 1.169 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.760456085205078
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.764 Test Loss: 1.170 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.614208459854126
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.764 Test Loss: 1.171 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.46932315826416
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.764 Test Loss: 1.173 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8055555555555556
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7024102210998535
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.322 Vali Acc: 0.278 Test Loss: 2.322 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 2.51846981048584
Epoch: 2, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.812 Vali Acc: 0.472 Test Loss: 1.812 Test Acc: 0.472
Validation loss decreased (-0.277755 --> -0.472204).  Saving model ...
Epoch: 3 cost time: 2.620767593383789
Epoch: 3, Steps: 7 | Train Loss: 0.552 Vali Loss: 1.654 Vali Acc: 0.514 Test Loss: 1.654 Test Acc: 0.514
Validation loss decreased (-0.472204 --> -0.513872).  Saving model ...
Epoch: 4 cost time: 2.7437119483947754
Epoch: 4, Steps: 7 | Train Loss: 0.119 Vali Loss: 1.308 Vali Acc: 0.653 Test Loss: 1.308 Test Acc: 0.653
Validation loss decreased (-0.513872 --> -0.652765).  Saving model ...
Epoch: 5 cost time: 2.5325281620025635
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.866 Vali Acc: 0.556 Test Loss: 1.866 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5885353088378906
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.556 Test Loss: 1.644 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.550464630126953
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.569 Test Loss: 1.661 Test Acc: 0.569
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5168516635894775
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.611 Test Loss: 1.710 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6369433403015137
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.625 Test Loss: 1.742 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6830999851226807
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.639 Test Loss: 1.722 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.563706636428833
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.653 Test Loss: 1.708 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.638810157775879
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.653 Test Loss: 1.697 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.695699691772461
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.653 Test Loss: 1.689 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7491869926452637
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.639 Test Loss: 1.676 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6527777777777778
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.602874279022217
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.448 Vali Acc: 0.208 Test Loss: 2.448 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.3305716514587402
Epoch: 2, Steps: 7 | Train Loss: 1.909 Vali Loss: 2.162 Vali Acc: 0.389 Test Loss: 2.162 Test Acc: 0.389
Validation loss decreased (-0.208309 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 2.417137384414673
Epoch: 3, Steps: 7 | Train Loss: 0.780 Vali Loss: 2.365 Vali Acc: 0.347 Test Loss: 2.365 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4567644596099854
Epoch: 4, Steps: 7 | Train Loss: 0.195 Vali Loss: 2.066 Vali Acc: 0.444 Test Loss: 2.066 Test Acc: 0.444
Validation loss decreased (-0.388867 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 2.3201725482940674
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.740 Vali Acc: 0.389 Test Loss: 2.740 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5380489826202393
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.988 Vali Acc: 0.417 Test Loss: 2.988 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3709020614624023
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.972 Vali Acc: 0.403 Test Loss: 2.972 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.295905113220215
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.192 Vali Acc: 0.347 Test Loss: 3.192 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4998068809509277
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.927 Vali Acc: 0.361 Test Loss: 3.927 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3719725608825684
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.086 Vali Acc: 0.431 Test Loss: 3.086 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5295064449310303
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.215 Vali Acc: 0.417 Test Loss: 3.215 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4442267417907715
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.210 Vali Acc: 0.431 Test Loss: 3.210 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3435797691345215
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.254 Vali Acc: 0.417 Test Loss: 3.254 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.598994255065918
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.286 Vali Acc: 0.417 Test Loss: 3.286 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5198802947998047
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.400 Vali Acc: 0.208 Test Loss: 2.400 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.2599942684173584
Epoch: 2, Steps: 7 | Train Loss: 2.017 Vali Loss: 2.023 Vali Acc: 0.417 Test Loss: 2.023 Test Acc: 0.417
Validation loss decreased (-0.208309 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 2.380398988723755
Epoch: 3, Steps: 7 | Train Loss: 0.967 Vali Loss: 2.140 Vali Acc: 0.319 Test Loss: 2.140 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.330206871032715
Epoch: 4, Steps: 7 | Train Loss: 0.250 Vali Loss: 1.785 Vali Acc: 0.431 Test Loss: 1.785 Test Acc: 0.431
Validation loss decreased (-0.416646 --> -0.430538).  Saving model ...
Epoch: 5 cost time: 2.378605365753174
Epoch: 5, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.153 Vali Acc: 0.431 Test Loss: 2.153 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5819685459136963
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.153 Vali Acc: 0.417 Test Loss: 2.153 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.308515787124634
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.696 Vali Acc: 0.389 Test Loss: 2.696 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4408719539642334
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.500 Vali Acc: 0.444 Test Loss: 2.500 Test Acc: 0.444
Validation loss decreased (-0.430538 --> -0.444419).  Saving model ...
Epoch: 9 cost time: 2.5320780277252197
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.303 Vali Acc: 0.431 Test Loss: 2.303 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4607841968536377
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.316 Vali Acc: 0.444 Test Loss: 2.316 Test Acc: 0.444
Validation loss decreased (-0.444419 --> -0.444421).  Saving model ...
Epoch: 11 cost time: 2.4761159420013428
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.390 Vali Acc: 0.458 Test Loss: 2.390 Test Acc: 0.458
Validation loss decreased (-0.444421 --> -0.458309).  Saving model ...
Epoch: 12 cost time: 2.428373098373413
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.486 Test Loss: 2.561 Test Acc: 0.486
Validation loss decreased (-0.458309 --> -0.486085).  Saving model ...
Epoch: 13 cost time: 2.3610336780548096
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.570 Vali Acc: 0.458 Test Loss: 2.570 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.611137866973877
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.465 Vali Acc: 0.500 Test Loss: 2.465 Test Acc: 0.500
Validation loss decreased (-0.486085 --> -0.499975).  Saving model ...
Epoch: 15 cost time: 2.480154275894165
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.514 Test Loss: 2.350 Test Acc: 0.514
Validation loss decreased (-0.499975 --> -0.513865).  Saving model ...
Epoch: 16 cost time: 2.439178943634033
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.293 Vali Acc: 0.514 Test Loss: 2.293 Test Acc: 0.514
Validation loss decreased (-0.513865 --> -0.513866).  Saving model ...
Epoch: 17 cost time: 2.4973437786102295
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.514 Test Loss: 2.267 Test Acc: 0.514
Validation loss decreased (-0.513866 --> -0.513866).  Saving model ...
Epoch: 18 cost time: 2.549551010131836
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.500 Test Loss: 2.263 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4296042919158936
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.500 Test Loss: 2.263 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4288365840911865
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.270 Vali Acc: 0.500 Test Loss: 2.270 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3942041397094727
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.276 Vali Acc: 0.500 Test Loss: 2.276 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.595113754272461
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.276 Vali Acc: 0.500 Test Loss: 2.276 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.30135440826416
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.514 Test Loss: 2.267 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4099411964416504
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.254 Vali Acc: 0.514 Test Loss: 2.254 Test Acc: 0.514
Validation loss decreased (-0.513866 --> -0.513866).  Saving model ...
Epoch: 25 cost time: 2.412874460220337
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.257 Vali Acc: 0.500 Test Loss: 2.257 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3943545818328857
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.500 Test Loss: 2.261 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2685635089874268
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.253 Vali Acc: 0.514 Test Loss: 2.253 Test Acc: 0.514
Validation loss decreased (-0.513866 --> -0.513866).  Saving model ...
Epoch: 28 cost time: 2.2007830142974854
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.253 Vali Acc: 0.500 Test Loss: 2.253 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3486106395721436
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.253 Vali Acc: 0.514 Test Loss: 2.253 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.338376045227051
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.514 Test Loss: 2.260 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3425793647766113
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.253 Vali Acc: 0.514 Test Loss: 2.253 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.278675079345703
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.251 Vali Acc: 0.514 Test Loss: 2.251 Test Acc: 0.514
Validation loss decreased (-0.513866 --> -0.513866).  Saving model ...
Epoch: 33 cost time: 2.3490798473358154
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.255 Vali Acc: 0.514 Test Loss: 2.255 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.4989097118377686
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.254 Vali Acc: 0.514 Test Loss: 2.254 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.3173341751098633
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.528 Test Loss: 2.256 Test Acc: 0.528
Validation loss decreased (-0.513866 --> -0.527755).  Saving model ...
Epoch: 36 cost time: 2.5358710289001465
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.528 Test Loss: 2.259 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.7071785926818848
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.528 Test Loss: 2.261 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.6225154399871826
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.258 Vali Acc: 0.528 Test Loss: 2.258 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.4123141765594482
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.254 Vali Acc: 0.528 Test Loss: 2.254 Test Acc: 0.528
Validation loss decreased (-0.527755 --> -0.527755).  Saving model ...
Epoch: 40 cost time: 2.297239065170288
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.528 Test Loss: 2.252 Test Acc: 0.528
Validation loss decreased (-0.527755 --> -0.527755).  Saving model ...
Epoch: 41 cost time: 2.522463798522949
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.528 Test Loss: 2.252 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.7042396068573
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.528 Test Loss: 2.249 Test Acc: 0.528
Validation loss decreased (-0.527755 --> -0.527755).  Saving model ...
Epoch: 43 cost time: 2.3929126262664795
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.245 Vali Acc: 0.528 Test Loss: 2.245 Test Acc: 0.528
Validation loss decreased (-0.527755 --> -0.527755).  Saving model ...
Epoch: 44 cost time: 2.4351465702056885
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.244 Vali Acc: 0.528 Test Loss: 2.244 Test Acc: 0.528
Validation loss decreased (-0.527755 --> -0.527755).  Saving model ...
Epoch: 45 cost time: 2.340902805328369
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.245 Vali Acc: 0.528 Test Loss: 2.245 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.4404022693634033
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.237 Vali Acc: 0.528 Test Loss: 2.237 Test Acc: 0.528
Validation loss decreased (-0.527755 --> -0.527755).  Saving model ...
Epoch: 47 cost time: 2.31858229637146
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.239 Vali Acc: 0.528 Test Loss: 2.239 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.37719464302063
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.251 Vali Acc: 0.528 Test Loss: 2.251 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.3184823989868164
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.262 Vali Acc: 0.528 Test Loss: 2.262 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.339855432510376
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.528 Test Loss: 2.267 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.3083620071411133
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.528 Test Loss: 2.256 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.3798890113830566
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.238 Vali Acc: 0.528 Test Loss: 2.238 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.5154364109039307
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.240 Vali Acc: 0.528 Test Loss: 2.240 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.527787446975708
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.241 Vali Acc: 0.528 Test Loss: 2.241 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.370008707046509
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.238 Vali Acc: 0.528 Test Loss: 2.238 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.3419368267059326
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.240 Vali Acc: 0.528 Test Loss: 2.240 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5277777777777778
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5789451599121094
Epoch: 1, Steps: 7 | Train Loss: 2.591 Vali Loss: 2.386 Vali Acc: 0.306 Test Loss: 2.386 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 2.500709056854248
Epoch: 2, Steps: 7 | Train Loss: 2.108 Vali Loss: 2.040 Vali Acc: 0.431 Test Loss: 2.040 Test Acc: 0.431
Validation loss decreased (-0.305532 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 2.27264666557312
Epoch: 3, Steps: 7 | Train Loss: 1.113 Vali Loss: 2.078 Vali Acc: 0.361 Test Loss: 2.078 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.339716672897339
Epoch: 4, Steps: 7 | Train Loss: 0.346 Vali Loss: 1.601 Vali Acc: 0.458 Test Loss: 1.601 Test Acc: 0.458
Validation loss decreased (-0.430535 --> -0.458317).  Saving model ...
Epoch: 5 cost time: 2.270266056060791
Epoch: 5, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.109 Vali Acc: 0.347 Test Loss: 2.109 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.277658700942993
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.118 Vali Acc: 0.319 Test Loss: 2.118 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0989232063293457
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.282 Vali Acc: 0.347 Test Loss: 2.282 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.162804365158081
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.020 Vali Acc: 0.403 Test Loss: 2.020 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.087259292602539
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.534 Vali Acc: 0.361 Test Loss: 2.534 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2227816581726074
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.151 Vali Acc: 0.403 Test Loss: 2.151 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.149395704269409
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.399 Vali Acc: 0.361 Test Loss: 2.399 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2143216133117676
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.155 Vali Acc: 0.361 Test Loss: 2.155 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1548943519592285
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.431 Test Loss: 1.868 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.323171615600586
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.444 Test Loss: 1.799 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.556929349899292
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.405 Vali Acc: 0.222 Test Loss: 2.405 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 2.4049220085144043
Epoch: 2, Steps: 7 | Train Loss: 2.172 Vali Loss: 2.162 Vali Acc: 0.472 Test Loss: 2.162 Test Acc: 0.472
Validation loss decreased (-0.222198 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 2.478778123855591
Epoch: 3, Steps: 7 | Train Loss: 1.224 Vali Loss: 2.252 Vali Acc: 0.431 Test Loss: 2.252 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.428495168685913
Epoch: 4, Steps: 7 | Train Loss: 0.410 Vali Loss: 1.869 Vali Acc: 0.417 Test Loss: 1.869 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6598458290100098
Epoch: 5, Steps: 7 | Train Loss: 0.114 Vali Loss: 2.568 Vali Acc: 0.236 Test Loss: 2.568 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.534855842590332
Epoch: 6, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.194 Vali Acc: 0.333 Test Loss: 2.194 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.490696907043457
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.307 Vali Acc: 0.361 Test Loss: 2.307 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4176714420318604
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.990 Vali Acc: 0.403 Test Loss: 1.990 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.649502754211426
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.028 Vali Acc: 0.319 Test Loss: 3.028 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.490488290786743
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.587 Vali Acc: 0.417 Test Loss: 2.587 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.584805727005005
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.472 Test Loss: 2.172 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3253672122955322
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.043 Vali Acc: 0.472 Test Loss: 2.043 Test Acc: 0.472
Validation loss decreased (-0.472201 --> -0.472202).  Saving model ...
Epoch: 13 cost time: 2.3617334365844727
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.019 Vali Acc: 0.472 Test Loss: 2.019 Test Acc: 0.472
Validation loss decreased (-0.472202 --> -0.472202).  Saving model ...
Epoch: 14 cost time: 2.3381922245025635
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.486 Test Loss: 2.020 Test Acc: 0.486
Validation loss decreased (-0.472202 --> -0.486091).  Saving model ...
Epoch: 15 cost time: 2.5120084285736084
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.458 Test Loss: 2.038 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5886003971099854
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.458 Test Loss: 2.086 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3640244007110596
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.157 Vali Acc: 0.444 Test Loss: 2.157 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.383694887161255
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.444 Test Loss: 2.221 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.377589225769043
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.266 Vali Acc: 0.444 Test Loss: 2.266 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.525707721710205
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.304 Vali Acc: 0.444 Test Loss: 2.304 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6018004417419434
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.444 Test Loss: 2.320 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6872146129608154
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.444 Test Loss: 2.323 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4851067066192627
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.314 Vali Acc: 0.444 Test Loss: 2.314 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5726921558380127
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.301 Vali Acc: 0.444 Test Loss: 2.301 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.836444139480591
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.391 Vali Acc: 0.181 Test Loss: 2.391 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 2.63325572013855
Epoch: 2, Steps: 7 | Train Loss: 2.310 Vali Loss: 2.288 Vali Acc: 0.292 Test Loss: 2.288 Test Acc: 0.292
Validation loss decreased (-0.180532 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 2.3184051513671875
Epoch: 3, Steps: 7 | Train Loss: 1.537 Vali Loss: 2.481 Vali Acc: 0.222 Test Loss: 2.481 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.41772723197937
Epoch: 4, Steps: 7 | Train Loss: 0.705 Vali Loss: 2.202 Vali Acc: 0.278 Test Loss: 2.202 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.624631404876709
Epoch: 5, Steps: 7 | Train Loss: 0.266 Vali Loss: 2.608 Vali Acc: 0.222 Test Loss: 2.608 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.461594343185425
Epoch: 6, Steps: 7 | Train Loss: 0.110 Vali Loss: 2.668 Vali Acc: 0.125 Test Loss: 2.668 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.534282922744751
Epoch: 7, Steps: 7 | Train Loss: 0.065 Vali Loss: 2.776 Vali Acc: 0.167 Test Loss: 2.776 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.523216962814331
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.655 Vali Acc: 0.181 Test Loss: 3.655 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.491283416748047
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 2.929 Vali Acc: 0.181 Test Loss: 2.929 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.18826961517334
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.647 Vali Acc: 0.250 Test Loss: 2.647 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4430184364318848
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.242 Vali Acc: 0.250 Test Loss: 3.242 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.250166177749634
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.931 Vali Acc: 0.236 Test Loss: 2.931 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.364109992980957
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.369 Vali Acc: 0.208 Test Loss: 2.369 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.3582353591918945
Epoch: 2, Steps: 7 | Train Loss: 2.184 Vali Loss: 2.555 Vali Acc: 0.208 Test Loss: 2.555 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2839794158935547
Epoch: 3, Steps: 7 | Train Loss: 1.460 Vali Loss: 2.777 Vali Acc: 0.250 Test Loss: 2.777 Test Acc: 0.250
Validation loss decreased (-0.208310 --> -0.249972).  Saving model ...
Epoch: 4 cost time: 2.4846599102020264
Epoch: 4, Steps: 7 | Train Loss: 0.720 Vali Loss: 2.774 Vali Acc: 0.167 Test Loss: 2.774 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5326497554779053
Epoch: 5, Steps: 7 | Train Loss: 0.301 Vali Loss: 2.750 Vali Acc: 0.236 Test Loss: 2.750 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.284000873565674
Epoch: 6, Steps: 7 | Train Loss: 0.148 Vali Loss: 3.215 Vali Acc: 0.250 Test Loss: 3.215 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.316399097442627
Epoch: 7, Steps: 7 | Train Loss: 0.081 Vali Loss: 3.983 Vali Acc: 0.181 Test Loss: 3.983 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.701167583465576
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 3.917 Vali Acc: 0.236 Test Loss: 3.917 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.355393171310425
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 4.382 Vali Acc: 0.181 Test Loss: 4.382 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5548171997070312
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 4.612 Vali Acc: 0.167 Test Loss: 4.612 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2221925258636475
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.648 Vali Acc: 0.250 Test Loss: 4.648 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2093520164489746
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 4.783 Vali Acc: 0.278 Test Loss: 4.783 Test Acc: 0.278
Validation loss decreased (-0.249972 --> -0.277730).  Saving model ...
Epoch: 13 cost time: 2.3471810817718506
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 4.764 Vali Acc: 0.250 Test Loss: 4.764 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.434391498565674
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.546 Vali Acc: 0.250 Test Loss: 4.546 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.165766954421997
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.665 Vali Acc: 0.250 Test Loss: 4.665 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4052419662475586
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.977 Vali Acc: 0.250 Test Loss: 4.977 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2811439037323
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.232 Vali Acc: 0.278 Test Loss: 5.232 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.710141897201538
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.360 Vali Acc: 0.278 Test Loss: 5.360 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4730377197265625
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.419 Vali Acc: 0.278 Test Loss: 5.419 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5327155590057373
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.396 Vali Acc: 0.278 Test Loss: 5.396 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.353477954864502
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.348 Vali Acc: 0.278 Test Loss: 5.348 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4455201625823975
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.320 Vali Acc: 0.278 Test Loss: 5.320 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2777777777777778
model parameter : 2699148
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.49931001663208
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 1.789 Vali Acc: 0.681 Test Loss: 1.789 Test Acc: 0.681
Validation loss decreased (inf --> -0.680538).  Saving model ...
Epoch: 2 cost time: 3.3927464485168457
Epoch: 2, Steps: 7 | Train Loss: 0.983 Vali Loss: 0.921 Vali Acc: 0.792 Test Loss: 0.921 Test Acc: 0.792
Validation loss decreased (-0.680538 --> -0.791657).  Saving model ...
Epoch: 3 cost time: 3.2043423652648926
Epoch: 3, Steps: 7 | Train Loss: 0.175 Vali Loss: 1.131 Vali Acc: 0.750 Test Loss: 1.131 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.740391492843628
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.314 Vali Acc: 0.792 Test Loss: 1.314 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4742417335510254
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.322 Vali Acc: 0.764 Test Loss: 1.322 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.294616222381592
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.251 Vali Acc: 0.792 Test Loss: 1.251 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8148086071014404
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.819 Test Loss: 1.266 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819432).  Saving model ...
Epoch: 8 cost time: 3.1229076385498047
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.819 Test Loss: 1.294 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3473098278045654
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.819 Test Loss: 1.311 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4359865188598633
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.819 Test Loss: 1.318 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0154335498809814
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.806 Test Loss: 1.323 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.853982925415039
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.819 Test Loss: 1.324 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.931168794631958
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.819 Test Loss: 1.325 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.500047206878662
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.833 Test Loss: 1.326 Test Acc: 0.833
Validation loss decreased (-0.819432 --> -0.833320).  Saving model ...
Epoch: 15 cost time: 3.136389970779419
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.833 Test Loss: 1.326 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.941941022872925
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.847 Test Loss: 1.326 Test Acc: 0.847
Validation loss decreased (-0.833320 --> -0.847209).  Saving model ...
Epoch: 17 cost time: 3.0166447162628174
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.847 Test Loss: 1.326 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 18 cost time: 3.0883283615112305
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.847 Test Loss: 1.327 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.266429901123047
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.847 Test Loss: 1.326 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 20 cost time: 3.1893935203552246
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 21 cost time: 3.089303731918335
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 22 cost time: 3.128080368041992
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 23 cost time: 3.2496211528778076
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 24 cost time: 2.916201114654541
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 25 cost time: 2.87506103515625
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 26 cost time: 2.963071823120117
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.847 Test Loss: 1.322 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 27 cost time: 3.0311079025268555
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0542750358581543
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.847 Test Loss: 1.322 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1809701919555664
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0105996131896973
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0200130939483643
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.1521921157836914
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.019361972808838
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.957866668701172
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.9174506664276123
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.847 Test Loss: 1.322 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 36 cost time: 3.1558191776275635
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.847 Test Loss: 1.321 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 37 cost time: 3.0743556022644043
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.847 Test Loss: 1.321 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 38 cost time: 3.3131823539733887
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.847 Test Loss: 1.321 Test Acc: 0.847
Validation loss decreased (-0.847209 --> -0.847209).  Saving model ...
Epoch: 39 cost time: 3.156634569168091
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.847 Test Loss: 1.322 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.211867332458496
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.0003437995910645
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.847 Test Loss: 1.325 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.8510472774505615
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.847 Test Loss: 1.325 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.015864372253418
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.0961883068084717
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.4218719005584717
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.847 Test Loss: 1.324 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.946512222290039
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.847 Test Loss: 1.325 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.2803707122802734
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.847 Test Loss: 1.325 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.2967820167541504
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.847 Test Loss: 1.325 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.145313739776611
Epoch: 1, Steps: 7 | Train Loss: 2.485 Vali Loss: 1.932 Vali Acc: 0.583 Test Loss: 1.932 Test Acc: 0.583
Validation loss decreased (inf --> -0.583314).  Saving model ...
Epoch: 2 cost time: 2.8167080879211426
Epoch: 2, Steps: 7 | Train Loss: 1.193 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.583314 --> -0.749990).  Saving model ...
Epoch: 3 cost time: 2.7892119884490967
Epoch: 3, Steps: 7 | Train Loss: 0.256 Vali Loss: 1.294 Vali Acc: 0.722 Test Loss: 1.294 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.138699531555176
Epoch: 4, Steps: 7 | Train Loss: 0.023 Vali Loss: 1.066 Vali Acc: 0.778 Test Loss: 1.066 Test Acc: 0.778
Validation loss decreased (-0.749990 --> -0.777767).  Saving model ...
Epoch: 5 cost time: 3.040728807449341
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.984 Vali Acc: 0.847 Test Loss: 0.984 Test Acc: 0.847
Validation loss decreased (-0.777767 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 3.3379595279693604
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.498 Vali Acc: 0.778 Test Loss: 1.498 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0724079608917236
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.152 Vali Acc: 0.792 Test Loss: 1.152 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.180530309677124
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.750 Test Loss: 1.649 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.808464288711548
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.046 Vali Acc: 0.722 Test Loss: 2.046 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9063467979431152
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.028 Vali Acc: 0.750 Test Loss: 2.028 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.773285388946533
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.736 Test Loss: 2.120 Test Acc: 0.736
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.184201717376709
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.764 Test Loss: 1.796 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8639230728149414
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.806 Test Loss: 1.561 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.096644639968872
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.792 Test Loss: 1.524 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8531153202056885
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.792 Test Loss: 1.519 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.605536460876465
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.107 Vali Acc: 0.514 Test Loss: 2.107 Test Acc: 0.514
Validation loss decreased (inf --> -0.513868).  Saving model ...
Epoch: 2 cost time: 2.500948429107666
Epoch: 2, Steps: 7 | Train Loss: 1.423 Vali Loss: 1.376 Vali Acc: 0.653 Test Loss: 1.376 Test Acc: 0.653
Validation loss decreased (-0.513868 --> -0.652764).  Saving model ...
Epoch: 3 cost time: 2.6731789112091064
Epoch: 3, Steps: 7 | Train Loss: 0.408 Vali Loss: 1.709 Vali Acc: 0.611 Test Loss: 1.709 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.581822633743286
Epoch: 4, Steps: 7 | Train Loss: 0.079 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.652764 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 2.8853631019592285
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.267 Vali Acc: 0.681 Test Loss: 1.267 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.703657388687134
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.607 Vali Acc: 0.625 Test Loss: 1.607 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6788532733917236
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.911724090576172
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.764 Test Loss: 1.094 Test Acc: 0.764
Validation loss decreased (-0.749989 --> -0.763878).  Saving model ...
Epoch: 9 cost time: 2.6799285411834717
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.750 Test Loss: 1.132 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.708956003189087
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.764 Test Loss: 1.133 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8576159477233887
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.764 Test Loss: 1.129 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.712689161300659
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.778 Test Loss: 1.131 Test Acc: 0.778
Validation loss decreased (-0.763878 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 2.5070412158966064
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.778 Test Loss: 1.132 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8276920318603516
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.778 Test Loss: 1.130 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 15 cost time: 2.709763526916504
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.778 Test Loss: 1.127 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777767).  Saving model ...
Epoch: 16 cost time: 2.9788014888763428
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.778 Test Loss: 1.122 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 17 cost time: 2.7989048957824707
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.119 Vali Acc: 0.778 Test Loss: 1.119 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 18 cost time: 2.666558027267456
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.778 Test Loss: 1.116 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 19 cost time: 2.794339418411255
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.778 Test Loss: 1.113 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 20 cost time: 2.464132070541382
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.792 Test Loss: 1.109 Test Acc: 0.792
Validation loss decreased (-0.777767 --> -0.791656).  Saving model ...
Epoch: 21 cost time: 2.622865915298462
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.792 Test Loss: 1.104 Test Acc: 0.792
Validation loss decreased (-0.791656 --> -0.791656).  Saving model ...
Epoch: 22 cost time: 2.3878560066223145
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.792 Test Loss: 1.100 Test Acc: 0.792
Validation loss decreased (-0.791656 --> -0.791656).  Saving model ...
Epoch: 23 cost time: 2.6671254634857178
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.806 Test Loss: 1.096 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805545).  Saving model ...
Epoch: 24 cost time: 2.5669097900390625
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.806 Test Loss: 1.093 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 25 cost time: 2.7401254177093506
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.806 Test Loss: 1.090 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 26 cost time: 2.574753522872925
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.806 Test Loss: 1.085 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 27 cost time: 2.8172473907470703
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.084 Vali Acc: 0.806 Test Loss: 1.084 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 28 cost time: 2.6671152114868164
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.806 Test Loss: 1.081 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 29 cost time: 2.715695858001709
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.806 Test Loss: 1.081 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 30 cost time: 2.479773759841919
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.792 Test Loss: 1.080 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.5856173038482666
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.792 Test Loss: 1.078 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.6568808555603027
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.792 Test Loss: 1.076 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.4275999069213867
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.792 Test Loss: 1.073 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.478825569152832
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.792 Test Loss: 1.070 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.473438024520874
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.792 Test Loss: 1.068 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.9313254356384277
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.792 Test Loss: 1.069 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.5561556816101074
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.792 Test Loss: 1.069 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.855741500854492
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.792 Test Loss: 1.068 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.7706868648529053
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.792 Test Loss: 1.069 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8055555555555556
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.795553207397461
Epoch: 1, Steps: 7 | Train Loss: 2.545 Vali Loss: 2.186 Vali Acc: 0.389 Test Loss: 2.186 Test Acc: 0.389
Validation loss decreased (inf --> -0.388867).  Saving model ...
Epoch: 2 cost time: 2.410233497619629
Epoch: 2, Steps: 7 | Train Loss: 1.571 Vali Loss: 1.690 Vali Acc: 0.528 Test Loss: 1.690 Test Acc: 0.528
Validation loss decreased (-0.388867 --> -0.527761).  Saving model ...
Epoch: 3 cost time: 2.8585188388824463
Epoch: 3, Steps: 7 | Train Loss: 0.502 Vali Loss: 1.575 Vali Acc: 0.583 Test Loss: 1.575 Test Acc: 0.583
Validation loss decreased (-0.527761 --> -0.583318).  Saving model ...
Epoch: 4 cost time: 2.4730169773101807
Epoch: 4, Steps: 7 | Train Loss: 0.073 Vali Loss: 1.391 Vali Acc: 0.611 Test Loss: 1.391 Test Acc: 0.611
Validation loss decreased (-0.583318 --> -0.611097).  Saving model ...
Epoch: 5 cost time: 2.6935980319976807
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.885 Vali Acc: 0.569 Test Loss: 1.885 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2969954013824463
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.692 Vali Acc: 0.583 Test Loss: 1.692 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5011038780212402
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.575 Vali Acc: 0.653 Test Loss: 1.575 Test Acc: 0.653
Validation loss decreased (-0.611097 --> -0.652762).  Saving model ...
Epoch: 8 cost time: 2.7368860244750977
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.272 Vali Acc: 0.639 Test Loss: 2.272 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.623262643814087
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.964 Vali Acc: 0.653 Test Loss: 1.964 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5626134872436523
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.653 Test Loss: 1.736 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.592416286468506
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.597 Test Loss: 1.745 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.813406467437744
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.625 Test Loss: 1.665 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.709885358810425
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.639 Test Loss: 1.577 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5909979343414307
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.653 Test Loss: 1.528 Test Acc: 0.653
Validation loss decreased (-0.652762 --> -0.652762).  Saving model ...
Epoch: 15 cost time: 2.68796706199646
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.667 Test Loss: 1.508 Test Acc: 0.667
Validation loss decreased (-0.652762 --> -0.666652).  Saving model ...
Epoch: 16 cost time: 2.372145652770996
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.653 Test Loss: 1.505 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4900519847869873
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.653 Test Loss: 1.507 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.850491762161255
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.653 Test Loss: 1.510 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5918467044830322
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.653 Test Loss: 1.517 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4082815647125244
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.653 Test Loss: 1.525 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3927924633026123
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.653 Test Loss: 1.535 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4118127822875977
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.653 Test Loss: 1.541 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4092698097229004
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.653 Test Loss: 1.545 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5127804279327393
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.653 Test Loss: 1.548 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.616687297821045
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.653 Test Loss: 1.551 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6666666666666666
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6956350803375244
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.363 Vali Acc: 0.208 Test Loss: 2.363 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.5244462490081787
Epoch: 2, Steps: 7 | Train Loss: 1.706 Vali Loss: 2.048 Vali Acc: 0.264 Test Loss: 2.048 Test Acc: 0.264
Validation loss decreased (-0.208310 --> -0.263868).  Saving model ...
Epoch: 3 cost time: 2.7720272541046143
Epoch: 3, Steps: 7 | Train Loss: 0.630 Vali Loss: 2.238 Vali Acc: 0.417 Test Loss: 2.238 Test Acc: 0.417
Validation loss decreased (-0.263868 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 2.761033535003662
Epoch: 4, Steps: 7 | Train Loss: 0.127 Vali Loss: 2.190 Vali Acc: 0.375 Test Loss: 2.190 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.572378158569336
Epoch: 5, Steps: 7 | Train Loss: 0.031 Vali Loss: 2.754 Vali Acc: 0.403 Test Loss: 2.754 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7867043018341064
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.923 Vali Acc: 0.389 Test Loss: 2.923 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.819399356842041
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.635 Vali Acc: 0.458 Test Loss: 2.635 Test Acc: 0.458
Validation loss decreased (-0.416644 --> -0.458307).  Saving model ...
Epoch: 8 cost time: 2.3968355655670166
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.862 Vali Acc: 0.403 Test Loss: 2.862 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.499202251434326
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.186 Vali Acc: 0.347 Test Loss: 3.186 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5716142654418945
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.610 Vali Acc: 0.389 Test Loss: 3.610 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4764599800109863
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.850 Vali Acc: 0.361 Test Loss: 3.850 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3180794715881348
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.619 Vali Acc: 0.389 Test Loss: 3.619 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6442465782165527
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.421 Vali Acc: 0.403 Test Loss: 3.421 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.307096481323242
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.307 Vali Acc: 0.361 Test Loss: 3.307 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.675662040710449
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.245 Vali Acc: 0.375 Test Loss: 3.245 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3421735763549805
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.212 Vali Acc: 0.375 Test Loss: 3.212 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.510998010635376
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.214 Vali Acc: 0.375 Test Loss: 3.214 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6705410480499268
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.354 Vali Acc: 0.208 Test Loss: 2.354 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.4579873085021973
Epoch: 2, Steps: 7 | Train Loss: 1.844 Vali Loss: 1.925 Vali Acc: 0.361 Test Loss: 1.925 Test Acc: 0.361
Validation loss decreased (-0.208310 --> -0.361092).  Saving model ...
Epoch: 3 cost time: 2.453789234161377
Epoch: 3, Steps: 7 | Train Loss: 0.773 Vali Loss: 1.952 Vali Acc: 0.375 Test Loss: 1.952 Test Acc: 0.375
Validation loss decreased (-0.361092 --> -0.374980).  Saving model ...
Epoch: 4 cost time: 2.461796522140503
Epoch: 4, Steps: 7 | Train Loss: 0.204 Vali Loss: 1.904 Vali Acc: 0.389 Test Loss: 1.904 Test Acc: 0.389
Validation loss decreased (-0.374980 --> -0.388870).  Saving model ...
Epoch: 5 cost time: 2.3746135234832764
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 2.377 Vali Acc: 0.403 Test Loss: 2.377 Test Acc: 0.403
Validation loss decreased (-0.388870 --> -0.402754).  Saving model ...
Epoch: 6 cost time: 2.622049570083618
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.385 Vali Acc: 0.472 Test Loss: 2.385 Test Acc: 0.472
Validation loss decreased (-0.402754 --> -0.472198).  Saving model ...
Epoch: 7 cost time: 2.4961791038513184
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.419 Vali Acc: 0.431 Test Loss: 2.419 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5462567806243896
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.666 Vali Acc: 0.319 Test Loss: 2.666 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5299978256225586
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.683 Vali Acc: 0.361 Test Loss: 2.683 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6560609340667725
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.609 Vali Acc: 0.431 Test Loss: 2.609 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5053505897521973
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.648 Vali Acc: 0.431 Test Loss: 2.648 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.458770275115967
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.505 Vali Acc: 0.444 Test Loss: 2.505 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.268688201904297
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.405 Vali Acc: 0.458 Test Loss: 2.405 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6624019145965576
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.385 Vali Acc: 0.444 Test Loss: 2.385 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2696449756622314
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.392 Vali Acc: 0.417 Test Loss: 2.392 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3756630420684814
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.417 Test Loss: 2.402 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.617436170578003
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.375 Vali Acc: 0.236 Test Loss: 2.375 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 2.577986001968384
Epoch: 2, Steps: 7 | Train Loss: 1.950 Vali Loss: 1.957 Vali Acc: 0.361 Test Loss: 1.957 Test Acc: 0.361
Validation loss decreased (-0.236087 --> -0.361092).  Saving model ...
Epoch: 3 cost time: 2.302564859390259
Epoch: 3, Steps: 7 | Train Loss: 0.923 Vali Loss: 1.951 Vali Acc: 0.403 Test Loss: 1.951 Test Acc: 0.403
Validation loss decreased (-0.361092 --> -0.402758).  Saving model ...
Epoch: 4 cost time: 2.509002208709717
Epoch: 4, Steps: 7 | Train Loss: 0.306 Vali Loss: 1.846 Vali Acc: 0.292 Test Loss: 1.846 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6523215770721436
Epoch: 5, Steps: 7 | Train Loss: 0.101 Vali Loss: 2.151 Vali Acc: 0.431 Test Loss: 2.151 Test Acc: 0.431
Validation loss decreased (-0.402758 --> -0.430534).  Saving model ...
Epoch: 6 cost time: 2.5350430011749268
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 2.252 Vali Acc: 0.333 Test Loss: 2.252 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.383615016937256
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.342 Vali Acc: 0.403 Test Loss: 2.342 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5264055728912354
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.166 Vali Acc: 0.347 Test Loss: 2.166 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3836817741394043
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.345 Vali Acc: 0.417 Test Loss: 2.345 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3762526512145996
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.148 Vali Acc: 0.458 Test Loss: 2.148 Test Acc: 0.458
Validation loss decreased (-0.430534 --> -0.458312).  Saving model ...
Epoch: 11 cost time: 2.478640556335449
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.444 Test Loss: 2.001 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.911142349243164
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.444 Test Loss: 1.894 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1811327934265137
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.458 Test Loss: 1.838 Test Acc: 0.458
Validation loss decreased (-0.458312 --> -0.458315).  Saving model ...
Epoch: 14 cost time: 2.2311644554138184
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.500 Test Loss: 1.828 Test Acc: 0.500
Validation loss decreased (-0.458315 --> -0.499982).  Saving model ...
Epoch: 15 cost time: 2.3294155597686768
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.500 Test Loss: 1.849 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.640062093734741
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.500 Test Loss: 1.870 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.082347869873047
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.486 Test Loss: 1.912 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3567423820495605
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.472 Test Loss: 1.930 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3819477558135986
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.472 Test Loss: 1.927 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2607805728912354
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.472 Test Loss: 1.921 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2601001262664795
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.486 Test Loss: 1.912 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.411874532699585
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.486 Test Loss: 1.903 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3039064407348633
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.500 Test Loss: 1.909 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3576812744140625
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.486 Test Loss: 1.913 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7586629390716553
Epoch: 1, Steps: 7 | Train Loss: 2.605 Vali Loss: 2.371 Vali Acc: 0.194 Test Loss: 2.371 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 2.6136276721954346
Epoch: 2, Steps: 7 | Train Loss: 2.067 Vali Loss: 2.049 Vali Acc: 0.333 Test Loss: 2.049 Test Acc: 0.333
Validation loss decreased (-0.194421 --> -0.333313).  Saving model ...
Epoch: 3 cost time: 2.517847776412964
Epoch: 3, Steps: 7 | Train Loss: 1.049 Vali Loss: 2.064 Vali Acc: 0.333 Test Loss: 2.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4502861499786377
Epoch: 4, Steps: 7 | Train Loss: 0.346 Vali Loss: 1.947 Vali Acc: 0.333 Test Loss: 1.947 Test Acc: 0.333
Validation loss decreased (-0.333313 --> -0.333314).  Saving model ...
Epoch: 5 cost time: 2.8123669624328613
Epoch: 5, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.463 Vali Acc: 0.375 Test Loss: 2.463 Test Acc: 0.375
Validation loss decreased (-0.333314 --> -0.374975).  Saving model ...
Epoch: 6 cost time: 2.435394048690796
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.492 Vali Acc: 0.278 Test Loss: 2.492 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4236345291137695
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.494 Vali Acc: 0.375 Test Loss: 2.494 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.520754098892212
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.038 Vali Acc: 0.444 Test Loss: 2.038 Test Acc: 0.444
Validation loss decreased (-0.374975 --> -0.444424).  Saving model ...
Epoch: 9 cost time: 2.457003116607666
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.208 Vali Acc: 0.403 Test Loss: 2.208 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.396888494491577
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.488 Vali Acc: 0.375 Test Loss: 2.488 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.744948625564575
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.435 Vali Acc: 0.375 Test Loss: 2.435 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3707289695739746
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.310 Vali Acc: 0.361 Test Loss: 2.310 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.812859535217285
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.361 Test Loss: 2.249 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.555219888687134
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.224 Vali Acc: 0.375 Test Loss: 2.224 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5314102172851562
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.211 Vali Acc: 0.389 Test Loss: 2.211 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.608600616455078
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.389 Test Loss: 2.204 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.347287893295288
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.218 Vali Acc: 0.389 Test Loss: 2.218 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4980685710906982
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.403 Test Loss: 2.227 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6643593311309814
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.413 Vali Acc: 0.139 Test Loss: 2.413 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.2783877849578857
Epoch: 2, Steps: 7 | Train Loss: 2.219 Vali Loss: 2.254 Vali Acc: 0.194 Test Loss: 2.254 Test Acc: 0.194
Validation loss decreased (-0.138865 --> -0.194422).  Saving model ...
Epoch: 3 cost time: 2.2958242893218994
Epoch: 3, Steps: 7 | Train Loss: 1.342 Vali Loss: 2.268 Vali Acc: 0.181 Test Loss: 2.268 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3332865238189697
Epoch: 4, Steps: 7 | Train Loss: 0.647 Vali Loss: 2.142 Vali Acc: 0.250 Test Loss: 2.142 Test Acc: 0.250
Validation loss decreased (-0.194422 --> -0.249979).  Saving model ...
Epoch: 5 cost time: 2.2955172061920166
Epoch: 5, Steps: 7 | Train Loss: 0.277 Vali Loss: 2.572 Vali Acc: 0.167 Test Loss: 2.572 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3284904956817627
Epoch: 6, Steps: 7 | Train Loss: 0.103 Vali Loss: 2.682 Vali Acc: 0.222 Test Loss: 2.682 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5089774131774902
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 2.249 Vali Acc: 0.292 Test Loss: 2.249 Test Acc: 0.292
Validation loss decreased (-0.249979 --> -0.291644).  Saving model ...
Epoch: 8 cost time: 2.567533493041992
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.715 Vali Acc: 0.250 Test Loss: 2.715 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4402663707733154
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.822 Vali Acc: 0.153 Test Loss: 2.822 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.273571729660034
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.134 Vali Acc: 0.222 Test Loss: 3.134 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.404336929321289
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.170 Vali Acc: 0.278 Test Loss: 3.170 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2058565616607666
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.719 Vali Acc: 0.333 Test Loss: 2.719 Test Acc: 0.333
Validation loss decreased (-0.291644 --> -0.333306).  Saving model ...
Epoch: 13 cost time: 2.2313244342803955
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.466 Vali Acc: 0.319 Test Loss: 2.466 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.283985137939453
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.504 Vali Acc: 0.292 Test Loss: 2.504 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1682677268981934
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.692 Vali Acc: 0.278 Test Loss: 2.692 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2069649696350098
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.733 Vali Acc: 0.236 Test Loss: 2.733 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.294192314147949
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.222 Test Loss: 2.711 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3574512004852295
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.690 Vali Acc: 0.222 Test Loss: 2.690 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4036941528320312
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.646 Vali Acc: 0.236 Test Loss: 2.646 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.238539695739746
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.602 Vali Acc: 0.264 Test Loss: 2.602 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.32216739654541
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.616 Vali Acc: 0.278 Test Loss: 2.616 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.508936882019043
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.656 Vali Acc: 0.278 Test Loss: 2.656 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3333333333333333
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.590707302093506
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.456 Vali Acc: 0.097 Test Loss: 2.456 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.4555139541625977
Epoch: 2, Steps: 7 | Train Loss: 2.198 Vali Loss: 2.628 Vali Acc: 0.194 Test Loss: 2.628 Test Acc: 0.194
Validation loss decreased (-0.097198 --> -0.194418).  Saving model ...
Epoch: 3 cost time: 2.466627836227417
Epoch: 3, Steps: 7 | Train Loss: 1.317 Vali Loss: 2.676 Vali Acc: 0.167 Test Loss: 2.676 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5017759799957275
Epoch: 4, Steps: 7 | Train Loss: 0.714 Vali Loss: 2.364 Vali Acc: 0.264 Test Loss: 2.364 Test Acc: 0.264
Validation loss decreased (-0.194418 --> -0.263865).  Saving model ...
Epoch: 5 cost time: 2.2788491249084473
Epoch: 5, Steps: 7 | Train Loss: 0.290 Vali Loss: 3.117 Vali Acc: 0.194 Test Loss: 3.117 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2780072689056396
Epoch: 6, Steps: 7 | Train Loss: 0.154 Vali Loss: 3.124 Vali Acc: 0.236 Test Loss: 3.124 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1774067878723145
Epoch: 7, Steps: 7 | Train Loss: 0.072 Vali Loss: 3.090 Vali Acc: 0.222 Test Loss: 3.090 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3381311893463135
Epoch: 8, Steps: 7 | Train Loss: 0.057 Vali Loss: 3.530 Vali Acc: 0.208 Test Loss: 3.530 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.363502025604248
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 4.510 Vali Acc: 0.222 Test Loss: 4.510 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2481048107147217
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 4.470 Vali Acc: 0.208 Test Loss: 4.470 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.307981014251709
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 4.483 Vali Acc: 0.208 Test Loss: 4.483 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.28688907623291
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.877 Vali Acc: 0.250 Test Loss: 4.877 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.293065309524536
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.859 Vali Acc: 0.264 Test Loss: 4.859 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3272647857666016
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.657 Vali Acc: 0.250 Test Loss: 4.657 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2638888888888889
model parameter : 2600844
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.957122564315796
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.143 Vali Acc: 0.542 Test Loss: 2.143 Test Acc: 0.542
Validation loss decreased (inf --> -0.541645).  Saving model ...
Epoch: 2 cost time: 2.7811050415039062
Epoch: 2, Steps: 7 | Train Loss: 1.461 Vali Loss: 1.146 Vali Acc: 0.708 Test Loss: 1.146 Test Acc: 0.708
Validation loss decreased (-0.541645 --> -0.708322).  Saving model ...
Epoch: 3 cost time: 2.9887919425964355
Epoch: 3, Steps: 7 | Train Loss: 0.346 Vali Loss: 0.827 Vali Acc: 0.806 Test Loss: 0.827 Test Acc: 0.806
Validation loss decreased (-0.708322 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 3.079881191253662
Epoch: 4, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.878 Vali Acc: 0.819 Test Loss: 0.878 Test Acc: 0.819
Validation loss decreased (-0.805547 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 2.796973705291748
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.979 Vali Acc: 0.778 Test Loss: 0.979 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0123889446258545
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.806 Test Loss: 1.016 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9243199825286865
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.819 Test Loss: 1.075 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.742156744003296
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.112 Vali Acc: 0.819 Test Loss: 1.112 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.738819122314453
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.819 Test Loss: 1.104 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5696964263916016
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.833 Test Loss: 1.097 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833322).  Saving model ...
Epoch: 11 cost time: 2.6581497192382812
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.833 Test Loss: 1.090 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 12 cost time: 2.746778964996338
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.833 Test Loss: 1.085 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 13 cost time: 2.953278064727783
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.833 Test Loss: 1.080 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833323).  Saving model ...
Epoch: 14 cost time: 2.855541467666626
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.833 Test Loss: 1.076 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 15 cost time: 2.694845676422119
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.847 Test Loss: 1.070 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847212).  Saving model ...
Epoch: 16 cost time: 2.8313138484954834
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.847 Test Loss: 1.065 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 17 cost time: 2.624255657196045
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.847 Test Loss: 1.062 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 18 cost time: 2.6377203464508057
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.847 Test Loss: 1.058 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 19 cost time: 2.4497933387756348
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.847 Test Loss: 1.054 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 20 cost time: 2.770080089569092
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.847 Test Loss: 1.053 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 21 cost time: 2.739605188369751
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.847 Test Loss: 1.049 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 22 cost time: 3.012540817260742
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.847 Test Loss: 1.048 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 23 cost time: 2.750934362411499
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.861 Test Loss: 1.047 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861101).  Saving model ...
Epoch: 24 cost time: 2.7611072063446045
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.861 Test Loss: 1.045 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 25 cost time: 2.982736825942993
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.861 Test Loss: 1.043 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 26 cost time: 2.702101945877075
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.861 Test Loss: 1.041 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 27 cost time: 3.061077833175659
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.861 Test Loss: 1.040 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 28 cost time: 2.7479467391967773
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.861 Test Loss: 1.039 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 29 cost time: 2.7611968517303467
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.861 Test Loss: 1.038 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 30 cost time: 2.69720458984375
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.861 Test Loss: 1.038 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 31 cost time: 2.741209030151367
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.861 Test Loss: 1.037 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 32 cost time: 2.8418965339660645
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.861 Test Loss: 1.036 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 33 cost time: 2.796900987625122
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.861 Test Loss: 1.034 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 34 cost time: 2.665668487548828
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.861 Test Loss: 1.033 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 35 cost time: 2.7820186614990234
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.861 Test Loss: 1.030 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 36 cost time: 2.893904447555542
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.861 Test Loss: 1.029 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 37 cost time: 2.530690908432007
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.861 Test Loss: 1.027 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 38 cost time: 2.707549571990967
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 39 cost time: 2.5864105224609375
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861101).  Saving model ...
Epoch: 40 cost time: 2.690261125564575
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.759108304977417
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.706120014190674
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.9101829528808594
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.605663299560547
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.9981203079223633
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.861 Test Loss: 1.027 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.806201696395874
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.7984824180603027
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.566208839416504
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.5404021739959717
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9212491512298584
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.294 Vali Acc: 0.375 Test Loss: 2.294 Test Acc: 0.375
Validation loss decreased (inf --> -0.374977).  Saving model ...
Epoch: 2 cost time: 2.880997657775879
Epoch: 2, Steps: 7 | Train Loss: 1.682 Vali Loss: 1.412 Vali Acc: 0.611 Test Loss: 1.412 Test Acc: 0.611
Validation loss decreased (-0.374977 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 2.695218801498413
Epoch: 3, Steps: 7 | Train Loss: 0.508 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
Validation loss decreased (-0.611097 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 2.745429039001465
Epoch: 4, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.894 Vali Acc: 0.792 Test Loss: 0.894 Test Acc: 0.792
Validation loss decreased (-0.749991 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 2.577073335647583
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6634247303009033
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.101 Vali Acc: 0.778 Test Loss: 1.101 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.613633632659912
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.219 Vali Acc: 0.764 Test Loss: 1.219 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.654794931411743
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.210 Vali Acc: 0.792 Test Loss: 1.210 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7594854831695557
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.806 Test Loss: 1.124 Test Acc: 0.806
Validation loss decreased (-0.791658 --> -0.805544).  Saving model ...
Epoch: 10 cost time: 2.8434324264526367
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.806 Test Loss: 1.071 Test Acc: 0.806
Validation loss decreased (-0.805544 --> -0.805545).  Saving model ...
Epoch: 11 cost time: 2.9914791584014893
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.806 Test Loss: 1.038 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 12 cost time: 2.7989277839660645
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.806 Test Loss: 1.021 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805545).  Saving model ...
Epoch: 13 cost time: 2.793477773666382
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.819 Test Loss: 1.011 Test Acc: 0.819
Validation loss decreased (-0.805545 --> -0.819434).  Saving model ...
Epoch: 14 cost time: 2.954430341720581
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.819 Test Loss: 1.005 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819434).  Saving model ...
Epoch: 15 cost time: 2.843588352203369
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.819 Test Loss: 1.000 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819434).  Saving model ...
Epoch: 16 cost time: 2.874561071395874
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819434).  Saving model ...
Epoch: 17 cost time: 2.615164041519165
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.819 Test Loss: 0.999 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.731247663497925
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819434).  Saving model ...
Epoch: 19 cost time: 2.681307077407837
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.819 Test Loss: 0.996 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819434).  Saving model ...
Epoch: 20 cost time: 2.716136932373047
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.861818790435791
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6207971572875977
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.99106764793396
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.6912295818328857
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.819 Test Loss: 0.999 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8213419914245605
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.761378765106201
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.589740753173828
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7682738304138184
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.586668014526367
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.819 Test Loss: 0.999 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.035381555557251
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.328 Vali Acc: 0.292 Test Loss: 2.328 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 2.656721591949463
Epoch: 2, Steps: 7 | Train Loss: 1.843 Vali Loss: 1.671 Vali Acc: 0.569 Test Loss: 1.671 Test Acc: 0.569
Validation loss decreased (-0.291643 --> -0.569428).  Saving model ...
Epoch: 3 cost time: 2.5589675903320312
Epoch: 3, Steps: 7 | Train Loss: 0.696 Vali Loss: 1.262 Vali Acc: 0.653 Test Loss: 1.262 Test Acc: 0.653
Validation loss decreased (-0.569428 --> -0.652765).  Saving model ...
Epoch: 4 cost time: 2.452714681625366
Epoch: 4, Steps: 7 | Train Loss: 0.253 Vali Loss: 1.206 Vali Acc: 0.750 Test Loss: 1.206 Test Acc: 0.750
Validation loss decreased (-0.652765 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 2.6447479724884033
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.989 Vali Acc: 0.694 Test Loss: 0.989 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.477931261062622
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.106 Vali Acc: 0.708 Test Loss: 1.106 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.376708507537842
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.159 Vali Acc: 0.694 Test Loss: 1.159 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.813959836959839
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.736 Test Loss: 1.030 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6075682640075684
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.948 Vali Acc: 0.778 Test Loss: 0.948 Test Acc: 0.778
Validation loss decreased (-0.749988 --> -0.777768).  Saving model ...
Epoch: 10 cost time: 2.704464912414551
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.778 Test Loss: 0.917 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 2.545163154602051
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.778 Test Loss: 0.906 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 2.682183027267456
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.778 Test Loss: 0.904 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 13 cost time: 2.5440146923065186
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.778 Test Loss: 0.911 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5907623767852783
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.764 Test Loss: 0.918 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7957723140716553
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.756237506866455
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5893092155456543
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9277148246765137
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5878047943115234
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7479288578033447
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.400486946105957
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.594466209411621
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5370748043060303
Epoch: 1, Steps: 7 | Train Loss: 2.544 Vali Loss: 2.355 Vali Acc: 0.236 Test Loss: 2.355 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 2.6041860580444336
Epoch: 2, Steps: 7 | Train Loss: 1.946 Vali Loss: 1.891 Vali Acc: 0.444 Test Loss: 1.891 Test Acc: 0.444
Validation loss decreased (-0.236088 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 2.453265905380249
Epoch: 3, Steps: 7 | Train Loss: 0.861 Vali Loss: 1.595 Vali Acc: 0.556 Test Loss: 1.595 Test Acc: 0.556
Validation loss decreased (-0.444426 --> -0.555540).  Saving model ...
Epoch: 4 cost time: 2.510991334915161
Epoch: 4, Steps: 7 | Train Loss: 0.316 Vali Loss: 1.467 Vali Acc: 0.597 Test Loss: 1.467 Test Acc: 0.597
Validation loss decreased (-0.555540 --> -0.597208).  Saving model ...
Epoch: 5 cost time: 2.5756397247314453
Epoch: 5, Steps: 7 | Train Loss: 0.059 Vali Loss: 1.253 Vali Acc: 0.597 Test Loss: 1.253 Test Acc: 0.597
Validation loss decreased (-0.597208 --> -0.597210).  Saving model ...
Epoch: 6 cost time: 2.4750607013702393
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.298 Vali Acc: 0.583 Test Loss: 1.298 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6409976482391357
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.190 Vali Acc: 0.639 Test Loss: 1.190 Test Acc: 0.639
Validation loss decreased (-0.597210 --> -0.638877).  Saving model ...
Epoch: 8 cost time: 3.060232400894165
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.145 Vali Acc: 0.681 Test Loss: 1.145 Test Acc: 0.681
Validation loss decreased (-0.638877 --> -0.680544).  Saving model ...
Epoch: 9 cost time: 2.7976977825164795
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.681 Test Loss: 1.139 Test Acc: 0.681
Validation loss decreased (-0.680544 --> -0.680544).  Saving model ...
Epoch: 10 cost time: 2.879977226257324
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.681 Test Loss: 1.149 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5556509494781494
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.667 Test Loss: 1.154 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.644188642501831
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.667 Test Loss: 1.157 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.482483148574829
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.667 Test Loss: 1.165 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.807068109512329
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.667 Test Loss: 1.167 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.801130533218384
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.653 Test Loss: 1.172 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.72229266166687
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.653 Test Loss: 1.179 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.484006643295288
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.667 Test Loss: 1.185 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5017194747924805
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.667 Test Loss: 1.193 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.818129062652588
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.667 Test Loss: 1.194 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6805555555555556
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6487574577331543
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.448 Vali Acc: 0.125 Test Loss: 2.448 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.346745491027832
Epoch: 2, Steps: 7 | Train Loss: 2.069 Vali Loss: 2.248 Vali Acc: 0.250 Test Loss: 2.248 Test Acc: 0.250
Validation loss decreased (-0.124976 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 2.390336036682129
Epoch: 3, Steps: 7 | Train Loss: 1.051 Vali Loss: 2.054 Vali Acc: 0.361 Test Loss: 2.054 Test Acc: 0.361
Validation loss decreased (-0.249978 --> -0.361091).  Saving model ...
Epoch: 4 cost time: 2.5464975833892822
Epoch: 4, Steps: 7 | Train Loss: 0.402 Vali Loss: 2.029 Vali Acc: 0.389 Test Loss: 2.029 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388869).  Saving model ...
Epoch: 5 cost time: 2.549621820449829
Epoch: 5, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.145 Vali Acc: 0.361 Test Loss: 2.145 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8848700523376465
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.301 Vali Acc: 0.403 Test Loss: 2.301 Test Acc: 0.403
Validation loss decreased (-0.388869 --> -0.402755).  Saving model ...
Epoch: 7 cost time: 2.7333197593688965
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.468 Vali Acc: 0.431 Test Loss: 2.468 Test Acc: 0.431
Validation loss decreased (-0.402755 --> -0.430531).  Saving model ...
Epoch: 8 cost time: 2.6447837352752686
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.945 Vali Acc: 0.403 Test Loss: 2.945 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8506863117218018
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.361 Vali Acc: 0.500 Test Loss: 2.361 Test Acc: 0.500
Validation loss decreased (-0.430531 --> -0.499976).  Saving model ...
Epoch: 10 cost time: 2.450688123703003
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.337 Vali Acc: 0.444 Test Loss: 2.337 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6504268646240234
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.393 Vali Acc: 0.486 Test Loss: 2.393 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5909364223480225
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.500 Test Loss: 2.455 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.548341751098633
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.486 Test Loss: 2.503 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6516993045806885
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.524 Vali Acc: 0.486 Test Loss: 2.524 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.313326597213745
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.525 Vali Acc: 0.486 Test Loss: 2.525 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4947242736816406
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.519 Vali Acc: 0.486 Test Loss: 2.519 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.394780397415161
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.511 Vali Acc: 0.486 Test Loss: 2.511 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.574899911880493
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.510 Vali Acc: 0.486 Test Loss: 2.510 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3680713176727295
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.486 Test Loss: 2.503 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.376013994216919
Epoch: 1, Steps: 7 | Train Loss: 2.518 Vali Loss: 2.420 Vali Acc: 0.069 Test Loss: 2.420 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 2.4243342876434326
Epoch: 2, Steps: 7 | Train Loss: 2.108 Vali Loss: 2.162 Vali Acc: 0.222 Test Loss: 2.162 Test Acc: 0.222
Validation loss decreased (-0.069420 --> -0.222201).  Saving model ...
Epoch: 3 cost time: 2.7431187629699707
Epoch: 3, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.961 Vali Acc: 0.347 Test Loss: 1.961 Test Acc: 0.347
Validation loss decreased (-0.222201 --> -0.347203).  Saving model ...
Epoch: 4 cost time: 2.5030407905578613
Epoch: 4, Steps: 7 | Train Loss: 0.548 Vali Loss: 1.855 Vali Acc: 0.375 Test Loss: 1.855 Test Acc: 0.375
Validation loss decreased (-0.347203 --> -0.374981).  Saving model ...
Epoch: 5 cost time: 2.5015220642089844
Epoch: 5, Steps: 7 | Train Loss: 0.190 Vali Loss: 1.947 Vali Acc: 0.431 Test Loss: 1.947 Test Acc: 0.431
Validation loss decreased (-0.374981 --> -0.430536).  Saving model ...
Epoch: 6 cost time: 2.635624885559082
Epoch: 6, Steps: 7 | Train Loss: 0.066 Vali Loss: 1.931 Vali Acc: 0.431 Test Loss: 1.931 Test Acc: 0.431
Validation loss decreased (-0.430536 --> -0.430536).  Saving model ...
Epoch: 7 cost time: 2.5786375999450684
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.165 Vali Acc: 0.444 Test Loss: 2.165 Test Acc: 0.444
Validation loss decreased (-0.430536 --> -0.444423).  Saving model ...
Epoch: 8 cost time: 2.79101300239563
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.376 Vali Acc: 0.403 Test Loss: 2.376 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.428194046020508
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.147 Vali Acc: 0.431 Test Loss: 2.147 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6168103218078613
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.191 Vali Acc: 0.458 Test Loss: 2.191 Test Acc: 0.458
Validation loss decreased (-0.444423 --> -0.458311).  Saving model ...
Epoch: 11 cost time: 2.5349905490875244
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.252 Vali Acc: 0.458 Test Loss: 2.252 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.356940746307373
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.300 Vali Acc: 0.486 Test Loss: 2.300 Test Acc: 0.486
Validation loss decreased (-0.458311 --> -0.486088).  Saving model ...
Epoch: 13 cost time: 2.569939374923706
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.357 Vali Acc: 0.472 Test Loss: 2.357 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6007280349731445
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.361 Vali Acc: 0.472 Test Loss: 2.361 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.493457317352295
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.472 Test Loss: 2.356 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.406456232070923
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.472 Test Loss: 2.340 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.638174295425415
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.324 Vali Acc: 0.472 Test Loss: 2.324 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3954012393951416
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.472 Test Loss: 2.319 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4622771739959717
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.299 Vali Acc: 0.472 Test Loss: 2.299 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.572596788406372
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.291 Vali Acc: 0.458 Test Loss: 2.291 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.508026361465454
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.297 Vali Acc: 0.458 Test Loss: 2.297 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7905173301696777
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.458 Test Loss: 2.312 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9217164516448975
Epoch: 1, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.434 Vali Acc: 0.153 Test Loss: 2.434 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 2.574272871017456
Epoch: 2, Steps: 7 | Train Loss: 2.187 Vali Loss: 2.167 Vali Acc: 0.278 Test Loss: 2.167 Test Acc: 0.278
Validation loss decreased (-0.152753 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 2.6924967765808105
Epoch: 3, Steps: 7 | Train Loss: 1.318 Vali Loss: 1.978 Vali Acc: 0.375 Test Loss: 1.978 Test Acc: 0.375
Validation loss decreased (-0.277756 --> -0.374980).  Saving model ...
Epoch: 4 cost time: 2.74926495552063
Epoch: 4, Steps: 7 | Train Loss: 0.685 Vali Loss: 1.877 Vali Acc: 0.375 Test Loss: 1.877 Test Acc: 0.375
Validation loss decreased (-0.374980 --> -0.374981).  Saving model ...
Epoch: 5 cost time: 2.4954423904418945
Epoch: 5, Steps: 7 | Train Loss: 0.257 Vali Loss: 1.852 Vali Acc: 0.403 Test Loss: 1.852 Test Acc: 0.403
Validation loss decreased (-0.374981 --> -0.402759).  Saving model ...
Epoch: 6 cost time: 2.492149591445923
Epoch: 6, Steps: 7 | Train Loss: 0.119 Vali Loss: 1.829 Vali Acc: 0.417 Test Loss: 1.829 Test Acc: 0.417
Validation loss decreased (-0.402759 --> -0.416648).  Saving model ...
Epoch: 7 cost time: 2.639692783355713
Epoch: 7, Steps: 7 | Train Loss: 0.042 Vali Loss: 2.207 Vali Acc: 0.389 Test Loss: 2.207 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4222869873046875
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.047 Vali Acc: 0.417 Test Loss: 2.047 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.496314525604248
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.039 Vali Acc: 0.431 Test Loss: 2.039 Test Acc: 0.431
Validation loss decreased (-0.416648 --> -0.430535).  Saving model ...
Epoch: 10 cost time: 2.3398313522338867
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.917 Vali Acc: 0.444 Test Loss: 1.917 Test Acc: 0.444
Validation loss decreased (-0.430535 --> -0.444425).  Saving model ...
Epoch: 11 cost time: 2.3758301734924316
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.992 Vali Acc: 0.486 Test Loss: 1.992 Test Acc: 0.486
Validation loss decreased (-0.444425 --> -0.486091).  Saving model ...
Epoch: 12 cost time: 2.5471365451812744
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.105 Vali Acc: 0.444 Test Loss: 2.105 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.482779026031494
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.228 Vali Acc: 0.431 Test Loss: 2.228 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5674967765808105
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.278 Vali Acc: 0.444 Test Loss: 2.278 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4031307697296143
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.256 Vali Acc: 0.444 Test Loss: 2.256 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4933018684387207
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.234 Vali Acc: 0.458 Test Loss: 2.234 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.48173189163208
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.213 Vali Acc: 0.444 Test Loss: 2.213 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.754701852798462
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.209 Vali Acc: 0.444 Test Loss: 2.209 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.715040445327759
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.195 Vali Acc: 0.444 Test Loss: 2.195 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6736679077148438
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.444 Test Loss: 2.194 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.654557228088379
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.200 Vali Acc: 0.444 Test Loss: 2.200 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4861111111111111
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7341010570526123
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.437 Vali Acc: 0.125 Test Loss: 2.437 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.593061685562134
Epoch: 2, Steps: 7 | Train Loss: 2.233 Vali Loss: 2.254 Vali Acc: 0.250 Test Loss: 2.254 Test Acc: 0.250
Validation loss decreased (-0.124976 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 2.256573438644409
Epoch: 3, Steps: 7 | Train Loss: 1.425 Vali Loss: 2.071 Vali Acc: 0.347 Test Loss: 2.071 Test Acc: 0.347
Validation loss decreased (-0.249977 --> -0.347202).  Saving model ...
Epoch: 4 cost time: 2.3633651733398438
Epoch: 4, Steps: 7 | Train Loss: 0.784 Vali Loss: 2.024 Vali Acc: 0.292 Test Loss: 2.024 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.484527587890625
Epoch: 5, Steps: 7 | Train Loss: 0.309 Vali Loss: 1.957 Vali Acc: 0.417 Test Loss: 1.957 Test Acc: 0.417
Validation loss decreased (-0.347202 --> -0.416647).  Saving model ...
Epoch: 6 cost time: 2.496340036392212
Epoch: 6, Steps: 7 | Train Loss: 0.105 Vali Loss: 1.904 Vali Acc: 0.403 Test Loss: 1.904 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.605705499649048
Epoch: 7, Steps: 7 | Train Loss: 0.037 Vali Loss: 2.289 Vali Acc: 0.389 Test Loss: 2.289 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2351901531219482
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.250 Vali Acc: 0.417 Test Loss: 2.250 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3895516395568848
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.128 Vali Acc: 0.361 Test Loss: 2.128 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.297852039337158
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.993 Vali Acc: 0.431 Test Loss: 1.993 Test Acc: 0.431
Validation loss decreased (-0.416647 --> -0.430536).  Saving model ...
Epoch: 11 cost time: 2.4090139865875244
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.068 Vali Acc: 0.444 Test Loss: 2.068 Test Acc: 0.444
Validation loss decreased (-0.430536 --> -0.444424).  Saving model ...
Epoch: 12 cost time: 2.4491384029388428
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.245 Vali Acc: 0.444 Test Loss: 2.245 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.164567470550537
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.388 Vali Acc: 0.444 Test Loss: 2.388 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.358363151550293
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.423 Vali Acc: 0.458 Test Loss: 2.423 Test Acc: 0.458
Validation loss decreased (-0.444424 --> -0.458309).  Saving model ...
Epoch: 15 cost time: 2.4602434635162354
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.406 Vali Acc: 0.444 Test Loss: 2.406 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4119858741760254
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.431 Test Loss: 2.381 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.561934232711792
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.348 Vali Acc: 0.444 Test Loss: 2.348 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5212578773498535
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.444 Test Loss: 2.342 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.494036912918091
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.444 Test Loss: 2.339 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.584301471710205
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.431 Test Loss: 2.342 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4213428497314453
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.361 Vali Acc: 0.431 Test Loss: 2.361 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8180012702941895
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.431 Test Loss: 2.387 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4681835174560547
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.417 Test Loss: 2.407 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7252776622772217
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.425 Vali Acc: 0.417 Test Loss: 2.425 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.295708656311035
Epoch: 1, Steps: 7 | Train Loss: 2.532 Vali Loss: 2.433 Vali Acc: 0.097 Test Loss: 2.433 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.4950668811798096
Epoch: 2, Steps: 7 | Train Loss: 2.347 Vali Loss: 2.353 Vali Acc: 0.153 Test Loss: 2.353 Test Acc: 0.153
Validation loss decreased (-0.097198 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 2.1501667499542236
Epoch: 3, Steps: 7 | Train Loss: 1.700 Vali Loss: 2.228 Vali Acc: 0.333 Test Loss: 2.228 Test Acc: 0.333
Validation loss decreased (-0.152754 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 2.2545597553253174
Epoch: 4, Steps: 7 | Train Loss: 1.215 Vali Loss: 2.424 Vali Acc: 0.250 Test Loss: 2.424 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3426172733306885
Epoch: 5, Steps: 7 | Train Loss: 0.655 Vali Loss: 2.230 Vali Acc: 0.264 Test Loss: 2.230 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.397510051727295
Epoch: 6, Steps: 7 | Train Loss: 0.313 Vali Loss: 2.251 Vali Acc: 0.361 Test Loss: 2.251 Test Acc: 0.361
Validation loss decreased (-0.333311 --> -0.361089).  Saving model ...
Epoch: 7 cost time: 2.1848504543304443
Epoch: 7, Steps: 7 | Train Loss: 0.139 Vali Loss: 2.534 Vali Acc: 0.264 Test Loss: 2.534 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2608022689819336
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 2.187 Vali Acc: 0.417 Test Loss: 2.187 Test Acc: 0.417
Validation loss decreased (-0.361089 --> -0.416645).  Saving model ...
Epoch: 9 cost time: 2.582015037536621
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.778 Vali Acc: 0.347 Test Loss: 2.778 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3388195037841797
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.488 Vali Acc: 0.472 Test Loss: 2.488 Test Acc: 0.472
Validation loss decreased (-0.416645 --> -0.472197).  Saving model ...
Epoch: 11 cost time: 2.3614282608032227
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.678 Vali Acc: 0.375 Test Loss: 2.678 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.357429027557373
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.928 Vali Acc: 0.333 Test Loss: 2.928 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3473238945007324
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.951 Vali Acc: 0.361 Test Loss: 2.951 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.34139084815979
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.965 Vali Acc: 0.361 Test Loss: 2.965 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2891845703125
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.924 Vali Acc: 0.389 Test Loss: 2.924 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4125304222106934
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.919 Vali Acc: 0.375 Test Loss: 2.919 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3105478286743164
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.922 Vali Acc: 0.375 Test Loss: 2.922 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.152311325073242
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.924 Vali Acc: 0.375 Test Loss: 2.924 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.168950080871582
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.942 Vali Acc: 0.361 Test Loss: 2.942 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.198171377182007
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.966 Vali Acc: 0.347 Test Loss: 2.966 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.608186721801758
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.461 Vali Acc: 0.069 Test Loss: 2.461 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 2.264004945755005
Epoch: 2, Steps: 7 | Train Loss: 2.349 Vali Loss: 2.373 Vali Acc: 0.250 Test Loss: 2.373 Test Acc: 0.250
Validation loss decreased (-0.069420 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 2.520080804824829
Epoch: 3, Steps: 7 | Train Loss: 1.704 Vali Loss: 2.492 Vali Acc: 0.181 Test Loss: 2.492 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3490543365478516
Epoch: 4, Steps: 7 | Train Loss: 1.278 Vali Loss: 2.588 Vali Acc: 0.236 Test Loss: 2.588 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6147618293762207
Epoch: 5, Steps: 7 | Train Loss: 0.802 Vali Loss: 2.567 Vali Acc: 0.319 Test Loss: 2.567 Test Acc: 0.319
Validation loss decreased (-0.249976 --> -0.319419).  Saving model ...
Epoch: 6 cost time: 2.6022934913635254
Epoch: 6, Steps: 7 | Train Loss: 0.455 Vali Loss: 2.312 Vali Acc: 0.278 Test Loss: 2.312 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.456944465637207
Epoch: 7, Steps: 7 | Train Loss: 0.238 Vali Loss: 2.622 Vali Acc: 0.306 Test Loss: 2.622 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6182427406311035
Epoch: 8, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.601 Vali Acc: 0.347 Test Loss: 2.601 Test Acc: 0.347
Validation loss decreased (-0.319419 --> -0.347196).  Saving model ...
Epoch: 9 cost time: 2.7116074562072754
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 3.253 Vali Acc: 0.264 Test Loss: 3.253 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.626572608947754
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 3.309 Vali Acc: 0.222 Test Loss: 3.309 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7411041259765625
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.454 Vali Acc: 0.278 Test Loss: 3.454 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.654989719390869
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.595 Vali Acc: 0.319 Test Loss: 3.595 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.497392416000366
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 3.618 Vali Acc: 0.278 Test Loss: 3.618 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6625001430511475
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.477 Vali Acc: 0.319 Test Loss: 3.477 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.674135684967041
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.601 Vali Acc: 0.306 Test Loss: 3.601 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5525472164154053
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.687 Vali Acc: 0.306 Test Loss: 3.687 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.569911003112793
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.773 Vali Acc: 0.306 Test Loss: 3.773 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.459470272064209
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.923 Vali Acc: 0.292 Test Loss: 3.923 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3472222222222222
model parameter : 1873868
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8553926944732666
Epoch: 1, Steps: 7 | Train Loss: 2.495 Vali Loss: 2.123 Vali Acc: 0.500 Test Loss: 2.123 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 2.552417755126953
Epoch: 2, Steps: 7 | Train Loss: 1.509 Vali Loss: 1.151 Vali Acc: 0.750 Test Loss: 1.151 Test Acc: 0.750
Validation loss decreased (-0.499979 --> -0.749988).  Saving model ...
Epoch: 3 cost time: 2.4731314182281494
Epoch: 3, Steps: 7 | Train Loss: 0.382 Vali Loss: 0.817 Vali Acc: 0.806 Test Loss: 0.817 Test Acc: 0.806
Validation loss decreased (-0.749988 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 2.6347150802612305
Epoch: 4, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833325).  Saving model ...
Epoch: 5 cost time: 2.4232177734375
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.050 Vali Acc: 0.819 Test Loss: 1.050 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.454864740371704
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.173 Vali Acc: 0.819 Test Loss: 1.173 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.598198413848877
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.806 Test Loss: 1.263 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4792368412017822
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.214 Vali Acc: 0.819 Test Loss: 1.214 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4707529544830322
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.819 Test Loss: 1.162 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4933841228485107
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.819 Test Loss: 1.135 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3460006713867188
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.819 Test Loss: 1.120 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.512594699859619
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.819 Test Loss: 1.113 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4424057006835938
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.819 Test Loss: 1.108 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5290706157684326
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.819 Test Loss: 1.105 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8333333333333334
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.459850311279297
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.223 Vali Acc: 0.417 Test Loss: 2.223 Test Acc: 0.417
Validation loss decreased (inf --> -0.416644).  Saving model ...
Epoch: 2 cost time: 2.4492523670196533
Epoch: 2, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.368 Vali Acc: 0.694 Test Loss: 1.368 Test Acc: 0.694
Validation loss decreased (-0.416644 --> -0.694431).  Saving model ...
Epoch: 3 cost time: 2.3319435119628906
Epoch: 3, Steps: 7 | Train Loss: 0.551 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
Validation loss decreased (-0.694431 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 2.4692940711975098
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 2.6277143955230713
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.000 Vali Acc: 0.764 Test Loss: 1.000 Test Acc: 0.764
Validation loss decreased (-0.749992 --> -0.763879).  Saving model ...
Epoch: 6 cost time: 2.4202146530151367
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.091 Vali Acc: 0.750 Test Loss: 1.091 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4709630012512207
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.024 Vali Acc: 0.792 Test Loss: 1.024 Test Acc: 0.792
Validation loss decreased (-0.763879 --> -0.791656).  Saving model ...
Epoch: 8 cost time: 2.47645902633667
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.806 Test Loss: 0.943 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805546).  Saving model ...
Epoch: 9 cost time: 2.4245798587799072
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.806 Test Loss: 0.906 Test Acc: 0.806
Validation loss decreased (-0.805546 --> -0.805546).  Saving model ...
Epoch: 10 cost time: 2.5758039951324463
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.806 Test Loss: 0.898 Test Acc: 0.806
Validation loss decreased (-0.805546 --> -0.805547).  Saving model ...
Epoch: 11 cost time: 2.540379285812378
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.806 Test Loss: 0.900 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5852813720703125
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.806 Test Loss: 0.905 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4468939304351807
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.806 Test Loss: 0.909 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.439905881881714
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.806 Test Loss: 0.913 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5264413356781006
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.819 Test Loss: 0.917 Test Acc: 0.819
Validation loss decreased (-0.805547 --> -0.819435).  Saving model ...
Epoch: 16 cost time: 2.4488070011138916
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.819 Test Loss: 0.920 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4877214431762695
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.819 Test Loss: 0.922 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6295711994171143
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.819 Test Loss: 0.927 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.194561004638672
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.819 Test Loss: 0.931 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4327244758605957
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.819 Test Loss: 0.934 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.398773193359375
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.819 Test Loss: 0.936 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1997363567352295
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.819 Test Loss: 0.935 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3592476844787598
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.819 Test Loss: 0.933 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.4900801181793213
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.819 Test Loss: 0.933 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4316065311431885
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.819 Test Loss: 0.935 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.611954927444458
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.320 Vali Acc: 0.278 Test Loss: 2.320 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 2.450570583343506
Epoch: 2, Steps: 7 | Train Loss: 1.827 Vali Loss: 1.636 Vali Acc: 0.569 Test Loss: 1.636 Test Acc: 0.569
Validation loss decreased (-0.277755 --> -0.569428).  Saving model ...
Epoch: 3 cost time: 2.4172468185424805
Epoch: 3, Steps: 7 | Train Loss: 0.756 Vali Loss: 1.295 Vali Acc: 0.708 Test Loss: 1.295 Test Acc: 0.708
Validation loss decreased (-0.569428 --> -0.708320).  Saving model ...
Epoch: 4 cost time: 2.2998769283294678
Epoch: 4, Steps: 7 | Train Loss: 0.232 Vali Loss: 1.094 Vali Acc: 0.653 Test Loss: 1.094 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6385111808776855
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.008 Vali Acc: 0.736 Test Loss: 1.008 Test Acc: 0.736
Validation loss decreased (-0.708320 --> -0.736101).  Saving model ...
Epoch: 6 cost time: 2.5805916786193848
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.953 Vali Acc: 0.736 Test Loss: 0.953 Test Acc: 0.736
Validation loss decreased (-0.736101 --> -0.736102).  Saving model ...
Epoch: 7 cost time: 2.589272975921631
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
Validation loss decreased (-0.736102 --> -0.777768).  Saving model ...
Epoch: 8 cost time: 2.3203232288360596
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.722 Test Loss: 0.964 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6170313358306885
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6198925971984863
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.736 Test Loss: 0.989 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4620296955108643
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.736 Test Loss: 0.991 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6201202869415283
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.722 Test Loss: 0.990 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.541428804397583
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.736 Test Loss: 0.987 Test Acc: 0.736
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6533610820770264
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.736 Test Loss: 0.987 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9105639457702637
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.736 Test Loss: 0.988 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.629758834838867
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.588912010192871
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.765652894973755
Epoch: 1, Steps: 7 | Train Loss: 2.604 Vali Loss: 2.384 Vali Acc: 0.194 Test Loss: 2.384 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 2.4040873050689697
Epoch: 2, Steps: 7 | Train Loss: 1.974 Vali Loss: 1.929 Vali Acc: 0.361 Test Loss: 1.929 Test Acc: 0.361
Validation loss decreased (-0.194421 --> -0.361092).  Saving model ...
Epoch: 3 cost time: 2.527372360229492
Epoch: 3, Steps: 7 | Train Loss: 0.947 Vali Loss: 1.613 Vali Acc: 0.569 Test Loss: 1.613 Test Acc: 0.569
Validation loss decreased (-0.361092 --> -0.569428).  Saving model ...
Epoch: 4 cost time: 2.2980782985687256
Epoch: 4, Steps: 7 | Train Loss: 0.306 Vali Loss: 1.465 Vali Acc: 0.556 Test Loss: 1.465 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.610661268234253
Epoch: 5, Steps: 7 | Train Loss: 0.079 Vali Loss: 1.345 Vali Acc: 0.583 Test Loss: 1.345 Test Acc: 0.583
Validation loss decreased (-0.569428 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 2.4387378692626953
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.280 Vali Acc: 0.611 Test Loss: 1.280 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 2.332590341567993
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.362 Vali Acc: 0.611 Test Loss: 1.362 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4559214115142822
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.339 Vali Acc: 0.639 Test Loss: 1.339 Test Acc: 0.639
Validation loss decreased (-0.611098 --> -0.638876).  Saving model ...
Epoch: 9 cost time: 2.376030445098877
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.291 Vali Acc: 0.639 Test Loss: 1.291 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638876).  Saving model ...
Epoch: 10 cost time: 2.35642147064209
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.639 Test Loss: 1.285 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638876).  Saving model ...
Epoch: 11 cost time: 2.2250308990478516
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.639 Test Loss: 1.302 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5059943199157715
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.625 Test Loss: 1.317 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4849212169647217
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.625 Test Loss: 1.326 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.480356454849243
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.625 Test Loss: 1.333 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.521071434020996
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.625 Test Loss: 1.333 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4130609035491943
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.625 Test Loss: 1.335 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4978244304656982
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.625 Test Loss: 1.339 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2611260414123535
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.625 Test Loss: 1.347 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3889858722686768
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.625 Test Loss: 1.358 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.6135482788085938
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.625 Test Loss: 1.364 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6388888888888888
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8869919776916504
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.478 Vali Acc: 0.111 Test Loss: 2.478 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.675640821456909
Epoch: 2, Steps: 7 | Train Loss: 2.055 Vali Loss: 2.228 Vali Acc: 0.250 Test Loss: 2.228 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 2.546048641204834
Epoch: 3, Steps: 7 | Train Loss: 1.123 Vali Loss: 2.082 Vali Acc: 0.361 Test Loss: 2.082 Test Acc: 0.361
Validation loss decreased (-0.249978 --> -0.361090).  Saving model ...
Epoch: 4 cost time: 2.649787187576294
Epoch: 4, Steps: 7 | Train Loss: 0.436 Vali Loss: 2.103 Vali Acc: 0.389 Test Loss: 2.103 Test Acc: 0.389
Validation loss decreased (-0.361090 --> -0.388868).  Saving model ...
Epoch: 5 cost time: 2.353207588195801
Epoch: 5, Steps: 7 | Train Loss: 0.152 Vali Loss: 2.249 Vali Acc: 0.431 Test Loss: 2.249 Test Acc: 0.431
Validation loss decreased (-0.388868 --> -0.430533).  Saving model ...
Epoch: 6 cost time: 2.410515546798706
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 2.166 Vali Acc: 0.361 Test Loss: 2.166 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5301921367645264
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.573 Vali Acc: 0.431 Test Loss: 2.573 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.583178758621216
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.566 Vali Acc: 0.444 Test Loss: 2.566 Test Acc: 0.444
Validation loss decreased (-0.430533 --> -0.444419).  Saving model ...
Epoch: 9 cost time: 2.5395050048828125
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.356 Vali Acc: 0.417 Test Loss: 2.356 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.755080223083496
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.297 Vali Acc: 0.389 Test Loss: 2.297 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.477562427520752
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.324 Vali Acc: 0.389 Test Loss: 2.324 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4677603244781494
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.383 Vali Acc: 0.417 Test Loss: 2.383 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4451866149902344
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.435 Vali Acc: 0.431 Test Loss: 2.435 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8693125247955322
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.444 Test Loss: 2.485 Test Acc: 0.444
Validation loss decreased (-0.444419 --> -0.444420).  Saving model ...
Epoch: 15 cost time: 2.543125629425049
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.518 Vali Acc: 0.444 Test Loss: 2.518 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.207974910736084
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.458 Test Loss: 2.530 Test Acc: 0.458
Validation loss decreased (-0.444420 --> -0.458308).  Saving model ...
Epoch: 17 cost time: 2.4827919006347656
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.472 Test Loss: 2.538 Test Acc: 0.472
Validation loss decreased (-0.458308 --> -0.472197).  Saving model ...
Epoch: 18 cost time: 2.39534068107605
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.550 Vali Acc: 0.472 Test Loss: 2.550 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.411644458770752
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.558 Vali Acc: 0.458 Test Loss: 2.558 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.311751365661621
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.569 Vali Acc: 0.458 Test Loss: 2.569 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.414151668548584
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.579 Vali Acc: 0.458 Test Loss: 2.579 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2363297939300537
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.590 Vali Acc: 0.458 Test Loss: 2.590 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3864998817443848
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.590 Vali Acc: 0.458 Test Loss: 2.590 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.479152202606201
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.594 Vali Acc: 0.472 Test Loss: 2.594 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.464920997619629
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.472 Test Loss: 2.598 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.599356174468994
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.601 Vali Acc: 0.458 Test Loss: 2.601 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.410815715789795
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.458 Test Loss: 2.607 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8021063804626465
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.451 Vali Acc: 0.083 Test Loss: 2.451 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.705186605453491
Epoch: 2, Steps: 7 | Train Loss: 2.169 Vali Loss: 2.160 Vali Acc: 0.292 Test Loss: 2.160 Test Acc: 0.292
Validation loss decreased (-0.083309 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 2.4504311084747314
Epoch: 3, Steps: 7 | Train Loss: 1.293 Vali Loss: 1.954 Vali Acc: 0.292 Test Loss: 1.954 Test Acc: 0.292
Validation loss decreased (-0.291645 --> -0.291647).  Saving model ...
Epoch: 4 cost time: 2.46049165725708
Epoch: 4, Steps: 7 | Train Loss: 0.604 Vali Loss: 1.829 Vali Acc: 0.444 Test Loss: 1.829 Test Acc: 0.444
Validation loss decreased (-0.291647 --> -0.444426).  Saving model ...
Epoch: 5 cost time: 2.3529856204986572
Epoch: 5, Steps: 7 | Train Loss: 0.246 Vali Loss: 1.900 Vali Acc: 0.389 Test Loss: 1.900 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.379912853240967
Epoch: 6, Steps: 7 | Train Loss: 0.095 Vali Loss: 1.957 Vali Acc: 0.417 Test Loss: 1.957 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4394564628601074
Epoch: 7, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.118 Vali Acc: 0.444 Test Loss: 2.118 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.421065330505371
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.005 Vali Acc: 0.431 Test Loss: 2.005 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.526278257369995
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.111 Vali Acc: 0.431 Test Loss: 2.111 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.373401641845703
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.270 Vali Acc: 0.431 Test Loss: 2.270 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.380802631378174
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.410 Vali Acc: 0.431 Test Loss: 2.410 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.509315252304077
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.455 Vali Acc: 0.444 Test Loss: 2.455 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.484048366546631
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.410 Vali Acc: 0.458 Test Loss: 2.410 Test Acc: 0.458
Validation loss decreased (-0.444426 --> -0.458309).  Saving model ...
Epoch: 14 cost time: 2.4214909076690674
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.370 Vali Acc: 0.458 Test Loss: 2.370 Test Acc: 0.458
Validation loss decreased (-0.458309 --> -0.458310).  Saving model ...
Epoch: 15 cost time: 2.570692300796509
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.343 Vali Acc: 0.458 Test Loss: 2.343 Test Acc: 0.458
Validation loss decreased (-0.458310 --> -0.458310).  Saving model ...
Epoch: 16 cost time: 2.4974145889282227
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.458 Test Loss: 2.332 Test Acc: 0.458
Validation loss decreased (-0.458310 --> -0.458310).  Saving model ...
Epoch: 17 cost time: 2.517033576965332
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.458 Test Loss: 2.331 Test Acc: 0.458
Validation loss decreased (-0.458310 --> -0.458310).  Saving model ...
Epoch: 18 cost time: 2.596662759780884
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.458 Test Loss: 2.334 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.287745714187622
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.344 Vali Acc: 0.458 Test Loss: 2.344 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4791526794433594
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.353 Vali Acc: 0.472 Test Loss: 2.353 Test Acc: 0.472
Validation loss decreased (-0.458310 --> -0.472199).  Saving model ...
Epoch: 21 cost time: 2.7068963050842285
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.472 Test Loss: 2.354 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.612736225128174
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.458 Test Loss: 2.354 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7235803604125977
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.458 Test Loss: 2.347 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.643904685974121
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.458 Test Loss: 2.349 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.3796184062957764
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.458 Test Loss: 2.349 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.369016170501709
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.472 Test Loss: 2.334 Test Acc: 0.472
Validation loss decreased (-0.472199 --> -0.472199).  Saving model ...
Epoch: 27 cost time: 2.452100992202759
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.335 Vali Acc: 0.472 Test Loss: 2.335 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.298189640045166
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.357 Vali Acc: 0.472 Test Loss: 2.357 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.322227716445923
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.472 Test Loss: 2.388 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3430206775665283
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.472 Test Loss: 2.386 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.429610013961792
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.472 Test Loss: 2.372 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4277918338775635
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.364 Vali Acc: 0.472 Test Loss: 2.364 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.5620555877685547
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.472 Test Loss: 2.370 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.510510206222534
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.375 Vali Acc: 0.472 Test Loss: 2.375 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.5402796268463135
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.377 Vali Acc: 0.472 Test Loss: 2.377 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.4874939918518066
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.472 Test Loss: 2.373 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.928593158721924
Epoch: 1, Steps: 7 | Train Loss: 2.590 Vali Loss: 2.452 Vali Acc: 0.125 Test Loss: 2.452 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.5151307582855225
Epoch: 2, Steps: 7 | Train Loss: 2.208 Vali Loss: 2.174 Vali Acc: 0.250 Test Loss: 2.174 Test Acc: 0.250
Validation loss decreased (-0.124975 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 2.5990989208221436
Epoch: 3, Steps: 7 | Train Loss: 1.425 Vali Loss: 1.979 Vali Acc: 0.319 Test Loss: 1.979 Test Acc: 0.319
Validation loss decreased (-0.249978 --> -0.319425).  Saving model ...
Epoch: 4 cost time: 2.651381254196167
Epoch: 4, Steps: 7 | Train Loss: 0.734 Vali Loss: 1.771 Vali Acc: 0.458 Test Loss: 1.771 Test Acc: 0.458
Validation loss decreased (-0.319425 --> -0.458316).  Saving model ...
Epoch: 5 cost time: 2.741895914077759
Epoch: 5, Steps: 7 | Train Loss: 0.318 Vali Loss: 1.780 Vali Acc: 0.389 Test Loss: 1.780 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4361186027526855
Epoch: 6, Steps: 7 | Train Loss: 0.117 Vali Loss: 1.813 Vali Acc: 0.389 Test Loss: 1.813 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4790492057800293
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.817 Vali Acc: 0.403 Test Loss: 1.817 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.601395845413208
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.879 Vali Acc: 0.389 Test Loss: 1.879 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5469167232513428
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.944 Vali Acc: 0.431 Test Loss: 1.944 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4675889015197754
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.079 Vali Acc: 0.458 Test Loss: 2.079 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5884921550750732
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.238 Vali Acc: 0.431 Test Loss: 2.238 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.493412733078003
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.251 Vali Acc: 0.444 Test Loss: 2.251 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.24413800239563
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.143 Vali Acc: 0.444 Test Loss: 2.143 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.281862258911133
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.093 Vali Acc: 0.444 Test Loss: 2.093 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.622706651687622
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.469 Vali Acc: 0.111 Test Loss: 2.469 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.510420560836792
Epoch: 2, Steps: 7 | Train Loss: 2.259 Vali Loss: 2.276 Vali Acc: 0.250 Test Loss: 2.276 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 2.642242431640625
Epoch: 3, Steps: 7 | Train Loss: 1.521 Vali Loss: 2.070 Vali Acc: 0.264 Test Loss: 2.070 Test Acc: 0.264
Validation loss decreased (-0.249977 --> -0.263868).  Saving model ...
Epoch: 4 cost time: 2.333383798599243
Epoch: 4, Steps: 7 | Train Loss: 0.833 Vali Loss: 1.923 Vali Acc: 0.389 Test Loss: 1.923 Test Acc: 0.389
Validation loss decreased (-0.263868 --> -0.388870).  Saving model ...
Epoch: 5 cost time: 2.4633820056915283
Epoch: 5, Steps: 7 | Train Loss: 0.343 Vali Loss: 1.940 Vali Acc: 0.361 Test Loss: 1.940 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4020676612854004
Epoch: 6, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.899 Vali Acc: 0.333 Test Loss: 1.899 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4680068492889404
Epoch: 7, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.953 Vali Acc: 0.389 Test Loss: 1.953 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.242954969406128
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.017 Vali Acc: 0.389 Test Loss: 2.017 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.422001361846924
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.141 Vali Acc: 0.389 Test Loss: 2.141 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.312466621398926
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.343 Vali Acc: 0.417 Test Loss: 2.343 Test Acc: 0.417
Validation loss decreased (-0.388870 --> -0.416643).  Saving model ...
Epoch: 11 cost time: 2.3556346893310547
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.416 Vali Acc: 0.417 Test Loss: 2.416 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.587273120880127
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.321 Vali Acc: 0.417 Test Loss: 2.321 Test Acc: 0.417
Validation loss decreased (-0.416643 --> -0.416643).  Saving model ...
Epoch: 13 cost time: 2.556488513946533
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.220 Vali Acc: 0.389 Test Loss: 2.220 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4901723861694336
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.223 Vali Acc: 0.375 Test Loss: 2.223 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.51078200340271
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.262 Vali Acc: 0.403 Test Loss: 2.262 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7193665504455566
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.300 Vali Acc: 0.417 Test Loss: 2.300 Test Acc: 0.417
Validation loss decreased (-0.416643 --> -0.416644).  Saving model ...
Epoch: 17 cost time: 2.4993560314178467
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.326 Vali Acc: 0.403 Test Loss: 2.326 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6940839290618896
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.403 Test Loss: 2.340 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.415196418762207
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.352 Vali Acc: 0.403 Test Loss: 2.352 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.910473108291626
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.364 Vali Acc: 0.403 Test Loss: 2.364 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.532040596008301
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.403 Test Loss: 2.349 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5869367122650146
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.389 Test Loss: 2.356 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.395850658416748
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.389 Test Loss: 2.354 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5575881004333496
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.383 Vali Acc: 0.389 Test Loss: 2.383 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5667452812194824
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.401 Vali Acc: 0.403 Test Loss: 2.401 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.796468496322632
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.398 Vali Acc: 0.403 Test Loss: 2.398 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.60463285446167
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.485 Vali Acc: 0.056 Test Loss: 2.485 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 2.437732219696045
Epoch: 2, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.367 Vali Acc: 0.236 Test Loss: 2.367 Test Acc: 0.236
Validation loss decreased (-0.055531 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 2.2329065799713135
Epoch: 3, Steps: 7 | Train Loss: 1.797 Vali Loss: 2.309 Vali Acc: 0.208 Test Loss: 2.309 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2386937141418457
Epoch: 4, Steps: 7 | Train Loss: 1.219 Vali Loss: 2.257 Vali Acc: 0.306 Test Loss: 2.257 Test Acc: 0.306
Validation loss decreased (-0.236087 --> -0.305533).  Saving model ...
Epoch: 5 cost time: 2.2550597190856934
Epoch: 5, Steps: 7 | Train Loss: 0.693 Vali Loss: 2.365 Vali Acc: 0.347 Test Loss: 2.365 Test Acc: 0.347
Validation loss decreased (-0.305533 --> -0.347199).  Saving model ...
Epoch: 6 cost time: 2.440493583679199
Epoch: 6, Steps: 7 | Train Loss: 0.355 Vali Loss: 2.186 Vali Acc: 0.278 Test Loss: 2.186 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7352957725524902
Epoch: 7, Steps: 7 | Train Loss: 0.152 Vali Loss: 2.408 Vali Acc: 0.292 Test Loss: 2.408 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2240066528320312
Epoch: 8, Steps: 7 | Train Loss: 0.076 Vali Loss: 2.268 Vali Acc: 0.333 Test Loss: 2.268 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5314853191375732
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.641 Vali Acc: 0.264 Test Loss: 2.641 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6956474781036377
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.648 Vali Acc: 0.431 Test Loss: 2.648 Test Acc: 0.431
Validation loss decreased (-0.347199 --> -0.430529).  Saving model ...
Epoch: 11 cost time: 2.4000468254089355
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.940 Vali Acc: 0.347 Test Loss: 2.940 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.240226984024048
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.990 Vali Acc: 0.347 Test Loss: 2.990 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.491680383682251
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.923 Vali Acc: 0.361 Test Loss: 2.923 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7104785442352295
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.883 Vali Acc: 0.347 Test Loss: 2.883 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3084757328033447
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.904 Vali Acc: 0.347 Test Loss: 2.904 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3871052265167236
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.924 Vali Acc: 0.347 Test Loss: 2.924 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.615065336227417
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.957 Vali Acc: 0.319 Test Loss: 2.957 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.532866954803467
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.975 Vali Acc: 0.333 Test Loss: 2.975 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5306975841522217
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.960 Vali Acc: 0.347 Test Loss: 2.960 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4969849586486816
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.970 Vali Acc: 0.375 Test Loss: 2.970 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6675407886505127
Epoch: 1, Steps: 7 | Train Loss: 2.570 Vali Loss: 2.461 Vali Acc: 0.139 Test Loss: 2.461 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 2.351099729537964
Epoch: 2, Steps: 7 | Train Loss: 2.339 Vali Loss: 2.338 Vali Acc: 0.194 Test Loss: 2.338 Test Acc: 0.194
Validation loss decreased (-0.138864 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 2.417664051055908
Epoch: 3, Steps: 7 | Train Loss: 1.834 Vali Loss: 2.388 Vali Acc: 0.181 Test Loss: 2.388 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.659876585006714
Epoch: 4, Steps: 7 | Train Loss: 1.307 Vali Loss: 2.557 Vali Acc: 0.222 Test Loss: 2.557 Test Acc: 0.222
Validation loss decreased (-0.194421 --> -0.222197).  Saving model ...
Epoch: 5 cost time: 2.4417531490325928
Epoch: 5, Steps: 7 | Train Loss: 0.801 Vali Loss: 2.526 Vali Acc: 0.292 Test Loss: 2.526 Test Acc: 0.292
Validation loss decreased (-0.222197 --> -0.291641).  Saving model ...
Epoch: 6 cost time: 2.4003584384918213
Epoch: 6, Steps: 7 | Train Loss: 0.496 Vali Loss: 2.311 Vali Acc: 0.250 Test Loss: 2.311 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4727747440338135
Epoch: 7, Steps: 7 | Train Loss: 0.263 Vali Loss: 2.312 Vali Acc: 0.306 Test Loss: 2.312 Test Acc: 0.306
Validation loss decreased (-0.291641 --> -0.305532).  Saving model ...
Epoch: 8 cost time: 2.382622480392456
Epoch: 8, Steps: 7 | Train Loss: 0.141 Vali Loss: 2.510 Vali Acc: 0.389 Test Loss: 2.510 Test Acc: 0.389
Validation loss decreased (-0.305532 --> -0.388864).  Saving model ...
Epoch: 9 cost time: 2.3676016330718994
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 2.780 Vali Acc: 0.222 Test Loss: 2.780 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.44189190864563
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 3.029 Vali Acc: 0.264 Test Loss: 3.029 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.623044729232788
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 3.281 Vali Acc: 0.292 Test Loss: 3.281 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4718284606933594
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 3.184 Vali Acc: 0.278 Test Loss: 3.184 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5615909099578857
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.395 Vali Acc: 0.250 Test Loss: 3.395 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5614616870880127
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.450 Vali Acc: 0.236 Test Loss: 3.450 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4251973628997803
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.447 Vali Acc: 0.306 Test Loss: 3.447 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.35687255859375
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 3.379 Vali Acc: 0.319 Test Loss: 3.379 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3593342304229736
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.448 Vali Acc: 0.347 Test Loss: 3.448 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4931163787841797
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.520 Vali Acc: 0.292 Test Loss: 3.520 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3888888888888889
model parameter : 1480652
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6006453037261963
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.139 Vali Acc: 0.458 Test Loss: 2.139 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 2.3782846927642822
Epoch: 2, Steps: 7 | Train Loss: 1.561 Vali Loss: 1.084 Vali Acc: 0.778 Test Loss: 1.084 Test Acc: 0.778
Validation loss decreased (-0.458312 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 2.395451307296753
Epoch: 3, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.780 Vali Acc: 0.847 Test Loss: 0.780 Test Acc: 0.847
Validation loss decreased (-0.777767 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 2.488656997680664
Epoch: 4, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.826 Vali Acc: 0.819 Test Loss: 0.826 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.571428060531616
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.937 Vali Acc: 0.819 Test Loss: 0.937 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7057018280029297
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.833 Test Loss: 0.999 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2722582817077637
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.040 Vali Acc: 0.819 Test Loss: 1.040 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.508913278579712
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.819 Test Loss: 1.057 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6311025619506836
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.819 Test Loss: 1.049 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.615481376647949
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.819 Test Loss: 1.039 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.589132070541382
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.819 Test Loss: 1.030 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5264456272125244
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.806 Test Loss: 1.022 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6154823303222656
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.806 Test Loss: 1.017 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6377005577087402
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.214 Vali Acc: 0.389 Test Loss: 2.214 Test Acc: 0.389
Validation loss decreased (inf --> -0.388867).  Saving model ...
Epoch: 2 cost time: 2.417997121810913
Epoch: 2, Steps: 7 | Train Loss: 1.729 Vali Loss: 1.292 Vali Acc: 0.708 Test Loss: 1.292 Test Acc: 0.708
Validation loss decreased (-0.388867 --> -0.708320).  Saving model ...
Epoch: 3 cost time: 2.347832679748535
Epoch: 3, Steps: 7 | Train Loss: 0.553 Vali Loss: 0.931 Vali Acc: 0.792 Test Loss: 0.931 Test Acc: 0.792
Validation loss decreased (-0.708320 --> -0.791657).  Saving model ...
Epoch: 4 cost time: 3.0211610794067383
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.911 Vali Acc: 0.736 Test Loss: 0.911 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.578545093536377
Epoch: 5, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.938 Vali Acc: 0.819 Test Loss: 0.938 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 2.5569067001342773
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.966 Vali Acc: 0.806 Test Loss: 0.966 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5669405460357666
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.806 Test Loss: 1.014 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.487426519393921
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.764 Test Loss: 1.045 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.458030939102173
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.764 Test Loss: 1.059 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.633967161178589
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.778 Test Loss: 1.060 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.496145725250244
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.778 Test Loss: 1.059 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.639328718185425
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.778 Test Loss: 1.049 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.632260322570801
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.806 Test Loss: 1.040 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.8121347427368164
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.806 Test Loss: 1.029 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.515998601913452
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.806 Test Loss: 1.021 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8950634002685547
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.299 Vali Acc: 0.236 Test Loss: 2.299 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 2.995455265045166
Epoch: 2, Steps: 7 | Train Loss: 1.862 Vali Loss: 1.580 Vali Acc: 0.681 Test Loss: 1.580 Test Acc: 0.681
Validation loss decreased (-0.236088 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 2.483210325241089
Epoch: 3, Steps: 7 | Train Loss: 0.757 Vali Loss: 1.254 Vali Acc: 0.708 Test Loss: 1.254 Test Acc: 0.708
Validation loss decreased (-0.680540 --> -0.708321).  Saving model ...
Epoch: 4 cost time: 2.5001542568206787
Epoch: 4, Steps: 7 | Train Loss: 0.235 Vali Loss: 1.175 Vali Acc: 0.694 Test Loss: 1.175 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3928136825561523
Epoch: 5, Steps: 7 | Train Loss: 0.053 Vali Loss: 1.109 Vali Acc: 0.708 Test Loss: 1.109 Test Acc: 0.708
Validation loss decreased (-0.708321 --> -0.708322).  Saving model ...
Epoch: 6 cost time: 2.377328634262085
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.970 Vali Acc: 0.736 Test Loss: 0.970 Test Acc: 0.736
Validation loss decreased (-0.708322 --> -0.736101).  Saving model ...
Epoch: 7 cost time: 2.1991889476776123
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.736101 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 2.341730833053589
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.736 Test Loss: 0.992 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.199495553970337
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.722 Test Loss: 1.005 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.472895860671997
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.736 Test Loss: 0.990 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.369173288345337
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.736 Test Loss: 0.976 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.43350887298584
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.750 Test Loss: 0.960 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 2.412900686264038
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 2.357144355773926
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 2.5626156330108643
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3481695652008057
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 2.4563047885894775
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3962152004241943
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.549250364303589
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5744502544403076
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5815765857696533
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.527662992477417
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3780527114868164
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3002724647521973
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6847786903381348
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.3278427124023438
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.75
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4413700103759766
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.360 Vali Acc: 0.167 Test Loss: 2.360 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.4218389987945557
Epoch: 2, Steps: 7 | Train Loss: 2.043 Vali Loss: 1.855 Vali Acc: 0.458 Test Loss: 1.855 Test Acc: 0.458
Validation loss decreased (-0.166643 --> -0.458315).  Saving model ...
Epoch: 3 cost time: 2.4287900924682617
Epoch: 3, Steps: 7 | Train Loss: 0.930 Vali Loss: 1.568 Vali Acc: 0.569 Test Loss: 1.568 Test Acc: 0.569
Validation loss decreased (-0.458315 --> -0.569429).  Saving model ...
Epoch: 4 cost time: 2.3338208198547363
Epoch: 4, Steps: 7 | Train Loss: 0.314 Vali Loss: 1.358 Vali Acc: 0.597 Test Loss: 1.358 Test Acc: 0.597
Validation loss decreased (-0.569429 --> -0.597209).  Saving model ...
Epoch: 5 cost time: 2.472862958908081
Epoch: 5, Steps: 7 | Train Loss: 0.074 Vali Loss: 1.507 Vali Acc: 0.597 Test Loss: 1.507 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.432326078414917
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 1.286 Vali Acc: 0.583 Test Loss: 1.286 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4870948791503906
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.379 Vali Acc: 0.528 Test Loss: 1.379 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2955563068389893
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.233 Vali Acc: 0.583 Test Loss: 1.233 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2977259159088135
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.175 Vali Acc: 0.597 Test Loss: 1.175 Test Acc: 0.597
Validation loss decreased (-0.597209 --> -0.597210).  Saving model ...
Epoch: 10 cost time: 2.4863100051879883
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.182 Vali Acc: 0.625 Test Loss: 1.182 Test Acc: 0.625
Validation loss decreased (-0.597210 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 2.435626983642578
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.625 Test Loss: 1.220 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.479696750640869
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.639 Test Loss: 1.266 Test Acc: 0.639
Validation loss decreased (-0.624988 --> -0.638876).  Saving model ...
Epoch: 13 cost time: 2.2773027420043945
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.611 Test Loss: 1.293 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.258465528488159
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.611 Test Loss: 1.301 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.261545181274414
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.611 Test Loss: 1.306 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.356377601623535
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.611 Test Loss: 1.297 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.280841588973999
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.597 Test Loss: 1.297 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.333846092224121
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.597 Test Loss: 1.292 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2790045738220215
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.597 Test Loss: 1.288 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.408201217651367
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.611 Test Loss: 1.284 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.220076560974121
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.611 Test Loss: 1.282 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.412536382675171
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.611 Test Loss: 1.277 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6388888888888888
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9129769802093506
Epoch: 1, Steps: 7 | Train Loss: 2.527 Vali Loss: 2.448 Vali Acc: 0.167 Test Loss: 2.448 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.63800311088562
Epoch: 2, Steps: 7 | Train Loss: 2.098 Vali Loss: 2.191 Vali Acc: 0.333 Test Loss: 2.191 Test Acc: 0.333
Validation loss decreased (-0.166642 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 2.576591968536377
Epoch: 3, Steps: 7 | Train Loss: 1.129 Vali Loss: 2.078 Vali Acc: 0.375 Test Loss: 2.078 Test Acc: 0.375
Validation loss decreased (-0.333311 --> -0.374979).  Saving model ...
Epoch: 4 cost time: 3.016200304031372
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 2.115 Vali Acc: 0.319 Test Loss: 2.115 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4403891563415527
Epoch: 5, Steps: 7 | Train Loss: 0.148 Vali Loss: 2.216 Vali Acc: 0.431 Test Loss: 2.216 Test Acc: 0.431
Validation loss decreased (-0.374979 --> -0.430533).  Saving model ...
Epoch: 6 cost time: 2.67968487739563
Epoch: 6, Steps: 7 | Train Loss: 0.059 Vali Loss: 2.452 Vali Acc: 0.361 Test Loss: 2.452 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6985151767730713
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.725 Vali Acc: 0.333 Test Loss: 2.725 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4974029064178467
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.502 Vali Acc: 0.347 Test Loss: 2.502 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.587096929550171
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.741 Vali Acc: 0.389 Test Loss: 2.741 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4342265129089355
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.617 Vali Acc: 0.403 Test Loss: 2.617 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5275511741638184
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.573 Vali Acc: 0.403 Test Loss: 2.573 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7170937061309814
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.577 Vali Acc: 0.375 Test Loss: 2.577 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.541642189025879
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.595 Vali Acc: 0.403 Test Loss: 2.595 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3952221870422363
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.606 Vali Acc: 0.417 Test Loss: 2.606 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.428574323654175
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.632 Vali Acc: 0.417 Test Loss: 2.632 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.719674587249756
Epoch: 1, Steps: 7 | Train Loss: 2.570 Vali Loss: 2.449 Vali Acc: 0.167 Test Loss: 2.449 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.4618282318115234
Epoch: 2, Steps: 7 | Train Loss: 2.182 Vali Loss: 2.120 Vali Acc: 0.306 Test Loss: 2.120 Test Acc: 0.306
Validation loss decreased (-0.166642 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 2.483147144317627
Epoch: 3, Steps: 7 | Train Loss: 1.308 Vali Loss: 2.000 Vali Acc: 0.319 Test Loss: 2.000 Test Acc: 0.319
Validation loss decreased (-0.305534 --> -0.319424).  Saving model ...
Epoch: 4 cost time: 2.487079381942749
Epoch: 4, Steps: 7 | Train Loss: 0.592 Vali Loss: 1.846 Vali Acc: 0.375 Test Loss: 1.846 Test Acc: 0.375
Validation loss decreased (-0.319424 --> -0.374982).  Saving model ...
Epoch: 5 cost time: 2.4647557735443115
Epoch: 5, Steps: 7 | Train Loss: 0.250 Vali Loss: 2.048 Vali Acc: 0.347 Test Loss: 2.048 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4016835689544678
Epoch: 6, Steps: 7 | Train Loss: 0.095 Vali Loss: 1.984 Vali Acc: 0.444 Test Loss: 1.984 Test Acc: 0.444
Validation loss decreased (-0.374982 --> -0.444425).  Saving model ...
Epoch: 7 cost time: 2.4112327098846436
Epoch: 7, Steps: 7 | Train Loss: 0.033 Vali Loss: 2.343 Vali Acc: 0.417 Test Loss: 2.343 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.393770694732666
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.015 Vali Acc: 0.500 Test Loss: 2.015 Test Acc: 0.500
Validation loss decreased (-0.444425 --> -0.499980).  Saving model ...
Epoch: 9 cost time: 2.5014092922210693
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.181 Vali Acc: 0.444 Test Loss: 2.181 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5630924701690674
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.373 Vali Acc: 0.417 Test Loss: 2.373 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.328359842300415
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.509 Vali Acc: 0.403 Test Loss: 2.509 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4025192260742188
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.484 Vali Acc: 0.403 Test Loss: 2.484 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.279986619949341
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.414 Vali Acc: 0.431 Test Loss: 2.414 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3140525817871094
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.363 Vali Acc: 0.444 Test Loss: 2.363 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4434406757354736
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.359 Vali Acc: 0.431 Test Loss: 2.359 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.6024272441864014
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.358 Vali Acc: 0.458 Test Loss: 2.358 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4766616821289062
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.378 Vali Acc: 0.444 Test Loss: 2.378 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3557863235473633
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.394 Vali Acc: 0.444 Test Loss: 2.394 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4814260005950928
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.450 Vali Acc: 0.097 Test Loss: 2.450 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.629324197769165
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.146 Vali Acc: 0.347 Test Loss: 2.146 Test Acc: 0.347
Validation loss decreased (-0.097198 --> -0.347201).  Saving model ...
Epoch: 3 cost time: 2.5644378662109375
Epoch: 3, Steps: 7 | Train Loss: 1.426 Vali Loss: 2.036 Vali Acc: 0.319 Test Loss: 2.036 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.594667911529541
Epoch: 4, Steps: 7 | Train Loss: 0.713 Vali Loss: 1.826 Vali Acc: 0.361 Test Loss: 1.826 Test Acc: 0.361
Validation loss decreased (-0.347201 --> -0.361093).  Saving model ...
Epoch: 5 cost time: 2.4666457176208496
Epoch: 5, Steps: 7 | Train Loss: 0.310 Vali Loss: 1.911 Vali Acc: 0.375 Test Loss: 1.911 Test Acc: 0.375
Validation loss decreased (-0.361093 --> -0.374981).  Saving model ...
Epoch: 6 cost time: 2.582735061645508
Epoch: 6, Steps: 7 | Train Loss: 0.133 Vali Loss: 1.961 Vali Acc: 0.375 Test Loss: 1.961 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7907047271728516
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 2.050 Vali Acc: 0.361 Test Loss: 2.050 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.799215316772461
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.948 Vali Acc: 0.458 Test Loss: 1.948 Test Acc: 0.458
Validation loss decreased (-0.374981 --> -0.458314).  Saving model ...
Epoch: 9 cost time: 2.554062843322754
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.155 Vali Acc: 0.444 Test Loss: 2.155 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3496251106262207
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.358 Vali Acc: 0.417 Test Loss: 2.358 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2518153190612793
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.273 Vali Acc: 0.444 Test Loss: 2.273 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.248279333114624
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.171 Vali Acc: 0.458 Test Loss: 2.171 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.338658094406128
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.036 Vali Acc: 0.458 Test Loss: 2.036 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.38782000541687
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.981 Vali Acc: 0.444 Test Loss: 1.981 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2872369289398193
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.063 Vali Acc: 0.444 Test Loss: 2.063 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3463947772979736
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.154 Vali Acc: 0.431 Test Loss: 2.154 Test Acc: 0.431
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4310009479522705
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.200 Vali Acc: 0.431 Test Loss: 2.200 Test Acc: 0.431
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.393566131591797
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.221 Vali Acc: 0.431 Test Loss: 2.221 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4573440551757812
Epoch: 1, Steps: 7 | Train Loss: 2.573 Vali Loss: 2.491 Vali Acc: 0.097 Test Loss: 2.491 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.374617338180542
Epoch: 2, Steps: 7 | Train Loss: 2.305 Vali Loss: 2.243 Vali Acc: 0.319 Test Loss: 2.243 Test Acc: 0.319
Validation loss decreased (-0.097197 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 2.367098331451416
Epoch: 3, Steps: 7 | Train Loss: 1.538 Vali Loss: 2.146 Vali Acc: 0.264 Test Loss: 2.146 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.290231227874756
Epoch: 4, Steps: 7 | Train Loss: 0.808 Vali Loss: 1.981 Vali Acc: 0.333 Test Loss: 1.981 Test Acc: 0.333
Validation loss decreased (-0.319422 --> -0.333314).  Saving model ...
Epoch: 5 cost time: 2.1933648586273193
Epoch: 5, Steps: 7 | Train Loss: 0.359 Vali Loss: 2.067 Vali Acc: 0.347 Test Loss: 2.067 Test Acc: 0.347
Validation loss decreased (-0.333314 --> -0.347202).  Saving model ...
Epoch: 6 cost time: 2.3158748149871826
Epoch: 6, Steps: 7 | Train Loss: 0.149 Vali Loss: 2.046 Vali Acc: 0.361 Test Loss: 2.046 Test Acc: 0.361
Validation loss decreased (-0.347202 --> -0.361091).  Saving model ...
Epoch: 7 cost time: 2.401135206222534
Epoch: 7, Steps: 7 | Train Loss: 0.054 Vali Loss: 2.140 Vali Acc: 0.389 Test Loss: 2.140 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388867).  Saving model ...
Epoch: 8 cost time: 2.401775360107422
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.028 Vali Acc: 0.417 Test Loss: 2.028 Test Acc: 0.417
Validation loss decreased (-0.388867 --> -0.416646).  Saving model ...
Epoch: 9 cost time: 2.437199831008911
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.222 Vali Acc: 0.444 Test Loss: 2.222 Test Acc: 0.444
Validation loss decreased (-0.416646 --> -0.444422).  Saving model ...
Epoch: 10 cost time: 2.509687662124634
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.366 Vali Acc: 0.389 Test Loss: 2.366 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.319397211074829
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.353 Vali Acc: 0.417 Test Loss: 2.353 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.371324300765991
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.294 Vali Acc: 0.403 Test Loss: 2.294 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.350590705871582
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.250 Vali Acc: 0.431 Test Loss: 2.250 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.26155161857605
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.237 Vali Acc: 0.431 Test Loss: 2.237 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2649526596069336
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.307 Vali Acc: 0.431 Test Loss: 2.307 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.35105562210083
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.350 Vali Acc: 0.444 Test Loss: 2.350 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.325378656387329
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.366 Vali Acc: 0.458 Test Loss: 2.366 Test Acc: 0.458
Validation loss decreased (-0.444422 --> -0.458310).  Saving model ...
Epoch: 18 cost time: 2.238301992416382
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.373 Vali Acc: 0.444 Test Loss: 2.373 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2273519039154053
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.367 Vali Acc: 0.458 Test Loss: 2.367 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3172225952148438
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.361 Vali Acc: 0.458 Test Loss: 2.361 Test Acc: 0.458
Validation loss decreased (-0.458310 --> -0.458310).  Saving model ...
Epoch: 21 cost time: 2.394129753112793
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.366 Vali Acc: 0.444 Test Loss: 2.366 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2106144428253174
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.349 Vali Acc: 0.444 Test Loss: 2.349 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.523677349090576
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.364 Vali Acc: 0.444 Test Loss: 2.364 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4582481384277344
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.444 Test Loss: 2.369 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4632387161254883
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.458 Test Loss: 2.387 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3006982803344727
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.458 Test Loss: 2.402 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.279849052429199
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.430 Vali Acc: 0.458 Test Loss: 2.430 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.374337911605835
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.458 Test Loss: 2.442 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.326575994491577
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.458 Test Loss: 2.463 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.240293264389038
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.477 Vali Acc: 0.458 Test Loss: 2.477 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.566849946975708
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.521 Vali Acc: 0.111 Test Loss: 2.521 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.1394102573394775
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.354 Vali Acc: 0.222 Test Loss: 2.354 Test Acc: 0.222
Validation loss decreased (-0.111086 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 2.30731463432312
Epoch: 3, Steps: 7 | Train Loss: 1.825 Vali Loss: 2.402 Vali Acc: 0.125 Test Loss: 2.402 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.248520612716675
Epoch: 4, Steps: 7 | Train Loss: 1.199 Vali Loss: 2.283 Vali Acc: 0.208 Test Loss: 2.283 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1679670810699463
Epoch: 5, Steps: 7 | Train Loss: 0.703 Vali Loss: 2.396 Vali Acc: 0.278 Test Loss: 2.396 Test Acc: 0.278
Validation loss decreased (-0.222199 --> -0.277754).  Saving model ...
Epoch: 6 cost time: 2.428748607635498
Epoch: 6, Steps: 7 | Train Loss: 0.373 Vali Loss: 2.547 Vali Acc: 0.194 Test Loss: 2.547 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.295754909515381
Epoch: 7, Steps: 7 | Train Loss: 0.187 Vali Loss: 2.419 Vali Acc: 0.333 Test Loss: 2.419 Test Acc: 0.333
Validation loss decreased (-0.277754 --> -0.333309).  Saving model ...
Epoch: 8 cost time: 2.266997814178467
Epoch: 8, Steps: 7 | Train Loss: 0.067 Vali Loss: 2.556 Vali Acc: 0.306 Test Loss: 2.556 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6298015117645264
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 2.626 Vali Acc: 0.361 Test Loss: 2.626 Test Acc: 0.361
Validation loss decreased (-0.333309 --> -0.361085).  Saving model ...
Epoch: 10 cost time: 2.5235233306884766
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.564 Vali Acc: 0.361 Test Loss: 2.564 Test Acc: 0.361
Validation loss decreased (-0.361085 --> -0.361085).  Saving model ...
Epoch: 11 cost time: 2.577430248260498
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.054 Vali Acc: 0.278 Test Loss: 3.054 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.392378807067871
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.877 Vali Acc: 0.417 Test Loss: 2.877 Test Acc: 0.417
Validation loss decreased (-0.361085 --> -0.416638).  Saving model ...
Epoch: 13 cost time: 2.7557425498962402
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.827 Vali Acc: 0.389 Test Loss: 2.827 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4277162551879883
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.788 Vali Acc: 0.403 Test Loss: 2.788 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6101138591766357
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.047 Vali Acc: 0.292 Test Loss: 3.047 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.458946466445923
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.136 Vali Acc: 0.306 Test Loss: 3.136 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5149271488189697
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.052 Vali Acc: 0.361 Test Loss: 3.052 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4456679821014404
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.975 Vali Acc: 0.333 Test Loss: 2.975 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4238314628601074
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.942 Vali Acc: 0.375 Test Loss: 2.942 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.48219633102417
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.000 Vali Acc: 0.361 Test Loss: 3.000 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4023783206939697
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.077 Vali Acc: 0.319 Test Loss: 3.077 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.388512134552002
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.051 Vali Acc: 0.319 Test Loss: 3.051 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.537442684173584
Epoch: 1, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.517 Vali Acc: 0.125 Test Loss: 2.517 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.366532325744629
Epoch: 2, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.427 Vali Acc: 0.139 Test Loss: 2.427 Test Acc: 0.139
Validation loss decreased (-0.124975 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 2.141075372695923
Epoch: 3, Steps: 7 | Train Loss: 1.787 Vali Loss: 2.442 Vali Acc: 0.208 Test Loss: 2.442 Test Acc: 0.208
Validation loss decreased (-0.138865 --> -0.208309).  Saving model ...
Epoch: 4 cost time: 2.494227647781372
Epoch: 4, Steps: 7 | Train Loss: 1.218 Vali Loss: 2.605 Vali Acc: 0.236 Test Loss: 2.605 Test Acc: 0.236
Validation loss decreased (-0.208309 --> -0.236085).  Saving model ...
Epoch: 5 cost time: 2.5678205490112305
Epoch: 5, Steps: 7 | Train Loss: 0.814 Vali Loss: 2.546 Vali Acc: 0.306 Test Loss: 2.546 Test Acc: 0.306
Validation loss decreased (-0.236085 --> -0.305530).  Saving model ...
Epoch: 6 cost time: 2.7238190174102783
Epoch: 6, Steps: 7 | Train Loss: 0.487 Vali Loss: 2.612 Vali Acc: 0.319 Test Loss: 2.612 Test Acc: 0.319
Validation loss decreased (-0.305530 --> -0.319418).  Saving model ...
Epoch: 7 cost time: 2.475916862487793
Epoch: 7, Steps: 7 | Train Loss: 0.278 Vali Loss: 2.501 Vali Acc: 0.292 Test Loss: 2.501 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4085750579833984
Epoch: 8, Steps: 7 | Train Loss: 0.152 Vali Loss: 2.661 Vali Acc: 0.319 Test Loss: 2.661 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.825754165649414
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 2.833 Vali Acc: 0.278 Test Loss: 2.833 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3033926486968994
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 3.299 Vali Acc: 0.236 Test Loss: 3.299 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4376728534698486
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.683 Vali Acc: 0.250 Test Loss: 3.683 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.437983274459839
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 3.487 Vali Acc: 0.264 Test Loss: 3.487 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4624390602111816
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.496 Vali Acc: 0.292 Test Loss: 3.496 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.327977418899536
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.806 Vali Acc: 0.236 Test Loss: 3.806 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2959043979644775
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 4.055 Vali Acc: 0.264 Test Loss: 4.055 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6937761306762695
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.938 Vali Acc: 0.278 Test Loss: 3.938 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3194444444444444
model parameter : 1284044
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.784421920776367
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.083 Vali Acc: 0.528 Test Loss: 2.083 Test Acc: 0.528
Validation loss decreased (inf --> -0.527757).  Saving model ...
Epoch: 2 cost time: 2.3529305458068848
Epoch: 2, Steps: 7 | Train Loss: 1.406 Vali Loss: 1.137 Vali Acc: 0.708 Test Loss: 1.137 Test Acc: 0.708
Validation loss decreased (-0.527757 --> -0.708322).  Saving model ...
Epoch: 3 cost time: 2.520047664642334
Epoch: 3, Steps: 7 | Train Loss: 0.384 Vali Loss: 0.909 Vali Acc: 0.806 Test Loss: 0.909 Test Acc: 0.806
Validation loss decreased (-0.708322 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 2.4992833137512207
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 2.4662506580352783
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.051 Vali Acc: 0.778 Test Loss: 1.051 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5439372062683105
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.196 Vali Acc: 0.778 Test Loss: 1.196 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.56919264793396
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.184 Vali Acc: 0.778 Test Loss: 1.184 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5028302669525146
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.152 Vali Acc: 0.778 Test Loss: 1.152 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4616596698760986
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.819 Test Loss: 1.137 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5484402179718018
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.819 Test Loss: 1.128 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.678894519805908
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.819 Test Loss: 1.121 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6706702709198
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.119 Vali Acc: 0.819 Test Loss: 1.119 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.618969678878784
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.833 Test Loss: 1.116 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833322).  Saving model ...
Epoch: 14 cost time: 2.6195411682128906
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.112 Vali Acc: 0.833 Test Loss: 1.112 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 15 cost time: 2.547147274017334
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.833 Test Loss: 1.107 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 16 cost time: 2.464695692062378
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.833 Test Loss: 1.100 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 17 cost time: 2.420870542526245
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.833 Test Loss: 1.097 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 18 cost time: 2.495497941970825
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.833 Test Loss: 1.093 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 19 cost time: 2.720123529434204
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.833 Test Loss: 1.090 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 20 cost time: 2.5228774547576904
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.833 Test Loss: 1.088 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 21 cost time: 2.4302120208740234
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.833 Test Loss: 1.083 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833322).  Saving model ...
Epoch: 22 cost time: 2.4417340755462646
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.833 Test Loss: 1.081 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833323).  Saving model ...
Epoch: 23 cost time: 2.3705804347991943
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.833 Test Loss: 1.078 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 24 cost time: 2.661987543106079
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.833 Test Loss: 1.077 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 25 cost time: 2.6133182048797607
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.819 Test Loss: 1.076 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.441495656967163
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.819 Test Loss: 1.074 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3019237518310547
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.819 Test Loss: 1.074 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.499427080154419
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.833 Test Loss: 1.073 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 29 cost time: 2.5971322059631348
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.833 Test Loss: 1.071 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 30 cost time: 2.582345962524414
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.847 Test Loss: 1.070 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847212).  Saving model ...
Epoch: 31 cost time: 2.631058931350708
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.847 Test Loss: 1.071 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.7521655559539795
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.847 Test Loss: 1.071 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.6970152854919434
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.847 Test Loss: 1.069 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 34 cost time: 2.5014452934265137
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.847 Test Loss: 1.069 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 35 cost time: 2.633707284927368
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.847 Test Loss: 1.069 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.247255802154541
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.847 Test Loss: 1.068 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847212).  Saving model ...
Epoch: 37 cost time: 2.6576035022735596
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.847 Test Loss: 1.069 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.52881121635437
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.847 Test Loss: 1.070 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.5604896545410156
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.847 Test Loss: 1.072 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.6505677700042725
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.847 Test Loss: 1.072 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.3880860805511475
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.847 Test Loss: 1.071 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.634965181350708
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.847 Test Loss: 1.071 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.4270403385162354
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.847 Test Loss: 1.069 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.795865297317505
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.833 Test Loss: 1.068 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.4650211334228516
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.819 Test Loss: 1.067 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.3243234157562256
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.819 Test Loss: 1.069 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.413708448410034
Epoch: 1, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.221 Vali Acc: 0.458 Test Loss: 2.221 Test Acc: 0.458
Validation loss decreased (inf --> -0.458311).  Saving model ...
Epoch: 2 cost time: 2.3450937271118164
Epoch: 2, Steps: 7 | Train Loss: 1.622 Vali Loss: 1.383 Vali Acc: 0.667 Test Loss: 1.383 Test Acc: 0.667
Validation loss decreased (-0.458311 --> -0.666653).  Saving model ...
Epoch: 3 cost time: 2.564119338989258
Epoch: 3, Steps: 7 | Train Loss: 0.554 Vali Loss: 1.046 Vali Acc: 0.764 Test Loss: 1.046 Test Acc: 0.764
Validation loss decreased (-0.666653 --> -0.763878).  Saving model ...
Epoch: 4 cost time: 2.2851500511169434
Epoch: 4, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.885 Vali Acc: 0.778 Test Loss: 0.885 Test Acc: 0.778
Validation loss decreased (-0.763878 --> -0.777769).  Saving model ...
Epoch: 5 cost time: 2.468980312347412
Epoch: 5, Steps: 7 | Train Loss: 0.021 Vali Loss: 1.181 Vali Acc: 0.722 Test Loss: 1.181 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.461021661758423
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.206 Vali Acc: 0.764 Test Loss: 1.206 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6657016277313232
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.129 Vali Acc: 0.764 Test Loss: 1.129 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5575859546661377
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.764 Test Loss: 1.046 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4336490631103516
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.806 Test Loss: 1.011 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805545).  Saving model ...
Epoch: 10 cost time: 2.479015350341797
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.806 Test Loss: 0.999 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805546).  Saving model ...
Epoch: 11 cost time: 2.7250471115112305
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.819 Test Loss: 0.993 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819435).  Saving model ...
Epoch: 12 cost time: 2.676182270050049
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.819 Test Loss: 0.994 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5870039463043213
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.819 Test Loss: 0.997 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5477874279022217
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.819 Test Loss: 1.000 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4044179916381836
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.819 Test Loss: 1.002 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.633653163909912
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.819 Test Loss: 1.003 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6367931365966797
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.819 Test Loss: 1.007 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4601340293884277
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.819 Test Loss: 1.008 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7111880779266357
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.819 Test Loss: 1.011 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5153820514678955
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.819 Test Loss: 1.013 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.379620313644409
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.819 Test Loss: 1.012 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.575685977935791
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.323 Vali Acc: 0.306 Test Loss: 2.323 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 2.521340847015381
Epoch: 2, Steps: 7 | Train Loss: 1.799 Vali Loss: 1.650 Vali Acc: 0.569 Test Loss: 1.650 Test Acc: 0.569
Validation loss decreased (-0.305532 --> -0.569428).  Saving model ...
Epoch: 3 cost time: 2.6077756881713867
Epoch: 3, Steps: 7 | Train Loss: 0.757 Vali Loss: 1.394 Vali Acc: 0.694 Test Loss: 1.394 Test Acc: 0.694
Validation loss decreased (-0.569428 --> -0.694431).  Saving model ...
Epoch: 4 cost time: 2.5440523624420166
Epoch: 4, Steps: 7 | Train Loss: 0.268 Vali Loss: 1.185 Vali Acc: 0.694 Test Loss: 1.185 Test Acc: 0.694
Validation loss decreased (-0.694431 --> -0.694433).  Saving model ...
Epoch: 5 cost time: 2.4941396713256836
Epoch: 5, Steps: 7 | Train Loss: 0.053 Vali Loss: 1.073 Vali Acc: 0.694 Test Loss: 1.073 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 2.521019220352173
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.981 Vali Acc: 0.722 Test Loss: 0.981 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 2.4051108360290527
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 2.485247850418091
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.778 Test Loss: 0.934 Test Acc: 0.778
Validation loss decreased (-0.749990 --> -0.777768).  Saving model ...
Epoch: 9 cost time: 2.4205799102783203
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.792 Test Loss: 0.935 Test Acc: 0.792
Validation loss decreased (-0.777768 --> -0.791657).  Saving model ...
Epoch: 10 cost time: 2.259945869445801
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.948 Vali Acc: 0.792 Test Loss: 0.948 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4118924140930176
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.792 Test Loss: 0.965 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.243457317352295
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.792 Test Loss: 0.978 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.456937789916992
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.778 Test Loss: 0.985 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3019001483917236
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.778 Test Loss: 0.990 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3587777614593506
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.778 Test Loss: 0.992 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.412219285964966
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.778 Test Loss: 0.993 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1873719692230225
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.778 Test Loss: 0.992 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.199571371078491
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2842965126037598
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.778 Test Loss: 1.001 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7916666666666666
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6656715869903564
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.366 Vali Acc: 0.264 Test Loss: 2.366 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 2.412954807281494
Epoch: 2, Steps: 7 | Train Loss: 1.892 Vali Loss: 1.896 Vali Acc: 0.389 Test Loss: 1.896 Test Acc: 0.389
Validation loss decreased (-0.263865 --> -0.388870).  Saving model ...
Epoch: 3 cost time: 2.3356080055236816
Epoch: 3, Steps: 7 | Train Loss: 0.931 Vali Loss: 1.671 Vali Acc: 0.514 Test Loss: 1.671 Test Acc: 0.514
Validation loss decreased (-0.388870 --> -0.513872).  Saving model ...
Epoch: 4 cost time: 2.4513933658599854
Epoch: 4, Steps: 7 | Train Loss: 0.338 Vali Loss: 1.468 Vali Acc: 0.569 Test Loss: 1.468 Test Acc: 0.569
Validation loss decreased (-0.513872 --> -0.569430).  Saving model ...
Epoch: 5 cost time: 2.4919958114624023
Epoch: 5, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.301 Vali Acc: 0.583 Test Loss: 1.301 Test Acc: 0.583
Validation loss decreased (-0.569430 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 2.351026773452759
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.342 Vali Acc: 0.639 Test Loss: 1.342 Test Acc: 0.639
Validation loss decreased (-0.583320 --> -0.638875).  Saving model ...
Epoch: 7 cost time: 2.3506832122802734
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.355 Vali Acc: 0.611 Test Loss: 1.355 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4221091270446777
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.263 Vali Acc: 0.611 Test Loss: 1.263 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.397101640701294
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.611 Test Loss: 1.270 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3558881282806396
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.583 Test Loss: 1.311 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.36320161819458
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.583 Test Loss: 1.351 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3120193481445312
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.583 Test Loss: 1.381 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1923811435699463
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.597 Test Loss: 1.395 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3472561836242676
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.597 Test Loss: 1.401 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3493635654449463
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.583 Test Loss: 1.399 Test Acc: 0.583
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2880637645721436
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.583 Test Loss: 1.397 Test Acc: 0.583
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6388888888888888
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4896762371063232
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.401 Vali Acc: 0.167 Test Loss: 2.401 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.2852942943573
Epoch: 2, Steps: 7 | Train Loss: 2.042 Vali Loss: 2.149 Vali Acc: 0.264 Test Loss: 2.149 Test Acc: 0.264
Validation loss decreased (-0.166643 --> -0.263867).  Saving model ...
Epoch: 3 cost time: 2.3175082206726074
Epoch: 3, Steps: 7 | Train Loss: 1.117 Vali Loss: 2.059 Vali Acc: 0.333 Test Loss: 2.059 Test Acc: 0.333
Validation loss decreased (-0.263867 --> -0.333313).  Saving model ...
Epoch: 4 cost time: 2.1698594093322754
Epoch: 4, Steps: 7 | Train Loss: 0.464 Vali Loss: 2.032 Vali Acc: 0.333 Test Loss: 2.032 Test Acc: 0.333
Validation loss decreased (-0.333313 --> -0.333313).  Saving model ...
Epoch: 5 cost time: 2.233538866043091
Epoch: 5, Steps: 7 | Train Loss: 0.145 Vali Loss: 2.095 Vali Acc: 0.403 Test Loss: 2.095 Test Acc: 0.403
Validation loss decreased (-0.333313 --> -0.402757).  Saving model ...
Epoch: 6 cost time: 2.4200198650360107
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.386 Vali Acc: 0.333 Test Loss: 2.386 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2849032878875732
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.349 Vali Acc: 0.375 Test Loss: 2.349 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3303840160369873
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.188 Vali Acc: 0.417 Test Loss: 2.188 Test Acc: 0.417
Validation loss decreased (-0.402757 --> -0.416645).  Saving model ...
Epoch: 9 cost time: 2.3754239082336426
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.275 Vali Acc: 0.417 Test Loss: 2.275 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2557616233825684
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.424 Vali Acc: 0.444 Test Loss: 2.424 Test Acc: 0.444
Validation loss decreased (-0.416645 --> -0.444420).  Saving model ...
Epoch: 11 cost time: 2.1887950897216797
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.516 Vali Acc: 0.431 Test Loss: 2.516 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1021029949188232
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.524 Vali Acc: 0.444 Test Loss: 2.524 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1168484687805176
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.512 Vali Acc: 0.444 Test Loss: 2.512 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.310905933380127
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.529 Vali Acc: 0.431 Test Loss: 2.529 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2138137817382812
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.535 Vali Acc: 0.431 Test Loss: 2.535 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2005207538604736
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.417 Test Loss: 2.528 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.498218059539795
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.537 Vali Acc: 0.417 Test Loss: 2.537 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.218425989151001
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.545 Vali Acc: 0.417 Test Loss: 2.545 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.248767375946045
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.578 Vali Acc: 0.403 Test Loss: 2.578 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3401119709014893
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.577 Vali Acc: 0.403 Test Loss: 2.577 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.617990732192993
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.400 Vali Acc: 0.208 Test Loss: 2.400 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.3121094703674316
Epoch: 2, Steps: 7 | Train Loss: 2.115 Vali Loss: 2.092 Vali Acc: 0.278 Test Loss: 2.092 Test Acc: 0.278
Validation loss decreased (-0.208309 --> -0.277757).  Saving model ...
Epoch: 3 cost time: 2.286195755004883
Epoch: 3, Steps: 7 | Train Loss: 1.304 Vali Loss: 1.921 Vali Acc: 0.431 Test Loss: 1.921 Test Acc: 0.431
Validation loss decreased (-0.277757 --> -0.430536).  Saving model ...
Epoch: 4 cost time: 2.4849815368652344
Epoch: 4, Steps: 7 | Train Loss: 0.619 Vali Loss: 1.841 Vali Acc: 0.389 Test Loss: 1.841 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4195938110351562
Epoch: 5, Steps: 7 | Train Loss: 0.234 Vali Loss: 1.899 Vali Acc: 0.333 Test Loss: 1.899 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.354567527770996
Epoch: 6, Steps: 7 | Train Loss: 0.083 Vali Loss: 2.139 Vali Acc: 0.431 Test Loss: 2.139 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3982555866241455
Epoch: 7, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.038 Vali Acc: 0.444 Test Loss: 2.038 Test Acc: 0.444
Validation loss decreased (-0.430536 --> -0.444424).  Saving model ...
Epoch: 8 cost time: 2.5440847873687744
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.062 Vali Acc: 0.444 Test Loss: 2.062 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.430847406387329
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.334 Vali Acc: 0.458 Test Loss: 2.334 Test Acc: 0.458
Validation loss decreased (-0.444424 --> -0.458310).  Saving model ...
Epoch: 10 cost time: 2.2974722385406494
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.570 Vali Acc: 0.431 Test Loss: 2.570 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3744566440582275
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.506 Vali Acc: 0.431 Test Loss: 2.506 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3049638271331787
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.358 Vali Acc: 0.458 Test Loss: 2.358 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1872916221618652
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.285 Vali Acc: 0.458 Test Loss: 2.285 Test Acc: 0.458
Validation loss decreased (-0.458310 --> -0.458310).  Saving model ...
Epoch: 14 cost time: 2.294604539871216
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.295 Vali Acc: 0.458 Test Loss: 2.295 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.239527463912964
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.346 Vali Acc: 0.458 Test Loss: 2.346 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1898648738861084
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.365 Vali Acc: 0.458 Test Loss: 2.365 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3298563957214355
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.379 Vali Acc: 0.458 Test Loss: 2.379 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1843628883361816
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.393 Vali Acc: 0.472 Test Loss: 2.393 Test Acc: 0.472
Validation loss decreased (-0.458310 --> -0.472198).  Saving model ...
Epoch: 19 cost time: 2.198309898376465
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.438 Vali Acc: 0.472 Test Loss: 2.438 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0264124870300293
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.418 Vali Acc: 0.458 Test Loss: 2.418 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1650993824005127
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.401 Vali Acc: 0.472 Test Loss: 2.401 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.21181583404541
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.472 Test Loss: 2.407 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1701807975769043
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.418 Vali Acc: 0.472 Test Loss: 2.418 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.078606367111206
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.412 Vali Acc: 0.458 Test Loss: 2.412 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2178995609283447
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.400 Vali Acc: 0.458 Test Loss: 2.400 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2636070251464844
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.458 Test Loss: 2.388 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2956299781799316
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.390 Vali Acc: 0.458 Test Loss: 2.390 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3113787174224854
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.472 Test Loss: 2.386 Test Acc: 0.472
Validation loss decreased (-0.472198 --> -0.472198).  Saving model ...
Epoch: 29 cost time: 2.2990164756774902
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.458 Test Loss: 2.386 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.440509557723999
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.458 Test Loss: 2.373 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3756299018859863
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.393 Vali Acc: 0.458 Test Loss: 2.393 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.4707117080688477
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.400 Vali Acc: 0.458 Test Loss: 2.400 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.381908416748047
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.396 Vali Acc: 0.458 Test Loss: 2.396 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.6223039627075195
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.384 Vali Acc: 0.458 Test Loss: 2.384 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.3944778442382812
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.472 Test Loss: 2.371 Test Acc: 0.472
Validation loss decreased (-0.472198 --> -0.472199).  Saving model ...
Epoch: 36 cost time: 2.292353391647339
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.472 Test Loss: 2.372 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.36458683013916
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.376 Vali Acc: 0.472 Test Loss: 2.376 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2907707691192627
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.458 Test Loss: 2.367 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.3801662921905518
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.360 Vali Acc: 0.472 Test Loss: 2.360 Test Acc: 0.472
Validation loss decreased (-0.472199 --> -0.472199).  Saving model ...
Epoch: 40 cost time: 2.1973836421966553
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.458 Test Loss: 2.349 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.3510468006134033
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.352 Vali Acc: 0.472 Test Loss: 2.352 Test Acc: 0.472
Validation loss decreased (-0.472199 --> -0.472199).  Saving model ...
Epoch: 42 cost time: 2.2057993412017822
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.335 Vali Acc: 0.472 Test Loss: 2.335 Test Acc: 0.472
Validation loss decreased (-0.472199 --> -0.472199).  Saving model ...
Epoch: 43 cost time: 2.186908483505249
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.472 Test Loss: 2.305 Test Acc: 0.472
Validation loss decreased (-0.472199 --> -0.472199).  Saving model ...
Epoch: 44 cost time: 2.316601276397705
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.285 Vali Acc: 0.486 Test Loss: 2.285 Test Acc: 0.486
Validation loss decreased (-0.472199 --> -0.486088).  Saving model ...
Epoch: 45 cost time: 2.1715495586395264
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.472 Test Loss: 2.275 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.1227378845214844
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.268 Vali Acc: 0.472 Test Loss: 2.268 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.256596326828003
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.269 Vali Acc: 0.472 Test Loss: 2.269 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.2819697856903076
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.472 Test Loss: 2.267 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.1317949295043945
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.255 Vali Acc: 0.472 Test Loss: 2.255 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.2059996128082275
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.486 Test Loss: 2.233 Test Acc: 0.486
Validation loss decreased (-0.486088 --> -0.486089).  Saving model ...
Epoch: 51 cost time: 2.4566779136657715
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.207 Vali Acc: 0.486 Test Loss: 2.207 Test Acc: 0.486
Validation loss decreased (-0.486089 --> -0.486089).  Saving model ...
Epoch: 52 cost time: 2.270137310028076
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.188 Vali Acc: 0.486 Test Loss: 2.188 Test Acc: 0.486
Validation loss decreased (-0.486089 --> -0.486089).  Saving model ...
Epoch: 53 cost time: 2.1997439861297607
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.486 Test Loss: 2.171 Test Acc: 0.486
Validation loss decreased (-0.486089 --> -0.486089).  Saving model ...
Epoch: 54 cost time: 2.2457826137542725
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.159 Vali Acc: 0.486 Test Loss: 2.159 Test Acc: 0.486
Validation loss decreased (-0.486089 --> -0.486090).  Saving model ...
Epoch: 55 cost time: 2.2567996978759766
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.143 Vali Acc: 0.500 Test Loss: 2.143 Test Acc: 0.500
Validation loss decreased (-0.486090 --> -0.499979).  Saving model ...
Epoch: 56 cost time: 2.1688530445098877
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.127 Vali Acc: 0.500 Test Loss: 2.127 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499979).  Saving model ...
Epoch: 57 cost time: 2.2623934745788574
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.500 Test Loss: 2.119 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499979).  Saving model ...
Epoch: 58 cost time: 2.2420735359191895
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.500 Test Loss: 2.107 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499979).  Saving model ...
Epoch: 59 cost time: 2.2574188709259033
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.500 Test Loss: 2.088 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499979).  Saving model ...
Epoch: 60 cost time: 2.201549768447876
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499979).  Saving model ...
Epoch: 61 cost time: 2.195666551589966
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.061 Vali Acc: 0.500 Test Loss: 2.061 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499979).  Saving model ...
Epoch: 62 cost time: 2.234891414642334
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.500 Test Loss: 2.035 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499980).  Saving model ...
Epoch: 63 cost time: 2.353766918182373
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.500 Test Loss: 2.009 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499980).  Saving model ...
Epoch: 64 cost time: 2.3635334968566895
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.500 Test Loss: 1.995 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499980).  Saving model ...
Epoch: 65 cost time: 2.3577373027801514
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.500 Test Loss: 1.977 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499980).  Saving model ...
Epoch: 66 cost time: 2.2614712715148926
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.500 Test Loss: 1.954 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499980).  Saving model ...
Epoch: 67 cost time: 2.3336338996887207
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.500 Test Loss: 1.941 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499981).  Saving model ...
Epoch: 68 cost time: 2.18115234375
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.500 Test Loss: 1.929 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 69 cost time: 2.3461904525756836
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.514 Test Loss: 1.919 Test Acc: 0.514
Validation loss decreased (-0.499981 --> -0.513870).  Saving model ...
Epoch: 70 cost time: 2.376479148864746
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.514 Test Loss: 1.912 Test Acc: 0.514
Validation loss decreased (-0.513870 --> -0.513870).  Saving model ...
Epoch: 71 cost time: 2.126373291015625
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.514 Test Loss: 1.906 Test Acc: 0.514
Validation loss decreased (-0.513870 --> -0.513870).  Saving model ...
Epoch: 72 cost time: 2.3139445781707764
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.514 Test Loss: 1.895 Test Acc: 0.514
Validation loss decreased (-0.513870 --> -0.513870).  Saving model ...
Epoch: 73 cost time: 2.3897314071655273
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.500 Test Loss: 1.882 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.332754373550415
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.384089231491089
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 2.404024839401245
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.514 Test Loss: 1.844 Test Acc: 0.514
Validation loss decreased (-0.513870 --> -0.513870).  Saving model ...
Epoch: 77 cost time: 2.473567247390747
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.528 Test Loss: 1.829 Test Acc: 0.528
Validation loss decreased (-0.513870 --> -0.527759).  Saving model ...
Epoch: 78 cost time: 2.378417730331421
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.528 Test Loss: 1.821 Test Acc: 0.528
Validation loss decreased (-0.527759 --> -0.527760).  Saving model ...
Epoch: 79 cost time: 2.3774447441101074
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.528 Test Loss: 1.812 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 80 cost time: 2.449826717376709
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.528 Test Loss: 1.803 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 81 cost time: 2.1932547092437744
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.528 Test Loss: 1.792 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 82 cost time: 2.16316556930542
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.528 Test Loss: 1.788 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 83 cost time: 2.227384328842163
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.528 Test Loss: 1.781 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 84 cost time: 2.365006923675537
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.528 Test Loss: 1.765 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 85 cost time: 2.2161242961883545
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.528 Test Loss: 1.749 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 86 cost time: 2.168494939804077
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.528 Test Loss: 1.737 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527760).  Saving model ...
Epoch: 87 cost time: 2.0825881958007812
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.528 Test Loss: 1.727 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527761).  Saving model ...
Epoch: 88 cost time: 2.1775848865509033
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.528 Test Loss: 1.710 Test Acc: 0.528
Validation loss decreased (-0.527761 --> -0.527761).  Saving model ...
Epoch: 89 cost time: 2.1117594242095947
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.528 Test Loss: 1.706 Test Acc: 0.528
Validation loss decreased (-0.527761 --> -0.527761).  Saving model ...
Epoch: 90 cost time: 2.176363706588745
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.528 Test Loss: 1.696 Test Acc: 0.528
Validation loss decreased (-0.527761 --> -0.527761).  Saving model ...
Epoch: 91 cost time: 2.2279133796691895
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.528 Test Loss: 1.691 Test Acc: 0.528
Validation loss decreased (-0.527761 --> -0.527761).  Saving model ...
Epoch: 92 cost time: 2.2039377689361572
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.542 Test Loss: 1.684 Test Acc: 0.542
Validation loss decreased (-0.527761 --> -0.541650).  Saving model ...
Epoch: 93 cost time: 2.2386457920074463
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.528 Test Loss: 1.681 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 2.193542957305908
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.528 Test Loss: 1.674 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 2.327307939529419
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.542 Test Loss: 1.670 Test Acc: 0.542
Validation loss decreased (-0.541650 --> -0.541650).  Saving model ...
Epoch: 96 cost time: 2.325728178024292
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.528 Test Loss: 1.668 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.3959641456604004
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.528 Test Loss: 1.665 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 2.3990554809570312
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.528 Test Loss: 1.661 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 2.6154887676239014
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.556 Test Loss: 1.654 Test Acc: 0.556
Validation loss decreased (-0.541650 --> -0.555539).  Saving model ...
Epoch: 100 cost time: 2.2624897956848145
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.569 Test Loss: 1.641 Test Acc: 0.569
Validation loss decreased (-0.555539 --> -0.569428).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5694444444444444
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.890255928039551
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.409 Vali Acc: 0.153 Test Loss: 2.409 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 2.40354323387146
Epoch: 2, Steps: 7 | Train Loss: 2.185 Vali Loss: 2.129 Vali Acc: 0.292 Test Loss: 2.129 Test Acc: 0.292
Validation loss decreased (-0.152754 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 2.544196367263794
Epoch: 3, Steps: 7 | Train Loss: 1.431 Vali Loss: 1.974 Vali Acc: 0.403 Test Loss: 1.974 Test Acc: 0.403
Validation loss decreased (-0.291645 --> -0.402758).  Saving model ...
Epoch: 4 cost time: 2.6161587238311768
Epoch: 4, Steps: 7 | Train Loss: 0.755 Vali Loss: 1.836 Vali Acc: 0.333 Test Loss: 1.836 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5290844440460205
Epoch: 5, Steps: 7 | Train Loss: 0.325 Vali Loss: 1.860 Vali Acc: 0.403 Test Loss: 1.860 Test Acc: 0.403
Validation loss decreased (-0.402758 --> -0.402759).  Saving model ...
Epoch: 6 cost time: 2.4624900817871094
Epoch: 6, Steps: 7 | Train Loss: 0.116 Vali Loss: 2.023 Vali Acc: 0.361 Test Loss: 2.023 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.584646701812744
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 1.968 Vali Acc: 0.389 Test Loss: 1.968 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.684807300567627
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.923 Vali Acc: 0.417 Test Loss: 1.923 Test Acc: 0.417
Validation loss decreased (-0.402759 --> -0.416647).  Saving model ...
Epoch: 9 cost time: 2.312891960144043
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.055 Vali Acc: 0.389 Test Loss: 2.055 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4046802520751953
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.227 Vali Acc: 0.361 Test Loss: 2.227 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2958996295928955
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.996 Vali Acc: 0.417 Test Loss: 1.996 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6259074211120605
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.044 Vali Acc: 0.431 Test Loss: 2.044 Test Acc: 0.431
Validation loss decreased (-0.416647 --> -0.430535).  Saving model ...
Epoch: 13 cost time: 2.7737417221069336
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.125 Vali Acc: 0.389 Test Loss: 2.125 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4378902912139893
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.228 Vali Acc: 0.389 Test Loss: 2.228 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.454674482345581
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.253 Vali Acc: 0.389 Test Loss: 2.253 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4879117012023926
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.214 Vali Acc: 0.389 Test Loss: 2.214 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.63598895072937
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.187 Vali Acc: 0.389 Test Loss: 2.187 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6864423751831055
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.164 Vali Acc: 0.403 Test Loss: 2.164 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.658172607421875
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.190 Vali Acc: 0.403 Test Loss: 2.190 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.500458002090454
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.187 Vali Acc: 0.389 Test Loss: 2.187 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4768424034118652
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.199 Vali Acc: 0.375 Test Loss: 2.199 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.349294424057007
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.231 Vali Acc: 0.375 Test Loss: 2.231 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6140987873077393
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.448 Vali Acc: 0.097 Test Loss: 2.448 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.238100051879883
Epoch: 2, Steps: 7 | Train Loss: 2.216 Vali Loss: 2.231 Vali Acc: 0.236 Test Loss: 2.231 Test Acc: 0.236
Validation loss decreased (-0.097198 --> -0.236089).  Saving model ...
Epoch: 3 cost time: 2.4548211097717285
Epoch: 3, Steps: 7 | Train Loss: 1.535 Vali Loss: 2.129 Vali Acc: 0.306 Test Loss: 2.129 Test Acc: 0.306
Validation loss decreased (-0.236089 --> -0.305534).  Saving model ...
Epoch: 4 cost time: 2.4745032787323
Epoch: 4, Steps: 7 | Train Loss: 0.824 Vali Loss: 2.024 Vali Acc: 0.264 Test Loss: 2.024 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4697105884552
Epoch: 5, Steps: 7 | Train Loss: 0.361 Vali Loss: 2.079 Vali Acc: 0.444 Test Loss: 2.079 Test Acc: 0.444
Validation loss decreased (-0.305534 --> -0.444424).  Saving model ...
Epoch: 6 cost time: 2.612657070159912
Epoch: 6, Steps: 7 | Train Loss: 0.141 Vali Loss: 2.208 Vali Acc: 0.292 Test Loss: 2.208 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3096532821655273
Epoch: 7, Steps: 7 | Train Loss: 0.063 Vali Loss: 2.162 Vali Acc: 0.403 Test Loss: 2.162 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5252859592437744
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.152 Vali Acc: 0.375 Test Loss: 2.152 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1882517337799072
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.542 Vali Acc: 0.389 Test Loss: 2.542 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3170244693756104
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.447 Vali Acc: 0.361 Test Loss: 2.447 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5375139713287354
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.330 Vali Acc: 0.361 Test Loss: 2.330 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7974793910980225
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.263 Vali Acc: 0.375 Test Loss: 2.263 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.641894817352295
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.347 Vali Acc: 0.417 Test Loss: 2.347 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5851964950561523
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.493 Vali Acc: 0.417 Test Loss: 2.493 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5128304958343506
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.549 Vali Acc: 0.417 Test Loss: 2.549 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.500610828399658
Epoch: 1, Steps: 7 | Train Loss: 2.592 Vali Loss: 2.453 Vali Acc: 0.083 Test Loss: 2.453 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.311842679977417
Epoch: 2, Steps: 7 | Train Loss: 2.309 Vali Loss: 2.325 Vali Acc: 0.236 Test Loss: 2.325 Test Acc: 0.236
Validation loss decreased (-0.083309 --> -0.236088).  Saving model ...
Epoch: 3 cost time: 2.25227689743042
Epoch: 3, Steps: 7 | Train Loss: 1.807 Vali Loss: 2.373 Vali Acc: 0.208 Test Loss: 2.373 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1656503677368164
Epoch: 4, Steps: 7 | Train Loss: 1.213 Vali Loss: 2.293 Vali Acc: 0.250 Test Loss: 2.293 Test Acc: 0.250
Validation loss decreased (-0.236088 --> -0.249977).  Saving model ...
Epoch: 5 cost time: 2.1057498455047607
Epoch: 5, Steps: 7 | Train Loss: 0.750 Vali Loss: 2.467 Vali Acc: 0.208 Test Loss: 2.467 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4992148876190186
Epoch: 6, Steps: 7 | Train Loss: 0.370 Vali Loss: 2.405 Vali Acc: 0.194 Test Loss: 2.405 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.438065767288208
Epoch: 7, Steps: 7 | Train Loss: 0.183 Vali Loss: 2.508 Vali Acc: 0.250 Test Loss: 2.508 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6095428466796875
Epoch: 8, Steps: 7 | Train Loss: 0.081 Vali Loss: 2.598 Vali Acc: 0.278 Test Loss: 2.598 Test Acc: 0.278
Validation loss decreased (-0.249977 --> -0.277752).  Saving model ...
Epoch: 9 cost time: 2.256553888320923
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 2.418 Vali Acc: 0.403 Test Loss: 2.418 Test Acc: 0.403
Validation loss decreased (-0.277752 --> -0.402754).  Saving model ...
Epoch: 10 cost time: 2.3904967308044434
Epoch: 10, Steps: 7 | Train Loss: 0.021 Vali Loss: 3.140 Vali Acc: 0.153 Test Loss: 3.140 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.198378562927246
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.994 Vali Acc: 0.278 Test Loss: 2.994 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1891582012176514
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.686 Vali Acc: 0.403 Test Loss: 2.686 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3058021068573
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.140 Vali Acc: 0.236 Test Loss: 3.140 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4035584926605225
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.415 Vali Acc: 0.208 Test Loss: 3.415 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4339253902435303
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 3.185 Vali Acc: 0.264 Test Loss: 3.185 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4479386806488037
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.041 Vali Acc: 0.306 Test Loss: 3.041 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3843464851379395
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.021 Vali Acc: 0.306 Test Loss: 3.021 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7462306022644043
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.084 Vali Acc: 0.306 Test Loss: 3.084 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.366642713546753
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.170 Vali Acc: 0.278 Test Loss: 3.170 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4027777777777778
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7958931922912598
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.469 Vali Acc: 0.236 Test Loss: 2.469 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 2.300222396850586
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.356 Vali Acc: 0.222 Test Loss: 2.356 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.459421157836914
Epoch: 3, Steps: 7 | Train Loss: 1.821 Vali Loss: 2.463 Vali Acc: 0.208 Test Loss: 2.463 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.44553804397583
Epoch: 4, Steps: 7 | Train Loss: 1.262 Vali Loss: 2.511 Vali Acc: 0.222 Test Loss: 2.511 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4493391513824463
Epoch: 5, Steps: 7 | Train Loss: 0.844 Vali Loss: 2.492 Vali Acc: 0.306 Test Loss: 2.492 Test Acc: 0.306
Validation loss decreased (-0.236086 --> -0.305531).  Saving model ...
Epoch: 6 cost time: 2.417879343032837
Epoch: 6, Steps: 7 | Train Loss: 0.471 Vali Loss: 2.408 Vali Acc: 0.292 Test Loss: 2.408 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.312511920928955
Epoch: 7, Steps: 7 | Train Loss: 0.266 Vali Loss: 2.574 Vali Acc: 0.167 Test Loss: 2.574 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3673315048217773
Epoch: 8, Steps: 7 | Train Loss: 0.166 Vali Loss: 2.514 Vali Acc: 0.319 Test Loss: 2.514 Test Acc: 0.319
Validation loss decreased (-0.305531 --> -0.319419).  Saving model ...
Epoch: 9 cost time: 2.4925501346588135
Epoch: 9, Steps: 7 | Train Loss: 0.097 Vali Loss: 2.992 Vali Acc: 0.222 Test Loss: 2.992 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.719654083251953
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 3.173 Vali Acc: 0.236 Test Loss: 3.173 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2927322387695312
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 3.544 Vali Acc: 0.236 Test Loss: 3.544 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.332577705383301
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 3.276 Vali Acc: 0.264 Test Loss: 3.276 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.186262845993042
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 3.450 Vali Acc: 0.292 Test Loss: 3.450 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.212982177734375
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.806 Vali Acc: 0.292 Test Loss: 3.806 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.529433488845825
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.629 Vali Acc: 0.250 Test Loss: 3.629 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3772482872009277
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.602 Vali Acc: 0.250 Test Loss: 3.602 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.45717191696167
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.703 Vali Acc: 0.250 Test Loss: 3.703 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4587936401367188
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.967 Vali Acc: 0.250 Test Loss: 3.967 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3194444444444444
model parameter : 1185740
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6710896492004395
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.109 Vali Acc: 0.500 Test Loss: 2.109 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 2.6075856685638428
Epoch: 2, Steps: 7 | Train Loss: 1.541 Vali Loss: 1.134 Vali Acc: 0.750 Test Loss: 1.134 Test Acc: 0.750
Validation loss decreased (-0.499979 --> -0.749989).  Saving model ...
Epoch: 3 cost time: 2.414133071899414
Epoch: 3, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.835 Vali Acc: 0.806 Test Loss: 0.835 Test Acc: 0.806
Validation loss decreased (-0.749989 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 2.5287914276123047
Epoch: 4, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.864 Vali Acc: 0.861 Test Loss: 0.864 Test Acc: 0.861
Validation loss decreased (-0.805547 --> -0.861102).  Saving model ...
Epoch: 5 cost time: 2.4489614963531494
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.970 Vali Acc: 0.806 Test Loss: 0.970 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.632969617843628
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.071 Vali Acc: 0.806 Test Loss: 1.071 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.533006191253662
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.847 Test Loss: 1.123 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4587326049804688
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.147 Vali Acc: 0.819 Test Loss: 1.147 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4260060787200928
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.819 Test Loss: 1.149 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4804515838623047
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.833 Test Loss: 1.134 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.687349319458008
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.847 Test Loss: 1.121 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.603135108947754
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.847 Test Loss: 1.110 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.584031581878662
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.847 Test Loss: 1.100 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6811654567718506
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.861 Test Loss: 1.091 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.706225633621216
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.215 Vali Acc: 0.375 Test Loss: 2.215 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 2.4125897884368896
Epoch: 2, Steps: 7 | Train Loss: 1.727 Vali Loss: 1.375 Vali Acc: 0.653 Test Loss: 1.375 Test Acc: 0.653
Validation loss decreased (-0.374978 --> -0.652764).  Saving model ...
Epoch: 3 cost time: 2.4391801357269287
Epoch: 3, Steps: 7 | Train Loss: 0.550 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
Validation loss decreased (-0.652764 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 2.6277875900268555
Epoch: 4, Steps: 7 | Train Loss: 0.190 Vali Loss: 0.911 Vali Acc: 0.819 Test Loss: 0.911 Test Acc: 0.819
Validation loss decreased (-0.749990 --> -0.819435).  Saving model ...
Epoch: 5 cost time: 2.4382200241088867
Epoch: 5, Steps: 7 | Train Loss: 0.021 Vali Loss: 1.014 Vali Acc: 0.778 Test Loss: 1.014 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5709874629974365
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.095 Vali Acc: 0.778 Test Loss: 1.095 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4283273220062256
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.106 Vali Acc: 0.764 Test Loss: 1.106 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5058016777038574
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.764 Test Loss: 1.100 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.604114055633545
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.764 Test Loss: 1.088 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3374924659729004
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.792 Test Loss: 1.073 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.569398880004883
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.819 Test Loss: 1.065 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4284756183624268
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.819 Test Loss: 1.060 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.241753339767456
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.819 Test Loss: 1.056 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5155885219573975
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.819 Test Loss: 1.053 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7593629360198975
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.297 Vali Acc: 0.333 Test Loss: 2.297 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 2.430203914642334
Epoch: 2, Steps: 7 | Train Loss: 1.873 Vali Loss: 1.657 Vali Acc: 0.569 Test Loss: 1.657 Test Acc: 0.569
Validation loss decreased (-0.333310 --> -0.569428).  Saving model ...
Epoch: 3 cost time: 2.4132299423217773
Epoch: 3, Steps: 7 | Train Loss: 0.743 Vali Loss: 1.293 Vali Acc: 0.653 Test Loss: 1.293 Test Acc: 0.653
Validation loss decreased (-0.569428 --> -0.652765).  Saving model ...
Epoch: 4 cost time: 2.664724826812744
Epoch: 4, Steps: 7 | Train Loss: 0.308 Vali Loss: 1.276 Vali Acc: 0.681 Test Loss: 1.276 Test Acc: 0.681
Validation loss decreased (-0.652765 --> -0.680543).  Saving model ...
Epoch: 5 cost time: 2.484151840209961
Epoch: 5, Steps: 7 | Train Loss: 0.055 Vali Loss: 1.150 Vali Acc: 0.694 Test Loss: 1.150 Test Acc: 0.694
Validation loss decreased (-0.680543 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 2.549042224884033
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 2.6378278732299805
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.185 Vali Acc: 0.708 Test Loss: 1.185 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4894466400146484
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.750 Test Loss: 1.081 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 2.4938547611236572
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.778 Test Loss: 1.024 Test Acc: 0.778
Validation loss decreased (-0.749989 --> -0.777768).  Saving model ...
Epoch: 10 cost time: 2.369368314743042
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4724321365356445
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.736 Test Loss: 1.042 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.545604944229126
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.736 Test Loss: 1.063 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4580655097961426
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.578289031982422
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.764 Test Loss: 1.053 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.259735584259033
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.764 Test Loss: 1.040 Test Acc: 0.764
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.271536350250244
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.764 Test Loss: 1.028 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.420243978500366
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.750 Test Loss: 1.020 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.717402219772339
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4210073947906494
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.750 Test Loss: 1.017 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7277297973632812
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.324 Vali Acc: 0.333 Test Loss: 2.324 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 2.633284568786621
Epoch: 2, Steps: 7 | Train Loss: 2.037 Vali Loss: 1.901 Vali Acc: 0.486 Test Loss: 1.901 Test Acc: 0.486
Validation loss decreased (-0.333310 --> -0.486092).  Saving model ...
Epoch: 3 cost time: 2.612389326095581
Epoch: 3, Steps: 7 | Train Loss: 0.936 Vali Loss: 1.660 Vali Acc: 0.500 Test Loss: 1.660 Test Acc: 0.500
Validation loss decreased (-0.486092 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 2.4566869735717773
Epoch: 4, Steps: 7 | Train Loss: 0.408 Vali Loss: 1.473 Vali Acc: 0.611 Test Loss: 1.473 Test Acc: 0.611
Validation loss decreased (-0.499983 --> -0.611096).  Saving model ...
Epoch: 5 cost time: 2.4851481914520264
Epoch: 5, Steps: 7 | Train Loss: 0.090 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3726093769073486
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 1.395 Vali Acc: 0.542 Test Loss: 1.395 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.653374433517456
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.605 Vali Acc: 0.625 Test Loss: 1.605 Test Acc: 0.625
Validation loss decreased (-0.611096 --> -0.624984).  Saving model ...
Epoch: 8 cost time: 2.5542349815368652
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.391 Vali Acc: 0.597 Test Loss: 1.391 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.475482702255249
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.364 Vali Acc: 0.611 Test Loss: 1.364 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4560980796813965
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.421 Vali Acc: 0.583 Test Loss: 1.421 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3764476776123047
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.569 Test Loss: 1.467 Test Acc: 0.569
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.318632125854492
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.583 Test Loss: 1.474 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.508711814880371
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.583 Test Loss: 1.471 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.56067156791687
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.569 Test Loss: 1.468 Test Acc: 0.569
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.369422197341919
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.569 Test Loss: 1.460 Test Acc: 0.569
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.439872980117798
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.583 Test Loss: 1.455 Test Acc: 0.583
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6126654148101807
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.583 Test Loss: 1.465 Test Acc: 0.583
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.625
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.072549104690552
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.4385852813720703
Epoch: 2, Steps: 7 | Train Loss: 2.137 Vali Loss: 2.218 Vali Acc: 0.319 Test Loss: 2.218 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 2.5383026599884033
Epoch: 3, Steps: 7 | Train Loss: 1.140 Vali Loss: 2.114 Vali Acc: 0.361 Test Loss: 2.114 Test Acc: 0.361
Validation loss decreased (-0.319422 --> -0.361090).  Saving model ...
Epoch: 4 cost time: 2.539579391479492
Epoch: 4, Steps: 7 | Train Loss: 0.458 Vali Loss: 2.051 Vali Acc: 0.306 Test Loss: 2.051 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5466995239257812
Epoch: 5, Steps: 7 | Train Loss: 0.170 Vali Loss: 2.146 Vali Acc: 0.361 Test Loss: 2.146 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3213348388671875
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 2.514 Vali Acc: 0.389 Test Loss: 2.514 Test Acc: 0.389
Validation loss decreased (-0.361090 --> -0.388864).  Saving model ...
Epoch: 7 cost time: 2.475234270095825
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.288 Vali Acc: 0.389 Test Loss: 2.288 Test Acc: 0.389
Validation loss decreased (-0.388864 --> -0.388866).  Saving model ...
Epoch: 8 cost time: 2.7538421154022217
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.242 Vali Acc: 0.389 Test Loss: 2.242 Test Acc: 0.389
Validation loss decreased (-0.388866 --> -0.388866).  Saving model ...
Epoch: 9 cost time: 2.4605188369750977
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.467 Vali Acc: 0.389 Test Loss: 2.467 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.386183023452759
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.681 Vali Acc: 0.403 Test Loss: 2.681 Test Acc: 0.403
Validation loss decreased (-0.388866 --> -0.402751).  Saving model ...
Epoch: 11 cost time: 2.4370574951171875
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.718 Vali Acc: 0.375 Test Loss: 2.718 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6001174449920654
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.665 Vali Acc: 0.361 Test Loss: 2.665 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.532667398452759
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.631 Vali Acc: 0.389 Test Loss: 2.631 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.54624342918396
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.624 Vali Acc: 0.375 Test Loss: 2.624 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.623641014099121
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.625 Vali Acc: 0.403 Test Loss: 2.625 Test Acc: 0.403
Validation loss decreased (-0.402751 --> -0.402752).  Saving model ...
Epoch: 16 cost time: 2.2586023807525635
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.620 Vali Acc: 0.403 Test Loss: 2.620 Test Acc: 0.403
Validation loss decreased (-0.402752 --> -0.402752).  Saving model ...
Epoch: 17 cost time: 2.3274924755096436
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.636 Vali Acc: 0.389 Test Loss: 2.636 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3409295082092285
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.636 Vali Acc: 0.403 Test Loss: 2.636 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2525618076324463
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.644 Vali Acc: 0.403 Test Loss: 2.644 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.19521427154541
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.662 Vali Acc: 0.417 Test Loss: 2.662 Test Acc: 0.417
Validation loss decreased (-0.402752 --> -0.416640).  Saving model ...
Epoch: 21 cost time: 2.3438992500305176
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.667 Vali Acc: 0.431 Test Loss: 2.667 Test Acc: 0.431
Validation loss decreased (-0.416640 --> -0.430529).  Saving model ...
Epoch: 22 cost time: 2.537567615509033
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.665 Vali Acc: 0.417 Test Loss: 2.665 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4257984161376953
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.650 Vali Acc: 0.417 Test Loss: 2.650 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.690188407897949
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.640 Vali Acc: 0.403 Test Loss: 2.640 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.352266550064087
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.646 Vali Acc: 0.403 Test Loss: 2.646 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.363949775695801
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.653 Vali Acc: 0.417 Test Loss: 2.653 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4242987632751465
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.667 Vali Acc: 0.403 Test Loss: 2.667 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.384002685546875
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.403 Test Loss: 2.677 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3759355545043945
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.417 Test Loss: 2.677 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2988009452819824
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.417 Test Loss: 2.685 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2549965381622314
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.683 Vali Acc: 0.417 Test Loss: 2.683 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4424824714660645
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.452 Vali Acc: 0.083 Test Loss: 2.452 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.689166307449341
Epoch: 2, Steps: 7 | Train Loss: 2.217 Vali Loss: 2.183 Vali Acc: 0.194 Test Loss: 2.183 Test Acc: 0.194
Validation loss decreased (-0.083309 --> -0.194423).  Saving model ...
Epoch: 3 cost time: 2.373185873031616
Epoch: 3, Steps: 7 | Train Loss: 1.307 Vali Loss: 2.003 Vali Acc: 0.375 Test Loss: 2.003 Test Acc: 0.375
Validation loss decreased (-0.194423 --> -0.374980).  Saving model ...
Epoch: 4 cost time: 2.3700220584869385
Epoch: 4, Steps: 7 | Train Loss: 0.624 Vali Loss: 1.891 Vali Acc: 0.389 Test Loss: 1.891 Test Acc: 0.389
Validation loss decreased (-0.374980 --> -0.388870).  Saving model ...
Epoch: 5 cost time: 2.4404795169830322
Epoch: 5, Steps: 7 | Train Loss: 0.258 Vali Loss: 2.001 Vali Acc: 0.375 Test Loss: 2.001 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.441101551055908
Epoch: 6, Steps: 7 | Train Loss: 0.106 Vali Loss: 2.092 Vali Acc: 0.431 Test Loss: 2.092 Test Acc: 0.431
Validation loss decreased (-0.388870 --> -0.430535).  Saving model ...
Epoch: 7 cost time: 2.4784553050994873
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 2.237 Vali Acc: 0.347 Test Loss: 2.237 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3723833560943604
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.267 Vali Acc: 0.431 Test Loss: 2.267 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6599676609039307
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.480 Vali Acc: 0.403 Test Loss: 2.480 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.502793073654175
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.615 Vali Acc: 0.389 Test Loss: 2.615 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.388624429702759
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.483 Vali Acc: 0.403 Test Loss: 2.483 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5620198249816895
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.368 Vali Acc: 0.431 Test Loss: 2.368 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6536805629730225
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.360 Vali Acc: 0.444 Test Loss: 2.360 Test Acc: 0.444
Validation loss decreased (-0.430535 --> -0.444421).  Saving model ...
Epoch: 14 cost time: 2.4763522148132324
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.406 Vali Acc: 0.431 Test Loss: 2.406 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3700926303863525
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.441 Vali Acc: 0.417 Test Loss: 2.441 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6711275577545166
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.455 Vali Acc: 0.417 Test Loss: 2.455 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5600407123565674
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.479 Vali Acc: 0.417 Test Loss: 2.479 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1641600131988525
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.496 Vali Acc: 0.417 Test Loss: 2.496 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.279618263244629
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.491 Vali Acc: 0.417 Test Loss: 2.491 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.390413284301758
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.500 Vali Acc: 0.417 Test Loss: 2.500 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2169556617736816
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.498 Vali Acc: 0.417 Test Loss: 2.498 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2500600814819336
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.468 Vali Acc: 0.417 Test Loss: 2.468 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3665719032287598
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.449 Vali Acc: 0.417 Test Loss: 2.449 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3432247638702393
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.451 Vali Acc: 0.083 Test Loss: 2.451 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.2408063411712646
Epoch: 2, Steps: 7 | Train Loss: 2.256 Vali Loss: 2.183 Vali Acc: 0.278 Test Loss: 2.183 Test Acc: 0.278
Validation loss decreased (-0.083309 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 2.1885008811950684
Epoch: 3, Steps: 7 | Train Loss: 1.436 Vali Loss: 1.989 Vali Acc: 0.389 Test Loss: 1.989 Test Acc: 0.389
Validation loss decreased (-0.277756 --> -0.388869).  Saving model ...
Epoch: 4 cost time: 2.2695767879486084
Epoch: 4, Steps: 7 | Train Loss: 0.746 Vali Loss: 1.868 Vali Acc: 0.361 Test Loss: 1.868 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.274491310119629
Epoch: 5, Steps: 7 | Train Loss: 0.357 Vali Loss: 1.906 Vali Acc: 0.417 Test Loss: 1.906 Test Acc: 0.417
Validation loss decreased (-0.388869 --> -0.416648).  Saving model ...
Epoch: 6 cost time: 2.339827060699463
Epoch: 6, Steps: 7 | Train Loss: 0.143 Vali Loss: 1.941 Vali Acc: 0.403 Test Loss: 1.941 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.489548444747925
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 2.006 Vali Acc: 0.375 Test Loss: 2.006 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.74332594871521
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.062 Vali Acc: 0.417 Test Loss: 2.062 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.506742000579834
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.301 Vali Acc: 0.347 Test Loss: 2.301 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3420398235321045
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.060 Vali Acc: 0.389 Test Loss: 2.060 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4199330806732178
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.938 Vali Acc: 0.389 Test Loss: 1.938 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4715278148651123
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.984 Vali Acc: 0.403 Test Loss: 1.984 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.385162353515625
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.095 Vali Acc: 0.417 Test Loss: 2.095 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4260356426239014
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.179 Vali Acc: 0.431 Test Loss: 2.179 Test Acc: 0.431
Validation loss decreased (-0.416648 --> -0.430534).  Saving model ...
Epoch: 15 cost time: 2.3811705112457275
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.197 Vali Acc: 0.444 Test Loss: 2.197 Test Acc: 0.444
Validation loss decreased (-0.430534 --> -0.444422).  Saving model ...
Epoch: 16 cost time: 2.637662649154663
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.166 Vali Acc: 0.444 Test Loss: 2.166 Test Acc: 0.444
Validation loss decreased (-0.444422 --> -0.444423).  Saving model ...
Epoch: 17 cost time: 2.575932025909424
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.159 Vali Acc: 0.444 Test Loss: 2.159 Test Acc: 0.444
Validation loss decreased (-0.444423 --> -0.444423).  Saving model ...
Epoch: 18 cost time: 2.336815357208252
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.141 Vali Acc: 0.444 Test Loss: 2.141 Test Acc: 0.444
Validation loss decreased (-0.444423 --> -0.444423).  Saving model ...
Epoch: 19 cost time: 2.482941150665283
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.128 Vali Acc: 0.458 Test Loss: 2.128 Test Acc: 0.458
Validation loss decreased (-0.444423 --> -0.458312).  Saving model ...
Epoch: 20 cost time: 2.3198301792144775
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.162 Vali Acc: 0.458 Test Loss: 2.162 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.526219606399536
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.171 Vali Acc: 0.458 Test Loss: 2.171 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7848246097564697
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.144 Vali Acc: 0.472 Test Loss: 2.144 Test Acc: 0.472
Validation loss decreased (-0.458312 --> -0.472201).  Saving model ...
Epoch: 23 cost time: 2.5034544467926025
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.121 Vali Acc: 0.472 Test Loss: 2.121 Test Acc: 0.472
Validation loss decreased (-0.472201 --> -0.472201).  Saving model ...
Epoch: 24 cost time: 2.6085848808288574
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.199 Vali Acc: 0.458 Test Loss: 2.199 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.567641019821167
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.230 Vali Acc: 0.458 Test Loss: 2.230 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7019500732421875
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.217 Vali Acc: 0.458 Test Loss: 2.217 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4252219200134277
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.458 Test Loss: 2.206 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.432532787322998
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.207 Vali Acc: 0.472 Test Loss: 2.207 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.610053539276123
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.472 Test Loss: 2.191 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.4010534286499023
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.226 Vali Acc: 0.458 Test Loss: 2.226 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.2776222229003906
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.210 Vali Acc: 0.458 Test Loss: 2.210 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.42057728767395
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.472 Test Loss: 2.196 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.540299654006958
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.472 Test Loss: 2.203 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4722222222222222
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.459304094314575
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.448 Vali Acc: 0.139 Test Loss: 2.448 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 2.2980494499206543
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 2.225 Vali Acc: 0.292 Test Loss: 2.225 Test Acc: 0.292
Validation loss decreased (-0.138864 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 2.3478853702545166
Epoch: 3, Steps: 7 | Train Loss: 1.505 Vali Loss: 2.082 Vali Acc: 0.417 Test Loss: 2.082 Test Acc: 0.417
Validation loss decreased (-0.291644 --> -0.416646).  Saving model ...
Epoch: 4 cost time: 2.6280648708343506
Epoch: 4, Steps: 7 | Train Loss: 0.830 Vali Loss: 2.020 Vali Acc: 0.333 Test Loss: 2.020 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.293347120285034
Epoch: 5, Steps: 7 | Train Loss: 0.403 Vali Loss: 2.057 Vali Acc: 0.333 Test Loss: 2.057 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3619723320007324
Epoch: 6, Steps: 7 | Train Loss: 0.154 Vali Loss: 2.079 Vali Acc: 0.375 Test Loss: 2.079 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2819056510925293
Epoch: 7, Steps: 7 | Train Loss: 0.063 Vali Loss: 2.151 Vali Acc: 0.375 Test Loss: 2.151 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.386617660522461
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 2.079 Vali Acc: 0.389 Test Loss: 2.079 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.177586555480957
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.495 Vali Acc: 0.306 Test Loss: 2.495 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.372244119644165
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.327 Vali Acc: 0.403 Test Loss: 2.327 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.404876947402954
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.156 Vali Acc: 0.417 Test Loss: 2.156 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4645633697509766
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.152 Vali Acc: 0.417 Test Loss: 2.152 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2055532932281494
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.300 Vali Acc: 0.417 Test Loss: 2.300 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5998847484588623
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.469 Vali Acc: 0.125 Test Loss: 2.469 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.3819544315338135
Epoch: 2, Steps: 7 | Train Loss: 2.346 Vali Loss: 2.332 Vali Acc: 0.208 Test Loss: 2.332 Test Acc: 0.208
Validation loss decreased (-0.124975 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 2.4593923091888428
Epoch: 3, Steps: 7 | Train Loss: 1.758 Vali Loss: 2.333 Vali Acc: 0.208 Test Loss: 2.333 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3811233043670654
Epoch: 4, Steps: 7 | Train Loss: 1.224 Vali Loss: 2.349 Vali Acc: 0.250 Test Loss: 2.349 Test Acc: 0.250
Validation loss decreased (-0.208310 --> -0.249977).  Saving model ...
Epoch: 5 cost time: 2.343106508255005
Epoch: 5, Steps: 7 | Train Loss: 0.747 Vali Loss: 2.381 Vali Acc: 0.125 Test Loss: 2.381 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4278759956359863
Epoch: 6, Steps: 7 | Train Loss: 0.399 Vali Loss: 2.334 Vali Acc: 0.333 Test Loss: 2.334 Test Acc: 0.333
Validation loss decreased (-0.249977 --> -0.333310).  Saving model ...
Epoch: 7 cost time: 2.150993824005127
Epoch: 7, Steps: 7 | Train Loss: 0.209 Vali Loss: 2.449 Vali Acc: 0.264 Test Loss: 2.449 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.082575559616089
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 2.632 Vali Acc: 0.222 Test Loss: 2.632 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4224166870117188
Epoch: 9, Steps: 7 | Train Loss: 0.053 Vali Loss: 2.798 Vali Acc: 0.153 Test Loss: 2.798 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.268155574798584
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 2.335 Vali Acc: 0.375 Test Loss: 2.335 Test Acc: 0.375
Validation loss decreased (-0.333310 --> -0.374977).  Saving model ...
Epoch: 11 cost time: 2.1830787658691406
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.845 Vali Acc: 0.403 Test Loss: 2.845 Test Acc: 0.403
Validation loss decreased (-0.374977 --> -0.402749).  Saving model ...
Epoch: 12 cost time: 2.4185683727264404
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 3.473 Vali Acc: 0.208 Test Loss: 3.473 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4654629230499268
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.886 Vali Acc: 0.333 Test Loss: 2.886 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2308082580566406
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.684 Vali Acc: 0.389 Test Loss: 2.684 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1281659603118896
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.963 Vali Acc: 0.236 Test Loss: 2.963 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3506181240081787
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.089 Vali Acc: 0.264 Test Loss: 3.089 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3614680767059326
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.034 Vali Acc: 0.306 Test Loss: 3.034 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.269503355026245
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.929 Vali Acc: 0.306 Test Loss: 2.929 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.317058801651001
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.905 Vali Acc: 0.333 Test Loss: 2.905 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.263436794281006
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.928 Vali Acc: 0.333 Test Loss: 2.928 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2896766662597656
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.957 Vali Acc: 0.319 Test Loss: 2.957 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4027777777777778
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.618229389190674
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.538 Vali Acc: 0.028 Test Loss: 2.538 Test Acc: 0.028
Validation loss decreased (inf --> -0.027752).  Saving model ...
Epoch: 2 cost time: 2.503358840942383
Epoch: 2, Steps: 7 | Train Loss: 2.323 Vali Loss: 2.367 Vali Acc: 0.125 Test Loss: 2.367 Test Acc: 0.125
Validation loss decreased (-0.027752 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.5457077026367188
Epoch: 3, Steps: 7 | Train Loss: 1.780 Vali Loss: 2.418 Vali Acc: 0.236 Test Loss: 2.418 Test Acc: 0.236
Validation loss decreased (-0.124976 --> -0.236087).  Saving model ...
Epoch: 4 cost time: 2.7167446613311768
Epoch: 4, Steps: 7 | Train Loss: 1.239 Vali Loss: 2.542 Vali Acc: 0.208 Test Loss: 2.542 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.626340389251709
Epoch: 5, Steps: 7 | Train Loss: 0.821 Vali Loss: 2.451 Vali Acc: 0.194 Test Loss: 2.451 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4630320072174072
Epoch: 6, Steps: 7 | Train Loss: 0.507 Vali Loss: 2.324 Vali Acc: 0.278 Test Loss: 2.324 Test Acc: 0.278
Validation loss decreased (-0.236087 --> -0.277755).  Saving model ...
Epoch: 7 cost time: 2.499833822250366
Epoch: 7, Steps: 7 | Train Loss: 0.319 Vali Loss: 2.217 Vali Acc: 0.333 Test Loss: 2.217 Test Acc: 0.333
Validation loss decreased (-0.277755 --> -0.333311).  Saving model ...
Epoch: 8 cost time: 2.5764498710632324
Epoch: 8, Steps: 7 | Train Loss: 0.164 Vali Loss: 2.556 Vali Acc: 0.319 Test Loss: 2.556 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7104310989379883
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 2.672 Vali Acc: 0.319 Test Loss: 2.672 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5609066486358643
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 3.072 Vali Acc: 0.208 Test Loss: 3.072 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6383819580078125
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.771 Vali Acc: 0.333 Test Loss: 2.771 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.383364677429199
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 3.731 Vali Acc: 0.264 Test Loss: 3.731 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2513442039489746
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 3.320 Vali Acc: 0.278 Test Loss: 3.320 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3987035751342773
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.177 Vali Acc: 0.306 Test Loss: 3.177 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5676136016845703
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.563 Vali Acc: 0.306 Test Loss: 3.563 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.290435552597046
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.664 Vali Acc: 0.319 Test Loss: 3.664 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.426523447036743
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.637 Vali Acc: 0.278 Test Loss: 3.637 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3333333333333333
model parameter : 1136588
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5993762016296387
Epoch: 1, Steps: 7 | Train Loss: 2.462 Vali Loss: 2.285 Vali Acc: 0.278 Test Loss: 2.285 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 2.3564670085906982
Epoch: 2, Steps: 7 | Train Loss: 1.865 Vali Loss: 1.608 Vali Acc: 0.625 Test Loss: 1.608 Test Acc: 0.625
Validation loss decreased (-0.277755 --> -0.624984).  Saving model ...
Epoch: 3 cost time: 2.242403030395508
Epoch: 3, Steps: 7 | Train Loss: 0.954 Vali Loss: 1.134 Vali Acc: 0.708 Test Loss: 1.134 Test Acc: 0.708
Validation loss decreased (-0.624984 --> -0.708322).  Saving model ...
Epoch: 4 cost time: 2.5363714694976807
Epoch: 4, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.933 Vali Acc: 0.764 Test Loss: 0.933 Test Acc: 0.764
Validation loss decreased (-0.708322 --> -0.763880).  Saving model ...
Epoch: 5 cost time: 2.5410711765289307
Epoch: 5, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.911 Vali Acc: 0.792 Test Loss: 0.911 Test Acc: 0.792
Validation loss decreased (-0.763880 --> -0.791658).  Saving model ...
Epoch: 6 cost time: 2.5681345462799072
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.874 Vali Acc: 0.792 Test Loss: 0.874 Test Acc: 0.792
Validation loss decreased (-0.791658 --> -0.791658).  Saving model ...
Epoch: 7 cost time: 2.508833646774292
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.905 Vali Acc: 0.764 Test Loss: 0.905 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.501378059387207
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.038 Vali Acc: 0.764 Test Loss: 1.038 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4536406993865967
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.068 Vali Acc: 0.778 Test Loss: 1.068 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5444717407226562
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.819 Test Loss: 0.954 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819435).  Saving model ...
Epoch: 11 cost time: 2.5697038173675537
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.833 Test Loss: 0.891 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833324).  Saving model ...
Epoch: 12 cost time: 2.210939645767212
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 13 cost time: 2.4716761112213135
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.833 Test Loss: 0.843 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 14 cost time: 2.4987332820892334
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2893753051757812
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4655966758728027
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.833 Test Loss: 0.860 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3460211753845215
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.497697591781616
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.833 Test Loss: 0.866 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4347546100616455
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.833 Test Loss: 0.867 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5340723991394043
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.833 Test Loss: 0.870 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6172609329223633
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3309988975524902
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.833 Test Loss: 0.873 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5476534366607666
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.833 Test Loss: 0.874 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8333333333333334
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9330637454986572
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.356 Vali Acc: 0.236 Test Loss: 2.356 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 2.6658124923706055
Epoch: 2, Steps: 7 | Train Loss: 1.993 Vali Loss: 1.790 Vali Acc: 0.611 Test Loss: 1.790 Test Acc: 0.611
Validation loss decreased (-0.236088 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 2.6493515968322754
Epoch: 3, Steps: 7 | Train Loss: 1.150 Vali Loss: 1.316 Vali Acc: 0.694 Test Loss: 1.316 Test Acc: 0.694
Validation loss decreased (-0.611093 --> -0.694431).  Saving model ...
Epoch: 4 cost time: 2.510026454925537
Epoch: 4, Steps: 7 | Train Loss: 0.487 Vali Loss: 1.049 Vali Acc: 0.764 Test Loss: 1.049 Test Acc: 0.764
Validation loss decreased (-0.694431 --> -0.763878).  Saving model ...
Epoch: 5 cost time: 2.678379535675049
Epoch: 5, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.949 Vali Acc: 0.708 Test Loss: 0.949 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.424025058746338
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.911 Vali Acc: 0.764 Test Loss: 0.911 Test Acc: 0.764
Validation loss decreased (-0.763878 --> -0.763880).  Saving model ...
Epoch: 7 cost time: 2.4058706760406494
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.908 Vali Acc: 0.792 Test Loss: 0.908 Test Acc: 0.792
Validation loss decreased (-0.763880 --> -0.791658).  Saving model ...
Epoch: 8 cost time: 2.2703654766082764
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.088 Vali Acc: 0.708 Test Loss: 1.088 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3729586601257324
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.111 Vali Acc: 0.694 Test Loss: 1.111 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.59736967086792
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.981 Vali Acc: 0.708 Test Loss: 0.981 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.597285032272339
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.349881649017334
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.432777166366577
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.778 Test Loss: 0.876 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3768765926361084
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.778 Test Loss: 0.882 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.300715684890747
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.764 Test Loss: 0.888 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2468888759613037
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.764 Test Loss: 0.896 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4992568492889404
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.764 Test Loss: 0.899 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7916666666666666
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9152700901031494
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.476 Vali Acc: 0.181 Test Loss: 2.476 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.4385769367218018
Epoch: 2, Steps: 7 | Train Loss: 2.142 Vali Loss: 2.040 Vali Acc: 0.500 Test Loss: 2.040 Test Acc: 0.500
Validation loss decreased (-0.180531 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 2.717580795288086
Epoch: 3, Steps: 7 | Train Loss: 1.366 Vali Loss: 1.624 Vali Acc: 0.597 Test Loss: 1.624 Test Acc: 0.597
Validation loss decreased (-0.499980 --> -0.597206).  Saving model ...
Epoch: 4 cost time: 2.9147229194641113
Epoch: 4, Steps: 7 | Train Loss: 0.669 Vali Loss: 1.343 Vali Acc: 0.694 Test Loss: 1.343 Test Acc: 0.694
Validation loss decreased (-0.597206 --> -0.694431).  Saving model ...
Epoch: 5 cost time: 2.529569149017334
Epoch: 5, Steps: 7 | Train Loss: 0.320 Vali Loss: 1.232 Vali Acc: 0.667 Test Loss: 1.232 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4863052368164062
Epoch: 6, Steps: 7 | Train Loss: 0.120 Vali Loss: 1.075 Vali Acc: 0.708 Test Loss: 1.075 Test Acc: 0.708
Validation loss decreased (-0.694431 --> -0.708323).  Saving model ...
Epoch: 7 cost time: 2.272630453109741
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 1.035 Vali Acc: 0.722 Test Loss: 1.035 Test Acc: 0.722
Validation loss decreased (-0.708323 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 2.2828152179718018
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.211 Vali Acc: 0.694 Test Loss: 1.211 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2660582065582275
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4680585861206055
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.026 Vali Acc: 0.681 Test Loss: 1.026 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6357381343841553
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.997 Vali Acc: 0.694 Test Loss: 0.997 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3151519298553467
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.694 Test Loss: 0.999 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4125866889953613
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.708 Test Loss: 1.006 Test Acc: 0.708
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.422555685043335
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.708 Test Loss: 1.010 Test Acc: 0.708
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.536957025527954
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 16 cost time: 2.231618881225586
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 2.4826245307922363
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 18 cost time: 2.4999611377716064
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.722 Test Loss: 1.001 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 19 cost time: 2.545518636703491
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.722 Test Loss: 0.997 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 20 cost time: 2.341278553009033
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 2.5787012577056885
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.722 Test Loss: 0.997 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4599432945251465
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.722 Test Loss: 0.994 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 2.6770431995391846
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.722 Test Loss: 1.002 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7219414710998535
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.722 Test Loss: 1.004 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5496695041656494
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.558453321456909
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.722 Test Loss: 1.006 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.265660047531128
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.442826986312866
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.382740020751953
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.576417922973633
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.50006365776062
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.8049323558807373
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.722 Test Loss: 1.013 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7222222222222222
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4754908084869385
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.482 Vali Acc: 0.097 Test Loss: 2.482 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.4198718070983887
Epoch: 2, Steps: 7 | Train Loss: 2.192 Vali Loss: 2.180 Vali Acc: 0.347 Test Loss: 2.180 Test Acc: 0.347
Validation loss decreased (-0.097197 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 2.4527440071105957
Epoch: 3, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.886 Vali Acc: 0.431 Test Loss: 1.886 Test Acc: 0.431
Validation loss decreased (-0.347200 --> -0.430537).  Saving model ...
Epoch: 4 cost time: 2.5476808547973633
Epoch: 4, Steps: 7 | Train Loss: 0.856 Vali Loss: 1.659 Vali Acc: 0.528 Test Loss: 1.659 Test Acc: 0.528
Validation loss decreased (-0.430537 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 2.5894203186035156
Epoch: 5, Steps: 7 | Train Loss: 0.436 Vali Loss: 1.575 Vali Acc: 0.528 Test Loss: 1.575 Test Acc: 0.528
Validation loss decreased (-0.527761 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 2.655442714691162
Epoch: 6, Steps: 7 | Train Loss: 0.169 Vali Loss: 1.415 Vali Acc: 0.583 Test Loss: 1.415 Test Acc: 0.583
Validation loss decreased (-0.527762 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 2.802410125732422
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 1.400 Vali Acc: 0.611 Test Loss: 1.400 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 2.5002336502075195
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.361 Vali Acc: 0.597 Test Loss: 1.361 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.513092279434204
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.364 Vali Acc: 0.611 Test Loss: 1.364 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611097).  Saving model ...
Epoch: 10 cost time: 2.5728759765625
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.379 Vali Acc: 0.611 Test Loss: 1.379 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.447726249694824
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.403 Vali Acc: 0.625 Test Loss: 1.403 Test Acc: 0.625
Validation loss decreased (-0.611097 --> -0.624986).  Saving model ...
Epoch: 12 cost time: 2.5762131214141846
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.611 Test Loss: 1.424 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.484853744506836
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.437 Vali Acc: 0.611 Test Loss: 1.437 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4787662029266357
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.625 Test Loss: 1.436 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4612386226654053
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.625 Test Loss: 1.435 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4254863262176514
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.625 Test Loss: 1.441 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4147136211395264
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.625 Test Loss: 1.454 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.610002279281616
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.625 Test Loss: 1.459 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.464083433151245
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.465 Vali Acc: 0.625 Test Loss: 1.465 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4030275344848633
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.473 Vali Acc: 0.611 Test Loss: 1.473 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4306747913360596
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.611 Test Loss: 1.481 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.625
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6568264961242676
Epoch: 1, Steps: 7 | Train Loss: 2.549 Vali Loss: 2.565 Vali Acc: 0.097 Test Loss: 2.565 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.6014575958251953
Epoch: 2, Steps: 7 | Train Loss: 2.241 Vali Loss: 2.379 Vali Acc: 0.125 Test Loss: 2.379 Test Acc: 0.125
Validation loss decreased (-0.097197 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.562645196914673
Epoch: 3, Steps: 7 | Train Loss: 1.701 Vali Loss: 2.220 Vali Acc: 0.292 Test Loss: 2.220 Test Acc: 0.292
Validation loss decreased (-0.124976 --> -0.291644).  Saving model ...
Epoch: 4 cost time: 2.4407224655151367
Epoch: 4, Steps: 7 | Train Loss: 1.071 Vali Loss: 2.123 Vali Acc: 0.319 Test Loss: 2.123 Test Acc: 0.319
Validation loss decreased (-0.291644 --> -0.319423).  Saving model ...
Epoch: 5 cost time: 2.460839033126831
Epoch: 5, Steps: 7 | Train Loss: 0.600 Vali Loss: 2.123 Vali Acc: 0.319 Test Loss: 2.123 Test Acc: 0.319
Validation loss decreased (-0.319423 --> -0.319423).  Saving model ...
Epoch: 6 cost time: 2.587453842163086
Epoch: 6, Steps: 7 | Train Loss: 0.278 Vali Loss: 2.084 Vali Acc: 0.361 Test Loss: 2.084 Test Acc: 0.361
Validation loss decreased (-0.319423 --> -0.361090).  Saving model ...
Epoch: 7 cost time: 2.554455041885376
Epoch: 7, Steps: 7 | Train Loss: 0.126 Vali Loss: 2.221 Vali Acc: 0.306 Test Loss: 2.221 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4129700660705566
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 2.266 Vali Acc: 0.333 Test Loss: 2.266 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3851158618927
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.285 Vali Acc: 0.347 Test Loss: 2.285 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5003836154937744
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.400 Vali Acc: 0.375 Test Loss: 2.400 Test Acc: 0.375
Validation loss decreased (-0.361090 --> -0.374976).  Saving model ...
Epoch: 11 cost time: 2.5873777866363525
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.487 Vali Acc: 0.361 Test Loss: 2.487 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5309693813323975
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.479 Vali Acc: 0.347 Test Loss: 2.479 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.417527675628662
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.450 Vali Acc: 0.375 Test Loss: 2.450 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.515226125717163
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.417 Vali Acc: 0.375 Test Loss: 2.417 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4032623767852783
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.448 Vali Acc: 0.375 Test Loss: 2.448 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.405332326889038
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.493 Vali Acc: 0.375 Test Loss: 2.493 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.463441848754883
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.514 Vali Acc: 0.375 Test Loss: 2.514 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.471947431564331
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.501 Vali Acc: 0.361 Test Loss: 2.501 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.439652681350708
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.518 Vali Acc: 0.361 Test Loss: 2.518 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.426435947418213
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.528 Vali Acc: 0.361 Test Loss: 2.528 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.375
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6838014125823975
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.499 Vali Acc: 0.069 Test Loss: 2.499 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.6640782356262207
Epoch: 2, Steps: 7 | Train Loss: 2.302 Vali Loss: 2.281 Vali Acc: 0.167 Test Loss: 2.281 Test Acc: 0.167
Validation loss decreased (-0.069419 --> -0.166644).  Saving model ...
Epoch: 3 cost time: 2.7477128505706787
Epoch: 3, Steps: 7 | Train Loss: 1.856 Vali Loss: 2.114 Vali Acc: 0.375 Test Loss: 2.114 Test Acc: 0.375
Validation loss decreased (-0.166644 --> -0.374979).  Saving model ...
Epoch: 4 cost time: 2.41787052154541
Epoch: 4, Steps: 7 | Train Loss: 1.285 Vali Loss: 1.934 Vali Acc: 0.347 Test Loss: 1.934 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.30773663520813
Epoch: 5, Steps: 7 | Train Loss: 0.800 Vali Loss: 1.908 Vali Acc: 0.389 Test Loss: 1.908 Test Acc: 0.389
Validation loss decreased (-0.374979 --> -0.388870).  Saving model ...
Epoch: 6 cost time: 2.2925162315368652
Epoch: 6, Steps: 7 | Train Loss: 0.457 Vali Loss: 1.738 Vali Acc: 0.500 Test Loss: 1.738 Test Acc: 0.500
Validation loss decreased (-0.388870 --> -0.499983).  Saving model ...
Epoch: 7 cost time: 2.4339096546173096
Epoch: 7, Steps: 7 | Train Loss: 0.229 Vali Loss: 1.862 Vali Acc: 0.431 Test Loss: 1.862 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4379873275756836
Epoch: 8, Steps: 7 | Train Loss: 0.106 Vali Loss: 1.770 Vali Acc: 0.431 Test Loss: 1.770 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3807740211486816
Epoch: 9, Steps: 7 | Train Loss: 0.044 Vali Loss: 2.216 Vali Acc: 0.417 Test Loss: 2.216 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2869110107421875
Epoch: 10, Steps: 7 | Train Loss: 0.021 Vali Loss: 2.080 Vali Acc: 0.431 Test Loss: 2.080 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.521137237548828
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.017 Vali Acc: 0.417 Test Loss: 2.017 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5311403274536133
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.046 Vali Acc: 0.417 Test Loss: 2.046 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4984378814697266
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.099 Vali Acc: 0.444 Test Loss: 2.099 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.500410795211792
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.161 Vali Acc: 0.458 Test Loss: 2.161 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.312908411026001
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.210 Vali Acc: 0.458 Test Loss: 2.210 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3586983680725098
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.218 Vali Acc: 0.458 Test Loss: 2.218 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.844827651977539
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.470 Vali Acc: 0.097 Test Loss: 2.470 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.5848569869995117
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.278 Vali Acc: 0.139 Test Loss: 2.278 Test Acc: 0.139
Validation loss decreased (-0.097198 --> -0.138866).  Saving model ...
Epoch: 3 cost time: 2.466378688812256
Epoch: 3, Steps: 7 | Train Loss: 1.937 Vali Loss: 2.099 Vali Acc: 0.222 Test Loss: 2.099 Test Acc: 0.222
Validation loss decreased (-0.138866 --> -0.222201).  Saving model ...
Epoch: 4 cost time: 2.3204240798950195
Epoch: 4, Steps: 7 | Train Loss: 1.409 Vali Loss: 1.888 Vali Acc: 0.333 Test Loss: 1.888 Test Acc: 0.333
Validation loss decreased (-0.222201 --> -0.333314).  Saving model ...
Epoch: 5 cost time: 2.5558717250823975
Epoch: 5, Steps: 7 | Train Loss: 0.915 Vali Loss: 1.814 Vali Acc: 0.361 Test Loss: 1.814 Test Acc: 0.361
Validation loss decreased (-0.333314 --> -0.361093).  Saving model ...
Epoch: 6 cost time: 2.5228989124298096
Epoch: 6, Steps: 7 | Train Loss: 0.558 Vali Loss: 1.588 Vali Acc: 0.458 Test Loss: 1.588 Test Acc: 0.458
Validation loss decreased (-0.361093 --> -0.458317).  Saving model ...
Epoch: 7 cost time: 2.52132248878479
Epoch: 7, Steps: 7 | Train Loss: 0.325 Vali Loss: 1.636 Vali Acc: 0.375 Test Loss: 1.636 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5902652740478516
Epoch: 8, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
Validation loss decreased (-0.458317 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 2.3669190406799316
Epoch: 9, Steps: 7 | Train Loss: 0.076 Vali Loss: 1.849 Vali Acc: 0.389 Test Loss: 1.849 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.323068618774414
Epoch: 10, Steps: 7 | Train Loss: 0.037 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2650904655456543
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.819 Vali Acc: 0.444 Test Loss: 1.819 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.386223077774048
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.821 Vali Acc: 0.417 Test Loss: 1.821 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.265101671218872
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.711 Vali Acc: 0.444 Test Loss: 1.711 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2471375465393066
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.730 Vali Acc: 0.458 Test Loss: 1.730 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.26023268699646
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.911 Vali Acc: 0.444 Test Loss: 1.911 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2444472312927246
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.980 Vali Acc: 0.458 Test Loss: 1.980 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1025454998016357
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.933 Vali Acc: 0.444 Test Loss: 1.933 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1767611503601074
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.848 Vali Acc: 0.444 Test Loss: 1.848 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5781989097595215
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.506 Vali Acc: 0.083 Test Loss: 2.506 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.5328516960144043
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.369 Vali Acc: 0.125 Test Loss: 2.369 Test Acc: 0.125
Validation loss decreased (-0.083308 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.7083747386932373
Epoch: 3, Steps: 7 | Train Loss: 1.977 Vali Loss: 2.227 Vali Acc: 0.153 Test Loss: 2.227 Test Acc: 0.153
Validation loss decreased (-0.124976 --> -0.152756).  Saving model ...
Epoch: 4 cost time: 2.422696590423584
Epoch: 4, Steps: 7 | Train Loss: 1.497 Vali Loss: 2.053 Vali Acc: 0.264 Test Loss: 2.053 Test Acc: 0.264
Validation loss decreased (-0.152756 --> -0.263868).  Saving model ...
Epoch: 5 cost time: 2.72558856010437
Epoch: 5, Steps: 7 | Train Loss: 1.010 Vali Loss: 1.992 Vali Acc: 0.319 Test Loss: 1.992 Test Acc: 0.319
Validation loss decreased (-0.263868 --> -0.319425).  Saving model ...
Epoch: 6 cost time: 2.372504711151123
Epoch: 6, Steps: 7 | Train Loss: 0.606 Vali Loss: 1.782 Vali Acc: 0.389 Test Loss: 1.782 Test Acc: 0.389
Validation loss decreased (-0.319425 --> -0.388871).  Saving model ...
Epoch: 7 cost time: 2.1909241676330566
Epoch: 7, Steps: 7 | Train Loss: 0.337 Vali Loss: 1.859 Vali Acc: 0.306 Test Loss: 1.859 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.344111680984497
Epoch: 8, Steps: 7 | Train Loss: 0.162 Vali Loss: 1.719 Vali Acc: 0.389 Test Loss: 1.719 Test Acc: 0.389
Validation loss decreased (-0.388871 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 2.69014835357666
Epoch: 9, Steps: 7 | Train Loss: 0.086 Vali Loss: 2.055 Vali Acc: 0.292 Test Loss: 2.055 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3745901584625244
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.782 Vali Acc: 0.417 Test Loss: 1.782 Test Acc: 0.417
Validation loss decreased (-0.388872 --> -0.416649).  Saving model ...
Epoch: 11 cost time: 2.430959463119507
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.036 Vali Acc: 0.431 Test Loss: 2.036 Test Acc: 0.431
Validation loss decreased (-0.416649 --> -0.430535).  Saving model ...
Epoch: 12 cost time: 2.3870089054107666
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.097 Vali Acc: 0.417 Test Loss: 2.097 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.323317050933838
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.066 Vali Acc: 0.375 Test Loss: 2.066 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.396758556365967
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.025 Vali Acc: 0.389 Test Loss: 2.025 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4881818294525146
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.102 Vali Acc: 0.389 Test Loss: 2.102 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3779637813568115
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.197 Vali Acc: 0.389 Test Loss: 2.197 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3971376419067383
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.180 Vali Acc: 0.417 Test Loss: 2.180 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3005919456481934
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.154 Vali Acc: 0.417 Test Loss: 2.154 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.479659080505371
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.165 Vali Acc: 0.403 Test Loss: 2.165 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3064124584198
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.193 Vali Acc: 0.375 Test Loss: 2.193 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.378126859664917
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.226 Vali Acc: 0.389 Test Loss: 2.226 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5493922233581543
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.457 Vali Acc: 0.125 Test Loss: 2.457 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.563441753387451
Epoch: 2, Steps: 7 | Train Loss: 2.395 Vali Loss: 2.342 Vali Acc: 0.083 Test Loss: 2.342 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5714261531829834
Epoch: 3, Steps: 7 | Train Loss: 2.115 Vali Loss: 2.275 Vali Acc: 0.208 Test Loss: 2.275 Test Acc: 0.208
Validation loss decreased (-0.124975 --> -0.208311).  Saving model ...
Epoch: 4 cost time: 2.6473007202148438
Epoch: 4, Steps: 7 | Train Loss: 1.768 Vali Loss: 2.180 Vali Acc: 0.194 Test Loss: 2.180 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.503690719604492
Epoch: 5, Steps: 7 | Train Loss: 1.394 Vali Loss: 2.166 Vali Acc: 0.319 Test Loss: 2.166 Test Acc: 0.319
Validation loss decreased (-0.208311 --> -0.319423).  Saving model ...
Epoch: 6 cost time: 2.3644542694091797
Epoch: 6, Steps: 7 | Train Loss: 1.022 Vali Loss: 2.020 Vali Acc: 0.264 Test Loss: 2.020 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4250316619873047
Epoch: 7, Steps: 7 | Train Loss: 0.707 Vali Loss: 2.017 Vali Acc: 0.292 Test Loss: 2.017 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.280587673187256
Epoch: 8, Steps: 7 | Train Loss: 0.423 Vali Loss: 1.875 Vali Acc: 0.292 Test Loss: 1.875 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.356430768966675
Epoch: 9, Steps: 7 | Train Loss: 0.260 Vali Loss: 1.884 Vali Acc: 0.250 Test Loss: 1.884 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.312800645828247
Epoch: 10, Steps: 7 | Train Loss: 0.145 Vali Loss: 1.986 Vali Acc: 0.264 Test Loss: 1.986 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.172192096710205
Epoch: 11, Steps: 7 | Train Loss: 0.086 Vali Loss: 1.920 Vali Acc: 0.292 Test Loss: 1.920 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3069417476654053
Epoch: 12, Steps: 7 | Train Loss: 0.053 Vali Loss: 1.985 Vali Acc: 0.361 Test Loss: 1.985 Test Acc: 0.361
Validation loss decreased (-0.319423 --> -0.361091).  Saving model ...
Epoch: 13 cost time: 2.3588948249816895
Epoch: 13, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.079 Vali Acc: 0.361 Test Loss: 2.079 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.296552896499634
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.136 Vali Acc: 0.236 Test Loss: 2.136 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3119943141937256
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.377 Vali Acc: 0.278 Test Loss: 2.377 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3267693519592285
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.240 Vali Acc: 0.319 Test Loss: 2.240 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.211869716644287
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.162 Vali Acc: 0.319 Test Loss: 2.162 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3506786823272705
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.227 Vali Acc: 0.306 Test Loss: 2.227 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.541130781173706
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.289 Vali Acc: 0.306 Test Loss: 2.289 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4095146656036377
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.313 Vali Acc: 0.278 Test Loss: 2.313 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4431495666503906
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.332 Vali Acc: 0.292 Test Loss: 2.332 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.398301362991333
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.272 Vali Acc: 0.319 Test Loss: 2.272 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3611111111111111
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7468554973602295
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.445 Vali Acc: 0.167 Test Loss: 2.445 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.232595682144165
Epoch: 2, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.340 Vali Acc: 0.222 Test Loss: 2.340 Test Acc: 0.222
Validation loss decreased (-0.166642 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 2.5043060779571533
Epoch: 3, Steps: 7 | Train Loss: 2.149 Vali Loss: 2.338 Vali Acc: 0.236 Test Loss: 2.338 Test Acc: 0.236
Validation loss decreased (-0.222199 --> -0.236088).  Saving model ...
Epoch: 4 cost time: 2.4604082107543945
Epoch: 4, Steps: 7 | Train Loss: 1.881 Vali Loss: 2.362 Vali Acc: 0.292 Test Loss: 2.362 Test Acc: 0.292
Validation loss decreased (-0.236088 --> -0.291643).  Saving model ...
Epoch: 5 cost time: 2.33549427986145
Epoch: 5, Steps: 7 | Train Loss: 1.578 Vali Loss: 2.384 Vali Acc: 0.250 Test Loss: 2.384 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.383876323699951
Epoch: 6, Steps: 7 | Train Loss: 1.271 Vali Loss: 2.206 Vali Acc: 0.222 Test Loss: 2.206 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.307039499282837
Epoch: 7, Steps: 7 | Train Loss: 0.944 Vali Loss: 2.234 Vali Acc: 0.250 Test Loss: 2.234 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5049328804016113
Epoch: 8, Steps: 7 | Train Loss: 0.713 Vali Loss: 2.069 Vali Acc: 0.292 Test Loss: 2.069 Test Acc: 0.292
Validation loss decreased (-0.291643 --> -0.291646).  Saving model ...
Epoch: 9 cost time: 2.555739164352417
Epoch: 9, Steps: 7 | Train Loss: 0.517 Vali Loss: 2.010 Vali Acc: 0.278 Test Loss: 2.010 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.601492166519165
Epoch: 10, Steps: 7 | Train Loss: 0.346 Vali Loss: 2.262 Vali Acc: 0.278 Test Loss: 2.262 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.445622205734253
Epoch: 11, Steps: 7 | Train Loss: 0.240 Vali Loss: 2.282 Vali Acc: 0.333 Test Loss: 2.282 Test Acc: 0.333
Validation loss decreased (-0.291646 --> -0.333311).  Saving model ...
Epoch: 12 cost time: 2.487403154373169
Epoch: 12, Steps: 7 | Train Loss: 0.181 Vali Loss: 2.330 Vali Acc: 0.278 Test Loss: 2.330 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3550922870635986
Epoch: 13, Steps: 7 | Train Loss: 0.098 Vali Loss: 2.539 Vali Acc: 0.264 Test Loss: 2.539 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4478163719177246
Epoch: 14, Steps: 7 | Train Loss: 0.076 Vali Loss: 2.629 Vali Acc: 0.208 Test Loss: 2.629 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.54201340675354
Epoch: 15, Steps: 7 | Train Loss: 0.056 Vali Loss: 2.788 Vali Acc: 0.292 Test Loss: 2.788 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5573654174804688
Epoch: 16, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.550 Vali Acc: 0.306 Test Loss: 2.550 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4413347244262695
Epoch: 17, Steps: 7 | Train Loss: 0.034 Vali Loss: 2.744 Vali Acc: 0.306 Test Loss: 2.744 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5107197761535645
Epoch: 18, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.999 Vali Acc: 0.208 Test Loss: 2.999 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5053656101226807
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.708 Vali Acc: 0.250 Test Loss: 2.708 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.660817861557007
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.794 Vali Acc: 0.264 Test Loss: 2.794 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.47518253326416
Epoch: 21, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.885 Vali Acc: 0.319 Test Loss: 2.885 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3333333333333333
model parameter : 895980
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6744511127471924
Epoch: 1, Steps: 7 | Train Loss: 2.512 Vali Loss: 2.245 Vali Acc: 0.347 Test Loss: 2.245 Test Acc: 0.347
Validation loss decreased (inf --> -0.347200).  Saving model ...
Epoch: 2 cost time: 2.144733190536499
Epoch: 2, Steps: 7 | Train Loss: 1.919 Vali Loss: 1.571 Vali Acc: 0.653 Test Loss: 1.571 Test Acc: 0.653
Validation loss decreased (-0.347200 --> -0.652762).  Saving model ...
Epoch: 3 cost time: 2.3978426456451416
Epoch: 3, Steps: 7 | Train Loss: 0.963 Vali Loss: 1.110 Vali Acc: 0.681 Test Loss: 1.110 Test Acc: 0.681
Validation loss decreased (-0.652762 --> -0.680544).  Saving model ...
Epoch: 4 cost time: 2.4097940921783447
Epoch: 4, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
Validation loss decreased (-0.680544 --> -0.722213).  Saving model ...
Epoch: 5 cost time: 2.4144434928894043
Epoch: 5, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.887 Vali Acc: 0.778 Test Loss: 0.887 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 2.530672550201416
Epoch: 6, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.943 Vali Acc: 0.819 Test Loss: 0.943 Test Acc: 0.819
Validation loss decreased (-0.777769 --> -0.819435).  Saving model ...
Epoch: 7 cost time: 2.282841205596924
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.902 Vali Acc: 0.792 Test Loss: 0.902 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2721831798553467
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.847 Test Loss: 0.851 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847214).  Saving model ...
Epoch: 9 cost time: 2.454177141189575
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.889 Test Loss: 0.812 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888881).  Saving model ...
Epoch: 10 cost time: 2.5311594009399414
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.889 Test Loss: 0.813 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4755916595458984
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.861 Test Loss: 0.822 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6839404106140137
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.861 Test Loss: 0.830 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4656822681427
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.847 Test Loss: 0.835 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6328680515289307
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.847 Test Loss: 0.835 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.635185956954956
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.847 Test Loss: 0.832 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6475136280059814
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.847 Test Loss: 0.836 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.563382148742676
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.847 Test Loss: 0.839 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.589171886444092
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.847 Test Loss: 0.842 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4785115718841553
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.847 Test Loss: 0.843 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4245448112487793
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.308 Vali Acc: 0.292 Test Loss: 2.308 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 2.335273265838623
Epoch: 2, Steps: 7 | Train Loss: 2.016 Vali Loss: 1.750 Vali Acc: 0.597 Test Loss: 1.750 Test Acc: 0.597
Validation loss decreased (-0.291644 --> -0.597205).  Saving model ...
Epoch: 3 cost time: 2.3935742378234863
Epoch: 3, Steps: 7 | Train Loss: 1.128 Vali Loss: 1.300 Vali Acc: 0.625 Test Loss: 1.300 Test Acc: 0.625
Validation loss decreased (-0.597205 --> -0.624987).  Saving model ...
Epoch: 4 cost time: 2.4736499786376953
Epoch: 4, Steps: 7 | Train Loss: 0.528 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
Validation loss decreased (-0.624987 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 2.288858413696289
Epoch: 5, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.933 Vali Acc: 0.778 Test Loss: 0.933 Test Acc: 0.778
Validation loss decreased (-0.722211 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 2.2490317821502686
Epoch: 6, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.379380941390991
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.968 Vali Acc: 0.764 Test Loss: 0.968 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3608620166778564
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.869 Vali Acc: 0.806 Test Loss: 0.869 Test Acc: 0.806
Validation loss decreased (-0.777768 --> -0.805547).  Saving model ...
Epoch: 9 cost time: 2.4745659828186035
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.835 Vali Acc: 0.806 Test Loss: 0.835 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805547).  Saving model ...
Epoch: 10 cost time: 2.2794620990753174
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.806 Test Loss: 0.843 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.349257469177246
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.806 Test Loss: 0.861 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.261535406112671
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.806 Test Loss: 0.876 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.373948812484741
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.792 Test Loss: 0.889 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3808536529541016
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.792 Test Loss: 0.892 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4778621196746826
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.806 Test Loss: 0.892 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3541007041931152
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.806 Test Loss: 0.894 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.390692949295044
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.806 Test Loss: 0.896 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.172696590423584
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.806 Test Loss: 0.897 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2712345123291016
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.806 Test Loss: 0.894 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8055555555555556
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4638853073120117
Epoch: 1, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.382 Vali Acc: 0.250 Test Loss: 2.382 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 2.480933904647827
Epoch: 2, Steps: 7 | Train Loss: 2.125 Vali Loss: 1.974 Vali Acc: 0.500 Test Loss: 1.974 Test Acc: 0.500
Validation loss decreased (-0.249976 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 2.324934720993042
Epoch: 3, Steps: 7 | Train Loss: 1.349 Vali Loss: 1.585 Vali Acc: 0.583 Test Loss: 1.585 Test Acc: 0.583
Validation loss decreased (-0.499980 --> -0.583317).  Saving model ...
Epoch: 4 cost time: 2.3640360832214355
Epoch: 4, Steps: 7 | Train Loss: 0.729 Vali Loss: 1.369 Vali Acc: 0.667 Test Loss: 1.369 Test Acc: 0.667
Validation loss decreased (-0.583317 --> -0.666653).  Saving model ...
Epoch: 5 cost time: 2.5523173809051514
Epoch: 5, Steps: 7 | Train Loss: 0.320 Vali Loss: 1.252 Vali Acc: 0.667 Test Loss: 1.252 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666654).  Saving model ...
Epoch: 6 cost time: 2.7431187629699707
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 1.126 Vali Acc: 0.681 Test Loss: 1.126 Test Acc: 0.681
Validation loss decreased (-0.666654 --> -0.680544).  Saving model ...
Epoch: 7 cost time: 2.44592547416687
Epoch: 7, Steps: 7 | Train Loss: 0.045 Vali Loss: 1.022 Vali Acc: 0.722 Test Loss: 1.022 Test Acc: 0.722
Validation loss decreased (-0.680544 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 2.4993844032287598
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.983 Vali Acc: 0.736 Test Loss: 0.983 Test Acc: 0.736
Validation loss decreased (-0.722212 --> -0.736101).  Saving model ...
Epoch: 9 cost time: 2.529203176498413
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.47422194480896
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.044 Vali Acc: 0.694 Test Loss: 1.044 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5057976245880127
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.088 Vali Acc: 0.708 Test Loss: 1.088 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4572157859802246
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.708 Test Loss: 1.063 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5273101329803467
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.708 Test Loss: 1.022 Test Acc: 0.708
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5876049995422363
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4866127967834473
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4755923748016357
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.46583890914917
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.722 Test Loss: 0.991 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3817925453186035
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.708 Test Loss: 0.996 Test Acc: 0.708
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7361111111111112
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.41278076171875
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.435 Vali Acc: 0.139 Test Loss: 2.435 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.498326539993286
Epoch: 2, Steps: 7 | Train Loss: 2.249 Vali Loss: 2.152 Vali Acc: 0.333 Test Loss: 2.152 Test Acc: 0.333
Validation loss decreased (-0.138865 --> -0.333312).  Saving model ...
Epoch: 3 cost time: 2.296025037765503
Epoch: 3, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.852 Vali Acc: 0.472 Test Loss: 1.852 Test Acc: 0.472
Validation loss decreased (-0.333312 --> -0.472204).  Saving model ...
Epoch: 4 cost time: 2.2802348136901855
Epoch: 4, Steps: 7 | Train Loss: 0.943 Vali Loss: 1.690 Vali Acc: 0.458 Test Loss: 1.690 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2926647663116455
Epoch: 5, Steps: 7 | Train Loss: 0.437 Vali Loss: 1.562 Vali Acc: 0.528 Test Loss: 1.562 Test Acc: 0.528
Validation loss decreased (-0.472204 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 2.426884651184082
Epoch: 6, Steps: 7 | Train Loss: 0.195 Vali Loss: 1.427 Vali Acc: 0.569 Test Loss: 1.427 Test Acc: 0.569
Validation loss decreased (-0.527762 --> -0.569430).  Saving model ...
Epoch: 7 cost time: 2.395056962966919
Epoch: 7, Steps: 7 | Train Loss: 0.069 Vali Loss: 1.363 Vali Acc: 0.611 Test Loss: 1.363 Test Acc: 0.611
Validation loss decreased (-0.569430 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 2.3398799896240234
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 1.298 Vali Acc: 0.569 Test Loss: 1.298 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.430755376815796
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.265 Vali Acc: 0.583 Test Loss: 1.265 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3670718669891357
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.370 Vali Acc: 0.583 Test Loss: 1.370 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3757078647613525
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.389 Vali Acc: 0.597 Test Loss: 1.389 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4732778072357178
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.353 Vali Acc: 0.611 Test Loss: 1.353 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611098).  Saving model ...
Epoch: 13 cost time: 2.434966802597046
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.337 Vali Acc: 0.625 Test Loss: 1.337 Test Acc: 0.625
Validation loss decreased (-0.611098 --> -0.624987).  Saving model ...
Epoch: 14 cost time: 2.4479315280914307
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.611 Test Loss: 1.337 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6059811115264893
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.611 Test Loss: 1.352 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.492785930633545
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.369 Vali Acc: 0.597 Test Loss: 1.369 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.339712619781494
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.597 Test Loss: 1.388 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3928942680358887
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.611 Test Loss: 1.395 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.41288423538208
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.611 Test Loss: 1.398 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3068761825561523
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.611 Test Loss: 1.401 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.464151382446289
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.611 Test Loss: 1.408 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.508070468902588
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.597 Test Loss: 1.410 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8022263050079346
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.597 Test Loss: 1.415 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.625
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.538881778717041
Epoch: 1, Steps: 7 | Train Loss: 2.611 Vali Loss: 2.490 Vali Acc: 0.139 Test Loss: 2.490 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 2.5247082710266113
Epoch: 2, Steps: 7 | Train Loss: 2.332 Vali Loss: 2.350 Vali Acc: 0.167 Test Loss: 2.350 Test Acc: 0.167
Validation loss decreased (-0.138864 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 2.587146282196045
Epoch: 3, Steps: 7 | Train Loss: 1.736 Vali Loss: 2.186 Vali Acc: 0.222 Test Loss: 2.186 Test Acc: 0.222
Validation loss decreased (-0.166643 --> -0.222200).  Saving model ...
Epoch: 4 cost time: 2.6509954929351807
Epoch: 4, Steps: 7 | Train Loss: 1.166 Vali Loss: 2.151 Vali Acc: 0.361 Test Loss: 2.151 Test Acc: 0.361
Validation loss decreased (-0.222200 --> -0.361090).  Saving model ...
Epoch: 5 cost time: 2.521634340286255
Epoch: 5, Steps: 7 | Train Loss: 0.632 Vali Loss: 2.090 Vali Acc: 0.292 Test Loss: 2.090 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.23001766204834
Epoch: 6, Steps: 7 | Train Loss: 0.346 Vali Loss: 2.097 Vali Acc: 0.389 Test Loss: 2.097 Test Acc: 0.389
Validation loss decreased (-0.361090 --> -0.388868).  Saving model ...
Epoch: 7 cost time: 2.426793336868286
Epoch: 7, Steps: 7 | Train Loss: 0.162 Vali Loss: 2.156 Vali Acc: 0.403 Test Loss: 2.156 Test Acc: 0.403
Validation loss decreased (-0.388868 --> -0.402756).  Saving model ...
Epoch: 8 cost time: 2.3163366317749023
Epoch: 8, Steps: 7 | Train Loss: 0.078 Vali Loss: 2.239 Vali Acc: 0.333 Test Loss: 2.239 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4550588130950928
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 2.373 Vali Acc: 0.361 Test Loss: 2.373 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4037320613861084
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.309 Vali Acc: 0.389 Test Loss: 2.309 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3335394859313965
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.448 Vali Acc: 0.361 Test Loss: 2.448 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.538445472717285
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.526 Vali Acc: 0.375 Test Loss: 2.526 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2713534832000732
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.506 Vali Acc: 0.417 Test Loss: 2.506 Test Acc: 0.417
Validation loss decreased (-0.402756 --> -0.416642).  Saving model ...
Epoch: 14 cost time: 2.2765557765960693
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.509 Vali Acc: 0.403 Test Loss: 2.509 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3446474075317383
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.503 Vali Acc: 0.375 Test Loss: 2.503 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1989104747772217
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.519 Vali Acc: 0.375 Test Loss: 2.519 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5231943130493164
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.540 Vali Acc: 0.375 Test Loss: 2.540 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5330307483673096
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.548 Vali Acc: 0.375 Test Loss: 2.548 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.504460573196411
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.536 Vali Acc: 0.375 Test Loss: 2.536 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.408156156539917
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.540 Vali Acc: 0.375 Test Loss: 2.540 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4586398601531982
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.551 Vali Acc: 0.375 Test Loss: 2.551 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3643293380737305
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.546 Vali Acc: 0.375 Test Loss: 2.546 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.470390796661377
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.550 Vali Acc: 0.389 Test Loss: 2.550 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6149325370788574
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.477 Vali Acc: 0.139 Test Loss: 2.477 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 2.4192700386047363
Epoch: 2, Steps: 7 | Train Loss: 2.392 Vali Loss: 2.302 Vali Acc: 0.153 Test Loss: 2.302 Test Acc: 0.153
Validation loss decreased (-0.138864 --> -0.152755).  Saving model ...
Epoch: 3 cost time: 2.30427885055542
Epoch: 3, Steps: 7 | Train Loss: 1.837 Vali Loss: 2.092 Vali Acc: 0.250 Test Loss: 2.092 Test Acc: 0.250
Validation loss decreased (-0.152755 --> -0.249979).  Saving model ...
Epoch: 4 cost time: 2.3500964641571045
Epoch: 4, Steps: 7 | Train Loss: 1.342 Vali Loss: 1.966 Vali Acc: 0.375 Test Loss: 1.966 Test Acc: 0.375
Validation loss decreased (-0.249979 --> -0.374980).  Saving model ...
Epoch: 5 cost time: 2.4459140300750732
Epoch: 5, Steps: 7 | Train Loss: 0.831 Vali Loss: 1.872 Vali Acc: 0.333 Test Loss: 1.872 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3930470943450928
Epoch: 6, Steps: 7 | Train Loss: 0.517 Vali Loss: 1.778 Vali Acc: 0.444 Test Loss: 1.778 Test Acc: 0.444
Validation loss decreased (-0.374980 --> -0.444427).  Saving model ...
Epoch: 7 cost time: 2.297860860824585
Epoch: 7, Steps: 7 | Train Loss: 0.276 Vali Loss: 1.875 Vali Acc: 0.417 Test Loss: 1.875 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3159263134002686
Epoch: 8, Steps: 7 | Train Loss: 0.146 Vali Loss: 1.775 Vali Acc: 0.389 Test Loss: 1.775 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.436020851135254
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 1.948 Vali Acc: 0.361 Test Loss: 1.948 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.433589458465576
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.985 Vali Acc: 0.403 Test Loss: 1.985 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.471766948699951
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.055 Vali Acc: 0.417 Test Loss: 2.055 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4773025512695312
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.015 Vali Acc: 0.389 Test Loss: 2.015 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3478338718414307
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.032 Vali Acc: 0.403 Test Loss: 2.032 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3585941791534424
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.125 Vali Acc: 0.389 Test Loss: 2.125 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2058775424957275
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.190 Vali Acc: 0.375 Test Loss: 2.190 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0665946006774902
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.197 Vali Acc: 0.389 Test Loss: 2.197 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.828561782836914
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.437 Vali Acc: 0.167 Test Loss: 2.437 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.4297714233398438
Epoch: 2, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.284 Vali Acc: 0.167 Test Loss: 2.284 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166644).  Saving model ...
Epoch: 3 cost time: 2.532917022705078
Epoch: 3, Steps: 7 | Train Loss: 1.930 Vali Loss: 2.067 Vali Acc: 0.292 Test Loss: 2.067 Test Acc: 0.292
Validation loss decreased (-0.166644 --> -0.291646).  Saving model ...
Epoch: 4 cost time: 2.3818845748901367
Epoch: 4, Steps: 7 | Train Loss: 1.502 Vali Loss: 1.956 Vali Acc: 0.306 Test Loss: 1.956 Test Acc: 0.306
Validation loss decreased (-0.291646 --> -0.305536).  Saving model ...
Epoch: 5 cost time: 2.381270408630371
Epoch: 5, Steps: 7 | Train Loss: 0.973 Vali Loss: 1.803 Vali Acc: 0.306 Test Loss: 1.803 Test Acc: 0.306
Validation loss decreased (-0.305536 --> -0.305538).  Saving model ...
Epoch: 6 cost time: 2.224698781967163
Epoch: 6, Steps: 7 | Train Loss: 0.630 Vali Loss: 1.679 Vali Acc: 0.417 Test Loss: 1.679 Test Acc: 0.417
Validation loss decreased (-0.305538 --> -0.416650).  Saving model ...
Epoch: 7 cost time: 2.411674737930298
Epoch: 7, Steps: 7 | Train Loss: 0.371 Vali Loss: 1.696 Vali Acc: 0.389 Test Loss: 1.696 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3321337699890137
Epoch: 8, Steps: 7 | Train Loss: 0.207 Vali Loss: 1.583 Vali Acc: 0.431 Test Loss: 1.583 Test Acc: 0.431
Validation loss decreased (-0.416650 --> -0.430540).  Saving model ...
Epoch: 9 cost time: 2.3802859783172607
Epoch: 9, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.564 Vali Acc: 0.458 Test Loss: 1.564 Test Acc: 0.458
Validation loss decreased (-0.430540 --> -0.458318).  Saving model ...
Epoch: 10 cost time: 2.258354902267456
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 1.680 Vali Acc: 0.431 Test Loss: 1.680 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5178287029266357
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 1.721 Vali Acc: 0.500 Test Loss: 1.721 Test Acc: 0.500
Validation loss decreased (-0.458318 --> -0.499983).  Saving model ...
Epoch: 12 cost time: 2.8633060455322266
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.612 Vali Acc: 0.472 Test Loss: 1.612 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5472326278686523
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.708 Vali Acc: 0.431 Test Loss: 1.708 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.469527006149292
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.822 Vali Acc: 0.458 Test Loss: 1.822 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.369628429412842
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.852 Vali Acc: 0.472 Test Loss: 1.852 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.333940267562866
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.825 Vali Acc: 0.458 Test Loss: 1.825 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.446753740310669
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.823 Vali Acc: 0.458 Test Loss: 1.823 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.467207908630371
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.832 Vali Acc: 0.458 Test Loss: 1.832 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.430121898651123
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.868 Vali Acc: 0.458 Test Loss: 1.868 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5929718017578125
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.886 Vali Acc: 0.458 Test Loss: 1.886 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.465059757232666
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.882 Vali Acc: 0.458 Test Loss: 1.882 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.626873731613159
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.473 Vali Acc: 0.125 Test Loss: 2.473 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.411695718765259
Epoch: 2, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.357 Vali Acc: 0.125 Test Loss: 2.357 Test Acc: 0.125
Validation loss decreased (-0.124975 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.2666547298431396
Epoch: 3, Steps: 7 | Train Loss: 2.002 Vali Loss: 2.181 Vali Acc: 0.250 Test Loss: 2.181 Test Acc: 0.250
Validation loss decreased (-0.124976 --> -0.249978).  Saving model ...
Epoch: 4 cost time: 2.361703395843506
Epoch: 4, Steps: 7 | Train Loss: 1.586 Vali Loss: 2.124 Vali Acc: 0.306 Test Loss: 2.124 Test Acc: 0.306
Validation loss decreased (-0.249978 --> -0.305534).  Saving model ...
Epoch: 5 cost time: 2.273707866668701
Epoch: 5, Steps: 7 | Train Loss: 1.072 Vali Loss: 1.969 Vali Acc: 0.361 Test Loss: 1.969 Test Acc: 0.361
Validation loss decreased (-0.305534 --> -0.361091).  Saving model ...
Epoch: 6 cost time: 2.436187744140625
Epoch: 6, Steps: 7 | Train Loss: 0.702 Vali Loss: 1.881 Vali Acc: 0.403 Test Loss: 1.881 Test Acc: 0.403
Validation loss decreased (-0.361091 --> -0.402759).  Saving model ...
Epoch: 7 cost time: 2.4833452701568604
Epoch: 7, Steps: 7 | Train Loss: 0.382 Vali Loss: 1.938 Vali Acc: 0.306 Test Loss: 1.938 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2579681873321533
Epoch: 8, Steps: 7 | Train Loss: 0.224 Vali Loss: 1.796 Vali Acc: 0.444 Test Loss: 1.796 Test Acc: 0.444
Validation loss decreased (-0.402759 --> -0.444426).  Saving model ...
Epoch: 9 cost time: 2.4176275730133057
Epoch: 9, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.847 Vali Acc: 0.417 Test Loss: 1.847 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.264508008956909
Epoch: 10, Steps: 7 | Train Loss: 0.049 Vali Loss: 1.866 Vali Acc: 0.403 Test Loss: 1.866 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.420314311981201
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.985 Vali Acc: 0.375 Test Loss: 1.985 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.306856632232666
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.913 Vali Acc: 0.431 Test Loss: 1.913 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.20235013961792
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.001 Vali Acc: 0.417 Test Loss: 2.001 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.247342348098755
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.139 Vali Acc: 0.431 Test Loss: 2.139 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.121093273162842
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.175 Vali Acc: 0.417 Test Loss: 2.175 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3114774227142334
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.163 Vali Acc: 0.403 Test Loss: 2.163 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5554940700531006
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.145 Vali Acc: 0.417 Test Loss: 2.145 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.353222131729126
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.148 Vali Acc: 0.403 Test Loss: 2.148 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.800593852996826
Epoch: 1, Steps: 7 | Train Loss: 2.575 Vali Loss: 2.467 Vali Acc: 0.181 Test Loss: 2.467 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.3705625534057617
Epoch: 2, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.373 Vali Acc: 0.181 Test Loss: 2.373 Test Acc: 0.181
Validation loss decreased (-0.180531 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 2.2722887992858887
Epoch: 3, Steps: 7 | Train Loss: 2.146 Vali Loss: 2.258 Vali Acc: 0.181 Test Loss: 2.258 Test Acc: 0.181
Validation loss decreased (-0.180532 --> -0.180533).  Saving model ...
Epoch: 4 cost time: 2.374593496322632
Epoch: 4, Steps: 7 | Train Loss: 1.838 Vali Loss: 2.278 Vali Acc: 0.194 Test Loss: 2.278 Test Acc: 0.194
Validation loss decreased (-0.180533 --> -0.194422).  Saving model ...
Epoch: 5 cost time: 2.38826322555542
Epoch: 5, Steps: 7 | Train Loss: 1.428 Vali Loss: 2.192 Vali Acc: 0.361 Test Loss: 2.192 Test Acc: 0.361
Validation loss decreased (-0.194422 --> -0.361089).  Saving model ...
Epoch: 6 cost time: 2.251882314682007
Epoch: 6, Steps: 7 | Train Loss: 1.124 Vali Loss: 2.183 Vali Acc: 0.236 Test Loss: 2.183 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.260577440261841
Epoch: 7, Steps: 7 | Train Loss: 0.785 Vali Loss: 2.165 Vali Acc: 0.292 Test Loss: 2.165 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.300121545791626
Epoch: 8, Steps: 7 | Train Loss: 0.477 Vali Loss: 2.061 Vali Acc: 0.306 Test Loss: 2.061 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3172712326049805
Epoch: 9, Steps: 7 | Train Loss: 0.321 Vali Loss: 2.037 Vali Acc: 0.236 Test Loss: 2.037 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1324357986450195
Epoch: 10, Steps: 7 | Train Loss: 0.168 Vali Loss: 1.992 Vali Acc: 0.278 Test Loss: 1.992 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.328261137008667
Epoch: 11, Steps: 7 | Train Loss: 0.107 Vali Loss: 2.084 Vali Acc: 0.264 Test Loss: 2.084 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1963236331939697
Epoch: 12, Steps: 7 | Train Loss: 0.059 Vali Loss: 2.108 Vali Acc: 0.278 Test Loss: 2.108 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.371270179748535
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.166 Vali Acc: 0.333 Test Loss: 2.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2804079055786133
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.210 Vali Acc: 0.278 Test Loss: 2.210 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.088463544845581
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.282 Vali Acc: 0.292 Test Loss: 2.282 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3611111111111111
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6425936222076416
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.519 Vali Acc: 0.153 Test Loss: 2.519 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 2.6137588024139404
Epoch: 2, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.395 Vali Acc: 0.167 Test Loss: 2.395 Test Acc: 0.167
Validation loss decreased (-0.152753 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 2.3030076026916504
Epoch: 3, Steps: 7 | Train Loss: 2.212 Vali Loss: 2.314 Vali Acc: 0.222 Test Loss: 2.314 Test Acc: 0.222
Validation loss decreased (-0.166643 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 2.4264228343963623
Epoch: 4, Steps: 7 | Train Loss: 1.937 Vali Loss: 2.408 Vali Acc: 0.236 Test Loss: 2.408 Test Acc: 0.236
Validation loss decreased (-0.222199 --> -0.236087).  Saving model ...
Epoch: 5 cost time: 2.451688289642334
Epoch: 5, Steps: 7 | Train Loss: 1.587 Vali Loss: 2.328 Vali Acc: 0.250 Test Loss: 2.328 Test Acc: 0.250
Validation loss decreased (-0.236087 --> -0.249977).  Saving model ...
Epoch: 6 cost time: 2.2818379402160645
Epoch: 6, Steps: 7 | Train Loss: 1.285 Vali Loss: 2.268 Vali Acc: 0.222 Test Loss: 2.268 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3715875148773193
Epoch: 7, Steps: 7 | Train Loss: 1.022 Vali Loss: 2.269 Vali Acc: 0.264 Test Loss: 2.269 Test Acc: 0.264
Validation loss decreased (-0.249977 --> -0.263866).  Saving model ...
Epoch: 8 cost time: 2.395139455795288
Epoch: 8, Steps: 7 | Train Loss: 0.707 Vali Loss: 2.056 Vali Acc: 0.264 Test Loss: 2.056 Test Acc: 0.264
Validation loss decreased (-0.263866 --> -0.263868).  Saving model ...
Epoch: 9 cost time: 2.2636306285858154
Epoch: 9, Steps: 7 | Train Loss: 0.520 Vali Loss: 2.033 Vali Acc: 0.319 Test Loss: 2.033 Test Acc: 0.319
Validation loss decreased (-0.263868 --> -0.319424).  Saving model ...
Epoch: 10 cost time: 2.3903651237487793
Epoch: 10, Steps: 7 | Train Loss: 0.342 Vali Loss: 2.163 Vali Acc: 0.194 Test Loss: 2.163 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2386693954467773
Epoch: 11, Steps: 7 | Train Loss: 0.253 Vali Loss: 2.123 Vali Acc: 0.278 Test Loss: 2.123 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2205183506011963
Epoch: 12, Steps: 7 | Train Loss: 0.184 Vali Loss: 2.202 Vali Acc: 0.250 Test Loss: 2.202 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.311152696609497
Epoch: 13, Steps: 7 | Train Loss: 0.136 Vali Loss: 2.428 Vali Acc: 0.250 Test Loss: 2.428 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.395683765411377
Epoch: 14, Steps: 7 | Train Loss: 0.086 Vali Loss: 2.316 Vali Acc: 0.292 Test Loss: 2.316 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4671132564544678
Epoch: 15, Steps: 7 | Train Loss: 0.060 Vali Loss: 2.482 Vali Acc: 0.264 Test Loss: 2.482 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3683085441589355
Epoch: 16, Steps: 7 | Train Loss: 0.047 Vali Loss: 2.869 Vali Acc: 0.236 Test Loss: 2.869 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3852572441101074
Epoch: 17, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.703 Vali Acc: 0.306 Test Loss: 2.703 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.616791009902954
Epoch: 18, Steps: 7 | Train Loss: 0.034 Vali Loss: 2.854 Vali Acc: 0.306 Test Loss: 2.854 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.597834825515747
Epoch: 19, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.944 Vali Acc: 0.250 Test Loss: 2.944 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3194444444444444
model parameter : 699372
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.580422878265381
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.323 Vali Acc: 0.250 Test Loss: 2.323 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 2.5256803035736084
Epoch: 2, Steps: 7 | Train Loss: 1.930 Vali Loss: 1.660 Vali Acc: 0.694 Test Loss: 1.660 Test Acc: 0.694
Validation loss decreased (-0.249977 --> -0.694428).  Saving model ...
Epoch: 3 cost time: 2.4328482151031494
Epoch: 3, Steps: 7 | Train Loss: 0.994 Vali Loss: 1.099 Vali Acc: 0.764 Test Loss: 1.099 Test Acc: 0.764
Validation loss decreased (-0.694428 --> -0.763878).  Saving model ...
Epoch: 4 cost time: 2.449103593826294
Epoch: 4, Steps: 7 | Train Loss: 0.389 Vali Loss: 0.899 Vali Acc: 0.792 Test Loss: 0.899 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 2.3560855388641357
Epoch: 5, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.887 Vali Acc: 0.778 Test Loss: 0.887 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4324657917022705
Epoch: 6, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.850 Vali Acc: 0.819 Test Loss: 0.850 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 2.2913455963134766
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.831 Vali Acc: 0.833 Test Loss: 0.831 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833325).  Saving model ...
Epoch: 8 cost time: 2.3531668186187744
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.833 Test Loss: 0.825 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 9 cost time: 2.4081268310546875
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.845 Vali Acc: 0.806 Test Loss: 0.845 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.075911283493042
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.819 Test Loss: 0.865 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2687456607818604
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.819 Test Loss: 0.870 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.269660234451294
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.819 Test Loss: 0.860 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.220975399017334
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.819 Test Loss: 0.853 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1788253784179688
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.847 Test Loss: 0.853 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847214).  Saving model ...
Epoch: 15 cost time: 2.302978515625
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.847 Test Loss: 0.849 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847214).  Saving model ...
Epoch: 16 cost time: 2.34507417678833
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.847 Test Loss: 0.846 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847214).  Saving model ...
Epoch: 17 cost time: 2.1707046031951904
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.833 Test Loss: 0.851 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2207090854644775
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.286696195602417
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.833 Test Loss: 0.853 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3418421745300293
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.833 Test Loss: 0.853 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.294462203979492
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.071542739868164
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.833 Test Loss: 0.846 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.458369731903076
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.405669689178467
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.833 Test Loss: 0.850 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3399364948272705
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.444990873336792
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5950095653533936
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.372 Vali Acc: 0.222 Test Loss: 2.372 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 2.501305341720581
Epoch: 2, Steps: 7 | Train Loss: 2.052 Vali Loss: 1.832 Vali Acc: 0.597 Test Loss: 1.832 Test Acc: 0.597
Validation loss decreased (-0.222199 --> -0.597204).  Saving model ...
Epoch: 3 cost time: 2.460941791534424
Epoch: 3, Steps: 7 | Train Loss: 1.180 Vali Loss: 1.310 Vali Acc: 0.708 Test Loss: 1.310 Test Acc: 0.708
Validation loss decreased (-0.597204 --> -0.708320).  Saving model ...
Epoch: 4 cost time: 2.37410306930542
Epoch: 4, Steps: 7 | Train Loss: 0.519 Vali Loss: 1.024 Vali Acc: 0.750 Test Loss: 1.024 Test Acc: 0.750
Validation loss decreased (-0.708320 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 2.432698965072632
Epoch: 5, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 2.4131555557250977
Epoch: 6, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.872 Vali Acc: 0.778 Test Loss: 0.872 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777769).  Saving model ...
Epoch: 7 cost time: 2.5302085876464844
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 2.320479393005371
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.895 Vali Acc: 0.764 Test Loss: 0.895 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5540223121643066
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.914 Vali Acc: 0.764 Test Loss: 0.914 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.510129928588867
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.764 Test Loss: 0.915 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.342514753341675
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.370943069458008
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.764 Test Loss: 0.885 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2751126289367676
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.792 Test Loss: 0.875 Test Acc: 0.792
Validation loss decreased (-0.777769 --> -0.791658).  Saving model ...
Epoch: 14 cost time: 2.2719945907592773
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.806 Test Loss: 0.876 Test Acc: 0.806
Validation loss decreased (-0.791658 --> -0.805547).  Saving model ...
Epoch: 15 cost time: 2.5106170177459717
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.806 Test Loss: 0.874 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805547).  Saving model ...
Epoch: 16 cost time: 2.5723745822906494
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.792 Test Loss: 0.876 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4214351177215576
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.806 Test Loss: 0.885 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.403533458709717
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.792 Test Loss: 0.894 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3166890144348145
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.792 Test Loss: 0.892 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2742199897766113
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.806 Test Loss: 0.892 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4127464294433594
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.806 Test Loss: 0.891 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5390915870666504
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.806 Test Loss: 0.885 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.51649808883667
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.819 Test Loss: 0.891 Test Acc: 0.819
Validation loss decreased (-0.805547 --> -0.819436).  Saving model ...
Epoch: 24 cost time: 2.570146083831787
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.819 Test Loss: 0.893 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3466482162475586
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.819 Test Loss: 0.894 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4810471534729004
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3123109340667725
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.819 Test Loss: 0.899 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4766368865966797
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.513812303543091
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.5741994380950928
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.819 Test Loss: 0.903 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.4662883281707764
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.819 Test Loss: 0.905 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.389427423477173
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.819 Test Loss: 0.907 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.3088550567626953
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.819 Test Loss: 0.908 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8194444444444444
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9927926063537598
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.421 Vali Acc: 0.111 Test Loss: 2.421 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 2.7781755924224854
Epoch: 2, Steps: 7 | Train Loss: 2.154 Vali Loss: 2.042 Vali Acc: 0.472 Test Loss: 2.042 Test Acc: 0.472
Validation loss decreased (-0.111087 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 2.5200788974761963
Epoch: 3, Steps: 7 | Train Loss: 1.371 Vali Loss: 1.619 Vali Acc: 0.611 Test Loss: 1.619 Test Acc: 0.611
Validation loss decreased (-0.472202 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 2.5817129611968994
Epoch: 4, Steps: 7 | Train Loss: 0.701 Vali Loss: 1.336 Vali Acc: 0.681 Test Loss: 1.336 Test Acc: 0.681
Validation loss decreased (-0.611095 --> -0.680542).  Saving model ...
Epoch: 5 cost time: 2.488835573196411
Epoch: 5, Steps: 7 | Train Loss: 0.341 Vali Loss: 1.186 Vali Acc: 0.694 Test Loss: 1.186 Test Acc: 0.694
Validation loss decreased (-0.680542 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 2.4454801082611084
Epoch: 6, Steps: 7 | Train Loss: 0.120 Vali Loss: 1.080 Vali Acc: 0.722 Test Loss: 1.080 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722211).  Saving model ...
Epoch: 7 cost time: 2.3130578994750977
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.990 Vali Acc: 0.708 Test Loss: 0.990 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3956663608551025
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.064 Vali Acc: 0.681 Test Loss: 1.064 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.433230400085449
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.005 Vali Acc: 0.694 Test Loss: 1.005 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3324904441833496
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.958 Vali Acc: 0.708 Test Loss: 0.958 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.232030153274536
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.951 Vali Acc: 0.736 Test Loss: 0.951 Test Acc: 0.736
Validation loss decreased (-0.722211 --> -0.736102).  Saving model ...
Epoch: 12 cost time: 2.353834390640259
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3223512172698975
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2866873741149902
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.708 Test Loss: 0.984 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6945927143096924
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.708 Test Loss: 0.991 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5562503337860107
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.708 Test Loss: 0.991 Test Acc: 0.708
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.326690673828125
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.708 Test Loss: 0.992 Test Acc: 0.708
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.477595090866089
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.708 Test Loss: 0.997 Test Acc: 0.708
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.417896270751953
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.708 Test Loss: 0.990 Test Acc: 0.708
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4455254077911377
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.708 Test Loss: 0.991 Test Acc: 0.708
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.448002815246582
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.708 Test Loss: 0.989 Test Acc: 0.708
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7361111111111112
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7928082942962646
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.458 Vali Acc: 0.125 Test Loss: 2.458 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.694136619567871
Epoch: 2, Steps: 7 | Train Loss: 2.219 Vali Loss: 2.209 Vali Acc: 0.375 Test Loss: 2.209 Test Acc: 0.375
Validation loss decreased (-0.124975 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 2.645902395248413
Epoch: 3, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.889 Vali Acc: 0.458 Test Loss: 1.889 Test Acc: 0.458
Validation loss decreased (-0.374978 --> -0.458314).  Saving model ...
Epoch: 4 cost time: 2.773322105407715
Epoch: 4, Steps: 7 | Train Loss: 0.873 Vali Loss: 1.640 Vali Acc: 0.486 Test Loss: 1.640 Test Acc: 0.486
Validation loss decreased (-0.458314 --> -0.486095).  Saving model ...
Epoch: 5 cost time: 2.423511028289795
Epoch: 5, Steps: 7 | Train Loss: 0.436 Vali Loss: 1.546 Vali Acc: 0.514 Test Loss: 1.546 Test Acc: 0.514
Validation loss decreased (-0.486095 --> -0.513873).  Saving model ...
Epoch: 6 cost time: 2.4711966514587402
Epoch: 6, Steps: 7 | Train Loss: 0.169 Vali Loss: 1.386 Vali Acc: 0.583 Test Loss: 1.386 Test Acc: 0.583
Validation loss decreased (-0.513873 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 2.5679969787597656
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.398 Vali Acc: 0.569 Test Loss: 1.398 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4198477268218994
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.451 Vali Acc: 0.528 Test Loss: 1.451 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3515331745147705
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.292 Vali Acc: 0.569 Test Loss: 1.292 Test Acc: 0.569
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4796364307403564
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.342 Vali Acc: 0.583 Test Loss: 1.342 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583320).  Saving model ...
Epoch: 11 cost time: 2.436101198196411
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.428 Vali Acc: 0.611 Test Loss: 1.428 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611097).  Saving model ...
Epoch: 12 cost time: 2.6737914085388184
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.447 Vali Acc: 0.639 Test Loss: 1.447 Test Acc: 0.639
Validation loss decreased (-0.611097 --> -0.638874).  Saving model ...
Epoch: 13 cost time: 2.762702465057373
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.436 Vali Acc: 0.611 Test Loss: 1.436 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6500320434570312
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.415 Vali Acc: 0.597 Test Loss: 1.415 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5763583183288574
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.395 Vali Acc: 0.597 Test Loss: 1.395 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.527280569076538
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.625 Test Loss: 1.381 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5328898429870605
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.625 Test Loss: 1.380 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.540496349334717
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.625 Test Loss: 1.392 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3797428607940674
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.611 Test Loss: 1.396 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6528985500335693
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.625 Test Loss: 1.408 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6994354724884033
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.625 Test Loss: 1.416 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4526023864746094
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.625 Test Loss: 1.413 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6388888888888888
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3214709758758545
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.477 Vali Acc: 0.111 Test Loss: 2.477 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.286891460418701
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.336 Vali Acc: 0.264 Test Loss: 2.336 Test Acc: 0.264
Validation loss decreased (-0.111086 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 2.2187047004699707
Epoch: 3, Steps: 7 | Train Loss: 1.692 Vali Loss: 2.168 Vali Acc: 0.292 Test Loss: 2.168 Test Acc: 0.292
Validation loss decreased (-0.263866 --> -0.291645).  Saving model ...
Epoch: 4 cost time: 2.1906371116638184
Epoch: 4, Steps: 7 | Train Loss: 1.100 Vali Loss: 2.052 Vali Acc: 0.333 Test Loss: 2.052 Test Acc: 0.333
Validation loss decreased (-0.291645 --> -0.333313).  Saving model ...
Epoch: 5 cost time: 2.251115322113037
Epoch: 5, Steps: 7 | Train Loss: 0.623 Vali Loss: 2.097 Vali Acc: 0.333 Test Loss: 2.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3516910076141357
Epoch: 6, Steps: 7 | Train Loss: 0.296 Vali Loss: 2.071 Vali Acc: 0.375 Test Loss: 2.071 Test Acc: 0.375
Validation loss decreased (-0.333313 --> -0.374979).  Saving model ...
Epoch: 7 cost time: 2.396286725997925
Epoch: 7, Steps: 7 | Train Loss: 0.148 Vali Loss: 2.041 Vali Acc: 0.375 Test Loss: 2.041 Test Acc: 0.375
Validation loss decreased (-0.374979 --> -0.374980).  Saving model ...
Epoch: 8 cost time: 2.5189106464385986
Epoch: 8, Steps: 7 | Train Loss: 0.075 Vali Loss: 2.397 Vali Acc: 0.403 Test Loss: 2.397 Test Acc: 0.403
Validation loss decreased (-0.374980 --> -0.402754).  Saving model ...
Epoch: 9 cost time: 2.4023513793945312
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 2.071 Vali Acc: 0.375 Test Loss: 2.071 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4235832691192627
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.299 Vali Acc: 0.403 Test Loss: 2.299 Test Acc: 0.403
Validation loss decreased (-0.402754 --> -0.402755).  Saving model ...
Epoch: 11 cost time: 2.5077874660491943
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.501 Vali Acc: 0.389 Test Loss: 2.501 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.496124029159546
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.440 Vali Acc: 0.417 Test Loss: 2.440 Test Acc: 0.417
Validation loss decreased (-0.402755 --> -0.416642).  Saving model ...
Epoch: 13 cost time: 2.6165366172790527
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.337 Vali Acc: 0.389 Test Loss: 2.337 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4430744647979736
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.294 Vali Acc: 0.417 Test Loss: 2.294 Test Acc: 0.417
Validation loss decreased (-0.416642 --> -0.416644).  Saving model ...
Epoch: 15 cost time: 2.4282186031341553
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.313 Vali Acc: 0.417 Test Loss: 2.313 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4830713272094727
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.334 Vali Acc: 0.417 Test Loss: 2.334 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5769970417022705
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.371 Vali Acc: 0.403 Test Loss: 2.371 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4416391849517822
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.423 Vali Acc: 0.403 Test Loss: 2.423 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6319057941436768
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.427 Vali Acc: 0.403 Test Loss: 2.427 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.618356227874756
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.449 Vali Acc: 0.403 Test Loss: 2.449 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.377397060394287
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.454 Vali Acc: 0.389 Test Loss: 2.454 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4951322078704834
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.458 Vali Acc: 0.403 Test Loss: 2.458 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8529834747314453
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.475 Vali Acc: 0.417 Test Loss: 2.475 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4764182567596436
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.470 Vali Acc: 0.417 Test Loss: 2.470 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.525909900665283
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.500 Vali Acc: 0.111 Test Loss: 2.500 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.455338478088379
Epoch: 2, Steps: 7 | Train Loss: 2.329 Vali Loss: 2.310 Vali Acc: 0.292 Test Loss: 2.310 Test Acc: 0.292
Validation loss decreased (-0.111086 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 2.3923707008361816
Epoch: 3, Steps: 7 | Train Loss: 1.824 Vali Loss: 2.115 Vali Acc: 0.292 Test Loss: 2.115 Test Acc: 0.292
Validation loss decreased (-0.291644 --> -0.291646).  Saving model ...
Epoch: 4 cost time: 2.188983678817749
Epoch: 4, Steps: 7 | Train Loss: 1.300 Vali Loss: 1.943 Vali Acc: 0.389 Test Loss: 1.943 Test Acc: 0.389
Validation loss decreased (-0.291646 --> -0.388869).  Saving model ...
Epoch: 5 cost time: 2.2949037551879883
Epoch: 5, Steps: 7 | Train Loss: 0.812 Vali Loss: 1.937 Vali Acc: 0.361 Test Loss: 1.937 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3887510299682617
Epoch: 6, Steps: 7 | Train Loss: 0.459 Vali Loss: 1.803 Vali Acc: 0.417 Test Loss: 1.803 Test Acc: 0.417
Validation loss decreased (-0.388869 --> -0.416649).  Saving model ...
Epoch: 7 cost time: 2.4280712604522705
Epoch: 7, Steps: 7 | Train Loss: 0.258 Vali Loss: 1.804 Vali Acc: 0.403 Test Loss: 1.804 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6059112548828125
Epoch: 8, Steps: 7 | Train Loss: 0.142 Vali Loss: 1.901 Vali Acc: 0.389 Test Loss: 1.901 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4261233806610107
Epoch: 9, Steps: 7 | Train Loss: 0.063 Vali Loss: 1.850 Vali Acc: 0.417 Test Loss: 1.850 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2880022525787354
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 2.061 Vali Acc: 0.417 Test Loss: 2.061 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3804454803466797
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.989 Vali Acc: 0.417 Test Loss: 1.989 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.389361619949341
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.074 Vali Acc: 0.431 Test Loss: 2.074 Test Acc: 0.431
Validation loss decreased (-0.416649 --> -0.430535).  Saving model ...
Epoch: 13 cost time: 2.329624891281128
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.112 Vali Acc: 0.431 Test Loss: 2.112 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.33801007270813
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.145 Vali Acc: 0.417 Test Loss: 2.145 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4370691776275635
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.127 Vali Acc: 0.417 Test Loss: 2.127 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.394580125808716
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.091 Vali Acc: 0.417 Test Loss: 2.091 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5990030765533447
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.098 Vali Acc: 0.417 Test Loss: 2.098 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8475186824798584
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.179 Vali Acc: 0.417 Test Loss: 2.179 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4879603385925293
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.179 Vali Acc: 0.431 Test Loss: 2.179 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.565434217453003
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.210 Vali Acc: 0.417 Test Loss: 2.210 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.469926357269287
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.212 Vali Acc: 0.417 Test Loss: 2.212 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.572113275527954
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.210 Vali Acc: 0.431 Test Loss: 2.210 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5945756435394287
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.475 Vali Acc: 0.125 Test Loss: 2.475 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.289771318435669
Epoch: 2, Steps: 7 | Train Loss: 2.355 Vali Loss: 2.294 Vali Acc: 0.264 Test Loss: 2.294 Test Acc: 0.264
Validation loss decreased (-0.124975 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 2.2715601921081543
Epoch: 3, Steps: 7 | Train Loss: 1.917 Vali Loss: 2.118 Vali Acc: 0.333 Test Loss: 2.118 Test Acc: 0.333
Validation loss decreased (-0.263866 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 2.6331822872161865
Epoch: 4, Steps: 7 | Train Loss: 1.429 Vali Loss: 1.929 Vali Acc: 0.375 Test Loss: 1.929 Test Acc: 0.375
Validation loss decreased (-0.333312 --> -0.374981).  Saving model ...
Epoch: 5 cost time: 2.3040473461151123
Epoch: 5, Steps: 7 | Train Loss: 0.952 Vali Loss: 1.898 Vali Acc: 0.361 Test Loss: 1.898 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1773011684417725
Epoch: 6, Steps: 7 | Train Loss: 0.579 Vali Loss: 1.690 Vali Acc: 0.472 Test Loss: 1.690 Test Acc: 0.472
Validation loss decreased (-0.374981 --> -0.472205).  Saving model ...
Epoch: 7 cost time: 2.3390369415283203
Epoch: 7, Steps: 7 | Train Loss: 0.362 Vali Loss: 1.625 Vali Acc: 0.417 Test Loss: 1.625 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0467987060546875
Epoch: 8, Steps: 7 | Train Loss: 0.212 Vali Loss: 1.674 Vali Acc: 0.444 Test Loss: 1.674 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3271074295043945
Epoch: 9, Steps: 7 | Train Loss: 0.128 Vali Loss: 1.485 Vali Acc: 0.486 Test Loss: 1.485 Test Acc: 0.486
Validation loss decreased (-0.472205 --> -0.486096).  Saving model ...
Epoch: 10 cost time: 2.287686586380005
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.828 Vali Acc: 0.431 Test Loss: 1.828 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2073092460632324
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 1.673 Vali Acc: 0.444 Test Loss: 1.673 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.355048894882202
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 1.558 Vali Acc: 0.500 Test Loss: 1.558 Test Acc: 0.500
Validation loss decreased (-0.486096 --> -0.499984).  Saving model ...
Epoch: 13 cost time: 2.366884231567383
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.710 Vali Acc: 0.444 Test Loss: 1.710 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2351596355438232
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.932 Vali Acc: 0.472 Test Loss: 1.932 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.410922050476074
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.812 Vali Acc: 0.472 Test Loss: 1.812 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.308279037475586
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.651 Vali Acc: 0.458 Test Loss: 1.651 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2283730506896973
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.625 Vali Acc: 0.458 Test Loss: 1.625 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2775700092315674
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.740 Vali Acc: 0.472 Test Loss: 1.740 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5624938011169434
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.797 Vali Acc: 0.472 Test Loss: 1.797 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4354588985443115
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.847 Vali Acc: 0.458 Test Loss: 1.847 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5875942707061768
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.458 Test Loss: 1.841 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5335593223571777
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.458 Test Loss: 1.816 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.663912057876587
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.506 Vali Acc: 0.083 Test Loss: 2.506 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.30497145652771
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.374 Vali Acc: 0.264 Test Loss: 2.374 Test Acc: 0.264
Validation loss decreased (-0.083308 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 2.425762891769409
Epoch: 3, Steps: 7 | Train Loss: 2.014 Vali Loss: 2.232 Vali Acc: 0.306 Test Loss: 2.232 Test Acc: 0.306
Validation loss decreased (-0.263865 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 2.2446374893188477
Epoch: 4, Steps: 7 | Train Loss: 1.567 Vali Loss: 2.101 Vali Acc: 0.347 Test Loss: 2.101 Test Acc: 0.347
Validation loss decreased (-0.305533 --> -0.347201).  Saving model ...
Epoch: 5 cost time: 2.389770269393921
Epoch: 5, Steps: 7 | Train Loss: 1.075 Vali Loss: 2.056 Vali Acc: 0.292 Test Loss: 2.056 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.41896390914917
Epoch: 6, Steps: 7 | Train Loss: 0.662 Vali Loss: 1.885 Vali Acc: 0.417 Test Loss: 1.885 Test Acc: 0.417
Validation loss decreased (-0.347201 --> -0.416648).  Saving model ...
Epoch: 7 cost time: 2.4157869815826416
Epoch: 7, Steps: 7 | Train Loss: 0.405 Vali Loss: 1.834 Vali Acc: 0.361 Test Loss: 1.834 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.585118293762207
Epoch: 8, Steps: 7 | Train Loss: 0.226 Vali Loss: 1.935 Vali Acc: 0.403 Test Loss: 1.935 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.540003776550293
Epoch: 9, Steps: 7 | Train Loss: 0.126 Vali Loss: 1.731 Vali Acc: 0.458 Test Loss: 1.731 Test Acc: 0.458
Validation loss decreased (-0.416648 --> -0.458316).  Saving model ...
Epoch: 10 cost time: 2.557116985321045
Epoch: 10, Steps: 7 | Train Loss: 0.058 Vali Loss: 2.061 Vali Acc: 0.375 Test Loss: 2.061 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5860960483551025
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 1.921 Vali Acc: 0.417 Test Loss: 1.921 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7161543369293213
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.884 Vali Acc: 0.403 Test Loss: 1.884 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.919098138809204
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.906 Vali Acc: 0.431 Test Loss: 1.906 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4197659492492676
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.087 Vali Acc: 0.431 Test Loss: 2.087 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5878541469573975
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.075 Vali Acc: 0.458 Test Loss: 2.075 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.233049154281616
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.945 Vali Acc: 0.444 Test Loss: 1.945 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2732865810394287
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.922 Vali Acc: 0.458 Test Loss: 1.922 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4560985565185547
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.032 Vali Acc: 0.417 Test Loss: 2.032 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.266361951828003
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.034 Vali Acc: 0.417 Test Loss: 2.034 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4583333333333333
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3920552730560303
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.538 Vali Acc: 0.111 Test Loss: 2.538 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.40548038482666
Epoch: 2, Steps: 7 | Train Loss: 2.421 Vali Loss: 2.434 Vali Acc: 0.083 Test Loss: 2.434 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.300692558288574
Epoch: 3, Steps: 7 | Train Loss: 2.132 Vali Loss: 2.346 Vali Acc: 0.236 Test Loss: 2.346 Test Acc: 0.236
Validation loss decreased (-0.111086 --> -0.236088).  Saving model ...
Epoch: 4 cost time: 2.8141345977783203
Epoch: 4, Steps: 7 | Train Loss: 1.824 Vali Loss: 2.286 Vali Acc: 0.306 Test Loss: 2.286 Test Acc: 0.306
Validation loss decreased (-0.236088 --> -0.305533).  Saving model ...
Epoch: 5 cost time: 2.3102939128875732
Epoch: 5, Steps: 7 | Train Loss: 1.411 Vali Loss: 2.329 Vali Acc: 0.264 Test Loss: 2.329 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.295696258544922
Epoch: 6, Steps: 7 | Train Loss: 1.062 Vali Loss: 2.179 Vali Acc: 0.278 Test Loss: 2.179 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.50520396232605
Epoch: 7, Steps: 7 | Train Loss: 0.777 Vali Loss: 2.162 Vali Acc: 0.236 Test Loss: 2.162 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.521284818649292
Epoch: 8, Steps: 7 | Train Loss: 0.512 Vali Loss: 2.224 Vali Acc: 0.278 Test Loss: 2.224 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6639251708984375
Epoch: 9, Steps: 7 | Train Loss: 0.318 Vali Loss: 2.089 Vali Acc: 0.292 Test Loss: 2.089 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8025712966918945
Epoch: 10, Steps: 7 | Train Loss: 0.184 Vali Loss: 2.178 Vali Acc: 0.292 Test Loss: 2.178 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9876010417938232
Epoch: 11, Steps: 7 | Train Loss: 0.104 Vali Loss: 2.100 Vali Acc: 0.347 Test Loss: 2.100 Test Acc: 0.347
Validation loss decreased (-0.305533 --> -0.347201).  Saving model ...
Epoch: 12 cost time: 2.535811424255371
Epoch: 12, Steps: 7 | Train Loss: 0.073 Vali Loss: 1.984 Vali Acc: 0.292 Test Loss: 1.984 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7276957035064697
Epoch: 13, Steps: 7 | Train Loss: 0.041 Vali Loss: 2.277 Vali Acc: 0.278 Test Loss: 2.277 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.629030227661133
Epoch: 14, Steps: 7 | Train Loss: 0.031 Vali Loss: 2.305 Vali Acc: 0.347 Test Loss: 2.305 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.628213882446289
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.100 Vali Acc: 0.319 Test Loss: 2.100 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.441134214401245
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.096 Vali Acc: 0.347 Test Loss: 2.096 Test Acc: 0.347
Validation loss decreased (-0.347201 --> -0.347201).  Saving model ...
Epoch: 17 cost time: 2.775563955307007
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.216 Vali Acc: 0.278 Test Loss: 2.216 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.675891876220703
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.324 Vali Acc: 0.278 Test Loss: 2.324 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.365713596343994
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.285 Vali Acc: 0.264 Test Loss: 2.285 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3851804733276367
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.238 Vali Acc: 0.347 Test Loss: 2.238 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.223254680633545
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.253 Vali Acc: 0.375 Test Loss: 2.253 Test Acc: 0.375
Validation loss decreased (-0.347201 --> -0.374977).  Saving model ...
Epoch: 22 cost time: 2.2956557273864746
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.259 Vali Acc: 0.361 Test Loss: 2.259 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6031320095062256
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.327 Vali Acc: 0.306 Test Loss: 2.327 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3483200073242188
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.383 Vali Acc: 0.292 Test Loss: 2.383 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2882566452026367
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.348 Vali Acc: 0.306 Test Loss: 2.348 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.309086799621582
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.334 Vali Acc: 0.306 Test Loss: 2.334 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.674285411834717
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.320 Vali Acc: 0.347 Test Loss: 2.320 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4672021865844727
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.332 Vali Acc: 0.319 Test Loss: 2.332 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4633662700653076
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.357 Vali Acc: 0.319 Test Loss: 2.357 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4879965782165527
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.394 Vali Acc: 0.319 Test Loss: 2.394 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.3360133171081543
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.400 Vali Acc: 0.333 Test Loss: 2.400 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.375
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4861903190612793
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.558 Vali Acc: 0.125 Test Loss: 2.558 Test Acc: 0.125
Validation loss decreased (inf --> -0.124974).  Saving model ...
Epoch: 2 cost time: 2.5641427040100098
Epoch: 2, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.456 Vali Acc: 0.153 Test Loss: 2.456 Test Acc: 0.153
Validation loss decreased (-0.124974 --> -0.152753).  Saving model ...
Epoch: 3 cost time: 2.491957902908325
Epoch: 3, Steps: 7 | Train Loss: 2.174 Vali Loss: 2.437 Vali Acc: 0.153 Test Loss: 2.437 Test Acc: 0.153
Validation loss decreased (-0.152753 --> -0.152753).  Saving model ...
Epoch: 4 cost time: 2.5382003784179688
Epoch: 4, Steps: 7 | Train Loss: 1.899 Vali Loss: 2.445 Vali Acc: 0.167 Test Loss: 2.445 Test Acc: 0.167
Validation loss decreased (-0.152753 --> -0.166642).  Saving model ...
Epoch: 5 cost time: 2.577815532684326
Epoch: 5, Steps: 7 | Train Loss: 1.587 Vali Loss: 2.521 Vali Acc: 0.236 Test Loss: 2.521 Test Acc: 0.236
Validation loss decreased (-0.166642 --> -0.236086).  Saving model ...
Epoch: 6 cost time: 2.5144269466400146
Epoch: 6, Steps: 7 | Train Loss: 1.249 Vali Loss: 2.438 Vali Acc: 0.153 Test Loss: 2.438 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5003528594970703
Epoch: 7, Steps: 7 | Train Loss: 1.003 Vali Loss: 2.313 Vali Acc: 0.181 Test Loss: 2.313 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.462486982345581
Epoch: 8, Steps: 7 | Train Loss: 0.779 Vali Loss: 2.347 Vali Acc: 0.236 Test Loss: 2.347 Test Acc: 0.236
Validation loss decreased (-0.236086 --> -0.236088).  Saving model ...
Epoch: 9 cost time: 2.6044249534606934
Epoch: 9, Steps: 7 | Train Loss: 0.493 Vali Loss: 2.177 Vali Acc: 0.222 Test Loss: 2.177 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5652735233306885
Epoch: 10, Steps: 7 | Train Loss: 0.370 Vali Loss: 2.237 Vali Acc: 0.167 Test Loss: 2.237 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4819698333740234
Epoch: 11, Steps: 7 | Train Loss: 0.261 Vali Loss: 2.435 Vali Acc: 0.208 Test Loss: 2.435 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7070138454437256
Epoch: 12, Steps: 7 | Train Loss: 0.180 Vali Loss: 2.354 Vali Acc: 0.181 Test Loss: 2.354 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.635242462158203
Epoch: 13, Steps: 7 | Train Loss: 0.123 Vali Loss: 2.692 Vali Acc: 0.236 Test Loss: 2.692 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.53493070602417
Epoch: 14, Steps: 7 | Train Loss: 0.085 Vali Loss: 2.457 Vali Acc: 0.250 Test Loss: 2.457 Test Acc: 0.250
Validation loss decreased (-0.236088 --> -0.249975).  Saving model ...
Epoch: 15 cost time: 2.530970335006714
Epoch: 15, Steps: 7 | Train Loss: 0.055 Vali Loss: 2.430 Vali Acc: 0.292 Test Loss: 2.430 Test Acc: 0.292
Validation loss decreased (-0.249975 --> -0.291642).  Saving model ...
Epoch: 16 cost time: 2.631669521331787
Epoch: 16, Steps: 7 | Train Loss: 0.036 Vali Loss: 2.816 Vali Acc: 0.250 Test Loss: 2.816 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4930508136749268
Epoch: 17, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.799 Vali Acc: 0.250 Test Loss: 2.799 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6493937969207764
Epoch: 18, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.778 Vali Acc: 0.194 Test Loss: 2.778 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5796356201171875
Epoch: 19, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.767 Vali Acc: 0.208 Test Loss: 2.767 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6227753162384033
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.885 Vali Acc: 0.250 Test Loss: 2.885 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4392588138580322
Epoch: 21, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.952 Vali Acc: 0.264 Test Loss: 2.952 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6228747367858887
Epoch: 22, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.020 Vali Acc: 0.264 Test Loss: 3.020 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5254485607147217
Epoch: 23, Steps: 7 | Train Loss: 0.009 Vali Loss: 3.055 Vali Acc: 0.236 Test Loss: 3.055 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.419468402862549
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.095 Vali Acc: 0.250 Test Loss: 3.095 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4470856189727783
Epoch: 25, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.106 Vali Acc: 0.236 Test Loss: 3.106 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 601068
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4427077770233154
Epoch: 1, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.314 Vali Acc: 0.236 Test Loss: 2.314 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 2.4882452487945557
Epoch: 2, Steps: 7 | Train Loss: 1.963 Vali Loss: 1.653 Vali Acc: 0.611 Test Loss: 1.653 Test Acc: 0.611
Validation loss decreased (-0.236088 --> -0.611095).  Saving model ...
Epoch: 3 cost time: 2.266850709915161
Epoch: 3, Steps: 7 | Train Loss: 1.002 Vali Loss: 1.134 Vali Acc: 0.736 Test Loss: 1.134 Test Acc: 0.736
Validation loss decreased (-0.611095 --> -0.736100).  Saving model ...
Epoch: 4 cost time: 2.4639358520507812
Epoch: 4, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.956 Vali Acc: 0.792 Test Loss: 0.956 Test Acc: 0.792
Validation loss decreased (-0.736100 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 2.5147831439971924
Epoch: 5, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4050440788269043
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.927 Vali Acc: 0.778 Test Loss: 0.927 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5775585174560547
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.967 Vali Acc: 0.778 Test Loss: 0.967 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4744105339050293
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.919 Vali Acc: 0.806 Test Loss: 0.919 Test Acc: 0.806
Validation loss decreased (-0.791657 --> -0.805546).  Saving model ...
Epoch: 9 cost time: 2.4986817836761475
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.883 Vali Acc: 0.819 Test Loss: 0.883 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819436).  Saving model ...
Epoch: 10 cost time: 2.521327018737793
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.806 Test Loss: 0.871 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6186704635620117
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.806 Test Loss: 0.872 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9733834266662598
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.880 Vali Acc: 0.833 Test Loss: 0.880 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833325).  Saving model ...
Epoch: 13 cost time: 2.807813882827759
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.833 Test Loss: 0.888 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8805928230285645
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.806 Test Loss: 0.896 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6418797969818115
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.792 Test Loss: 0.903 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5311710834503174
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.806 Test Loss: 0.905 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.580773115158081
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.806 Test Loss: 0.906 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.414763927459717
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.819 Test Loss: 0.905 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.404263734817505
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.806 Test Loss: 0.905 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5833239555358887
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.847 Test Loss: 0.902 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847213).  Saving model ...
Epoch: 21 cost time: 2.4870667457580566
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.833 Test Loss: 0.902 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.449866533279419
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.833 Test Loss: 0.906 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5634748935699463
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.580382823944092
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.316859722137451
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.833 Test Loss: 0.914 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.372187852859497
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7262325286865234
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.38466477394104
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3281967639923096
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.833 Test Loss: 0.915 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.505674362182617
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.833 Test Loss: 0.917 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.72477650642395
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.351 Vali Acc: 0.139 Test Loss: 2.351 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.640366554260254
Epoch: 2, Steps: 7 | Train Loss: 2.069 Vali Loss: 1.815 Vali Acc: 0.542 Test Loss: 1.815 Test Acc: 0.542
Validation loss decreased (-0.138865 --> -0.541649).  Saving model ...
Epoch: 3 cost time: 2.4729912281036377
Epoch: 3, Steps: 7 | Train Loss: 1.174 Vali Loss: 1.285 Vali Acc: 0.722 Test Loss: 1.285 Test Acc: 0.722
Validation loss decreased (-0.541649 --> -0.722209).  Saving model ...
Epoch: 4 cost time: 2.5629539489746094
Epoch: 4, Steps: 7 | Train Loss: 0.548 Vali Loss: 1.029 Vali Acc: 0.778 Test Loss: 1.029 Test Acc: 0.778
Validation loss decreased (-0.722209 --> -0.777767).  Saving model ...
Epoch: 5 cost time: 2.4943554401397705
Epoch: 5, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5359981060028076
Epoch: 6, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.902 Vali Acc: 0.736 Test Loss: 0.902 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1847283840179443
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.922 Vali Acc: 0.764 Test Loss: 0.922 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3661797046661377
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.413034677505493
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.857 Vali Acc: 0.764 Test Loss: 0.857 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.51360821723938
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.885 Vali Acc: 0.764 Test Loss: 0.885 Test Acc: 0.764
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2842044830322266
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.778 Test Loss: 0.902 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 2.384739875793457
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.778 Test Loss: 0.910 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4108216762542725
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.778 Test Loss: 0.909 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.338179111480713
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.764 Test Loss: 0.904 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6701507568359375
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.764 Test Loss: 0.901 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4548048973083496
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.764 Test Loss: 0.902 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3573875427246094
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.764 Test Loss: 0.902 Test Acc: 0.764
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.313115119934082
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.764 Test Loss: 0.904 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.260751247406006
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.764 Test Loss: 0.907 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2948224544525146
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.764 Test Loss: 0.907 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5249500274658203
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.764 Test Loss: 0.907 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6123037338256836
Epoch: 1, Steps: 7 | Train Loss: 2.545 Vali Loss: 2.394 Vali Acc: 0.181 Test Loss: 2.394 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 2.3592896461486816
Epoch: 2, Steps: 7 | Train Loss: 2.180 Vali Loss: 1.998 Vali Acc: 0.431 Test Loss: 1.998 Test Acc: 0.431
Validation loss decreased (-0.180532 --> -0.430536).  Saving model ...
Epoch: 3 cost time: 2.283719778060913
Epoch: 3, Steps: 7 | Train Loss: 1.373 Vali Loss: 1.529 Vali Acc: 0.653 Test Loss: 1.529 Test Acc: 0.653
Validation loss decreased (-0.430536 --> -0.652762).  Saving model ...
Epoch: 4 cost time: 2.3718745708465576
Epoch: 4, Steps: 7 | Train Loss: 0.742 Vali Loss: 1.317 Vali Acc: 0.597 Test Loss: 1.317 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2098095417022705
Epoch: 5, Steps: 7 | Train Loss: 0.344 Vali Loss: 1.165 Vali Acc: 0.708 Test Loss: 1.165 Test Acc: 0.708
Validation loss decreased (-0.652762 --> -0.708322).  Saving model ...
Epoch: 6 cost time: 2.2297794818878174
Epoch: 6, Steps: 7 | Train Loss: 0.131 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.708322 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 2.284390449523926
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 1.021 Vali Acc: 0.736 Test Loss: 1.021 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.207118511199951
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4783308506011963
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.147134780883789
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.979 Vali Acc: 0.736 Test Loss: 0.979 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2495431900024414
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.990 Vali Acc: 0.736 Test Loss: 0.990 Test Acc: 0.736
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.318882942199707
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.975 Vali Acc: 0.736 Test Loss: 0.975 Test Acc: 0.736
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.410475492477417
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.955 Vali Acc: 0.736 Test Loss: 0.955 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4274346828460693
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.943 Vali Acc: 0.736 Test Loss: 0.943 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3683598041534424
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.736 Test Loss: 0.946 Test Acc: 0.736
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.273411750793457
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.722 Test Loss: 0.955 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.75
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8073973655700684
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.407 Vali Acc: 0.153 Test Loss: 2.407 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 2.455369234085083
Epoch: 2, Steps: 7 | Train Loss: 2.264 Vali Loss: 2.138 Vali Acc: 0.361 Test Loss: 2.138 Test Acc: 0.361
Validation loss decreased (-0.152754 --> -0.361090).  Saving model ...
Epoch: 3 cost time: 2.4271926879882812
Epoch: 3, Steps: 7 | Train Loss: 1.555 Vali Loss: 1.815 Vali Acc: 0.486 Test Loss: 1.815 Test Acc: 0.486
Validation loss decreased (-0.361090 --> -0.486093).  Saving model ...
Epoch: 4 cost time: 2.4784207344055176
Epoch: 4, Steps: 7 | Train Loss: 0.923 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
Validation loss decreased (-0.486093 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 2.3153839111328125
Epoch: 5, Steps: 7 | Train Loss: 0.467 Vali Loss: 1.490 Vali Acc: 0.583 Test Loss: 1.490 Test Acc: 0.583
Validation loss decreased (-0.499984 --> -0.583318).  Saving model ...
Epoch: 6 cost time: 2.573345184326172
Epoch: 6, Steps: 7 | Train Loss: 0.204 Vali Loss: 1.433 Vali Acc: 0.556 Test Loss: 1.433 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5697004795074463
Epoch: 7, Steps: 7 | Train Loss: 0.073 Vali Loss: 1.410 Vali Acc: 0.583 Test Loss: 1.410 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 8 cost time: 2.401707172393799
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.308 Vali Acc: 0.569 Test Loss: 1.308 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.489046096801758
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.401 Vali Acc: 0.597 Test Loss: 1.401 Test Acc: 0.597
Validation loss decreased (-0.583319 --> -0.597208).  Saving model ...
Epoch: 10 cost time: 2.3600220680236816
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.430 Vali Acc: 0.597 Test Loss: 1.430 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.165489912033081
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.365 Vali Acc: 0.625 Test Loss: 1.365 Test Acc: 0.625
Validation loss decreased (-0.597208 --> -0.624986).  Saving model ...
Epoch: 12 cost time: 2.307434558868408
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.330 Vali Acc: 0.625 Test Loss: 1.330 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624987).  Saving model ...
Epoch: 13 cost time: 2.2416083812713623
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.324 Vali Acc: 0.611 Test Loss: 1.324 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2264504432678223
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.344 Vali Acc: 0.597 Test Loss: 1.344 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.136866807937622
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.364 Vali Acc: 0.625 Test Loss: 1.364 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3521728515625
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.625 Test Loss: 1.382 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.307300567626953
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.389 Vali Acc: 0.625 Test Loss: 1.389 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2806625366210938
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.625 Test Loss: 1.390 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2595651149749756
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.625 Test Loss: 1.392 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2908201217651367
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.625 Test Loss: 1.391 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.389441728591919
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.625 Test Loss: 1.390 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8769969940185547
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.625 Test Loss: 1.398 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.625
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5846710205078125
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.476 Vali Acc: 0.125 Test Loss: 2.476 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.4789087772369385
Epoch: 2, Steps: 7 | Train Loss: 2.325 Vali Loss: 2.353 Vali Acc: 0.222 Test Loss: 2.353 Test Acc: 0.222
Validation loss decreased (-0.124975 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 2.4346115589141846
Epoch: 3, Steps: 7 | Train Loss: 1.725 Vali Loss: 2.157 Vali Acc: 0.347 Test Loss: 2.157 Test Acc: 0.347
Validation loss decreased (-0.222199 --> -0.347201).  Saving model ...
Epoch: 4 cost time: 2.399535655975342
Epoch: 4, Steps: 7 | Train Loss: 1.144 Vali Loss: 2.089 Vali Acc: 0.278 Test Loss: 2.089 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3425607681274414
Epoch: 5, Steps: 7 | Train Loss: 0.666 Vali Loss: 2.106 Vali Acc: 0.361 Test Loss: 2.106 Test Acc: 0.361
Validation loss decreased (-0.347201 --> -0.361090).  Saving model ...
Epoch: 6 cost time: 2.290771245956421
Epoch: 6, Steps: 7 | Train Loss: 0.371 Vali Loss: 2.088 Vali Acc: 0.375 Test Loss: 2.088 Test Acc: 0.375
Validation loss decreased (-0.361090 --> -0.374979).  Saving model ...
Epoch: 7 cost time: 2.2681164741516113
Epoch: 7, Steps: 7 | Train Loss: 0.185 Vali Loss: 2.146 Vali Acc: 0.403 Test Loss: 2.146 Test Acc: 0.403
Validation loss decreased (-0.374979 --> -0.402756).  Saving model ...
Epoch: 8 cost time: 2.2909739017486572
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 2.305 Vali Acc: 0.347 Test Loss: 2.305 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.244626045227051
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 2.275 Vali Acc: 0.333 Test Loss: 2.275 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2057383060455322
Epoch: 10, Steps: 7 | Train Loss: 0.021 Vali Loss: 2.306 Vali Acc: 0.361 Test Loss: 2.306 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.27056884765625
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.462 Vali Acc: 0.389 Test Loss: 2.462 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2173259258270264
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.462 Vali Acc: 0.417 Test Loss: 2.462 Test Acc: 0.417
Validation loss decreased (-0.402756 --> -0.416642).  Saving model ...
Epoch: 13 cost time: 2.3245625495910645
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.457 Vali Acc: 0.389 Test Loss: 2.457 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.068584680557251
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.488 Vali Acc: 0.375 Test Loss: 2.488 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2190186977386475
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.501 Vali Acc: 0.375 Test Loss: 2.501 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.208491802215576
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.516 Vali Acc: 0.375 Test Loss: 2.516 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1542978286743164
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.495 Vali Acc: 0.375 Test Loss: 2.495 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2704856395721436
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.513 Vali Acc: 0.389 Test Loss: 2.513 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.283458709716797
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.521 Vali Acc: 0.389 Test Loss: 2.521 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3289382457733154
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.525 Vali Acc: 0.389 Test Loss: 2.525 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2819647789001465
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.532 Vali Acc: 0.375 Test Loss: 2.532 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.349351644515991
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.549 Vali Acc: 0.375 Test Loss: 2.549 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6391992568969727
Epoch: 1, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.485 Vali Acc: 0.111 Test Loss: 2.485 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.297698497772217
Epoch: 2, Steps: 7 | Train Loss: 2.390 Vali Loss: 2.342 Vali Acc: 0.194 Test Loss: 2.342 Test Acc: 0.194
Validation loss decreased (-0.111086 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 2.264603853225708
Epoch: 3, Steps: 7 | Train Loss: 1.890 Vali Loss: 2.103 Vali Acc: 0.278 Test Loss: 2.103 Test Acc: 0.278
Validation loss decreased (-0.194421 --> -0.277757).  Saving model ...
Epoch: 4 cost time: 2.6774890422821045
Epoch: 4, Steps: 7 | Train Loss: 1.338 Vali Loss: 1.981 Vali Acc: 0.292 Test Loss: 1.981 Test Acc: 0.292
Validation loss decreased (-0.277757 --> -0.291647).  Saving model ...
Epoch: 5 cost time: 2.428741216659546
Epoch: 5, Steps: 7 | Train Loss: 0.837 Vali Loss: 1.899 Vali Acc: 0.361 Test Loss: 1.899 Test Acc: 0.361
Validation loss decreased (-0.291647 --> -0.361092).  Saving model ...
Epoch: 6 cost time: 2.3338918685913086
Epoch: 6, Steps: 7 | Train Loss: 0.516 Vali Loss: 1.831 Vali Acc: 0.417 Test Loss: 1.831 Test Acc: 0.417
Validation loss decreased (-0.361092 --> -0.416648).  Saving model ...
Epoch: 7 cost time: 2.3912694454193115
Epoch: 7, Steps: 7 | Train Loss: 0.309 Vali Loss: 1.886 Vali Acc: 0.389 Test Loss: 1.886 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4760189056396484
Epoch: 8, Steps: 7 | Train Loss: 0.197 Vali Loss: 1.883 Vali Acc: 0.417 Test Loss: 1.883 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3828303813934326
Epoch: 9, Steps: 7 | Train Loss: 0.081 Vali Loss: 1.998 Vali Acc: 0.403 Test Loss: 1.998 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.257746458053589
Epoch: 10, Steps: 7 | Train Loss: 0.043 Vali Loss: 1.992 Vali Acc: 0.389 Test Loss: 1.992 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.500347137451172
Epoch: 11, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.100 Vali Acc: 0.375 Test Loss: 2.100 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6998605728149414
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.105 Vali Acc: 0.417 Test Loss: 2.105 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2395100593566895
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.134 Vali Acc: 0.431 Test Loss: 2.134 Test Acc: 0.431
Validation loss decreased (-0.416648 --> -0.430534).  Saving model ...
Epoch: 14 cost time: 2.323087215423584
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.201 Vali Acc: 0.431 Test Loss: 2.201 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.436633348464966
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.158 Vali Acc: 0.444 Test Loss: 2.158 Test Acc: 0.444
Validation loss decreased (-0.430534 --> -0.444423).  Saving model ...
Epoch: 16 cost time: 2.347642421722412
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.135 Vali Acc: 0.444 Test Loss: 2.135 Test Acc: 0.444
Validation loss decreased (-0.444423 --> -0.444423).  Saving model ...
Epoch: 17 cost time: 2.417905807495117
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.153 Vali Acc: 0.444 Test Loss: 2.153 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.465291976928711
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.206 Vali Acc: 0.431 Test Loss: 2.206 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.409191370010376
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.233 Vali Acc: 0.431 Test Loss: 2.233 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4574036598205566
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.247 Vali Acc: 0.444 Test Loss: 2.247 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.405625581741333
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.207 Vali Acc: 0.444 Test Loss: 2.207 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.304194211959839
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.218 Vali Acc: 0.444 Test Loss: 2.218 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.282437324523926
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.261 Vali Acc: 0.444 Test Loss: 2.261 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2709057331085205
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.254 Vali Acc: 0.444 Test Loss: 2.254 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4219911098480225
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.243 Vali Acc: 0.444 Test Loss: 2.243 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.294750213623047
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.264 Vali Acc: 0.444 Test Loss: 2.264 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8139562606811523
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.468 Vali Acc: 0.167 Test Loss: 2.468 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.6416220664978027
Epoch: 2, Steps: 7 | Train Loss: 2.452 Vali Loss: 2.333 Vali Acc: 0.194 Test Loss: 2.333 Test Acc: 0.194
Validation loss decreased (-0.166642 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 2.5337131023406982
Epoch: 3, Steps: 7 | Train Loss: 2.008 Vali Loss: 2.104 Vali Acc: 0.222 Test Loss: 2.104 Test Acc: 0.222
Validation loss decreased (-0.194421 --> -0.222201).  Saving model ...
Epoch: 4 cost time: 2.422786235809326
Epoch: 4, Steps: 7 | Train Loss: 1.507 Vali Loss: 1.978 Vali Acc: 0.361 Test Loss: 1.978 Test Acc: 0.361
Validation loss decreased (-0.222201 --> -0.361091).  Saving model ...
Epoch: 5 cost time: 2.589940309524536
Epoch: 5, Steps: 7 | Train Loss: 1.013 Vali Loss: 1.859 Vali Acc: 0.389 Test Loss: 1.859 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388870).  Saving model ...
Epoch: 6 cost time: 2.5060062408447266
Epoch: 6, Steps: 7 | Train Loss: 0.663 Vali Loss: 1.776 Vali Acc: 0.361 Test Loss: 1.776 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2207581996917725
Epoch: 7, Steps: 7 | Train Loss: 0.404 Vali Loss: 1.781 Vali Acc: 0.389 Test Loss: 1.781 Test Acc: 0.389
Validation loss decreased (-0.388870 --> -0.388871).  Saving model ...
Epoch: 8 cost time: 2.437502861022949
Epoch: 8, Steps: 7 | Train Loss: 0.251 Vali Loss: 1.707 Vali Acc: 0.389 Test Loss: 1.707 Test Acc: 0.389
Validation loss decreased (-0.388871 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 2.5363543033599854
Epoch: 9, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.671 Vali Acc: 0.417 Test Loss: 1.671 Test Acc: 0.417
Validation loss decreased (-0.388872 --> -0.416650).  Saving model ...
Epoch: 10 cost time: 2.477928400039673
Epoch: 10, Steps: 7 | Train Loss: 0.071 Vali Loss: 1.653 Vali Acc: 0.417 Test Loss: 1.653 Test Acc: 0.417
Validation loss decreased (-0.416650 --> -0.416650).  Saving model ...
Epoch: 11 cost time: 2.5549182891845703
Epoch: 11, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.718 Vali Acc: 0.389 Test Loss: 1.718 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.31264066696167
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.678 Vali Acc: 0.444 Test Loss: 1.678 Test Acc: 0.444
Validation loss decreased (-0.416650 --> -0.444428).  Saving model ...
Epoch: 13 cost time: 2.512298345565796
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.725 Vali Acc: 0.431 Test Loss: 1.725 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.556243658065796
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.761 Vali Acc: 0.417 Test Loss: 1.761 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8082218170166016
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.729 Vali Acc: 0.417 Test Loss: 1.729 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.602107048034668
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.734 Vali Acc: 0.417 Test Loss: 1.734 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7016117572784424
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.770 Vali Acc: 0.431 Test Loss: 1.770 Test Acc: 0.431
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.54099178314209
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.812 Vali Acc: 0.444 Test Loss: 1.812 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.344691276550293
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.757 Vali Acc: 0.444 Test Loss: 1.757 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.795344352722168
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.728 Vali Acc: 0.444 Test Loss: 1.728 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.341843605041504
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.757 Vali Acc: 0.444 Test Loss: 1.757 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.429178476333618
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.444 Test Loss: 1.810 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4444444444444444
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.510134220123291
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.512 Vali Acc: 0.097 Test Loss: 2.512 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.5511765480041504
Epoch: 2, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.392 Vali Acc: 0.194 Test Loss: 2.392 Test Acc: 0.194
Validation loss decreased (-0.097197 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 2.4154469966888428
Epoch: 3, Steps: 7 | Train Loss: 2.072 Vali Loss: 2.224 Vali Acc: 0.222 Test Loss: 2.224 Test Acc: 0.222
Validation loss decreased (-0.194421 --> -0.222200).  Saving model ...
Epoch: 4 cost time: 2.395541191101074
Epoch: 4, Steps: 7 | Train Loss: 1.595 Vali Loss: 2.131 Vali Acc: 0.306 Test Loss: 2.131 Test Acc: 0.306
Validation loss decreased (-0.222200 --> -0.305534).  Saving model ...
Epoch: 5 cost time: 2.602712631225586
Epoch: 5, Steps: 7 | Train Loss: 1.090 Vali Loss: 2.029 Vali Acc: 0.347 Test Loss: 2.029 Test Acc: 0.347
Validation loss decreased (-0.305534 --> -0.347202).  Saving model ...
Epoch: 6 cost time: 2.2910823822021484
Epoch: 6, Steps: 7 | Train Loss: 0.734 Vali Loss: 1.995 Vali Acc: 0.264 Test Loss: 1.995 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.481343984603882
Epoch: 7, Steps: 7 | Train Loss: 0.456 Vali Loss: 1.945 Vali Acc: 0.431 Test Loss: 1.945 Test Acc: 0.431
Validation loss decreased (-0.347202 --> -0.430536).  Saving model ...
Epoch: 8 cost time: 2.331653356552124
Epoch: 8, Steps: 7 | Train Loss: 0.260 Vali Loss: 1.900 Vali Acc: 0.417 Test Loss: 1.900 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7944765090942383
Epoch: 9, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.911 Vali Acc: 0.375 Test Loss: 1.911 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.401240825653076
Epoch: 10, Steps: 7 | Train Loss: 0.066 Vali Loss: 1.857 Vali Acc: 0.431 Test Loss: 1.857 Test Acc: 0.431
Validation loss decreased (-0.430536 --> -0.430537).  Saving model ...
Epoch: 11 cost time: 2.447395086288452
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.021 Vali Acc: 0.375 Test Loss: 2.021 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.352477550506592
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.931 Vali Acc: 0.417 Test Loss: 1.931 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2755022048950195
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.888 Vali Acc: 0.431 Test Loss: 1.888 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.241044282913208
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.965 Vali Acc: 0.403 Test Loss: 1.965 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2907047271728516
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.075 Vali Acc: 0.403 Test Loss: 2.075 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5501184463500977
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.067 Vali Acc: 0.403 Test Loss: 2.067 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3806142807006836
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.031 Vali Acc: 0.403 Test Loss: 2.031 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.639887809753418
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.044 Vali Acc: 0.403 Test Loss: 2.044 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4806249141693115
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.016 Vali Acc: 0.403 Test Loss: 2.016 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4539146423339844
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.008 Vali Acc: 0.403 Test Loss: 2.008 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3990659713745117
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.508 Vali Acc: 0.111 Test Loss: 2.508 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.4800643920898438
Epoch: 2, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.417 Vali Acc: 0.208 Test Loss: 2.417 Test Acc: 0.208
Validation loss decreased (-0.111086 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 2.5059149265289307
Epoch: 3, Steps: 7 | Train Loss: 2.168 Vali Loss: 2.283 Vali Acc: 0.181 Test Loss: 2.283 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.416834831237793
Epoch: 4, Steps: 7 | Train Loss: 1.884 Vali Loss: 2.271 Vali Acc: 0.181 Test Loss: 2.271 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4438252449035645
Epoch: 5, Steps: 7 | Train Loss: 1.458 Vali Loss: 2.217 Vali Acc: 0.278 Test Loss: 2.217 Test Acc: 0.278
Validation loss decreased (-0.208309 --> -0.277756).  Saving model ...
Epoch: 6 cost time: 2.3754782676696777
Epoch: 6, Steps: 7 | Train Loss: 1.118 Vali Loss: 2.183 Vali Acc: 0.208 Test Loss: 2.183 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5025110244750977
Epoch: 7, Steps: 7 | Train Loss: 0.826 Vali Loss: 2.154 Vali Acc: 0.347 Test Loss: 2.154 Test Acc: 0.347
Validation loss decreased (-0.277756 --> -0.347201).  Saving model ...
Epoch: 8 cost time: 2.4842283725738525
Epoch: 8, Steps: 7 | Train Loss: 0.555 Vali Loss: 2.130 Vali Acc: 0.278 Test Loss: 2.130 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3472514152526855
Epoch: 9, Steps: 7 | Train Loss: 0.341 Vali Loss: 2.139 Vali Acc: 0.306 Test Loss: 2.139 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4975509643554688
Epoch: 10, Steps: 7 | Train Loss: 0.232 Vali Loss: 2.072 Vali Acc: 0.306 Test Loss: 2.072 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.124251365661621
Epoch: 11, Steps: 7 | Train Loss: 0.143 Vali Loss: 2.000 Vali Acc: 0.403 Test Loss: 2.000 Test Acc: 0.403
Validation loss decreased (-0.347201 --> -0.402758).  Saving model ...
Epoch: 12 cost time: 2.4404137134552
Epoch: 12, Steps: 7 | Train Loss: 0.095 Vali Loss: 2.027 Vali Acc: 0.389 Test Loss: 2.027 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1560373306274414
Epoch: 13, Steps: 7 | Train Loss: 0.055 Vali Loss: 2.111 Vali Acc: 0.278 Test Loss: 2.111 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.129133939743042
Epoch: 14, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.069 Vali Acc: 0.361 Test Loss: 2.069 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.194883108139038
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.010 Vali Acc: 0.389 Test Loss: 2.010 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4300220012664795
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.040 Vali Acc: 0.361 Test Loss: 2.040 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2955517768859863
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.061 Vali Acc: 0.389 Test Loss: 2.061 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.313288450241089
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.061 Vali Acc: 0.389 Test Loss: 2.061 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2630722522735596
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.034 Vali Acc: 0.417 Test Loss: 2.034 Test Acc: 0.417
Validation loss decreased (-0.402758 --> -0.416646).  Saving model ...
Epoch: 20 cost time: 2.199270248413086
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.023 Vali Acc: 0.403 Test Loss: 2.023 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.379653215408325
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.030 Vali Acc: 0.417 Test Loss: 2.030 Test Acc: 0.417
Validation loss decreased (-0.416646 --> -0.416646).  Saving model ...
Epoch: 22 cost time: 2.0532946586608887
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.080 Vali Acc: 0.417 Test Loss: 2.080 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3528571128845215
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.101 Vali Acc: 0.417 Test Loss: 2.101 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.317875623703003
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.094 Vali Acc: 0.417 Test Loss: 2.094 Test Acc: 0.417
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.306401491165161
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.089 Vali Acc: 0.375 Test Loss: 2.089 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4196982383728027
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.060 Vali Acc: 0.417 Test Loss: 2.060 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4862959384918213
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.096 Vali Acc: 0.431 Test Loss: 2.096 Test Acc: 0.431
Validation loss decreased (-0.416646 --> -0.430535).  Saving model ...
Epoch: 28 cost time: 2.492685317993164
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.099 Vali Acc: 0.417 Test Loss: 2.099 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4675533771514893
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.132 Vali Acc: 0.389 Test Loss: 2.132 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.455103635787964
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.149 Vali Acc: 0.431 Test Loss: 2.149 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.575448751449585
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.160 Vali Acc: 0.417 Test Loss: 2.160 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.5466206073760986
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.128 Vali Acc: 0.417 Test Loss: 2.128 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.4110515117645264
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.130 Vali Acc: 0.403 Test Loss: 2.130 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.301269054412842
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.145 Vali Acc: 0.403 Test Loss: 2.145 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.2621357440948486
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.154 Vali Acc: 0.403 Test Loss: 2.154 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.270050287246704
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.163 Vali Acc: 0.403 Test Loss: 2.163 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.3409628868103027
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.196 Vali Acc: 0.417 Test Loss: 2.196 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.511061191558838
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.593 Vali Acc: 0.042 Test Loss: 2.593 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 2.2424983978271484
Epoch: 2, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.460 Vali Acc: 0.194 Test Loss: 2.460 Test Acc: 0.194
Validation loss decreased (-0.041641 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 2.2730886936187744
Epoch: 3, Steps: 7 | Train Loss: 2.213 Vali Loss: 2.363 Vali Acc: 0.264 Test Loss: 2.363 Test Acc: 0.264
Validation loss decreased (-0.194420 --> -0.263865).  Saving model ...
Epoch: 4 cost time: 2.1317636966705322
Epoch: 4, Steps: 7 | Train Loss: 1.924 Vali Loss: 2.392 Vali Acc: 0.222 Test Loss: 2.392 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.225006341934204
Epoch: 5, Steps: 7 | Train Loss: 1.589 Vali Loss: 2.341 Vali Acc: 0.139 Test Loss: 2.341 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2506163120269775
Epoch: 6, Steps: 7 | Train Loss: 1.291 Vali Loss: 2.242 Vali Acc: 0.250 Test Loss: 2.242 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.273491144180298
Epoch: 7, Steps: 7 | Train Loss: 1.019 Vali Loss: 2.147 Vali Acc: 0.181 Test Loss: 2.147 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.223757028579712
Epoch: 8, Steps: 7 | Train Loss: 0.770 Vali Loss: 2.148 Vali Acc: 0.194 Test Loss: 2.148 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2584357261657715
Epoch: 9, Steps: 7 | Train Loss: 0.575 Vali Loss: 2.059 Vali Acc: 0.222 Test Loss: 2.059 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.286172866821289
Epoch: 10, Steps: 7 | Train Loss: 0.431 Vali Loss: 2.099 Vali Acc: 0.167 Test Loss: 2.099 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3250181674957275
Epoch: 11, Steps: 7 | Train Loss: 0.294 Vali Loss: 2.016 Vali Acc: 0.250 Test Loss: 2.016 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.259036064147949
Epoch: 12, Steps: 7 | Train Loss: 0.219 Vali Loss: 2.133 Vali Acc: 0.292 Test Loss: 2.133 Test Acc: 0.292
Validation loss decreased (-0.263865 --> -0.291645).  Saving model ...
Epoch: 13 cost time: 2.1737070083618164
Epoch: 13, Steps: 7 | Train Loss: 0.149 Vali Loss: 2.165 Vali Acc: 0.194 Test Loss: 2.165 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.25604248046875
Epoch: 14, Steps: 7 | Train Loss: 0.091 Vali Loss: 2.341 Vali Acc: 0.222 Test Loss: 2.341 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.253380060195923
Epoch: 15, Steps: 7 | Train Loss: 0.082 Vali Loss: 2.239 Vali Acc: 0.236 Test Loss: 2.239 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.101999044418335
Epoch: 16, Steps: 7 | Train Loss: 0.059 Vali Loss: 2.127 Vali Acc: 0.250 Test Loss: 2.127 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1727421283721924
Epoch: 17, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.301 Vali Acc: 0.250 Test Loss: 2.301 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1104371547698975
Epoch: 18, Steps: 7 | Train Loss: 0.027 Vali Loss: 2.526 Vali Acc: 0.194 Test Loss: 2.526 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1976563930511475
Epoch: 19, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.482 Vali Acc: 0.208 Test Loss: 2.482 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.324594020843506
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.568 Vali Acc: 0.208 Test Loss: 2.568 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2349495887756348
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.504 Vali Acc: 0.278 Test Loss: 2.504 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2203118801116943
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.528 Vali Acc: 0.236 Test Loss: 2.528 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.2916666666666667
model parameter : 551916
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         599                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5963661670684814
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.372 Vali Acc: 0.208 Test Loss: 2.372 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.3977420330047607
Epoch: 2, Steps: 7 | Train Loss: 1.952 Vali Loss: 1.654 Vali Acc: 0.556 Test Loss: 1.654 Test Acc: 0.556
Validation loss decreased (-0.208310 --> -0.555539).  Saving model ...
Epoch: 3 cost time: 2.3742637634277344
Epoch: 3, Steps: 7 | Train Loss: 1.041 Vali Loss: 1.112 Vali Acc: 0.722 Test Loss: 1.112 Test Acc: 0.722
Validation loss decreased (-0.555539 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 2.3862459659576416
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.943 Vali Acc: 0.764 Test Loss: 0.943 Test Acc: 0.764
Validation loss decreased (-0.722211 --> -0.763879).  Saving model ...
Epoch: 5 cost time: 2.5445375442504883
Epoch: 5, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.870 Vali Acc: 0.764 Test Loss: 0.870 Test Acc: 0.764
Validation loss decreased (-0.763879 --> -0.763880).  Saving model ...
Epoch: 6 cost time: 2.4488697052001953
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
Validation loss decreased (-0.763880 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 2.519171953201294
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.924 Vali Acc: 0.819 Test Loss: 0.924 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9959628582000732
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.931 Vali Acc: 0.806 Test Loss: 0.931 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.539268970489502
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.884 Vali Acc: 0.833 Test Loss: 0.884 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6395294666290283
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.864 Vali Acc: 0.847 Test Loss: 0.864 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847214).  Saving model ...
Epoch: 11 cost time: 2.5755128860473633
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.862 Vali Acc: 0.819 Test Loss: 0.862 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.48869252204895
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.833 Test Loss: 0.869 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3823649883270264
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3343007564544678
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.819 Test Loss: 0.870 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3911850452423096
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.819 Test Loss: 0.870 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4172134399414062
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.819 Test Loss: 0.869 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4335312843322754
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.819 Test Loss: 0.870 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.507559061050415
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.819 Test Loss: 0.874 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5026309490203857
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.819 Test Loss: 0.872 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3619463443756104
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.819 Test Loss: 0.875 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8472222222222222
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         479                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma479_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3852484226226807
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.419 Vali Acc: 0.208 Test Loss: 2.419 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.283445358276367
Epoch: 2, Steps: 7 | Train Loss: 2.064 Vali Loss: 1.822 Vali Acc: 0.542 Test Loss: 1.822 Test Acc: 0.542
Validation loss decreased (-0.208309 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 2.283877372741699
Epoch: 3, Steps: 7 | Train Loss: 1.225 Vali Loss: 1.306 Vali Acc: 0.681 Test Loss: 1.306 Test Acc: 0.681
Validation loss decreased (-0.541648 --> -0.680542).  Saving model ...
Epoch: 4 cost time: 2.1275744438171387
Epoch: 4, Steps: 7 | Train Loss: 0.578 Vali Loss: 1.062 Vali Acc: 0.736 Test Loss: 1.062 Test Acc: 0.736
Validation loss decreased (-0.680542 --> -0.736100).  Saving model ...
Epoch: 5 cost time: 2.209592342376709
Epoch: 5, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.914 Vali Acc: 0.778 Test Loss: 0.914 Test Acc: 0.778
Validation loss decreased (-0.736100 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 2.278898000717163
Epoch: 6, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.844 Vali Acc: 0.736 Test Loss: 0.844 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2759757041931152
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 1.015 Vali Acc: 0.736 Test Loss: 1.015 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.348816156387329
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.962 Vali Acc: 0.736 Test Loss: 0.962 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2985994815826416
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.912 Vali Acc: 0.736 Test Loss: 0.912 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1547598838806152
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.736 Test Loss: 0.902 Test Acc: 0.736
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5904734134674072
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.736 Test Loss: 0.910 Test Acc: 0.736
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.414029598236084
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.736 Test Loss: 0.915 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3412861824035645
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.736 Test Loss: 0.912 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4847042560577393
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.404332399368286
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma479_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7777777777777778
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6371266841888428
Epoch: 1, Steps: 7 | Train Loss: 2.592 Vali Loss: 2.433 Vali Acc: 0.139 Test Loss: 2.433 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.4727783203125
Epoch: 2, Steps: 7 | Train Loss: 2.149 Vali Loss: 1.993 Vali Acc: 0.389 Test Loss: 1.993 Test Acc: 0.389
Validation loss decreased (-0.138865 --> -0.388869).  Saving model ...
Epoch: 3 cost time: 2.443894386291504
Epoch: 3, Steps: 7 | Train Loss: 1.391 Vali Loss: 1.541 Vali Acc: 0.569 Test Loss: 1.541 Test Acc: 0.569
Validation loss decreased (-0.388869 --> -0.569429).  Saving model ...
Epoch: 4 cost time: 2.743180990219116
Epoch: 4, Steps: 7 | Train Loss: 0.747 Vali Loss: 1.308 Vali Acc: 0.667 Test Loss: 1.308 Test Acc: 0.667
Validation loss decreased (-0.569429 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 2.417315721511841
Epoch: 5, Steps: 7 | Train Loss: 0.354 Vali Loss: 1.173 Vali Acc: 0.639 Test Loss: 1.173 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4150028228759766
Epoch: 6, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.011 Vali Acc: 0.708 Test Loss: 1.011 Test Acc: 0.708
Validation loss decreased (-0.666654 --> -0.708323).  Saving model ...
Epoch: 7 cost time: 2.580169677734375
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 1.062 Vali Acc: 0.681 Test Loss: 1.062 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.378066062927246
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.989 Vali Acc: 0.694 Test Loss: 0.989 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3869881629943848
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.980 Vali Acc: 0.694 Test Loss: 0.980 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4558451175689697
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
Validation loss decreased (-0.708323 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 2.3299760818481445
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 2.485896587371826
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.934 Vali Acc: 0.736 Test Loss: 0.934 Test Acc: 0.736
Validation loss decreased (-0.722213 --> -0.736102).  Saving model ...
Epoch: 13 cost time: 2.503725290298462
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4310245513916016
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.736 Test Loss: 0.927 Test Acc: 0.736
Validation loss decreased (-0.736102 --> -0.736102).  Saving model ...
Epoch: 15 cost time: 2.578871965408325
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4580540657043457
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.722 Test Loss: 0.942 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4846768379211426
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.63590931892395
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.909548759460449
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7117528915405273
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.722 Test Loss: 0.952 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4137661457061768
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.722 Test Loss: 0.952 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3737447261810303
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.722 Test Loss: 0.945 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.281812906265259
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.722 Test Loss: 0.946 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.595580577850342
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.722 Test Loss: 0.950 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.7361111111111112
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         240                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.834620475769043
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.430 Vali Acc: 0.181 Test Loss: 2.430 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.5440752506256104
Epoch: 2, Steps: 7 | Train Loss: 2.223 Vali Loss: 2.145 Vali Acc: 0.292 Test Loss: 2.145 Test Acc: 0.292
Validation loss decreased (-0.180531 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 2.2812883853912354
Epoch: 3, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.821 Vali Acc: 0.458 Test Loss: 1.821 Test Acc: 0.458
Validation loss decreased (-0.291645 --> -0.458315).  Saving model ...
Epoch: 4 cost time: 2.481621026992798
Epoch: 4, Steps: 7 | Train Loss: 0.911 Vali Loss: 1.664 Vali Acc: 0.542 Test Loss: 1.664 Test Acc: 0.542
Validation loss decreased (-0.458315 --> -0.541650).  Saving model ...
Epoch: 5 cost time: 2.494065761566162
Epoch: 5, Steps: 7 | Train Loss: 0.476 Vali Loss: 1.548 Vali Acc: 0.514 Test Loss: 1.548 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6238365173339844
Epoch: 6, Steps: 7 | Train Loss: 0.232 Vali Loss: 1.449 Vali Acc: 0.569 Test Loss: 1.449 Test Acc: 0.569
Validation loss decreased (-0.541650 --> -0.569430).  Saving model ...
Epoch: 7 cost time: 2.4645345211029053
Epoch: 7, Steps: 7 | Train Loss: 0.076 Vali Loss: 1.456 Vali Acc: 0.556 Test Loss: 1.456 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6708221435546875
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.425 Vali Acc: 0.556 Test Loss: 1.425 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.714698314666748
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.525 Vali Acc: 0.583 Test Loss: 1.525 Test Acc: 0.583
Validation loss decreased (-0.569430 --> -0.583318).  Saving model ...
Epoch: 10 cost time: 2.7320311069488525
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.529 Vali Acc: 0.569 Test Loss: 1.529 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3742377758026123
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.473 Vali Acc: 0.597 Test Loss: 1.473 Test Acc: 0.597
Validation loss decreased (-0.583318 --> -0.597207).  Saving model ...
Epoch: 12 cost time: 2.6366183757781982
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.441 Vali Acc: 0.583 Test Loss: 1.441 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2781994342803955
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.439 Vali Acc: 0.597 Test Loss: 1.439 Test Acc: 0.597
Validation loss decreased (-0.597207 --> -0.597208).  Saving model ...
Epoch: 14 cost time: 2.22417950630188
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.453 Vali Acc: 0.611 Test Loss: 1.453 Test Acc: 0.611
Validation loss decreased (-0.597208 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 2.339306592941284
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.470 Vali Acc: 0.597 Test Loss: 1.470 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.339909553527832
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.488 Vali Acc: 0.583 Test Loss: 1.488 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4020297527313232
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.502 Vali Acc: 0.597 Test Loss: 1.502 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3789947032928467
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.597 Test Loss: 1.515 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4153170585632324
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.597 Test Loss: 1.515 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.443819284439087
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.597 Test Loss: 1.522 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1518938541412354
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.597 Test Loss: 1.532 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2524776458740234
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.611 Test Loss: 1.529 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5805745124816895
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.611 Test Loss: 1.524 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2748265266418457
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.611 Test Loss: 1.526 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.6111111111111112
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9350168704986572
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.509 Vali Acc: 0.083 Test Loss: 2.509 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.6038925647735596
Epoch: 2, Steps: 7 | Train Loss: 2.284 Vali Loss: 2.346 Vali Acc: 0.139 Test Loss: 2.346 Test Acc: 0.139
Validation loss decreased (-0.083308 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 2.6360020637512207
Epoch: 3, Steps: 7 | Train Loss: 1.771 Vali Loss: 2.136 Vali Acc: 0.306 Test Loss: 2.136 Test Acc: 0.306
Validation loss decreased (-0.138865 --> -0.305534).  Saving model ...
Epoch: 4 cost time: 2.566662549972534
Epoch: 4, Steps: 7 | Train Loss: 1.135 Vali Loss: 2.068 Vali Acc: 0.389 Test Loss: 2.068 Test Acc: 0.389
Validation loss decreased (-0.305534 --> -0.388868).  Saving model ...
Epoch: 5 cost time: 2.4509153366088867
Epoch: 5, Steps: 7 | Train Loss: 0.662 Vali Loss: 2.027 Vali Acc: 0.361 Test Loss: 2.027 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.350597381591797
Epoch: 6, Steps: 7 | Train Loss: 0.376 Vali Loss: 2.076 Vali Acc: 0.375 Test Loss: 2.076 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.517453670501709
Epoch: 7, Steps: 7 | Train Loss: 0.176 Vali Loss: 2.129 Vali Acc: 0.375 Test Loss: 2.129 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.400592803955078
Epoch: 8, Steps: 7 | Train Loss: 0.089 Vali Loss: 2.174 Vali Acc: 0.417 Test Loss: 2.174 Test Acc: 0.417
Validation loss decreased (-0.388868 --> -0.416645).  Saving model ...
Epoch: 9 cost time: 2.365854501724243
Epoch: 9, Steps: 7 | Train Loss: 0.041 Vali Loss: 2.404 Vali Acc: 0.361 Test Loss: 2.404 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.611264944076538
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.334 Vali Acc: 0.375 Test Loss: 2.334 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.386460304260254
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.257 Vali Acc: 0.403 Test Loss: 2.257 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.217400550842285
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.322 Vali Acc: 0.375 Test Loss: 2.322 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6973960399627686
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.367 Vali Acc: 0.375 Test Loss: 2.367 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3760826587677
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.407 Vali Acc: 0.389 Test Loss: 2.407 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5493431091308594
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.414 Vali Acc: 0.389 Test Loss: 2.414 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9620888233184814
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.413 Vali Acc: 0.403 Test Loss: 2.413 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.205685615539551
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.403 Vali Acc: 0.389 Test Loss: 2.403 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.554859161376953
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.416 Vali Acc: 0.375 Test Loss: 2.416 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8333725929260254
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.501 Vali Acc: 0.097 Test Loss: 2.501 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.3800885677337646
Epoch: 2, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.312 Vali Acc: 0.153 Test Loss: 2.312 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152755).  Saving model ...
Epoch: 3 cost time: 2.3854708671569824
Epoch: 3, Steps: 7 | Train Loss: 1.867 Vali Loss: 2.090 Vali Acc: 0.347 Test Loss: 2.090 Test Acc: 0.347
Validation loss decreased (-0.152755 --> -0.347201).  Saving model ...
Epoch: 4 cost time: 2.508082628250122
Epoch: 4, Steps: 7 | Train Loss: 1.301 Vali Loss: 2.011 Vali Acc: 0.500 Test Loss: 2.011 Test Acc: 0.500
Validation loss decreased (-0.347201 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 2.4478650093078613
Epoch: 5, Steps: 7 | Train Loss: 0.868 Vali Loss: 1.910 Vali Acc: 0.347 Test Loss: 1.910 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5152225494384766
Epoch: 6, Steps: 7 | Train Loss: 0.550 Vali Loss: 1.889 Vali Acc: 0.417 Test Loss: 1.889 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.308818817138672
Epoch: 7, Steps: 7 | Train Loss: 0.305 Vali Loss: 1.933 Vali Acc: 0.403 Test Loss: 1.933 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3575527667999268
Epoch: 8, Steps: 7 | Train Loss: 0.194 Vali Loss: 1.948 Vali Acc: 0.403 Test Loss: 1.948 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3138225078582764
Epoch: 9, Steps: 7 | Train Loss: 0.107 Vali Loss: 2.037 Vali Acc: 0.417 Test Loss: 2.037 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3425302505493164
Epoch: 10, Steps: 7 | Train Loss: 0.062 Vali Loss: 2.044 Vali Acc: 0.417 Test Loss: 2.044 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2860219478607178
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.124 Vali Acc: 0.375 Test Loss: 2.124 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.294279098510742
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.087 Vali Acc: 0.417 Test Loss: 2.087 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4368958473205566
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.052 Vali Acc: 0.444 Test Loss: 2.052 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3049657344818115
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.164 Vali Acc: 0.431 Test Loss: 2.164 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.5
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7278120517730713
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.512 Vali Acc: 0.069 Test Loss: 2.512 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.424368143081665
Epoch: 2, Steps: 7 | Train Loss: 2.346 Vali Loss: 2.329 Vali Acc: 0.083 Test Loss: 2.329 Test Acc: 0.083
Validation loss decreased (-0.069419 --> -0.083310).  Saving model ...
Epoch: 3 cost time: 2.6062545776367188
Epoch: 3, Steps: 7 | Train Loss: 1.956 Vali Loss: 2.120 Vali Acc: 0.250 Test Loss: 2.120 Test Acc: 0.250
Validation loss decreased (-0.083310 --> -0.249979).  Saving model ...
Epoch: 4 cost time: 2.8339293003082275
Epoch: 4, Steps: 7 | Train Loss: 1.425 Vali Loss: 2.001 Vali Acc: 0.431 Test Loss: 2.001 Test Acc: 0.431
Validation loss decreased (-0.249979 --> -0.430536).  Saving model ...
Epoch: 5 cost time: 2.482478380203247
Epoch: 5, Steps: 7 | Train Loss: 1.007 Vali Loss: 1.894 Vali Acc: 0.389 Test Loss: 1.894 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5119011402130127
Epoch: 6, Steps: 7 | Train Loss: 0.671 Vali Loss: 1.827 Vali Acc: 0.347 Test Loss: 1.827 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.351600408554077
Epoch: 7, Steps: 7 | Train Loss: 0.385 Vali Loss: 1.831 Vali Acc: 0.389 Test Loss: 1.831 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.483595371246338
Epoch: 8, Steps: 7 | Train Loss: 0.250 Vali Loss: 1.779 Vali Acc: 0.403 Test Loss: 1.779 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.594681978225708
Epoch: 9, Steps: 7 | Train Loss: 0.137 Vali Loss: 1.725 Vali Acc: 0.375 Test Loss: 1.725 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.549771785736084
Epoch: 10, Steps: 7 | Train Loss: 0.079 Vali Loss: 1.883 Vali Acc: 0.417 Test Loss: 1.883 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4464361667633057
Epoch: 11, Steps: 7 | Train Loss: 0.046 Vali Loss: 1.739 Vali Acc: 0.375 Test Loss: 1.739 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.306723117828369
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 1.817 Vali Acc: 0.417 Test Loss: 1.817 Test Acc: 0.417
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.300856590270996
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.801 Vali Acc: 0.417 Test Loss: 1.801 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3554012775421143
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.875 Vali Acc: 0.417 Test Loss: 1.875 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4305555555555556
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         24                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.625990867614746
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.534 Vali Acc: 0.042 Test Loss: 2.534 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 2.5295052528381348
Epoch: 2, Steps: 7 | Train Loss: 2.361 Vali Loss: 2.399 Vali Acc: 0.111 Test Loss: 2.399 Test Acc: 0.111
Validation loss decreased (-0.041641 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 2.3704683780670166
Epoch: 3, Steps: 7 | Train Loss: 1.986 Vali Loss: 2.233 Vali Acc: 0.208 Test Loss: 2.233 Test Acc: 0.208
Validation loss decreased (-0.111087 --> -0.208311).  Saving model ...
Epoch: 4 cost time: 2.2963340282440186
Epoch: 4, Steps: 7 | Train Loss: 1.497 Vali Loss: 2.129 Vali Acc: 0.347 Test Loss: 2.129 Test Acc: 0.347
Validation loss decreased (-0.208311 --> -0.347201).  Saving model ...
Epoch: 5 cost time: 2.4872710704803467
Epoch: 5, Steps: 7 | Train Loss: 1.085 Vali Loss: 2.085 Vali Acc: 0.292 Test Loss: 2.085 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3103134632110596
Epoch: 6, Steps: 7 | Train Loss: 0.755 Vali Loss: 1.980 Vali Acc: 0.306 Test Loss: 1.980 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.304959535598755
Epoch: 7, Steps: 7 | Train Loss: 0.441 Vali Loss: 2.093 Vali Acc: 0.347 Test Loss: 2.093 Test Acc: 0.347
Validation loss decreased (-0.347201 --> -0.347201).  Saving model ...
Epoch: 8 cost time: 2.543508529663086
Epoch: 8, Steps: 7 | Train Loss: 0.276 Vali Loss: 1.922 Vali Acc: 0.319 Test Loss: 1.922 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4094698429107666
Epoch: 9, Steps: 7 | Train Loss: 0.142 Vali Loss: 1.989 Vali Acc: 0.375 Test Loss: 1.989 Test Acc: 0.375
Validation loss decreased (-0.347201 --> -0.374980).  Saving model ...
Epoch: 10 cost time: 2.5610249042510986
Epoch: 10, Steps: 7 | Train Loss: 0.083 Vali Loss: 2.031 Vali Acc: 0.347 Test Loss: 2.031 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.551785945892334
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 2.087 Vali Acc: 0.361 Test Loss: 2.087 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.494913339614868
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 2.136 Vali Acc: 0.361 Test Loss: 2.136 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5576465129852295
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.994 Vali Acc: 0.347 Test Loss: 1.994 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4612412452697754
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.062 Vali Acc: 0.375 Test Loss: 2.062 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4914944171905518
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.145 Vali Acc: 0.361 Test Loss: 2.145 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.381553888320923
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.151 Vali Acc: 0.375 Test Loss: 2.151 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4217917919158936
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.130 Vali Acc: 0.375 Test Loss: 2.130 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.506821632385254
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.140 Vali Acc: 0.361 Test Loss: 2.140 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5764245986938477
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 2.112 Vali Acc: 0.361 Test Loss: 2.112 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.375
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7063558101654053
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.524 Vali Acc: 0.083 Test Loss: 2.524 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.372107744216919
Epoch: 2, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.410 Vali Acc: 0.208 Test Loss: 2.410 Test Acc: 0.208
Validation loss decreased (-0.083308 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 2.22200870513916
Epoch: 3, Steps: 7 | Train Loss: 2.130 Vali Loss: 2.312 Vali Acc: 0.208 Test Loss: 2.312 Test Acc: 0.208
Validation loss decreased (-0.208309 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 2.362762689590454
Epoch: 4, Steps: 7 | Train Loss: 1.730 Vali Loss: 2.235 Vali Acc: 0.292 Test Loss: 2.235 Test Acc: 0.292
Validation loss decreased (-0.208310 --> -0.291644).  Saving model ...
Epoch: 5 cost time: 2.7059555053710938
Epoch: 5, Steps: 7 | Train Loss: 1.423 Vali Loss: 2.308 Vali Acc: 0.208 Test Loss: 2.308 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3589606285095215
Epoch: 6, Steps: 7 | Train Loss: 1.123 Vali Loss: 2.177 Vali Acc: 0.319 Test Loss: 2.177 Test Acc: 0.319
Validation loss decreased (-0.291644 --> -0.319423).  Saving model ...
Epoch: 7 cost time: 2.4542574882507324
Epoch: 7, Steps: 7 | Train Loss: 0.806 Vali Loss: 2.295 Vali Acc: 0.306 Test Loss: 2.295 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4805409908294678
Epoch: 8, Steps: 7 | Train Loss: 0.565 Vali Loss: 2.077 Vali Acc: 0.306 Test Loss: 2.077 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6741607189178467
Epoch: 9, Steps: 7 | Train Loss: 0.369 Vali Loss: 2.216 Vali Acc: 0.347 Test Loss: 2.216 Test Acc: 0.347
Validation loss decreased (-0.319423 --> -0.347200).  Saving model ...
Epoch: 10 cost time: 2.5295848846435547
Epoch: 10, Steps: 7 | Train Loss: 0.236 Vali Loss: 2.222 Vali Acc: 0.236 Test Loss: 2.222 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7636146545410156
Epoch: 11, Steps: 7 | Train Loss: 0.159 Vali Loss: 2.149 Vali Acc: 0.306 Test Loss: 2.149 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2790307998657227
Epoch: 12, Steps: 7 | Train Loss: 0.108 Vali Loss: 2.233 Vali Acc: 0.417 Test Loss: 2.233 Test Acc: 0.417
Validation loss decreased (-0.347200 --> -0.416644).  Saving model ...
Epoch: 13 cost time: 2.4620654582977295
Epoch: 13, Steps: 7 | Train Loss: 0.075 Vali Loss: 2.210 Vali Acc: 0.292 Test Loss: 2.210 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5045106410980225
Epoch: 14, Steps: 7 | Train Loss: 0.042 Vali Loss: 2.362 Vali Acc: 0.319 Test Loss: 2.362 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3517260551452637
Epoch: 15, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.254 Vali Acc: 0.361 Test Loss: 2.254 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2502224445343018
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 2.170 Vali Acc: 0.333 Test Loss: 2.170 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2916290760040283
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 2.220 Vali Acc: 0.319 Test Loss: 2.220 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.387082815170288
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.251 Vali Acc: 0.389 Test Loss: 2.251 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4336321353912354
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.214 Vali Acc: 0.375 Test Loss: 2.214 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5063037872314453
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.250 Vali Acc: 0.333 Test Loss: 2.250 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.475507974624634
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.242 Vali Acc: 0.319 Test Loss: 2.242 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.236980438232422
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.218 Vali Acc: 0.333 Test Loss: 2.218 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.4166666666666667
model parameter : 527340
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
fourier enhanced block used!
modes=32, index=[1, 28, 32, 46, 52, 60, 73, 124, 158, 167, 226, 258, 264, 271, 284, 309, 312, 313, 325, 373, 383, 426, 456, 464, 467, 490, 491, 529, 530, 532, 565, 568]
fourier enhanced block used!
modes=32, index=[13, 18, 20, 32, 38, 61, 62, 63, 67, 70, 74, 79, 85, 86, 93, 113, 132, 159, 178, 179, 182, 194, 197, 204, 218, 237, 243, 251, 269, 289, 290, 294]
 fourier enhanced cross attention used!
modes_q=32, index_q=[10, 15, 26, 28, 32, 43, 44, 47, 56, 61, 65, 89, 92, 94, 105, 119, 125, 133, 135, 141, 145, 151, 178, 194, 205, 213, 232, 261, 282, 283, 285, 291]
modes_kv=32, index_kv=[7, 37, 48, 49, 65, 77, 79, 89, 105, 117, 145, 147, 155, 157, 160, 222, 256, 257, 273, 320, 324, 354, 398, 417, 438, 442, 486, 488, 491, 499, 566, 595]
>>>>>>>start training : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7200512886047363
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.549 Vali Acc: 0.028 Test Loss: 2.549 Test Acc: 0.028
Validation loss decreased (inf --> -0.027752).  Saving model ...
Epoch: 2 cost time: 2.346689462661743
Epoch: 2, Steps: 7 | Train Loss: 2.388 Vali Loss: 2.427 Vali Acc: 0.125 Test Loss: 2.427 Test Acc: 0.125
Validation loss decreased (-0.027752 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.427501678466797
Epoch: 3, Steps: 7 | Train Loss: 2.186 Vali Loss: 2.388 Vali Acc: 0.139 Test Loss: 2.388 Test Acc: 0.139
Validation loss decreased (-0.124976 --> -0.138865).  Saving model ...
Epoch: 4 cost time: 2.2794442176818848
Epoch: 4, Steps: 7 | Train Loss: 1.826 Vali Loss: 2.339 Vali Acc: 0.167 Test Loss: 2.339 Test Acc: 0.167
Validation loss decreased (-0.138865 --> -0.166643).  Saving model ...
Epoch: 5 cost time: 2.336477756500244
Epoch: 5, Steps: 7 | Train Loss: 1.550 Vali Loss: 2.429 Vali Acc: 0.181 Test Loss: 2.429 Test Acc: 0.181
Validation loss decreased (-0.166643 --> -0.180531).  Saving model ...
Epoch: 6 cost time: 2.3780486583709717
Epoch: 6, Steps: 7 | Train Loss: 1.312 Vali Loss: 2.237 Vali Acc: 0.236 Test Loss: 2.237 Test Acc: 0.236
Validation loss decreased (-0.180531 --> -0.236089).  Saving model ...
Epoch: 7 cost time: 2.447631597518921
Epoch: 7, Steps: 7 | Train Loss: 1.007 Vali Loss: 2.303 Vali Acc: 0.208 Test Loss: 2.303 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.337728500366211
Epoch: 8, Steps: 7 | Train Loss: 0.757 Vali Loss: 2.153 Vali Acc: 0.181 Test Loss: 2.153 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2355129718780518
Epoch: 9, Steps: 7 | Train Loss: 0.573 Vali Loss: 2.147 Vali Acc: 0.194 Test Loss: 2.147 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.310347080230713
Epoch: 10, Steps: 7 | Train Loss: 0.420 Vali Loss: 2.187 Vali Acc: 0.222 Test Loss: 2.187 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2179508209228516
Epoch: 11, Steps: 7 | Train Loss: 0.288 Vali Loss: 2.323 Vali Acc: 0.264 Test Loss: 2.323 Test Acc: 0.264
Validation loss decreased (-0.236089 --> -0.263866).  Saving model ...
Epoch: 12 cost time: 2.249828815460205
Epoch: 12, Steps: 7 | Train Loss: 0.197 Vali Loss: 2.274 Vali Acc: 0.208 Test Loss: 2.274 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2687785625457764
Epoch: 13, Steps: 7 | Train Loss: 0.173 Vali Loss: 2.337 Vali Acc: 0.208 Test Loss: 2.337 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1962602138519287
Epoch: 14, Steps: 7 | Train Loss: 0.112 Vali Loss: 2.384 Vali Acc: 0.278 Test Loss: 2.384 Test Acc: 0.278
Validation loss decreased (-0.263866 --> -0.277754).  Saving model ...
Epoch: 15 cost time: 2.274935245513916
Epoch: 15, Steps: 7 | Train Loss: 0.086 Vali Loss: 2.471 Vali Acc: 0.306 Test Loss: 2.471 Test Acc: 0.306
Validation loss decreased (-0.277754 --> -0.305531).  Saving model ...
Epoch: 16 cost time: 2.331031560897827
Epoch: 16, Steps: 7 | Train Loss: 0.056 Vali Loss: 2.559 Vali Acc: 0.250 Test Loss: 2.559 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.428867816925049
Epoch: 17, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.803 Vali Acc: 0.264 Test Loss: 2.803 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.156741142272949
Epoch: 18, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.708 Vali Acc: 0.278 Test Loss: 2.708 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2014331817626953
Epoch: 19, Steps: 7 | Train Loss: 0.024 Vali Loss: 2.567 Vali Acc: 0.264 Test Loss: 2.567 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2331247329711914
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.762 Vali Acc: 0.278 Test Loss: 2.762 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1953320503234863
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.792 Vali Acc: 0.278 Test Loss: 2.792 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3021628856658936
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.770 Vali Acc: 0.264 Test Loss: 2.770 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2999796867370605
Epoch: 23, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.834 Vali Acc: 0.264 Test Loss: 2.834 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.214686870574951
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.958 Vali Acc: 0.264 Test Loss: 2.958 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.18467116355896
Epoch: 25, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.967 Vali Acc: 0.292 Test Loss: 2.967 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_FEDformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.3055555555555556
model parameter : 527340
model size : 3.26MB
